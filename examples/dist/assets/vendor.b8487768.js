var MF=Object.defineProperty;var r_=Object.getOwnPropertySymbols;var SF=Object.prototype.hasOwnProperty,TF=Object.prototype.propertyIsEnumerable;var i_=(i,n,r)=>n in i?MF(i,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[n]=r,a_=(i,n)=>{for(var r in n||(n={}))SF.call(n,r)&&i_(i,r,n[r]);if(r_)for(var r of r_(n))TF.call(n,r)&&i_(i,r,n[r]);return i};function Xy(i,n){const r=Object.create(null),a=i.split(",");for(let s=0;s<a.length;s++)r[a[s]]=!0;return n?s=>!!r[s.toLowerCase()]:s=>!!r[s]}const CF="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",RF=Xy(CF);function o_(i){return!!i||i===""}function Jm(i){if(wr(i)){const n={};for(let r=0;r<i.length;r++){const a=i[r],s=Ji(a)?DF(a):Jm(a);if(s)for(const o in s)n[o]=s[o]}return n}else{if(Ji(i))return i;if(Gi(i))return i}}const LF=/;(?![^(]*\))/g,PF=/:(.+)/;function DF(i){const n={};return i.split(LF).forEach(r=>{if(r){const a=r.split(PF);a.length>1&&(n[a[0].trim()]=a[1].trim())}}),n}function qy(i){let n="";if(Ji(i))n=i;else if(wr(i))for(let r=0;r<i.length;r++){const a=qy(i[r]);a&&(n+=a+" ")}else if(Gi(i))for(const r in i)i[r]&&(n+=r+" ");return n.trim()}const OF=i=>i==null?"":wr(i)||Gi(i)&&(i.toString===h_||!Ar(i.toString))?JSON.stringify(i,s_,2):String(i),s_=(i,n)=>n&&n.__v_isRef?s_(i,n.value):Hu(n)?{[`Map(${n.size})`]:[...n.entries()].reduce((r,[a,s])=>(r[`${a} =>`]=s,r),{})}:c_(n)?{[`Set(${n.size})`]:[...n.values()]}:Gi(n)&&!wr(n)&&!f_(n)?String(n):n,si={},Uu=[],Lo=()=>{},IF=()=>!1,kF=/^on[^a-z]/,ev=i=>kF.test(i),Yy=i=>i.startsWith("onUpdate:"),Ma=Object.assign,l_=(i,n)=>{const r=i.indexOf(n);r>-1&&i.splice(r,1)},FF=Object.prototype.hasOwnProperty,zr=(i,n)=>FF.call(i,n),wr=Array.isArray,Hu=i=>tv(i)==="[object Map]",c_=i=>tv(i)==="[object Set]",Ar=i=>typeof i=="function",Ji=i=>typeof i=="string",$y=i=>typeof i=="symbol",Gi=i=>i!==null&&typeof i=="object",u_=i=>Gi(i)&&Ar(i.then)&&Ar(i.catch),h_=Object.prototype.toString,tv=i=>h_.call(i),BF=i=>tv(i).slice(8,-1),f_=i=>tv(i)==="[object Object]",Ky=i=>Ji(i)&&i!=="NaN"&&i[0]!=="-"&&""+parseInt(i,10)===i,nv=Xy(",key,ref,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),rv=i=>{const n=Object.create(null);return r=>n[r]||(n[r]=i(r))},NF=/-(\w)/g,Qo=rv(i=>i.replace(NF,(n,r)=>r?r.toUpperCase():"")),UF=/\B([A-Z])/g,zu=rv(i=>i.replace(UF,"-$1").toLowerCase()),iv=rv(i=>i.charAt(0).toUpperCase()+i.slice(1)),Zy=rv(i=>i?`on${iv(i)}`:""),$f=(i,n)=>!Object.is(i,n),Qy=(i,n)=>{for(let r=0;r<i.length;r++)i[r](n)},av=(i,n,r)=>{Object.defineProperty(i,n,{configurable:!0,enumerable:!1,value:r})},HF=i=>{const n=parseFloat(i);return isNaN(n)?i:n};let d_;const zF=()=>d_||(d_=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});let Lc;const ov=[];class GF{constructor(n=!1){this.active=!0,this.effects=[],this.cleanups=[],!n&&Lc&&(this.parent=Lc,this.index=(Lc.scopes||(Lc.scopes=[])).push(this)-1)}run(n){if(this.active)try{return this.on(),n()}finally{this.off()}}on(){this.active&&(ov.push(this),Lc=this)}off(){this.active&&(ov.pop(),Lc=ov[ov.length-1])}stop(n){if(this.active){if(this.effects.forEach(r=>r.stop()),this.cleanups.forEach(r=>r()),this.scopes&&this.scopes.forEach(r=>r.stop(!0)),this.parent&&!n){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.active=!1}}}function VF(i,n){n=n||Lc,n&&n.active&&n.effects.push(i)}const Jy=i=>{const n=new Set(i);return n.w=0,n.n=0,n},p_=i=>(i.w&El)>0,m_=i=>(i.n&El)>0,WF=({deps:i})=>{if(i.length)for(let n=0;n<i.length;n++)i[n].w|=El},jF=i=>{const{deps:n}=i;if(n.length){let r=0;for(let a=0;a<n.length;a++){const s=n[a];p_(s)&&!m_(s)?s.delete(i):n[r++]=s,s.w&=~El,s.n&=~El}n.length=r}},eb=new WeakMap;let Kf=0,El=1;const tb=30,Zf=[];let Pc;const Dc=Symbol(""),nb=Symbol("");class rb{constructor(n,r=null,a){this.fn=n,this.scheduler=r,this.active=!0,this.deps=[],VF(this,a)}run(){if(!this.active)return this.fn();if(!Zf.includes(this))try{return Zf.push(Pc=this),XF(),El=1<<++Kf,Kf<=tb?WF(this):v_(this),this.fn()}finally{Kf<=tb&&jF(this),El=1<<--Kf,Oc(),Zf.pop();const n=Zf.length;Pc=n>0?Zf[n-1]:void 0}}stop(){this.active&&(v_(this),this.onStop&&this.onStop(),this.active=!1)}}function v_(i){const{deps:n}=i;if(n.length){for(let r=0;r<n.length;r++)n[r].delete(i);n.length=0}}let Gu=!0;const ib=[];function Vu(){ib.push(Gu),Gu=!1}function XF(){ib.push(Gu),Gu=!0}function Oc(){const i=ib.pop();Gu=i===void 0?!0:i}function Ka(i,n,r){if(!g_())return;let a=eb.get(i);a||eb.set(i,a=new Map);let s=a.get(r);s||a.set(r,s=Jy()),y_(s)}function g_(){return Gu&&Pc!==void 0}function y_(i,n){let r=!1;Kf<=tb?m_(i)||(i.n|=El,r=!p_(i)):r=!i.has(Pc),r&&(i.add(Pc),Pc.deps.push(i))}function Ps(i,n,r,a,s,o){const u=eb.get(i);if(!u)return;let f=[];if(n==="clear")f=[...u.values()];else if(r==="length"&&wr(i))u.forEach((v,m)=>{(m==="length"||m>=a)&&f.push(v)});else switch(r!==void 0&&f.push(u.get(r)),n){case"add":wr(i)?Ky(r)&&f.push(u.get("length")):(f.push(u.get(Dc)),Hu(i)&&f.push(u.get(nb)));break;case"delete":wr(i)||(f.push(u.get(Dc)),Hu(i)&&f.push(u.get(nb)));break;case"set":Hu(i)&&f.push(u.get(Dc));break}if(f.length===1)f[0]&&ab(f[0]);else{const v=[];for(const m of f)m&&v.push(...m);ab(Jy(v))}}function ab(i,n){for(const r of wr(i)?i:[...i])(r!==Pc||r.allowRecurse)&&(r.scheduler?r.scheduler():r.run())}const qF=Xy("__proto__,__v_isRef,__isVue"),b_=new Set(Object.getOwnPropertyNames(Symbol).map(i=>Symbol[i]).filter($y)),YF=ob(),$F=ob(!1,!0),KF=ob(!0),x_=ZF();function ZF(){const i={};return["includes","indexOf","lastIndexOf"].forEach(n=>{i[n]=function(...r){const a=Kr(this);for(let o=0,u=this.length;o<u;o++)Ka(a,"get",o+"");const s=a[n](...r);return s===-1||s===!1?a[n](...r.map(Kr)):s}}),["push","pop","shift","unshift","splice"].forEach(n=>{i[n]=function(...r){Vu();const a=Kr(this)[n].apply(this,r);return Oc(),a}}),i}function ob(i=!1,n=!1){return function(a,s,o){if(s==="__v_isReactive")return!i;if(s==="__v_isReadonly")return i;if(s==="__v_raw"&&o===(i?n?d4:R_:n?C_:T_).get(a))return a;const u=wr(a);if(!i&&u&&zr(x_,s))return Reflect.get(x_,s,o);const f=Reflect.get(a,s,o);return($y(s)?b_.has(s):qF(s))||(i||Ka(a,"get",s),n)?f:Sa(f)?!u||!Ky(s)?f.value:f:Gi(f)?i?L_(f):Ic(f):f}}const QF=w_(),JF=w_(!0);function w_(i=!1){return function(r,a,s,o){let u=r[a];if(!i&&(s=Kr(s),u=Kr(u),!wr(r)&&Sa(u)&&!Sa(s)))return u.value=s,!0;const f=wr(r)&&Ky(a)?Number(a)<r.length:zr(r,a),v=Reflect.set(r,a,s,o);return r===Kr(o)&&(f?$f(s,u)&&Ps(r,"set",a,s):Ps(r,"add",a,s)),v}}function e4(i,n){const r=zr(i,n);i[n];const a=Reflect.deleteProperty(i,n);return a&&r&&Ps(i,"delete",n,void 0),a}function t4(i,n){const r=Reflect.has(i,n);return(!$y(n)||!b_.has(n))&&Ka(i,"has",n),r}function n4(i){return Ka(i,"iterate",wr(i)?"length":Dc),Reflect.ownKeys(i)}const A_={get:YF,set:QF,deleteProperty:e4,has:t4,ownKeys:n4},r4={get:KF,set(i,n){return!0},deleteProperty(i,n){return!0}},i4=Ma({},A_,{get:$F,set:JF}),sb=i=>i,sv=i=>Reflect.getPrototypeOf(i);function lv(i,n,r=!1,a=!1){i=i.__v_raw;const s=Kr(i),o=Kr(n);n!==o&&!r&&Ka(s,"get",n),!r&&Ka(s,"get",o);const{has:u}=sv(s),f=a?sb:r?ub:Qf;if(u.call(s,n))return f(i.get(n));if(u.call(s,o))return f(i.get(o));i!==s&&i.get(n)}function cv(i,n=!1){const r=this.__v_raw,a=Kr(r),s=Kr(i);return i!==s&&!n&&Ka(a,"has",i),!n&&Ka(a,"has",s),i===s?r.has(i):r.has(i)||r.has(s)}function uv(i,n=!1){return i=i.__v_raw,!n&&Ka(Kr(i),"iterate",Dc),Reflect.get(i,"size",i)}function E_(i){i=Kr(i);const n=Kr(this);return sv(n).has.call(n,i)||(n.add(i),Ps(n,"add",i,i)),this}function __(i,n){n=Kr(n);const r=Kr(this),{has:a,get:s}=sv(r);let o=a.call(r,i);o||(i=Kr(i),o=a.call(r,i));const u=s.call(r,i);return r.set(i,n),o?$f(n,u)&&Ps(r,"set",i,n):Ps(r,"add",i,n),this}function M_(i){const n=Kr(this),{has:r,get:a}=sv(n);let s=r.call(n,i);s||(i=Kr(i),s=r.call(n,i)),a&&a.call(n,i);const o=n.delete(i);return s&&Ps(n,"delete",i,void 0),o}function S_(){const i=Kr(this),n=i.size!==0,r=i.clear();return n&&Ps(i,"clear",void 0,void 0),r}function hv(i,n){return function(a,s){const o=this,u=o.__v_raw,f=Kr(u),v=n?sb:i?ub:Qf;return!i&&Ka(f,"iterate",Dc),u.forEach((m,g)=>a.call(s,v(m),v(g),o))}}function fv(i,n,r){return function(...a){const s=this.__v_raw,o=Kr(s),u=Hu(o),f=i==="entries"||i===Symbol.iterator&&u,v=i==="keys"&&u,m=s[i](...a),g=r?sb:n?ub:Qf;return!n&&Ka(o,"iterate",v?nb:Dc),{next(){const{value:y,done:b}=m.next();return b?{value:y,done:b}:{value:f?[g(y[0]),g(y[1])]:g(y),done:b}},[Symbol.iterator](){return this}}}}function _l(i){return function(...n){return i==="delete"?!1:this}}function a4(){const i={get(o){return lv(this,o)},get size(){return uv(this)},has:cv,add:E_,set:__,delete:M_,clear:S_,forEach:hv(!1,!1)},n={get(o){return lv(this,o,!1,!0)},get size(){return uv(this)},has:cv,add:E_,set:__,delete:M_,clear:S_,forEach:hv(!1,!0)},r={get(o){return lv(this,o,!0)},get size(){return uv(this,!0)},has(o){return cv.call(this,o,!0)},add:_l("add"),set:_l("set"),delete:_l("delete"),clear:_l("clear"),forEach:hv(!0,!1)},a={get(o){return lv(this,o,!0,!0)},get size(){return uv(this,!0)},has(o){return cv.call(this,o,!0)},add:_l("add"),set:_l("set"),delete:_l("delete"),clear:_l("clear"),forEach:hv(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(o=>{i[o]=fv(o,!1,!1),r[o]=fv(o,!0,!1),n[o]=fv(o,!1,!0),a[o]=fv(o,!0,!0)}),[i,r,n,a]}const[o4,s4,l4,c4]=a4();function lb(i,n){const r=n?i?c4:l4:i?s4:o4;return(a,s,o)=>s==="__v_isReactive"?!i:s==="__v_isReadonly"?i:s==="__v_raw"?a:Reflect.get(zr(r,s)&&s in a?r:a,s,o)}const u4={get:lb(!1,!1)},h4={get:lb(!1,!0)},f4={get:lb(!0,!1)},T_=new WeakMap,C_=new WeakMap,R_=new WeakMap,d4=new WeakMap;function p4(i){switch(i){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function m4(i){return i.__v_skip||!Object.isExtensible(i)?0:p4(BF(i))}function Ic(i){return i&&i.__v_isReadonly?i:cb(i,!1,A_,u4,T_)}function v4(i){return cb(i,!1,i4,h4,C_)}function L_(i){return cb(i,!0,r4,f4,R_)}function cb(i,n,r,a,s){if(!Gi(i)||i.__v_raw&&!(n&&i.__v_isReactive))return i;const o=s.get(i);if(o)return o;const u=m4(i);if(u===0)return i;const f=new Proxy(i,u===2?a:r);return s.set(i,f),f}function Wu(i){return P_(i)?Wu(i.__v_raw):!!(i&&i.__v_isReactive)}function P_(i){return!!(i&&i.__v_isReadonly)}function D_(i){return Wu(i)||P_(i)}function Kr(i){const n=i&&i.__v_raw;return n?Kr(n):i}function O_(i){return av(i,"__v_skip",!0),i}const Qf=i=>Gi(i)?Ic(i):i,ub=i=>Gi(i)?L_(i):i;function I_(i){g_()&&(i=Kr(i),i.dep||(i.dep=Jy()),y_(i.dep))}function k_(i,n){i=Kr(i),i.dep&&ab(i.dep)}function Sa(i){return Boolean(i&&i.__v_isRef===!0)}function hb(i){return F_(i,!1)}function g4(i){return F_(i,!0)}function F_(i,n){return Sa(i)?i:new y4(i,n)}class y4{constructor(n,r){this._shallow=r,this.dep=void 0,this.__v_isRef=!0,this._rawValue=r?n:Kr(n),this._value=r?n:Qf(n)}get value(){return I_(this),this._value}set value(n){n=this._shallow?n:Kr(n),$f(n,this._rawValue)&&(this._rawValue=n,this._value=this._shallow?n:Qf(n),k_(this))}}function Jf(i){return Sa(i)?i.value:i}const b4={get:(i,n,r)=>Jf(Reflect.get(i,n,r)),set:(i,n,r,a)=>{const s=i[n];return Sa(s)&&!Sa(r)?(s.value=r,!0):Reflect.set(i,n,r,a)}};function B_(i){return Wu(i)?i:new Proxy(i,b4)}function N_(i){const n=wr(i)?new Array(i.length):{};for(const r in i)n[r]=w4(i,r);return n}class x4{constructor(n,r){this._object=n,this._key=r,this.__v_isRef=!0}get value(){return this._object[this._key]}set value(n){this._object[this._key]=n}}function w4(i,n){const r=i[n];return Sa(r)?r:new x4(i,n)}class A4{constructor(n,r,a){this._setter=r,this.dep=void 0,this._dirty=!0,this.__v_isRef=!0,this.effect=new rb(n,()=>{this._dirty||(this._dirty=!0,k_(this))}),this.__v_isReadonly=a}get value(){const n=Kr(this);return I_(n),n._dirty&&(n._dirty=!1,n._value=n.effect.run()),n._value}set value(n){this._setter(n)}}function Jo(i,n){let r,a;const s=Ar(i);return s?(r=i,a=Lo):(r=i.get,a=i.set),new A4(r,a,s||!a)}Promise.resolve();function E4(i,n,...r){const a=i.vnode.props||si;let s=r;const o=n.startsWith("update:"),u=o&&n.slice(7);if(u&&u in a){const g=`${u==="modelValue"?"model":u}Modifiers`,{number:y,trim:b}=a[g]||si;b?s=r.map(w=>w.trim()):y&&(s=r.map(HF))}let f,v=a[f=Zy(n)]||a[f=Zy(Qo(n))];!v&&o&&(v=a[f=Zy(zu(n))]),v&&Po(v,i,6,s);const m=a[f+"Once"];if(m){if(!i.emitted)i.emitted={};else if(i.emitted[f])return;i.emitted[f]=!0,Po(m,i,6,s)}}function U_(i,n,r=!1){const a=n.emitsCache,s=a.get(i);if(s!==void 0)return s;const o=i.emits;let u={},f=!1;if(!Ar(i)){const v=m=>{const g=U_(m,n,!0);g&&(f=!0,Ma(u,g))};!r&&n.mixins.length&&n.mixins.forEach(v),i.extends&&v(i.extends),i.mixins&&i.mixins.forEach(v)}return!o&&!f?(a.set(i,null),null):(wr(o)?o.forEach(v=>u[v]=null):Ma(u,o),a.set(i,u),u)}function fb(i,n){return!i||!ev(n)?!1:(n=n.slice(2).replace(/Once$/,""),zr(i,n[0].toLowerCase()+n.slice(1))||zr(i,zu(n))||zr(i,n))}let lo=null,dv=null;function pv(i){const n=lo;return lo=i,dv=i&&i.type.__scopeId||null,n}function IZ(i){dv=i}function kZ(){dv=null}function _4(i,n=lo,r){if(!n||i._n)return i;const a=(...s)=>{a._d&&sM(-1);const o=pv(n),u=i(...s);return pv(o),a._d&&sM(1),u};return a._n=!0,a._c=!0,a._d=!0,a}function db(i){const{type:n,vnode:r,proxy:a,withProxy:s,props:o,propsOptions:[u],slots:f,attrs:v,emit:m,render:g,renderCache:y,data:b,setupState:w,ctx:A,inheritAttrs:M}=i;let S,E;const T=pv(i);try{if(r.shapeFlag&4){const L=s||a;S=ns(g.call(L,L,y,o,w,b,A)),E=v}else{const L=n;S=ns(L.length>1?L(o,{attrs:v,slots:f,emit:m}):L(o,null)),E=n.props?v:M4(v)}}catch(L){nd.length=0,_v(L,i,1),S=ka(Ml)}let C=S;if(E&&M!==!1){const L=Object.keys(E),{shapeFlag:P}=C;L.length&&P&(1|6)&&(u&&L.some(Yy)&&(E=S4(E,u)),C=id(C,E))}return r.dirs&&(C.dirs=C.dirs?C.dirs.concat(r.dirs):r.dirs),r.transition&&(C.transition=r.transition),S=C,pv(T),S}const M4=i=>{let n;for(const r in i)(r==="class"||r==="style"||ev(r))&&((n||(n={}))[r]=i[r]);return n},S4=(i,n)=>{const r={};for(const a in i)(!Yy(a)||!(a.slice(9)in n))&&(r[a]=i[a]);return r};function T4(i,n,r){const{props:a,children:s,component:o}=i,{props:u,children:f,patchFlag:v}=n,m=o.emitsOptions;if(n.dirs||n.transition)return!0;if(r&&v>=0){if(v&1024)return!0;if(v&16)return a?H_(a,u,m):!!u;if(v&8){const g=n.dynamicProps;for(let y=0;y<g.length;y++){const b=g[y];if(u[b]!==a[b]&&!fb(m,b))return!0}}}else return(s||f)&&(!f||!f.$stable)?!0:a===u?!1:a?u?H_(a,u,m):!0:!!u;return!1}function H_(i,n,r){const a=Object.keys(n);if(a.length!==Object.keys(i).length)return!0;for(let s=0;s<a.length;s++){const o=a[s];if(n[o]!==i[o]&&!fb(r,o))return!0}return!1}function C4({vnode:i,parent:n},r){for(;n&&n.subTree===i;)(i=n.vnode).el=r,n=n.parent}const R4=i=>i.__isSuspense;function L4(i,n){n&&n.pendingBranch?wr(i)?n.effects.push(...i):n.effects.push(i):TB(i)}function ed(i,n){if(ea){let r=ea.provides;const a=ea.parent&&ea.parent.provides;a===r&&(r=ea.provides=Object.create(a)),r[i]=n}}function es(i,n,r=!1){const a=ea||lo;if(a){const s=a.parent==null?a.vnode.appContext&&a.vnode.appContext.provides:a.parent.provides;if(s&&i in s)return s[i];if(arguments.length>1)return r&&Ar(n)?n.call(a.proxy):n}}function td(i){return Ar(i)?{setup:i,name:i.name}:i}const pb=i=>!!i.type.__asyncLoader,z_=i=>i.type.__isKeepAlive;function P4(i,n){G_(i,"a",n)}function D4(i,n){G_(i,"da",n)}function G_(i,n,r=ea){const a=i.__wdc||(i.__wdc=()=>{let s=r;for(;s;){if(s.isDeactivated)return;s=s.parent}i()});if(mv(n,a,r),r){let s=r.parent;for(;s&&s.parent;)z_(s.parent.vnode)&&O4(a,n,r,s),s=s.parent}}function O4(i,n,r,a){const s=mv(n,i,a,!0);V_(()=>{l_(a[n],s)},r)}function mv(i,n,r=ea,a=!1){if(r){const s=r[i]||(r[i]=[]),o=n.__weh||(n.__weh=(...u)=>{if(r.isUnmounted)return;Vu(),Xu(r);const f=Po(n,r,i,u);return Nc(),Oc(),f});return a?s.unshift(o):s.push(o),o}}const Ds=i=>(n,r=ea)=>(!Ev||i==="sp")&&mv(i,n,r),I4=Ds("bm"),mb=Ds("m"),k4=Ds("bu"),F4=Ds("u"),vb=Ds("bum"),V_=Ds("um"),B4=Ds("sp"),N4=Ds("rtg"),U4=Ds("rtc");function H4(i,n=ea){mv("ec",i,n)}let gb=!0;function z4(i){const n=X_(i),r=i.proxy,a=i.ctx;gb=!1,n.beforeCreate&&W_(n.beforeCreate,i,"bc");const{data:s,computed:o,methods:u,watch:f,provide:v,inject:m,created:g,beforeMount:y,mounted:b,beforeUpdate:w,updated:A,activated:M,deactivated:S,beforeDestroy:E,beforeUnmount:T,destroyed:C,unmounted:L,render:P,renderTracked:N,renderTriggered:F,errorCaptured:X,serverPrefetch:Y,expose:ae,inheritAttrs:$,components:de,directives:D,filters:I}=n;if(m&&G4(m,a,null,i.appContext.config.unwrapInjectedRef),u)for(const W in u){const ce=u[W];Ar(ce)&&(a[W]=ce.bind(r))}if(s){const W=s.call(r,r);Gi(W)&&(i.data=Ic(W))}if(gb=!0,o)for(const W in o){const ce=o[W],oe=Ar(ce)?ce.bind(r,r):Ar(ce.get)?ce.get.bind(r,r):Lo,ge=!Ar(ce)&&Ar(ce.set)?ce.set.bind(r):Lo,_e=Jo({get:oe,set:ge});Object.defineProperty(a,W,{enumerable:!0,configurable:!0,get:()=>_e.value,set:Ne=>_e.value=Ne})}if(f)for(const W in f)j_(f[W],a,r,W);if(v){const W=Ar(v)?v.call(r):v;Reflect.ownKeys(W).forEach(ce=>{ed(ce,W[ce])})}g&&W_(g,i,"c");function U(W,ce){wr(ce)?ce.forEach(oe=>W(oe.bind(r))):ce&&W(ce.bind(r))}if(U(I4,y),U(mb,b),U(k4,w),U(F4,A),U(P4,M),U(D4,S),U(H4,X),U(U4,N),U(N4,F),U(vb,T),U(V_,L),U(B4,Y),wr(ae))if(ae.length){const W=i.exposed||(i.exposed={});ae.forEach(ce=>{Object.defineProperty(W,ce,{get:()=>r[ce],set:oe=>r[ce]=oe})})}else i.exposed||(i.exposed={});P&&i.render===Lo&&(i.render=P),$!=null&&(i.inheritAttrs=$),de&&(i.components=de),D&&(i.directives=D)}function G4(i,n,r=Lo,a=!1){wr(i)&&(i=yb(i));for(const s in i){const o=i[s];let u;Gi(o)?"default"in o?u=es(o.from||s,o.default,!0):u=es(o.from||s):u=es(o),Sa(u)&&a?Object.defineProperty(n,s,{enumerable:!0,configurable:!0,get:()=>u.value,set:f=>u.value=f}):n[s]=u}}function W_(i,n,r){Po(wr(i)?i.map(a=>a.bind(n.proxy)):i.bind(n.proxy),n,r)}function j_(i,n,r,a){const s=a.includes(".")?TM(r,a):()=>r[a];if(Ji(i)){const o=n[i];Ar(o)&&cd(s,o)}else if(Ar(i))cd(s,i.bind(r));else if(Gi(i))if(wr(i))i.forEach(o=>j_(o,n,r,a));else{const o=Ar(i.handler)?i.handler.bind(r):n[i.handler];Ar(o)&&cd(s,o,i)}}function X_(i){const n=i.type,{mixins:r,extends:a}=n,{mixins:s,optionsCache:o,config:{optionMergeStrategies:u}}=i.appContext,f=o.get(n);let v;return f?v=f:!s.length&&!r&&!a?v=n:(v={},s.length&&s.forEach(m=>vv(v,m,u,!0)),vv(v,n,u)),o.set(n,v),v}function vv(i,n,r,a=!1){const{mixins:s,extends:o}=n;o&&vv(i,o,r,!0),s&&s.forEach(u=>vv(i,u,r,!0));for(const u in n)if(!(a&&u==="expose")){const f=V4[u]||r&&r[u];i[u]=f?f(i[u],n[u]):n[u]}return i}const V4={data:q_,props:kc,emits:kc,methods:kc,computed:kc,beforeCreate:Ta,created:Ta,beforeMount:Ta,mounted:Ta,beforeUpdate:Ta,updated:Ta,beforeDestroy:Ta,beforeUnmount:Ta,destroyed:Ta,unmounted:Ta,activated:Ta,deactivated:Ta,errorCaptured:Ta,serverPrefetch:Ta,components:kc,directives:kc,watch:j4,provide:q_,inject:W4};function q_(i,n){return n?i?function(){return Ma(Ar(i)?i.call(this,this):i,Ar(n)?n.call(this,this):n)}:n:i}function W4(i,n){return kc(yb(i),yb(n))}function yb(i){if(wr(i)){const n={};for(let r=0;r<i.length;r++)n[i[r]]=i[r];return n}return i}function Ta(i,n){return i?[...new Set([].concat(i,n))]:n}function kc(i,n){return i?Ma(Ma(Object.create(null),i),n):n}function j4(i,n){if(!i)return n;if(!n)return i;const r=Ma(Object.create(null),i);for(const a in n)r[a]=Ta(i[a],n[a]);return r}function X4(i,n,r,a=!1){const s={},o={};av(o,xv,1),i.propsDefaults=Object.create(null),Y_(i,n,s,o);for(const u in i.propsOptions[0])u in s||(s[u]=void 0);r?i.props=a?s:v4(s):i.type.props?i.props=s:i.props=o,i.attrs=o}function q4(i,n,r,a){const{props:s,attrs:o,vnode:{patchFlag:u}}=i,f=Kr(s),[v]=i.propsOptions;let m=!1;if((a||u>0)&&!(u&16)){if(u&8){const g=i.vnode.dynamicProps;for(let y=0;y<g.length;y++){let b=g[y];const w=n[b];if(v)if(zr(o,b))w!==o[b]&&(o[b]=w,m=!0);else{const A=Qo(b);s[A]=bb(v,f,A,w,i,!1)}else w!==o[b]&&(o[b]=w,m=!0)}}}else{Y_(i,n,s,o)&&(m=!0);let g;for(const y in f)(!n||!zr(n,y)&&((g=zu(y))===y||!zr(n,g)))&&(v?r&&(r[y]!==void 0||r[g]!==void 0)&&(s[y]=bb(v,f,y,void 0,i,!0)):delete s[y]);if(o!==f)for(const y in o)(!n||!zr(n,y))&&(delete o[y],m=!0)}m&&Ps(i,"set","$attrs")}function Y_(i,n,r,a){const[s,o]=i.propsOptions;let u=!1,f;if(n)for(let v in n){if(nv(v))continue;const m=n[v];let g;s&&zr(s,g=Qo(v))?!o||!o.includes(g)?r[g]=m:(f||(f={}))[g]=m:fb(i.emitsOptions,v)||m!==a[v]&&(a[v]=m,u=!0)}if(o){const v=Kr(r),m=f||si;for(let g=0;g<o.length;g++){const y=o[g];r[y]=bb(s,v,y,m[y],i,!zr(m,y))}}return u}function bb(i,n,r,a,s,o){const u=i[r];if(u!=null){const f=zr(u,"default");if(f&&a===void 0){const v=u.default;if(u.type!==Function&&Ar(v)){const{propsDefaults:m}=s;r in m?a=m[r]:(Xu(s),a=m[r]=v.call(null,n),Nc())}else a=v}u[0]&&(o&&!f?a=!1:u[1]&&(a===""||a===zu(r))&&(a=!0))}return a}function $_(i,n,r=!1){const a=n.propsCache,s=a.get(i);if(s)return s;const o=i.props,u={},f=[];let v=!1;if(!Ar(i)){const g=y=>{v=!0;const[b,w]=$_(y,n,!0);Ma(u,b),w&&f.push(...w)};!r&&n.mixins.length&&n.mixins.forEach(g),i.extends&&g(i.extends),i.mixins&&i.mixins.forEach(g)}if(!o&&!v)return a.set(i,Uu),Uu;if(wr(o))for(let g=0;g<o.length;g++){const y=Qo(o[g]);K_(y)&&(u[y]=si)}else if(o)for(const g in o){const y=Qo(g);if(K_(y)){const b=o[g],w=u[y]=wr(b)||Ar(b)?{type:b}:b;if(w){const A=J_(Boolean,w.type),M=J_(String,w.type);w[0]=A>-1,w[1]=M<0||A<M,(A>-1||zr(w,"default"))&&f.push(y)}}}const m=[u,f];return a.set(i,m),m}function K_(i){return i[0]!=="$"}function Z_(i){const n=i&&i.toString().match(/^\s*function (\w+)/);return n?n[1]:i===null?"null":""}function Q_(i,n){return Z_(i)===Z_(n)}function J_(i,n){return wr(n)?n.findIndex(r=>Q_(r,i)):Ar(n)&&Q_(n,i)?0:-1}const eM=i=>i[0]==="_"||i==="$stable",xb=i=>wr(i)?i.map(ns):[ns(i)],Y4=(i,n,r)=>{const a=_4((...s)=>xb(n(...s)),r);return a._c=!1,a},tM=(i,n,r)=>{const a=i._ctx;for(const s in i){if(eM(s))continue;const o=i[s];if(Ar(o))n[s]=Y4(s,o,a);else if(o!=null){const u=xb(o);n[s]=()=>u}}},nM=(i,n)=>{const r=xb(n);i.slots.default=()=>r},$4=(i,n)=>{if(i.vnode.shapeFlag&32){const r=n._;r?(i.slots=Kr(n),av(n,"_",r)):tM(n,i.slots={})}else i.slots={},n&&nM(i,n);av(i.slots,xv,1)},K4=(i,n,r)=>{const{vnode:a,slots:s}=i;let o=!0,u=si;if(a.shapeFlag&32){const f=n._;f?r&&f===1?o=!1:(Ma(s,n),!r&&f===1&&delete s._):(o=!n.$stable,tM(n,s)),u=n}else n&&(nM(i,n),u={default:1});if(o)for(const f in s)!eM(f)&&!(f in u)&&delete s[f]};function Z4(i,n){const r=lo;if(r===null)return i;const a=r.proxy,s=i.dirs||(i.dirs=[]);for(let o=0;o<n.length;o++){let[u,f,v,m=si]=n[o];Ar(u)&&(u={mounted:u,updated:u}),u.deep&&Uc(f),s.push({dir:u,instance:a,value:f,oldValue:void 0,arg:v,modifiers:m})}return i}function Fc(i,n,r,a){const s=i.dirs,o=n&&n.dirs;for(let u=0;u<s.length;u++){const f=s[u];o&&(f.oldValue=o[u].value);let v=f.dir[a];v&&(Vu(),Po(v,r,8,[i.el,f,i,n]),Oc())}}function rM(){return{app:null,config:{isNativeTag:IF,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Q4=0;function J4(i,n){return function(a,s=null){s!=null&&!Gi(s)&&(s=null);const o=rM(),u=new Set;let f=!1;const v=o.app={_uid:Q4++,_component:a,_props:s,_container:null,_context:o,_instance:null,version:RB,get config(){return o.config},set config(m){},use(m,...g){return u.has(m)||(m&&Ar(m.install)?(u.add(m),m.install(v,...g)):Ar(m)&&(u.add(m),m(v,...g))),v},mixin(m){return o.mixins.includes(m)||o.mixins.push(m),v},component(m,g){return g?(o.components[m]=g,v):o.components[m]},directive(m,g){return g?(o.directives[m]=g,v):o.directives[m]},mount(m,g,y){if(!f){const b=ka(a,s);return b.appContext=o,g&&n?n(b,m):i(b,m,y),f=!0,v._container=m,m.__vue_app__=v,Sb(b.component)||b.component.proxy}},unmount(){f&&(i(null,v._container),delete v._container.__vue_app__)},provide(m,g){return o.provides[m]=g,v}};return v}}const Ca=L4;function eB(i){return tB(i)}function tB(i,n){const r=zF();r.__VUE__=!0;const{insert:a,remove:s,patchProp:o,createElement:u,createText:f,createComment:v,setText:m,setElementText:g,parentNode:y,nextSibling:b,setScopeId:w=Lo,cloneNode:A,insertStaticContent:M}=i,S=(H,j,q,pe=null,ee=null,te=null,Se=!1,ke=null,Be=!!j.dynamicChildren)=>{if(H===j)return;H&&!rd(H,j)&&(pe=Qe(H),Ie(H,ee,te,!0),H=null),j.patchFlag===-2&&(Be=!1,j.dynamicChildren=null);const{type:We,ref:ve,shapeFlag:K}=j;switch(We){case Ab:E(H,j,q,pe);break;case Ml:T(H,j,q,pe);break;case Eb:H==null&&C(j,q,pe,Se);break;case co:D(H,j,q,pe,ee,te,Se,ke,Be);break;default:K&1?N(H,j,q,pe,ee,te,Se,ke,Be):K&6?I(H,j,q,pe,ee,te,Se,ke,Be):(K&64||K&128)&&We.process(H,j,q,pe,ee,te,Se,ke,Be,ht)}ve!=null&&ee&&wb(ve,H&&H.ref,te,j||H,!j)},E=(H,j,q,pe)=>{if(H==null)a(j.el=f(j.children),q,pe);else{const ee=j.el=H.el;j.children!==H.children&&m(ee,j.children)}},T=(H,j,q,pe)=>{H==null?a(j.el=v(j.children||""),q,pe):j.el=H.el},C=(H,j,q,pe)=>{[H.el,H.anchor]=M(H.children,j,q,pe)},L=({el:H,anchor:j},q,pe)=>{let ee;for(;H&&H!==j;)ee=b(H),a(H,q,pe),H=ee;a(j,q,pe)},P=({el:H,anchor:j})=>{let q;for(;H&&H!==j;)q=b(H),s(H),H=q;s(j)},N=(H,j,q,pe,ee,te,Se,ke,Be)=>{Se=Se||j.type==="svg",H==null?F(j,q,pe,ee,te,Se,ke,Be):ae(H,j,ee,te,Se,ke,Be)},F=(H,j,q,pe,ee,te,Se,ke)=>{let Be,We;const{type:ve,props:K,shapeFlag:J,transition:Ee,patchFlag:xe,dirs:Je}=H;if(H.el&&A!==void 0&&xe===-1)Be=H.el=A(H.el);else{if(Be=H.el=u(H.type,te,K&&K.is,K),J&8?g(Be,H.children):J&16&&Y(H.children,Be,null,pe,ee,te&&ve!=="foreignObject",Se,ke),Je&&Fc(H,null,pe,"created"),K){for(const Mt in K)Mt!=="value"&&!nv(Mt)&&o(Be,Mt,null,K[Mt],te,H.children,pe,ee,Me);"value"in K&&o(Be,"value",null,K.value),(We=K.onVnodeBeforeMount)&&ts(We,pe,H)}X(Be,H,H.scopeId,Se,pe)}Je&&Fc(H,null,pe,"beforeMount");const Xe=(!ee||ee&&!ee.pendingBranch)&&Ee&&!Ee.persisted;Xe&&Ee.beforeEnter(Be),a(Be,j,q),((We=K&&K.onVnodeMounted)||Xe||Je)&&Ca(()=>{We&&ts(We,pe,H),Xe&&Ee.enter(Be),Je&&Fc(H,null,pe,"mounted")},ee)},X=(H,j,q,pe,ee)=>{if(q&&w(H,q),pe)for(let te=0;te<pe.length;te++)w(H,pe[te]);if(ee){let te=ee.subTree;if(j===te){const Se=ee.vnode;X(H,Se,Se.scopeId,Se.slotScopeIds,ee.parent)}}},Y=(H,j,q,pe,ee,te,Se,ke,Be=0)=>{for(let We=Be;We<H.length;We++){const ve=H[We]=ke?Sl(H[We]):ns(H[We]);S(null,ve,j,q,pe,ee,te,Se,ke)}},ae=(H,j,q,pe,ee,te,Se)=>{const ke=j.el=H.el;let{patchFlag:Be,dynamicChildren:We,dirs:ve}=j;Be|=H.patchFlag&16;const K=H.props||si,J=j.props||si;let Ee;(Ee=J.onVnodeBeforeUpdate)&&ts(Ee,q,j,H),ve&&Fc(j,H,q,"beforeUpdate");const xe=ee&&j.type!=="foreignObject";if(We?$(H.dynamicChildren,We,ke,q,pe,xe,te):Se||oe(H,j,ke,null,q,pe,xe,te,!1),Be>0){if(Be&16)de(ke,j,K,J,q,pe,ee);else if(Be&2&&K.class!==J.class&&o(ke,"class",null,J.class,ee),Be&4&&o(ke,"style",K.style,J.style,ee),Be&8){const Je=j.dynamicProps;for(let Xe=0;Xe<Je.length;Xe++){const Mt=Je[Xe],qe=K[Mt],It=J[Mt];(It!==qe||Mt==="value")&&o(ke,Mt,qe,It,ee,H.children,q,pe,Me)}}Be&1&&H.children!==j.children&&g(ke,j.children)}else!Se&&We==null&&de(ke,j,K,J,q,pe,ee);((Ee=J.onVnodeUpdated)||ve)&&Ca(()=>{Ee&&ts(Ee,q,j,H),ve&&Fc(j,H,q,"updated")},pe)},$=(H,j,q,pe,ee,te,Se)=>{for(let ke=0;ke<j.length;ke++){const Be=H[ke],We=j[ke],ve=Be.el&&(Be.type===co||!rd(Be,We)||Be.shapeFlag&(6|64))?y(Be.el):q;S(Be,We,ve,null,pe,ee,te,Se,!0)}},de=(H,j,q,pe,ee,te,Se)=>{if(q!==pe){for(const ke in pe){if(nv(ke))continue;const Be=pe[ke],We=q[ke];Be!==We&&ke!=="value"&&o(H,ke,We,Be,Se,j.children,ee,te,Me)}if(q!==si)for(const ke in q)!nv(ke)&&!(ke in pe)&&o(H,ke,q[ke],null,Se,j.children,ee,te,Me);"value"in pe&&o(H,"value",q.value,pe.value)}},D=(H,j,q,pe,ee,te,Se,ke,Be)=>{const We=j.el=H?H.el:f(""),ve=j.anchor=H?H.anchor:f("");let{patchFlag:K,dynamicChildren:J,slotScopeIds:Ee}=j;Ee&&(ke=ke?ke.concat(Ee):Ee),H==null?(a(We,q,pe),a(ve,q,pe),Y(j.children,q,ve,ee,te,Se,ke,Be)):K>0&&K&64&&J&&H.dynamicChildren?($(H.dynamicChildren,J,q,ee,te,Se,ke),(j.key!=null||ee&&j===ee.subTree)&&iM(H,j,!0)):oe(H,j,q,ve,ee,te,Se,ke,Be)},I=(H,j,q,pe,ee,te,Se,ke,Be)=>{j.slotScopeIds=ke,H==null?j.shapeFlag&512?ee.ctx.activate(j,q,pe,Se,Be):k(j,q,pe,ee,te,Se,Be):U(H,j,Be)},k=(H,j,q,pe,ee,te,Se)=>{const ke=H.component=vB(H,pe,ee);if(z_(H)&&(ke.ctx.renderer=ht),gB(ke),ke.asyncDep){if(ee&&ee.registerDep(ke,W),!H.el){const Be=ke.subTree=ka(Ml);T(null,Be,j,q)}return}W(ke,H,j,q,ee,te,Se)},U=(H,j,q)=>{const pe=j.component=H.component;if(T4(H,j,q))if(pe.asyncDep&&!pe.asyncResolved){ce(pe,j,q);return}else pe.next=j,MB(pe.update),pe.update();else j.component=H.component,j.el=H.el,pe.vnode=j},W=(H,j,q,pe,ee,te,Se)=>{const ke=()=>{if(H.isMounted){let{next:ve,bu:K,u:J,parent:Ee,vnode:xe}=H,Je=ve,Xe;Be.allowRecurse=!1,ve?(ve.el=xe.el,ce(H,ve,Se)):ve=xe,K&&Qy(K),(Xe=ve.props&&ve.props.onVnodeBeforeUpdate)&&ts(Xe,Ee,ve,xe),Be.allowRecurse=!0;const Mt=db(H),qe=H.subTree;H.subTree=Mt,S(qe,Mt,y(qe.el),Qe(qe),H,ee,te),ve.el=Mt.el,Je===null&&C4(H,Mt.el),J&&Ca(J,ee),(Xe=ve.props&&ve.props.onVnodeUpdated)&&Ca(()=>ts(Xe,Ee,ve,xe),ee)}else{let ve;const{el:K,props:J}=j,{bm:Ee,m:xe,parent:Je}=H,Xe=pb(j);if(Be.allowRecurse=!1,Ee&&Qy(Ee),!Xe&&(ve=J&&J.onVnodeBeforeMount)&&ts(ve,Je,j),Be.allowRecurse=!0,K&&fe){const Mt=()=>{H.subTree=db(H),fe(K,H.subTree,H,ee,null)};Xe?j.type.__asyncLoader().then(()=>!H.isUnmounted&&Mt()):Mt()}else{const Mt=H.subTree=db(H);S(null,Mt,q,pe,H,ee,te),j.el=Mt.el}if(xe&&Ca(xe,ee),!Xe&&(ve=J&&J.onVnodeMounted)){const Mt=j;Ca(()=>ts(ve,Je,Mt),ee)}j.shapeFlag&256&&H.a&&Ca(H.a,ee),H.isMounted=!0,j=q=pe=null}},Be=new rb(ke,()=>xM(H.update),H.scope),We=H.update=Be.run.bind(Be);We.id=H.uid,Be.allowRecurse=We.allowRecurse=!0,We()},ce=(H,j,q)=>{j.component=H;const pe=H.vnode.props;H.vnode=j,H.next=null,q4(H,j.props,pe,q),K4(H,j.children,q),Vu(),Lb(void 0,H.update),Oc()},oe=(H,j,q,pe,ee,te,Se,ke,Be=!1)=>{const We=H&&H.children,ve=H?H.shapeFlag:0,K=j.children,{patchFlag:J,shapeFlag:Ee}=j;if(J>0){if(J&128){_e(We,K,q,pe,ee,te,Se,ke,Be);return}else if(J&256){ge(We,K,q,pe,ee,te,Se,ke,Be);return}}Ee&8?(ve&16&&Me(We,ee,te),K!==We&&g(q,K)):ve&16?Ee&16?_e(We,K,q,pe,ee,te,Se,ke,Be):Me(We,ee,te,!0):(ve&8&&g(q,""),Ee&16&&Y(K,q,pe,ee,te,Se,ke,Be))},ge=(H,j,q,pe,ee,te,Se,ke,Be)=>{H=H||Uu,j=j||Uu;const We=H.length,ve=j.length,K=Math.min(We,ve);let J;for(J=0;J<K;J++){const Ee=j[J]=Be?Sl(j[J]):ns(j[J]);S(H[J],Ee,q,null,ee,te,Se,ke,Be)}We>ve?Me(H,ee,te,!0,!1,K):Y(j,q,pe,ee,te,Se,ke,Be,K)},_e=(H,j,q,pe,ee,te,Se,ke,Be)=>{let We=0;const ve=j.length;let K=H.length-1,J=ve-1;for(;We<=K&&We<=J;){const Ee=H[We],xe=j[We]=Be?Sl(j[We]):ns(j[We]);if(rd(Ee,xe))S(Ee,xe,q,null,ee,te,Se,ke,Be);else break;We++}for(;We<=K&&We<=J;){const Ee=H[K],xe=j[J]=Be?Sl(j[J]):ns(j[J]);if(rd(Ee,xe))S(Ee,xe,q,null,ee,te,Se,ke,Be);else break;K--,J--}if(We>K){if(We<=J){const Ee=J+1,xe=Ee<ve?j[Ee].el:pe;for(;We<=J;)S(null,j[We]=Be?Sl(j[We]):ns(j[We]),q,xe,ee,te,Se,ke,Be),We++}}else if(We>J)for(;We<=K;)Ie(H[We],ee,te,!0),We++;else{const Ee=We,xe=We,Je=new Map;for(We=xe;We<=J;We++){const Jt=j[We]=Be?Sl(j[We]):ns(j[We]);Jt.key!=null&&Je.set(Jt.key,We)}let Xe,Mt=0;const qe=J-xe+1;let It=!1,rn=0;const Yt=new Array(qe);for(We=0;We<qe;We++)Yt[We]=0;for(We=Ee;We<=K;We++){const Jt=H[We];if(Mt>=qe){Ie(Jt,ee,te,!0);continue}let Fn;if(Jt.key!=null)Fn=Je.get(Jt.key);else for(Xe=xe;Xe<=J;Xe++)if(Yt[Xe-xe]===0&&rd(Jt,j[Xe])){Fn=Xe;break}Fn===void 0?Ie(Jt,ee,te,!0):(Yt[Fn-xe]=We+1,Fn>=rn?rn=Fn:It=!0,S(Jt,j[Fn],q,null,ee,te,Se,ke,Be),Mt++)}const Tn=It?nB(Yt):Uu;for(Xe=Tn.length-1,We=qe-1;We>=0;We--){const Jt=xe+We,Fn=j[Jt],mr=Jt+1<ve?j[Jt+1].el:pe;Yt[We]===0?S(null,Fn,q,mr,ee,te,Se,ke,Be):It&&(Xe<0||We!==Tn[Xe]?Ne(Fn,q,mr,2):Xe--)}}},Ne=(H,j,q,pe,ee=null)=>{const{el:te,type:Se,transition:ke,children:Be,shapeFlag:We}=H;if(We&6){Ne(H.component.subTree,j,q,pe);return}if(We&128){H.suspense.move(j,q,pe);return}if(We&64){Se.move(H,j,q,ht);return}if(Se===co){a(te,j,q);for(let K=0;K<Be.length;K++)Ne(Be[K],j,q,pe);a(H.anchor,j,q);return}if(Se===Eb){L(H,j,q);return}if(pe!==2&&We&1&&ke)if(pe===0)ke.beforeEnter(te),a(te,j,q),Ca(()=>ke.enter(te),ee);else{const{leave:K,delayLeave:J,afterLeave:Ee}=ke,xe=()=>a(te,j,q),Je=()=>{K(te,()=>{xe(),Ee&&Ee()})};J?J(te,xe,Je):Je()}else a(te,j,q)},Ie=(H,j,q,pe=!1,ee=!1)=>{const{type:te,props:Se,ref:ke,children:Be,dynamicChildren:We,shapeFlag:ve,patchFlag:K,dirs:J}=H;if(ke!=null&&wb(ke,null,q,H,!0),ve&256){j.ctx.deactivate(H);return}const Ee=ve&1&&J,xe=!pb(H);let Je;if(xe&&(Je=Se&&Se.onVnodeBeforeUnmount)&&ts(Je,j,H),ve&6)Fe(H.component,q,pe);else{if(ve&128){H.suspense.unmount(q,pe);return}Ee&&Fc(H,null,j,"beforeUnmount"),ve&64?H.type.remove(H,j,q,ee,ht,pe):We&&(te!==co||K>0&&K&64)?Me(We,j,q,!1,!0):(te===co&&K&(128|256)||!ee&&ve&16)&&Me(Be,j,q),pe&&Ve(H)}(xe&&(Je=Se&&Se.onVnodeUnmounted)||Ee)&&Ca(()=>{Je&&ts(Je,j,H),Ee&&Fc(H,null,j,"unmounted")},q)},Ve=H=>{const{type:j,el:q,anchor:pe,transition:ee}=H;if(j===co){Le(q,pe);return}if(j===Eb){P(H);return}const te=()=>{s(q),ee&&!ee.persisted&&ee.afterLeave&&ee.afterLeave()};if(H.shapeFlag&1&&ee&&!ee.persisted){const{leave:Se,delayLeave:ke}=ee,Be=()=>Se(q,te);ke?ke(H.el,te,Be):Be()}else te()},Le=(H,j)=>{let q;for(;H!==j;)q=b(H),s(H),H=q;s(j)},Fe=(H,j,q)=>{const{bum:pe,scope:ee,update:te,subTree:Se,um:ke}=H;pe&&Qy(pe),ee.stop(),te&&(te.active=!1,Ie(Se,H,j,q)),ke&&Ca(ke,j),Ca(()=>{H.isUnmounted=!0},j),j&&j.pendingBranch&&!j.isUnmounted&&H.asyncDep&&!H.asyncResolved&&H.suspenseId===j.pendingId&&(j.deps--,j.deps===0&&j.resolve())},Me=(H,j,q,pe=!1,ee=!1,te=0)=>{for(let Se=te;Se<H.length;Se++)Ie(H[Se],j,q,pe,ee)},Qe=H=>H.shapeFlag&6?Qe(H.component.subTree):H.shapeFlag&128?H.suspense.next():b(H.anchor||H.el),mt=(H,j,q)=>{H==null?j._vnode&&Ie(j._vnode,null,null,!0):S(j._vnode||null,H,j,null,null,null,q),EM(),j._vnode=H},ht={p:S,um:Ie,m:Ne,r:Ve,mt:k,mc:Y,pc:oe,pbc:$,n:Qe,o:i};let ye,fe;return n&&([ye,fe]=n(ht)),{render:mt,hydrate:ye,createApp:J4(mt,ye)}}function wb(i,n,r,a,s=!1){if(wr(i)){i.forEach((b,w)=>wb(b,n&&(wr(n)?n[w]:n),r,a,s));return}if(pb(a)&&!s)return;const o=a.shapeFlag&4?Sb(a.component)||a.component.proxy:a.el,u=s?null:o,{i:f,r:v}=i,m=n&&n.r,g=f.refs===si?f.refs={}:f.refs,y=f.setupState;if(m!=null&&m!==v&&(Ji(m)?(g[m]=null,zr(y,m)&&(y[m]=null)):Sa(m)&&(m.value=null)),Ji(v)){const b=()=>{g[v]=u,zr(y,v)&&(y[v]=u)};u?(b.id=-1,Ca(b,r)):b()}else if(Sa(v)){const b=()=>{v.value=u};u?(b.id=-1,Ca(b,r)):b()}else Ar(v)&&Tl(v,f,12,[u,g])}function ts(i,n,r,a=null){Po(i,n,7,[r,a])}function iM(i,n,r=!1){const a=i.children,s=n.children;if(wr(a)&&wr(s))for(let o=0;o<a.length;o++){const u=a[o];let f=s[o];f.shapeFlag&1&&!f.dynamicChildren&&((f.patchFlag<=0||f.patchFlag===32)&&(f=s[o]=Sl(s[o]),f.el=u.el),r||iM(u,f))}}function nB(i){const n=i.slice(),r=[0];let a,s,o,u,f;const v=i.length;for(a=0;a<v;a++){const m=i[a];if(m!==0){if(s=r[r.length-1],i[s]<m){n[a]=s,r.push(a);continue}for(o=0,u=r.length-1;o<u;)f=o+u>>1,i[r[f]]<m?o=f+1:u=f;m<i[r[o]]&&(o>0&&(n[a]=r[o-1]),r[o]=a)}}for(o=r.length,u=r[o-1];o-- >0;)r[o]=u,u=n[u];return r}const rB=i=>i.__isTeleport,aM="components";function FZ(i,n){return aB(aM,i,!0,n)||i}const iB=Symbol();function aB(i,n,r=!0,a=!1){const s=lo||ea;if(s){const o=s.type;if(i===aM){const f=wB(o);if(f&&(f===n||f===Qo(n)||f===iv(Qo(n))))return o}const u=oM(s[i]||o[i],n)||oM(s.appContext[i],n);return!u&&a?o:u}}function oM(i,n){return i&&(i[n]||i[Qo(n)]||i[iv(Qo(n))])}const co=Symbol(void 0),Ab=Symbol(void 0),Ml=Symbol(void 0),Eb=Symbol(void 0),nd=[];let Bc=null;function ju(i=!1){nd.push(Bc=i?null:[])}function oB(){nd.pop(),Bc=nd[nd.length-1]||null}let gv=1;function sM(i){gv+=i}function lM(i){return i.dynamicChildren=gv>0?Bc||Uu:null,oB(),gv>0&&Bc&&Bc.push(i),i}function yv(i,n,r,a,s,o){return lM(hM(i,n,r,a,s,o,!0))}function cM(i,n,r,a,s){return lM(ka(i,n,r,a,s,!0))}function bv(i){return i?i.__v_isVNode===!0:!1}function rd(i,n){return i.type===n.type&&i.key===n.key}const xv="__vInternal",uM=({key:i})=>i!=null?i:null,wv=({ref:i})=>i!=null?Ji(i)||Sa(i)||Ar(i)?{i:lo,r:i}:i:null;function hM(i,n=null,r=null,a=0,s=null,o=i===co?0:1,u=!1,f=!1){const v={__v_isVNode:!0,__v_skip:!0,type:i,props:n,key:n&&uM(n),ref:n&&wv(n),scopeId:dv,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:o,patchFlag:a,dynamicProps:s,dynamicChildren:null,appContext:null};return f?(_b(v,r),o&128&&i.normalize(v)):r&&(v.shapeFlag|=Ji(r)?8:16),gv>0&&!u&&Bc&&(v.patchFlag>0||o&6)&&v.patchFlag!==32&&Bc.push(v),v}const ka=sB;function sB(i,n=null,r=null,a=0,s=null,o=!1){if((!i||i===iB)&&(i=Ml),bv(i)){const f=id(i,n,!0);return r&&_b(f,r),f}if(AB(i)&&(i=i.__vccOpts),n){n=lB(n);let{class:f,style:v}=n;f&&!Ji(f)&&(n.class=qy(f)),Gi(v)&&(D_(v)&&!wr(v)&&(v=Ma({},v)),n.style=Jm(v))}const u=Ji(i)?1:R4(i)?128:rB(i)?64:Gi(i)?4:Ar(i)?2:0;return hM(i,n,r,a,s,u,o,!0)}function lB(i){return i?D_(i)||xv in i?Ma({},i):i:null}function id(i,n,r=!1){const{props:a,ref:s,patchFlag:o,children:u}=i,f=n?hB(a||{},n):a;return{__v_isVNode:!0,__v_skip:!0,type:i.type,props:f,key:f&&uM(f),ref:n&&n.ref?r&&s?wr(s)?s.concat(wv(n)):[s,wv(n)]:wv(n):s,scopeId:i.scopeId,slotScopeIds:i.slotScopeIds,children:u,target:i.target,targetAnchor:i.targetAnchor,staticCount:i.staticCount,shapeFlag:i.shapeFlag,patchFlag:n&&i.type!==co?o===-1?16:o|16:o,dynamicProps:i.dynamicProps,dynamicChildren:i.dynamicChildren,appContext:i.appContext,dirs:i.dirs,transition:i.transition,component:i.component,suspense:i.suspense,ssContent:i.ssContent&&id(i.ssContent),ssFallback:i.ssFallback&&id(i.ssFallback),el:i.el,anchor:i.anchor}}function cB(i=" ",n=0){return ka(Ab,null,i,n)}function uB(i="",n=!1){return n?(ju(),cM(Ml,null,i)):ka(Ml,null,i)}function ns(i){return i==null||typeof i=="boolean"?ka(Ml):wr(i)?ka(co,null,i.slice()):typeof i=="object"?Sl(i):ka(Ab,null,String(i))}function Sl(i){return i.el===null||i.memo?i:id(i)}function _b(i,n){let r=0;const{shapeFlag:a}=i;if(n==null)n=null;else if(wr(n))r=16;else if(typeof n=="object")if(a&(1|64)){const s=n.default;s&&(s._c&&(s._d=!1),_b(i,s()),s._c&&(s._d=!0));return}else{r=32;const s=n._;!s&&!(xv in n)?n._ctx=lo:s===3&&lo&&(lo.slots._===1?n._=1:(n._=2,i.patchFlag|=1024))}else Ar(n)?(n={default:n,_ctx:lo},r=32):(n=String(n),a&64?(r=16,n=[cB(n)]):r=8);i.children=n,i.shapeFlag|=r}function hB(...i){const n={};for(let r=0;r<i.length;r++){const a=i[r];for(const s in a)if(s==="class")n.class!==a.class&&(n.class=qy([n.class,a.class]));else if(s==="style")n.style=Jm([n.style,a.style]);else if(ev(s)){const o=n[s],u=a[s];o!==u&&(n[s]=o?[].concat(o,u):u)}else s!==""&&(n[s]=a[s])}return n}function fB(i,n,r,a){let s;const o=r&&r[a];if(wr(i)||Ji(i)){s=new Array(i.length);for(let u=0,f=i.length;u<f;u++)s[u]=n(i[u],u,void 0,o&&o[u])}else if(typeof i=="number"){s=new Array(i);for(let u=0;u<i;u++)s[u]=n(u+1,u,void 0,o&&o[u])}else if(Gi(i))if(i[Symbol.iterator])s=Array.from(i,(u,f)=>n(u,f,void 0,o&&o[f]));else{const u=Object.keys(i);s=new Array(u.length);for(let f=0,v=u.length;f<v;f++){const m=u[f];s[f]=n(i[m],m,f,o&&o[f])}}else s=[];return r&&(r[a]=s),s}function fM(i,n,r={},a,s){if(lo.isCE)return ka("slot",n==="default"?null:{name:n},a&&a());let o=i[n];o&&o._c&&(o._d=!1),ju();const u=o&&dM(o(r)),f=cM(co,{key:r.key||`_${n}`},u||(a?a():[]),u&&i._===1?64:-2);return!s&&f.scopeId&&(f.slotScopeIds=[f.scopeId+"-s"]),o&&o._c&&(o._d=!0),f}function dM(i){return i.some(n=>bv(n)?!(n.type===Ml||n.type===co&&!dM(n.children)):!0)?i:null}const Mb=i=>i?pM(i)?Sb(i)||i.proxy:Mb(i.parent):null,Av=Ma(Object.create(null),{$:i=>i,$el:i=>i.vnode.el,$data:i=>i.data,$props:i=>i.props,$attrs:i=>i.attrs,$slots:i=>i.slots,$refs:i=>i.refs,$parent:i=>Mb(i.parent),$root:i=>Mb(i.root),$emit:i=>i.emit,$options:i=>X_(i),$forceUpdate:i=>()=>xM(i.update),$nextTick:i=>bM.bind(i.proxy),$watch:i=>CB.bind(i)}),dB={get({_:i},n){const{ctx:r,setupState:a,data:s,props:o,accessCache:u,type:f,appContext:v}=i;let m;if(n[0]!=="$"){const w=u[n];if(w!==void 0)switch(w){case 0:return a[n];case 1:return s[n];case 3:return r[n];case 2:return o[n]}else{if(a!==si&&zr(a,n))return u[n]=0,a[n];if(s!==si&&zr(s,n))return u[n]=1,s[n];if((m=i.propsOptions[0])&&zr(m,n))return u[n]=2,o[n];if(r!==si&&zr(r,n))return u[n]=3,r[n];gb&&(u[n]=4)}}const g=Av[n];let y,b;if(g)return n==="$attrs"&&Ka(i,"get",n),g(i);if((y=f.__cssModules)&&(y=y[n]))return y;if(r!==si&&zr(r,n))return u[n]=3,r[n];if(b=v.config.globalProperties,zr(b,n))return b[n]},set({_:i},n,r){const{data:a,setupState:s,ctx:o}=i;if(s!==si&&zr(s,n))s[n]=r;else if(a!==si&&zr(a,n))a[n]=r;else if(zr(i.props,n))return!1;return n[0]==="$"&&n.slice(1)in i?!1:(o[n]=r,!0)},has({_:{data:i,setupState:n,accessCache:r,ctx:a,appContext:s,propsOptions:o}},u){let f;return r[u]!==void 0||i!==si&&zr(i,u)||n!==si&&zr(n,u)||(f=o[0])&&zr(f,u)||zr(a,u)||zr(Av,u)||zr(s.config.globalProperties,u)}},pB=rM();let mB=0;function vB(i,n,r){const a=i.type,s=(n?n.appContext:i.appContext)||pB,o={uid:mB++,vnode:i,type:a,parent:n,appContext:s,root:null,next:null,subTree:null,update:null,scope:new GF(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:n?n.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:$_(a,s),emitsOptions:U_(a,s),emit:null,emitted:null,propsDefaults:si,inheritAttrs:a.inheritAttrs,ctx:si,data:si,props:si,attrs:si,slots:si,refs:si,setupState:si,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return o.ctx={_:o},o.root=n?n.root:o,o.emit=E4.bind(null,o),i.ce&&i.ce(o),o}let ea=null;const Xu=i=>{ea=i,i.scope.on()},Nc=()=>{ea&&ea.scope.off(),ea=null};function pM(i){return i.vnode.shapeFlag&4}let Ev=!1;function gB(i,n=!1){Ev=n;const{props:r,children:a}=i.vnode,s=pM(i);X4(i,r,s,n),$4(i,a);const o=s?yB(i,n):void 0;return Ev=!1,o}function yB(i,n){const r=i.type;i.accessCache=Object.create(null),i.proxy=O_(new Proxy(i.ctx,dB));const{setup:a}=r;if(a){const s=i.setupContext=a.length>1?xB(i):null;Xu(i),Vu();const o=Tl(a,i,0,[i.props,s]);if(Oc(),Nc(),u_(o)){if(o.then(Nc,Nc),n)return o.then(u=>{mM(i,u,n)}).catch(u=>{_v(u,i,0)});i.asyncDep=o}else mM(i,o,n)}else gM(i,n)}function mM(i,n,r){Ar(n)?i.type.__ssrInlineRender?i.ssrRender=n:i.render=n:Gi(n)&&(i.setupState=B_(n)),gM(i,r)}let vM;function gM(i,n,r){const a=i.type;if(!i.render){if(!n&&vM&&!a.render){const s=a.template;if(s){const{isCustomElement:o,compilerOptions:u}=i.appContext.config,{delimiters:f,compilerOptions:v}=a,m=Ma(Ma({isCustomElement:o,delimiters:f},u),v);a.render=vM(s,m)}}i.render=a.render||Lo}Xu(i),Vu(),z4(i),Oc(),Nc()}function bB(i){return new Proxy(i.attrs,{get(n,r){return Ka(i,"get","$attrs"),n[r]}})}function xB(i){const n=a=>{i.exposed=a||{}};let r;return{get attrs(){return r||(r=bB(i))},slots:i.slots,emit:i.emit,expose:n}}function Sb(i){if(i.exposed)return i.exposeProxy||(i.exposeProxy=new Proxy(B_(O_(i.exposed)),{get(n,r){if(r in n)return n[r];if(r in Av)return Av[r](i)}}))}function wB(i){return Ar(i)&&i.displayName||i.name}function AB(i){return Ar(i)&&"__vccOpts"in i}function Tl(i,n,r,a){let s;try{s=a?i(...a):i()}catch(o){_v(o,n,r)}return s}function Po(i,n,r,a){if(Ar(i)){const o=Tl(i,n,r,a);return o&&u_(o)&&o.catch(u=>{_v(u,n,r)}),o}const s=[];for(let o=0;o<i.length;o++)s.push(Po(i[o],n,r,a));return s}function _v(i,n,r,a=!0){const s=n?n.vnode:null;if(n){let o=n.parent;const u=n.proxy,f=r;for(;o;){const m=o.ec;if(m){for(let g=0;g<m.length;g++)if(m[g](i,u,f)===!1)return}o=o.parent}const v=n.appContext.config.errorHandler;if(v){Tl(v,null,10,[i,u,f]);return}}EB(i,r,s,a)}function EB(i,n,r,a=!0){console.error(i)}let Mv=!1,Tb=!1;const Za=[];let Os=0;const ad=[];let od=null,qu=0;const sd=[];let Cl=null,Yu=0;const yM=Promise.resolve();let Cb=null,Rb=null;function bM(i){const n=Cb||yM;return i?n.then(this?i.bind(this):i):n}function _B(i){let n=Os+1,r=Za.length;for(;n<r;){const a=n+r>>>1;ld(Za[a])<i?n=a+1:r=a}return n}function xM(i){(!Za.length||!Za.includes(i,Mv&&i.allowRecurse?Os+1:Os))&&i!==Rb&&(i.id==null?Za.push(i):Za.splice(_B(i.id),0,i),wM())}function wM(){!Mv&&!Tb&&(Tb=!0,Cb=yM.then(_M))}function MB(i){const n=Za.indexOf(i);n>Os&&Za.splice(n,1)}function AM(i,n,r,a){wr(i)?r.push(...i):(!n||!n.includes(i,i.allowRecurse?a+1:a))&&r.push(i),wM()}function SB(i){AM(i,od,ad,qu)}function TB(i){AM(i,Cl,sd,Yu)}function Lb(i,n=null){if(ad.length){for(Rb=n,od=[...new Set(ad)],ad.length=0,qu=0;qu<od.length;qu++)od[qu]();od=null,qu=0,Rb=null,Lb(i,n)}}function EM(i){if(sd.length){const n=[...new Set(sd)];if(sd.length=0,Cl){Cl.push(...n);return}for(Cl=n,Cl.sort((r,a)=>ld(r)-ld(a)),Yu=0;Yu<Cl.length;Yu++)Cl[Yu]();Cl=null,Yu=0}}const ld=i=>i.id==null?1/0:i.id;function _M(i){Tb=!1,Mv=!0,Lb(i),Za.sort((r,a)=>ld(r)-ld(a));const n=Lo;try{for(Os=0;Os<Za.length;Os++){const r=Za[Os];r&&r.active!==!1&&Tl(r,null,14)}}finally{Os=0,Za.length=0,EM(),Mv=!1,Cb=null,(Za.length||ad.length||sd.length)&&_M(i)}}function MM(i,n){return Pb(i,null,n)}const SM={};function cd(i,n,r){return Pb(i,n,r)}function Pb(i,n,{immediate:r,deep:a,flush:s,onTrack:o,onTrigger:u}=si){const f=ea;let v,m=!1,g=!1;if(Sa(i)?(v=()=>i.value,m=!!i._shallow):Wu(i)?(v=()=>i,a=!0):wr(i)?(g=!0,m=i.some(Wu),v=()=>i.map(E=>{if(Sa(E))return E.value;if(Wu(E))return Uc(E);if(Ar(E))return Tl(E,f,2)})):Ar(i)?n?v=()=>Tl(i,f,2):v=()=>{if(!(f&&f.isUnmounted))return y&&y(),Po(i,f,3,[b])}:v=Lo,n&&a){const E=v;v=()=>Uc(E())}let y,b=E=>{y=S.onStop=()=>{Tl(E,f,4)}};if(Ev)return b=Lo,n?r&&Po(n,f,3,[v(),g?[]:void 0,b]):v(),Lo;let w=g?[]:SM;const A=()=>{if(!!S.active)if(n){const E=S.run();(a||m||(g?E.some((T,C)=>$f(T,w[C])):$f(E,w)))&&(y&&y(),Po(n,f,3,[E,w===SM?void 0:w,b]),w=E)}else S.run()};A.allowRecurse=!!n;let M;s==="sync"?M=A:s==="post"?M=()=>Ca(A,f&&f.suspense):M=()=>{!f||f.isMounted?SB(A):A()};const S=new rb(v,M);return n?r?A():w=S.run():s==="post"?Ca(S.run.bind(S),f&&f.suspense):S.run(),()=>{S.stop(),f&&f.scope&&l_(f.scope.effects,S)}}function CB(i,n,r){const a=this.proxy,s=Ji(i)?i.includes(".")?TM(a,i):()=>a[i]:i.bind(a,a);let o;Ar(n)?o=n:(o=n.handler,r=n);const u=ea;Xu(this);const f=Pb(s,o.bind(a),r);return u?Xu(u):Nc(),f}function TM(i,n){const r=n.split(".");return()=>{let a=i;for(let s=0;s<r.length&&a;s++)a=a[r[s]];return a}}function Uc(i,n){if(!Gi(i)||i.__v_skip||(n=n||new Set,n.has(i)))return i;if(n.add(i),Sa(i))Uc(i.value,n);else if(wr(i))for(let r=0;r<i.length;r++)Uc(i[r],n);else if(c_(i)||Hu(i))i.forEach(r=>{Uc(r,n)});else if(f_(i))for(const r in i)Uc(i[r],n);return i}function Sv(i,n,r){const a=arguments.length;return a===2?Gi(n)&&!wr(n)?bv(n)?ka(i,null,[n]):ka(i,n):ka(i,null,n):(a>3?r=Array.prototype.slice.call(arguments,2):a===3&&bv(r)&&(r=[r]),ka(i,n,r))}const RB="3.2.21",LB="http://www.w3.org/2000/svg",$u=typeof document!="undefined"?document:null,CM=new Map,PB={insert:(i,n,r)=>{n.insertBefore(i,r||null)},remove:i=>{const n=i.parentNode;n&&n.removeChild(i)},createElement:(i,n,r,a)=>{const s=n?$u.createElementNS(LB,i):$u.createElement(i,r?{is:r}:void 0);return i==="select"&&a&&a.multiple!=null&&s.setAttribute("multiple",a.multiple),s},createText:i=>$u.createTextNode(i),createComment:i=>$u.createComment(i),setText:(i,n)=>{i.nodeValue=n},setElementText:(i,n)=>{i.textContent=n},parentNode:i=>i.parentNode,nextSibling:i=>i.nextSibling,querySelector:i=>$u.querySelector(i),setScopeId(i,n){i.setAttribute(n,"")},cloneNode(i){const n=i.cloneNode(!0);return"_value"in i&&(n._value=i._value),n},insertStaticContent(i,n,r,a){const s=r?r.previousSibling:n.lastChild;let o=CM.get(i);if(!o){const u=$u.createElement("template");if(u.innerHTML=a?`<svg>${i}</svg>`:i,o=u.content,a){const f=o.firstChild;for(;f.firstChild;)o.appendChild(f.firstChild);o.removeChild(f)}CM.set(i,o)}return n.insertBefore(o.cloneNode(!0),r),[s?s.nextSibling:n.firstChild,r?r.previousSibling:n.lastChild]}};function DB(i,n,r){const a=i._vtc;a&&(n=(n?[n,...a]:[...a]).join(" ")),n==null?i.removeAttribute("class"):r?i.setAttribute("class",n):i.className=n}function OB(i,n,r){const a=i.style,s=Ji(r);if(r&&!s){for(const o in r)Db(a,o,r[o]);if(n&&!Ji(n))for(const o in n)r[o]==null&&Db(a,o,"")}else{const o=a.display;s?n!==r&&(a.cssText=r):n&&i.removeAttribute("style"),"_vod"in i&&(a.display=o)}}const RM=/\s*!important$/;function Db(i,n,r){if(wr(r))r.forEach(a=>Db(i,n,a));else if(n.startsWith("--"))i.setProperty(n,r);else{const a=IB(i,n);RM.test(r)?i.setProperty(zu(a),r.replace(RM,""),"important"):i[a]=r}}const LM=["Webkit","Moz","ms"],Ob={};function IB(i,n){const r=Ob[n];if(r)return r;let a=Qo(n);if(a!=="filter"&&a in i)return Ob[n]=a;a=iv(a);for(let s=0;s<LM.length;s++){const o=LM[s]+a;if(o in i)return Ob[n]=o}return n}const PM="http://www.w3.org/1999/xlink";function kB(i,n,r,a,s){if(a&&n.startsWith("xlink:"))r==null?i.removeAttributeNS(PM,n.slice(6,n.length)):i.setAttributeNS(PM,n,r);else{const o=RF(n);r==null||o&&!o_(r)?i.removeAttribute(n):i.setAttribute(n,o?"":r)}}function FB(i,n,r,a,s,o,u){if(n==="innerHTML"||n==="textContent"){a&&u(a,s,o),i[n]=r==null?"":r;return}if(n==="value"&&i.tagName!=="PROGRESS"){i._value=r;const f=r==null?"":r;i.value!==f&&(i.value=f),r==null&&i.removeAttribute(n);return}if(r===""||r==null){const f=typeof i[n];if(f==="boolean"){i[n]=o_(r);return}else if(r==null&&f==="string"){i[n]="",i.removeAttribute(n);return}else if(f==="number"){try{i[n]=0}catch{}i.removeAttribute(n);return}}try{i[n]=r}catch{}}let Tv=Date.now,DM=!1;if(typeof window!="undefined"){Tv()>document.createEvent("Event").timeStamp&&(Tv=()=>performance.now());const i=navigator.userAgent.match(/firefox\/(\d+)/i);DM=!!(i&&Number(i[1])<=53)}let Ib=0;const BB=Promise.resolve(),NB=()=>{Ib=0},UB=()=>Ib||(BB.then(NB),Ib=Tv());function HB(i,n,r,a){i.addEventListener(n,r,a)}function zB(i,n,r,a){i.removeEventListener(n,r,a)}function GB(i,n,r,a,s=null){const o=i._vei||(i._vei={}),u=o[n];if(a&&u)u.value=a;else{const[f,v]=VB(n);if(a){const m=o[n]=WB(a,s);HB(i,f,m,v)}else u&&(zB(i,f,u,v),o[n]=void 0)}}const OM=/(?:Once|Passive|Capture)$/;function VB(i){let n;if(OM.test(i)){n={};let r;for(;r=i.match(OM);)i=i.slice(0,i.length-r[0].length),n[r[0].toLowerCase()]=!0}return[zu(i.slice(2)),n]}function WB(i,n){const r=a=>{const s=a.timeStamp||Tv();(DM||s>=r.attached-1)&&Po(jB(a,r.value),n,5,[a])};return r.value=i,r.attached=UB(),r}function jB(i,n){if(wr(n)){const r=i.stopImmediatePropagation;return i.stopImmediatePropagation=()=>{r.call(i),i._stopped=!0},n.map(a=>s=>!s._stopped&&a(s))}else return n}const IM=/^on[a-z]/,XB=(i,n,r,a,s=!1,o,u,f,v)=>{n==="class"?DB(i,a,s):n==="style"?OB(i,r,a):ev(n)?Yy(n)||GB(i,n,r,a,u):(n[0]==="."?(n=n.slice(1),!0):n[0]==="^"?(n=n.slice(1),!1):qB(i,n,a,s))?FB(i,n,a,o,u,f,v):(n==="true-value"?i._trueValue=a:n==="false-value"&&(i._falseValue=a),kB(i,n,a,s))};function qB(i,n,r,a){return a?!!(n==="innerHTML"||n==="textContent"||n in i&&IM.test(n)&&Ar(r)):n==="spellcheck"||n==="draggable"||n==="form"||n==="list"&&i.tagName==="INPUT"||n==="type"&&i.tagName==="TEXTAREA"||IM.test(n)&&Ji(r)?!1:n in i}const YB=["ctrl","shift","alt","meta"],$B={stop:i=>i.stopPropagation(),prevent:i=>i.preventDefault(),self:i=>i.target!==i.currentTarget,ctrl:i=>!i.ctrlKey,shift:i=>!i.shiftKey,alt:i=>!i.altKey,meta:i=>!i.metaKey,left:i=>"button"in i&&i.button!==0,middle:i=>"button"in i&&i.button!==1,right:i=>"button"in i&&i.button!==2,exact:(i,n)=>YB.some(r=>i[`${r}Key`]&&!n.includes(r))},KB=(i,n)=>(r,...a)=>{for(let s=0;s<n.length;s++){const o=$B[n[s]];if(o&&o(r,n))return}return i(r,...a)},ZB={beforeMount(i,{value:n},{transition:r}){i._vod=i.style.display==="none"?"":i.style.display,r&&n?r.beforeEnter(i):ud(i,n)},mounted(i,{value:n},{transition:r}){r&&n&&r.enter(i)},updated(i,{value:n,oldValue:r},{transition:a}){!n!=!r&&(a?n?(a.beforeEnter(i),ud(i,!0),a.enter(i)):a.leave(i,()=>{ud(i,!1)}):ud(i,n))},beforeUnmount(i,{value:n}){ud(i,n)}};function ud(i,n){i.style.display=n?i._vod:"none"}const QB=Ma({patchProp:XB},PB);let kM;function JB(){return kM||(kM=eB(QB))}const BZ=(...i)=>{const n=JB().createApp(...i),{mount:r}=n;return n.mount=a=>{const s=e5(a);if(!s)return;const o=n._component;!Ar(o)&&!o.render&&!o.template&&(o.template=s.innerHTML),s.innerHTML="";const u=r(s,!1,s instanceof SVGElement);return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),u},n};function e5(i){return Ji(i)?document.querySelector(i):i}/*!
  * vue-router v4.0.12
  * (c) 2021 Eduardo San Martin Morote
  * @license MIT
  */const FM=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",Ku=i=>FM?Symbol(i):"_vr_"+i,t5=Ku("rvlm"),BM=Ku("rvd"),Cv=Ku("r"),NM=Ku("rl"),kb=Ku("rvl"),Zu=typeof window!="undefined";function n5(i){return i.__esModule||FM&&i[Symbol.toStringTag]==="Module"}const li=Object.assign;function Fb(i,n){const r={};for(const a in n){const s=n[a];r[a]=Array.isArray(s)?s.map(i):i(s)}return r}const hd=()=>{},r5=/\/$/,i5=i=>i.replace(r5,"");function Bb(i,n,r="/"){let a,s={},o="",u="";const f=n.indexOf("?"),v=n.indexOf("#",f>-1?f:0);return f>-1&&(a=n.slice(0,f),o=n.slice(f+1,v>-1?v:n.length),s=i(o)),v>-1&&(a=a||n.slice(0,v),u=n.slice(v,n.length)),a=l5(a!=null?a:n,r),{fullPath:a+(o&&"?")+o+u,path:a,query:s,hash:u}}function a5(i,n){const r=n.query?i(n.query):"";return n.path+(r&&"?")+r+(n.hash||"")}function UM(i,n){return!n||!i.toLowerCase().startsWith(n.toLowerCase())?i:i.slice(n.length)||"/"}function o5(i,n,r){const a=n.matched.length-1,s=r.matched.length-1;return a>-1&&a===s&&Qu(n.matched[a],r.matched[s])&&HM(n.params,r.params)&&i(n.query)===i(r.query)&&n.hash===r.hash}function Qu(i,n){return(i.aliasOf||i)===(n.aliasOf||n)}function HM(i,n){if(Object.keys(i).length!==Object.keys(n).length)return!1;for(const r in i)if(!s5(i[r],n[r]))return!1;return!0}function s5(i,n){return Array.isArray(i)?zM(i,n):Array.isArray(n)?zM(n,i):i===n}function zM(i,n){return Array.isArray(n)?i.length===n.length&&i.every((r,a)=>r===n[a]):i.length===1&&i[0]===n}function l5(i,n){if(i.startsWith("/"))return i;if(!i)return n;const r=n.split("/"),a=i.split("/");let s=r.length-1,o,u;for(o=0;o<a.length;o++)if(u=a[o],!(s===1||u==="."))if(u==="..")s--;else break;return r.slice(0,s).join("/")+"/"+a.slice(o-(o===a.length?1:0)).join("/")}var fd;(function(i){i.pop="pop",i.push="push"})(fd||(fd={}));var dd;(function(i){i.back="back",i.forward="forward",i.unknown=""})(dd||(dd={}));function c5(i){if(!i)if(Zu){const n=document.querySelector("base");i=n&&n.getAttribute("href")||"/",i=i.replace(/^\w+:\/\/[^\/]+/,"")}else i="/";return i[0]!=="/"&&i[0]!=="#"&&(i="/"+i),i5(i)}const u5=/^[^#]+#/;function h5(i,n){return i.replace(u5,"#")+n}function f5(i,n){const r=document.documentElement.getBoundingClientRect(),a=i.getBoundingClientRect();return{behavior:n.behavior,left:a.left-r.left-(n.left||0),top:a.top-r.top-(n.top||0)}}const Rv=()=>({left:window.pageXOffset,top:window.pageYOffset});function d5(i){let n;if("el"in i){const r=i.el,a=typeof r=="string"&&r.startsWith("#"),s=typeof r=="string"?a?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!s)return;n=f5(s,i)}else n=i;"scrollBehavior"in document.documentElement.style?window.scrollTo(n):window.scrollTo(n.left!=null?n.left:window.pageXOffset,n.top!=null?n.top:window.pageYOffset)}function GM(i,n){return(history.state?history.state.position-n:-1)+i}const Nb=new Map;function p5(i,n){Nb.set(i,n)}function m5(i){const n=Nb.get(i);return Nb.delete(i),n}let v5=()=>location.protocol+"//"+location.host;function VM(i,n){const{pathname:r,search:a,hash:s}=n,o=i.indexOf("#");if(o>-1){let f=s.includes(i.slice(o))?i.slice(o).length:1,v=s.slice(f);return v[0]!=="/"&&(v="/"+v),UM(v,"")}return UM(r,i)+a+s}function g5(i,n,r,a){let s=[],o=[],u=null;const f=({state:b})=>{const w=VM(i,location),A=r.value,M=n.value;let S=0;if(b){if(r.value=w,n.value=b,u&&u===A){u=null;return}S=M?b.position-M.position:0}else a(w);s.forEach(E=>{E(r.value,A,{delta:S,type:fd.pop,direction:S?S>0?dd.forward:dd.back:dd.unknown})})};function v(){u=r.value}function m(b){s.push(b);const w=()=>{const A=s.indexOf(b);A>-1&&s.splice(A,1)};return o.push(w),w}function g(){const{history:b}=window;!b.state||b.replaceState(li({},b.state,{scroll:Rv()}),"")}function y(){for(const b of o)b();o=[],window.removeEventListener("popstate",f),window.removeEventListener("beforeunload",g)}return window.addEventListener("popstate",f),window.addEventListener("beforeunload",g),{pauseListeners:v,listen:m,destroy:y}}function WM(i,n,r,a=!1,s=!1){return{back:i,current:n,forward:r,replaced:a,position:window.history.length,scroll:s?Rv():null}}function y5(i){const{history:n,location:r}=window,a={value:VM(i,r)},s={value:n.state};s.value||o(a.value,{back:null,current:a.value,forward:null,position:n.length-1,replaced:!0,scroll:null},!0);function o(v,m,g){const y=i.indexOf("#"),b=y>-1?(r.host&&document.querySelector("base")?i:i.slice(y))+v:v5()+i+v;try{n[g?"replaceState":"pushState"](m,"",b),s.value=m}catch(w){console.error(w),r[g?"replace":"assign"](b)}}function u(v,m){const g=li({},n.state,WM(s.value.back,v,s.value.forward,!0),m,{position:s.value.position});o(v,g,!0),a.value=v}function f(v,m){const g=li({},s.value,n.state,{forward:v,scroll:Rv()});o(g.current,g,!0);const y=li({},WM(a.value,v,null),{position:g.position+1},m);o(v,y,!1),a.value=v}return{location:a,state:s,push:f,replace:u}}function NZ(i){i=c5(i);const n=y5(i),r=g5(i,n.state,n.location,n.replace);function a(o,u=!0){u||r.pauseListeners(),history.go(o)}const s=li({location:"",base:i,go:a,createHref:h5.bind(null,i)},n,r);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>n.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>n.state.value}),s}function b5(i){return typeof i=="string"||i&&typeof i=="object"}function jM(i){return typeof i=="string"||typeof i=="symbol"}const Rl={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},XM=Ku("nf");var qM;(function(i){i[i.aborted=4]="aborted",i[i.cancelled=8]="cancelled",i[i.duplicated=16]="duplicated"})(qM||(qM={}));function Ju(i,n){return li(new Error,{type:i,[XM]:!0},n)}function Hc(i,n){return i instanceof Error&&XM in i&&(n==null||!!(i.type&n))}const YM="[^/]+?",x5={sensitive:!1,strict:!1,start:!0,end:!0},w5=/[.+*?^${}()[\]/\\]/g;function A5(i,n){const r=li({},x5,n),a=[];let s=r.start?"^":"";const o=[];for(const m of i){const g=m.length?[]:[90];r.strict&&!m.length&&(s+="/");for(let y=0;y<m.length;y++){const b=m[y];let w=40+(r.sensitive?.25:0);if(b.type===0)y||(s+="/"),s+=b.value.replace(w5,"\\$&"),w+=40;else if(b.type===1){const{value:A,repeatable:M,optional:S,regexp:E}=b;o.push({name:A,repeatable:M,optional:S});const T=E||YM;if(T!==YM){w+=10;try{new RegExp(`(${T})`)}catch(L){throw new Error(`Invalid custom RegExp for param "${A}" (${T}): `+L.message)}}let C=M?`((?:${T})(?:/(?:${T}))*)`:`(${T})`;y||(C=S&&m.length<2?`(?:/${C})`:"/"+C),S&&(C+="?"),s+=C,w+=20,S&&(w+=-8),M&&(w+=-20),T===".*"&&(w+=-50)}g.push(w)}a.push(g)}if(r.strict&&r.end){const m=a.length-1;a[m][a[m].length-1]+=.7000000000000001}r.strict||(s+="/?"),r.end?s+="$":r.strict&&(s+="(?:/|$)");const u=new RegExp(s,r.sensitive?"":"i");function f(m){const g=m.match(u),y={};if(!g)return null;for(let b=1;b<g.length;b++){const w=g[b]||"",A=o[b-1];y[A.name]=w&&A.repeatable?w.split("/"):w}return y}function v(m){let g="",y=!1;for(const b of i){(!y||!g.endsWith("/"))&&(g+="/"),y=!1;for(const w of b)if(w.type===0)g+=w.value;else if(w.type===1){const{value:A,repeatable:M,optional:S}=w,E=A in m?m[A]:"";if(Array.isArray(E)&&!M)throw new Error(`Provided param "${A}" is an array but it is not repeatable (* or + modifiers)`);const T=Array.isArray(E)?E.join("/"):E;if(!T)if(S)b.length<2&&(g.endsWith("/")?g=g.slice(0,-1):y=!0);else throw new Error(`Missing required param "${A}"`);g+=T}}return g}return{re:u,score:a,keys:o,parse:f,stringify:v}}function E5(i,n){let r=0;for(;r<i.length&&r<n.length;){const a=n[r]-i[r];if(a)return a;r++}return i.length<n.length?i.length===1&&i[0]===40+40?-1:1:i.length>n.length?n.length===1&&n[0]===40+40?1:-1:0}function _5(i,n){let r=0;const a=i.score,s=n.score;for(;r<a.length&&r<s.length;){const o=E5(a[r],s[r]);if(o)return o;r++}return s.length-a.length}const M5={type:0,value:""},S5=/[a-zA-Z0-9_]/;function T5(i){if(!i)return[[]];if(i==="/")return[[M5]];if(!i.startsWith("/"))throw new Error(`Invalid path "${i}"`);function n(w){throw new Error(`ERR (${r})/"${m}": ${w}`)}let r=0,a=r;const s=[];let o;function u(){o&&s.push(o),o=[]}let f=0,v,m="",g="";function y(){!m||(r===0?o.push({type:0,value:m}):r===1||r===2||r===3?(o.length>1&&(v==="*"||v==="+")&&n(`A repeatable param (${m}) must be alone in its segment. eg: '/:ids+.`),o.push({type:1,value:m,regexp:g,repeatable:v==="*"||v==="+",optional:v==="*"||v==="?"})):n("Invalid state to consume buffer"),m="")}function b(){m+=v}for(;f<i.length;){if(v=i[f++],v==="\\"&&r!==2){a=r,r=4;continue}switch(r){case 0:v==="/"?(m&&y(),u()):v===":"?(y(),r=1):b();break;case 4:b(),r=a;break;case 1:v==="("?r=2:S5.test(v)?b():(y(),r=0,v!=="*"&&v!=="?"&&v!=="+"&&f--);break;case 2:v===")"?g[g.length-1]=="\\"?g=g.slice(0,-1)+v:r=3:g+=v;break;case 3:y(),r=0,v!=="*"&&v!=="?"&&v!=="+"&&f--,g="";break;default:n("Unknown state");break}}return r===2&&n(`Unfinished custom RegExp for param "${m}"`),y(),u(),s}function C5(i,n,r){const a=A5(T5(i.path),r),s=li(a,{record:i,parent:n,children:[],alias:[]});return n&&!s.record.aliasOf==!n.record.aliasOf&&n.children.push(s),s}function R5(i,n){const r=[],a=new Map;n=KM({strict:!1,end:!0,sensitive:!1},n);function s(g){return a.get(g)}function o(g,y,b){const w=!b,A=P5(g);A.aliasOf=b&&b.record;const M=KM(n,g),S=[A];if("alias"in g){const C=typeof g.alias=="string"?[g.alias]:g.alias;for(const L of C)S.push(li({},A,{components:b?b.record.components:A.components,path:L,aliasOf:b?b.record:A}))}let E,T;for(const C of S){const{path:L}=C;if(y&&L[0]!=="/"){const P=y.record.path,N=P[P.length-1]==="/"?"":"/";C.path=y.record.path+(L&&N+L)}if(E=C5(C,y,M),b?b.alias.push(E):(T=T||E,T!==E&&T.alias.push(E),w&&g.name&&!$M(E)&&u(g.name)),"children"in A){const P=A.children;for(let N=0;N<P.length;N++)o(P[N],E,b&&b.children[N])}b=b||E,v(E)}return T?()=>{u(T)}:hd}function u(g){if(jM(g)){const y=a.get(g);y&&(a.delete(g),r.splice(r.indexOf(y),1),y.children.forEach(u),y.alias.forEach(u))}else{const y=r.indexOf(g);y>-1&&(r.splice(y,1),g.record.name&&a.delete(g.record.name),g.children.forEach(u),g.alias.forEach(u))}}function f(){return r}function v(g){let y=0;for(;y<r.length&&_5(g,r[y])>=0;)y++;r.splice(y,0,g),g.record.name&&!$M(g)&&a.set(g.record.name,g)}function m(g,y){let b,w={},A,M;if("name"in g&&g.name){if(b=a.get(g.name),!b)throw Ju(1,{location:g});M=b.record.name,w=li(L5(y.params,b.keys.filter(T=>!T.optional).map(T=>T.name)),g.params),A=b.stringify(w)}else if("path"in g)A=g.path,b=r.find(T=>T.re.test(A)),b&&(w=b.parse(A),M=b.record.name);else{if(b=y.name?a.get(y.name):r.find(T=>T.re.test(y.path)),!b)throw Ju(1,{location:g,currentLocation:y});M=b.record.name,w=li({},y.params,g.params),A=b.stringify(w)}const S=[];let E=b;for(;E;)S.unshift(E.record),E=E.parent;return{name:M,path:A,params:w,matched:S,meta:O5(S)}}return i.forEach(g=>o(g)),{addRoute:o,resolve:m,removeRoute:u,getRoutes:f,getRecordMatcher:s}}function L5(i,n){const r={};for(const a of n)a in i&&(r[a]=i[a]);return r}function P5(i){return{path:i.path,redirect:i.redirect,name:i.name,meta:i.meta||{},aliasOf:void 0,beforeEnter:i.beforeEnter,props:D5(i),children:i.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in i?i.components||{}:{default:i.component}}}function D5(i){const n={},r=i.props||!1;if("component"in i)n.default=r;else for(const a in i.components)n[a]=typeof r=="boolean"?r:r[a];return n}function $M(i){for(;i;){if(i.record.aliasOf)return!0;i=i.parent}return!1}function O5(i){return i.reduce((n,r)=>li(n,r.meta),{})}function KM(i,n){const r={};for(const a in i)r[a]=a in n?n[a]:i[a];return r}const ZM=/#/g,I5=/&/g,k5=/\//g,F5=/=/g,B5=/\?/g,QM=/\+/g,N5=/%5B/g,U5=/%5D/g,JM=/%5E/g,H5=/%60/g,eS=/%7B/g,z5=/%7C/g,tS=/%7D/g,G5=/%20/g;function Ub(i){return encodeURI(""+i).replace(z5,"|").replace(N5,"[").replace(U5,"]")}function V5(i){return Ub(i).replace(eS,"{").replace(tS,"}").replace(JM,"^")}function Hb(i){return Ub(i).replace(QM,"%2B").replace(G5,"+").replace(ZM,"%23").replace(I5,"%26").replace(H5,"`").replace(eS,"{").replace(tS,"}").replace(JM,"^")}function W5(i){return Hb(i).replace(F5,"%3D")}function j5(i){return Ub(i).replace(ZM,"%23").replace(B5,"%3F")}function X5(i){return i==null?"":j5(i).replace(k5,"%2F")}function Lv(i){try{return decodeURIComponent(""+i)}catch{}return""+i}function q5(i){const n={};if(i===""||i==="?")return n;const a=(i[0]==="?"?i.slice(1):i).split("&");for(let s=0;s<a.length;++s){const o=a[s].replace(QM," "),u=o.indexOf("="),f=Lv(u<0?o:o.slice(0,u)),v=u<0?null:Lv(o.slice(u+1));if(f in n){let m=n[f];Array.isArray(m)||(m=n[f]=[m]),m.push(v)}else n[f]=v}return n}function nS(i){let n="";for(let r in i){const a=i[r];if(r=W5(r),a==null){a!==void 0&&(n+=(n.length?"&":"")+r);continue}(Array.isArray(a)?a.map(o=>o&&Hb(o)):[a&&Hb(a)]).forEach(o=>{o!==void 0&&(n+=(n.length?"&":"")+r,o!=null&&(n+="="+o))})}return n}function Y5(i){const n={};for(const r in i){const a=i[r];a!==void 0&&(n[r]=Array.isArray(a)?a.map(s=>s==null?null:""+s):a==null?a:""+a)}return n}function pd(){let i=[];function n(a){return i.push(a),()=>{const s=i.indexOf(a);s>-1&&i.splice(s,1)}}function r(){i=[]}return{add:n,list:()=>i,reset:r}}function Ll(i,n,r,a,s){const o=a&&(a.enterCallbacks[s]=a.enterCallbacks[s]||[]);return()=>new Promise((u,f)=>{const v=y=>{y===!1?f(Ju(4,{from:r,to:n})):y instanceof Error?f(y):b5(y)?f(Ju(2,{from:n,to:y})):(o&&a.enterCallbacks[s]===o&&typeof y=="function"&&o.push(y),u())},m=i.call(a&&a.instances[s],n,r,v);let g=Promise.resolve(m);i.length<3&&(g=g.then(v)),g.catch(y=>f(y))})}function zb(i,n,r,a){const s=[];for(const o of i)for(const u in o.components){let f=o.components[u];if(!(n!=="beforeRouteEnter"&&!o.instances[u]))if($5(f)){const m=(f.__vccOpts||f)[n];m&&s.push(Ll(m,r,a,o,u))}else{let v=f();s.push(()=>v.then(m=>{if(!m)return Promise.reject(new Error(`Couldn't resolve component "${u}" at "${o.path}"`));const g=n5(m)?m.default:m;o.components[u]=g;const b=(g.__vccOpts||g)[n];return b&&Ll(b,r,a,o,u)()}))}}return s}function $5(i){return typeof i=="object"||"displayName"in i||"props"in i||"__vccOpts"in i}function rS(i){const n=es(Cv),r=es(NM),a=Jo(()=>n.resolve(Jf(i.to))),s=Jo(()=>{const{matched:v}=a.value,{length:m}=v,g=v[m-1],y=r.matched;if(!g||!y.length)return-1;const b=y.findIndex(Qu.bind(null,g));if(b>-1)return b;const w=iS(v[m-2]);return m>1&&iS(g)===w&&y[y.length-1].path!==w?y.findIndex(Qu.bind(null,v[m-2])):b}),o=Jo(()=>s.value>-1&&J5(r.params,a.value.params)),u=Jo(()=>s.value>-1&&s.value===r.matched.length-1&&HM(r.params,a.value.params));function f(v={}){return Q5(v)?n[Jf(i.replace)?"replace":"push"](Jf(i.to)).catch(hd):Promise.resolve()}return{route:a,href:Jo(()=>a.value.href),isActive:o,isExactActive:u,navigate:f}}const K5=td({name:"RouterLink",props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:rS,setup(i,{slots:n}){const r=Ic(rS(i)),{options:a}=es(Cv),s=Jo(()=>({[aS(i.activeClass,a.linkActiveClass,"router-link-active")]:r.isActive,[aS(i.exactActiveClass,a.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const o=n.default&&n.default(r);return i.custom?o:Sv("a",{"aria-current":r.isExactActive?i.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:s.value},o)}}}),Z5=K5;function Q5(i){if(!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)&&!i.defaultPrevented&&!(i.button!==void 0&&i.button!==0)){if(i.currentTarget&&i.currentTarget.getAttribute){const n=i.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(n))return}return i.preventDefault&&i.preventDefault(),!0}}function J5(i,n){for(const r in n){const a=n[r],s=i[r];if(typeof a=="string"){if(a!==s)return!1}else if(!Array.isArray(s)||s.length!==a.length||a.some((o,u)=>o!==s[u]))return!1}return!0}function iS(i){return i?i.aliasOf?i.aliasOf.path:i.path:""}const aS=(i,n,r)=>i!=null?i:n!=null?n:r,eN=td({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},setup(i,{attrs:n,slots:r}){const a=es(kb),s=Jo(()=>i.route||a.value),o=es(BM,0),u=Jo(()=>s.value.matched[o]);ed(BM,o+1),ed(t5,u),ed(kb,s);const f=hb();return cd(()=>[f.value,u.value,i.name],([v,m,g],[y,b,w])=>{m&&(m.instances[g]=v,b&&b!==m&&v&&v===y&&(m.leaveGuards.size||(m.leaveGuards=b.leaveGuards),m.updateGuards.size||(m.updateGuards=b.updateGuards))),v&&m&&(!b||!Qu(m,b)||!y)&&(m.enterCallbacks[g]||[]).forEach(A=>A(v))},{flush:"post"}),()=>{const v=s.value,m=u.value,g=m&&m.components[i.name],y=i.name;if(!g)return oS(r.default,{Component:g,route:v});const b=m.props[i.name],w=b?b===!0?v.params:typeof b=="function"?b(v):b:null,M=Sv(g,li({},w,n,{onVnodeUnmounted:S=>{S.component.isUnmounted&&(m.instances[y]=null)},ref:f}));return oS(r.default,{Component:M,route:v})||M}}});function oS(i,n){if(!i)return null;const r=i(n);return r.length===1?r[0]:r}const tN=eN;function UZ(i){const n=R5(i.routes,i),r=i.parseQuery||q5,a=i.stringifyQuery||nS,s=i.history,o=pd(),u=pd(),f=pd(),v=g4(Rl);let m=Rl;Zu&&i.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const g=Fb.bind(null,Le=>""+Le),y=Fb.bind(null,X5),b=Fb.bind(null,Lv);function w(Le,Fe){let Me,Qe;return jM(Le)?(Me=n.getRecordMatcher(Le),Qe=Fe):Qe=Le,n.addRoute(Qe,Me)}function A(Le){const Fe=n.getRecordMatcher(Le);Fe&&n.removeRoute(Fe)}function M(){return n.getRoutes().map(Le=>Le.record)}function S(Le){return!!n.getRecordMatcher(Le)}function E(Le,Fe){if(Fe=li({},Fe||v.value),typeof Le=="string"){const fe=Bb(r,Le,Fe.path),H=n.resolve({path:fe.path},Fe),j=s.createHref(fe.fullPath);return li(fe,H,{params:b(H.params),hash:Lv(fe.hash),redirectedFrom:void 0,href:j})}let Me;if("path"in Le)Me=li({},Le,{path:Bb(r,Le.path,Fe.path).path});else{const fe=li({},Le.params);for(const H in fe)fe[H]==null&&delete fe[H];Me=li({},Le,{params:y(Le.params)}),Fe.params=y(Fe.params)}const Qe=n.resolve(Me,Fe),mt=Le.hash||"";Qe.params=g(b(Qe.params));const ht=a5(a,li({},Le,{hash:V5(mt),path:Qe.path})),ye=s.createHref(ht);return li({fullPath:ht,hash:mt,query:a===nS?Y5(Le.query):Le.query||{}},Qe,{redirectedFrom:void 0,href:ye})}function T(Le){return typeof Le=="string"?Bb(r,Le,v.value.path):li({},Le)}function C(Le,Fe){if(m!==Le)return Ju(8,{from:Fe,to:Le})}function L(Le){return F(Le)}function P(Le){return L(li(T(Le),{replace:!0}))}function N(Le){const Fe=Le.matched[Le.matched.length-1];if(Fe&&Fe.redirect){const{redirect:Me}=Fe;let Qe=typeof Me=="function"?Me(Le):Me;return typeof Qe=="string"&&(Qe=Qe.includes("?")||Qe.includes("#")?Qe=T(Qe):{path:Qe},Qe.params={}),li({query:Le.query,hash:Le.hash,params:Le.params},Qe)}}function F(Le,Fe){const Me=m=E(Le),Qe=v.value,mt=Le.state,ht=Le.force,ye=Le.replace===!0,fe=N(Me);if(fe)return F(li(T(fe),{state:mt,force:ht,replace:ye}),Fe||Me);const H=Me;H.redirectedFrom=Fe;let j;return!ht&&o5(a,Qe,Me)&&(j=Ju(16,{to:H,from:Qe}),ge(Qe,Qe,!0,!1)),(j?Promise.resolve(j):Y(H,Qe)).catch(q=>Hc(q)?q:W(q,H,Qe)).then(q=>{if(q){if(Hc(q,2))return F(li(T(q.to),{state:mt,force:ht,replace:ye}),Fe||H)}else q=$(H,Qe,!0,ye,mt);return ae(H,Qe,q),q})}function X(Le,Fe){const Me=C(Le,Fe);return Me?Promise.reject(Me):Promise.resolve()}function Y(Le,Fe){let Me;const[Qe,mt,ht]=nN(Le,Fe);Me=zb(Qe.reverse(),"beforeRouteLeave",Le,Fe);for(const fe of Qe)fe.leaveGuards.forEach(H=>{Me.push(Ll(H,Le,Fe))});const ye=X.bind(null,Le,Fe);return Me.push(ye),eh(Me).then(()=>{Me=[];for(const fe of o.list())Me.push(Ll(fe,Le,Fe));return Me.push(ye),eh(Me)}).then(()=>{Me=zb(mt,"beforeRouteUpdate",Le,Fe);for(const fe of mt)fe.updateGuards.forEach(H=>{Me.push(Ll(H,Le,Fe))});return Me.push(ye),eh(Me)}).then(()=>{Me=[];for(const fe of Le.matched)if(fe.beforeEnter&&!Fe.matched.includes(fe))if(Array.isArray(fe.beforeEnter))for(const H of fe.beforeEnter)Me.push(Ll(H,Le,Fe));else Me.push(Ll(fe.beforeEnter,Le,Fe));return Me.push(ye),eh(Me)}).then(()=>(Le.matched.forEach(fe=>fe.enterCallbacks={}),Me=zb(ht,"beforeRouteEnter",Le,Fe),Me.push(ye),eh(Me))).then(()=>{Me=[];for(const fe of u.list())Me.push(Ll(fe,Le,Fe));return Me.push(ye),eh(Me)}).catch(fe=>Hc(fe,8)?fe:Promise.reject(fe))}function ae(Le,Fe,Me){for(const Qe of f.list())Qe(Le,Fe,Me)}function $(Le,Fe,Me,Qe,mt){const ht=C(Le,Fe);if(ht)return ht;const ye=Fe===Rl,fe=Zu?history.state:{};Me&&(Qe||ye?s.replace(Le.fullPath,li({scroll:ye&&fe&&fe.scroll},mt)):s.push(Le.fullPath,mt)),v.value=Le,ge(Le,Fe,Me,ye),oe()}let de;function D(){de=s.listen((Le,Fe,Me)=>{const Qe=E(Le),mt=N(Qe);if(mt){F(li(mt,{replace:!0}),Qe).catch(hd);return}m=Qe;const ht=v.value;Zu&&p5(GM(ht.fullPath,Me.delta),Rv()),Y(Qe,ht).catch(ye=>Hc(ye,4|8)?ye:Hc(ye,2)?(F(ye.to,Qe).then(fe=>{Hc(fe,4|16)&&!Me.delta&&Me.type===fd.pop&&s.go(-1,!1)}).catch(hd),Promise.reject()):(Me.delta&&s.go(-Me.delta,!1),W(ye,Qe,ht))).then(ye=>{ye=ye||$(Qe,ht,!1),ye&&(Me.delta?s.go(-Me.delta,!1):Me.type===fd.pop&&Hc(ye,4|16)&&s.go(-1,!1)),ae(Qe,ht,ye)}).catch(hd)})}let I=pd(),k=pd(),U;function W(Le,Fe,Me){oe(Le);const Qe=k.list();return Qe.length?Qe.forEach(mt=>mt(Le,Fe,Me)):console.error(Le),Promise.reject(Le)}function ce(){return U&&v.value!==Rl?Promise.resolve():new Promise((Le,Fe)=>{I.add([Le,Fe])})}function oe(Le){U||(U=!0,D(),I.list().forEach(([Fe,Me])=>Le?Me(Le):Fe()),I.reset())}function ge(Le,Fe,Me,Qe){const{scrollBehavior:mt}=i;if(!Zu||!mt)return Promise.resolve();const ht=!Me&&m5(GM(Le.fullPath,0))||(Qe||!Me)&&history.state&&history.state.scroll||null;return bM().then(()=>mt(Le,Fe,ht)).then(ye=>ye&&d5(ye)).catch(ye=>W(ye,Le,Fe))}const _e=Le=>s.go(Le);let Ne;const Ie=new Set;return{currentRoute:v,addRoute:w,removeRoute:A,hasRoute:S,getRoutes:M,resolve:E,options:i,push:L,replace:P,go:_e,back:()=>_e(-1),forward:()=>_e(1),beforeEach:o.add,beforeResolve:u.add,afterEach:f.add,onError:k.add,isReady:ce,install(Le){const Fe=this;Le.component("RouterLink",Z5),Le.component("RouterView",tN),Le.config.globalProperties.$router=Fe,Object.defineProperty(Le.config.globalProperties,"$route",{enumerable:!0,get:()=>Jf(v)}),Zu&&!Ne&&v.value===Rl&&(Ne=!0,L(s.location).catch(mt=>{}));const Me={};for(const mt in Rl)Me[mt]=Jo(()=>v.value[mt]);Le.provide(Cv,Fe),Le.provide(NM,Ic(Me)),Le.provide(kb,v);const Qe=Le.unmount;Ie.add(Le),Le.unmount=function(){Ie.delete(Le),Ie.size<1&&(m=Rl,de&&de(),v.value=Rl,Ne=!1,U=!1),Qe()}}}}function eh(i){return i.reduce((n,r)=>n.then(()=>r()),Promise.resolve())}function nN(i,n){const r=[],a=[],s=[],o=Math.max(n.matched.length,i.matched.length);for(let u=0;u<o;u++){const f=n.matched[u];f&&(i.matched.find(m=>Qu(m,f))?a.push(f):r.push(f));const v=i.matched[u];v&&(n.matched.find(m=>Qu(m,v))||s.push(v))}return[r,a,s]}function HZ(){return es(Cv)}/**
 * @license
 * Copyright 2010-2021 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const sS="134",rs={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},th={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},rN=0,lS=1,iN=2,cS=1,aN=2,md=3,vd=0,Ni=1,nh=2,uS=1,Pl=0,gd=1,hS=2,fS=3,dS=4,oN=5,rh=100,sN=101,lN=102,pS=103,mS=104,cN=200,uN=201,hN=202,fN=203,vS=204,gS=205,dN=206,pN=207,mN=208,vN=209,gN=210,yN=0,bN=1,xN=2,Gb=3,wN=4,AN=5,EN=6,_N=7,Pv=0,MN=1,SN=2,zc=0,TN=1,CN=2,RN=3,LN=4,PN=5,yS=300,yd=301,bd=302,Vb=303,Wb=304,Dv=306,jb=307,Xb=1e3,Qa=1001,qb=1002,Xi=1003,bS=1004,xS=1005,Ra=1006,DN=1007,Ov=1008,Dl=1009,ON=1010,IN=1011,Iv=1012,kN=1013,kv=1014,Ol=1015,ih=1016,FN=1017,BN=1018,NN=1019,xd=1020,UN=1021,ah=1022,ha=1023,HN=1024,zN=1025,GN=ha,oh=1026,wd=1027,VN=1028,WN=1029,jN=1030,XN=1031,qN=1032,YN=1033,wS=33776,AS=33777,ES=33778,_S=33779,MS=35840,SS=35841,TS=35842,CS=35843,$N=36196,RS=37492,LS=37496,KN=37808,ZN=37809,QN=37810,JN=37811,e6=37812,t6=37813,n6=37814,r6=37815,i6=37816,a6=37817,o6=37818,s6=37819,l6=37820,c6=37821,u6=36492,h6=37840,f6=37841,d6=37842,p6=37843,m6=37844,v6=37845,g6=37846,y6=37847,b6=37848,x6=37849,w6=37850,A6=37851,E6=37852,_6=37853,M6=2200,S6=2201,T6=2202,Fv=2300,Bv=2301,Yb=2302,sh=2400,lh=2401,Nv=2402,$b=2500,PS=2501,C6=0,fa=3e3,Gc=3001,Kb=3007,Zb=3002,R6=3003,DS=3004,OS=3005,IS=3006,L6=3200,P6=3201,ch=0,D6=1,Qb=7680,O6=519,Ad=35044,Uv=35048,kS="300 es";class uo{addEventListener(n,r){this._listeners===void 0&&(this._listeners={});const a=this._listeners;a[n]===void 0&&(a[n]=[]),a[n].indexOf(r)===-1&&a[n].push(r)}hasEventListener(n,r){if(this._listeners===void 0)return!1;const a=this._listeners;return a[n]!==void 0&&a[n].indexOf(r)!==-1}removeEventListener(n,r){if(this._listeners===void 0)return;const s=this._listeners[n];if(s!==void 0){const o=s.indexOf(r);o!==-1&&s.splice(o,1)}}dispatchEvent(n){if(this._listeners===void 0)return;const a=this._listeners[n.type];if(a!==void 0){n.target=this;const s=a.slice(0);for(let o=0,u=s.length;o<u;o++)s[o].call(this,n);n.target=null}}}const Jb=Math.PI/180,ex=180/Math.PI,ta=[];for(let i=0;i<256;i++)ta[i]=(i<16?"0":"")+i.toString(16);const I6=typeof crypto!="undefined"&&"randomUUID"in crypto;function is(){if(I6)return crypto.randomUUID().toUpperCase();const i=Math.random()*4294967295|0,n=Math.random()*4294967295|0,r=Math.random()*4294967295|0,a=Math.random()*4294967295|0;return(ta[i&255]+ta[i>>8&255]+ta[i>>16&255]+ta[i>>24&255]+"-"+ta[n&255]+ta[n>>8&255]+"-"+ta[n>>16&15|64]+ta[n>>24&255]+"-"+ta[r&63|128]+ta[r>>8&255]+"-"+ta[r>>16&255]+ta[r>>24&255]+ta[a&255]+ta[a>>8&255]+ta[a>>16&255]+ta[a>>24&255]).toUpperCase()}function Fa(i,n,r){return Math.max(n,Math.min(r,i))}function k6(i,n){return(i%n+n)%n}function tx(i,n,r){return(1-r)*i+r*n}function FS(i){return(i&i-1)==0&&i!==0}function F6(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}class Wt{constructor(n=0,r=0){this.x=n,this.y=r}get width(){return this.x}set width(n){this.x=n}get height(){return this.y}set height(n){this.y=n}set(n,r){return this.x=n,this.y=r,this}setScalar(n){return this.x=n,this.y=n,this}setX(n){return this.x=n,this}setY(n){return this.y=n,this}setComponent(n,r){switch(n){case 0:this.x=r;break;case 1:this.y=r;break;default:throw new Error("index is out of range: "+n)}return this}getComponent(n){switch(n){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+n)}}clone(){return new this.constructor(this.x,this.y)}copy(n){return this.x=n.x,this.y=n.y,this}add(n,r){return r!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(n,r)):(this.x+=n.x,this.y+=n.y,this)}addScalar(n){return this.x+=n,this.y+=n,this}addVectors(n,r){return this.x=n.x+r.x,this.y=n.y+r.y,this}addScaledVector(n,r){return this.x+=n.x*r,this.y+=n.y*r,this}sub(n,r){return r!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(n,r)):(this.x-=n.x,this.y-=n.y,this)}subScalar(n){return this.x-=n,this.y-=n,this}subVectors(n,r){return this.x=n.x-r.x,this.y=n.y-r.y,this}multiply(n){return this.x*=n.x,this.y*=n.y,this}multiplyScalar(n){return this.x*=n,this.y*=n,this}divide(n){return this.x/=n.x,this.y/=n.y,this}divideScalar(n){return this.multiplyScalar(1/n)}applyMatrix3(n){const r=this.x,a=this.y,s=n.elements;return this.x=s[0]*r+s[3]*a+s[6],this.y=s[1]*r+s[4]*a+s[7],this}min(n){return this.x=Math.min(this.x,n.x),this.y=Math.min(this.y,n.y),this}max(n){return this.x=Math.max(this.x,n.x),this.y=Math.max(this.y,n.y),this}clamp(n,r){return this.x=Math.max(n.x,Math.min(r.x,this.x)),this.y=Math.max(n.y,Math.min(r.y,this.y)),this}clampScalar(n,r){return this.x=Math.max(n,Math.min(r,this.x)),this.y=Math.max(n,Math.min(r,this.y)),this}clampLength(n,r){const a=this.length();return this.divideScalar(a||1).multiplyScalar(Math.max(n,Math.min(r,a)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(n){return this.x*n.x+this.y*n.y}cross(n){return this.x*n.y-this.y*n.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(n){return Math.sqrt(this.distanceToSquared(n))}distanceToSquared(n){const r=this.x-n.x,a=this.y-n.y;return r*r+a*a}manhattanDistanceTo(n){return Math.abs(this.x-n.x)+Math.abs(this.y-n.y)}setLength(n){return this.normalize().multiplyScalar(n)}lerp(n,r){return this.x+=(n.x-this.x)*r,this.y+=(n.y-this.y)*r,this}lerpVectors(n,r,a){return this.x=n.x+(r.x-n.x)*a,this.y=n.y+(r.y-n.y)*a,this}equals(n){return n.x===this.x&&n.y===this.y}fromArray(n,r=0){return this.x=n[r],this.y=n[r+1],this}toArray(n=[],r=0){return n[r]=this.x,n[r+1]=this.y,n}fromBufferAttribute(n,r,a){return a!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=n.getX(r),this.y=n.getY(r),this}rotateAround(n,r){const a=Math.cos(r),s=Math.sin(r),o=this.x-n.x,u=this.y-n.y;return this.x=o*a-u*s+n.x,this.y=o*s+u*a+n.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}Wt.prototype.isVector2=!0;class na{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(n,r,a,s,o,u,f,v,m){const g=this.elements;return g[0]=n,g[1]=s,g[2]=f,g[3]=r,g[4]=o,g[5]=v,g[6]=a,g[7]=u,g[8]=m,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(n){const r=this.elements,a=n.elements;return r[0]=a[0],r[1]=a[1],r[2]=a[2],r[3]=a[3],r[4]=a[4],r[5]=a[5],r[6]=a[6],r[7]=a[7],r[8]=a[8],this}extractBasis(n,r,a){return n.setFromMatrix3Column(this,0),r.setFromMatrix3Column(this,1),a.setFromMatrix3Column(this,2),this}setFromMatrix4(n){const r=n.elements;return this.set(r[0],r[4],r[8],r[1],r[5],r[9],r[2],r[6],r[10]),this}multiply(n){return this.multiplyMatrices(this,n)}premultiply(n){return this.multiplyMatrices(n,this)}multiplyMatrices(n,r){const a=n.elements,s=r.elements,o=this.elements,u=a[0],f=a[3],v=a[6],m=a[1],g=a[4],y=a[7],b=a[2],w=a[5],A=a[8],M=s[0],S=s[3],E=s[6],T=s[1],C=s[4],L=s[7],P=s[2],N=s[5],F=s[8];return o[0]=u*M+f*T+v*P,o[3]=u*S+f*C+v*N,o[6]=u*E+f*L+v*F,o[1]=m*M+g*T+y*P,o[4]=m*S+g*C+y*N,o[7]=m*E+g*L+y*F,o[2]=b*M+w*T+A*P,o[5]=b*S+w*C+A*N,o[8]=b*E+w*L+A*F,this}multiplyScalar(n){const r=this.elements;return r[0]*=n,r[3]*=n,r[6]*=n,r[1]*=n,r[4]*=n,r[7]*=n,r[2]*=n,r[5]*=n,r[8]*=n,this}determinant(){const n=this.elements,r=n[0],a=n[1],s=n[2],o=n[3],u=n[4],f=n[5],v=n[6],m=n[7],g=n[8];return r*u*g-r*f*m-a*o*g+a*f*v+s*o*m-s*u*v}invert(){const n=this.elements,r=n[0],a=n[1],s=n[2],o=n[3],u=n[4],f=n[5],v=n[6],m=n[7],g=n[8],y=g*u-f*m,b=f*v-g*o,w=m*o-u*v,A=r*y+a*b+s*w;if(A===0)return this.set(0,0,0,0,0,0,0,0,0);const M=1/A;return n[0]=y*M,n[1]=(s*m-g*a)*M,n[2]=(f*a-s*u)*M,n[3]=b*M,n[4]=(g*r-s*v)*M,n[5]=(s*o-f*r)*M,n[6]=w*M,n[7]=(a*v-m*r)*M,n[8]=(u*r-a*o)*M,this}transpose(){let n;const r=this.elements;return n=r[1],r[1]=r[3],r[3]=n,n=r[2],r[2]=r[6],r[6]=n,n=r[5],r[5]=r[7],r[7]=n,this}getNormalMatrix(n){return this.setFromMatrix4(n).invert().transpose()}transposeIntoArray(n){const r=this.elements;return n[0]=r[0],n[1]=r[3],n[2]=r[6],n[3]=r[1],n[4]=r[4],n[5]=r[7],n[6]=r[2],n[7]=r[5],n[8]=r[8],this}setUvTransform(n,r,a,s,o,u,f){const v=Math.cos(o),m=Math.sin(o);return this.set(a*v,a*m,-a*(v*u+m*f)+u+n,-s*m,s*v,-s*(-m*u+v*f)+f+r,0,0,1),this}scale(n,r){const a=this.elements;return a[0]*=n,a[3]*=n,a[6]*=n,a[1]*=r,a[4]*=r,a[7]*=r,this}rotate(n){const r=Math.cos(n),a=Math.sin(n),s=this.elements,o=s[0],u=s[3],f=s[6],v=s[1],m=s[4],g=s[7];return s[0]=r*o+a*v,s[3]=r*u+a*m,s[6]=r*f+a*g,s[1]=-a*o+r*v,s[4]=-a*u+r*m,s[7]=-a*f+r*g,this}translate(n,r){const a=this.elements;return a[0]+=n*a[2],a[3]+=n*a[5],a[6]+=n*a[8],a[1]+=r*a[2],a[4]+=r*a[5],a[7]+=r*a[8],this}equals(n){const r=this.elements,a=n.elements;for(let s=0;s<9;s++)if(r[s]!==a[s])return!1;return!0}fromArray(n,r=0){for(let a=0;a<9;a++)this.elements[a]=n[a+r];return this}toArray(n=[],r=0){const a=this.elements;return n[r]=a[0],n[r+1]=a[1],n[r+2]=a[2],n[r+3]=a[3],n[r+4]=a[4],n[r+5]=a[5],n[r+6]=a[6],n[r+7]=a[7],n[r+8]=a[8],n}clone(){return new this.constructor().fromArray(this.elements)}}na.prototype.isMatrix3=!0;function BS(i){if(i.length===0)return-1/0;let n=i[0];for(let r=1,a=i.length;r<a;++r)i[r]>n&&(n=i[r]);return n}function Hv(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function NS(i,n=0){let r=3735928559^n,a=1103547991^n;for(let s=0,o;s<i.length;s++)o=i.charCodeAt(s),r=Math.imul(r^o,2654435761),a=Math.imul(a^o,1597334677);return r=Math.imul(r^r>>>16,2246822507)^Math.imul(a^a>>>13,3266489909),a=Math.imul(a^a>>>16,2246822507)^Math.imul(r^r>>>13,3266489909),4294967296*(2097151&a)+(r>>>0)}let uh;class hh{static getDataURL(n){if(/^data:/i.test(n.src)||typeof HTMLCanvasElement=="undefined")return n.src;let r;if(n instanceof HTMLCanvasElement)r=n;else{uh===void 0&&(uh=Hv("canvas")),uh.width=n.width,uh.height=n.height;const a=uh.getContext("2d");n instanceof ImageData?a.putImageData(n,0,0):a.drawImage(n,0,0,n.width,n.height),r=uh}return r.width>2048||r.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",n),r.toDataURL("image/jpeg",.6)):r.toDataURL("image/png")}}let B6=0;class qi extends uo{constructor(n=qi.DEFAULT_IMAGE,r=qi.DEFAULT_MAPPING,a=Qa,s=Qa,o=Ra,u=Ov,f=ha,v=Dl,m=1,g=fa){super();Object.defineProperty(this,"id",{value:B6++}),this.uuid=is(),this.name="",this.image=n,this.mipmaps=[],this.mapping=r,this.wrapS=a,this.wrapT=s,this.magFilter=o,this.minFilter=u,this.anisotropy=m,this.format=f,this.internalFormat=null,this.type=v,this.offset=new Wt(0,0),this.repeat=new Wt(1,1),this.center=new Wt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new na,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=g,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(n){return this.name=n.name,this.image=n.image,this.mipmaps=n.mipmaps.slice(0),this.mapping=n.mapping,this.wrapS=n.wrapS,this.wrapT=n.wrapT,this.magFilter=n.magFilter,this.minFilter=n.minFilter,this.anisotropy=n.anisotropy,this.format=n.format,this.internalFormat=n.internalFormat,this.type=n.type,this.offset.copy(n.offset),this.repeat.copy(n.repeat),this.center.copy(n.center),this.rotation=n.rotation,this.matrixAutoUpdate=n.matrixAutoUpdate,this.matrix.copy(n.matrix),this.generateMipmaps=n.generateMipmaps,this.premultiplyAlpha=n.premultiplyAlpha,this.flipY=n.flipY,this.unpackAlignment=n.unpackAlignment,this.encoding=n.encoding,this.userData=JSON.parse(JSON.stringify(n.userData)),this}toJSON(n){const r=n===void 0||typeof n=="string";if(!r&&n.textures[this.uuid]!==void 0)return n.textures[this.uuid];const a={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){const s=this.image;if(s.uuid===void 0&&(s.uuid=is()),!r&&n.images[s.uuid]===void 0){let o;if(Array.isArray(s)){o=[];for(let u=0,f=s.length;u<f;u++)s[u].isDataTexture?o.push(nx(s[u].image)):o.push(nx(s[u]))}else o=nx(s);n.images[s.uuid]={uuid:s.uuid,url:o}}a.image=s.uuid}return JSON.stringify(this.userData)!=="{}"&&(a.userData=this.userData),r||(n.textures[this.uuid]=a),a}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(n){if(this.mapping!==yS)return n;if(n.applyMatrix3(this.matrix),n.x<0||n.x>1)switch(this.wrapS){case Xb:n.x=n.x-Math.floor(n.x);break;case Qa:n.x=n.x<0?0:1;break;case qb:Math.abs(Math.floor(n.x)%2)===1?n.x=Math.ceil(n.x)-n.x:n.x=n.x-Math.floor(n.x);break}if(n.y<0||n.y>1)switch(this.wrapT){case Xb:n.y=n.y-Math.floor(n.y);break;case Qa:n.y=n.y<0?0:1;break;case qb:Math.abs(Math.floor(n.y)%2)===1?n.y=Math.ceil(n.y)-n.y:n.y=n.y-Math.floor(n.y);break}return this.flipY&&(n.y=1-n.y),n}set needsUpdate(n){n===!0&&this.version++}}qi.DEFAULT_IMAGE=void 0;qi.DEFAULT_MAPPING=yS;qi.prototype.isTexture=!0;function nx(i){return typeof HTMLImageElement!="undefined"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&i instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&i instanceof ImageBitmap?hh.getDataURL(i):i.data?{data:Array.prototype.slice.call(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}class ci{constructor(n=0,r=0,a=0,s=1){this.x=n,this.y=r,this.z=a,this.w=s}get width(){return this.z}set width(n){this.z=n}get height(){return this.w}set height(n){this.w=n}set(n,r,a,s){return this.x=n,this.y=r,this.z=a,this.w=s,this}setScalar(n){return this.x=n,this.y=n,this.z=n,this.w=n,this}setX(n){return this.x=n,this}setY(n){return this.y=n,this}setZ(n){return this.z=n,this}setW(n){return this.w=n,this}setComponent(n,r){switch(n){case 0:this.x=r;break;case 1:this.y=r;break;case 2:this.z=r;break;case 3:this.w=r;break;default:throw new Error("index is out of range: "+n)}return this}getComponent(n){switch(n){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+n)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(n){return this.x=n.x,this.y=n.y,this.z=n.z,this.w=n.w!==void 0?n.w:1,this}add(n,r){return r!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(n,r)):(this.x+=n.x,this.y+=n.y,this.z+=n.z,this.w+=n.w,this)}addScalar(n){return this.x+=n,this.y+=n,this.z+=n,this.w+=n,this}addVectors(n,r){return this.x=n.x+r.x,this.y=n.y+r.y,this.z=n.z+r.z,this.w=n.w+r.w,this}addScaledVector(n,r){return this.x+=n.x*r,this.y+=n.y*r,this.z+=n.z*r,this.w+=n.w*r,this}sub(n,r){return r!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(n,r)):(this.x-=n.x,this.y-=n.y,this.z-=n.z,this.w-=n.w,this)}subScalar(n){return this.x-=n,this.y-=n,this.z-=n,this.w-=n,this}subVectors(n,r){return this.x=n.x-r.x,this.y=n.y-r.y,this.z=n.z-r.z,this.w=n.w-r.w,this}multiply(n){return this.x*=n.x,this.y*=n.y,this.z*=n.z,this.w*=n.w,this}multiplyScalar(n){return this.x*=n,this.y*=n,this.z*=n,this.w*=n,this}applyMatrix4(n){const r=this.x,a=this.y,s=this.z,o=this.w,u=n.elements;return this.x=u[0]*r+u[4]*a+u[8]*s+u[12]*o,this.y=u[1]*r+u[5]*a+u[9]*s+u[13]*o,this.z=u[2]*r+u[6]*a+u[10]*s+u[14]*o,this.w=u[3]*r+u[7]*a+u[11]*s+u[15]*o,this}divideScalar(n){return this.multiplyScalar(1/n)}setAxisAngleFromQuaternion(n){this.w=2*Math.acos(n.w);const r=Math.sqrt(1-n.w*n.w);return r<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=n.x/r,this.y=n.y/r,this.z=n.z/r),this}setAxisAngleFromRotationMatrix(n){let r,a,s,o;const u=.01,f=.1,v=n.elements,m=v[0],g=v[4],y=v[8],b=v[1],w=v[5],A=v[9],M=v[2],S=v[6],E=v[10];if(Math.abs(g-b)<u&&Math.abs(y-M)<u&&Math.abs(A-S)<u){if(Math.abs(g+b)<f&&Math.abs(y+M)<f&&Math.abs(A+S)<f&&Math.abs(m+w+E-3)<f)return this.set(1,0,0,0),this;r=Math.PI;const C=(m+1)/2,L=(w+1)/2,P=(E+1)/2,N=(g+b)/4,F=(y+M)/4,X=(A+S)/4;return C>L&&C>P?C<u?(a=0,s=.707106781,o=.707106781):(a=Math.sqrt(C),s=N/a,o=F/a):L>P?L<u?(a=.707106781,s=0,o=.707106781):(s=Math.sqrt(L),a=N/s,o=X/s):P<u?(a=.707106781,s=.707106781,o=0):(o=Math.sqrt(P),a=F/o,s=X/o),this.set(a,s,o,r),this}let T=Math.sqrt((S-A)*(S-A)+(y-M)*(y-M)+(b-g)*(b-g));return Math.abs(T)<.001&&(T=1),this.x=(S-A)/T,this.y=(y-M)/T,this.z=(b-g)/T,this.w=Math.acos((m+w+E-1)/2),this}min(n){return this.x=Math.min(this.x,n.x),this.y=Math.min(this.y,n.y),this.z=Math.min(this.z,n.z),this.w=Math.min(this.w,n.w),this}max(n){return this.x=Math.max(this.x,n.x),this.y=Math.max(this.y,n.y),this.z=Math.max(this.z,n.z),this.w=Math.max(this.w,n.w),this}clamp(n,r){return this.x=Math.max(n.x,Math.min(r.x,this.x)),this.y=Math.max(n.y,Math.min(r.y,this.y)),this.z=Math.max(n.z,Math.min(r.z,this.z)),this.w=Math.max(n.w,Math.min(r.w,this.w)),this}clampScalar(n,r){return this.x=Math.max(n,Math.min(r,this.x)),this.y=Math.max(n,Math.min(r,this.y)),this.z=Math.max(n,Math.min(r,this.z)),this.w=Math.max(n,Math.min(r,this.w)),this}clampLength(n,r){const a=this.length();return this.divideScalar(a||1).multiplyScalar(Math.max(n,Math.min(r,a)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(n){return this.x*n.x+this.y*n.y+this.z*n.z+this.w*n.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(n){return this.normalize().multiplyScalar(n)}lerp(n,r){return this.x+=(n.x-this.x)*r,this.y+=(n.y-this.y)*r,this.z+=(n.z-this.z)*r,this.w+=(n.w-this.w)*r,this}lerpVectors(n,r,a){return this.x=n.x+(r.x-n.x)*a,this.y=n.y+(r.y-n.y)*a,this.z=n.z+(r.z-n.z)*a,this.w=n.w+(r.w-n.w)*a,this}equals(n){return n.x===this.x&&n.y===this.y&&n.z===this.z&&n.w===this.w}fromArray(n,r=0){return this.x=n[r],this.y=n[r+1],this.z=n[r+2],this.w=n[r+3],this}toArray(n=[],r=0){return n[r]=this.x,n[r+1]=this.y,n[r+2]=this.z,n[r+3]=this.w,n}fromBufferAttribute(n,r,a){return a!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=n.getX(r),this.y=n.getY(r),this.z=n.getZ(r),this.w=n.getW(r),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}ci.prototype.isVector4=!0;class Do extends uo{constructor(n,r,a={}){super();this.width=n,this.height=r,this.depth=1,this.scissor=new ci(0,0,n,r),this.scissorTest=!1,this.viewport=new ci(0,0,n,r),this.texture=new qi(void 0,a.mapping,a.wrapS,a.wrapT,a.magFilter,a.minFilter,a.format,a.type,a.anisotropy,a.encoding),this.texture.isRenderTargetTexture=!0,this.texture.image={width:n,height:r,depth:1},this.texture.generateMipmaps=a.generateMipmaps!==void 0?a.generateMipmaps:!1,this.texture.internalFormat=a.internalFormat!==void 0?a.internalFormat:null,this.texture.minFilter=a.minFilter!==void 0?a.minFilter:Ra,this.depthBuffer=a.depthBuffer!==void 0?a.depthBuffer:!0,this.stencilBuffer=a.stencilBuffer!==void 0?a.stencilBuffer:!1,this.depthTexture=a.depthTexture!==void 0?a.depthTexture:null}setTexture(n){n.image={width:this.width,height:this.height,depth:this.depth},this.texture=n}setSize(n,r,a=1){(this.width!==n||this.height!==r||this.depth!==a)&&(this.width=n,this.height=r,this.depth=a,this.texture.image.width=n,this.texture.image.height=r,this.texture.image.depth=a,this.dispose()),this.viewport.set(0,0,n,r),this.scissor.set(0,0,n,r)}clone(){return new this.constructor().copy(this)}copy(n){return this.width=n.width,this.height=n.height,this.depth=n.depth,this.viewport.copy(n.viewport),this.texture=n.texture.clone(),this.texture.image=a_({},this.texture.image),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.depthTexture=n.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}Do.prototype.isWebGLRenderTarget=!0;class N6 extends Do{constructor(n,r,a){super(n,r);const s=this.texture;this.texture=[];for(let o=0;o<a;o++)this.texture[o]=s.clone()}setSize(n,r,a=1){if(this.width!==n||this.height!==r||this.depth!==a){this.width=n,this.height=r,this.depth=a;for(let s=0,o=this.texture.length;s<o;s++)this.texture[s].image.width=n,this.texture[s].image.height=r,this.texture[s].image.depth=a;this.dispose()}return this.viewport.set(0,0,n,r),this.scissor.set(0,0,n,r),this}copy(n){this.dispose(),this.width=n.width,this.height=n.height,this.depth=n.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.depthTexture=n.depthTexture,this.texture.length=0;for(let r=0,a=n.texture.length;r<a;r++)this.texture[r]=n.texture[r].clone();return this}}N6.prototype.isWebGLMultipleRenderTargets=!0;class US extends Do{constructor(n,r,a){super(n,r,a);this.samples=4}copy(n){return super.copy.call(this,n),this.samples=n.samples,this}}US.prototype.isWebGLMultisampleRenderTarget=!0;class Ui{constructor(n=0,r=0,a=0,s=1){this._x=n,this._y=r,this._z=a,this._w=s}static slerp(n,r,a,s){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),a.slerpQuaternions(n,r,s)}static slerpFlat(n,r,a,s,o,u,f){let v=a[s+0],m=a[s+1],g=a[s+2],y=a[s+3];const b=o[u+0],w=o[u+1],A=o[u+2],M=o[u+3];if(f===0){n[r+0]=v,n[r+1]=m,n[r+2]=g,n[r+3]=y;return}if(f===1){n[r+0]=b,n[r+1]=w,n[r+2]=A,n[r+3]=M;return}if(y!==M||v!==b||m!==w||g!==A){let S=1-f;const E=v*b+m*w+g*A+y*M,T=E>=0?1:-1,C=1-E*E;if(C>Number.EPSILON){const P=Math.sqrt(C),N=Math.atan2(P,E*T);S=Math.sin(S*N)/P,f=Math.sin(f*N)/P}const L=f*T;if(v=v*S+b*L,m=m*S+w*L,g=g*S+A*L,y=y*S+M*L,S===1-f){const P=1/Math.sqrt(v*v+m*m+g*g+y*y);v*=P,m*=P,g*=P,y*=P}}n[r]=v,n[r+1]=m,n[r+2]=g,n[r+3]=y}static multiplyQuaternionsFlat(n,r,a,s,o,u){const f=a[s],v=a[s+1],m=a[s+2],g=a[s+3],y=o[u],b=o[u+1],w=o[u+2],A=o[u+3];return n[r]=f*A+g*y+v*w-m*b,n[r+1]=v*A+g*b+m*y-f*w,n[r+2]=m*A+g*w+f*b-v*y,n[r+3]=g*A-f*y-v*b-m*w,n}get x(){return this._x}set x(n){this._x=n,this._onChangeCallback()}get y(){return this._y}set y(n){this._y=n,this._onChangeCallback()}get z(){return this._z}set z(n){this._z=n,this._onChangeCallback()}get w(){return this._w}set w(n){this._w=n,this._onChangeCallback()}set(n,r,a,s){return this._x=n,this._y=r,this._z=a,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(n){return this._x=n.x,this._y=n.y,this._z=n.z,this._w=n.w,this._onChangeCallback(),this}setFromEuler(n,r){if(!(n&&n.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const a=n._x,s=n._y,o=n._z,u=n._order,f=Math.cos,v=Math.sin,m=f(a/2),g=f(s/2),y=f(o/2),b=v(a/2),w=v(s/2),A=v(o/2);switch(u){case"XYZ":this._x=b*g*y+m*w*A,this._y=m*w*y-b*g*A,this._z=m*g*A+b*w*y,this._w=m*g*y-b*w*A;break;case"YXZ":this._x=b*g*y+m*w*A,this._y=m*w*y-b*g*A,this._z=m*g*A-b*w*y,this._w=m*g*y+b*w*A;break;case"ZXY":this._x=b*g*y-m*w*A,this._y=m*w*y+b*g*A,this._z=m*g*A+b*w*y,this._w=m*g*y-b*w*A;break;case"ZYX":this._x=b*g*y-m*w*A,this._y=m*w*y+b*g*A,this._z=m*g*A-b*w*y,this._w=m*g*y+b*w*A;break;case"YZX":this._x=b*g*y+m*w*A,this._y=m*w*y+b*g*A,this._z=m*g*A-b*w*y,this._w=m*g*y-b*w*A;break;case"XZY":this._x=b*g*y-m*w*A,this._y=m*w*y-b*g*A,this._z=m*g*A+b*w*y,this._w=m*g*y+b*w*A;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+u)}return r!==!1&&this._onChangeCallback(),this}setFromAxisAngle(n,r){const a=r/2,s=Math.sin(a);return this._x=n.x*s,this._y=n.y*s,this._z=n.z*s,this._w=Math.cos(a),this._onChangeCallback(),this}setFromRotationMatrix(n){const r=n.elements,a=r[0],s=r[4],o=r[8],u=r[1],f=r[5],v=r[9],m=r[2],g=r[6],y=r[10],b=a+f+y;if(b>0){const w=.5/Math.sqrt(b+1);this._w=.25/w,this._x=(g-v)*w,this._y=(o-m)*w,this._z=(u-s)*w}else if(a>f&&a>y){const w=2*Math.sqrt(1+a-f-y);this._w=(g-v)/w,this._x=.25*w,this._y=(s+u)/w,this._z=(o+m)/w}else if(f>y){const w=2*Math.sqrt(1+f-a-y);this._w=(o-m)/w,this._x=(s+u)/w,this._y=.25*w,this._z=(v+g)/w}else{const w=2*Math.sqrt(1+y-a-f);this._w=(u-s)/w,this._x=(o+m)/w,this._y=(v+g)/w,this._z=.25*w}return this._onChangeCallback(),this}setFromUnitVectors(n,r){let a=n.dot(r)+1;return a<Number.EPSILON?(a=0,Math.abs(n.x)>Math.abs(n.z)?(this._x=-n.y,this._y=n.x,this._z=0,this._w=a):(this._x=0,this._y=-n.z,this._z=n.y,this._w=a)):(this._x=n.y*r.z-n.z*r.y,this._y=n.z*r.x-n.x*r.z,this._z=n.x*r.y-n.y*r.x,this._w=a),this.normalize()}angleTo(n){return 2*Math.acos(Math.abs(Fa(this.dot(n),-1,1)))}rotateTowards(n,r){const a=this.angleTo(n);if(a===0)return this;const s=Math.min(1,r/a);return this.slerp(n,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(n){return this._x*n._x+this._y*n._y+this._z*n._z+this._w*n._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let n=this.length();return n===0?(this._x=0,this._y=0,this._z=0,this._w=1):(n=1/n,this._x=this._x*n,this._y=this._y*n,this._z=this._z*n,this._w=this._w*n),this._onChangeCallback(),this}multiply(n,r){return r!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(n,r)):this.multiplyQuaternions(this,n)}premultiply(n){return this.multiplyQuaternions(n,this)}multiplyQuaternions(n,r){const a=n._x,s=n._y,o=n._z,u=n._w,f=r._x,v=r._y,m=r._z,g=r._w;return this._x=a*g+u*f+s*m-o*v,this._y=s*g+u*v+o*f-a*m,this._z=o*g+u*m+a*v-s*f,this._w=u*g-a*f-s*v-o*m,this._onChangeCallback(),this}slerp(n,r){if(r===0)return this;if(r===1)return this.copy(n);const a=this._x,s=this._y,o=this._z,u=this._w;let f=u*n._w+a*n._x+s*n._y+o*n._z;if(f<0?(this._w=-n._w,this._x=-n._x,this._y=-n._y,this._z=-n._z,f=-f):this.copy(n),f>=1)return this._w=u,this._x=a,this._y=s,this._z=o,this;const v=1-f*f;if(v<=Number.EPSILON){const w=1-r;return this._w=w*u+r*this._w,this._x=w*a+r*this._x,this._y=w*s+r*this._y,this._z=w*o+r*this._z,this.normalize(),this._onChangeCallback(),this}const m=Math.sqrt(v),g=Math.atan2(m,f),y=Math.sin((1-r)*g)/m,b=Math.sin(r*g)/m;return this._w=u*y+this._w*b,this._x=a*y+this._x*b,this._y=s*y+this._y*b,this._z=o*y+this._z*b,this._onChangeCallback(),this}slerpQuaternions(n,r,a){this.copy(n).slerp(r,a)}random(){const n=Math.random(),r=Math.sqrt(1-n),a=Math.sqrt(n),s=2*Math.PI*Math.random(),o=2*Math.PI*Math.random();return this.set(r*Math.cos(s),a*Math.sin(o),a*Math.cos(o),r*Math.sin(s))}equals(n){return n._x===this._x&&n._y===this._y&&n._z===this._z&&n._w===this._w}fromArray(n,r=0){return this._x=n[r],this._y=n[r+1],this._z=n[r+2],this._w=n[r+3],this._onChangeCallback(),this}toArray(n=[],r=0){return n[r]=this._x,n[r+1]=this._y,n[r+2]=this._z,n[r+3]=this._w,n}fromBufferAttribute(n,r){return this._x=n.getX(r),this._y=n.getY(r),this._z=n.getZ(r),this._w=n.getW(r),this}_onChange(n){return this._onChangeCallback=n,this}_onChangeCallback(){}}Ui.prototype.isQuaternion=!0;class Ze{constructor(n=0,r=0,a=0){this.x=n,this.y=r,this.z=a}set(n,r,a){return a===void 0&&(a=this.z),this.x=n,this.y=r,this.z=a,this}setScalar(n){return this.x=n,this.y=n,this.z=n,this}setX(n){return this.x=n,this}setY(n){return this.y=n,this}setZ(n){return this.z=n,this}setComponent(n,r){switch(n){case 0:this.x=r;break;case 1:this.y=r;break;case 2:this.z=r;break;default:throw new Error("index is out of range: "+n)}return this}getComponent(n){switch(n){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+n)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(n){return this.x=n.x,this.y=n.y,this.z=n.z,this}add(n,r){return r!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(n,r)):(this.x+=n.x,this.y+=n.y,this.z+=n.z,this)}addScalar(n){return this.x+=n,this.y+=n,this.z+=n,this}addVectors(n,r){return this.x=n.x+r.x,this.y=n.y+r.y,this.z=n.z+r.z,this}addScaledVector(n,r){return this.x+=n.x*r,this.y+=n.y*r,this.z+=n.z*r,this}sub(n,r){return r!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(n,r)):(this.x-=n.x,this.y-=n.y,this.z-=n.z,this)}subScalar(n){return this.x-=n,this.y-=n,this.z-=n,this}subVectors(n,r){return this.x=n.x-r.x,this.y=n.y-r.y,this.z=n.z-r.z,this}multiply(n,r){return r!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(n,r)):(this.x*=n.x,this.y*=n.y,this.z*=n.z,this)}multiplyScalar(n){return this.x*=n,this.y*=n,this.z*=n,this}multiplyVectors(n,r){return this.x=n.x*r.x,this.y=n.y*r.y,this.z=n.z*r.z,this}applyEuler(n){return n&&n.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(HS.setFromEuler(n))}applyAxisAngle(n,r){return this.applyQuaternion(HS.setFromAxisAngle(n,r))}applyMatrix3(n){const r=this.x,a=this.y,s=this.z,o=n.elements;return this.x=o[0]*r+o[3]*a+o[6]*s,this.y=o[1]*r+o[4]*a+o[7]*s,this.z=o[2]*r+o[5]*a+o[8]*s,this}applyNormalMatrix(n){return this.applyMatrix3(n).normalize()}applyMatrix4(n){const r=this.x,a=this.y,s=this.z,o=n.elements,u=1/(o[3]*r+o[7]*a+o[11]*s+o[15]);return this.x=(o[0]*r+o[4]*a+o[8]*s+o[12])*u,this.y=(o[1]*r+o[5]*a+o[9]*s+o[13])*u,this.z=(o[2]*r+o[6]*a+o[10]*s+o[14])*u,this}applyQuaternion(n){const r=this.x,a=this.y,s=this.z,o=n.x,u=n.y,f=n.z,v=n.w,m=v*r+u*s-f*a,g=v*a+f*r-o*s,y=v*s+o*a-u*r,b=-o*r-u*a-f*s;return this.x=m*v+b*-o+g*-f-y*-u,this.y=g*v+b*-u+y*-o-m*-f,this.z=y*v+b*-f+m*-u-g*-o,this}project(n){return this.applyMatrix4(n.matrixWorldInverse).applyMatrix4(n.projectionMatrix)}unproject(n){return this.applyMatrix4(n.projectionMatrixInverse).applyMatrix4(n.matrixWorld)}transformDirection(n){const r=this.x,a=this.y,s=this.z,o=n.elements;return this.x=o[0]*r+o[4]*a+o[8]*s,this.y=o[1]*r+o[5]*a+o[9]*s,this.z=o[2]*r+o[6]*a+o[10]*s,this.normalize()}divide(n){return this.x/=n.x,this.y/=n.y,this.z/=n.z,this}divideScalar(n){return this.multiplyScalar(1/n)}min(n){return this.x=Math.min(this.x,n.x),this.y=Math.min(this.y,n.y),this.z=Math.min(this.z,n.z),this}max(n){return this.x=Math.max(this.x,n.x),this.y=Math.max(this.y,n.y),this.z=Math.max(this.z,n.z),this}clamp(n,r){return this.x=Math.max(n.x,Math.min(r.x,this.x)),this.y=Math.max(n.y,Math.min(r.y,this.y)),this.z=Math.max(n.z,Math.min(r.z,this.z)),this}clampScalar(n,r){return this.x=Math.max(n,Math.min(r,this.x)),this.y=Math.max(n,Math.min(r,this.y)),this.z=Math.max(n,Math.min(r,this.z)),this}clampLength(n,r){const a=this.length();return this.divideScalar(a||1).multiplyScalar(Math.max(n,Math.min(r,a)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(n){return this.x*n.x+this.y*n.y+this.z*n.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(n){return this.normalize().multiplyScalar(n)}lerp(n,r){return this.x+=(n.x-this.x)*r,this.y+=(n.y-this.y)*r,this.z+=(n.z-this.z)*r,this}lerpVectors(n,r,a){return this.x=n.x+(r.x-n.x)*a,this.y=n.y+(r.y-n.y)*a,this.z=n.z+(r.z-n.z)*a,this}cross(n,r){return r!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(n,r)):this.crossVectors(this,n)}crossVectors(n,r){const a=n.x,s=n.y,o=n.z,u=r.x,f=r.y,v=r.z;return this.x=s*v-o*f,this.y=o*u-a*v,this.z=a*f-s*u,this}projectOnVector(n){const r=n.lengthSq();if(r===0)return this.set(0,0,0);const a=n.dot(this)/r;return this.copy(n).multiplyScalar(a)}projectOnPlane(n){return rx.copy(this).projectOnVector(n),this.sub(rx)}reflect(n){return this.sub(rx.copy(n).multiplyScalar(2*this.dot(n)))}angleTo(n){const r=Math.sqrt(this.lengthSq()*n.lengthSq());if(r===0)return Math.PI/2;const a=this.dot(n)/r;return Math.acos(Fa(a,-1,1))}distanceTo(n){return Math.sqrt(this.distanceToSquared(n))}distanceToSquared(n){const r=this.x-n.x,a=this.y-n.y,s=this.z-n.z;return r*r+a*a+s*s}manhattanDistanceTo(n){return Math.abs(this.x-n.x)+Math.abs(this.y-n.y)+Math.abs(this.z-n.z)}setFromSpherical(n){return this.setFromSphericalCoords(n.radius,n.phi,n.theta)}setFromSphericalCoords(n,r,a){const s=Math.sin(r)*n;return this.x=s*Math.sin(a),this.y=Math.cos(r)*n,this.z=s*Math.cos(a),this}setFromCylindrical(n){return this.setFromCylindricalCoords(n.radius,n.theta,n.y)}setFromCylindricalCoords(n,r,a){return this.x=n*Math.sin(r),this.y=a,this.z=n*Math.cos(r),this}setFromMatrixPosition(n){const r=n.elements;return this.x=r[12],this.y=r[13],this.z=r[14],this}setFromMatrixScale(n){const r=this.setFromMatrixColumn(n,0).length(),a=this.setFromMatrixColumn(n,1).length(),s=this.setFromMatrixColumn(n,2).length();return this.x=r,this.y=a,this.z=s,this}setFromMatrixColumn(n,r){return this.fromArray(n.elements,r*4)}setFromMatrix3Column(n,r){return this.fromArray(n.elements,r*3)}equals(n){return n.x===this.x&&n.y===this.y&&n.z===this.z}fromArray(n,r=0){return this.x=n[r],this.y=n[r+1],this.z=n[r+2],this}toArray(n=[],r=0){return n[r]=this.x,n[r+1]=this.y,n[r+2]=this.z,n}fromBufferAttribute(n,r,a){return a!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=n.getX(r),this.y=n.getY(r),this.z=n.getZ(r),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const n=(Math.random()-.5)*2,r=Math.random()*Math.PI*2,a=Math.sqrt(1-n**2);return this.x=a*Math.cos(r),this.y=a*Math.sin(r),this.z=n,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}Ze.prototype.isVector3=!0;const rx=new Ze,HS=new Ui;class Ja{constructor(n=new Ze(1/0,1/0,1/0),r=new Ze(-1/0,-1/0,-1/0)){this.min=n,this.max=r}set(n,r){return this.min.copy(n),this.max.copy(r),this}setFromArray(n){let r=1/0,a=1/0,s=1/0,o=-1/0,u=-1/0,f=-1/0;for(let v=0,m=n.length;v<m;v+=3){const g=n[v],y=n[v+1],b=n[v+2];g<r&&(r=g),y<a&&(a=y),b<s&&(s=b),g>o&&(o=g),y>u&&(u=y),b>f&&(f=b)}return this.min.set(r,a,s),this.max.set(o,u,f),this}setFromBufferAttribute(n){let r=1/0,a=1/0,s=1/0,o=-1/0,u=-1/0,f=-1/0;for(let v=0,m=n.count;v<m;v++){const g=n.getX(v),y=n.getY(v),b=n.getZ(v);g<r&&(r=g),y<a&&(a=y),b<s&&(s=b),g>o&&(o=g),y>u&&(u=y),b>f&&(f=b)}return this.min.set(r,a,s),this.max.set(o,u,f),this}setFromPoints(n){this.makeEmpty();for(let r=0,a=n.length;r<a;r++)this.expandByPoint(n[r]);return this}setFromCenterAndSize(n,r){const a=Ed.copy(r).multiplyScalar(.5);return this.min.copy(n).sub(a),this.max.copy(n).add(a),this}setFromObject(n){return this.makeEmpty(),this.expandByObject(n)}clone(){return new this.constructor().copy(this)}copy(n){return this.min.copy(n.min),this.max.copy(n.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(n){return this.isEmpty()?n.set(0,0,0):n.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(n){return this.isEmpty()?n.set(0,0,0):n.subVectors(this.max,this.min)}expandByPoint(n){return this.min.min(n),this.max.max(n),this}expandByVector(n){return this.min.sub(n),this.max.add(n),this}expandByScalar(n){return this.min.addScalar(-n),this.max.addScalar(n),this}expandByObject(n){n.updateWorldMatrix(!1,!1);const r=n.geometry;r!==void 0&&(r.boundingBox===null&&r.computeBoundingBox(),ix.copy(r.boundingBox),ix.applyMatrix4(n.matrixWorld),this.union(ix));const a=n.children;for(let s=0,o=a.length;s<o;s++)this.expandByObject(a[s]);return this}containsPoint(n){return!(n.x<this.min.x||n.x>this.max.x||n.y<this.min.y||n.y>this.max.y||n.z<this.min.z||n.z>this.max.z)}containsBox(n){return this.min.x<=n.min.x&&n.max.x<=this.max.x&&this.min.y<=n.min.y&&n.max.y<=this.max.y&&this.min.z<=n.min.z&&n.max.z<=this.max.z}getParameter(n,r){return r.set((n.x-this.min.x)/(this.max.x-this.min.x),(n.y-this.min.y)/(this.max.y-this.min.y),(n.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(n){return!(n.max.x<this.min.x||n.min.x>this.max.x||n.max.y<this.min.y||n.min.y>this.max.y||n.max.z<this.min.z||n.min.z>this.max.z)}intersectsSphere(n){return this.clampPoint(n.center,Ed),Ed.distanceToSquared(n.center)<=n.radius*n.radius}intersectsPlane(n){let r,a;return n.normal.x>0?(r=n.normal.x*this.min.x,a=n.normal.x*this.max.x):(r=n.normal.x*this.max.x,a=n.normal.x*this.min.x),n.normal.y>0?(r+=n.normal.y*this.min.y,a+=n.normal.y*this.max.y):(r+=n.normal.y*this.max.y,a+=n.normal.y*this.min.y),n.normal.z>0?(r+=n.normal.z*this.min.z,a+=n.normal.z*this.max.z):(r+=n.normal.z*this.max.z,a+=n.normal.z*this.min.z),r<=-n.constant&&a>=-n.constant}intersectsTriangle(n){if(this.isEmpty())return!1;this.getCenter(_d),zv.subVectors(this.max,_d),fh.subVectors(n.a,_d),dh.subVectors(n.b,_d),ph.subVectors(n.c,_d),Il.subVectors(dh,fh),kl.subVectors(ph,dh),Vc.subVectors(fh,ph);let r=[0,-Il.z,Il.y,0,-kl.z,kl.y,0,-Vc.z,Vc.y,Il.z,0,-Il.x,kl.z,0,-kl.x,Vc.z,0,-Vc.x,-Il.y,Il.x,0,-kl.y,kl.x,0,-Vc.y,Vc.x,0];return!ax(r,fh,dh,ph,zv)||(r=[1,0,0,0,1,0,0,0,1],!ax(r,fh,dh,ph,zv))?!1:(Gv.crossVectors(Il,kl),r=[Gv.x,Gv.y,Gv.z],ax(r,fh,dh,ph,zv))}clampPoint(n,r){return r.copy(n).clamp(this.min,this.max)}distanceToPoint(n){return Ed.copy(n).clamp(this.min,this.max).sub(n).length()}getBoundingSphere(n){return this.getCenter(n.center),n.radius=this.getSize(Ed).length()*.5,n}intersect(n){return this.min.max(n.min),this.max.min(n.max),this.isEmpty()&&this.makeEmpty(),this}union(n){return this.min.min(n.min),this.max.max(n.max),this}applyMatrix4(n){return this.isEmpty()?this:(Is[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(n),Is[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(n),Is[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(n),Is[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(n),Is[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(n),Is[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(n),Is[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(n),Is[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(n),this.setFromPoints(Is),this)}translate(n){return this.min.add(n),this.max.add(n),this}equals(n){return n.min.equals(this.min)&&n.max.equals(this.max)}}Ja.prototype.isBox3=!0;const Is=[new Ze,new Ze,new Ze,new Ze,new Ze,new Ze,new Ze,new Ze],Ed=new Ze,ix=new Ja,fh=new Ze,dh=new Ze,ph=new Ze,Il=new Ze,kl=new Ze,Vc=new Ze,_d=new Ze,zv=new Ze,Gv=new Ze,Wc=new Ze;function ax(i,n,r,a,s){for(let o=0,u=i.length-3;o<=u;o+=3){Wc.fromArray(i,o);const f=s.x*Math.abs(Wc.x)+s.y*Math.abs(Wc.y)+s.z*Math.abs(Wc.z),v=n.dot(Wc),m=r.dot(Wc),g=a.dot(Wc);if(Math.max(-Math.max(v,m,g),Math.min(v,m,g))>f)return!1}return!0}const U6=new Ja,zS=new Ze,ox=new Ze,sx=new Ze;class mh{constructor(n=new Ze,r=-1){this.center=n,this.radius=r}set(n,r){return this.center.copy(n),this.radius=r,this}setFromPoints(n,r){const a=this.center;r!==void 0?a.copy(r):U6.setFromPoints(n).getCenter(a);let s=0;for(let o=0,u=n.length;o<u;o++)s=Math.max(s,a.distanceToSquared(n[o]));return this.radius=Math.sqrt(s),this}copy(n){return this.center.copy(n.center),this.radius=n.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(n){return n.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(n){return n.distanceTo(this.center)-this.radius}intersectsSphere(n){const r=this.radius+n.radius;return n.center.distanceToSquared(this.center)<=r*r}intersectsBox(n){return n.intersectsSphere(this)}intersectsPlane(n){return Math.abs(n.distanceToPoint(this.center))<=this.radius}clampPoint(n,r){const a=this.center.distanceToSquared(n);return r.copy(n),a>this.radius*this.radius&&(r.sub(this.center).normalize(),r.multiplyScalar(this.radius).add(this.center)),r}getBoundingBox(n){return this.isEmpty()?(n.makeEmpty(),n):(n.set(this.center,this.center),n.expandByScalar(this.radius),n)}applyMatrix4(n){return this.center.applyMatrix4(n),this.radius=this.radius*n.getMaxScaleOnAxis(),this}translate(n){return this.center.add(n),this}expandByPoint(n){sx.subVectors(n,this.center);const r=sx.lengthSq();if(r>this.radius*this.radius){const a=Math.sqrt(r),s=(a-this.radius)*.5;this.center.add(sx.multiplyScalar(s/a)),this.radius+=s}return this}union(n){return ox.subVectors(n.center,this.center).normalize().multiplyScalar(n.radius),this.expandByPoint(zS.copy(n.center).add(ox)),this.expandByPoint(zS.copy(n.center).sub(ox)),this}equals(n){return n.center.equals(this.center)&&n.radius===this.radius}clone(){return new this.constructor().copy(this)}}const ks=new Ze,lx=new Ze,Vv=new Ze,Fl=new Ze,cx=new Ze,Wv=new Ze,ux=new Ze;class jc{constructor(n=new Ze,r=new Ze(0,0,-1)){this.origin=n,this.direction=r}set(n,r){return this.origin.copy(n),this.direction.copy(r),this}copy(n){return this.origin.copy(n.origin),this.direction.copy(n.direction),this}at(n,r){return r.copy(this.direction).multiplyScalar(n).add(this.origin)}lookAt(n){return this.direction.copy(n).sub(this.origin).normalize(),this}recast(n){return this.origin.copy(this.at(n,ks)),this}closestPointToPoint(n,r){r.subVectors(n,this.origin);const a=r.dot(this.direction);return a<0?r.copy(this.origin):r.copy(this.direction).multiplyScalar(a).add(this.origin)}distanceToPoint(n){return Math.sqrt(this.distanceSqToPoint(n))}distanceSqToPoint(n){const r=ks.subVectors(n,this.origin).dot(this.direction);return r<0?this.origin.distanceToSquared(n):(ks.copy(this.direction).multiplyScalar(r).add(this.origin),ks.distanceToSquared(n))}distanceSqToSegment(n,r,a,s){lx.copy(n).add(r).multiplyScalar(.5),Vv.copy(r).sub(n).normalize(),Fl.copy(this.origin).sub(lx);const o=n.distanceTo(r)*.5,u=-this.direction.dot(Vv),f=Fl.dot(this.direction),v=-Fl.dot(Vv),m=Fl.lengthSq(),g=Math.abs(1-u*u);let y,b,w,A;if(g>0)if(y=u*v-f,b=u*f-v,A=o*g,y>=0)if(b>=-A)if(b<=A){const M=1/g;y*=M,b*=M,w=y*(y+u*b+2*f)+b*(u*y+b+2*v)+m}else b=o,y=Math.max(0,-(u*b+f)),w=-y*y+b*(b+2*v)+m;else b=-o,y=Math.max(0,-(u*b+f)),w=-y*y+b*(b+2*v)+m;else b<=-A?(y=Math.max(0,-(-u*o+f)),b=y>0?-o:Math.min(Math.max(-o,-v),o),w=-y*y+b*(b+2*v)+m):b<=A?(y=0,b=Math.min(Math.max(-o,-v),o),w=b*(b+2*v)+m):(y=Math.max(0,-(u*o+f)),b=y>0?o:Math.min(Math.max(-o,-v),o),w=-y*y+b*(b+2*v)+m);else b=u>0?-o:o,y=Math.max(0,-(u*b+f)),w=-y*y+b*(b+2*v)+m;return a&&a.copy(this.direction).multiplyScalar(y).add(this.origin),s&&s.copy(Vv).multiplyScalar(b).add(lx),w}intersectSphere(n,r){ks.subVectors(n.center,this.origin);const a=ks.dot(this.direction),s=ks.dot(ks)-a*a,o=n.radius*n.radius;if(s>o)return null;const u=Math.sqrt(o-s),f=a-u,v=a+u;return f<0&&v<0?null:f<0?this.at(v,r):this.at(f,r)}intersectsSphere(n){return this.distanceSqToPoint(n.center)<=n.radius*n.radius}distanceToPlane(n){const r=n.normal.dot(this.direction);if(r===0)return n.distanceToPoint(this.origin)===0?0:null;const a=-(this.origin.dot(n.normal)+n.constant)/r;return a>=0?a:null}intersectPlane(n,r){const a=this.distanceToPlane(n);return a===null?null:this.at(a,r)}intersectsPlane(n){const r=n.distanceToPoint(this.origin);return r===0||n.normal.dot(this.direction)*r<0}intersectBox(n,r){let a,s,o,u,f,v;const m=1/this.direction.x,g=1/this.direction.y,y=1/this.direction.z,b=this.origin;return m>=0?(a=(n.min.x-b.x)*m,s=(n.max.x-b.x)*m):(a=(n.max.x-b.x)*m,s=(n.min.x-b.x)*m),g>=0?(o=(n.min.y-b.y)*g,u=(n.max.y-b.y)*g):(o=(n.max.y-b.y)*g,u=(n.min.y-b.y)*g),a>u||o>s||((o>a||a!==a)&&(a=o),(u<s||s!==s)&&(s=u),y>=0?(f=(n.min.z-b.z)*y,v=(n.max.z-b.z)*y):(f=(n.max.z-b.z)*y,v=(n.min.z-b.z)*y),a>v||f>s)||((f>a||a!==a)&&(a=f),(v<s||s!==s)&&(s=v),s<0)?null:this.at(a>=0?a:s,r)}intersectsBox(n){return this.intersectBox(n,ks)!==null}intersectTriangle(n,r,a,s,o){cx.subVectors(r,n),Wv.subVectors(a,n),ux.crossVectors(cx,Wv);let u=this.direction.dot(ux),f;if(u>0){if(s)return null;f=1}else if(u<0)f=-1,u=-u;else return null;Fl.subVectors(this.origin,n);const v=f*this.direction.dot(Wv.crossVectors(Fl,Wv));if(v<0)return null;const m=f*this.direction.dot(cx.cross(Fl));if(m<0||v+m>u)return null;const g=-f*Fl.dot(ux);return g<0?null:this.at(g/u,o)}applyMatrix4(n){return this.origin.applyMatrix4(n),this.direction.transformDirection(n),this}equals(n){return n.origin.equals(this.origin)&&n.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class jn{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(n,r,a,s,o,u,f,v,m,g,y,b,w,A,M,S){const E=this.elements;return E[0]=n,E[4]=r,E[8]=a,E[12]=s,E[1]=o,E[5]=u,E[9]=f,E[13]=v,E[2]=m,E[6]=g,E[10]=y,E[14]=b,E[3]=w,E[7]=A,E[11]=M,E[15]=S,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new jn().fromArray(this.elements)}copy(n){const r=this.elements,a=n.elements;return r[0]=a[0],r[1]=a[1],r[2]=a[2],r[3]=a[3],r[4]=a[4],r[5]=a[5],r[6]=a[6],r[7]=a[7],r[8]=a[8],r[9]=a[9],r[10]=a[10],r[11]=a[11],r[12]=a[12],r[13]=a[13],r[14]=a[14],r[15]=a[15],this}copyPosition(n){const r=this.elements,a=n.elements;return r[12]=a[12],r[13]=a[13],r[14]=a[14],this}setFromMatrix3(n){const r=n.elements;return this.set(r[0],r[3],r[6],0,r[1],r[4],r[7],0,r[2],r[5],r[8],0,0,0,0,1),this}extractBasis(n,r,a){return n.setFromMatrixColumn(this,0),r.setFromMatrixColumn(this,1),a.setFromMatrixColumn(this,2),this}makeBasis(n,r,a){return this.set(n.x,r.x,a.x,0,n.y,r.y,a.y,0,n.z,r.z,a.z,0,0,0,0,1),this}extractRotation(n){const r=this.elements,a=n.elements,s=1/vh.setFromMatrixColumn(n,0).length(),o=1/vh.setFromMatrixColumn(n,1).length(),u=1/vh.setFromMatrixColumn(n,2).length();return r[0]=a[0]*s,r[1]=a[1]*s,r[2]=a[2]*s,r[3]=0,r[4]=a[4]*o,r[5]=a[5]*o,r[6]=a[6]*o,r[7]=0,r[8]=a[8]*u,r[9]=a[9]*u,r[10]=a[10]*u,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this}makeRotationFromEuler(n){n&&n.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const r=this.elements,a=n.x,s=n.y,o=n.z,u=Math.cos(a),f=Math.sin(a),v=Math.cos(s),m=Math.sin(s),g=Math.cos(o),y=Math.sin(o);if(n.order==="XYZ"){const b=u*g,w=u*y,A=f*g,M=f*y;r[0]=v*g,r[4]=-v*y,r[8]=m,r[1]=w+A*m,r[5]=b-M*m,r[9]=-f*v,r[2]=M-b*m,r[6]=A+w*m,r[10]=u*v}else if(n.order==="YXZ"){const b=v*g,w=v*y,A=m*g,M=m*y;r[0]=b+M*f,r[4]=A*f-w,r[8]=u*m,r[1]=u*y,r[5]=u*g,r[9]=-f,r[2]=w*f-A,r[6]=M+b*f,r[10]=u*v}else if(n.order==="ZXY"){const b=v*g,w=v*y,A=m*g,M=m*y;r[0]=b-M*f,r[4]=-u*y,r[8]=A+w*f,r[1]=w+A*f,r[5]=u*g,r[9]=M-b*f,r[2]=-u*m,r[6]=f,r[10]=u*v}else if(n.order==="ZYX"){const b=u*g,w=u*y,A=f*g,M=f*y;r[0]=v*g,r[4]=A*m-w,r[8]=b*m+M,r[1]=v*y,r[5]=M*m+b,r[9]=w*m-A,r[2]=-m,r[6]=f*v,r[10]=u*v}else if(n.order==="YZX"){const b=u*v,w=u*m,A=f*v,M=f*m;r[0]=v*g,r[4]=M-b*y,r[8]=A*y+w,r[1]=y,r[5]=u*g,r[9]=-f*g,r[2]=-m*g,r[6]=w*y+A,r[10]=b-M*y}else if(n.order==="XZY"){const b=u*v,w=u*m,A=f*v,M=f*m;r[0]=v*g,r[4]=-y,r[8]=m*g,r[1]=b*y+M,r[5]=u*g,r[9]=w*y-A,r[2]=A*y-w,r[6]=f*g,r[10]=M*y+b}return r[3]=0,r[7]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this}makeRotationFromQuaternion(n){return this.compose(H6,n,z6)}lookAt(n,r,a){const s=this.elements;return eo.subVectors(n,r),eo.lengthSq()===0&&(eo.z=1),eo.normalize(),Bl.crossVectors(a,eo),Bl.lengthSq()===0&&(Math.abs(a.z)===1?eo.x+=1e-4:eo.z+=1e-4,eo.normalize(),Bl.crossVectors(a,eo)),Bl.normalize(),jv.crossVectors(eo,Bl),s[0]=Bl.x,s[4]=jv.x,s[8]=eo.x,s[1]=Bl.y,s[5]=jv.y,s[9]=eo.y,s[2]=Bl.z,s[6]=jv.z,s[10]=eo.z,this}multiply(n,r){return r!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(n,r)):this.multiplyMatrices(this,n)}premultiply(n){return this.multiplyMatrices(n,this)}multiplyMatrices(n,r){const a=n.elements,s=r.elements,o=this.elements,u=a[0],f=a[4],v=a[8],m=a[12],g=a[1],y=a[5],b=a[9],w=a[13],A=a[2],M=a[6],S=a[10],E=a[14],T=a[3],C=a[7],L=a[11],P=a[15],N=s[0],F=s[4],X=s[8],Y=s[12],ae=s[1],$=s[5],de=s[9],D=s[13],I=s[2],k=s[6],U=s[10],W=s[14],ce=s[3],oe=s[7],ge=s[11],_e=s[15];return o[0]=u*N+f*ae+v*I+m*ce,o[4]=u*F+f*$+v*k+m*oe,o[8]=u*X+f*de+v*U+m*ge,o[12]=u*Y+f*D+v*W+m*_e,o[1]=g*N+y*ae+b*I+w*ce,o[5]=g*F+y*$+b*k+w*oe,o[9]=g*X+y*de+b*U+w*ge,o[13]=g*Y+y*D+b*W+w*_e,o[2]=A*N+M*ae+S*I+E*ce,o[6]=A*F+M*$+S*k+E*oe,o[10]=A*X+M*de+S*U+E*ge,o[14]=A*Y+M*D+S*W+E*_e,o[3]=T*N+C*ae+L*I+P*ce,o[7]=T*F+C*$+L*k+P*oe,o[11]=T*X+C*de+L*U+P*ge,o[15]=T*Y+C*D+L*W+P*_e,this}multiplyScalar(n){const r=this.elements;return r[0]*=n,r[4]*=n,r[8]*=n,r[12]*=n,r[1]*=n,r[5]*=n,r[9]*=n,r[13]*=n,r[2]*=n,r[6]*=n,r[10]*=n,r[14]*=n,r[3]*=n,r[7]*=n,r[11]*=n,r[15]*=n,this}determinant(){const n=this.elements,r=n[0],a=n[4],s=n[8],o=n[12],u=n[1],f=n[5],v=n[9],m=n[13],g=n[2],y=n[6],b=n[10],w=n[14],A=n[3],M=n[7],S=n[11],E=n[15];return A*(+o*v*y-s*m*y-o*f*b+a*m*b+s*f*w-a*v*w)+M*(+r*v*w-r*m*b+o*u*b-s*u*w+s*m*g-o*v*g)+S*(+r*m*y-r*f*w-o*u*y+a*u*w+o*f*g-a*m*g)+E*(-s*f*g-r*v*y+r*f*b+s*u*y-a*u*b+a*v*g)}transpose(){const n=this.elements;let r;return r=n[1],n[1]=n[4],n[4]=r,r=n[2],n[2]=n[8],n[8]=r,r=n[6],n[6]=n[9],n[9]=r,r=n[3],n[3]=n[12],n[12]=r,r=n[7],n[7]=n[13],n[13]=r,r=n[11],n[11]=n[14],n[14]=r,this}setPosition(n,r,a){const s=this.elements;return n.isVector3?(s[12]=n.x,s[13]=n.y,s[14]=n.z):(s[12]=n,s[13]=r,s[14]=a),this}invert(){const n=this.elements,r=n[0],a=n[1],s=n[2],o=n[3],u=n[4],f=n[5],v=n[6],m=n[7],g=n[8],y=n[9],b=n[10],w=n[11],A=n[12],M=n[13],S=n[14],E=n[15],T=y*S*m-M*b*m+M*v*w-f*S*w-y*v*E+f*b*E,C=A*b*m-g*S*m-A*v*w+u*S*w+g*v*E-u*b*E,L=g*M*m-A*y*m+A*f*w-u*M*w-g*f*E+u*y*E,P=A*y*v-g*M*v-A*f*b+u*M*b+g*f*S-u*y*S,N=r*T+a*C+s*L+o*P;if(N===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const F=1/N;return n[0]=T*F,n[1]=(M*b*o-y*S*o-M*s*w+a*S*w+y*s*E-a*b*E)*F,n[2]=(f*S*o-M*v*o+M*s*m-a*S*m-f*s*E+a*v*E)*F,n[3]=(y*v*o-f*b*o-y*s*m+a*b*m+f*s*w-a*v*w)*F,n[4]=C*F,n[5]=(g*S*o-A*b*o+A*s*w-r*S*w-g*s*E+r*b*E)*F,n[6]=(A*v*o-u*S*o-A*s*m+r*S*m+u*s*E-r*v*E)*F,n[7]=(u*b*o-g*v*o+g*s*m-r*b*m-u*s*w+r*v*w)*F,n[8]=L*F,n[9]=(A*y*o-g*M*o-A*a*w+r*M*w+g*a*E-r*y*E)*F,n[10]=(u*M*o-A*f*o+A*a*m-r*M*m-u*a*E+r*f*E)*F,n[11]=(g*f*o-u*y*o-g*a*m+r*y*m+u*a*w-r*f*w)*F,n[12]=P*F,n[13]=(g*M*s-A*y*s+A*a*b-r*M*b-g*a*S+r*y*S)*F,n[14]=(A*f*s-u*M*s-A*a*v+r*M*v+u*a*S-r*f*S)*F,n[15]=(u*y*s-g*f*s+g*a*v-r*y*v-u*a*b+r*f*b)*F,this}scale(n){const r=this.elements,a=n.x,s=n.y,o=n.z;return r[0]*=a,r[4]*=s,r[8]*=o,r[1]*=a,r[5]*=s,r[9]*=o,r[2]*=a,r[6]*=s,r[10]*=o,r[3]*=a,r[7]*=s,r[11]*=o,this}getMaxScaleOnAxis(){const n=this.elements,r=n[0]*n[0]+n[1]*n[1]+n[2]*n[2],a=n[4]*n[4]+n[5]*n[5]+n[6]*n[6],s=n[8]*n[8]+n[9]*n[9]+n[10]*n[10];return Math.sqrt(Math.max(r,a,s))}makeTranslation(n,r,a){return this.set(1,0,0,n,0,1,0,r,0,0,1,a,0,0,0,1),this}makeRotationX(n){const r=Math.cos(n),a=Math.sin(n);return this.set(1,0,0,0,0,r,-a,0,0,a,r,0,0,0,0,1),this}makeRotationY(n){const r=Math.cos(n),a=Math.sin(n);return this.set(r,0,a,0,0,1,0,0,-a,0,r,0,0,0,0,1),this}makeRotationZ(n){const r=Math.cos(n),a=Math.sin(n);return this.set(r,-a,0,0,a,r,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(n,r){const a=Math.cos(r),s=Math.sin(r),o=1-a,u=n.x,f=n.y,v=n.z,m=o*u,g=o*f;return this.set(m*u+a,m*f-s*v,m*v+s*f,0,m*f+s*v,g*f+a,g*v-s*u,0,m*v-s*f,g*v+s*u,o*v*v+a,0,0,0,0,1),this}makeScale(n,r,a){return this.set(n,0,0,0,0,r,0,0,0,0,a,0,0,0,0,1),this}makeShear(n,r,a,s,o,u){return this.set(1,a,o,0,n,1,u,0,r,s,1,0,0,0,0,1),this}compose(n,r,a){const s=this.elements,o=r._x,u=r._y,f=r._z,v=r._w,m=o+o,g=u+u,y=f+f,b=o*m,w=o*g,A=o*y,M=u*g,S=u*y,E=f*y,T=v*m,C=v*g,L=v*y,P=a.x,N=a.y,F=a.z;return s[0]=(1-(M+E))*P,s[1]=(w+L)*P,s[2]=(A-C)*P,s[3]=0,s[4]=(w-L)*N,s[5]=(1-(b+E))*N,s[6]=(S+T)*N,s[7]=0,s[8]=(A+C)*F,s[9]=(S-T)*F,s[10]=(1-(b+M))*F,s[11]=0,s[12]=n.x,s[13]=n.y,s[14]=n.z,s[15]=1,this}decompose(n,r,a){const s=this.elements;let o=vh.set(s[0],s[1],s[2]).length();const u=vh.set(s[4],s[5],s[6]).length(),f=vh.set(s[8],s[9],s[10]).length();this.determinant()<0&&(o=-o),n.x=s[12],n.y=s[13],n.z=s[14],Oo.copy(this);const m=1/o,g=1/u,y=1/f;return Oo.elements[0]*=m,Oo.elements[1]*=m,Oo.elements[2]*=m,Oo.elements[4]*=g,Oo.elements[5]*=g,Oo.elements[6]*=g,Oo.elements[8]*=y,Oo.elements[9]*=y,Oo.elements[10]*=y,r.setFromRotationMatrix(Oo),a.x=o,a.y=u,a.z=f,this}makePerspective(n,r,a,s,o,u){u===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const f=this.elements,v=2*o/(r-n),m=2*o/(a-s),g=(r+n)/(r-n),y=(a+s)/(a-s),b=-(u+o)/(u-o),w=-2*u*o/(u-o);return f[0]=v,f[4]=0,f[8]=g,f[12]=0,f[1]=0,f[5]=m,f[9]=y,f[13]=0,f[2]=0,f[6]=0,f[10]=b,f[14]=w,f[3]=0,f[7]=0,f[11]=-1,f[15]=0,this}makeOrthographic(n,r,a,s,o,u){const f=this.elements,v=1/(r-n),m=1/(a-s),g=1/(u-o),y=(r+n)*v,b=(a+s)*m,w=(u+o)*g;return f[0]=2*v,f[4]=0,f[8]=0,f[12]=-y,f[1]=0,f[5]=2*m,f[9]=0,f[13]=-b,f[2]=0,f[6]=0,f[10]=-2*g,f[14]=-w,f[3]=0,f[7]=0,f[11]=0,f[15]=1,this}equals(n){const r=this.elements,a=n.elements;for(let s=0;s<16;s++)if(r[s]!==a[s])return!1;return!0}fromArray(n,r=0){for(let a=0;a<16;a++)this.elements[a]=n[a+r];return this}toArray(n=[],r=0){const a=this.elements;return n[r]=a[0],n[r+1]=a[1],n[r+2]=a[2],n[r+3]=a[3],n[r+4]=a[4],n[r+5]=a[5],n[r+6]=a[6],n[r+7]=a[7],n[r+8]=a[8],n[r+9]=a[9],n[r+10]=a[10],n[r+11]=a[11],n[r+12]=a[12],n[r+13]=a[13],n[r+14]=a[14],n[r+15]=a[15],n}}jn.prototype.isMatrix4=!0;const vh=new Ze,Oo=new jn,H6=new Ze(0,0,0),z6=new Ze(1,1,1),Bl=new Ze,jv=new Ze,eo=new Ze,GS=new jn,VS=new Ui;class gh{constructor(n=0,r=0,a=0,s=gh.DefaultOrder){this._x=n,this._y=r,this._z=a,this._order=s}get x(){return this._x}set x(n){this._x=n,this._onChangeCallback()}get y(){return this._y}set y(n){this._y=n,this._onChangeCallback()}get z(){return this._z}set z(n){this._z=n,this._onChangeCallback()}get order(){return this._order}set order(n){this._order=n,this._onChangeCallback()}set(n,r,a,s=this._order){return this._x=n,this._y=r,this._z=a,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(n){return this._x=n._x,this._y=n._y,this._z=n._z,this._order=n._order,this._onChangeCallback(),this}setFromRotationMatrix(n,r=this._order,a=!0){const s=n.elements,o=s[0],u=s[4],f=s[8],v=s[1],m=s[5],g=s[9],y=s[2],b=s[6],w=s[10];switch(r){case"XYZ":this._y=Math.asin(Fa(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(-g,w),this._z=Math.atan2(-u,o)):(this._x=Math.atan2(b,m),this._z=0);break;case"YXZ":this._x=Math.asin(-Fa(g,-1,1)),Math.abs(g)<.9999999?(this._y=Math.atan2(f,w),this._z=Math.atan2(v,m)):(this._y=Math.atan2(-y,o),this._z=0);break;case"ZXY":this._x=Math.asin(Fa(b,-1,1)),Math.abs(b)<.9999999?(this._y=Math.atan2(-y,w),this._z=Math.atan2(-u,m)):(this._y=0,this._z=Math.atan2(v,o));break;case"ZYX":this._y=Math.asin(-Fa(y,-1,1)),Math.abs(y)<.9999999?(this._x=Math.atan2(b,w),this._z=Math.atan2(v,o)):(this._x=0,this._z=Math.atan2(-u,m));break;case"YZX":this._z=Math.asin(Fa(v,-1,1)),Math.abs(v)<.9999999?(this._x=Math.atan2(-g,m),this._y=Math.atan2(-y,o)):(this._x=0,this._y=Math.atan2(f,w));break;case"XZY":this._z=Math.asin(-Fa(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(b,m),this._y=Math.atan2(f,o)):(this._x=Math.atan2(-g,w),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+r)}return this._order=r,a===!0&&this._onChangeCallback(),this}setFromQuaternion(n,r,a){return GS.makeRotationFromQuaternion(n),this.setFromRotationMatrix(GS,r,a)}setFromVector3(n,r=this._order){return this.set(n.x,n.y,n.z,r)}reorder(n){return VS.setFromEuler(this),this.setFromQuaternion(VS,n)}equals(n){return n._x===this._x&&n._y===this._y&&n._z===this._z&&n._order===this._order}fromArray(n){return this._x=n[0],this._y=n[1],this._z=n[2],n[3]!==void 0&&(this._order=n[3]),this._onChangeCallback(),this}toArray(n=[],r=0){return n[r]=this._x,n[r+1]=this._y,n[r+2]=this._z,n[r+3]=this._order,n}toVector3(n){return n?n.set(this._x,this._y,this._z):new Ze(this._x,this._y,this._z)}_onChange(n){return this._onChangeCallback=n,this}_onChangeCallback(){}}gh.prototype.isEuler=!0;gh.DefaultOrder="XYZ";gh.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class WS{constructor(){this.mask=1|0}set(n){this.mask=1<<n|0}enable(n){this.mask|=1<<n|0}enableAll(){this.mask=4294967295|0}toggle(n){this.mask^=1<<n|0}disable(n){this.mask&=~(1<<n|0)}disableAll(){this.mask=0}test(n){return(this.mask&n.mask)!=0}}let G6=0;const jS=new Ze,yh=new Ui,Fs=new jn,Xv=new Ze,Md=new Ze,V6=new Ze,W6=new Ui,XS=new Ze(1,0,0),qS=new Ze(0,1,0),YS=new Ze(0,0,1),j6={type:"added"},$S={type:"removed"};class ei extends uo{constructor(){super();Object.defineProperty(this,"id",{value:G6++}),this.uuid=is(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ei.DefaultUp.clone();const n=new Ze,r=new gh,a=new Ui,s=new Ze(1,1,1);function o(){a.setFromEuler(r,!1)}function u(){r.setFromQuaternion(a,void 0,!1)}r._onChange(o),a._onChange(u),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:n},rotation:{configurable:!0,enumerable:!0,value:r},quaternion:{configurable:!0,enumerable:!0,value:a},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new jn},normalMatrix:{value:new na}}),this.matrix=new jn,this.matrixWorld=new jn,this.matrixAutoUpdate=ei.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new WS,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(n){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(n),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(n){return this.quaternion.premultiply(n),this}setRotationFromAxisAngle(n,r){this.quaternion.setFromAxisAngle(n,r)}setRotationFromEuler(n){this.quaternion.setFromEuler(n,!0)}setRotationFromMatrix(n){this.quaternion.setFromRotationMatrix(n)}setRotationFromQuaternion(n){this.quaternion.copy(n)}rotateOnAxis(n,r){return yh.setFromAxisAngle(n,r),this.quaternion.multiply(yh),this}rotateOnWorldAxis(n,r){return yh.setFromAxisAngle(n,r),this.quaternion.premultiply(yh),this}rotateX(n){return this.rotateOnAxis(XS,n)}rotateY(n){return this.rotateOnAxis(qS,n)}rotateZ(n){return this.rotateOnAxis(YS,n)}translateOnAxis(n,r){return jS.copy(n).applyQuaternion(this.quaternion),this.position.add(jS.multiplyScalar(r)),this}translateX(n){return this.translateOnAxis(XS,n)}translateY(n){return this.translateOnAxis(qS,n)}translateZ(n){return this.translateOnAxis(YS,n)}localToWorld(n){return n.applyMatrix4(this.matrixWorld)}worldToLocal(n){return n.applyMatrix4(Fs.copy(this.matrixWorld).invert())}lookAt(n,r,a){n.isVector3?Xv.copy(n):Xv.set(n,r,a);const s=this.parent;this.updateWorldMatrix(!0,!1),Md.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Fs.lookAt(Md,Xv,this.up):Fs.lookAt(Xv,Md,this.up),this.quaternion.setFromRotationMatrix(Fs),s&&(Fs.extractRotation(s.matrixWorld),yh.setFromRotationMatrix(Fs),this.quaternion.premultiply(yh.invert()))}add(n){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.add(arguments[r]);return this}return n===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",n),this):(n&&n.isObject3D?(n.parent!==null&&n.parent.remove(n),n.parent=this,this.children.push(n),n.dispatchEvent(j6)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",n),this)}remove(n){if(arguments.length>1){for(let a=0;a<arguments.length;a++)this.remove(arguments[a]);return this}const r=this.children.indexOf(n);return r!==-1&&(n.parent=null,this.children.splice(r,1),n.dispatchEvent($S)),this}removeFromParent(){const n=this.parent;return n!==null&&n.remove(this),this}clear(){for(let n=0;n<this.children.length;n++){const r=this.children[n];r.parent=null,r.dispatchEvent($S)}return this.children.length=0,this}attach(n){return this.updateWorldMatrix(!0,!1),Fs.copy(this.matrixWorld).invert(),n.parent!==null&&(n.parent.updateWorldMatrix(!0,!1),Fs.multiply(n.parent.matrixWorld)),n.applyMatrix4(Fs),this.add(n),n.updateWorldMatrix(!1,!0),this}getObjectById(n){return this.getObjectByProperty("id",n)}getObjectByName(n){return this.getObjectByProperty("name",n)}getObjectByProperty(n,r){if(this[n]===r)return this;for(let a=0,s=this.children.length;a<s;a++){const u=this.children[a].getObjectByProperty(n,r);if(u!==void 0)return u}}getWorldPosition(n){return this.updateWorldMatrix(!0,!1),n.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(n){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Md,n,V6),n}getWorldScale(n){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Md,W6,n),n}getWorldDirection(n){this.updateWorldMatrix(!0,!1);const r=this.matrixWorld.elements;return n.set(r[8],r[9],r[10]).normalize()}raycast(){}traverse(n){n(this);const r=this.children;for(let a=0,s=r.length;a<s;a++)r[a].traverse(n)}traverseVisible(n){if(this.visible===!1)return;n(this);const r=this.children;for(let a=0,s=r.length;a<s;a++)r[a].traverseVisible(n)}traverseAncestors(n){const r=this.parent;r!==null&&(n(r),r.traverseAncestors(n))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(n){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||n)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,n=!0);const r=this.children;for(let a=0,s=r.length;a<s;a++)r[a].updateMatrixWorld(n)}updateWorldMatrix(n,r){const a=this.parent;if(n===!0&&a!==null&&a.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),r===!0){const s=this.children;for(let o=0,u=s.length;o<u;o++)s[o].updateWorldMatrix(!1,!0)}}toJSON(n){const r=n===void 0||typeof n=="string",a={};r&&(n={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},a.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON()));function o(f,v){return f[v.uuid]===void 0&&(f[v.uuid]=v.toJSON(n)),v.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(n).uuid)),this.environment&&this.environment.isTexture&&(s.environment=this.environment.toJSON(n).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(n.geometries,this.geometry);const f=this.geometry.parameters;if(f!==void 0&&f.shapes!==void 0){const v=f.shapes;if(Array.isArray(v))for(let m=0,g=v.length;m<g;m++){const y=v[m];o(n.shapes,y)}else o(n.shapes,v)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(n.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const f=[];for(let v=0,m=this.material.length;v<m;v++)f.push(o(n.materials,this.material[v]));s.material=f}else s.material=o(n.materials,this.material);if(this.children.length>0){s.children=[];for(let f=0;f<this.children.length;f++)s.children.push(this.children[f].toJSON(n).object)}if(this.animations.length>0){s.animations=[];for(let f=0;f<this.animations.length;f++){const v=this.animations[f];s.animations.push(o(n.animations,v))}}if(r){const f=u(n.geometries),v=u(n.materials),m=u(n.textures),g=u(n.images),y=u(n.shapes),b=u(n.skeletons),w=u(n.animations);f.length>0&&(a.geometries=f),v.length>0&&(a.materials=v),m.length>0&&(a.textures=m),g.length>0&&(a.images=g),y.length>0&&(a.shapes=y),b.length>0&&(a.skeletons=b),w.length>0&&(a.animations=w)}return a.object=s,a;function u(f){const v=[];for(const m in f){const g=f[m];delete g.metadata,v.push(g)}return v}}clone(n){return new this.constructor().copy(this,n)}copy(n,r=!0){if(this.name=n.name,this.up.copy(n.up),this.position.copy(n.position),this.rotation.order=n.rotation.order,this.quaternion.copy(n.quaternion),this.scale.copy(n.scale),this.matrix.copy(n.matrix),this.matrixWorld.copy(n.matrixWorld),this.matrixAutoUpdate=n.matrixAutoUpdate,this.matrixWorldNeedsUpdate=n.matrixWorldNeedsUpdate,this.layers.mask=n.layers.mask,this.visible=n.visible,this.castShadow=n.castShadow,this.receiveShadow=n.receiveShadow,this.frustumCulled=n.frustumCulled,this.renderOrder=n.renderOrder,this.userData=JSON.parse(JSON.stringify(n.userData)),r===!0)for(let a=0;a<n.children.length;a++){const s=n.children[a];this.add(s.clone())}return this}}ei.DefaultUp=new Ze(0,1,0);ei.DefaultMatrixAutoUpdate=!0;ei.prototype.isObject3D=!0;const Io=new Ze,Bs=new Ze,hx=new Ze,Ns=new Ze,bh=new Ze,xh=new Ze,KS=new Ze,fx=new Ze,dx=new Ze,px=new Ze;class Hi{constructor(n=new Ze,r=new Ze,a=new Ze){this.a=n,this.b=r,this.c=a}static getNormal(n,r,a,s){s.subVectors(a,r),Io.subVectors(n,r),s.cross(Io);const o=s.lengthSq();return o>0?s.multiplyScalar(1/Math.sqrt(o)):s.set(0,0,0)}static getBarycoord(n,r,a,s,o){Io.subVectors(s,r),Bs.subVectors(a,r),hx.subVectors(n,r);const u=Io.dot(Io),f=Io.dot(Bs),v=Io.dot(hx),m=Bs.dot(Bs),g=Bs.dot(hx),y=u*m-f*f;if(y===0)return o.set(-2,-1,-1);const b=1/y,w=(m*v-f*g)*b,A=(u*g-f*v)*b;return o.set(1-w-A,A,w)}static containsPoint(n,r,a,s){return this.getBarycoord(n,r,a,s,Ns),Ns.x>=0&&Ns.y>=0&&Ns.x+Ns.y<=1}static getUV(n,r,a,s,o,u,f,v){return this.getBarycoord(n,r,a,s,Ns),v.set(0,0),v.addScaledVector(o,Ns.x),v.addScaledVector(u,Ns.y),v.addScaledVector(f,Ns.z),v}static isFrontFacing(n,r,a,s){return Io.subVectors(a,r),Bs.subVectors(n,r),Io.cross(Bs).dot(s)<0}set(n,r,a){return this.a.copy(n),this.b.copy(r),this.c.copy(a),this}setFromPointsAndIndices(n,r,a,s){return this.a.copy(n[r]),this.b.copy(n[a]),this.c.copy(n[s]),this}setFromAttributeAndIndices(n,r,a,s){return this.a.fromBufferAttribute(n,r),this.b.fromBufferAttribute(n,a),this.c.fromBufferAttribute(n,s),this}clone(){return new this.constructor().copy(this)}copy(n){return this.a.copy(n.a),this.b.copy(n.b),this.c.copy(n.c),this}getArea(){return Io.subVectors(this.c,this.b),Bs.subVectors(this.a,this.b),Io.cross(Bs).length()*.5}getMidpoint(n){return n.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(n){return Hi.getNormal(this.a,this.b,this.c,n)}getPlane(n){return n.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(n,r){return Hi.getBarycoord(n,this.a,this.b,this.c,r)}getUV(n,r,a,s,o){return Hi.getUV(n,this.a,this.b,this.c,r,a,s,o)}containsPoint(n){return Hi.containsPoint(n,this.a,this.b,this.c)}isFrontFacing(n){return Hi.isFrontFacing(this.a,this.b,this.c,n)}intersectsBox(n){return n.intersectsTriangle(this)}closestPointToPoint(n,r){const a=this.a,s=this.b,o=this.c;let u,f;bh.subVectors(s,a),xh.subVectors(o,a),fx.subVectors(n,a);const v=bh.dot(fx),m=xh.dot(fx);if(v<=0&&m<=0)return r.copy(a);dx.subVectors(n,s);const g=bh.dot(dx),y=xh.dot(dx);if(g>=0&&y<=g)return r.copy(s);const b=v*y-g*m;if(b<=0&&v>=0&&g<=0)return u=v/(v-g),r.copy(a).addScaledVector(bh,u);px.subVectors(n,o);const w=bh.dot(px),A=xh.dot(px);if(A>=0&&w<=A)return r.copy(o);const M=w*m-v*A;if(M<=0&&m>=0&&A<=0)return f=m/(m-A),r.copy(a).addScaledVector(xh,f);const S=g*A-w*y;if(S<=0&&y-g>=0&&w-A>=0)return KS.subVectors(o,s),f=(y-g)/(y-g+(w-A)),r.copy(s).addScaledVector(KS,f);const E=1/(S+M+b);return u=M*E,f=b*E,r.copy(a).addScaledVector(bh,u).addScaledVector(xh,f)}equals(n){return n.a.equals(this.a)&&n.b.equals(this.b)&&n.c.equals(this.c)}}let X6=0;class da extends uo{constructor(){super();Object.defineProperty(this,"id",{value:X6++}),this.uuid=is(),this.name="",this.type="Material",this.fog=!0,this.blending=gd,this.side=vd,this.vertexColors=!1,this.opacity=1,this.format=ha,this.transparent=!1,this.blendSrc=vS,this.blendDst=gS,this.blendEquation=rh,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Gb,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=O6,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Qb,this.stencilZFail=Qb,this.stencilZPass=Qb,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(n){this._alphaTest>0!=n>0&&this.version++,this._alphaTest=n}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(n){if(n!==void 0)for(const r in n){const a=n[r];if(a===void 0){console.warn("THREE.Material: '"+r+"' parameter is undefined.");continue}if(r==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=a===uS;continue}const s=this[r];if(s===void 0){console.warn("THREE."+this.type+": '"+r+"' is not a property of this material.");continue}s&&s.isColor?s.set(a):s&&s.isVector3&&a&&a.isVector3?s.copy(a):this[r]=a}}toJSON(n){const r=n===void 0||typeof n=="string";r&&(n={textures:{},images:{}});const a={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};a.uuid=this.uuid,a.type=this.type,this.name!==""&&(a.name=this.name),this.color&&this.color.isColor&&(a.color=this.color.getHex()),this.roughness!==void 0&&(a.roughness=this.roughness),this.metalness!==void 0&&(a.metalness=this.metalness),this.sheen!==void 0&&(a.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(a.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(a.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(a.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(a.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(a.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(a.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(a.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(a.shininess=this.shininess),this.clearcoat!==void 0&&(a.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(a.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(a.clearcoatMap=this.clearcoatMap.toJSON(n).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(a.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(n).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(a.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(n).uuid,a.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(a.map=this.map.toJSON(n).uuid),this.matcap&&this.matcap.isTexture&&(a.matcap=this.matcap.toJSON(n).uuid),this.alphaMap&&this.alphaMap.isTexture&&(a.alphaMap=this.alphaMap.toJSON(n).uuid),this.lightMap&&this.lightMap.isTexture&&(a.lightMap=this.lightMap.toJSON(n).uuid,a.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(a.aoMap=this.aoMap.toJSON(n).uuid,a.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(a.bumpMap=this.bumpMap.toJSON(n).uuid,a.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(a.normalMap=this.normalMap.toJSON(n).uuid,a.normalMapType=this.normalMapType,a.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(a.displacementMap=this.displacementMap.toJSON(n).uuid,a.displacementScale=this.displacementScale,a.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(a.roughnessMap=this.roughnessMap.toJSON(n).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(a.metalnessMap=this.metalnessMap.toJSON(n).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(a.emissiveMap=this.emissiveMap.toJSON(n).uuid),this.specularMap&&this.specularMap.isTexture&&(a.specularMap=this.specularMap.toJSON(n).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(a.specularIntensityMap=this.specularIntensityMap.toJSON(n).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(a.specularColorMap=this.specularColorMap.toJSON(n).uuid),this.envMap&&this.envMap.isTexture&&(a.envMap=this.envMap.toJSON(n).uuid,this.combine!==void 0&&(a.combine=this.combine)),this.envMapIntensity!==void 0&&(a.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(a.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(a.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(a.gradientMap=this.gradientMap.toJSON(n).uuid),this.transmission!==void 0&&(a.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(a.transmissionMap=this.transmissionMap.toJSON(n).uuid),this.thickness!==void 0&&(a.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(a.thicknessMap=this.thicknessMap.toJSON(n).uuid),this.attenuationDistance!==void 0&&(a.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(a.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(a.size=this.size),this.shadowSide!==null&&(a.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(a.sizeAttenuation=this.sizeAttenuation),this.blending!==gd&&(a.blending=this.blending),this.side!==vd&&(a.side=this.side),this.vertexColors&&(a.vertexColors=!0),this.opacity<1&&(a.opacity=this.opacity),this.format!==ha&&(a.format=this.format),this.transparent===!0&&(a.transparent=this.transparent),a.depthFunc=this.depthFunc,a.depthTest=this.depthTest,a.depthWrite=this.depthWrite,a.colorWrite=this.colorWrite,a.stencilWrite=this.stencilWrite,a.stencilWriteMask=this.stencilWriteMask,a.stencilFunc=this.stencilFunc,a.stencilRef=this.stencilRef,a.stencilFuncMask=this.stencilFuncMask,a.stencilFail=this.stencilFail,a.stencilZFail=this.stencilZFail,a.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(a.rotation=this.rotation),this.polygonOffset===!0&&(a.polygonOffset=!0),this.polygonOffsetFactor!==0&&(a.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(a.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(a.linewidth=this.linewidth),this.dashSize!==void 0&&(a.dashSize=this.dashSize),this.gapSize!==void 0&&(a.gapSize=this.gapSize),this.scale!==void 0&&(a.scale=this.scale),this.dithering===!0&&(a.dithering=!0),this.alphaTest>0&&(a.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(a.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(a.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(a.wireframe=this.wireframe),this.wireframeLinewidth>1&&(a.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(a.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(a.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(a.flatShading=this.flatShading),this.visible===!1&&(a.visible=!1),this.toneMapped===!1&&(a.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(a.userData=this.userData);function s(o){const u=[];for(const f in o){const v=o[f];delete v.metadata,u.push(v)}return u}if(r){const o=s(n.textures),u=s(n.images);o.length>0&&(a.textures=o),u.length>0&&(a.images=u)}return a}clone(){return new this.constructor().copy(this)}copy(n){this.name=n.name,this.fog=n.fog,this.blending=n.blending,this.side=n.side,this.vertexColors=n.vertexColors,this.opacity=n.opacity,this.format=n.format,this.transparent=n.transparent,this.blendSrc=n.blendSrc,this.blendDst=n.blendDst,this.blendEquation=n.blendEquation,this.blendSrcAlpha=n.blendSrcAlpha,this.blendDstAlpha=n.blendDstAlpha,this.blendEquationAlpha=n.blendEquationAlpha,this.depthFunc=n.depthFunc,this.depthTest=n.depthTest,this.depthWrite=n.depthWrite,this.stencilWriteMask=n.stencilWriteMask,this.stencilFunc=n.stencilFunc,this.stencilRef=n.stencilRef,this.stencilFuncMask=n.stencilFuncMask,this.stencilFail=n.stencilFail,this.stencilZFail=n.stencilZFail,this.stencilZPass=n.stencilZPass,this.stencilWrite=n.stencilWrite;const r=n.clippingPlanes;let a=null;if(r!==null){const s=r.length;a=new Array(s);for(let o=0;o!==s;++o)a[o]=r[o].clone()}return this.clippingPlanes=a,this.clipIntersection=n.clipIntersection,this.clipShadows=n.clipShadows,this.shadowSide=n.shadowSide,this.colorWrite=n.colorWrite,this.precision=n.precision,this.polygonOffset=n.polygonOffset,this.polygonOffsetFactor=n.polygonOffsetFactor,this.polygonOffsetUnits=n.polygonOffsetUnits,this.dithering=n.dithering,this.alphaTest=n.alphaTest,this.alphaToCoverage=n.alphaToCoverage,this.premultipliedAlpha=n.premultipliedAlpha,this.visible=n.visible,this.toneMapped=n.toneMapped,this.userData=JSON.parse(JSON.stringify(n.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(n){n===!0&&this.version++}}da.prototype.isMaterial=!0;const ZS={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ko={h:0,s:0,l:0},qv={h:0,s:0,l:0};function mx(i,n,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?i+(n-i)*6*r:r<1/2?n:r<2/3?i+(n-i)*6*(2/3-r):i}function vx(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function gx(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}class On{constructor(n,r,a){return r===void 0&&a===void 0?this.set(n):this.setRGB(n,r,a)}set(n){return n&&n.isColor?this.copy(n):typeof n=="number"?this.setHex(n):typeof n=="string"&&this.setStyle(n),this}setScalar(n){return this.r=n,this.g=n,this.b=n,this}setHex(n){return n=Math.floor(n),this.r=(n>>16&255)/255,this.g=(n>>8&255)/255,this.b=(n&255)/255,this}setRGB(n,r,a){return this.r=n,this.g=r,this.b=a,this}setHSL(n,r,a){if(n=k6(n,1),r=Fa(r,0,1),a=Fa(a,0,1),r===0)this.r=this.g=this.b=a;else{const s=a<=.5?a*(1+r):a+r-a*r,o=2*a-s;this.r=mx(o,s,n+1/3),this.g=mx(o,s,n),this.b=mx(o,s,n-1/3)}return this}setStyle(n){function r(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+n+" will be ignored.")}let a;if(a=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(n)){let s;const o=a[1],u=a[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,r(s[4]),this;if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,r(s[4]),this;break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u)){const f=parseFloat(s[1])/360,v=parseInt(s[2],10)/100,m=parseInt(s[3],10)/100;return r(s[4]),this.setHSL(f,v,m)}break}}else if(a=/^\#([A-Fa-f\d]+)$/.exec(n)){const s=a[1],o=s.length;if(o===3)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,this;if(o===6)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,this}return n&&n.length>0?this.setColorName(n):this}setColorName(n){const r=ZS[n.toLowerCase()];return r!==void 0?this.setHex(r):console.warn("THREE.Color: Unknown color "+n),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(n){return this.r=n.r,this.g=n.g,this.b=n.b,this}copyGammaToLinear(n,r=2){return this.r=Math.pow(n.r,r),this.g=Math.pow(n.g,r),this.b=Math.pow(n.b,r),this}copyLinearToGamma(n,r=2){const a=r>0?1/r:1;return this.r=Math.pow(n.r,a),this.g=Math.pow(n.g,a),this.b=Math.pow(n.b,a),this}convertGammaToLinear(n){return this.copyGammaToLinear(this,n),this}convertLinearToGamma(n){return this.copyLinearToGamma(this,n),this}copySRGBToLinear(n){return this.r=vx(n.r),this.g=vx(n.g),this.b=vx(n.b),this}copyLinearToSRGB(n){return this.r=gx(n.r),this.g=gx(n.g),this.b=gx(n.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return this.r*255<<16^this.g*255<<8^this.b*255<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(n){const r=this.r,a=this.g,s=this.b,o=Math.max(r,a,s),u=Math.min(r,a,s);let f,v;const m=(u+o)/2;if(u===o)f=0,v=0;else{const g=o-u;switch(v=m<=.5?g/(o+u):g/(2-o-u),o){case r:f=(a-s)/g+(a<s?6:0);break;case a:f=(s-r)/g+2;break;case s:f=(r-a)/g+4;break}f/=6}return n.h=f,n.s=v,n.l=m,n}getStyle(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"}offsetHSL(n,r,a){return this.getHSL(ko),ko.h+=n,ko.s+=r,ko.l+=a,this.setHSL(ko.h,ko.s,ko.l),this}add(n){return this.r+=n.r,this.g+=n.g,this.b+=n.b,this}addColors(n,r){return this.r=n.r+r.r,this.g=n.g+r.g,this.b=n.b+r.b,this}addScalar(n){return this.r+=n,this.g+=n,this.b+=n,this}sub(n){return this.r=Math.max(0,this.r-n.r),this.g=Math.max(0,this.g-n.g),this.b=Math.max(0,this.b-n.b),this}multiply(n){return this.r*=n.r,this.g*=n.g,this.b*=n.b,this}multiplyScalar(n){return this.r*=n,this.g*=n,this.b*=n,this}lerp(n,r){return this.r+=(n.r-this.r)*r,this.g+=(n.g-this.g)*r,this.b+=(n.b-this.b)*r,this}lerpColors(n,r,a){return this.r=n.r+(r.r-n.r)*a,this.g=n.g+(r.g-n.g)*a,this.b=n.b+(r.b-n.b)*a,this}lerpHSL(n,r){this.getHSL(ko),n.getHSL(qv);const a=tx(ko.h,qv.h,r),s=tx(ko.s,qv.s,r),o=tx(ko.l,qv.l,r);return this.setHSL(a,s,o),this}equals(n){return n.r===this.r&&n.g===this.g&&n.b===this.b}fromArray(n,r=0){return this.r=n[r],this.g=n[r+1],this.b=n[r+2],this}toArray(n=[],r=0){return n[r]=this.r,n[r+1]=this.g,n[r+2]=this.b,n}fromBufferAttribute(n,r){return this.r=n.getX(r),this.g=n.getY(r),this.b=n.getZ(r),n.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}On.NAMES=ZS;On.prototype.isColor=!0;On.prototype.r=1;On.prototype.g=1;On.prototype.b=1;class Yv extends da{constructor(n){super();this.type="MeshBasicMaterial",this.color=new On(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Pv,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(n)}copy(n){return super.copy(n),this.color.copy(n.color),this.map=n.map,this.lightMap=n.lightMap,this.lightMapIntensity=n.lightMapIntensity,this.aoMap=n.aoMap,this.aoMapIntensity=n.aoMapIntensity,this.specularMap=n.specularMap,this.alphaMap=n.alphaMap,this.envMap=n.envMap,this.combine=n.combine,this.reflectivity=n.reflectivity,this.refractionRatio=n.refractionRatio,this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.wireframeLinecap=n.wireframeLinecap,this.wireframeLinejoin=n.wireframeLinejoin,this}}Yv.prototype.isMeshBasicMaterial=!0;const pi=new Ze,$v=new Wt;class zi{constructor(n,r,a){if(Array.isArray(n))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=n,this.itemSize=r,this.count=n!==void 0?n.length/r:0,this.normalized=a===!0,this.usage=Ad,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(n){n===!0&&this.version++}setUsage(n){return this.usage=n,this}copy(n){return this.name=n.name,this.array=new n.array.constructor(n.array),this.itemSize=n.itemSize,this.count=n.count,this.normalized=n.normalized,this.usage=n.usage,this}copyAt(n,r,a){n*=this.itemSize,a*=r.itemSize;for(let s=0,o=this.itemSize;s<o;s++)this.array[n+s]=r.array[a+s];return this}copyArray(n){return this.array.set(n),this}copyColorsArray(n){const r=this.array;let a=0;for(let s=0,o=n.length;s<o;s++){let u=n[s];u===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",s),u=new On),r[a++]=u.r,r[a++]=u.g,r[a++]=u.b}return this}copyVector2sArray(n){const r=this.array;let a=0;for(let s=0,o=n.length;s<o;s++){let u=n[s];u===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",s),u=new Wt),r[a++]=u.x,r[a++]=u.y}return this}copyVector3sArray(n){const r=this.array;let a=0;for(let s=0,o=n.length;s<o;s++){let u=n[s];u===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",s),u=new Ze),r[a++]=u.x,r[a++]=u.y,r[a++]=u.z}return this}copyVector4sArray(n){const r=this.array;let a=0;for(let s=0,o=n.length;s<o;s++){let u=n[s];u===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",s),u=new ci),r[a++]=u.x,r[a++]=u.y,r[a++]=u.z,r[a++]=u.w}return this}applyMatrix3(n){if(this.itemSize===2)for(let r=0,a=this.count;r<a;r++)$v.fromBufferAttribute(this,r),$v.applyMatrix3(n),this.setXY(r,$v.x,$v.y);else if(this.itemSize===3)for(let r=0,a=this.count;r<a;r++)pi.fromBufferAttribute(this,r),pi.applyMatrix3(n),this.setXYZ(r,pi.x,pi.y,pi.z);return this}applyMatrix4(n){for(let r=0,a=this.count;r<a;r++)pi.x=this.getX(r),pi.y=this.getY(r),pi.z=this.getZ(r),pi.applyMatrix4(n),this.setXYZ(r,pi.x,pi.y,pi.z);return this}applyNormalMatrix(n){for(let r=0,a=this.count;r<a;r++)pi.x=this.getX(r),pi.y=this.getY(r),pi.z=this.getZ(r),pi.applyNormalMatrix(n),this.setXYZ(r,pi.x,pi.y,pi.z);return this}transformDirection(n){for(let r=0,a=this.count;r<a;r++)pi.x=this.getX(r),pi.y=this.getY(r),pi.z=this.getZ(r),pi.transformDirection(n),this.setXYZ(r,pi.x,pi.y,pi.z);return this}set(n,r=0){return this.array.set(n,r),this}getX(n){return this.array[n*this.itemSize]}setX(n,r){return this.array[n*this.itemSize]=r,this}getY(n){return this.array[n*this.itemSize+1]}setY(n,r){return this.array[n*this.itemSize+1]=r,this}getZ(n){return this.array[n*this.itemSize+2]}setZ(n,r){return this.array[n*this.itemSize+2]=r,this}getW(n){return this.array[n*this.itemSize+3]}setW(n,r){return this.array[n*this.itemSize+3]=r,this}setXY(n,r,a){return n*=this.itemSize,this.array[n+0]=r,this.array[n+1]=a,this}setXYZ(n,r,a,s){return n*=this.itemSize,this.array[n+0]=r,this.array[n+1]=a,this.array[n+2]=s,this}setXYZW(n,r,a,s,o){return n*=this.itemSize,this.array[n+0]=r,this.array[n+1]=a,this.array[n+2]=s,this.array[n+3]=o,this}onUpload(n){return this.onUploadCallback=n,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const n={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return this.name!==""&&(n.name=this.name),this.usage!==Ad&&(n.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(n.updateRange=this.updateRange),n}}zi.prototype.isBufferAttribute=!0;class QS extends zi{constructor(n,r,a){super(new Uint16Array(n),r,a)}}class JS extends zi{constructor(n,r,a){super(new Uint32Array(n),r,a)}}class q6 extends zi{constructor(n,r,a){super(new Uint16Array(n),r,a)}}q6.prototype.isFloat16BufferAttribute=!0;class Xr extends zi{constructor(n,r,a){super(new Float32Array(n),r,a)}}let Y6=0;const ho=new jn,yx=new ei,wh=new Ze,to=new Ja,Sd=new Ja,Yi=new Ze;class Zr extends uo{constructor(){super();Object.defineProperty(this,"id",{value:Y6++}),this.uuid=is(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(n){return Array.isArray(n)?this.index=new(BS(n)>65535?JS:QS)(n,1):this.index=n,this}getAttribute(n){return this.attributes[n]}setAttribute(n,r){return this.attributes[n]=r,this}deleteAttribute(n){return delete this.attributes[n],this}hasAttribute(n){return this.attributes[n]!==void 0}addGroup(n,r,a=0){this.groups.push({start:n,count:r,materialIndex:a})}clearGroups(){this.groups=[]}setDrawRange(n,r){this.drawRange.start=n,this.drawRange.count=r}applyMatrix4(n){const r=this.attributes.position;r!==void 0&&(r.applyMatrix4(n),r.needsUpdate=!0);const a=this.attributes.normal;if(a!==void 0){const o=new na().getNormalMatrix(n);a.applyNormalMatrix(o),a.needsUpdate=!0}const s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(n),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(n){return ho.makeRotationFromQuaternion(n),this.applyMatrix4(ho),this}rotateX(n){return ho.makeRotationX(n),this.applyMatrix4(ho),this}rotateY(n){return ho.makeRotationY(n),this.applyMatrix4(ho),this}rotateZ(n){return ho.makeRotationZ(n),this.applyMatrix4(ho),this}translate(n,r,a){return ho.makeTranslation(n,r,a),this.applyMatrix4(ho),this}scale(n,r,a){return ho.makeScale(n,r,a),this.applyMatrix4(ho),this}lookAt(n){return yx.lookAt(n),yx.updateMatrix(),this.applyMatrix4(yx.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(wh).negate(),this.translate(wh.x,wh.y,wh.z),this}setFromPoints(n){const r=[];for(let a=0,s=n.length;a<s;a++){const o=n[a];r.push(o.x,o.y,o.z||0)}return this.setAttribute("position",new Xr(r,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ja);const n=this.attributes.position,r=this.morphAttributes.position;if(n&&n.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Ze(-1/0,-1/0,-1/0),new Ze(1/0,1/0,1/0));return}if(n!==void 0){if(this.boundingBox.setFromBufferAttribute(n),r)for(let a=0,s=r.length;a<s;a++){const o=r[a];to.setFromBufferAttribute(o),this.morphTargetsRelative?(Yi.addVectors(this.boundingBox.min,to.min),this.boundingBox.expandByPoint(Yi),Yi.addVectors(this.boundingBox.max,to.max),this.boundingBox.expandByPoint(Yi)):(this.boundingBox.expandByPoint(to.min),this.boundingBox.expandByPoint(to.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new mh);const n=this.attributes.position,r=this.morphAttributes.position;if(n&&n.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Ze,1/0);return}if(n){const a=this.boundingSphere.center;if(to.setFromBufferAttribute(n),r)for(let o=0,u=r.length;o<u;o++){const f=r[o];Sd.setFromBufferAttribute(f),this.morphTargetsRelative?(Yi.addVectors(to.min,Sd.min),to.expandByPoint(Yi),Yi.addVectors(to.max,Sd.max),to.expandByPoint(Yi)):(to.expandByPoint(Sd.min),to.expandByPoint(Sd.max))}to.getCenter(a);let s=0;for(let o=0,u=n.count;o<u;o++)Yi.fromBufferAttribute(n,o),s=Math.max(s,a.distanceToSquared(Yi));if(r)for(let o=0,u=r.length;o<u;o++){const f=r[o],v=this.morphTargetsRelative;for(let m=0,g=f.count;m<g;m++)Yi.fromBufferAttribute(f,m),v&&(wh.fromBufferAttribute(n,m),Yi.add(wh)),s=Math.max(s,a.distanceToSquared(Yi))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const n=this.index,r=this.attributes;if(n===null||r.position===void 0||r.normal===void 0||r.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const a=n.array,s=r.position.array,o=r.normal.array,u=r.uv.array,f=s.length/3;r.tangent===void 0&&this.setAttribute("tangent",new zi(new Float32Array(4*f),4));const v=r.tangent.array,m=[],g=[];for(let ae=0;ae<f;ae++)m[ae]=new Ze,g[ae]=new Ze;const y=new Ze,b=new Ze,w=new Ze,A=new Wt,M=new Wt,S=new Wt,E=new Ze,T=new Ze;function C(ae,$,de){y.fromArray(s,ae*3),b.fromArray(s,$*3),w.fromArray(s,de*3),A.fromArray(u,ae*2),M.fromArray(u,$*2),S.fromArray(u,de*2),b.sub(y),w.sub(y),M.sub(A),S.sub(A);const D=1/(M.x*S.y-S.x*M.y);!isFinite(D)||(E.copy(b).multiplyScalar(S.y).addScaledVector(w,-M.y).multiplyScalar(D),T.copy(w).multiplyScalar(M.x).addScaledVector(b,-S.x).multiplyScalar(D),m[ae].add(E),m[$].add(E),m[de].add(E),g[ae].add(T),g[$].add(T),g[de].add(T))}let L=this.groups;L.length===0&&(L=[{start:0,count:a.length}]);for(let ae=0,$=L.length;ae<$;++ae){const de=L[ae],D=de.start,I=de.count;for(let k=D,U=D+I;k<U;k+=3)C(a[k+0],a[k+1],a[k+2])}const P=new Ze,N=new Ze,F=new Ze,X=new Ze;function Y(ae){F.fromArray(o,ae*3),X.copy(F);const $=m[ae];P.copy($),P.sub(F.multiplyScalar(F.dot($))).normalize(),N.crossVectors(X,$);const D=N.dot(g[ae])<0?-1:1;v[ae*4]=P.x,v[ae*4+1]=P.y,v[ae*4+2]=P.z,v[ae*4+3]=D}for(let ae=0,$=L.length;ae<$;++ae){const de=L[ae],D=de.start,I=de.count;for(let k=D,U=D+I;k<U;k+=3)Y(a[k+0]),Y(a[k+1]),Y(a[k+2])}}computeVertexNormals(){const n=this.index,r=this.getAttribute("position");if(r!==void 0){let a=this.getAttribute("normal");if(a===void 0)a=new zi(new Float32Array(r.count*3),3),this.setAttribute("normal",a);else for(let b=0,w=a.count;b<w;b++)a.setXYZ(b,0,0,0);const s=new Ze,o=new Ze,u=new Ze,f=new Ze,v=new Ze,m=new Ze,g=new Ze,y=new Ze;if(n)for(let b=0,w=n.count;b<w;b+=3){const A=n.getX(b+0),M=n.getX(b+1),S=n.getX(b+2);s.fromBufferAttribute(r,A),o.fromBufferAttribute(r,M),u.fromBufferAttribute(r,S),g.subVectors(u,o),y.subVectors(s,o),g.cross(y),f.fromBufferAttribute(a,A),v.fromBufferAttribute(a,M),m.fromBufferAttribute(a,S),f.add(g),v.add(g),m.add(g),a.setXYZ(A,f.x,f.y,f.z),a.setXYZ(M,v.x,v.y,v.z),a.setXYZ(S,m.x,m.y,m.z)}else for(let b=0,w=r.count;b<w;b+=3)s.fromBufferAttribute(r,b+0),o.fromBufferAttribute(r,b+1),u.fromBufferAttribute(r,b+2),g.subVectors(u,o),y.subVectors(s,o),g.cross(y),a.setXYZ(b+0,g.x,g.y,g.z),a.setXYZ(b+1,g.x,g.y,g.z),a.setXYZ(b+2,g.x,g.y,g.z);this.normalizeNormals(),a.needsUpdate=!0}}merge(n,r){if(!(n&&n.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",n);return}r===void 0&&(r=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const a=this.attributes;for(const s in a){if(n.attributes[s]===void 0)continue;const u=a[s].array,f=n.attributes[s],v=f.array,m=f.itemSize*r,g=Math.min(v.length,u.length-m);for(let y=0,b=m;y<g;y++,b++)u[b]=v[y]}return this}normalizeNormals(){const n=this.attributes.normal;for(let r=0,a=n.count;r<a;r++)Yi.fromBufferAttribute(n,r),Yi.normalize(),n.setXYZ(r,Yi.x,Yi.y,Yi.z)}toNonIndexed(){function n(f,v){const m=f.array,g=f.itemSize,y=f.normalized,b=new m.constructor(v.length*g);let w=0,A=0;for(let M=0,S=v.length;M<S;M++){f.isInterleavedBufferAttribute?w=v[M]*f.data.stride+f.offset:w=v[M]*g;for(let E=0;E<g;E++)b[A++]=m[w++]}return new zi(b,g,y)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const r=new Zr,a=this.index.array,s=this.attributes;for(const f in s){const v=s[f],m=n(v,a);r.setAttribute(f,m)}const o=this.morphAttributes;for(const f in o){const v=[],m=o[f];for(let g=0,y=m.length;g<y;g++){const b=m[g],w=n(b,a);v.push(w)}r.morphAttributes[f]=v}r.morphTargetsRelative=this.morphTargetsRelative;const u=this.groups;for(let f=0,v=u.length;f<v;f++){const m=u[f];r.addGroup(m.start,m.count,m.materialIndex)}return r}toJSON(){const n={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),Object.keys(this.userData).length>0&&(n.userData=this.userData),this.parameters!==void 0){const v=this.parameters;for(const m in v)v[m]!==void 0&&(n[m]=v[m]);return n}n.data={attributes:{}};const r=this.index;r!==null&&(n.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});const a=this.attributes;for(const v in a){const m=a[v];n.data.attributes[v]=m.toJSON(n.data)}const s={};let o=!1;for(const v in this.morphAttributes){const m=this.morphAttributes[v],g=[];for(let y=0,b=m.length;y<b;y++){const w=m[y];g.push(w.toJSON(n.data))}g.length>0&&(s[v]=g,o=!0)}o&&(n.data.morphAttributes=s,n.data.morphTargetsRelative=this.morphTargetsRelative);const u=this.groups;u.length>0&&(n.data.groups=JSON.parse(JSON.stringify(u)));const f=this.boundingSphere;return f!==null&&(n.data.boundingSphere={center:f.center.toArray(),radius:f.radius}),n}clone(){return new this.constructor().copy(this)}copy(n){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const r={};this.name=n.name;const a=n.index;a!==null&&this.setIndex(a.clone(r));const s=n.attributes;for(const m in s){const g=s[m];this.setAttribute(m,g.clone(r))}const o=n.morphAttributes;for(const m in o){const g=[],y=o[m];for(let b=0,w=y.length;b<w;b++)g.push(y[b].clone(r));this.morphAttributes[m]=g}this.morphTargetsRelative=n.morphTargetsRelative;const u=n.groups;for(let m=0,g=u.length;m<g;m++){const y=u[m];this.addGroup(y.start,y.count,y.materialIndex)}const f=n.boundingBox;f!==null&&(this.boundingBox=f.clone());const v=n.boundingSphere;return v!==null&&(this.boundingSphere=v.clone()),this.drawRange.start=n.drawRange.start,this.drawRange.count=n.drawRange.count,this.userData=n.userData,n.parameters!==void 0&&(this.parameters=Object.assign({},n.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}Zr.prototype.isBufferGeometry=!0;const eT=new jn,Ah=new jc,bx=new mh,Nl=new Ze,Ul=new Ze,Hl=new Ze,xx=new Ze,wx=new Ze,Ax=new Ze,Kv=new Ze,Zv=new Ze,Qv=new Ze,Jv=new Wt,eg=new Wt,tg=new Wt,Ex=new Ze,ng=new Ze;class ra extends ei{constructor(n=new Zr,r=new Yv){super();this.type="Mesh",this.geometry=n,this.material=r,this.updateMorphTargets()}copy(n){return super.copy(n),n.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=n.morphTargetInfluences.slice()),n.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},n.morphTargetDictionary)),this.material=n.material,this.geometry=n.geometry,this}updateMorphTargets(){const n=this.geometry;if(n.isBufferGeometry){const r=n.morphAttributes,a=Object.keys(r);if(a.length>0){const s=r[a[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,u=s.length;o<u;o++){const f=s[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[f]=o}}}}else{const r=n.morphTargets;r!==void 0&&r.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(n,r){const a=this.geometry,s=this.material,o=this.matrixWorld;if(s===void 0||(a.boundingSphere===null&&a.computeBoundingSphere(),bx.copy(a.boundingSphere),bx.applyMatrix4(o),n.ray.intersectsSphere(bx)===!1)||(eT.copy(o).invert(),Ah.copy(n.ray).applyMatrix4(eT),a.boundingBox!==null&&Ah.intersectsBox(a.boundingBox)===!1))return;let u;if(a.isBufferGeometry){const f=a.index,v=a.attributes.position,m=a.morphAttributes.position,g=a.morphTargetsRelative,y=a.attributes.uv,b=a.attributes.uv2,w=a.groups,A=a.drawRange;if(f!==null)if(Array.isArray(s))for(let M=0,S=w.length;M<S;M++){const E=w[M],T=s[E.materialIndex],C=Math.max(E.start,A.start),L=Math.min(f.count,Math.min(E.start+E.count,A.start+A.count));for(let P=C,N=L;P<N;P+=3){const F=f.getX(P),X=f.getX(P+1),Y=f.getX(P+2);u=rg(this,T,n,Ah,v,m,g,y,b,F,X,Y),u&&(u.faceIndex=Math.floor(P/3),u.face.materialIndex=E.materialIndex,r.push(u))}}else{const M=Math.max(0,A.start),S=Math.min(f.count,A.start+A.count);for(let E=M,T=S;E<T;E+=3){const C=f.getX(E),L=f.getX(E+1),P=f.getX(E+2);u=rg(this,s,n,Ah,v,m,g,y,b,C,L,P),u&&(u.faceIndex=Math.floor(E/3),r.push(u))}}else if(v!==void 0)if(Array.isArray(s))for(let M=0,S=w.length;M<S;M++){const E=w[M],T=s[E.materialIndex],C=Math.max(E.start,A.start),L=Math.min(v.count,Math.min(E.start+E.count,A.start+A.count));for(let P=C,N=L;P<N;P+=3){const F=P,X=P+1,Y=P+2;u=rg(this,T,n,Ah,v,m,g,y,b,F,X,Y),u&&(u.faceIndex=Math.floor(P/3),u.face.materialIndex=E.materialIndex,r.push(u))}}else{const M=Math.max(0,A.start),S=Math.min(v.count,A.start+A.count);for(let E=M,T=S;E<T;E+=3){const C=E,L=E+1,P=E+2;u=rg(this,s,n,Ah,v,m,g,y,b,C,L,P),u&&(u.faceIndex=Math.floor(E/3),r.push(u))}}}else a.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}ra.prototype.isMesh=!0;function $6(i,n,r,a,s,o,u,f){let v;if(n.side===Ni?v=a.intersectTriangle(u,o,s,!0,f):v=a.intersectTriangle(s,o,u,n.side!==nh,f),v===null)return null;ng.copy(f),ng.applyMatrix4(i.matrixWorld);const m=r.ray.origin.distanceTo(ng);return m<r.near||m>r.far?null:{distance:m,point:ng.clone(),object:i}}function rg(i,n,r,a,s,o,u,f,v,m,g,y){Nl.fromBufferAttribute(s,m),Ul.fromBufferAttribute(s,g),Hl.fromBufferAttribute(s,y);const b=i.morphTargetInfluences;if(o&&b){Kv.set(0,0,0),Zv.set(0,0,0),Qv.set(0,0,0);for(let A=0,M=o.length;A<M;A++){const S=b[A],E=o[A];S!==0&&(xx.fromBufferAttribute(E,m),wx.fromBufferAttribute(E,g),Ax.fromBufferAttribute(E,y),u?(Kv.addScaledVector(xx,S),Zv.addScaledVector(wx,S),Qv.addScaledVector(Ax,S)):(Kv.addScaledVector(xx.sub(Nl),S),Zv.addScaledVector(wx.sub(Ul),S),Qv.addScaledVector(Ax.sub(Hl),S)))}Nl.add(Kv),Ul.add(Zv),Hl.add(Qv)}i.isSkinnedMesh&&(i.boneTransform(m,Nl),i.boneTransform(g,Ul),i.boneTransform(y,Hl));const w=$6(i,n,r,a,Nl,Ul,Hl,Ex);if(w){f&&(Jv.fromBufferAttribute(f,m),eg.fromBufferAttribute(f,g),tg.fromBufferAttribute(f,y),w.uv=Hi.getUV(Ex,Nl,Ul,Hl,Jv,eg,tg,new Wt)),v&&(Jv.fromBufferAttribute(v,m),eg.fromBufferAttribute(v,g),tg.fromBufferAttribute(v,y),w.uv2=Hi.getUV(Ex,Nl,Ul,Hl,Jv,eg,tg,new Wt));const A={a:m,b:g,c:y,normal:new Ze,materialIndex:0};Hi.getNormal(Nl,Ul,Hl,A.normal),w.face=A}return w}class Td extends Zr{constructor(n=1,r=1,a=1,s=1,o=1,u=1){super();this.type="BoxGeometry",this.parameters={width:n,height:r,depth:a,widthSegments:s,heightSegments:o,depthSegments:u};const f=this;s=Math.floor(s),o=Math.floor(o),u=Math.floor(u);const v=[],m=[],g=[],y=[];let b=0,w=0;A("z","y","x",-1,-1,a,r,n,u,o,0),A("z","y","x",1,-1,a,r,-n,u,o,1),A("x","z","y",1,1,n,a,r,s,u,2),A("x","z","y",1,-1,n,a,-r,s,u,3),A("x","y","z",1,-1,n,r,a,s,o,4),A("x","y","z",-1,-1,n,r,-a,s,o,5),this.setIndex(v),this.setAttribute("position",new Xr(m,3)),this.setAttribute("normal",new Xr(g,3)),this.setAttribute("uv",new Xr(y,2));function A(M,S,E,T,C,L,P,N,F,X,Y){const ae=L/F,$=P/X,de=L/2,D=P/2,I=N/2,k=F+1,U=X+1;let W=0,ce=0;const oe=new Ze;for(let ge=0;ge<U;ge++){const _e=ge*$-D;for(let Ne=0;Ne<k;Ne++){const Ie=Ne*ae-de;oe[M]=Ie*T,oe[S]=_e*C,oe[E]=I,m.push(oe.x,oe.y,oe.z),oe[M]=0,oe[S]=0,oe[E]=N>0?1:-1,g.push(oe.x,oe.y,oe.z),y.push(Ne/F),y.push(1-ge/X),W+=1}}for(let ge=0;ge<X;ge++)for(let _e=0;_e<F;_e++){const Ne=b+_e+k*ge,Ie=b+_e+k*(ge+1),Ve=b+(_e+1)+k*(ge+1),Le=b+(_e+1)+k*ge;v.push(Ne,Ie,Le),v.push(Ie,Ve,Le),ce+=6}f.addGroup(w,ce,Y),w+=ce,b+=W}}static fromJSON(n){return new Td(n.width,n.height,n.depth,n.widthSegments,n.heightSegments,n.depthSegments)}}function Eh(i){const n={};for(const r in i){n[r]={};for(const a in i[r]){const s=i[r][a];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?n[r][a]=s.clone():Array.isArray(s)?n[r][a]=s.slice():n[r][a]=s}}return n}function pa(i){const n={};for(let r=0;r<i.length;r++){const a=Eh(i[r]);for(const s in a)n[s]=a[s]}return n}const tT={clone:Eh,merge:pa};var K6=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Z6=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Us extends da{constructor(n){super();this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=K6,this.fragmentShader=Z6,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,n!==void 0&&(n.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(n))}copy(n){return super.copy(n),this.fragmentShader=n.fragmentShader,this.vertexShader=n.vertexShader,this.uniforms=Eh(n.uniforms),this.defines=Object.assign({},n.defines),this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.lights=n.lights,this.clipping=n.clipping,this.extensions=Object.assign({},n.extensions),this.glslVersion=n.glslVersion,this}toJSON(n){const r=super.toJSON(n);r.glslVersion=this.glslVersion,r.uniforms={};for(const s in this.uniforms){const u=this.uniforms[s].value;u&&u.isTexture?r.uniforms[s]={type:"t",value:u.toJSON(n).uuid}:u&&u.isColor?r.uniforms[s]={type:"c",value:u.getHex()}:u&&u.isVector2?r.uniforms[s]={type:"v2",value:u.toArray()}:u&&u.isVector3?r.uniforms[s]={type:"v3",value:u.toArray()}:u&&u.isVector4?r.uniforms[s]={type:"v4",value:u.toArray()}:u&&u.isMatrix3?r.uniforms[s]={type:"m3",value:u.toArray()}:u&&u.isMatrix4?r.uniforms[s]={type:"m4",value:u.toArray()}:r.uniforms[s]={value:u}}Object.keys(this.defines).length>0&&(r.defines=this.defines),r.vertexShader=this.vertexShader,r.fragmentShader=this.fragmentShader;const a={};for(const s in this.extensions)this.extensions[s]===!0&&(a[s]=!0);return Object.keys(a).length>0&&(r.extensions=a),r}}Us.prototype.isShaderMaterial=!0;class _x extends ei{constructor(){super();this.type="Camera",this.matrixWorldInverse=new jn,this.projectionMatrix=new jn,this.projectionMatrixInverse=new jn}copy(n,r){return super.copy(n,r),this.matrixWorldInverse.copy(n.matrixWorldInverse),this.projectionMatrix.copy(n.projectionMatrix),this.projectionMatrixInverse.copy(n.projectionMatrixInverse),this}getWorldDirection(n){this.updateWorldMatrix(!0,!1);const r=this.matrixWorld.elements;return n.set(-r[8],-r[9],-r[10]).normalize()}updateMatrixWorld(n){super.updateMatrixWorld(n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(n,r){super.updateWorldMatrix(n,r),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}_x.prototype.isCamera=!0;class La extends _x{constructor(n=50,r=1,a=.1,s=2e3){super();this.type="PerspectiveCamera",this.fov=n,this.zoom=1,this.near=a,this.far=s,this.focus=10,this.aspect=r,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(n,r){return super.copy(n,r),this.fov=n.fov,this.zoom=n.zoom,this.near=n.near,this.far=n.far,this.focus=n.focus,this.aspect=n.aspect,this.view=n.view===null?null:Object.assign({},n.view),this.filmGauge=n.filmGauge,this.filmOffset=n.filmOffset,this}setFocalLength(n){const r=.5*this.getFilmHeight()/n;this.fov=ex*2*Math.atan(r),this.updateProjectionMatrix()}getFocalLength(){const n=Math.tan(Jb*.5*this.fov);return .5*this.getFilmHeight()/n}getEffectiveFOV(){return ex*2*Math.atan(Math.tan(Jb*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(n,r,a,s,o,u){this.aspect=n/r,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=n,this.view.fullHeight=r,this.view.offsetX=a,this.view.offsetY=s,this.view.width=o,this.view.height=u,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const n=this.near;let r=n*Math.tan(Jb*.5*this.fov)/this.zoom,a=2*r,s=this.aspect*a,o=-.5*s;const u=this.view;if(this.view!==null&&this.view.enabled){const v=u.fullWidth,m=u.fullHeight;o+=u.offsetX*s/v,r-=u.offsetY*a/m,s*=u.width/v,a*=u.height/m}const f=this.filmOffset;f!==0&&(o+=n*f/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+s,r,r-a,n,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(n){const r=super.toJSON(n);return r.object.fov=this.fov,r.object.zoom=this.zoom,r.object.near=this.near,r.object.far=this.far,r.object.focus=this.focus,r.object.aspect=this.aspect,this.view!==null&&(r.object.view=Object.assign({},this.view)),r.object.filmGauge=this.filmGauge,r.object.filmOffset=this.filmOffset,r}}La.prototype.isPerspectiveCamera=!0;const _h=90,Mh=1;class Mx extends ei{constructor(n,r,a){super();if(this.type="CubeCamera",a.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=a;const s=new La(_h,Mh,n,r);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new Ze(1,0,0)),this.add(s);const o=new La(_h,Mh,n,r);o.layers=this.layers,o.up.set(0,-1,0),o.lookAt(new Ze(-1,0,0)),this.add(o);const u=new La(_h,Mh,n,r);u.layers=this.layers,u.up.set(0,0,1),u.lookAt(new Ze(0,1,0)),this.add(u);const f=new La(_h,Mh,n,r);f.layers=this.layers,f.up.set(0,0,-1),f.lookAt(new Ze(0,-1,0)),this.add(f);const v=new La(_h,Mh,n,r);v.layers=this.layers,v.up.set(0,-1,0),v.lookAt(new Ze(0,0,1)),this.add(v);const m=new La(_h,Mh,n,r);m.layers=this.layers,m.up.set(0,-1,0),m.lookAt(new Ze(0,0,-1)),this.add(m)}update(n,r){this.parent===null&&this.updateMatrixWorld();const a=this.renderTarget,[s,o,u,f,v,m]=this.children,g=n.xr.enabled,y=n.getRenderTarget();n.xr.enabled=!1;const b=a.texture.generateMipmaps;a.texture.generateMipmaps=!1,n.setRenderTarget(a,0),n.render(r,s),n.setRenderTarget(a,1),n.render(r,o),n.setRenderTarget(a,2),n.render(r,u),n.setRenderTarget(a,3),n.render(r,f),n.setRenderTarget(a,4),n.render(r,v),a.texture.generateMipmaps=b,n.setRenderTarget(a,5),n.render(r,m),n.setRenderTarget(y),n.xr.enabled=g}}class ig extends qi{constructor(n,r,a,s,o,u,f,v,m,g){n=n!==void 0?n:[],r=r!==void 0?r:yd;super(n,r,a,s,o,u,f,v,m,g);this.flipY=!1}get images(){return this.image}set images(n){this.image=n}}ig.prototype.isCubeTexture=!0;class nT extends Do{constructor(n,r,a){Number.isInteger(r)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),r=a);super(n,n,r);r=r||{},this.texture=new ig(void 0,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=r.generateMipmaps!==void 0?r.generateMipmaps:!1,this.texture.minFilter=r.minFilter!==void 0?r.minFilter:Ra,this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(n,r){this.texture.type=r.type,this.texture.format=ha,this.texture.encoding=r.encoding,this.texture.generateMipmaps=r.generateMipmaps,this.texture.minFilter=r.minFilter,this.texture.magFilter=r.magFilter;const a={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},s=new Td(5,5,5),o=new Us({name:"CubemapFromEquirect",uniforms:Eh(a.uniforms),vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,side:Ni,blending:Pl});o.uniforms.tEquirect.value=r;const u=new ra(s,o),f=r.minFilter;return r.minFilter===Ov&&(r.minFilter=Ra),new Mx(1,10,this).update(n,u),r.minFilter=f,u.geometry.dispose(),u.material.dispose(),this}clear(n,r,a,s){const o=n.getRenderTarget();for(let u=0;u<6;u++)n.setRenderTarget(this,u),n.clear(r,a,s);n.setRenderTarget(o)}}nT.prototype.isWebGLCubeRenderTarget=!0;const Sx=new Ze,Q6=new Ze,J6=new na;class as{constructor(n=new Ze(1,0,0),r=0){this.normal=n,this.constant=r}set(n,r){return this.normal.copy(n),this.constant=r,this}setComponents(n,r,a,s){return this.normal.set(n,r,a),this.constant=s,this}setFromNormalAndCoplanarPoint(n,r){return this.normal.copy(n),this.constant=-r.dot(this.normal),this}setFromCoplanarPoints(n,r,a){const s=Sx.subVectors(a,r).cross(Q6.subVectors(n,r)).normalize();return this.setFromNormalAndCoplanarPoint(s,n),this}copy(n){return this.normal.copy(n.normal),this.constant=n.constant,this}normalize(){const n=1/this.normal.length();return this.normal.multiplyScalar(n),this.constant*=n,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(n){return this.normal.dot(n)+this.constant}distanceToSphere(n){return this.distanceToPoint(n.center)-n.radius}projectPoint(n,r){return r.copy(this.normal).multiplyScalar(-this.distanceToPoint(n)).add(n)}intersectLine(n,r){const a=n.delta(Sx),s=this.normal.dot(a);if(s===0)return this.distanceToPoint(n.start)===0?r.copy(n.start):null;const o=-(n.start.dot(this.normal)+this.constant)/s;return o<0||o>1?null:r.copy(a).multiplyScalar(o).add(n.start)}intersectsLine(n){const r=this.distanceToPoint(n.start),a=this.distanceToPoint(n.end);return r<0&&a>0||a<0&&r>0}intersectsBox(n){return n.intersectsPlane(this)}intersectsSphere(n){return n.intersectsPlane(this)}coplanarPoint(n){return n.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(n,r){const a=r||J6.getNormalMatrix(n),s=this.coplanarPoint(Sx).applyMatrix4(n),o=this.normal.applyMatrix3(a).normalize();return this.constant=-s.dot(o),this}translate(n){return this.constant-=n.dot(this.normal),this}equals(n){return n.normal.equals(this.normal)&&n.constant===this.constant}clone(){return new this.constructor().copy(this)}}as.prototype.isPlane=!0;const Sh=new mh,ag=new Ze;class og{constructor(n=new as,r=new as,a=new as,s=new as,o=new as,u=new as){this.planes=[n,r,a,s,o,u]}set(n,r,a,s,o,u){const f=this.planes;return f[0].copy(n),f[1].copy(r),f[2].copy(a),f[3].copy(s),f[4].copy(o),f[5].copy(u),this}copy(n){const r=this.planes;for(let a=0;a<6;a++)r[a].copy(n.planes[a]);return this}setFromProjectionMatrix(n){const r=this.planes,a=n.elements,s=a[0],o=a[1],u=a[2],f=a[3],v=a[4],m=a[5],g=a[6],y=a[7],b=a[8],w=a[9],A=a[10],M=a[11],S=a[12],E=a[13],T=a[14],C=a[15];return r[0].setComponents(f-s,y-v,M-b,C-S).normalize(),r[1].setComponents(f+s,y+v,M+b,C+S).normalize(),r[2].setComponents(f+o,y+m,M+w,C+E).normalize(),r[3].setComponents(f-o,y-m,M-w,C-E).normalize(),r[4].setComponents(f-u,y-g,M-A,C-T).normalize(),r[5].setComponents(f+u,y+g,M+A,C+T).normalize(),this}intersectsObject(n){const r=n.geometry;return r.boundingSphere===null&&r.computeBoundingSphere(),Sh.copy(r.boundingSphere).applyMatrix4(n.matrixWorld),this.intersectsSphere(Sh)}intersectsSprite(n){return Sh.center.set(0,0,0),Sh.radius=.7071067811865476,Sh.applyMatrix4(n.matrixWorld),this.intersectsSphere(Sh)}intersectsSphere(n){const r=this.planes,a=n.center,s=-n.radius;for(let o=0;o<6;o++)if(r[o].distanceToPoint(a)<s)return!1;return!0}intersectsBox(n){const r=this.planes;for(let a=0;a<6;a++){const s=r[a];if(ag.x=s.normal.x>0?n.max.x:n.min.x,ag.y=s.normal.y>0?n.max.y:n.min.y,ag.z=s.normal.z>0?n.max.z:n.min.z,s.distanceToPoint(ag)<0)return!1}return!0}containsPoint(n){const r=this.planes;for(let a=0;a<6;a++)if(r[a].distanceToPoint(n)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function rT(){let i=null,n=!1,r=null,a=null;function s(o,u){r(o,u),a=i.requestAnimationFrame(s)}return{start:function(){n!==!0&&r!==null&&(a=i.requestAnimationFrame(s),n=!0)},stop:function(){i.cancelAnimationFrame(a),n=!1},setAnimationLoop:function(o){r=o},setContext:function(o){i=o}}}function eU(i,n){const r=n.isWebGL2,a=new WeakMap;function s(m,g){const y=m.array,b=m.usage,w=i.createBuffer();i.bindBuffer(g,w),i.bufferData(g,y,b),m.onUploadCallback();let A=5126;return y instanceof Float32Array?A=5126:y instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):y instanceof Uint16Array?m.isFloat16BufferAttribute?r?A=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):A=5123:y instanceof Int16Array?A=5122:y instanceof Uint32Array?A=5125:y instanceof Int32Array?A=5124:y instanceof Int8Array?A=5120:(y instanceof Uint8Array||y instanceof Uint8ClampedArray)&&(A=5121),{buffer:w,type:A,bytesPerElement:y.BYTES_PER_ELEMENT,version:m.version}}function o(m,g,y){const b=g.array,w=g.updateRange;i.bindBuffer(y,m),w.count===-1?i.bufferSubData(y,0,b):(r?i.bufferSubData(y,w.offset*b.BYTES_PER_ELEMENT,b,w.offset,w.count):i.bufferSubData(y,w.offset*b.BYTES_PER_ELEMENT,b.subarray(w.offset,w.offset+w.count)),w.count=-1)}function u(m){return m.isInterleavedBufferAttribute&&(m=m.data),a.get(m)}function f(m){m.isInterleavedBufferAttribute&&(m=m.data);const g=a.get(m);g&&(i.deleteBuffer(g.buffer),a.delete(m))}function v(m,g){if(m.isGLBufferAttribute){const b=a.get(m);(!b||b.version<m.version)&&a.set(m,{buffer:m.buffer,type:m.type,bytesPerElement:m.elementSize,version:m.version});return}m.isInterleavedBufferAttribute&&(m=m.data);const y=a.get(m);y===void 0?a.set(m,s(m,g)):y.version<m.version&&(o(y.buffer,m,g),y.version=m.version)}return{get:u,remove:f,update:v}}class Tx extends Zr{constructor(n=1,r=1,a=1,s=1){super();this.type="PlaneGeometry",this.parameters={width:n,height:r,widthSegments:a,heightSegments:s};const o=n/2,u=r/2,f=Math.floor(a),v=Math.floor(s),m=f+1,g=v+1,y=n/f,b=r/v,w=[],A=[],M=[],S=[];for(let E=0;E<g;E++){const T=E*b-u;for(let C=0;C<m;C++){const L=C*y-o;A.push(L,-T,0),M.push(0,0,1),S.push(C/f),S.push(1-E/v)}}for(let E=0;E<v;E++)for(let T=0;T<f;T++){const C=T+m*E,L=T+m*(E+1),P=T+1+m*(E+1),N=T+1+m*E;w.push(C,L,N),w.push(L,P,N)}this.setIndex(w),this.setAttribute("position",new Xr(A,3)),this.setAttribute("normal",new Xr(M,3)),this.setAttribute("uv",new Xr(S,2))}static fromJSON(n){return new Tx(n.width,n.height,n.widthSegments,n.heightSegments)}}var tU=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,nU=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,rU=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,iU=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,aU=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,oU=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,sU="vec3 transformed = vec3( position );",lU=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,cU=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,uU=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,hU=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,fU=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,dU=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,pU=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,mU=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,vU=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,gU=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,yU=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,bU=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,xU=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );
		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );
		vec2 f = fract( uv );
		uv += 0.5 - f;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		if ( mipInt < cubeUV_maxMipLevel ) {
			uv.y += 2.0 * cubeUV_maxTileSize;
		}
		uv.y += filterInt * 2.0 * cubeUV_minTileSize;
		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );
		uv *= texelSize;
		vec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x += texelSize;
		vec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.y += texelSize;
		vec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x -= texelSize;
		vec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		vec3 tm = mix( tl, tr, f.x );
		vec3 bm = mix( bl, br, f.x );
		return mix( tm, bm, f.y );
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,wU=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,AU=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,EU=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,_U=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,MU=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,SU="gl_FragColor = linearToOutputTexel( gl_FragColor );",TU=`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value ) {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,CU=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
		envColor = envMapTexelToLinear( envColor );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,RU=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,LU=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,PU=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,DU=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,OU=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,IU=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,kU=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,FU=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,BU=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,NU=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		lightMapIrradiance *= PI;
	#endif
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,UU=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,HU=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointLightInfo( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotLightInfo( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
		#endif
	}
	#pragma unroll_loop_end
#endif`,zU=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,GU=`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec;
			#ifdef ENVMAP_MODE_REFLECTION
				reflectVec = reflect( - viewDir, normal );
				reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			#else
				reflectVec = refract( - viewDir, normal, refractionRatio );
			#endif
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,VU=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,WU=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,jU=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,XU=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,qU=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= specularColorMapTexelToLinear( texture2D( specularColorMap, vUv ) ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= sheenColorMapTexelToLinear( texture2D( sheenColorMap, vUv ) ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,YU=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	vec3 FssEss = specularColor * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,$U=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,KU=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,ZU=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,QU=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,JU=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,eH=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,tH=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,nH=`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,rH=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,iH=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,aH=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,oH=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,sH=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,lH=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] > 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1, 2 ) * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,cH=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform vec2 morphTargetsTextureSize;
		vec3 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset, const in int stride ) {
			float texelIndex = float( vertexIndex * stride + offset );
			float y = floor( texelIndex / morphTargetsTextureSize.x );
			float x = texelIndex - y * morphTargetsTextureSize.x;
			vec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );
			return texture( morphTargetsTexture, morphUV ).xyz;
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,uH=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			#ifndef USE_MORPHNORMALS
				if ( morphTargetInfluences[ i ] > 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 1 ) * morphTargetInfluences[ i ];
			#else
				if ( morphTargetInfluences[ i ] > 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 2 ) * morphTargetInfluences[ i ];
			#endif
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,hH=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,fH=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,dH=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,pH=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,mH=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,vH=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,gH=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,yH=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,bH=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,xH=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,wH=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,AH=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,EH=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,_H=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,MH=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,SH=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,TH=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,CH=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,RH=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,LH=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,PH=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,DH=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,OH=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,IH=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,kH=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,FH=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,BH=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,NH=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,UH=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,HH=`#ifdef USE_TRANSMISSION
	float transmissionAlpha = 1.0;
	float transmissionFactor = transmission;
	float thicknessFactor = thickness;
	#ifdef USE_TRANSMISSIONMAP
		transmissionFactor *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		thicknessFactor *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,
		attenuationColor, attenuationDistance );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );
	transmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );
#endif`,zH=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( float roughness, float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( vec2 fragCoord, float roughness, float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef TEXTURE_LOD_EXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( vec3 radiance, float transmissionDistance, vec3 attenuationColor, float attenuationDistance ) {
		if ( attenuationDistance == 0.0 ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 diffuseColor, vec3 specularColor, float specularF90,
		vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness,
		vec3 attenuationColor, float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,GH=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,VH=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,WH=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,jH=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,XH=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,qH=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,YH=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const $H=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,KH=`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,ZH=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,QH=`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,JH=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,e8=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,t8=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,n8=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,r8=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,i8=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,a8=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,o8=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,s8=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,l8=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,c8=`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,u8=`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,h8=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,f8=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,d8=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,p8=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,m8=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,v8=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,g8=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,y8=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - clearcoat * Fcc ) + clearcoatSpecular * clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,b8=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,x8=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,w8=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,A8=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,E8=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,_8=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,M8=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,S8=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Pr={alphamap_fragment:tU,alphamap_pars_fragment:nU,alphatest_fragment:rU,alphatest_pars_fragment:iU,aomap_fragment:aU,aomap_pars_fragment:oU,begin_vertex:sU,beginnormal_vertex:lU,bsdfs:cU,bumpmap_pars_fragment:uU,clipping_planes_fragment:hU,clipping_planes_pars_fragment:fU,clipping_planes_pars_vertex:dU,clipping_planes_vertex:pU,color_fragment:mU,color_pars_fragment:vU,color_pars_vertex:gU,color_vertex:yU,common:bU,cube_uv_reflection_fragment:xU,defaultnormal_vertex:wU,displacementmap_pars_vertex:AU,displacementmap_vertex:EU,emissivemap_fragment:_U,emissivemap_pars_fragment:MU,encodings_fragment:SU,encodings_pars_fragment:TU,envmap_fragment:CU,envmap_common_pars_fragment:RU,envmap_pars_fragment:LU,envmap_pars_vertex:PU,envmap_physical_pars_fragment:GU,envmap_vertex:DU,fog_vertex:OU,fog_pars_vertex:IU,fog_fragment:kU,fog_pars_fragment:FU,gradientmap_pars_fragment:BU,lightmap_fragment:NU,lightmap_pars_fragment:UU,lights_lambert_vertex:HU,lights_pars_begin:zU,lights_toon_fragment:VU,lights_toon_pars_fragment:WU,lights_phong_fragment:jU,lights_phong_pars_fragment:XU,lights_physical_fragment:qU,lights_physical_pars_fragment:YU,lights_fragment_begin:$U,lights_fragment_maps:KU,lights_fragment_end:ZU,logdepthbuf_fragment:QU,logdepthbuf_pars_fragment:JU,logdepthbuf_pars_vertex:eH,logdepthbuf_vertex:tH,map_fragment:nH,map_pars_fragment:rH,map_particle_fragment:iH,map_particle_pars_fragment:aH,metalnessmap_fragment:oH,metalnessmap_pars_fragment:sH,morphnormal_vertex:lH,morphtarget_pars_vertex:cH,morphtarget_vertex:uH,normal_fragment_begin:hH,normal_fragment_maps:fH,normal_pars_fragment:dH,normal_pars_vertex:pH,normal_vertex:mH,normalmap_pars_fragment:vH,clearcoat_normal_fragment_begin:gH,clearcoat_normal_fragment_maps:yH,clearcoat_pars_fragment:bH,output_fragment:xH,packing:wH,premultiplied_alpha_fragment:AH,project_vertex:EH,dithering_fragment:_H,dithering_pars_fragment:MH,roughnessmap_fragment:SH,roughnessmap_pars_fragment:TH,shadowmap_pars_fragment:CH,shadowmap_pars_vertex:RH,shadowmap_vertex:LH,shadowmask_pars_fragment:PH,skinbase_vertex:DH,skinning_pars_vertex:OH,skinning_vertex:IH,skinnormal_vertex:kH,specularmap_fragment:FH,specularmap_pars_fragment:BH,tonemapping_fragment:NH,tonemapping_pars_fragment:UH,transmission_fragment:HH,transmission_pars_fragment:zH,uv_pars_fragment:GH,uv_pars_vertex:VH,uv_vertex:WH,uv2_pars_fragment:jH,uv2_pars_vertex:XH,uv2_vertex:qH,worldpos_vertex:YH,background_vert:$H,background_frag:KH,cube_vert:ZH,cube_frag:QH,depth_vert:JH,depth_frag:e8,distanceRGBA_vert:t8,distanceRGBA_frag:n8,equirect_vert:r8,equirect_frag:i8,linedashed_vert:a8,linedashed_frag:o8,meshbasic_vert:s8,meshbasic_frag:l8,meshlambert_vert:c8,meshlambert_frag:u8,meshmatcap_vert:h8,meshmatcap_frag:f8,meshnormal_vert:d8,meshnormal_frag:p8,meshphong_vert:m8,meshphong_frag:v8,meshphysical_vert:g8,meshphysical_frag:y8,meshtoon_vert:b8,meshtoon_frag:x8,points_vert:w8,points_frag:A8,shadow_vert:E8,shadow_frag:_8,sprite_vert:M8,sprite_frag:S8},un={common:{diffuse:{value:new On(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new na},uv2Transform:{value:new na},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Wt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new On(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new On(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new na}},sprite:{diffuse:{value:new On(16777215)},opacity:{value:1},center:{value:new Wt(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new na}}},os={basic:{uniforms:pa([un.common,un.specularmap,un.envmap,un.aomap,un.lightmap,un.fog]),vertexShader:Pr.meshbasic_vert,fragmentShader:Pr.meshbasic_frag},lambert:{uniforms:pa([un.common,un.specularmap,un.envmap,un.aomap,un.lightmap,un.emissivemap,un.fog,un.lights,{emissive:{value:new On(0)}}]),vertexShader:Pr.meshlambert_vert,fragmentShader:Pr.meshlambert_frag},phong:{uniforms:pa([un.common,un.specularmap,un.envmap,un.aomap,un.lightmap,un.emissivemap,un.bumpmap,un.normalmap,un.displacementmap,un.fog,un.lights,{emissive:{value:new On(0)},specular:{value:new On(1118481)},shininess:{value:30}}]),vertexShader:Pr.meshphong_vert,fragmentShader:Pr.meshphong_frag},standard:{uniforms:pa([un.common,un.envmap,un.aomap,un.lightmap,un.emissivemap,un.bumpmap,un.normalmap,un.displacementmap,un.roughnessmap,un.metalnessmap,un.fog,un.lights,{emissive:{value:new On(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Pr.meshphysical_vert,fragmentShader:Pr.meshphysical_frag},toon:{uniforms:pa([un.common,un.aomap,un.lightmap,un.emissivemap,un.bumpmap,un.normalmap,un.displacementmap,un.gradientmap,un.fog,un.lights,{emissive:{value:new On(0)}}]),vertexShader:Pr.meshtoon_vert,fragmentShader:Pr.meshtoon_frag},matcap:{uniforms:pa([un.common,un.bumpmap,un.normalmap,un.displacementmap,un.fog,{matcap:{value:null}}]),vertexShader:Pr.meshmatcap_vert,fragmentShader:Pr.meshmatcap_frag},points:{uniforms:pa([un.points,un.fog]),vertexShader:Pr.points_vert,fragmentShader:Pr.points_frag},dashed:{uniforms:pa([un.common,un.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Pr.linedashed_vert,fragmentShader:Pr.linedashed_frag},depth:{uniforms:pa([un.common,un.displacementmap]),vertexShader:Pr.depth_vert,fragmentShader:Pr.depth_frag},normal:{uniforms:pa([un.common,un.bumpmap,un.normalmap,un.displacementmap,{opacity:{value:1}}]),vertexShader:Pr.meshnormal_vert,fragmentShader:Pr.meshnormal_frag},sprite:{uniforms:pa([un.sprite,un.fog]),vertexShader:Pr.sprite_vert,fragmentShader:Pr.sprite_frag},background:{uniforms:{uvTransform:{value:new na},t2D:{value:null}},vertexShader:Pr.background_vert,fragmentShader:Pr.background_frag},cube:{uniforms:pa([un.envmap,{opacity:{value:1}}]),vertexShader:Pr.cube_vert,fragmentShader:Pr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Pr.equirect_vert,fragmentShader:Pr.equirect_frag},distanceRGBA:{uniforms:pa([un.common,un.displacementmap,{referencePosition:{value:new Ze},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Pr.distanceRGBA_vert,fragmentShader:Pr.distanceRGBA_frag},shadow:{uniforms:pa([un.lights,un.fog,{color:{value:new On(0)},opacity:{value:1}}]),vertexShader:Pr.shadow_vert,fragmentShader:Pr.shadow_frag}};os.physical={uniforms:pa([os.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Wt(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new On(0)},sheenColorMap:{value:null},sheenRoughness:{value:0},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Wt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new On(0)},specularIntensity:{value:0},specularIntensityMap:{value:null},specularColor:{value:new On(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Pr.meshphysical_vert,fragmentShader:Pr.meshphysical_frag};function T8(i,n,r,a,s){const o=new On(0);let u=0,f,v,m=null,g=0,y=null;function b(A,M){let S=!1,E=M.isScene===!0?M.background:null;E&&E.isTexture&&(E=n.get(E));const T=i.xr,C=T.getSession&&T.getSession();C&&C.environmentBlendMode==="additive"&&(E=null),E===null?w(o,u):E&&E.isColor&&(w(E,1),S=!0),(i.autoClear||S)&&i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil),E&&(E.isCubeTexture||E.mapping===Dv)?(v===void 0&&(v=new ra(new Td(1,1,1),new Us({name:"BackgroundCubeMaterial",uniforms:Eh(os.cube.uniforms),vertexShader:os.cube.vertexShader,fragmentShader:os.cube.fragmentShader,side:Ni,depthTest:!1,depthWrite:!1,fog:!1})),v.geometry.deleteAttribute("normal"),v.geometry.deleteAttribute("uv"),v.onBeforeRender=function(L,P,N){this.matrixWorld.copyPosition(N.matrixWorld)},Object.defineProperty(v.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),a.update(v)),v.material.uniforms.envMap.value=E,v.material.uniforms.flipEnvMap.value=E.isCubeTexture&&E.isRenderTargetTexture===!1?-1:1,(m!==E||g!==E.version||y!==i.toneMapping)&&(v.material.needsUpdate=!0,m=E,g=E.version,y=i.toneMapping),A.unshift(v,v.geometry,v.material,0,0,null)):E&&E.isTexture&&(f===void 0&&(f=new ra(new Tx(2,2),new Us({name:"BackgroundMaterial",uniforms:Eh(os.background.uniforms),vertexShader:os.background.vertexShader,fragmentShader:os.background.fragmentShader,side:vd,depthTest:!1,depthWrite:!1,fog:!1})),f.geometry.deleteAttribute("normal"),Object.defineProperty(f.material,"map",{get:function(){return this.uniforms.t2D.value}}),a.update(f)),f.material.uniforms.t2D.value=E,E.matrixAutoUpdate===!0&&E.updateMatrix(),f.material.uniforms.uvTransform.value.copy(E.matrix),(m!==E||g!==E.version||y!==i.toneMapping)&&(f.material.needsUpdate=!0,m=E,g=E.version,y=i.toneMapping),A.unshift(f,f.geometry,f.material,0,0,null))}function w(A,M){r.buffers.color.setClear(A.r,A.g,A.b,M,s)}return{getClearColor:function(){return o},setClearColor:function(A,M=1){o.set(A),u=M,w(o,u)},getClearAlpha:function(){return u},setClearAlpha:function(A){u=A,w(o,u)},render:b}}function C8(i,n,r,a){const s=i.getParameter(34921),o=a.isWebGL2?null:n.get("OES_vertex_array_object"),u=a.isWebGL2||o!==null,f={},v=M(null);let m=v;function g(D,I,k,U,W){let ce=!1;if(u){const oe=A(U,k,I);m!==oe&&(m=oe,b(m.object)),ce=S(U,W),ce&&E(U,W)}else{const oe=I.wireframe===!0;(m.geometry!==U.id||m.program!==k.id||m.wireframe!==oe)&&(m.geometry=U.id,m.program=k.id,m.wireframe=oe,ce=!0)}D.isInstancedMesh===!0&&(ce=!0),W!==null&&r.update(W,34963),ce&&(F(D,I,k,U),W!==null&&i.bindBuffer(34963,r.get(W).buffer))}function y(){return a.isWebGL2?i.createVertexArray():o.createVertexArrayOES()}function b(D){return a.isWebGL2?i.bindVertexArray(D):o.bindVertexArrayOES(D)}function w(D){return a.isWebGL2?i.deleteVertexArray(D):o.deleteVertexArrayOES(D)}function A(D,I,k){const U=k.wireframe===!0;let W=f[D.id];W===void 0&&(W={},f[D.id]=W);let ce=W[I.id];ce===void 0&&(ce={},W[I.id]=ce);let oe=ce[U];return oe===void 0&&(oe=M(y()),ce[U]=oe),oe}function M(D){const I=[],k=[],U=[];for(let W=0;W<s;W++)I[W]=0,k[W]=0,U[W]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:I,enabledAttributes:k,attributeDivisors:U,object:D,attributes:{},index:null}}function S(D,I){const k=m.attributes,U=D.attributes;let W=0;for(const ce in U){const oe=k[ce],ge=U[ce];if(oe===void 0||oe.attribute!==ge||oe.data!==ge.data)return!0;W++}return m.attributesNum!==W||m.index!==I}function E(D,I){const k={},U=D.attributes;let W=0;for(const ce in U){const oe=U[ce],ge={};ge.attribute=oe,oe.data&&(ge.data=oe.data),k[ce]=ge,W++}m.attributes=k,m.attributesNum=W,m.index=I}function T(){const D=m.newAttributes;for(let I=0,k=D.length;I<k;I++)D[I]=0}function C(D){L(D,0)}function L(D,I){const k=m.newAttributes,U=m.enabledAttributes,W=m.attributeDivisors;k[D]=1,U[D]===0&&(i.enableVertexAttribArray(D),U[D]=1),W[D]!==I&&((a.isWebGL2?i:n.get("ANGLE_instanced_arrays"))[a.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](D,I),W[D]=I)}function P(){const D=m.newAttributes,I=m.enabledAttributes;for(let k=0,U=I.length;k<U;k++)I[k]!==D[k]&&(i.disableVertexAttribArray(k),I[k]=0)}function N(D,I,k,U,W,ce){a.isWebGL2===!0&&(k===5124||k===5125)?i.vertexAttribIPointer(D,I,k,W,ce):i.vertexAttribPointer(D,I,k,U,W,ce)}function F(D,I,k,U){if(a.isWebGL2===!1&&(D.isInstancedMesh||U.isInstancedBufferGeometry)&&n.get("ANGLE_instanced_arrays")===null)return;T();const W=U.attributes,ce=k.getAttributes(),oe=I.defaultAttributeValues;for(const ge in ce){const _e=ce[ge];if(_e.location>=0){let Ne=W[ge];if(Ne===void 0&&(ge==="instanceMatrix"&&D.instanceMatrix&&(Ne=D.instanceMatrix),ge==="instanceColor"&&D.instanceColor&&(Ne=D.instanceColor)),Ne!==void 0){const Ie=Ne.normalized,Ve=Ne.itemSize,Le=r.get(Ne);if(Le===void 0)continue;const Fe=Le.buffer,Me=Le.type,Qe=Le.bytesPerElement;if(Ne.isInterleavedBufferAttribute){const mt=Ne.data,ht=mt.stride,ye=Ne.offset;if(mt&&mt.isInstancedInterleavedBuffer){for(let fe=0;fe<_e.locationSize;fe++)L(_e.location+fe,mt.meshPerAttribute);D.isInstancedMesh!==!0&&U._maxInstanceCount===void 0&&(U._maxInstanceCount=mt.meshPerAttribute*mt.count)}else for(let fe=0;fe<_e.locationSize;fe++)C(_e.location+fe);i.bindBuffer(34962,Fe);for(let fe=0;fe<_e.locationSize;fe++)N(_e.location+fe,Ve/_e.locationSize,Me,Ie,ht*Qe,(ye+Ve/_e.locationSize*fe)*Qe)}else{if(Ne.isInstancedBufferAttribute){for(let mt=0;mt<_e.locationSize;mt++)L(_e.location+mt,Ne.meshPerAttribute);D.isInstancedMesh!==!0&&U._maxInstanceCount===void 0&&(U._maxInstanceCount=Ne.meshPerAttribute*Ne.count)}else for(let mt=0;mt<_e.locationSize;mt++)C(_e.location+mt);i.bindBuffer(34962,Fe);for(let mt=0;mt<_e.locationSize;mt++)N(_e.location+mt,Ve/_e.locationSize,Me,Ie,Ve*Qe,Ve/_e.locationSize*mt*Qe)}}else if(oe!==void 0){const Ie=oe[ge];if(Ie!==void 0)switch(Ie.length){case 2:i.vertexAttrib2fv(_e.location,Ie);break;case 3:i.vertexAttrib3fv(_e.location,Ie);break;case 4:i.vertexAttrib4fv(_e.location,Ie);break;default:i.vertexAttrib1fv(_e.location,Ie)}}}}P()}function X(){$();for(const D in f){const I=f[D];for(const k in I){const U=I[k];for(const W in U)w(U[W].object),delete U[W];delete I[k]}delete f[D]}}function Y(D){if(f[D.id]===void 0)return;const I=f[D.id];for(const k in I){const U=I[k];for(const W in U)w(U[W].object),delete U[W];delete I[k]}delete f[D.id]}function ae(D){for(const I in f){const k=f[I];if(k[D.id]===void 0)continue;const U=k[D.id];for(const W in U)w(U[W].object),delete U[W];delete k[D.id]}}function $(){de(),m!==v&&(m=v,b(m.object))}function de(){v.geometry=null,v.program=null,v.wireframe=!1}return{setup:g,reset:$,resetDefaultState:de,dispose:X,releaseStatesOfGeometry:Y,releaseStatesOfProgram:ae,initAttributes:T,enableAttribute:C,disableUnusedAttributes:P}}function R8(i,n,r,a){const s=a.isWebGL2;let o;function u(m){o=m}function f(m,g){i.drawArrays(o,m,g),r.update(g,o,1)}function v(m,g,y){if(y===0)return;let b,w;if(s)b=i,w="drawArraysInstanced";else if(b=n.get("ANGLE_instanced_arrays"),w="drawArraysInstancedANGLE",b===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}b[w](o,m,g,y),r.update(g,o,y)}this.setMode=u,this.render=f,this.renderInstances=v}function L8(i,n,r){let a;function s(){if(a!==void 0)return a;if(n.has("EXT_texture_filter_anisotropic")===!0){const F=n.get("EXT_texture_filter_anisotropic");a=i.getParameter(F.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else a=0;return a}function o(F){if(F==="highp"){if(i.getShaderPrecisionFormat(35633,36338).precision>0&&i.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";F="mediump"}return F==="mediump"&&i.getShaderPrecisionFormat(35633,36337).precision>0&&i.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const u=typeof WebGL2RenderingContext!="undefined"&&i instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext!="undefined"&&i instanceof WebGL2ComputeRenderingContext;let f=r.precision!==void 0?r.precision:"highp";const v=o(f);v!==f&&(console.warn("THREE.WebGLRenderer:",f,"not supported, using",v,"instead."),f=v);const m=u||n.has("WEBGL_draw_buffers"),g=r.logarithmicDepthBuffer===!0,y=i.getParameter(34930),b=i.getParameter(35660),w=i.getParameter(3379),A=i.getParameter(34076),M=i.getParameter(34921),S=i.getParameter(36347),E=i.getParameter(36348),T=i.getParameter(36349),C=b>0,L=u||n.has("OES_texture_float"),P=C&&L,N=u?i.getParameter(36183):0;return{isWebGL2:u,drawBuffers:m,getMaxAnisotropy:s,getMaxPrecision:o,precision:f,logarithmicDepthBuffer:g,maxTextures:y,maxVertexTextures:b,maxTextureSize:w,maxCubemapSize:A,maxAttributes:M,maxVertexUniforms:S,maxVaryings:E,maxFragmentUniforms:T,vertexTextures:C,floatFragmentTextures:L,floatVertexTextures:P,maxSamples:N}}function P8(i){const n=this;let r=null,a=0,s=!1,o=!1;const u=new as,f=new na,v={value:null,needsUpdate:!1};this.uniform=v,this.numPlanes=0,this.numIntersection=0,this.init=function(y,b,w){const A=y.length!==0||b||a!==0||s;return s=b,r=g(y,w,0),a=y.length,A},this.beginShadows=function(){o=!0,g(null)},this.endShadows=function(){o=!1,m()},this.setState=function(y,b,w){const A=y.clippingPlanes,M=y.clipIntersection,S=y.clipShadows,E=i.get(y);if(!s||A===null||A.length===0||o&&!S)o?g(null):m();else{const T=o?0:a,C=T*4;let L=E.clippingState||null;v.value=L,L=g(A,b,C,w);for(let P=0;P!==C;++P)L[P]=r[P];E.clippingState=L,this.numIntersection=M?this.numPlanes:0,this.numPlanes+=T}};function m(){v.value!==r&&(v.value=r,v.needsUpdate=a>0),n.numPlanes=a,n.numIntersection=0}function g(y,b,w,A){const M=y!==null?y.length:0;let S=null;if(M!==0){if(S=v.value,A!==!0||S===null){const E=w+M*4,T=b.matrixWorldInverse;f.getNormalMatrix(T),(S===null||S.length<E)&&(S=new Float32Array(E));for(let C=0,L=w;C!==M;++C,L+=4)u.copy(y[C]).applyMatrix4(T,f),u.normal.toArray(S,L),S[L+3]=u.constant}v.value=S,v.needsUpdate=!0}return n.numPlanes=M,n.numIntersection=0,S}}function D8(i){let n=new WeakMap;function r(u,f){return f===Vb?u.mapping=yd:f===Wb&&(u.mapping=bd),u}function a(u){if(u&&u.isTexture&&u.isRenderTargetTexture===!1){const f=u.mapping;if(f===Vb||f===Wb)if(n.has(u)){const v=n.get(u).texture;return r(v,u.mapping)}else{const v=u.image;if(v&&v.height>0){const m=i.getRenderTarget(),g=new nT(v.height/2);return g.fromEquirectangularTexture(i,u),n.set(u,g),i.setRenderTarget(m),u.addEventListener("dispose",s),r(g.texture,u.mapping)}else return null}}return u}function s(u){const f=u.target;f.removeEventListener("dispose",s);const v=n.get(f);v!==void 0&&(n.delete(f),v.dispose())}function o(){n=new WeakMap}return{get:a,dispose:o}}class Cd extends _x{constructor(n=-1,r=1,a=1,s=-1,o=.1,u=2e3){super();this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=n,this.right=r,this.top=a,this.bottom=s,this.near=o,this.far=u,this.updateProjectionMatrix()}copy(n,r){return super.copy(n,r),this.left=n.left,this.right=n.right,this.top=n.top,this.bottom=n.bottom,this.near=n.near,this.far=n.far,this.zoom=n.zoom,this.view=n.view===null?null:Object.assign({},n.view),this}setViewOffset(n,r,a,s,o,u){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=n,this.view.fullHeight=r,this.view.offsetX=a,this.view.offsetY=s,this.view.width=o,this.view.height=u,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const n=(this.right-this.left)/(2*this.zoom),r=(this.top-this.bottom)/(2*this.zoom),a=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let o=a-n,u=a+n,f=s+r,v=s-r;if(this.view!==null&&this.view.enabled){const m=(this.right-this.left)/this.view.fullWidth/this.zoom,g=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=m*this.view.offsetX,u=o+m*this.view.width,f-=g*this.view.offsetY,v=f-g*this.view.height}this.projectionMatrix.makeOrthographic(o,u,f,v,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(n){const r=super.toJSON(n);return r.object.zoom=this.zoom,r.object.left=this.left,r.object.right=this.right,r.object.top=this.top,r.object.bottom=this.bottom,r.object.near=this.near,r.object.far=this.far,this.view!==null&&(r.object.view=Object.assign({},this.view)),r}}Cd.prototype.isOrthographicCamera=!0;class sg extends Us{constructor(n){super(n);this.type="RawShaderMaterial"}}sg.prototype.isRawShaderMaterial=!0;const Th=4,zl=8,ss=Math.pow(2,zl),iT=[.125,.215,.35,.446,.526,.582],aT=zl-Th+1+iT.length,Ch=20,Gl={[fa]:0,[Gc]:1,[Zb]:2,[DS]:3,[OS]:4,[IS]:5,[Kb]:6},Cx=new Cd,{_lodPlanes:Rd,_sizeLods:oT,_sigmas:lg}=k8(),sT=new On;let Rx=null;const Xc=(1+Math.sqrt(5))/2,Rh=1/Xc,lT=[new Ze(1,1,1),new Ze(-1,1,1),new Ze(1,1,-1),new Ze(-1,1,-1),new Ze(0,Xc,Rh),new Ze(0,Xc,-Rh),new Ze(Rh,0,Xc),new Ze(-Rh,0,Xc),new Ze(Xc,Rh,0),new Ze(-Xc,Rh,0)];class O8{constructor(n){this._renderer=n,this._pingPongRenderTarget=null,this._blurMaterial=F8(Ch),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(n,r=0,a=.1,s=100){Rx=this._renderer.getRenderTarget();const o=this._allocateTargets();return this._sceneToCubeUV(n,a,s,o),r>0&&this._blur(o,0,0,r),this._applyPMREM(o),this._cleanup(o),o}fromEquirectangular(n){return this._fromTexture(n)}fromCubemap(n){return this._fromTexture(n)}compileCubemapShader(){this._cubemapShader===null&&(this._cubemapShader=hT(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){this._equirectShader===null&&(this._equirectShader=uT(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),this._cubemapShader!==null&&this._cubemapShader.dispose(),this._equirectShader!==null&&this._equirectShader.dispose();for(let n=0;n<Rd.length;n++)Rd[n].dispose()}_cleanup(n){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(Rx),n.scissorTest=!1,cg(n,0,0,n.width,n.height)}_fromTexture(n){Rx=this._renderer.getRenderTarget();const r=this._allocateTargets(n);return this._textureToCubeUV(n,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(n){const r={magFilter:Xi,minFilter:Xi,generateMipmaps:!1,type:Dl,format:GN,encoding:I8(n)?n.encoding:Zb,depthBuffer:!1},a=cT(r);return a.depthBuffer=!n,this._pingPongRenderTarget=cT(r),a}_compileMaterial(n){const r=new ra(Rd[0],n);this._renderer.compile(r,Cx)}_sceneToCubeUV(n,r,a,s){const o=90,u=1,f=new La(o,u,r,a),v=[1,-1,1,1,1,1],m=[1,1,1,-1,-1,-1],g=this._renderer,y=g.autoClear,b=g.outputEncoding,w=g.toneMapping;g.getClearColor(sT),g.toneMapping=zc,g.outputEncoding=fa,g.autoClear=!1;const A=new Yv({name:"PMREM.Background",side:Ni,depthWrite:!1,depthTest:!1}),M=new ra(new Td,A);let S=!1;const E=n.background;E?E.isColor&&(A.color.copy(E),n.background=null,S=!0):(A.color.copy(sT),S=!0);for(let T=0;T<6;T++){const C=T%3;C==0?(f.up.set(0,v[T],0),f.lookAt(m[T],0,0)):C==1?(f.up.set(0,0,v[T]),f.lookAt(0,m[T],0)):(f.up.set(0,v[T],0),f.lookAt(0,0,m[T])),cg(s,C*ss,T>2?ss:0,ss,ss),g.setRenderTarget(s),S&&g.render(M,f),g.render(n,f)}M.geometry.dispose(),M.material.dispose(),g.toneMapping=w,g.outputEncoding=b,g.autoClear=y,n.background=E}_setEncoding(n,r){this._renderer.capabilities.isWebGL2===!0&&r.format===ha&&r.type===Dl&&r.encoding===Gc?n.value=Gl[fa]:n.value=Gl[r.encoding]}_textureToCubeUV(n,r){const a=this._renderer,s=n.mapping===yd||n.mapping===bd;s?this._cubemapShader==null&&(this._cubemapShader=hT()):this._equirectShader==null&&(this._equirectShader=uT());const o=s?this._cubemapShader:this._equirectShader,u=new ra(Rd[0],o),f=o.uniforms;f.envMap.value=n,s||f.texelSize.value.set(1/n.image.width,1/n.image.height),this._setEncoding(f.inputEncoding,n),this._setEncoding(f.outputEncoding,r.texture),cg(r,0,0,3*ss,2*ss),a.setRenderTarget(r),a.render(u,Cx)}_applyPMREM(n){const r=this._renderer,a=r.autoClear;r.autoClear=!1;for(let s=1;s<aT;s++){const o=Math.sqrt(lg[s]*lg[s]-lg[s-1]*lg[s-1]),u=lT[(s-1)%lT.length];this._blur(n,s-1,s,o,u)}r.autoClear=a}_blur(n,r,a,s,o){const u=this._pingPongRenderTarget;this._halfBlur(n,u,r,a,s,"latitudinal",o),this._halfBlur(u,n,a,a,s,"longitudinal",o)}_halfBlur(n,r,a,s,o,u,f){const v=this._renderer,m=this._blurMaterial;u!=="latitudinal"&&u!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const g=3,y=new ra(Rd[s],m),b=m.uniforms,w=oT[a]-1,A=isFinite(o)?Math.PI/(2*w):2*Math.PI/(2*Ch-1),M=o/A,S=isFinite(o)?1+Math.floor(g*M):Ch;S>Ch&&console.warn(`sigmaRadians, ${o}, is too large and will clip, as it requested ${S} samples when the maximum is set to ${Ch}`);const E=[];let T=0;for(let N=0;N<Ch;++N){const F=N/M,X=Math.exp(-F*F/2);E.push(X),N==0?T+=X:N<S&&(T+=2*X)}for(let N=0;N<E.length;N++)E[N]=E[N]/T;b.envMap.value=n.texture,b.samples.value=S,b.weights.value=E,b.latitudinal.value=u==="latitudinal",f&&(b.poleAxis.value=f),b.dTheta.value=A,b.mipInt.value=zl-a,this._setEncoding(b.inputEncoding,n.texture),this._setEncoding(b.outputEncoding,n.texture);const C=oT[s],L=3*Math.max(0,ss-2*C),P=(s===0?0:2*ss)+2*C*(s>zl-Th?s-zl+Th:0);cg(r,L,P,3*C,2*C),v.setRenderTarget(r),v.render(y,Cx)}}function I8(i){return i===void 0||i.type!==Dl?!1:i.encoding===fa||i.encoding===Gc||i.encoding===Kb}function k8(){const i=[],n=[],r=[];let a=zl;for(let s=0;s<aT;s++){const o=Math.pow(2,a);n.push(o);let u=1/o;s>zl-Th?u=iT[s-zl+Th-1]:s==0&&(u=0),r.push(u);const f=1/(o-1),v=-f/2,m=1+f/2,g=[v,v,m,v,m,m,v,v,m,m,v,m],y=6,b=6,w=3,A=2,M=1,S=new Float32Array(w*b*y),E=new Float32Array(A*b*y),T=new Float32Array(M*b*y);for(let L=0;L<y;L++){const P=L%3*2/3-1,N=L>2?0:-1,F=[P,N,0,P+2/3,N,0,P+2/3,N+1,0,P,N,0,P+2/3,N+1,0,P,N+1,0];S.set(F,w*b*L),E.set(g,A*b*L);const X=[L,L,L,L,L,L];T.set(X,M*b*L)}const C=new Zr;C.setAttribute("position",new zi(S,w)),C.setAttribute("uv",new zi(E,A)),C.setAttribute("faceIndex",new zi(T,M)),i.push(C),a>Th&&a--}return{_lodPlanes:i,_sizeLods:n,_sigmas:r}}function cT(i){const n=new Do(3*ss,3*ss,i);return n.texture.mapping=Dv,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function cg(i,n,r,a,s){i.viewport.set(n,r,a,s),i.scissor.set(n,r,a,s)}function F8(i){const n=new Float32Array(i),r=new Ze(0,1,0);return new sg({name:"SphericalGaussianBlur",defines:{n:i},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r},inputEncoding:{value:Gl[fa]},outputEncoding:{value:Gl[fa]}},vertexShader:Lx(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			${Px()}

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:Pl,depthTest:!1,depthWrite:!1})}function uT(){const i=new Wt(1,1);return new sg({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:i},inputEncoding:{value:Gl[fa]},outputEncoding:{value:Gl[fa]}},vertexShader:Lx(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform vec2 texelSize;

			${Px()}

			#include <common>

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				vec2 f = fract( uv / texelSize - 0.5 );
				uv -= f * texelSize;
				vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x += texelSize.x;
				vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.y += texelSize.y;
				vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x -= texelSize.x;
				vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;

				vec3 tm = mix( tl, tr, f.x );
				vec3 bm = mix( bl, br, f.x );
				gl_FragColor.rgb = mix( tm, bm, f.y );

				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:Pl,depthTest:!1,depthWrite:!1})}function hT(){return new sg({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:Gl[fa]},outputEncoding:{value:Gl[fa]}},vertexShader:Lx(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			${Px()}

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;
				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:Pl,depthTest:!1,depthWrite:!1})}function Lx(){return`

		precision mediump float;
		precision mediump int;

		attribute vec3 position;
		attribute vec2 uv;
		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function Px(){return`

		uniform int inputEncoding;
		uniform int outputEncoding;

		#include <encodings_pars_fragment>

		vec4 inputTexelToLinear( vec4 value ) {

			if ( inputEncoding == 0 ) {

				return value;

			} else if ( inputEncoding == 1 ) {

				return sRGBToLinear( value );

			} else if ( inputEncoding == 2 ) {

				return RGBEToLinear( value );

			} else if ( inputEncoding == 3 ) {

				return RGBMToLinear( value, 7.0 );

			} else if ( inputEncoding == 4 ) {

				return RGBMToLinear( value, 16.0 );

			} else if ( inputEncoding == 5 ) {

				return RGBDToLinear( value, 256.0 );

			} else {

				return GammaToLinear( value, 2.2 );

			}

		}

		vec4 linearToOutputTexel( vec4 value ) {

			if ( outputEncoding == 0 ) {

				return value;

			} else if ( outputEncoding == 1 ) {

				return LinearTosRGB( value );

			} else if ( outputEncoding == 2 ) {

				return LinearToRGBE( value );

			} else if ( outputEncoding == 3 ) {

				return LinearToRGBM( value, 7.0 );

			} else if ( outputEncoding == 4 ) {

				return LinearToRGBM( value, 16.0 );

			} else if ( outputEncoding == 5 ) {

				return LinearToRGBD( value, 256.0 );

			} else {

				return LinearToGamma( value, 2.2 );

			}

		}

		vec4 envMapTexelToLinear( vec4 color ) {

			return inputTexelToLinear( color );

		}
	`}function B8(i){let n=new WeakMap,r=null;function a(f){if(f&&f.isTexture&&f.isRenderTargetTexture===!1){const v=f.mapping,m=v===Vb||v===Wb,g=v===yd||v===bd;if(m||g){if(n.has(f))return n.get(f).texture;{const y=f.image;if(m&&y&&y.height>0||g&&y&&s(y)){const b=i.getRenderTarget();r===null&&(r=new O8(i));const w=m?r.fromEquirectangular(f):r.fromCubemap(f);return n.set(f,w),i.setRenderTarget(b),f.addEventListener("dispose",o),w.texture}else return null}}}return f}function s(f){let v=0;const m=6;for(let g=0;g<m;g++)f[g]!==void 0&&v++;return v===m}function o(f){const v=f.target;v.removeEventListener("dispose",o);const m=n.get(v);m!==void 0&&(n.delete(v),m.dispose())}function u(){n=new WeakMap,r!==null&&(r.dispose(),r=null)}return{get:a,dispose:u}}function N8(i){const n={};function r(a){if(n[a]!==void 0)return n[a];let s;switch(a){case"WEBGL_depth_texture":s=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=i.getExtension(a)}return n[a]=s,s}return{has:function(a){return r(a)!==null},init:function(a){a.isWebGL2?r("EXT_color_buffer_float"):(r("WEBGL_depth_texture"),r("OES_texture_float"),r("OES_texture_half_float"),r("OES_texture_half_float_linear"),r("OES_standard_derivatives"),r("OES_element_index_uint"),r("OES_vertex_array_object"),r("ANGLE_instanced_arrays")),r("OES_texture_float_linear"),r("EXT_color_buffer_half_float")},get:function(a){const s=r(a);return s===null&&console.warn("THREE.WebGLRenderer: "+a+" extension not supported."),s}}}function U8(i,n,r,a){const s={},o=new WeakMap;function u(y){const b=y.target;b.index!==null&&n.remove(b.index);for(const A in b.attributes)n.remove(b.attributes[A]);b.removeEventListener("dispose",u),delete s[b.id];const w=o.get(b);w&&(n.remove(w),o.delete(b)),a.releaseStatesOfGeometry(b),b.isInstancedBufferGeometry===!0&&delete b._maxInstanceCount,r.memory.geometries--}function f(y,b){return s[b.id]===!0||(b.addEventListener("dispose",u),s[b.id]=!0,r.memory.geometries++),b}function v(y){const b=y.attributes;for(const A in b)n.update(b[A],34962);const w=y.morphAttributes;for(const A in w){const M=w[A];for(let S=0,E=M.length;S<E;S++)n.update(M[S],34962)}}function m(y){const b=[],w=y.index,A=y.attributes.position;let M=0;if(w!==null){const T=w.array;M=w.version;for(let C=0,L=T.length;C<L;C+=3){const P=T[C+0],N=T[C+1],F=T[C+2];b.push(P,N,N,F,F,P)}}else{const T=A.array;M=A.version;for(let C=0,L=T.length/3-1;C<L;C+=3){const P=C+0,N=C+1,F=C+2;b.push(P,N,N,F,F,P)}}const S=new(BS(b)>65535?JS:QS)(b,1);S.version=M;const E=o.get(y);E&&n.remove(E),o.set(y,S)}function g(y){const b=o.get(y);if(b){const w=y.index;w!==null&&b.version<w.version&&m(y)}else m(y);return o.get(y)}return{get:f,update:v,getWireframeAttribute:g}}function H8(i,n,r,a){const s=a.isWebGL2;let o;function u(b){o=b}let f,v;function m(b){f=b.type,v=b.bytesPerElement}function g(b,w){i.drawElements(o,w,f,b*v),r.update(w,o,1)}function y(b,w,A){if(A===0)return;let M,S;if(s)M=i,S="drawElementsInstanced";else if(M=n.get("ANGLE_instanced_arrays"),S="drawElementsInstancedANGLE",M===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}M[S](o,w,f,b*v,A),r.update(w,o,A)}this.setMode=u,this.setIndex=m,this.render=g,this.renderInstances=y}function z8(i){const n={geometries:0,textures:0},r={frame:0,calls:0,triangles:0,points:0,lines:0};function a(o,u,f){switch(r.calls++,u){case 4:r.triangles+=f*(o/3);break;case 1:r.lines+=f*(o/2);break;case 3:r.lines+=f*(o-1);break;case 2:r.lines+=f*o;break;case 0:r.points+=f*o;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",u);break}}function s(){r.frame++,r.calls=0,r.triangles=0,r.points=0,r.lines=0}return{memory:n,render:r,programs:null,autoReset:!0,reset:s,update:a}}class Dx extends qi{constructor(n=null,r=1,a=1,s=1){super(null);this.image={data:n,width:r,height:a,depth:s},this.magFilter=Xi,this.minFilter=Xi,this.wrapR=Qa,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}Dx.prototype.isDataTexture2DArray=!0;function G8(i,n){return i[0]-n[0]}function V8(i,n){return Math.abs(n[1])-Math.abs(i[1])}function fT(i,n){let r=1;const a=n.isInterleavedBufferAttribute?n.data.array:n.array;a instanceof Int8Array?r=127:a instanceof Int16Array?r=32767:a instanceof Int32Array?r=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",a),i.divideScalar(r)}function W8(i,n,r){const a={},s=new Float32Array(8),o=new WeakMap,u=new Ze,f=[];for(let m=0;m<8;m++)f[m]=[m,0];function v(m,g,y,b){const w=m.morphTargetInfluences;if(n.isWebGL2===!0){const A=g.morphAttributes.position.length;let M=o.get(g);if(M===void 0||M.count!==A){M!==void 0&&M.texture.dispose();const T=g.morphAttributes.normal!==void 0,C=g.morphAttributes.position,L=g.morphAttributes.normal||[],P=g.attributes.position.count,N=T===!0?2:1;let F=P*N,X=1;F>n.maxTextureSize&&(X=Math.ceil(F/n.maxTextureSize),F=n.maxTextureSize);const Y=new Float32Array(F*X*4*A),ae=new Dx(Y,F,X,A);ae.format=ha,ae.type=Ol;const $=N*4;for(let de=0;de<A;de++){const D=C[de],I=L[de],k=F*X*4*de;for(let U=0;U<D.count;U++){u.fromBufferAttribute(D,U),D.normalized===!0&&fT(u,D);const W=U*$;Y[k+W+0]=u.x,Y[k+W+1]=u.y,Y[k+W+2]=u.z,Y[k+W+3]=0,T===!0&&(u.fromBufferAttribute(I,U),I.normalized===!0&&fT(u,I),Y[k+W+4]=u.x,Y[k+W+5]=u.y,Y[k+W+6]=u.z,Y[k+W+7]=0)}}M={count:A,texture:ae,size:new Wt(F,X)},o.set(g,M)}let S=0;for(let T=0;T<w.length;T++)S+=w[T];const E=g.morphTargetsRelative?1:1-S;b.getUniforms().setValue(i,"morphTargetBaseInfluence",E),b.getUniforms().setValue(i,"morphTargetInfluences",w),b.getUniforms().setValue(i,"morphTargetsTexture",M.texture,r),b.getUniforms().setValue(i,"morphTargetsTextureSize",M.size)}else{const A=w===void 0?0:w.length;let M=a[g.id];if(M===void 0||M.length!==A){M=[];for(let L=0;L<A;L++)M[L]=[L,0];a[g.id]=M}for(let L=0;L<A;L++){const P=M[L];P[0]=L,P[1]=w[L]}M.sort(V8);for(let L=0;L<8;L++)L<A&&M[L][1]?(f[L][0]=M[L][0],f[L][1]=M[L][1]):(f[L][0]=Number.MAX_SAFE_INTEGER,f[L][1]=0);f.sort(G8);const S=g.morphAttributes.position,E=g.morphAttributes.normal;let T=0;for(let L=0;L<8;L++){const P=f[L],N=P[0],F=P[1];N!==Number.MAX_SAFE_INTEGER&&F?(S&&g.getAttribute("morphTarget"+L)!==S[N]&&g.setAttribute("morphTarget"+L,S[N]),E&&g.getAttribute("morphNormal"+L)!==E[N]&&g.setAttribute("morphNormal"+L,E[N]),s[L]=F,T+=F):(S&&g.hasAttribute("morphTarget"+L)===!0&&g.deleteAttribute("morphTarget"+L),E&&g.hasAttribute("morphNormal"+L)===!0&&g.deleteAttribute("morphNormal"+L),s[L]=0)}const C=g.morphTargetsRelative?1:1-T;b.getUniforms().setValue(i,"morphTargetBaseInfluence",C),b.getUniforms().setValue(i,"morphTargetInfluences",s)}}return{update:v}}function j8(i,n,r,a){let s=new WeakMap;function o(v){const m=a.render.frame,g=v.geometry,y=n.get(v,g);return s.get(y)!==m&&(n.update(y),s.set(y,m)),v.isInstancedMesh&&(v.hasEventListener("dispose",f)===!1&&v.addEventListener("dispose",f),r.update(v.instanceMatrix,34962),v.instanceColor!==null&&r.update(v.instanceColor,34962)),y}function u(){s=new WeakMap}function f(v){const m=v.target;m.removeEventListener("dispose",f),r.remove(m.instanceMatrix),m.instanceColor!==null&&r.remove(m.instanceColor)}return{update:o,dispose:u}}class dT extends qi{constructor(n=null,r=1,a=1,s=1){super(null);this.image={data:n,width:r,height:a,depth:s},this.magFilter=Xi,this.minFilter=Xi,this.wrapR=Qa,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}dT.prototype.isDataTexture3D=!0;const pT=new qi,X8=new Dx,q8=new dT,mT=new ig,vT=[],gT=[],yT=new Float32Array(16),bT=new Float32Array(9),xT=new Float32Array(4);function Lh(i,n,r){const a=i[0];if(a<=0||a>0)return i;const s=n*r;let o=vT[s];if(o===void 0&&(o=new Float32Array(s),vT[s]=o),n!==0){a.toArray(o,0);for(let u=1,f=0;u!==n;++u)f+=r,i[u].toArray(o,f)}return o}function Pa(i,n){if(i.length!==n.length)return!1;for(let r=0,a=i.length;r<a;r++)if(i[r]!==n[r])return!1;return!0}function ma(i,n){for(let r=0,a=n.length;r<a;r++)i[r]=n[r]}function wT(i,n){let r=gT[n];r===void 0&&(r=new Int32Array(n),gT[n]=r);for(let a=0;a!==n;++a)r[a]=i.allocateTextureUnit();return r}function Y8(i,n){const r=this.cache;r[0]!==n&&(i.uniform1f(this.addr,n),r[0]=n)}function $8(i,n){const r=this.cache;if(n.x!==void 0)(r[0]!==n.x||r[1]!==n.y)&&(i.uniform2f(this.addr,n.x,n.y),r[0]=n.x,r[1]=n.y);else{if(Pa(r,n))return;i.uniform2fv(this.addr,n),ma(r,n)}}function K8(i,n){const r=this.cache;if(n.x!==void 0)(r[0]!==n.x||r[1]!==n.y||r[2]!==n.z)&&(i.uniform3f(this.addr,n.x,n.y,n.z),r[0]=n.x,r[1]=n.y,r[2]=n.z);else if(n.r!==void 0)(r[0]!==n.r||r[1]!==n.g||r[2]!==n.b)&&(i.uniform3f(this.addr,n.r,n.g,n.b),r[0]=n.r,r[1]=n.g,r[2]=n.b);else{if(Pa(r,n))return;i.uniform3fv(this.addr,n),ma(r,n)}}function Z8(i,n){const r=this.cache;if(n.x!==void 0)(r[0]!==n.x||r[1]!==n.y||r[2]!==n.z||r[3]!==n.w)&&(i.uniform4f(this.addr,n.x,n.y,n.z,n.w),r[0]=n.x,r[1]=n.y,r[2]=n.z,r[3]=n.w);else{if(Pa(r,n))return;i.uniform4fv(this.addr,n),ma(r,n)}}function Q8(i,n){const r=this.cache,a=n.elements;if(a===void 0){if(Pa(r,n))return;i.uniformMatrix2fv(this.addr,!1,n),ma(r,n)}else{if(Pa(r,a))return;xT.set(a),i.uniformMatrix2fv(this.addr,!1,xT),ma(r,a)}}function J8(i,n){const r=this.cache,a=n.elements;if(a===void 0){if(Pa(r,n))return;i.uniformMatrix3fv(this.addr,!1,n),ma(r,n)}else{if(Pa(r,a))return;bT.set(a),i.uniformMatrix3fv(this.addr,!1,bT),ma(r,a)}}function ez(i,n){const r=this.cache,a=n.elements;if(a===void 0){if(Pa(r,n))return;i.uniformMatrix4fv(this.addr,!1,n),ma(r,n)}else{if(Pa(r,a))return;yT.set(a),i.uniformMatrix4fv(this.addr,!1,yT),ma(r,a)}}function tz(i,n){const r=this.cache;r[0]!==n&&(i.uniform1i(this.addr,n),r[0]=n)}function nz(i,n){const r=this.cache;Pa(r,n)||(i.uniform2iv(this.addr,n),ma(r,n))}function rz(i,n){const r=this.cache;Pa(r,n)||(i.uniform3iv(this.addr,n),ma(r,n))}function iz(i,n){const r=this.cache;Pa(r,n)||(i.uniform4iv(this.addr,n),ma(r,n))}function az(i,n){const r=this.cache;r[0]!==n&&(i.uniform1ui(this.addr,n),r[0]=n)}function oz(i,n){const r=this.cache;Pa(r,n)||(i.uniform2uiv(this.addr,n),ma(r,n))}function sz(i,n){const r=this.cache;Pa(r,n)||(i.uniform3uiv(this.addr,n),ma(r,n))}function lz(i,n){const r=this.cache;Pa(r,n)||(i.uniform4uiv(this.addr,n),ma(r,n))}function cz(i,n,r){const a=this.cache,s=r.allocateTextureUnit();a[0]!==s&&(i.uniform1i(this.addr,s),a[0]=s),r.safeSetTexture2D(n||pT,s)}function uz(i,n,r){const a=this.cache,s=r.allocateTextureUnit();a[0]!==s&&(i.uniform1i(this.addr,s),a[0]=s),r.setTexture3D(n||q8,s)}function hz(i,n,r){const a=this.cache,s=r.allocateTextureUnit();a[0]!==s&&(i.uniform1i(this.addr,s),a[0]=s),r.safeSetTextureCube(n||mT,s)}function fz(i,n,r){const a=this.cache,s=r.allocateTextureUnit();a[0]!==s&&(i.uniform1i(this.addr,s),a[0]=s),r.setTexture2DArray(n||X8,s)}function dz(i){switch(i){case 5126:return Y8;case 35664:return $8;case 35665:return K8;case 35666:return Z8;case 35674:return Q8;case 35675:return J8;case 35676:return ez;case 5124:case 35670:return tz;case 35667:case 35671:return nz;case 35668:case 35672:return rz;case 35669:case 35673:return iz;case 5125:return az;case 36294:return oz;case 36295:return sz;case 36296:return lz;case 35678:case 36198:case 36298:case 36306:case 35682:return cz;case 35679:case 36299:case 36307:return uz;case 35680:case 36300:case 36308:case 36293:return hz;case 36289:case 36303:case 36311:case 36292:return fz}}function pz(i,n){i.uniform1fv(this.addr,n)}function mz(i,n){const r=Lh(n,this.size,2);i.uniform2fv(this.addr,r)}function vz(i,n){const r=Lh(n,this.size,3);i.uniform3fv(this.addr,r)}function gz(i,n){const r=Lh(n,this.size,4);i.uniform4fv(this.addr,r)}function yz(i,n){const r=Lh(n,this.size,4);i.uniformMatrix2fv(this.addr,!1,r)}function bz(i,n){const r=Lh(n,this.size,9);i.uniformMatrix3fv(this.addr,!1,r)}function xz(i,n){const r=Lh(n,this.size,16);i.uniformMatrix4fv(this.addr,!1,r)}function wz(i,n){i.uniform1iv(this.addr,n)}function Az(i,n){i.uniform2iv(this.addr,n)}function Ez(i,n){i.uniform3iv(this.addr,n)}function _z(i,n){i.uniform4iv(this.addr,n)}function Mz(i,n){i.uniform1uiv(this.addr,n)}function Sz(i,n){i.uniform2uiv(this.addr,n)}function Tz(i,n){i.uniform3uiv(this.addr,n)}function Cz(i,n){i.uniform4uiv(this.addr,n)}function Rz(i,n,r){const a=n.length,s=wT(r,a);i.uniform1iv(this.addr,s);for(let o=0;o!==a;++o)r.safeSetTexture2D(n[o]||pT,s[o])}function Lz(i,n,r){const a=n.length,s=wT(r,a);i.uniform1iv(this.addr,s);for(let o=0;o!==a;++o)r.safeSetTextureCube(n[o]||mT,s[o])}function Pz(i){switch(i){case 5126:return pz;case 35664:return mz;case 35665:return vz;case 35666:return gz;case 35674:return yz;case 35675:return bz;case 35676:return xz;case 5124:case 35670:return wz;case 35667:case 35671:return Az;case 35668:case 35672:return Ez;case 35669:case 35673:return _z;case 5125:return Mz;case 36294:return Sz;case 36295:return Tz;case 36296:return Cz;case 35678:case 36198:case 36298:case 36306:case 35682:return Rz;case 35680:case 36300:case 36308:case 36293:return Lz}}function Dz(i,n,r){this.id=i,this.addr=r,this.cache=[],this.setValue=dz(n.type)}function AT(i,n,r){this.id=i,this.addr=r,this.cache=[],this.size=n.size,this.setValue=Pz(n.type)}AT.prototype.updateCache=function(i){const n=this.cache;i instanceof Float32Array&&n.length!==i.length&&(this.cache=new Float32Array(i.length)),ma(n,i)};function ET(i){this.id=i,this.seq=[],this.map={}}ET.prototype.setValue=function(i,n,r){const a=this.seq;for(let s=0,o=a.length;s!==o;++s){const u=a[s];u.setValue(i,n[u.id],r)}};const Ox=/(\w+)(\])?(\[|\.)?/g;function _T(i,n){i.seq.push(n),i.map[n.id]=n}function Oz(i,n,r){const a=i.name,s=a.length;for(Ox.lastIndex=0;;){const o=Ox.exec(a),u=Ox.lastIndex;let f=o[1];const v=o[2]==="]",m=o[3];if(v&&(f=f|0),m===void 0||m==="["&&u+2===s){_T(r,m===void 0?new Dz(f,i,n):new AT(f,i,n));break}else{let y=r.map[f];y===void 0&&(y=new ET(f),_T(r,y)),r=y}}}function Vl(i,n){this.seq=[],this.map={};const r=i.getProgramParameter(n,35718);for(let a=0;a<r;++a){const s=i.getActiveUniform(n,a),o=i.getUniformLocation(n,s.name);Oz(s,o,this)}}Vl.prototype.setValue=function(i,n,r,a){const s=this.map[n];s!==void 0&&s.setValue(i,r,a)};Vl.prototype.setOptional=function(i,n,r){const a=n[r];a!==void 0&&this.setValue(i,r,a)};Vl.upload=function(i,n,r,a){for(let s=0,o=n.length;s!==o;++s){const u=n[s],f=r[u.id];f.needsUpdate!==!1&&u.setValue(i,f.value,a)}};Vl.seqWithValue=function(i,n){const r=[];for(let a=0,s=i.length;a!==s;++a){const o=i[a];o.id in n&&r.push(o)}return r};function MT(i,n,r){const a=i.createShader(n);return i.shaderSource(a,r),i.compileShader(a),a}let Iz=0;function kz(i){const n=i.split(`
`);for(let r=0;r<n.length;r++)n[r]=r+1+": "+n[r];return n.join(`
`)}function ST(i){switch(i){case fa:return["Linear","( value )"];case Gc:return["sRGB","( value )"];case Zb:return["RGBE","( value )"];case DS:return["RGBM","( value, 7.0 )"];case OS:return["RGBM","( value, 16.0 )"];case IS:return["RGBD","( value, 256.0 )"];case Kb:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case R6:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",i),["Linear","( value )"]}}function TT(i,n,r){const a=i.getShaderParameter(n,35713),s=i.getShaderInfoLog(n).trim();return a&&s===""?"":r.toUpperCase()+`

`+s+`

`+kz(i.getShaderSource(n))}function qc(i,n){const r=ST(n);return"vec4 "+i+"( vec4 value ) { return "+r[0]+"ToLinear"+r[1]+"; }"}function Fz(i,n){const r=ST(n);return"vec4 "+i+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}function Bz(i,n){let r;switch(n){case TN:r="Linear";break;case CN:r="Reinhard";break;case RN:r="OptimizedCineon";break;case LN:r="ACESFilmic";break;case PN:r="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",n),r="Linear"}return"vec3 "+i+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}function Nz(i){return[i.extensionDerivatives||i.envMapCubeUV||i.bumpMap||i.tangentSpaceNormalMap||i.clearcoatNormalMap||i.flatShading||i.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(i.extensionFragDepth||i.logarithmicDepthBuffer)&&i.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",i.extensionDrawBuffers&&i.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(i.extensionShaderTextureLOD||i.envMap||i.transmission)&&i.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Ld).join(`
`)}function Uz(i){const n=[];for(const r in i){const a=i[r];a!==!1&&n.push("#define "+r+" "+a)}return n.join(`
`)}function Hz(i,n){const r={},a=i.getProgramParameter(n,35721);for(let s=0;s<a;s++){const o=i.getActiveAttrib(n,s),u=o.name;let f=1;o.type===35674&&(f=2),o.type===35675&&(f=3),o.type===35676&&(f=4),r[u]={type:o.type,location:i.getAttribLocation(n,u),locationSize:f}}return r}function Ld(i){return i!==""}function CT(i,n){return i.replace(/NUM_DIR_LIGHTS/g,n.numDirLights).replace(/NUM_SPOT_LIGHTS/g,n.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,n.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,n.numPointLights).replace(/NUM_HEMI_LIGHTS/g,n.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,n.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,n.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,n.numPointLightShadows)}function RT(i,n){return i.replace(/NUM_CLIPPING_PLANES/g,n.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,n.numClippingPlanes-n.numClipIntersection)}const zz=/^[ \t]*#include +<([\w\d./]+)>/gm;function Ix(i){return i.replace(zz,Gz)}function Gz(i,n){const r=Pr[n];if(r===void 0)throw new Error("Can not resolve #include <"+n+">");return Ix(r)}const Vz=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Wz=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function LT(i){return i.replace(Wz,PT).replace(Vz,jz)}function jz(i,n,r,a){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),PT(i,n,r,a)}function PT(i,n,r,a){let s="";for(let o=parseInt(n);o<parseInt(r);o++)s+=a.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return s}function DT(i){let n="precision "+i.precision+` float;
precision `+i.precision+" int;";return i.precision==="highp"?n+=`
#define HIGH_PRECISION`:i.precision==="mediump"?n+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(n+=`
#define LOW_PRECISION`),n}function Xz(i){let n="SHADOWMAP_TYPE_BASIC";return i.shadowMapType===cS?n="SHADOWMAP_TYPE_PCF":i.shadowMapType===aN?n="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===md&&(n="SHADOWMAP_TYPE_VSM"),n}function qz(i){let n="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case yd:case bd:n="ENVMAP_TYPE_CUBE";break;case Dv:case jb:n="ENVMAP_TYPE_CUBE_UV";break}return n}function Yz(i){let n="ENVMAP_MODE_REFLECTION";if(i.envMap)switch(i.envMapMode){case bd:case jb:n="ENVMAP_MODE_REFRACTION";break}return n}function $z(i){let n="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case Pv:n="ENVMAP_BLENDING_MULTIPLY";break;case MN:n="ENVMAP_BLENDING_MIX";break;case SN:n="ENVMAP_BLENDING_ADD";break}return n}function Kz(i,n,r,a){const s=i.getContext(),o=r.defines;let u=r.vertexShader,f=r.fragmentShader;const v=Xz(r),m=qz(r),g=Yz(r),y=$z(r),b=i.gammaFactor>0?i.gammaFactor:1,w=r.isWebGL2?"":Nz(r),A=Uz(o),M=s.createProgram();let S,E,T=r.glslVersion?"#version "+r.glslVersion+`
`:"";r.isRawShaderMaterial?(S=[A].filter(Ld).join(`
`),S.length>0&&(S+=`
`),E=[w,A].filter(Ld).join(`
`),E.length>0&&(E+=`
`)):(S=[DT(r),"#define SHADER_NAME "+r.shaderName,A,r.instancing?"#define USE_INSTANCING":"",r.instancingColor?"#define USE_INSTANCING_COLOR":"",r.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+b,"#define MAX_BONES "+r.maxBones,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+g:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.displacementMap&&r.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",r.specularColorMap?"#define USE_SPECULARCOLORMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.sheenColorMap?"#define USE_SHEENCOLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.useVertexTexture?"#define BONE_TEXTURE":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&r.flatShading===!1?"#define USE_MORPHNORMALS":"",r.morphTargets&&r.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",r.morphTargets&&r.isWebGL2?"#define MORPHTARGETS_COUNT "+r.morphTargetsCount:"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+v:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Ld).join(`
`),E=[w,DT(r),"#define SHADER_NAME "+r.shaderName,A,"#define GAMMA_FACTOR "+b,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+m:"",r.envMap?"#define "+g:"",r.envMap?"#define "+y:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoat?"#define USE_CLEARCOAT":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",r.specularColorMap?"#define USE_SPECULARCOLORMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaTest?"#define USE_ALPHATEST":"",r.sheen?"#define USE_SHEEN":"",r.sheenColorMap?"#define USE_SHEENCOLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors||r.instancingColor?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+v:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(r.extensionShaderTextureLOD||r.envMap)&&r.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",r.toneMapping!==zc?"#define TONE_MAPPING":"",r.toneMapping!==zc?Pr.tonemapping_pars_fragment:"",r.toneMapping!==zc?Bz("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",r.format===ah?"#define OPAQUE":"",Pr.encodings_pars_fragment,r.map?qc("mapTexelToLinear",r.mapEncoding):"",r.matcap?qc("matcapTexelToLinear",r.matcapEncoding):"",r.envMap?qc("envMapTexelToLinear",r.envMapEncoding):"",r.emissiveMap?qc("emissiveMapTexelToLinear",r.emissiveMapEncoding):"",r.specularColorMap?qc("specularColorMapTexelToLinear",r.specularColorMapEncoding):"",r.sheenColorMap?qc("sheenColorMapTexelToLinear",r.sheenColorMapEncoding):"",r.lightMap?qc("lightMapTexelToLinear",r.lightMapEncoding):"",Fz("linearToOutputTexel",r.outputEncoding),r.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"",`
`].filter(Ld).join(`
`)),u=Ix(u),u=CT(u,r),u=RT(u,r),f=Ix(f),f=CT(f,r),f=RT(f,r),u=LT(u),f=LT(f),r.isWebGL2&&r.isRawShaderMaterial!==!0&&(T=`#version 300 es
`,S=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+S,E=["#define varying in",r.glslVersion===kS?"":"out highp vec4 pc_fragColor;",r.glslVersion===kS?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+E);const C=T+S+u,L=T+E+f,P=MT(s,35633,C),N=MT(s,35632,L);if(s.attachShader(M,P),s.attachShader(M,N),r.index0AttributeName!==void 0?s.bindAttribLocation(M,0,r.index0AttributeName):r.morphTargets===!0&&s.bindAttribLocation(M,0,"position"),s.linkProgram(M),i.debug.checkShaderErrors){const Y=s.getProgramInfoLog(M).trim(),ae=s.getShaderInfoLog(P).trim(),$=s.getShaderInfoLog(N).trim();let de=!0,D=!0;if(s.getProgramParameter(M,35714)===!1){de=!1;const I=TT(s,P,"vertex"),k=TT(s,N,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(M,35715)+`

Program Info Log: `+Y+`
`+I+`
`+k)}else Y!==""?console.warn("THREE.WebGLProgram: Program Info Log:",Y):(ae===""||$==="")&&(D=!1);D&&(this.diagnostics={runnable:de,programLog:Y,vertexShader:{log:ae,prefix:S},fragmentShader:{log:$,prefix:E}})}s.deleteShader(P),s.deleteShader(N);let F;this.getUniforms=function(){return F===void 0&&(F=new Vl(s,M)),F};let X;return this.getAttributes=function(){return X===void 0&&(X=Hz(s,M)),X},this.destroy=function(){a.releaseStatesOfProgram(this),s.deleteProgram(M),this.program=void 0},this.name=r.shaderName,this.id=Iz++,this.cacheKey=n,this.usedTimes=1,this.program=M,this.vertexShader=P,this.fragmentShader=N,this}function Zz(i,n,r,a,s,o,u){const f=[],v=s.isWebGL2,m=s.logarithmicDepthBuffer,g=s.floatVertexTextures,y=s.maxVertexUniforms,b=s.vertexTextures;let w=s.precision;const A={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},M=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoat","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap",,"roughnessMap","metalnessMap","gradientMap","alphaMap","alphaTest","combine","vertexColors","vertexAlphas","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","morphTargetsCount","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","format","specularIntensityMap","specularColorMap","specularColorMapEncoding","transmission","transmissionMap","thicknessMap","sheen","sheenColorMap","sheenColorMapEncoding","sheenRoughnessMap"];function S(F){const Y=F.skeleton.bones;if(g)return 1024;{const $=Math.floor((y-20)/4),de=Math.min($,Y.length);return de<Y.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+Y.length+" bones. This GPU supports "+de+"."),0):de}}function E(F){let X;return F&&F.isTexture?X=F.encoding:F&&F.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),X=F.texture.encoding):X=fa,v&&F&&F.isTexture&&F.format===ha&&F.type===Dl&&F.encoding===Gc&&(X=fa),X}function T(F,X,Y,ae,$){const de=ae.fog,D=F.isMeshStandardMaterial?ae.environment:null,I=(F.isMeshStandardMaterial?r:n).get(F.envMap||D),k=A[F.type],U=$.isSkinnedMesh?S($):0;F.precision!==null&&(w=s.getMaxPrecision(F.precision),w!==F.precision&&console.warn("THREE.WebGLProgram.getParameters:",F.precision,"not supported, using",w,"instead."));let W,ce;if(k){const Ie=os[k];W=Ie.vertexShader,ce=Ie.fragmentShader}else W=F.vertexShader,ce=F.fragmentShader;const oe=i.getRenderTarget(),ge=F.alphaTest>0,_e=F.clearcoat>0;return{isWebGL2:v,shaderID:k,shaderName:F.type,vertexShader:W,fragmentShader:ce,defines:F.defines,isRawShaderMaterial:F.isRawShaderMaterial===!0,glslVersion:F.glslVersion,precision:w,instancing:$.isInstancedMesh===!0,instancingColor:$.isInstancedMesh===!0&&$.instanceColor!==null,supportsVertexTextures:b,outputEncoding:oe!==null?E(oe.texture):i.outputEncoding,map:!!F.map,mapEncoding:E(F.map),matcap:!!F.matcap,matcapEncoding:E(F.matcap),envMap:!!I,envMapMode:I&&I.mapping,envMapEncoding:E(I),envMapCubeUV:!!I&&(I.mapping===Dv||I.mapping===jb),lightMap:!!F.lightMap,lightMapEncoding:E(F.lightMap),aoMap:!!F.aoMap,emissiveMap:!!F.emissiveMap,emissiveMapEncoding:E(F.emissiveMap),bumpMap:!!F.bumpMap,normalMap:!!F.normalMap,objectSpaceNormalMap:F.normalMapType===D6,tangentSpaceNormalMap:F.normalMapType===ch,clearcoat:_e,clearcoatMap:_e&&!!F.clearcoatMap,clearcoatRoughnessMap:_e&&!!F.clearcoatRoughnessMap,clearcoatNormalMap:_e&&!!F.clearcoatNormalMap,displacementMap:!!F.displacementMap,roughnessMap:!!F.roughnessMap,metalnessMap:!!F.metalnessMap,specularMap:!!F.specularMap,specularIntensityMap:!!F.specularIntensityMap,specularColorMap:!!F.specularColorMap,specularColorMapEncoding:E(F.specularColorMap),alphaMap:!!F.alphaMap,alphaTest:ge,gradientMap:!!F.gradientMap,sheen:F.sheen>0,sheenColorMap:!!F.sheenColorMap,sheenColorMapEncoding:E(F.sheenColorMap),sheenRoughnessMap:!!F.sheenRoughnessMap,transmission:F.transmission>0,transmissionMap:!!F.transmissionMap,thicknessMap:!!F.thicknessMap,combine:F.combine,vertexTangents:!!F.normalMap&&!!$.geometry&&!!$.geometry.attributes.tangent,vertexColors:F.vertexColors,vertexAlphas:F.vertexColors===!0&&!!$.geometry&&!!$.geometry.attributes.color&&$.geometry.attributes.color.itemSize===4,vertexUvs:!!F.map||!!F.bumpMap||!!F.normalMap||!!F.specularMap||!!F.alphaMap||!!F.emissiveMap||!!F.roughnessMap||!!F.metalnessMap||!!F.clearcoatMap||!!F.clearcoatRoughnessMap||!!F.clearcoatNormalMap||!!F.displacementMap||!!F.transmissionMap||!!F.thicknessMap||!!F.specularIntensityMap||!!F.specularColorMap||!!F.sheenColorMap||F.sheenRoughnessMap,uvsVertexOnly:!(!!F.map||!!F.bumpMap||!!F.normalMap||!!F.specularMap||!!F.alphaMap||!!F.emissiveMap||!!F.roughnessMap||!!F.metalnessMap||!!F.clearcoatNormalMap||F.transmission>0||!!F.transmissionMap||!!F.thicknessMap||!!F.specularIntensityMap||!!F.specularColorMap||!!F.sheen>0||!!F.sheenColorMap||!!F.sheenRoughnessMap)&&!!F.displacementMap,fog:!!de,useFog:F.fog,fogExp2:de&&de.isFogExp2,flatShading:!!F.flatShading,sizeAttenuation:F.sizeAttenuation,logarithmicDepthBuffer:m,skinning:$.isSkinnedMesh===!0&&U>0,maxBones:U,useVertexTexture:g,morphTargets:!!$.geometry&&!!$.geometry.morphAttributes.position,morphNormals:!!$.geometry&&!!$.geometry.morphAttributes.normal,morphTargetsCount:!!$.geometry&&!!$.geometry.morphAttributes.position?$.geometry.morphAttributes.position.length:0,numDirLights:X.directional.length,numPointLights:X.point.length,numSpotLights:X.spot.length,numRectAreaLights:X.rectArea.length,numHemiLights:X.hemi.length,numDirLightShadows:X.directionalShadowMap.length,numPointLightShadows:X.pointShadowMap.length,numSpotLightShadows:X.spotShadowMap.length,numClippingPlanes:u.numPlanes,numClipIntersection:u.numIntersection,format:F.format,dithering:F.dithering,shadowMapEnabled:i.shadowMap.enabled&&Y.length>0,shadowMapType:i.shadowMap.type,toneMapping:F.toneMapped?i.toneMapping:zc,physicallyCorrectLights:i.physicallyCorrectLights,premultipliedAlpha:F.premultipliedAlpha,doubleSided:F.side===nh,flipSided:F.side===Ni,depthPacking:F.depthPacking!==void 0?F.depthPacking:!1,index0AttributeName:F.index0AttributeName,extensionDerivatives:F.extensions&&F.extensions.derivatives,extensionFragDepth:F.extensions&&F.extensions.fragDepth,extensionDrawBuffers:F.extensions&&F.extensions.drawBuffers,extensionShaderTextureLOD:F.extensions&&F.extensions.shaderTextureLOD,rendererExtensionFragDepth:v||a.has("EXT_frag_depth"),rendererExtensionDrawBuffers:v||a.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:v||a.has("EXT_shader_texture_lod"),customProgramCacheKey:F.customProgramCacheKey()}}function C(F){const X=[];if(F.shaderID?X.push(F.shaderID):(X.push(NS(F.fragmentShader)),X.push(NS(F.vertexShader))),F.defines!==void 0)for(const Y in F.defines)X.push(Y),X.push(F.defines[Y]);if(F.isRawShaderMaterial===!1){for(let Y=0;Y<M.length;Y++)X.push(F[M[Y]]);X.push(i.outputEncoding),X.push(i.gammaFactor)}return X.push(F.customProgramCacheKey),X.join()}function L(F){const X=A[F.type];let Y;if(X){const ae=os[X];Y=tT.clone(ae.uniforms)}else Y=F.uniforms;return Y}function P(F,X){let Y;for(let ae=0,$=f.length;ae<$;ae++){const de=f[ae];if(de.cacheKey===X){Y=de,++Y.usedTimes;break}}return Y===void 0&&(Y=new Kz(i,X,F,o),f.push(Y)),Y}function N(F){if(--F.usedTimes==0){const X=f.indexOf(F);f[X]=f[f.length-1],f.pop(),F.destroy()}}return{getParameters:T,getProgramCacheKey:C,getUniforms:L,acquireProgram:P,releaseProgram:N,programs:f}}function Qz(){let i=new WeakMap;function n(o){let u=i.get(o);return u===void 0&&(u={},i.set(o,u)),u}function r(o){i.delete(o)}function a(o,u,f){i.get(o)[u]=f}function s(){i=new WeakMap}return{get:n,remove:r,update:a,dispose:s}}function Jz(i,n){return i.groupOrder!==n.groupOrder?i.groupOrder-n.groupOrder:i.renderOrder!==n.renderOrder?i.renderOrder-n.renderOrder:i.program!==n.program?i.program.id-n.program.id:i.material.id!==n.material.id?i.material.id-n.material.id:i.z!==n.z?i.z-n.z:i.id-n.id}function OT(i,n){return i.groupOrder!==n.groupOrder?i.groupOrder-n.groupOrder:i.renderOrder!==n.renderOrder?i.renderOrder-n.renderOrder:i.z!==n.z?n.z-i.z:i.id-n.id}function IT(i){const n=[];let r=0;const a=[],s=[],o=[],u={id:-1};function f(){r=0,a.length=0,s.length=0,o.length=0}function v(w,A,M,S,E,T){let C=n[r];const L=i.get(M);return C===void 0?(C={id:w.id,object:w,geometry:A,material:M,program:L.program||u,groupOrder:S,renderOrder:w.renderOrder,z:E,group:T},n[r]=C):(C.id=w.id,C.object=w,C.geometry=A,C.material=M,C.program=L.program||u,C.groupOrder=S,C.renderOrder=w.renderOrder,C.z=E,C.group=T),r++,C}function m(w,A,M,S,E,T){const C=v(w,A,M,S,E,T);M.transmission>0?s.push(C):M.transparent===!0?o.push(C):a.push(C)}function g(w,A,M,S,E,T){const C=v(w,A,M,S,E,T);M.transmission>0?s.unshift(C):M.transparent===!0?o.unshift(C):a.unshift(C)}function y(w,A){a.length>1&&a.sort(w||Jz),s.length>1&&s.sort(A||OT),o.length>1&&o.sort(A||OT)}function b(){for(let w=r,A=n.length;w<A;w++){const M=n[w];if(M.id===null)break;M.id=null,M.object=null,M.geometry=null,M.material=null,M.program=null,M.group=null}}return{opaque:a,transmissive:s,transparent:o,init:f,push:m,unshift:g,finish:b,sort:y}}function eG(i){let n=new WeakMap;function r(s,o){let u;return n.has(s)===!1?(u=new IT(i),n.set(s,[u])):o>=n.get(s).length?(u=new IT(i),n.get(s).push(u)):u=n.get(s)[o],u}function a(){n=new WeakMap}return{get:r,dispose:a}}function tG(){const i={};return{get:function(n){if(i[n.id]!==void 0)return i[n.id];let r;switch(n.type){case"DirectionalLight":r={direction:new Ze,color:new On};break;case"SpotLight":r={position:new Ze,direction:new Ze,color:new On,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":r={position:new Ze,color:new On,distance:0,decay:0};break;case"HemisphereLight":r={direction:new Ze,skyColor:new On,groundColor:new On};break;case"RectAreaLight":r={color:new On,position:new Ze,halfWidth:new Ze,halfHeight:new Ze};break}return i[n.id]=r,r}}}function nG(){const i={};return{get:function(n){if(i[n.id]!==void 0)return i[n.id];let r;switch(n.type){case"DirectionalLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Wt};break;case"SpotLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Wt};break;case"PointLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Wt,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[n.id]=r,r}}}let rG=0;function iG(i,n){return(n.castShadow?1:0)-(i.castShadow?1:0)}function aG(i,n){const r=new tG,a=nG(),s={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let g=0;g<9;g++)s.probe.push(new Ze);const o=new Ze,u=new jn,f=new jn;function v(g,y){let b=0,w=0,A=0;for(let Y=0;Y<9;Y++)s.probe[Y].set(0,0,0);let M=0,S=0,E=0,T=0,C=0,L=0,P=0,N=0;g.sort(iG);const F=y!==!0?Math.PI:1;for(let Y=0,ae=g.length;Y<ae;Y++){const $=g[Y],de=$.color,D=$.intensity,I=$.distance,k=$.shadow&&$.shadow.map?$.shadow.map.texture:null;if($.isAmbientLight)b+=de.r*D*F,w+=de.g*D*F,A+=de.b*D*F;else if($.isLightProbe)for(let U=0;U<9;U++)s.probe[U].addScaledVector($.sh.coefficients[U],D);else if($.isDirectionalLight){const U=r.get($);if(U.color.copy($.color).multiplyScalar($.intensity*F),$.castShadow){const W=$.shadow,ce=a.get($);ce.shadowBias=W.bias,ce.shadowNormalBias=W.normalBias,ce.shadowRadius=W.radius,ce.shadowMapSize=W.mapSize,s.directionalShadow[M]=ce,s.directionalShadowMap[M]=k,s.directionalShadowMatrix[M]=$.shadow.matrix,L++}s.directional[M]=U,M++}else if($.isSpotLight){const U=r.get($);if(U.position.setFromMatrixPosition($.matrixWorld),U.color.copy(de).multiplyScalar(D*F),U.distance=I,U.coneCos=Math.cos($.angle),U.penumbraCos=Math.cos($.angle*(1-$.penumbra)),U.decay=$.decay,$.castShadow){const W=$.shadow,ce=a.get($);ce.shadowBias=W.bias,ce.shadowNormalBias=W.normalBias,ce.shadowRadius=W.radius,ce.shadowMapSize=W.mapSize,s.spotShadow[E]=ce,s.spotShadowMap[E]=k,s.spotShadowMatrix[E]=$.shadow.matrix,N++}s.spot[E]=U,E++}else if($.isRectAreaLight){const U=r.get($);U.color.copy(de).multiplyScalar(D),U.halfWidth.set($.width*.5,0,0),U.halfHeight.set(0,$.height*.5,0),s.rectArea[T]=U,T++}else if($.isPointLight){const U=r.get($);if(U.color.copy($.color).multiplyScalar($.intensity*F),U.distance=$.distance,U.decay=$.decay,$.castShadow){const W=$.shadow,ce=a.get($);ce.shadowBias=W.bias,ce.shadowNormalBias=W.normalBias,ce.shadowRadius=W.radius,ce.shadowMapSize=W.mapSize,ce.shadowCameraNear=W.camera.near,ce.shadowCameraFar=W.camera.far,s.pointShadow[S]=ce,s.pointShadowMap[S]=k,s.pointShadowMatrix[S]=$.shadow.matrix,P++}s.point[S]=U,S++}else if($.isHemisphereLight){const U=r.get($);U.skyColor.copy($.color).multiplyScalar(D*F),U.groundColor.copy($.groundColor).multiplyScalar(D*F),s.hemi[C]=U,C++}}T>0&&(n.isWebGL2||i.has("OES_texture_float_linear")===!0?(s.rectAreaLTC1=un.LTC_FLOAT_1,s.rectAreaLTC2=un.LTC_FLOAT_2):i.has("OES_texture_half_float_linear")===!0?(s.rectAreaLTC1=un.LTC_HALF_1,s.rectAreaLTC2=un.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),s.ambient[0]=b,s.ambient[1]=w,s.ambient[2]=A;const X=s.hash;(X.directionalLength!==M||X.pointLength!==S||X.spotLength!==E||X.rectAreaLength!==T||X.hemiLength!==C||X.numDirectionalShadows!==L||X.numPointShadows!==P||X.numSpotShadows!==N)&&(s.directional.length=M,s.spot.length=E,s.rectArea.length=T,s.point.length=S,s.hemi.length=C,s.directionalShadow.length=L,s.directionalShadowMap.length=L,s.pointShadow.length=P,s.pointShadowMap.length=P,s.spotShadow.length=N,s.spotShadowMap.length=N,s.directionalShadowMatrix.length=L,s.pointShadowMatrix.length=P,s.spotShadowMatrix.length=N,X.directionalLength=M,X.pointLength=S,X.spotLength=E,X.rectAreaLength=T,X.hemiLength=C,X.numDirectionalShadows=L,X.numPointShadows=P,X.numSpotShadows=N,s.version=rG++)}function m(g,y){let b=0,w=0,A=0,M=0,S=0;const E=y.matrixWorldInverse;for(let T=0,C=g.length;T<C;T++){const L=g[T];if(L.isDirectionalLight){const P=s.directional[b];P.direction.setFromMatrixPosition(L.matrixWorld),o.setFromMatrixPosition(L.target.matrixWorld),P.direction.sub(o),P.direction.transformDirection(E),b++}else if(L.isSpotLight){const P=s.spot[A];P.position.setFromMatrixPosition(L.matrixWorld),P.position.applyMatrix4(E),P.direction.setFromMatrixPosition(L.matrixWorld),o.setFromMatrixPosition(L.target.matrixWorld),P.direction.sub(o),P.direction.transformDirection(E),A++}else if(L.isRectAreaLight){const P=s.rectArea[M];P.position.setFromMatrixPosition(L.matrixWorld),P.position.applyMatrix4(E),f.identity(),u.copy(L.matrixWorld),u.premultiply(E),f.extractRotation(u),P.halfWidth.set(L.width*.5,0,0),P.halfHeight.set(0,L.height*.5,0),P.halfWidth.applyMatrix4(f),P.halfHeight.applyMatrix4(f),M++}else if(L.isPointLight){const P=s.point[w];P.position.setFromMatrixPosition(L.matrixWorld),P.position.applyMatrix4(E),w++}else if(L.isHemisphereLight){const P=s.hemi[S];P.direction.setFromMatrixPosition(L.matrixWorld),P.direction.transformDirection(E),P.direction.normalize(),S++}}}return{setup:v,setupView:m,state:s}}function kT(i,n){const r=new aG(i,n),a=[],s=[];function o(){a.length=0,s.length=0}function u(y){a.push(y)}function f(y){s.push(y)}function v(y){r.setup(a,y)}function m(y){r.setupView(a,y)}return{init:o,state:{lightsArray:a,shadowsArray:s,lights:r},setupLights:v,setupLightsView:m,pushLight:u,pushShadow:f}}function oG(i,n){let r=new WeakMap;function a(o,u=0){let f;return r.has(o)===!1?(f=new kT(i,n),r.set(o,[f])):u>=r.get(o).length?(f=new kT(i,n),r.get(o).push(f)):f=r.get(o)[u],f}function s(){r=new WeakMap}return{get:a,dispose:s}}class FT extends da{constructor(n){super();this.type="MeshDepthMaterial",this.depthPacking=L6,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(n)}copy(n){return super.copy(n),this.depthPacking=n.depthPacking,this.map=n.map,this.alphaMap=n.alphaMap,this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this}}FT.prototype.isMeshDepthMaterial=!0;class BT extends da{constructor(n){super();this.type="MeshDistanceMaterial",this.referencePosition=new Ze,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(n)}copy(n){return super.copy(n),this.referencePosition.copy(n.referencePosition),this.nearDistance=n.nearDistance,this.farDistance=n.farDistance,this.map=n.map,this.alphaMap=n.alphaMap,this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this}}BT.prototype.isMeshDistanceMaterial=!0;const sG=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,lG=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function NT(i,n,r){let a=new og;const s=new Wt,o=new Wt,u=new ci,f=new FT({depthPacking:P6}),v=new BT,m={},g=r.maxTextureSize,y={0:Ni,1:vd,2:nh},b=new Us({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Wt},radius:{value:4}},vertexShader:sG,fragmentShader:lG}),w=b.clone();w.defines.HORIZONTAL_PASS=1;const A=new Zr;A.setAttribute("position",new zi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const M=new ra(A,b),S=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=cS,this.render=function(L,P,N){if(S.enabled===!1||S.autoUpdate===!1&&S.needsUpdate===!1||L.length===0)return;const F=i.getRenderTarget(),X=i.getActiveCubeFace(),Y=i.getActiveMipmapLevel(),ae=i.state;ae.setBlending(Pl),ae.buffers.color.setClear(1,1,1,1),ae.buffers.depth.setTest(!0),ae.setScissorTest(!1);for(let $=0,de=L.length;$<de;$++){const D=L[$],I=D.shadow;if(I===void 0){console.warn("THREE.WebGLShadowMap:",D,"has no shadow.");continue}if(I.autoUpdate===!1&&I.needsUpdate===!1)continue;s.copy(I.mapSize);const k=I.getFrameExtents();if(s.multiply(k),o.copy(I.mapSize),(s.x>g||s.y>g)&&(s.x>g&&(o.x=Math.floor(g/k.x),s.x=o.x*k.x,I.mapSize.x=o.x),s.y>g&&(o.y=Math.floor(g/k.y),s.y=o.y*k.y,I.mapSize.y=o.y)),I.map===null&&!I.isPointLightShadow&&this.type===md){const W={minFilter:Ra,magFilter:Ra,format:ha};I.map=new Do(s.x,s.y,W),I.map.texture.name=D.name+".shadowMap",I.mapPass=new Do(s.x,s.y,W),I.camera.updateProjectionMatrix()}if(I.map===null){const W={minFilter:Xi,magFilter:Xi,format:ha};I.map=new Do(s.x,s.y,W),I.map.texture.name=D.name+".shadowMap",I.camera.updateProjectionMatrix()}i.setRenderTarget(I.map),i.clear();const U=I.getViewportCount();for(let W=0;W<U;W++){const ce=I.getViewport(W);u.set(o.x*ce.x,o.y*ce.y,o.x*ce.z,o.y*ce.w),ae.viewport(u),I.updateMatrices(D,W),a=I.getFrustum(),C(P,N,I.camera,D,this.type)}!I.isPointLightShadow&&this.type===md&&E(I,N),I.needsUpdate=!1}S.needsUpdate=!1,i.setRenderTarget(F,X,Y)};function E(L,P){const N=n.update(M);b.defines.VSM_SAMPLES!==L.blurSamples&&(b.defines.VSM_SAMPLES=L.blurSamples,w.defines.VSM_SAMPLES=L.blurSamples,b.needsUpdate=!0,w.needsUpdate=!0),b.uniforms.shadow_pass.value=L.map.texture,b.uniforms.resolution.value=L.mapSize,b.uniforms.radius.value=L.radius,i.setRenderTarget(L.mapPass),i.clear(),i.renderBufferDirect(P,null,N,b,M,null),w.uniforms.shadow_pass.value=L.mapPass.texture,w.uniforms.resolution.value=L.mapSize,w.uniforms.radius.value=L.radius,i.setRenderTarget(L.map),i.clear(),i.renderBufferDirect(P,null,N,w,M,null)}function T(L,P,N,F,X,Y,ae){let $=null;const de=F.isPointLight===!0?L.customDistanceMaterial:L.customDepthMaterial;if(de!==void 0?$=de:$=F.isPointLight===!0?v:f,i.localClippingEnabled&&N.clipShadows===!0&&N.clippingPlanes.length!==0||N.displacementMap&&N.displacementScale!==0||N.alphaMap&&N.alphaTest>0){const D=$.uuid,I=N.uuid;let k=m[D];k===void 0&&(k={},m[D]=k);let U=k[I];U===void 0&&(U=$.clone(),k[I]=U),$=U}return $.visible=N.visible,$.wireframe=N.wireframe,ae===md?$.side=N.shadowSide!==null?N.shadowSide:N.side:$.side=N.shadowSide!==null?N.shadowSide:y[N.side],$.alphaMap=N.alphaMap,$.alphaTest=N.alphaTest,$.clipShadows=N.clipShadows,$.clippingPlanes=N.clippingPlanes,$.clipIntersection=N.clipIntersection,$.displacementMap=N.displacementMap,$.displacementScale=N.displacementScale,$.displacementBias=N.displacementBias,$.wireframeLinewidth=N.wireframeLinewidth,$.linewidth=N.linewidth,F.isPointLight===!0&&$.isMeshDistanceMaterial===!0&&($.referencePosition.setFromMatrixPosition(F.matrixWorld),$.nearDistance=X,$.farDistance=Y),$}function C(L,P,N,F,X){if(L.visible===!1)return;if(L.layers.test(P.layers)&&(L.isMesh||L.isLine||L.isPoints)&&(L.castShadow||L.receiveShadow&&X===md)&&(!L.frustumCulled||a.intersectsObject(L))){L.modelViewMatrix.multiplyMatrices(N.matrixWorldInverse,L.matrixWorld);const $=n.update(L),de=L.material;if(Array.isArray(de)){const D=$.groups;for(let I=0,k=D.length;I<k;I++){const U=D[I],W=de[U.materialIndex];if(W&&W.visible){const ce=T(L,$,W,F,N.near,N.far,X);i.renderBufferDirect(N,null,$,ce,L,U)}}}else if(de.visible){const D=T(L,$,de,F,N.near,N.far,X);i.renderBufferDirect(N,null,$,D,L,null)}}const ae=L.children;for(let $=0,de=ae.length;$<de;$++)C(ae[$],P,N,F,X)}}function cG(i,n,r){const a=r.isWebGL2;function s(){let xe=!1;const Je=new ci;let Xe=null;const Mt=new ci(0,0,0,0);return{setMask:function(qe){Xe!==qe&&!xe&&(i.colorMask(qe,qe,qe,qe),Xe=qe)},setLocked:function(qe){xe=qe},setClear:function(qe,It,rn,Yt,Tn){Tn===!0&&(qe*=Yt,It*=Yt,rn*=Yt),Je.set(qe,It,rn,Yt),Mt.equals(Je)===!1&&(i.clearColor(qe,It,rn,Yt),Mt.copy(Je))},reset:function(){xe=!1,Xe=null,Mt.set(-1,0,0,0)}}}function o(){let xe=!1,Je=null,Xe=null,Mt=null;return{setTest:function(qe){qe?Ve(2929):Le(2929)},setMask:function(qe){Je!==qe&&!xe&&(i.depthMask(qe),Je=qe)},setFunc:function(qe){if(Xe!==qe){if(qe)switch(qe){case yN:i.depthFunc(512);break;case bN:i.depthFunc(519);break;case xN:i.depthFunc(513);break;case Gb:i.depthFunc(515);break;case wN:i.depthFunc(514);break;case AN:i.depthFunc(518);break;case EN:i.depthFunc(516);break;case _N:i.depthFunc(517);break;default:i.depthFunc(515)}else i.depthFunc(515);Xe=qe}},setLocked:function(qe){xe=qe},setClear:function(qe){Mt!==qe&&(i.clearDepth(qe),Mt=qe)},reset:function(){xe=!1,Je=null,Xe=null,Mt=null}}}function u(){let xe=!1,Je=null,Xe=null,Mt=null,qe=null,It=null,rn=null,Yt=null,Tn=null;return{setTest:function(Jt){xe||(Jt?Ve(2960):Le(2960))},setMask:function(Jt){Je!==Jt&&!xe&&(i.stencilMask(Jt),Je=Jt)},setFunc:function(Jt,Fn,mr){(Xe!==Jt||Mt!==Fn||qe!==mr)&&(i.stencilFunc(Jt,Fn,mr),Xe=Jt,Mt=Fn,qe=mr)},setOp:function(Jt,Fn,mr){(It!==Jt||rn!==Fn||Yt!==mr)&&(i.stencilOp(Jt,Fn,mr),It=Jt,rn=Fn,Yt=mr)},setLocked:function(Jt){xe=Jt},setClear:function(Jt){Tn!==Jt&&(i.clearStencil(Jt),Tn=Jt)},reset:function(){xe=!1,Je=null,Xe=null,Mt=null,qe=null,It=null,rn=null,Yt=null,Tn=null}}}const f=new s,v=new o,m=new u;let g={},y=null,b={},w=null,A=!1,M=null,S=null,E=null,T=null,C=null,L=null,P=null,N=!1,F=null,X=null,Y=null,ae=null,$=null;const de=i.getParameter(35661);let D=!1,I=0;const k=i.getParameter(7938);k.indexOf("WebGL")!==-1?(I=parseFloat(/^WebGL (\d)/.exec(k)[1]),D=I>=1):k.indexOf("OpenGL ES")!==-1&&(I=parseFloat(/^OpenGL ES (\d)/.exec(k)[1]),D=I>=2);let U=null,W={};const ce=i.getParameter(3088),oe=i.getParameter(2978),ge=new ci().fromArray(ce),_e=new ci().fromArray(oe);function Ne(xe,Je,Xe){const Mt=new Uint8Array(4),qe=i.createTexture();i.bindTexture(xe,qe),i.texParameteri(xe,10241,9728),i.texParameteri(xe,10240,9728);for(let It=0;It<Xe;It++)i.texImage2D(Je+It,0,6408,1,1,0,6408,5121,Mt);return qe}const Ie={};Ie[3553]=Ne(3553,3553,1),Ie[34067]=Ne(34067,34069,6),f.setClear(0,0,0,1),v.setClear(1),m.setClear(0),Ve(2929),v.setFunc(Gb),H(!1),j(lS),Ve(2884),ye(Pl);function Ve(xe){g[xe]!==!0&&(i.enable(xe),g[xe]=!0)}function Le(xe){g[xe]!==!1&&(i.disable(xe),g[xe]=!1)}function Fe(xe){xe!==y&&(i.bindFramebuffer(36160,xe),y=xe)}function Me(xe,Je){return Je===null&&y!==null&&(Je=y),b[xe]!==Je?(i.bindFramebuffer(xe,Je),b[xe]=Je,a&&(xe===36009&&(b[36160]=Je),xe===36160&&(b[36009]=Je)),!0):!1}function Qe(xe){return w!==xe?(i.useProgram(xe),w=xe,!0):!1}const mt={[rh]:32774,[sN]:32778,[lN]:32779};if(a)mt[pS]=32775,mt[mS]=32776;else{const xe=n.get("EXT_blend_minmax");xe!==null&&(mt[pS]=xe.MIN_EXT,mt[mS]=xe.MAX_EXT)}const ht={[cN]:0,[uN]:1,[hN]:768,[vS]:770,[gN]:776,[mN]:774,[dN]:772,[fN]:769,[gS]:771,[vN]:775,[pN]:773};function ye(xe,Je,Xe,Mt,qe,It,rn,Yt){if(xe===Pl){A===!0&&(Le(3042),A=!1);return}if(A===!1&&(Ve(3042),A=!0),xe!==oN){if(xe!==M||Yt!==N){if((S!==rh||C!==rh)&&(i.blendEquation(32774),S=rh,C=rh),Yt)switch(xe){case gd:i.blendFuncSeparate(1,771,1,771);break;case hS:i.blendFunc(1,1);break;case fS:i.blendFuncSeparate(0,0,769,771);break;case dS:i.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",xe);break}else switch(xe){case gd:i.blendFuncSeparate(770,771,1,771);break;case hS:i.blendFunc(770,1);break;case fS:i.blendFunc(0,769);break;case dS:i.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",xe);break}E=null,T=null,L=null,P=null,M=xe,N=Yt}return}qe=qe||Je,It=It||Xe,rn=rn||Mt,(Je!==S||qe!==C)&&(i.blendEquationSeparate(mt[Je],mt[qe]),S=Je,C=qe),(Xe!==E||Mt!==T||It!==L||rn!==P)&&(i.blendFuncSeparate(ht[Xe],ht[Mt],ht[It],ht[rn]),E=Xe,T=Mt,L=It,P=rn),M=xe,N=null}function fe(xe,Je){xe.side===nh?Le(2884):Ve(2884);let Xe=xe.side===Ni;Je&&(Xe=!Xe),H(Xe),xe.blending===gd&&xe.transparent===!1?ye(Pl):ye(xe.blending,xe.blendEquation,xe.blendSrc,xe.blendDst,xe.blendEquationAlpha,xe.blendSrcAlpha,xe.blendDstAlpha,xe.premultipliedAlpha),v.setFunc(xe.depthFunc),v.setTest(xe.depthTest),v.setMask(xe.depthWrite),f.setMask(xe.colorWrite);const Mt=xe.stencilWrite;m.setTest(Mt),Mt&&(m.setMask(xe.stencilWriteMask),m.setFunc(xe.stencilFunc,xe.stencilRef,xe.stencilFuncMask),m.setOp(xe.stencilFail,xe.stencilZFail,xe.stencilZPass)),pe(xe.polygonOffset,xe.polygonOffsetFactor,xe.polygonOffsetUnits),xe.alphaToCoverage===!0?Ve(32926):Le(32926)}function H(xe){F!==xe&&(xe?i.frontFace(2304):i.frontFace(2305),F=xe)}function j(xe){xe!==rN?(Ve(2884),xe!==X&&(xe===lS?i.cullFace(1029):xe===iN?i.cullFace(1028):i.cullFace(1032))):Le(2884),X=xe}function q(xe){xe!==Y&&(D&&i.lineWidth(xe),Y=xe)}function pe(xe,Je,Xe){xe?(Ve(32823),(ae!==Je||$!==Xe)&&(i.polygonOffset(Je,Xe),ae=Je,$=Xe)):Le(32823)}function ee(xe){xe?Ve(3089):Le(3089)}function te(xe){xe===void 0&&(xe=33984+de-1),U!==xe&&(i.activeTexture(xe),U=xe)}function Se(xe,Je){U===null&&te();let Xe=W[U];Xe===void 0&&(Xe={type:void 0,texture:void 0},W[U]=Xe),(Xe.type!==xe||Xe.texture!==Je)&&(i.bindTexture(xe,Je||Ie[xe]),Xe.type=xe,Xe.texture=Je)}function ke(){const xe=W[U];xe!==void 0&&xe.type!==void 0&&(i.bindTexture(xe.type,null),xe.type=void 0,xe.texture=void 0)}function Be(){try{i.compressedTexImage2D.apply(i,arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function We(){try{i.texImage2D.apply(i,arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function ve(){try{i.texImage3D.apply(i,arguments)}catch(xe){console.error("THREE.WebGLState:",xe)}}function K(xe){ge.equals(xe)===!1&&(i.scissor(xe.x,xe.y,xe.z,xe.w),ge.copy(xe))}function J(xe){_e.equals(xe)===!1&&(i.viewport(xe.x,xe.y,xe.z,xe.w),_e.copy(xe))}function Ee(){i.disable(3042),i.disable(2884),i.disable(2929),i.disable(32823),i.disable(3089),i.disable(2960),i.disable(32926),i.blendEquation(32774),i.blendFunc(1,0),i.blendFuncSeparate(1,0,1,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(513),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(519,0,4294967295),i.stencilOp(7680,7680,7680),i.clearStencil(0),i.cullFace(1029),i.frontFace(2305),i.polygonOffset(0,0),i.activeTexture(33984),i.bindFramebuffer(36160,null),a===!0&&(i.bindFramebuffer(36009,null),i.bindFramebuffer(36008,null)),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),g={},U=null,W={},y=null,b={},w=null,A=!1,M=null,S=null,E=null,T=null,C=null,L=null,P=null,N=!1,F=null,X=null,Y=null,ae=null,$=null,ge.set(0,0,i.canvas.width,i.canvas.height),_e.set(0,0,i.canvas.width,i.canvas.height),f.reset(),v.reset(),m.reset()}return{buffers:{color:f,depth:v,stencil:m},enable:Ve,disable:Le,bindFramebuffer:Me,bindXRFramebuffer:Fe,useProgram:Qe,setBlending:ye,setMaterial:fe,setFlipSided:H,setCullFace:j,setLineWidth:q,setPolygonOffset:pe,setScissorTest:ee,activeTexture:te,bindTexture:Se,unbindTexture:ke,compressedTexImage2D:Be,texImage2D:We,texImage3D:ve,scissor:K,viewport:J,reset:Ee}}function uG(i,n,r,a,s,o,u){const f=s.isWebGL2,v=s.maxTextures,m=s.maxCubemapSize,g=s.maxTextureSize,y=s.maxSamples,b=new WeakMap;let w,A=!1;try{A=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function M(ee,te){return A?new OffscreenCanvas(ee,te):Hv("canvas")}function S(ee,te,Se,ke){let Be=1;if((ee.width>ke||ee.height>ke)&&(Be=ke/Math.max(ee.width,ee.height)),Be<1||te===!0)if(typeof HTMLImageElement!="undefined"&&ee instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&ee instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&ee instanceof ImageBitmap){const We=te?F6:Math.floor,ve=We(Be*ee.width),K=We(Be*ee.height);w===void 0&&(w=M(ve,K));const J=Se?M(ve,K):w;return J.width=ve,J.height=K,J.getContext("2d").drawImage(ee,0,0,ve,K),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ee.width+"x"+ee.height+") to ("+ve+"x"+K+")."),J}else return"data"in ee&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ee.width+"x"+ee.height+")."),ee;return ee}function E(ee){return FS(ee.width)&&FS(ee.height)}function T(ee){return f?!1:ee.wrapS!==Qa||ee.wrapT!==Qa||ee.minFilter!==Xi&&ee.minFilter!==Ra}function C(ee,te){return ee.generateMipmaps&&te&&ee.minFilter!==Xi&&ee.minFilter!==Ra}function L(ee,te,Se,ke,Be=1){i.generateMipmap(ee);const We=a.get(te);We.__maxMipLevel=Math.log2(Math.max(Se,ke,Be))}function P(ee,te,Se,ke){if(f===!1)return te;if(ee!==null){if(i[ee]!==void 0)return i[ee];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ee+"'")}let Be=te;return te===6403&&(Se===5126&&(Be=33326),Se===5131&&(Be=33325),Se===5121&&(Be=33321)),te===6407&&(Se===5126&&(Be=34837),Se===5131&&(Be=34843),Se===5121&&(Be=32849)),te===6408&&(Se===5126&&(Be=34836),Se===5131&&(Be=34842),Se===5121&&(Be=ke===Gc?35907:32856)),(Be===33325||Be===33326||Be===34842||Be===34836)&&n.get("EXT_color_buffer_float"),Be}function N(ee){return ee===Xi||ee===bS||ee===xS?9728:9729}function F(ee){const te=ee.target;te.removeEventListener("dispose",F),Y(te),te.isVideoTexture&&b.delete(te),u.memory.textures--}function X(ee){const te=ee.target;te.removeEventListener("dispose",X),ae(te)}function Y(ee){const te=a.get(ee);te.__webglInit!==void 0&&(i.deleteTexture(te.__webglTexture),a.remove(ee))}function ae(ee){const te=ee.texture,Se=a.get(ee),ke=a.get(te);if(!!ee){if(ke.__webglTexture!==void 0&&(i.deleteTexture(ke.__webglTexture),u.memory.textures--),ee.depthTexture&&ee.depthTexture.dispose(),ee.isWebGLCubeRenderTarget)for(let Be=0;Be<6;Be++)i.deleteFramebuffer(Se.__webglFramebuffer[Be]),Se.__webglDepthbuffer&&i.deleteRenderbuffer(Se.__webglDepthbuffer[Be]);else i.deleteFramebuffer(Se.__webglFramebuffer),Se.__webglDepthbuffer&&i.deleteRenderbuffer(Se.__webglDepthbuffer),Se.__webglMultisampledFramebuffer&&i.deleteFramebuffer(Se.__webglMultisampledFramebuffer),Se.__webglColorRenderbuffer&&i.deleteRenderbuffer(Se.__webglColorRenderbuffer),Se.__webglDepthRenderbuffer&&i.deleteRenderbuffer(Se.__webglDepthRenderbuffer);if(ee.isWebGLMultipleRenderTargets)for(let Be=0,We=te.length;Be<We;Be++){const ve=a.get(te[Be]);ve.__webglTexture&&(i.deleteTexture(ve.__webglTexture),u.memory.textures--),a.remove(te[Be])}a.remove(te),a.remove(ee)}}let $=0;function de(){$=0}function D(){const ee=$;return ee>=v&&console.warn("THREE.WebGLTextures: Trying to use "+ee+" texture units while this GPU supports only "+v),$+=1,ee}function I(ee,te){const Se=a.get(ee);if(ee.isVideoTexture&&fe(ee),ee.version>0&&Se.__version!==ee.version){const ke=ee.image;if(ke===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(ke.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Ne(Se,ee,te);return}}r.activeTexture(33984+te),r.bindTexture(3553,Se.__webglTexture)}function k(ee,te){const Se=a.get(ee);if(ee.version>0&&Se.__version!==ee.version){Ne(Se,ee,te);return}r.activeTexture(33984+te),r.bindTexture(35866,Se.__webglTexture)}function U(ee,te){const Se=a.get(ee);if(ee.version>0&&Se.__version!==ee.version){Ne(Se,ee,te);return}r.activeTexture(33984+te),r.bindTexture(32879,Se.__webglTexture)}function W(ee,te){const Se=a.get(ee);if(ee.version>0&&Se.__version!==ee.version){Ie(Se,ee,te);return}r.activeTexture(33984+te),r.bindTexture(34067,Se.__webglTexture)}const ce={[Xb]:10497,[Qa]:33071,[qb]:33648},oe={[Xi]:9728,[bS]:9984,[xS]:9986,[Ra]:9729,[DN]:9985,[Ov]:9987};function ge(ee,te,Se){if(Se?(i.texParameteri(ee,10242,ce[te.wrapS]),i.texParameteri(ee,10243,ce[te.wrapT]),(ee===32879||ee===35866)&&i.texParameteri(ee,32882,ce[te.wrapR]),i.texParameteri(ee,10240,oe[te.magFilter]),i.texParameteri(ee,10241,oe[te.minFilter])):(i.texParameteri(ee,10242,33071),i.texParameteri(ee,10243,33071),(ee===32879||ee===35866)&&i.texParameteri(ee,32882,33071),(te.wrapS!==Qa||te.wrapT!==Qa)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),i.texParameteri(ee,10240,N(te.magFilter)),i.texParameteri(ee,10241,N(te.minFilter)),te.minFilter!==Xi&&te.minFilter!==Ra&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),n.has("EXT_texture_filter_anisotropic")===!0){const ke=n.get("EXT_texture_filter_anisotropic");if(te.type===Ol&&n.has("OES_texture_float_linear")===!1||f===!1&&te.type===ih&&n.has("OES_texture_half_float_linear")===!1)return;(te.anisotropy>1||a.get(te).__currentAnisotropy)&&(i.texParameterf(ee,ke.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(te.anisotropy,s.getMaxAnisotropy())),a.get(te).__currentAnisotropy=te.anisotropy)}}function _e(ee,te){ee.__webglInit===void 0&&(ee.__webglInit=!0,te.addEventListener("dispose",F),ee.__webglTexture=i.createTexture(),u.memory.textures++)}function Ne(ee,te,Se){let ke=3553;te.isDataTexture2DArray&&(ke=35866),te.isDataTexture3D&&(ke=32879),_e(ee,te),r.activeTexture(33984+Se),r.bindTexture(ke,ee.__webglTexture),i.pixelStorei(37440,te.flipY),i.pixelStorei(37441,te.premultiplyAlpha),i.pixelStorei(3317,te.unpackAlignment),i.pixelStorei(37443,0);const Be=T(te)&&E(te.image)===!1,We=S(te.image,Be,!1,g),ve=E(We)||f,K=o.convert(te.format);let J=o.convert(te.type),Ee=P(te.internalFormat,K,J,te.encoding);ge(ke,te,ve);let xe;const Je=te.mipmaps;if(te.isDepthTexture)Ee=6402,f?te.type===Ol?Ee=36012:te.type===kv?Ee=33190:te.type===xd?Ee=35056:Ee=33189:te.type===Ol&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),te.format===oh&&Ee===6402&&te.type!==Iv&&te.type!==kv&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),te.type=Iv,J=o.convert(te.type)),te.format===wd&&Ee===6402&&(Ee=34041,te.type!==xd&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),te.type=xd,J=o.convert(te.type))),r.texImage2D(3553,0,Ee,We.width,We.height,0,K,J,null);else if(te.isDataTexture)if(Je.length>0&&ve){for(let Xe=0,Mt=Je.length;Xe<Mt;Xe++)xe=Je[Xe],r.texImage2D(3553,Xe,Ee,xe.width,xe.height,0,K,J,xe.data);te.generateMipmaps=!1,ee.__maxMipLevel=Je.length-1}else r.texImage2D(3553,0,Ee,We.width,We.height,0,K,J,We.data),ee.__maxMipLevel=0;else if(te.isCompressedTexture){for(let Xe=0,Mt=Je.length;Xe<Mt;Xe++)xe=Je[Xe],te.format!==ha&&te.format!==ah?K!==null?r.compressedTexImage2D(3553,Xe,Ee,xe.width,xe.height,0,xe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):r.texImage2D(3553,Xe,Ee,xe.width,xe.height,0,K,J,xe.data);ee.__maxMipLevel=Je.length-1}else if(te.isDataTexture2DArray)r.texImage3D(35866,0,Ee,We.width,We.height,We.depth,0,K,J,We.data),ee.__maxMipLevel=0;else if(te.isDataTexture3D)r.texImage3D(32879,0,Ee,We.width,We.height,We.depth,0,K,J,We.data),ee.__maxMipLevel=0;else if(Je.length>0&&ve){for(let Xe=0,Mt=Je.length;Xe<Mt;Xe++)xe=Je[Xe],r.texImage2D(3553,Xe,Ee,K,J,xe);te.generateMipmaps=!1,ee.__maxMipLevel=Je.length-1}else r.texImage2D(3553,0,Ee,K,J,We),ee.__maxMipLevel=0;C(te,ve)&&L(ke,te,We.width,We.height),ee.__version=te.version,te.onUpdate&&te.onUpdate(te)}function Ie(ee,te,Se){if(te.image.length!==6)return;_e(ee,te),r.activeTexture(33984+Se),r.bindTexture(34067,ee.__webglTexture),i.pixelStorei(37440,te.flipY),i.pixelStorei(37441,te.premultiplyAlpha),i.pixelStorei(3317,te.unpackAlignment),i.pixelStorei(37443,0);const ke=te&&(te.isCompressedTexture||te.image[0].isCompressedTexture),Be=te.image[0]&&te.image[0].isDataTexture,We=[];for(let Xe=0;Xe<6;Xe++)!ke&&!Be?We[Xe]=S(te.image[Xe],!1,!0,m):We[Xe]=Be?te.image[Xe].image:te.image[Xe];const ve=We[0],K=E(ve)||f,J=o.convert(te.format),Ee=o.convert(te.type),xe=P(te.internalFormat,J,Ee,te.encoding);ge(34067,te,K);let Je;if(ke){for(let Xe=0;Xe<6;Xe++){Je=We[Xe].mipmaps;for(let Mt=0;Mt<Je.length;Mt++){const qe=Je[Mt];te.format!==ha&&te.format!==ah?J!==null?r.compressedTexImage2D(34069+Xe,Mt,xe,qe.width,qe.height,0,qe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):r.texImage2D(34069+Xe,Mt,xe,qe.width,qe.height,0,J,Ee,qe.data)}}ee.__maxMipLevel=Je.length-1}else{Je=te.mipmaps;for(let Xe=0;Xe<6;Xe++)if(Be){r.texImage2D(34069+Xe,0,xe,We[Xe].width,We[Xe].height,0,J,Ee,We[Xe].data);for(let Mt=0;Mt<Je.length;Mt++){const It=Je[Mt].image[Xe].image;r.texImage2D(34069+Xe,Mt+1,xe,It.width,It.height,0,J,Ee,It.data)}}else{r.texImage2D(34069+Xe,0,xe,J,Ee,We[Xe]);for(let Mt=0;Mt<Je.length;Mt++){const qe=Je[Mt];r.texImage2D(34069+Xe,Mt+1,xe,J,Ee,qe.image[Xe])}}ee.__maxMipLevel=Je.length}C(te,K)&&L(34067,te,ve.width,ve.height),ee.__version=te.version,te.onUpdate&&te.onUpdate(te)}function Ve(ee,te,Se,ke,Be){const We=o.convert(Se.format),ve=o.convert(Se.type),K=P(Se.internalFormat,We,ve,Se.encoding);Be===32879||Be===35866?r.texImage3D(Be,0,K,te.width,te.height,te.depth,0,We,ve,null):r.texImage2D(Be,0,K,te.width,te.height,0,We,ve,null),r.bindFramebuffer(36160,ee),i.framebufferTexture2D(36160,ke,Be,a.get(Se).__webglTexture,0),r.bindFramebuffer(36160,null)}function Le(ee,te,Se){if(i.bindRenderbuffer(36161,ee),te.depthBuffer&&!te.stencilBuffer){let ke=33189;if(Se){const Be=te.depthTexture;Be&&Be.isDepthTexture&&(Be.type===Ol?ke=36012:Be.type===kv&&(ke=33190));const We=ye(te);i.renderbufferStorageMultisample(36161,We,ke,te.width,te.height)}else i.renderbufferStorage(36161,ke,te.width,te.height);i.framebufferRenderbuffer(36160,36096,36161,ee)}else if(te.depthBuffer&&te.stencilBuffer){if(Se){const ke=ye(te);i.renderbufferStorageMultisample(36161,ke,35056,te.width,te.height)}else i.renderbufferStorage(36161,34041,te.width,te.height);i.framebufferRenderbuffer(36160,33306,36161,ee)}else{const ke=te.isWebGLMultipleRenderTargets===!0?te.texture[0]:te.texture,Be=o.convert(ke.format),We=o.convert(ke.type),ve=P(ke.internalFormat,Be,We,ke.encoding);if(Se){const K=ye(te);i.renderbufferStorageMultisample(36161,K,ve,te.width,te.height)}else i.renderbufferStorage(36161,ve,te.width,te.height)}i.bindRenderbuffer(36161,null)}function Fe(ee,te){if(te&&te.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(r.bindFramebuffer(36160,ee),!(te.depthTexture&&te.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!a.get(te.depthTexture).__webglTexture||te.depthTexture.image.width!==te.width||te.depthTexture.image.height!==te.height)&&(te.depthTexture.image.width=te.width,te.depthTexture.image.height=te.height,te.depthTexture.needsUpdate=!0),I(te.depthTexture,0);const ke=a.get(te.depthTexture).__webglTexture;if(te.depthTexture.format===oh)i.framebufferTexture2D(36160,36096,3553,ke,0);else if(te.depthTexture.format===wd)i.framebufferTexture2D(36160,33306,3553,ke,0);else throw new Error("Unknown depthTexture format")}function Me(ee){const te=a.get(ee),Se=ee.isWebGLCubeRenderTarget===!0;if(ee.depthTexture){if(Se)throw new Error("target.depthTexture not supported in Cube render targets");Fe(te.__webglFramebuffer,ee)}else if(Se){te.__webglDepthbuffer=[];for(let ke=0;ke<6;ke++)r.bindFramebuffer(36160,te.__webglFramebuffer[ke]),te.__webglDepthbuffer[ke]=i.createRenderbuffer(),Le(te.__webglDepthbuffer[ke],ee,!1)}else r.bindFramebuffer(36160,te.__webglFramebuffer),te.__webglDepthbuffer=i.createRenderbuffer(),Le(te.__webglDepthbuffer,ee,!1);r.bindFramebuffer(36160,null)}function Qe(ee){const te=ee.texture,Se=a.get(ee),ke=a.get(te);ee.addEventListener("dispose",X),ee.isWebGLMultipleRenderTargets!==!0&&(ke.__webglTexture=i.createTexture(),ke.__version=te.version,u.memory.textures++);const Be=ee.isWebGLCubeRenderTarget===!0,We=ee.isWebGLMultipleRenderTargets===!0,ve=ee.isWebGLMultisampleRenderTarget===!0,K=te.isDataTexture3D||te.isDataTexture2DArray,J=E(ee)||f;if(f&&te.format===ah&&(te.type===Ol||te.type===ih)&&(te.format=ha,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),Be){Se.__webglFramebuffer=[];for(let Ee=0;Ee<6;Ee++)Se.__webglFramebuffer[Ee]=i.createFramebuffer()}else if(Se.__webglFramebuffer=i.createFramebuffer(),We)if(s.drawBuffers){const Ee=ee.texture;for(let xe=0,Je=Ee.length;xe<Je;xe++){const Xe=a.get(Ee[xe]);Xe.__webglTexture===void 0&&(Xe.__webglTexture=i.createTexture(),u.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(ve)if(f){Se.__webglMultisampledFramebuffer=i.createFramebuffer(),Se.__webglColorRenderbuffer=i.createRenderbuffer(),i.bindRenderbuffer(36161,Se.__webglColorRenderbuffer);const Ee=o.convert(te.format),xe=o.convert(te.type),Je=P(te.internalFormat,Ee,xe,te.encoding),Xe=ye(ee);i.renderbufferStorageMultisample(36161,Xe,Je,ee.width,ee.height),r.bindFramebuffer(36160,Se.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(36160,36064,36161,Se.__webglColorRenderbuffer),i.bindRenderbuffer(36161,null),ee.depthBuffer&&(Se.__webglDepthRenderbuffer=i.createRenderbuffer(),Le(Se.__webglDepthRenderbuffer,ee,!0)),r.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(Be){r.bindTexture(34067,ke.__webglTexture),ge(34067,te,J);for(let Ee=0;Ee<6;Ee++)Ve(Se.__webglFramebuffer[Ee],ee,te,36064,34069+Ee);C(te,J)&&L(34067,te,ee.width,ee.height),r.unbindTexture()}else if(We){const Ee=ee.texture;for(let xe=0,Je=Ee.length;xe<Je;xe++){const Xe=Ee[xe],Mt=a.get(Xe);r.bindTexture(3553,Mt.__webglTexture),ge(3553,Xe,J),Ve(Se.__webglFramebuffer,ee,Xe,36064+xe,3553),C(Xe,J)&&L(3553,Xe,ee.width,ee.height)}r.unbindTexture()}else{let Ee=3553;K&&(f?Ee=te.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),r.bindTexture(Ee,ke.__webglTexture),ge(Ee,te,J),Ve(Se.__webglFramebuffer,ee,te,36064,Ee),C(te,J)&&L(Ee,te,ee.width,ee.height,ee.depth),r.unbindTexture()}ee.depthBuffer&&Me(ee)}function mt(ee){const te=E(ee)||f,Se=ee.isWebGLMultipleRenderTargets===!0?ee.texture:[ee.texture];for(let ke=0,Be=Se.length;ke<Be;ke++){const We=Se[ke];if(C(We,te)){const ve=ee.isWebGLCubeRenderTarget?34067:3553,K=a.get(We).__webglTexture;r.bindTexture(ve,K),L(ve,We,ee.width,ee.height),r.unbindTexture()}}}function ht(ee){if(ee.isWebGLMultisampleRenderTarget)if(f){const te=ee.width,Se=ee.height;let ke=16384;ee.depthBuffer&&(ke|=256),ee.stencilBuffer&&(ke|=1024);const Be=a.get(ee);r.bindFramebuffer(36008,Be.__webglMultisampledFramebuffer),r.bindFramebuffer(36009,Be.__webglFramebuffer),i.blitFramebuffer(0,0,te,Se,0,0,te,Se,ke,9728),r.bindFramebuffer(36008,null),r.bindFramebuffer(36009,Be.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}function ye(ee){return f&&ee.isWebGLMultisampleRenderTarget?Math.min(y,ee.samples):0}function fe(ee){const te=u.render.frame;b.get(ee)!==te&&(b.set(ee,te),ee.update())}let H=!1,j=!1;function q(ee,te){ee&&ee.isWebGLRenderTarget&&(H===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),H=!0),ee=ee.texture),I(ee,te)}function pe(ee,te){ee&&ee.isWebGLCubeRenderTarget&&(j===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),j=!0),ee=ee.texture),W(ee,te)}this.allocateTextureUnit=D,this.resetTextureUnits=de,this.setTexture2D=I,this.setTexture2DArray=k,this.setTexture3D=U,this.setTextureCube=W,this.setupRenderTarget=Qe,this.updateRenderTargetMipmap=mt,this.updateMultisampleRenderTarget=ht,this.safeSetTexture2D=q,this.safeSetTextureCube=pe}function hG(i,n,r){const a=r.isWebGL2;function s(o){let u;if(o===Dl)return 5121;if(o===FN)return 32819;if(o===BN)return 32820;if(o===NN)return 33635;if(o===ON)return 5120;if(o===IN)return 5122;if(o===Iv)return 5123;if(o===kN)return 5124;if(o===kv)return 5125;if(o===Ol)return 5126;if(o===ih)return a?5131:(u=n.get("OES_texture_half_float"),u!==null?u.HALF_FLOAT_OES:null);if(o===UN)return 6406;if(o===ah)return 6407;if(o===ha)return 6408;if(o===HN)return 6409;if(o===zN)return 6410;if(o===oh)return 6402;if(o===wd)return 34041;if(o===VN)return 6403;if(o===WN)return 36244;if(o===jN)return 33319;if(o===XN)return 33320;if(o===qN)return 36248;if(o===YN)return 36249;if(o===wS||o===AS||o===ES||o===_S)if(u=n.get("WEBGL_compressed_texture_s3tc"),u!==null){if(o===wS)return u.COMPRESSED_RGB_S3TC_DXT1_EXT;if(o===AS)return u.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(o===ES)return u.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(o===_S)return u.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(o===MS||o===SS||o===TS||o===CS)if(u=n.get("WEBGL_compressed_texture_pvrtc"),u!==null){if(o===MS)return u.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(o===SS)return u.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(o===TS)return u.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(o===CS)return u.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(o===$N)return u=n.get("WEBGL_compressed_texture_etc1"),u!==null?u.COMPRESSED_RGB_ETC1_WEBGL:null;if((o===RS||o===LS)&&(u=n.get("WEBGL_compressed_texture_etc"),u!==null)){if(o===RS)return u.COMPRESSED_RGB8_ETC2;if(o===LS)return u.COMPRESSED_RGBA8_ETC2_EAC}if(o===KN||o===ZN||o===QN||o===JN||o===e6||o===t6||o===n6||o===r6||o===i6||o===a6||o===o6||o===s6||o===l6||o===c6||o===h6||o===f6||o===d6||o===p6||o===m6||o===v6||o===g6||o===y6||o===b6||o===x6||o===w6||o===A6||o===E6||o===_6)return u=n.get("WEBGL_compressed_texture_astc"),u!==null?o:null;if(o===u6)return u=n.get("EXT_texture_compression_bptc"),u!==null?o:null;if(o===xd)return a?34042:(u=n.get("WEBGL_depth_texture"),u!==null?u.UNSIGNED_INT_24_8_WEBGL:null)}return{convert:s}}class UT extends La{constructor(n=[]){super();this.cameras=n}}UT.prototype.isArrayCamera=!0;class Yc extends ei{constructor(){super();this.type="Group"}}Yc.prototype.isGroup=!0;const fG={type:"move"};class kx{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Yc,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Yc,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Ze,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Ze),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Yc,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Ze,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Ze),this._grip}dispatchEvent(n){return this._targetRay!==null&&this._targetRay.dispatchEvent(n),this._grip!==null&&this._grip.dispatchEvent(n),this._hand!==null&&this._hand.dispatchEvent(n),this}disconnect(n){return this.dispatchEvent({type:"disconnected",data:n}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(n,r,a){let s=null,o=null,u=null;const f=this._targetRay,v=this._grip,m=this._hand;if(n&&r.session.visibilityState!=="visible-blurred")if(f!==null&&(s=r.getPose(n.targetRaySpace,a),s!==null&&(f.matrix.fromArray(s.transform.matrix),f.matrix.decompose(f.position,f.rotation,f.scale),s.linearVelocity?(f.hasLinearVelocity=!0,f.linearVelocity.copy(s.linearVelocity)):f.hasLinearVelocity=!1,s.angularVelocity?(f.hasAngularVelocity=!0,f.angularVelocity.copy(s.angularVelocity)):f.hasAngularVelocity=!1,this.dispatchEvent(fG))),m&&n.hand){u=!0;for(const M of n.hand.values()){const S=r.getJointPose(M,a);if(m.joints[M.jointName]===void 0){const T=new Yc;T.matrixAutoUpdate=!1,T.visible=!1,m.joints[M.jointName]=T,m.add(T)}const E=m.joints[M.jointName];S!==null&&(E.matrix.fromArray(S.transform.matrix),E.matrix.decompose(E.position,E.rotation,E.scale),E.jointRadius=S.radius),E.visible=S!==null}const g=m.joints["index-finger-tip"],y=m.joints["thumb-tip"],b=g.position.distanceTo(y.position),w=.02,A=.005;m.inputState.pinching&&b>w+A?(m.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:n.handedness,target:this})):!m.inputState.pinching&&b<=w-A&&(m.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:n.handedness,target:this}))}else v!==null&&n.gripSpace&&(o=r.getPose(n.gripSpace,a),o!==null&&(v.matrix.fromArray(o.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),o.linearVelocity?(v.hasLinearVelocity=!0,v.linearVelocity.copy(o.linearVelocity)):v.hasLinearVelocity=!1,o.angularVelocity?(v.hasAngularVelocity=!0,v.angularVelocity.copy(o.angularVelocity)):v.hasAngularVelocity=!1));return f!==null&&(f.visible=s!==null),v!==null&&(v.visible=o!==null),m!==null&&(m.visible=u!==null),this}}class dG extends uo{constructor(n,r){super();const a=this,s=n.state;let o=null,u=1,f=null,v="local-floor",m=null,g=null,y=null,b=null,w=null,A=!1,M=null,S=null,E=null,T=null,C=null,L=null;const P=[],N=new Map,F=new La;F.layers.enable(1),F.viewport=new ci;const X=new La;X.layers.enable(2),X.viewport=new ci;const Y=[F,X],ae=new UT;ae.layers.enable(1),ae.layers.enable(2);let $=null,de=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Ie){let Ve=P[Ie];return Ve===void 0&&(Ve=new kx,P[Ie]=Ve),Ve.getTargetRaySpace()},this.getControllerGrip=function(Ie){let Ve=P[Ie];return Ve===void 0&&(Ve=new kx,P[Ie]=Ve),Ve.getGripSpace()},this.getHand=function(Ie){let Ve=P[Ie];return Ve===void 0&&(Ve=new kx,P[Ie]=Ve),Ve.getHandSpace()};function D(Ie){const Ve=N.get(Ie.inputSource);Ve&&Ve.dispatchEvent({type:Ie.type,data:Ie.inputSource})}function I(){N.forEach(function(Ie,Ve){Ie.disconnect(Ve)}),N.clear(),$=null,de=null,s.bindXRFramebuffer(null),n.setRenderTarget(n.getRenderTarget()),y&&r.deleteFramebuffer(y),M&&r.deleteFramebuffer(M),S&&r.deleteRenderbuffer(S),E&&r.deleteRenderbuffer(E),y=null,M=null,S=null,E=null,w=null,b=null,g=null,o=null,Ne.stop(),a.isPresenting=!1,a.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Ie){u=Ie,a.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Ie){v=Ie,a.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return f},this.getBaseLayer=function(){return b!==null?b:w},this.getBinding=function(){return g},this.getFrame=function(){return T},this.getSession=function(){return o},this.setSession=async function(Ie){if(o=Ie,o!==null){o.addEventListener("select",D),o.addEventListener("selectstart",D),o.addEventListener("selectend",D),o.addEventListener("squeeze",D),o.addEventListener("squeezestart",D),o.addEventListener("squeezeend",D),o.addEventListener("end",I),o.addEventListener("inputsourceschange",k);const Ve=r.getContextAttributes();if(Ve.xrCompatible!==!0&&await r.makeXRCompatible(),o.renderState.layers===void 0){const Le={antialias:Ve.antialias,alpha:Ve.alpha,depth:Ve.depth,stencil:Ve.stencil,framebufferScaleFactor:u};w=new XRWebGLLayer(o,r,Le),o.updateRenderState({baseLayer:w})}else if(r instanceof WebGLRenderingContext){const Le={antialias:!0,alpha:Ve.alpha,depth:Ve.depth,stencil:Ve.stencil,framebufferScaleFactor:u};w=new XRWebGLLayer(o,r,Le),o.updateRenderState({layers:[w]})}else{A=Ve.antialias;let Le=null;Ve.depth&&(L=256,Ve.stencil&&(L|=1024),C=Ve.stencil?33306:36096,Le=Ve.stencil?35056:33190);const Fe={colorFormat:Ve.alpha?32856:32849,depthFormat:Le,scaleFactor:u};g=new XRWebGLBinding(o,r),b=g.createProjectionLayer(Fe),y=r.createFramebuffer(),o.updateRenderState({layers:[b]}),A&&(M=r.createFramebuffer(),S=r.createRenderbuffer(),r.bindRenderbuffer(36161,S),r.renderbufferStorageMultisample(36161,4,32856,b.textureWidth,b.textureHeight),s.bindFramebuffer(36160,M),r.framebufferRenderbuffer(36160,36064,36161,S),r.bindRenderbuffer(36161,null),Le!==null&&(E=r.createRenderbuffer(),r.bindRenderbuffer(36161,E),r.renderbufferStorageMultisample(36161,4,Le,b.textureWidth,b.textureHeight),r.framebufferRenderbuffer(36160,C,36161,E),r.bindRenderbuffer(36161,null)),s.bindFramebuffer(36160,null))}f=await o.requestReferenceSpace(v),Ne.setContext(o),Ne.start(),a.isPresenting=!0,a.dispatchEvent({type:"sessionstart"})}};function k(Ie){const Ve=o.inputSources;for(let Le=0;Le<P.length;Le++)N.set(Ve[Le],P[Le]);for(let Le=0;Le<Ie.removed.length;Le++){const Fe=Ie.removed[Le],Me=N.get(Fe);Me&&(Me.dispatchEvent({type:"disconnected",data:Fe}),N.delete(Fe))}for(let Le=0;Le<Ie.added.length;Le++){const Fe=Ie.added[Le],Me=N.get(Fe);Me&&Me.dispatchEvent({type:"connected",data:Fe})}}const U=new Ze,W=new Ze;function ce(Ie,Ve,Le){U.setFromMatrixPosition(Ve.matrixWorld),W.setFromMatrixPosition(Le.matrixWorld);const Fe=U.distanceTo(W),Me=Ve.projectionMatrix.elements,Qe=Le.projectionMatrix.elements,mt=Me[14]/(Me[10]-1),ht=Me[14]/(Me[10]+1),ye=(Me[9]+1)/Me[5],fe=(Me[9]-1)/Me[5],H=(Me[8]-1)/Me[0],j=(Qe[8]+1)/Qe[0],q=mt*H,pe=mt*j,ee=Fe/(-H+j),te=ee*-H;Ve.matrixWorld.decompose(Ie.position,Ie.quaternion,Ie.scale),Ie.translateX(te),Ie.translateZ(ee),Ie.matrixWorld.compose(Ie.position,Ie.quaternion,Ie.scale),Ie.matrixWorldInverse.copy(Ie.matrixWorld).invert();const Se=mt+ee,ke=ht+ee,Be=q-te,We=pe+(Fe-te),ve=ye*ht/ke*Se,K=fe*ht/ke*Se;Ie.projectionMatrix.makePerspective(Be,We,ve,K,Se,ke)}function oe(Ie,Ve){Ve===null?Ie.matrixWorld.copy(Ie.matrix):Ie.matrixWorld.multiplyMatrices(Ve.matrixWorld,Ie.matrix),Ie.matrixWorldInverse.copy(Ie.matrixWorld).invert()}this.updateCamera=function(Ie){if(o===null)return;ae.near=X.near=F.near=Ie.near,ae.far=X.far=F.far=Ie.far,($!==ae.near||de!==ae.far)&&(o.updateRenderState({depthNear:ae.near,depthFar:ae.far}),$=ae.near,de=ae.far);const Ve=Ie.parent,Le=ae.cameras;oe(ae,Ve);for(let Me=0;Me<Le.length;Me++)oe(Le[Me],Ve);ae.matrixWorld.decompose(ae.position,ae.quaternion,ae.scale),Ie.position.copy(ae.position),Ie.quaternion.copy(ae.quaternion),Ie.scale.copy(ae.scale),Ie.matrix.copy(ae.matrix),Ie.matrixWorld.copy(ae.matrixWorld);const Fe=Ie.children;for(let Me=0,Qe=Fe.length;Me<Qe;Me++)Fe[Me].updateMatrixWorld(!0);Le.length===2?ce(ae,F,X):ae.projectionMatrix.copy(F.projectionMatrix)},this.getCamera=function(){return ae},this.getFoveation=function(){if(b!==null)return b.fixedFoveation;if(w!==null)return w.fixedFoveation},this.setFoveation=function(Ie){b!==null&&(b.fixedFoveation=Ie),w!==null&&w.fixedFoveation!==void 0&&(w.fixedFoveation=Ie)};let ge=null;function _e(Ie,Ve){if(m=Ve.getViewerPose(f),T=Ve,m!==null){const Fe=m.views;w!==null&&s.bindXRFramebuffer(w.framebuffer);let Me=!1;Fe.length!==ae.cameras.length&&(ae.cameras.length=0,Me=!0);for(let Qe=0;Qe<Fe.length;Qe++){const mt=Fe[Qe];let ht=null;if(w!==null)ht=w.getViewport(mt);else{const fe=g.getViewSubImage(b,mt);s.bindXRFramebuffer(y),fe.depthStencilTexture!==void 0&&r.framebufferTexture2D(36160,C,3553,fe.depthStencilTexture,0),r.framebufferTexture2D(36160,36064,3553,fe.colorTexture,0),ht=fe.viewport}const ye=Y[Qe];ye.matrix.fromArray(mt.transform.matrix),ye.projectionMatrix.fromArray(mt.projectionMatrix),ye.viewport.set(ht.x,ht.y,ht.width,ht.height),Qe===0&&ae.matrix.copy(ye.matrix),Me===!0&&ae.cameras.push(ye)}A&&(s.bindXRFramebuffer(M),L!==null&&r.clear(L))}const Le=o.inputSources;for(let Fe=0;Fe<P.length;Fe++){const Me=P[Fe],Qe=Le[Fe];Me.update(Qe,Ve,f)}if(ge&&ge(Ie,Ve),A){const Fe=b.textureWidth,Me=b.textureHeight;s.bindFramebuffer(36008,M),s.bindFramebuffer(36009,y),r.invalidateFramebuffer(36008,[C]),r.invalidateFramebuffer(36009,[C]),r.blitFramebuffer(0,0,Fe,Me,0,0,Fe,Me,16384,9728),r.invalidateFramebuffer(36008,[36064]),s.bindFramebuffer(36008,null),s.bindFramebuffer(36009,null),s.bindFramebuffer(36160,M)}T=null}const Ne=new rT;Ne.setAnimationLoop(_e),this.setAnimationLoop=function(Ie){ge=Ie},this.dispose=function(){}}}function pG(i){function n(E,T){E.fogColor.value.copy(T.color),T.isFog?(E.fogNear.value=T.near,E.fogFar.value=T.far):T.isFogExp2&&(E.fogDensity.value=T.density)}function r(E,T,C,L,P){T.isMeshBasicMaterial?a(E,T):T.isMeshLambertMaterial?(a(E,T),v(E,T)):T.isMeshToonMaterial?(a(E,T),g(E,T)):T.isMeshPhongMaterial?(a(E,T),m(E,T)):T.isMeshStandardMaterial?(a(E,T),T.isMeshPhysicalMaterial?b(E,T,P):y(E,T)):T.isMeshMatcapMaterial?(a(E,T),w(E,T)):T.isMeshDepthMaterial?(a(E,T),A(E,T)):T.isMeshDistanceMaterial?(a(E,T),M(E,T)):T.isMeshNormalMaterial?(a(E,T),S(E,T)):T.isLineBasicMaterial?(s(E,T),T.isLineDashedMaterial&&o(E,T)):T.isPointsMaterial?u(E,T,C,L):T.isSpriteMaterial?f(E,T):T.isShadowMaterial?(E.color.value.copy(T.color),E.opacity.value=T.opacity):T.isShaderMaterial&&(T.uniformsNeedUpdate=!1)}function a(E,T){E.opacity.value=T.opacity,T.color&&E.diffuse.value.copy(T.color),T.emissive&&E.emissive.value.copy(T.emissive).multiplyScalar(T.emissiveIntensity),T.map&&(E.map.value=T.map),T.alphaMap&&(E.alphaMap.value=T.alphaMap),T.specularMap&&(E.specularMap.value=T.specularMap),T.alphaTest>0&&(E.alphaTest.value=T.alphaTest);const C=i.get(T).envMap;if(C){E.envMap.value=C,E.flipEnvMap.value=C.isCubeTexture&&C.isRenderTargetTexture===!1?-1:1,E.reflectivity.value=T.reflectivity,E.ior.value=T.ior,E.refractionRatio.value=T.refractionRatio;const N=i.get(C).__maxMipLevel;N!==void 0&&(E.maxMipLevel.value=N)}T.lightMap&&(E.lightMap.value=T.lightMap,E.lightMapIntensity.value=T.lightMapIntensity),T.aoMap&&(E.aoMap.value=T.aoMap,E.aoMapIntensity.value=T.aoMapIntensity);let L;T.map?L=T.map:T.specularMap?L=T.specularMap:T.displacementMap?L=T.displacementMap:T.normalMap?L=T.normalMap:T.bumpMap?L=T.bumpMap:T.roughnessMap?L=T.roughnessMap:T.metalnessMap?L=T.metalnessMap:T.alphaMap?L=T.alphaMap:T.emissiveMap?L=T.emissiveMap:T.clearcoatMap?L=T.clearcoatMap:T.clearcoatNormalMap?L=T.clearcoatNormalMap:T.clearcoatRoughnessMap?L=T.clearcoatRoughnessMap:T.specularIntensityMap?L=T.specularIntensityMap:T.specularColorMap?L=T.specularColorMap:T.transmissionMap?L=T.transmissionMap:T.thicknessMap?L=T.thicknessMap:T.sheenColorMap?L=T.sheenColorMap:T.sheenRoughnessMap&&(L=T.sheenRoughnessMap),L!==void 0&&(L.isWebGLRenderTarget&&(L=L.texture),L.matrixAutoUpdate===!0&&L.updateMatrix(),E.uvTransform.value.copy(L.matrix));let P;T.aoMap?P=T.aoMap:T.lightMap&&(P=T.lightMap),P!==void 0&&(P.isWebGLRenderTarget&&(P=P.texture),P.matrixAutoUpdate===!0&&P.updateMatrix(),E.uv2Transform.value.copy(P.matrix))}function s(E,T){E.diffuse.value.copy(T.color),E.opacity.value=T.opacity}function o(E,T){E.dashSize.value=T.dashSize,E.totalSize.value=T.dashSize+T.gapSize,E.scale.value=T.scale}function u(E,T,C,L){E.diffuse.value.copy(T.color),E.opacity.value=T.opacity,E.size.value=T.size*C,E.scale.value=L*.5,T.map&&(E.map.value=T.map),T.alphaMap&&(E.alphaMap.value=T.alphaMap),T.alphaTest>0&&(E.alphaTest.value=T.alphaTest);let P;T.map?P=T.map:T.alphaMap&&(P=T.alphaMap),P!==void 0&&(P.matrixAutoUpdate===!0&&P.updateMatrix(),E.uvTransform.value.copy(P.matrix))}function f(E,T){E.diffuse.value.copy(T.color),E.opacity.value=T.opacity,E.rotation.value=T.rotation,T.map&&(E.map.value=T.map),T.alphaMap&&(E.alphaMap.value=T.alphaMap),T.alphaTest>0&&(E.alphaTest.value=T.alphaTest);let C;T.map?C=T.map:T.alphaMap&&(C=T.alphaMap),C!==void 0&&(C.matrixAutoUpdate===!0&&C.updateMatrix(),E.uvTransform.value.copy(C.matrix))}function v(E,T){T.emissiveMap&&(E.emissiveMap.value=T.emissiveMap)}function m(E,T){E.specular.value.copy(T.specular),E.shininess.value=Math.max(T.shininess,1e-4),T.emissiveMap&&(E.emissiveMap.value=T.emissiveMap),T.bumpMap&&(E.bumpMap.value=T.bumpMap,E.bumpScale.value=T.bumpScale,T.side===Ni&&(E.bumpScale.value*=-1)),T.normalMap&&(E.normalMap.value=T.normalMap,E.normalScale.value.copy(T.normalScale),T.side===Ni&&E.normalScale.value.negate()),T.displacementMap&&(E.displacementMap.value=T.displacementMap,E.displacementScale.value=T.displacementScale,E.displacementBias.value=T.displacementBias)}function g(E,T){T.gradientMap&&(E.gradientMap.value=T.gradientMap),T.emissiveMap&&(E.emissiveMap.value=T.emissiveMap),T.bumpMap&&(E.bumpMap.value=T.bumpMap,E.bumpScale.value=T.bumpScale,T.side===Ni&&(E.bumpScale.value*=-1)),T.normalMap&&(E.normalMap.value=T.normalMap,E.normalScale.value.copy(T.normalScale),T.side===Ni&&E.normalScale.value.negate()),T.displacementMap&&(E.displacementMap.value=T.displacementMap,E.displacementScale.value=T.displacementScale,E.displacementBias.value=T.displacementBias)}function y(E,T){E.roughness.value=T.roughness,E.metalness.value=T.metalness,T.roughnessMap&&(E.roughnessMap.value=T.roughnessMap),T.metalnessMap&&(E.metalnessMap.value=T.metalnessMap),T.emissiveMap&&(E.emissiveMap.value=T.emissiveMap),T.bumpMap&&(E.bumpMap.value=T.bumpMap,E.bumpScale.value=T.bumpScale,T.side===Ni&&(E.bumpScale.value*=-1)),T.normalMap&&(E.normalMap.value=T.normalMap,E.normalScale.value.copy(T.normalScale),T.side===Ni&&E.normalScale.value.negate()),T.displacementMap&&(E.displacementMap.value=T.displacementMap,E.displacementScale.value=T.displacementScale,E.displacementBias.value=T.displacementBias),i.get(T).envMap&&(E.envMapIntensity.value=T.envMapIntensity)}function b(E,T,C){y(E,T),E.ior.value=T.ior,T.sheen>0&&(E.sheenColor.value.copy(T.sheenColor).multiplyScalar(T.sheen),E.sheenRoughness.value=T.sheenRoughness,T.sheenColorMap&&(E.sheenColorMap.value=T.sheenColorMap),T.sheenRoughnessMap&&(E.sheenRoughnessMap.value=T.sheenRoughnessMap)),T.clearcoat>0&&(E.clearcoat.value=T.clearcoat,E.clearcoatRoughness.value=T.clearcoatRoughness,T.clearcoatMap&&(E.clearcoatMap.value=T.clearcoatMap),T.clearcoatRoughnessMap&&(E.clearcoatRoughnessMap.value=T.clearcoatRoughnessMap),T.clearcoatNormalMap&&(E.clearcoatNormalScale.value.copy(T.clearcoatNormalScale),E.clearcoatNormalMap.value=T.clearcoatNormalMap,T.side===Ni&&E.clearcoatNormalScale.value.negate())),T.transmission>0&&(E.transmission.value=T.transmission,E.transmissionSamplerMap.value=C.texture,E.transmissionSamplerSize.value.set(C.width,C.height),T.transmissionMap&&(E.transmissionMap.value=T.transmissionMap),E.thickness.value=T.thickness,T.thicknessMap&&(E.thicknessMap.value=T.thicknessMap),E.attenuationDistance.value=T.attenuationDistance,E.attenuationColor.value.copy(T.attenuationColor)),E.specularIntensity.value=T.specularIntensity,E.specularColor.value.copy(T.specularColor),T.specularIntensityMap&&(E.specularIntensityMap.value=T.specularIntensityMap),T.specularColorMap&&(E.specularColorMap.value=T.specularColorMap)}function w(E,T){T.matcap&&(E.matcap.value=T.matcap),T.bumpMap&&(E.bumpMap.value=T.bumpMap,E.bumpScale.value=T.bumpScale,T.side===Ni&&(E.bumpScale.value*=-1)),T.normalMap&&(E.normalMap.value=T.normalMap,E.normalScale.value.copy(T.normalScale),T.side===Ni&&E.normalScale.value.negate()),T.displacementMap&&(E.displacementMap.value=T.displacementMap,E.displacementScale.value=T.displacementScale,E.displacementBias.value=T.displacementBias)}function A(E,T){T.displacementMap&&(E.displacementMap.value=T.displacementMap,E.displacementScale.value=T.displacementScale,E.displacementBias.value=T.displacementBias)}function M(E,T){T.displacementMap&&(E.displacementMap.value=T.displacementMap,E.displacementScale.value=T.displacementScale,E.displacementBias.value=T.displacementBias),E.referencePosition.value.copy(T.referencePosition),E.nearDistance.value=T.nearDistance,E.farDistance.value=T.farDistance}function S(E,T){T.bumpMap&&(E.bumpMap.value=T.bumpMap,E.bumpScale.value=T.bumpScale,T.side===Ni&&(E.bumpScale.value*=-1)),T.normalMap&&(E.normalMap.value=T.normalMap,E.normalScale.value.copy(T.normalScale),T.side===Ni&&E.normalScale.value.negate()),T.displacementMap&&(E.displacementMap.value=T.displacementMap,E.displacementScale.value=T.displacementScale,E.displacementBias.value=T.displacementBias)}return{refreshFogUniforms:n,refreshMaterialUniforms:r}}function mG(){const i=Hv("canvas");return i.style.display="block",i}function ti(i={}){const n=i.canvas!==void 0?i.canvas:mG(),r=i.context!==void 0?i.context:null,a=i.alpha!==void 0?i.alpha:!1,s=i.depth!==void 0?i.depth:!0,o=i.stencil!==void 0?i.stencil:!0,u=i.antialias!==void 0?i.antialias:!1,f=i.premultipliedAlpha!==void 0?i.premultipliedAlpha:!0,v=i.preserveDrawingBuffer!==void 0?i.preserveDrawingBuffer:!1,m=i.powerPreference!==void 0?i.powerPreference:"default",g=i.failIfMajorPerformanceCaveat!==void 0?i.failIfMajorPerformanceCaveat:!1;let y=null,b=null;const w=[],A=[];this.domElement=n,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=fa,this.physicallyCorrectLights=!1,this.toneMapping=zc,this.toneMappingExposure=1;const M=this;let S=!1,E=0,T=0,C=null,L=-1,P=null;const N=new ci,F=new ci;let X=null,Y=n.width,ae=n.height,$=1,de=null,D=null;const I=new ci(0,0,Y,ae),k=new ci(0,0,Y,ae);let U=!1;const W=[],ce=new og;let oe=!1,ge=!1,_e=null;const Ne=new jn,Ie=new Ze,Ve={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Le(){return C===null?$:1}let Fe=r;function Me(je,_t){for(let Ot=0;Ot<je.length;Ot++){const At=je[Ot],Gt=n.getContext(At,_t);if(Gt!==null)return Gt}return null}try{const je={alpha:a,depth:s,stencil:o,antialias:u,premultipliedAlpha:f,preserveDrawingBuffer:v,powerPreference:m,failIfMajorPerformanceCaveat:g};if(n.addEventListener("webglcontextlost",rn,!1),n.addEventListener("webglcontextrestored",Yt,!1),Fe===null){const _t=["webgl2","webgl","experimental-webgl"];if(M.isWebGL1Renderer===!0&&_t.shift(),Fe=Me(_t,je),Fe===null)throw Me(_t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}Fe.getShaderPrecisionFormat===void 0&&(Fe.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(je){throw console.error("THREE.WebGLRenderer: "+je.message),je}let Qe,mt,ht,ye,fe,H,j,q,pe,ee,te,Se,ke,Be,We,ve,K,J,Ee,xe,Je,Xe,Mt;function qe(){Qe=new N8(Fe),mt=new L8(Fe,Qe,i),Qe.init(mt),Xe=new hG(Fe,Qe,mt),ht=new cG(Fe,Qe,mt),W[0]=1029,ye=new z8(Fe),fe=new Qz,H=new uG(Fe,Qe,ht,fe,mt,Xe,ye),j=new D8(M),q=new B8(M),pe=new eU(Fe,mt),Mt=new C8(Fe,Qe,pe,mt),ee=new U8(Fe,pe,ye,Mt),te=new j8(Fe,ee,pe,ye),Ee=new W8(Fe,mt,H),ve=new P8(fe),Se=new Zz(M,j,q,Qe,mt,Mt,ve),ke=new pG(fe),Be=new eG(fe),We=new oG(Qe,mt),J=new T8(M,j,ht,te,f),K=new NT(M,te,mt),xe=new R8(Fe,Qe,ye,mt),Je=new H8(Fe,Qe,ye,mt),ye.programs=Se.programs,M.capabilities=mt,M.extensions=Qe,M.properties=fe,M.renderLists=Be,M.shadowMap=K,M.state=ht,M.info=ye}qe();const It=new dG(M,Fe);this.xr=It,this.getContext=function(){return Fe},this.getContextAttributes=function(){return Fe.getContextAttributes()},this.forceContextLoss=function(){const je=Qe.get("WEBGL_lose_context");je&&je.loseContext()},this.forceContextRestore=function(){const je=Qe.get("WEBGL_lose_context");je&&je.restoreContext()},this.getPixelRatio=function(){return $},this.setPixelRatio=function(je){je!==void 0&&($=je,this.setSize(Y,ae,!1))},this.getSize=function(je){return je.set(Y,ae)},this.setSize=function(je,_t,Ot){if(It.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Y=je,ae=_t,n.width=Math.floor(je*$),n.height=Math.floor(_t*$),Ot!==!1&&(n.style.width=je+"px",n.style.height=_t+"px"),this.setViewport(0,0,je,_t)},this.getDrawingBufferSize=function(je){return je.set(Y*$,ae*$).floor()},this.setDrawingBufferSize=function(je,_t,Ot){Y=je,ae=_t,$=Ot,n.width=Math.floor(je*Ot),n.height=Math.floor(_t*Ot),this.setViewport(0,0,je,_t)},this.getCurrentViewport=function(je){return je.copy(N)},this.getViewport=function(je){return je.copy(I)},this.setViewport=function(je,_t,Ot,At){je.isVector4?I.set(je.x,je.y,je.z,je.w):I.set(je,_t,Ot,At),ht.viewport(N.copy(I).multiplyScalar($).floor())},this.getScissor=function(je){return je.copy(k)},this.setScissor=function(je,_t,Ot,At){je.isVector4?k.set(je.x,je.y,je.z,je.w):k.set(je,_t,Ot,At),ht.scissor(F.copy(k).multiplyScalar($).floor())},this.getScissorTest=function(){return U},this.setScissorTest=function(je){ht.setScissorTest(U=je)},this.setOpaqueSort=function(je){de=je},this.setTransparentSort=function(je){D=je},this.getClearColor=function(je){return je.copy(J.getClearColor())},this.setClearColor=function(){J.setClearColor.apply(J,arguments)},this.getClearAlpha=function(){return J.getClearAlpha()},this.setClearAlpha=function(){J.setClearAlpha.apply(J,arguments)},this.clear=function(je,_t,Ot){let At=0;(je===void 0||je)&&(At|=16384),(_t===void 0||_t)&&(At|=256),(Ot===void 0||Ot)&&(At|=1024),Fe.clear(At)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",rn,!1),n.removeEventListener("webglcontextrestored",Yt,!1),Be.dispose(),We.dispose(),fe.dispose(),j.dispose(),q.dispose(),te.dispose(),Mt.dispose(),It.dispose(),It.removeEventListener("sessionstart",Dt),It.removeEventListener("sessionend",Ft),_e&&(_e.dispose(),_e=null),$t.stop()};function rn(je){je.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),S=!0}function Yt(){console.log("THREE.WebGLRenderer: Context Restored."),S=!1;const je=ye.autoReset,_t=K.enabled,Ot=K.autoUpdate,At=K.needsUpdate,Gt=K.type;qe(),ye.autoReset=je,K.enabled=_t,K.autoUpdate=Ot,K.needsUpdate=At,K.type=Gt}function Tn(je){const _t=je.target;_t.removeEventListener("dispose",Tn),Jt(_t)}function Jt(je){Fn(je),fe.remove(je)}function Fn(je){const _t=fe.get(je).programs;_t!==void 0&&_t.forEach(function(Ot){Se.releaseProgram(Ot)})}this.renderBufferDirect=function(je,_t,Ot,At,Gt,En){_t===null&&(_t=Ve);const Sn=Gt.isMesh&&Gt.matrixWorld.determinant()<0,pn=gi(je,_t,Ot,At,Gt);ht.setMaterial(At,Sn);let De=Ot.index;const Ye=Ot.attributes.position;if(De===null){if(Ye===void 0||Ye.count===0)return}else if(De.count===0)return;let ct=1;At.wireframe===!0&&(De=ee.getWireframeAttribute(Ot),ct=2),Mt.setup(Gt,At,pn,Ot,De);let bt,yt=xe;De!==null&&(bt=pe.get(De),yt=Je,yt.setIndex(bt));const zt=De!==null?De.count:Ye.count,kt=Ot.drawRange.start*ct,sn=Ot.drawRange.count*ct,jt=En!==null?En.start*ct:0,Nt=En!==null?En.count*ct:1/0,mn=Math.max(kt,jt),An=Math.min(zt,kt+sn,jt+Nt)-1,Cn=Math.max(0,An-mn+1);if(Cn!==0){if(Gt.isMesh)At.wireframe===!0?(ht.setLineWidth(At.wireframeLinewidth*Le()),yt.setMode(1)):yt.setMode(4);else if(Gt.isLine){let Gn=At.linewidth;Gn===void 0&&(Gn=1),ht.setLineWidth(Gn*Le()),Gt.isLineSegments?yt.setMode(1):Gt.isLineLoop?yt.setMode(2):yt.setMode(3)}else Gt.isPoints?yt.setMode(0):Gt.isSprite&&yt.setMode(4);if(Gt.isInstancedMesh)yt.renderInstances(mn,Cn,Gt.count);else if(Ot.isInstancedBufferGeometry){const Gn=Math.min(Ot.instanceCount,Ot._maxInstanceCount);yt.renderInstances(mn,Cn,Gn)}else yt.render(mn,Cn)}},this.compile=function(je,_t){b=We.get(je),b.init(),A.push(b),je.traverseVisible(function(Ot){Ot.isLight&&Ot.layers.test(_t.layers)&&(b.pushLight(Ot),Ot.castShadow&&b.pushShadow(Ot))}),b.setupLights(M.physicallyCorrectLights),je.traverse(function(Ot){const At=Ot.material;if(At)if(Array.isArray(At))for(let Gt=0;Gt<At.length;Gt++){const En=At[Gt];Er(En,je,Ot)}else Er(At,je,Ot)}),A.pop(),b=null};let mr=null;function fr(je){mr&&mr(je)}function Dt(){$t.stop()}function Ft(){$t.start()}const $t=new rT;$t.setAnimationLoop(fr),typeof window!="undefined"&&$t.setContext(window),this.setAnimationLoop=function(je){mr=je,It.setAnimationLoop(je),je===null?$t.stop():$t.start()},It.addEventListener("sessionstart",Dt),It.addEventListener("sessionend",Ft),this.render=function(je,_t){if(_t!==void 0&&_t.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(S===!0)return;je.autoUpdate===!0&&je.updateMatrixWorld(),_t.parent===null&&_t.updateMatrixWorld(),It.enabled===!0&&It.isPresenting===!0&&(It.cameraAutoUpdate===!0&&It.updateCamera(_t),_t=It.getCamera()),je.isScene===!0&&je.onBeforeRender(M,je,_t,C),b=We.get(je,A.length),b.init(),A.push(b),Ne.multiplyMatrices(_t.projectionMatrix,_t.matrixWorldInverse),ce.setFromProjectionMatrix(Ne),ge=this.localClippingEnabled,oe=ve.init(this.clippingPlanes,ge,_t),y=Be.get(je,w.length),y.init(),w.push(y),Pn(je,_t,0,M.sortObjects),y.finish(),M.sortObjects===!0&&y.sort(de,D),oe===!0&&ve.beginShadows();const Ot=b.state.shadowsArray;if(K.render(Ot,je,_t),oe===!0&&ve.endShadows(),this.info.autoReset===!0&&this.info.reset(),J.render(y,je),b.setupLights(M.physicallyCorrectLights),_t.isArrayCamera){const At=_t.cameras;for(let Gt=0,En=At.length;Gt<En;Gt++){const Sn=At[Gt];In(y,je,Sn,Sn.viewport)}}else In(y,je,_t);C!==null&&(H.updateMultisampleRenderTarget(C),H.updateRenderTargetMipmap(C)),je.isScene===!0&&je.onAfterRender(M,je,_t),ht.buffers.depth.setTest(!0),ht.buffers.depth.setMask(!0),ht.buffers.color.setMask(!0),ht.setPolygonOffset(!1),Mt.resetDefaultState(),L=-1,P=null,A.pop(),A.length>0?b=A[A.length-1]:b=null,w.pop(),w.length>0?y=w[w.length-1]:y=null};function Pn(je,_t,Ot,At){if(je.visible===!1)return;if(je.layers.test(_t.layers)){if(je.isGroup)Ot=je.renderOrder;else if(je.isLOD)je.autoUpdate===!0&&je.update(_t);else if(je.isLight)b.pushLight(je),je.castShadow&&b.pushShadow(je);else if(je.isSprite){if(!je.frustumCulled||ce.intersectsSprite(je)){At&&Ie.setFromMatrixPosition(je.matrixWorld).applyMatrix4(Ne);const Sn=te.update(je),pn=je.material;pn.visible&&y.push(je,Sn,pn,Ot,Ie.z,null)}}else if((je.isMesh||je.isLine||je.isPoints)&&(je.isSkinnedMesh&&je.skeleton.frame!==ye.render.frame&&(je.skeleton.update(),je.skeleton.frame=ye.render.frame),!je.frustumCulled||ce.intersectsObject(je))){At&&Ie.setFromMatrixPosition(je.matrixWorld).applyMatrix4(Ne);const Sn=te.update(je),pn=je.material;if(Array.isArray(pn)){const De=Sn.groups;for(let Ye=0,ct=De.length;Ye<ct;Ye++){const bt=De[Ye],yt=pn[bt.materialIndex];yt&&yt.visible&&y.push(je,Sn,yt,Ot,Ie.z,bt)}}else pn.visible&&y.push(je,Sn,pn,Ot,Ie.z,null)}}const En=je.children;for(let Sn=0,pn=En.length;Sn<pn;Sn++)Pn(En[Sn],_t,Ot,At)}function In(je,_t,Ot,At){const Gt=je.opaque,En=je.transmissive,Sn=je.transparent;b.setupLightsView(Ot),En.length>0&&zn(Gt,_t,Ot),At&&ht.viewport(N.copy(At)),Gt.length>0&&bn(Gt,_t,Ot),En.length>0&&bn(En,_t,Ot),Sn.length>0&&bn(Sn,_t,Ot)}function zn(je,_t,Ot){if(_e===null){const Sn=u===!0&&mt.isWebGL2===!0?US:Do;_e=new Sn(1024,1024,{generateMipmaps:!0,type:Xe.convert(ih)!==null?ih:Dl,minFilter:Ov,magFilter:Xi,wrapS:Qa,wrapT:Qa})}const At=M.getRenderTarget();M.setRenderTarget(_e),M.clear();const Gt=M.toneMapping;M.toneMapping=zc,bn(je,_t,Ot),M.toneMapping=Gt,H.updateMultisampleRenderTarget(_e),H.updateRenderTargetMipmap(_e),M.setRenderTarget(At)}function bn(je,_t,Ot){const At=_t.isScene===!0?_t.overrideMaterial:null;for(let Gt=0,En=je.length;Gt<En;Gt++){const Sn=je[Gt],pn=Sn.object,De=Sn.geometry,Ye=At===null?Sn.material:At,ct=Sn.group;pn.layers.test(Ot.layers)&&Jn(pn,_t,Ot,De,Ye,ct)}}function Jn(je,_t,Ot,At,Gt,En){je.onBeforeRender(M,_t,Ot,At,Gt,En),je.modelViewMatrix.multiplyMatrices(Ot.matrixWorldInverse,je.matrixWorld),je.normalMatrix.getNormalMatrix(je.modelViewMatrix),Gt.onBeforeRender(M,_t,Ot,At,je,En),Gt.transparent===!0&&Gt.side===nh?(Gt.side=Ni,Gt.needsUpdate=!0,M.renderBufferDirect(Ot,_t,At,Gt,je,En),Gt.side=vd,Gt.needsUpdate=!0,M.renderBufferDirect(Ot,_t,At,Gt,je,En),Gt.side=nh):M.renderBufferDirect(Ot,_t,At,Gt,je,En),je.onAfterRender(M,_t,Ot,At,Gt,En)}function Er(je,_t,Ot){_t.isScene!==!0&&(_t=Ve);const At=fe.get(je),Gt=b.state.lights,En=b.state.shadowsArray,Sn=Gt.state.version,pn=Se.getParameters(je,Gt.state,En,_t,Ot),De=Se.getProgramCacheKey(pn);let Ye=At.programs;At.environment=je.isMeshStandardMaterial?_t.environment:null,At.fog=_t.fog,At.envMap=(je.isMeshStandardMaterial?q:j).get(je.envMap||At.environment),Ye===void 0&&(je.addEventListener("dispose",Tn),Ye=new Map,At.programs=Ye);let ct=Ye.get(De);if(ct!==void 0){if(At.currentProgram===ct&&At.lightsStateVersion===Sn)return cr(je,pn),ct}else pn.uniforms=Se.getUniforms(je),je.onBuild(Ot,pn,M),je.onBeforeCompile(pn,M),ct=Se.acquireProgram(pn,De),Ye.set(De,ct),At.uniforms=pn.uniforms;const bt=At.uniforms;(!je.isShaderMaterial&&!je.isRawShaderMaterial||je.clipping===!0)&&(bt.clippingPlanes=ve.uniform),cr(je,pn),At.needsLights=vr(je),At.lightsStateVersion=Sn,At.needsLights&&(bt.ambientLightColor.value=Gt.state.ambient,bt.lightProbe.value=Gt.state.probe,bt.directionalLights.value=Gt.state.directional,bt.directionalLightShadows.value=Gt.state.directionalShadow,bt.spotLights.value=Gt.state.spot,bt.spotLightShadows.value=Gt.state.spotShadow,bt.rectAreaLights.value=Gt.state.rectArea,bt.ltc_1.value=Gt.state.rectAreaLTC1,bt.ltc_2.value=Gt.state.rectAreaLTC2,bt.pointLights.value=Gt.state.point,bt.pointLightShadows.value=Gt.state.pointShadow,bt.hemisphereLights.value=Gt.state.hemi,bt.directionalShadowMap.value=Gt.state.directionalShadowMap,bt.directionalShadowMatrix.value=Gt.state.directionalShadowMatrix,bt.spotShadowMap.value=Gt.state.spotShadowMap,bt.spotShadowMatrix.value=Gt.state.spotShadowMatrix,bt.pointShadowMap.value=Gt.state.pointShadowMap,bt.pointShadowMatrix.value=Gt.state.pointShadowMatrix);const yt=ct.getUniforms(),zt=Vl.seqWithValue(yt.seq,bt);return At.currentProgram=ct,At.uniformsList=zt,ct}function cr(je,_t){const Ot=fe.get(je);Ot.outputEncoding=_t.outputEncoding,Ot.instancing=_t.instancing,Ot.skinning=_t.skinning,Ot.morphTargets=_t.morphTargets,Ot.morphNormals=_t.morphNormals,Ot.morphTargetsCount=_t.morphTargetsCount,Ot.numClippingPlanes=_t.numClippingPlanes,Ot.numIntersection=_t.numClipIntersection,Ot.vertexAlphas=_t.vertexAlphas,Ot.vertexTangents=_t.vertexTangents}function gi(je,_t,Ot,At,Gt){_t.isScene!==!0&&(_t=Ve),H.resetTextureUnits();const En=_t.fog,Sn=At.isMeshStandardMaterial?_t.environment:null,pn=C===null?M.outputEncoding:C.texture.encoding,De=(At.isMeshStandardMaterial?q:j).get(At.envMap||Sn),Ye=At.vertexColors===!0&&!!Ot.attributes.color&&Ot.attributes.color.itemSize===4,ct=!!At.normalMap&&!!Ot.attributes.tangent,bt=!!Ot.morphAttributes.position,yt=!!Ot.morphAttributes.normal,zt=Ot.morphAttributes.position?Ot.morphAttributes.position.length:0,kt=fe.get(At),sn=b.state.lights;if(oe===!0&&(ge===!0||je!==P)){const Rn=je===P&&At.id===L;ve.setState(At,je,Rn)}let jt=!1;At.version===kt.__version?(kt.needsLights&&kt.lightsStateVersion!==sn.state.version||kt.outputEncoding!==pn||Gt.isInstancedMesh&&kt.instancing===!1||!Gt.isInstancedMesh&&kt.instancing===!0||Gt.isSkinnedMesh&&kt.skinning===!1||!Gt.isSkinnedMesh&&kt.skinning===!0||kt.envMap!==De||At.fog&&kt.fog!==En||kt.numClippingPlanes!==void 0&&(kt.numClippingPlanes!==ve.numPlanes||kt.numIntersection!==ve.numIntersection)||kt.vertexAlphas!==Ye||kt.vertexTangents!==ct||kt.morphTargets!==bt||kt.morphNormals!==yt||mt.isWebGL2===!0&&kt.morphTargetsCount!==zt)&&(jt=!0):(jt=!0,kt.__version=At.version);let Nt=kt.currentProgram;jt===!0&&(Nt=Er(At,_t,Gt));let mn=!1,An=!1,Cn=!1;const Gn=Nt.getUniforms(),tr=kt.uniforms;if(ht.useProgram(Nt.program)&&(mn=!0,An=!0,Cn=!0),At.id!==L&&(L=At.id,An=!0),mn||P!==je){if(Gn.setValue(Fe,"projectionMatrix",je.projectionMatrix),mt.logarithmicDepthBuffer&&Gn.setValue(Fe,"logDepthBufFC",2/(Math.log(je.far+1)/Math.LN2)),P!==je&&(P=je,An=!0,Cn=!0),At.isShaderMaterial||At.isMeshPhongMaterial||At.isMeshToonMaterial||At.isMeshStandardMaterial||At.envMap){const Rn=Gn.map.cameraPosition;Rn!==void 0&&Rn.setValue(Fe,Ie.setFromMatrixPosition(je.matrixWorld))}(At.isMeshPhongMaterial||At.isMeshToonMaterial||At.isMeshLambertMaterial||At.isMeshBasicMaterial||At.isMeshStandardMaterial||At.isShaderMaterial)&&Gn.setValue(Fe,"isOrthographic",je.isOrthographicCamera===!0),(At.isMeshPhongMaterial||At.isMeshToonMaterial||At.isMeshLambertMaterial||At.isMeshBasicMaterial||At.isMeshStandardMaterial||At.isShaderMaterial||At.isShadowMaterial||Gt.isSkinnedMesh)&&Gn.setValue(Fe,"viewMatrix",je.matrixWorldInverse)}if(Gt.isSkinnedMesh){Gn.setOptional(Fe,Gt,"bindMatrix"),Gn.setOptional(Fe,Gt,"bindMatrixInverse");const Rn=Gt.skeleton;Rn&&(mt.floatVertexTextures?(Rn.boneTexture===null&&Rn.computeBoneTexture(),Gn.setValue(Fe,"boneTexture",Rn.boneTexture,H),Gn.setValue(Fe,"boneTextureSize",Rn.boneTextureSize)):Gn.setOptional(Fe,Rn,"boneMatrices"))}return!!Ot&&(Ot.morphAttributes.position!==void 0||Ot.morphAttributes.normal!==void 0)&&Ee.update(Gt,Ot,At,Nt),(An||kt.receiveShadow!==Gt.receiveShadow)&&(kt.receiveShadow=Gt.receiveShadow,Gn.setValue(Fe,"receiveShadow",Gt.receiveShadow)),An&&(Gn.setValue(Fe,"toneMappingExposure",M.toneMappingExposure),kt.needsLights&&Lr(tr,Cn),En&&At.fog&&ke.refreshFogUniforms(tr,En),ke.refreshMaterialUniforms(tr,At,$,ae,_e),Vl.upload(Fe,kt.uniformsList,tr,H)),At.isShaderMaterial&&At.uniformsNeedUpdate===!0&&(Vl.upload(Fe,kt.uniformsList,tr,H),At.uniformsNeedUpdate=!1),At.isSpriteMaterial&&Gn.setValue(Fe,"center",Gt.center),Gn.setValue(Fe,"modelViewMatrix",Gt.modelViewMatrix),Gn.setValue(Fe,"normalMatrix",Gt.normalMatrix),Gn.setValue(Fe,"modelMatrix",Gt.matrixWorld),Nt}function Lr(je,_t){je.ambientLightColor.needsUpdate=_t,je.lightProbe.needsUpdate=_t,je.directionalLights.needsUpdate=_t,je.directionalLightShadows.needsUpdate=_t,je.pointLights.needsUpdate=_t,je.pointLightShadows.needsUpdate=_t,je.spotLights.needsUpdate=_t,je.spotLightShadows.needsUpdate=_t,je.rectAreaLights.needsUpdate=_t,je.hemisphereLights.needsUpdate=_t}function vr(je){return je.isMeshLambertMaterial||je.isMeshToonMaterial||je.isMeshPhongMaterial||je.isMeshStandardMaterial||je.isShadowMaterial||je.isShaderMaterial&&je.lights===!0}this.getActiveCubeFace=function(){return E},this.getActiveMipmapLevel=function(){return T},this.getRenderTarget=function(){return C},this.setRenderTarget=function(je,_t=0,Ot=0){C=je,E=_t,T=Ot,je&&fe.get(je).__webglFramebuffer===void 0&&H.setupRenderTarget(je);let At=null,Gt=!1,En=!1;if(je){const pn=je.texture;(pn.isDataTexture3D||pn.isDataTexture2DArray)&&(En=!0);const De=fe.get(je).__webglFramebuffer;je.isWebGLCubeRenderTarget?(At=De[_t],Gt=!0):je.isWebGLMultisampleRenderTarget?At=fe.get(je).__webglMultisampledFramebuffer:At=De,N.copy(je.viewport),F.copy(je.scissor),X=je.scissorTest}else N.copy(I).multiplyScalar($).floor(),F.copy(k).multiplyScalar($).floor(),X=U;if(ht.bindFramebuffer(36160,At)&&mt.drawBuffers){let pn=!1;if(je)if(je.isWebGLMultipleRenderTargets){const De=je.texture;if(W.length!==De.length||W[0]!==36064){for(let Ye=0,ct=De.length;Ye<ct;Ye++)W[Ye]=36064+Ye;W.length=De.length,pn=!0}}else(W.length!==1||W[0]!==36064)&&(W[0]=36064,W.length=1,pn=!0);else(W.length!==1||W[0]!==1029)&&(W[0]=1029,W.length=1,pn=!0);pn&&(mt.isWebGL2?Fe.drawBuffers(W):Qe.get("WEBGL_draw_buffers").drawBuffersWEBGL(W))}if(ht.viewport(N),ht.scissor(F),ht.setScissorTest(X),Gt){const pn=fe.get(je.texture);Fe.framebufferTexture2D(36160,36064,34069+_t,pn.__webglTexture,Ot)}else if(En){const pn=fe.get(je.texture),De=_t||0;Fe.framebufferTextureLayer(36160,36064,pn.__webglTexture,Ot||0,De)}L=-1},this.readRenderTargetPixels=function(je,_t,Ot,At,Gt,En,Sn){if(!(je&&je.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let pn=fe.get(je).__webglFramebuffer;if(je.isWebGLCubeRenderTarget&&Sn!==void 0&&(pn=pn[Sn]),pn){ht.bindFramebuffer(36160,pn);try{const De=je.texture,Ye=De.format,ct=De.type;if(Ye!==ha&&Xe.convert(Ye)!==Fe.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const bt=ct===ih&&(Qe.has("EXT_color_buffer_half_float")||mt.isWebGL2&&Qe.has("EXT_color_buffer_float"));if(ct!==Dl&&Xe.convert(ct)!==Fe.getParameter(35738)&&!(ct===Ol&&(mt.isWebGL2||Qe.has("OES_texture_float")||Qe.has("WEBGL_color_buffer_float")))&&!bt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Fe.checkFramebufferStatus(36160)===36053?_t>=0&&_t<=je.width-At&&Ot>=0&&Ot<=je.height-Gt&&Fe.readPixels(_t,Ot,At,Gt,Xe.convert(Ye),Xe.convert(ct),En):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const De=C!==null?fe.get(C).__webglFramebuffer:null;ht.bindFramebuffer(36160,De)}}},this.copyFramebufferToTexture=function(je,_t,Ot=0){const At=Math.pow(2,-Ot),Gt=Math.floor(_t.image.width*At),En=Math.floor(_t.image.height*At);let Sn=Xe.convert(_t.format);mt.isWebGL2&&(Sn===6407&&(Sn=32849),Sn===6408&&(Sn=32856)),H.setTexture2D(_t,0),Fe.copyTexImage2D(3553,Ot,Sn,je.x,je.y,Gt,En,0),ht.unbindTexture()},this.copyTextureToTexture=function(je,_t,Ot,At=0){const Gt=_t.image.width,En=_t.image.height,Sn=Xe.convert(Ot.format),pn=Xe.convert(Ot.type);H.setTexture2D(Ot,0),Fe.pixelStorei(37440,Ot.flipY),Fe.pixelStorei(37441,Ot.premultiplyAlpha),Fe.pixelStorei(3317,Ot.unpackAlignment),_t.isDataTexture?Fe.texSubImage2D(3553,At,je.x,je.y,Gt,En,Sn,pn,_t.image.data):_t.isCompressedTexture?Fe.compressedTexSubImage2D(3553,At,je.x,je.y,_t.mipmaps[0].width,_t.mipmaps[0].height,Sn,_t.mipmaps[0].data):Fe.texSubImage2D(3553,At,je.x,je.y,Sn,pn,_t.image),At===0&&Ot.generateMipmaps&&Fe.generateMipmap(3553),ht.unbindTexture()},this.copyTextureToTexture3D=function(je,_t,Ot,At,Gt=0){if(M.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const En=je.max.x-je.min.x+1,Sn=je.max.y-je.min.y+1,pn=je.max.z-je.min.z+1,De=Xe.convert(At.format),Ye=Xe.convert(At.type);let ct;if(At.isDataTexture3D)H.setTexture3D(At,0),ct=32879;else if(At.isDataTexture2DArray)H.setTexture2DArray(At,0),ct=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}Fe.pixelStorei(37440,At.flipY),Fe.pixelStorei(37441,At.premultiplyAlpha),Fe.pixelStorei(3317,At.unpackAlignment);const bt=Fe.getParameter(3314),yt=Fe.getParameter(32878),zt=Fe.getParameter(3316),kt=Fe.getParameter(3315),sn=Fe.getParameter(32877),jt=Ot.isCompressedTexture?Ot.mipmaps[0]:Ot.image;Fe.pixelStorei(3314,jt.width),Fe.pixelStorei(32878,jt.height),Fe.pixelStorei(3316,je.min.x),Fe.pixelStorei(3315,je.min.y),Fe.pixelStorei(32877,je.min.z),Ot.isDataTexture||Ot.isDataTexture3D?Fe.texSubImage3D(ct,Gt,_t.x,_t.y,_t.z,En,Sn,pn,De,Ye,jt.data):Ot.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Fe.compressedTexSubImage3D(ct,Gt,_t.x,_t.y,_t.z,En,Sn,pn,De,jt.data)):Fe.texSubImage3D(ct,Gt,_t.x,_t.y,_t.z,En,Sn,pn,De,Ye,jt),Fe.pixelStorei(3314,bt),Fe.pixelStorei(32878,yt),Fe.pixelStorei(3316,zt),Fe.pixelStorei(3315,kt),Fe.pixelStorei(32877,sn),Gt===0&&At.generateMipmaps&&Fe.generateMipmap(ct),ht.unbindTexture()},this.initTexture=function(je){H.setTexture2D(je,0),ht.unbindTexture()},this.resetState=function(){E=0,T=0,C=null,ht.reset(),Mt.reset()},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}ti.prototype.isWebGLRenderer=!0;class vG extends ti{}vG.prototype.isWebGL1Renderer=!0;class Fx extends ei{constructor(){super();this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(n,r){return super.copy(n,r),n.background!==null&&(this.background=n.background.clone()),n.environment!==null&&(this.environment=n.environment.clone()),n.fog!==null&&(this.fog=n.fog.clone()),n.overrideMaterial!==null&&(this.overrideMaterial=n.overrideMaterial.clone()),this.autoUpdate=n.autoUpdate,this.matrixAutoUpdate=n.matrixAutoUpdate,this}toJSON(n){const r=super.toJSON(n);return this.fog!==null&&(r.object.fog=this.fog.toJSON()),r}}Fx.prototype.isScene=!0;class Pd{constructor(n,r){this.array=n,this.stride=r,this.count=n!==void 0?n.length/r:0,this.usage=Ad,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=is()}onUploadCallback(){}set needsUpdate(n){n===!0&&this.version++}setUsage(n){return this.usage=n,this}copy(n){return this.array=new n.array.constructor(n.array),this.count=n.count,this.stride=n.stride,this.usage=n.usage,this}copyAt(n,r,a){n*=this.stride,a*=r.stride;for(let s=0,o=this.stride;s<o;s++)this.array[n+s]=r.array[a+s];return this}set(n,r=0){return this.array.set(n,r),this}clone(n){n.arrayBuffers===void 0&&(n.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=is()),n.arrayBuffers[this.array.buffer._uuid]===void 0&&(n.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const r=new this.array.constructor(n.arrayBuffers[this.array.buffer._uuid]),a=new this.constructor(r,this.stride);return a.setUsage(this.usage),a}onUpload(n){return this.onUploadCallback=n,this}toJSON(n){return n.arrayBuffers===void 0&&(n.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=is()),n.arrayBuffers[this.array.buffer._uuid]===void 0&&(n.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}Pd.prototype.isInterleavedBuffer=!0;const ki=new Ze;class Dd{constructor(n,r,a,s=!1){this.name="",this.data=n,this.itemSize=r,this.offset=a,this.normalized=s===!0}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(n){this.data.needsUpdate=n}applyMatrix4(n){for(let r=0,a=this.data.count;r<a;r++)ki.x=this.getX(r),ki.y=this.getY(r),ki.z=this.getZ(r),ki.applyMatrix4(n),this.setXYZ(r,ki.x,ki.y,ki.z);return this}applyNormalMatrix(n){for(let r=0,a=this.count;r<a;r++)ki.x=this.getX(r),ki.y=this.getY(r),ki.z=this.getZ(r),ki.applyNormalMatrix(n),this.setXYZ(r,ki.x,ki.y,ki.z);return this}transformDirection(n){for(let r=0,a=this.count;r<a;r++)ki.x=this.getX(r),ki.y=this.getY(r),ki.z=this.getZ(r),ki.transformDirection(n),this.setXYZ(r,ki.x,ki.y,ki.z);return this}setX(n,r){return this.data.array[n*this.data.stride+this.offset]=r,this}setY(n,r){return this.data.array[n*this.data.stride+this.offset+1]=r,this}setZ(n,r){return this.data.array[n*this.data.stride+this.offset+2]=r,this}setW(n,r){return this.data.array[n*this.data.stride+this.offset+3]=r,this}getX(n){return this.data.array[n*this.data.stride+this.offset]}getY(n){return this.data.array[n*this.data.stride+this.offset+1]}getZ(n){return this.data.array[n*this.data.stride+this.offset+2]}getW(n){return this.data.array[n*this.data.stride+this.offset+3]}setXY(n,r,a){return n=n*this.data.stride+this.offset,this.data.array[n+0]=r,this.data.array[n+1]=a,this}setXYZ(n,r,a,s){return n=n*this.data.stride+this.offset,this.data.array[n+0]=r,this.data.array[n+1]=a,this.data.array[n+2]=s,this}setXYZW(n,r,a,s,o){return n=n*this.data.stride+this.offset,this.data.array[n+0]=r,this.data.array[n+1]=a,this.data.array[n+2]=s,this.data.array[n+3]=o,this}clone(n){if(n===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const r=[];for(let a=0;a<this.count;a++){const s=a*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)r.push(this.data.array[s+o])}return new zi(new this.array.constructor(r),this.itemSize,this.normalized)}else return n.interleavedBuffers===void 0&&(n.interleavedBuffers={}),n.interleavedBuffers[this.data.uuid]===void 0&&(n.interleavedBuffers[this.data.uuid]=this.data.clone(n)),new Dd(n.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(n){if(n===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const r=[];for(let a=0;a<this.count;a++){const s=a*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)r.push(this.data.array[s+o])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:r,normalized:this.normalized}}else return n.interleavedBuffers===void 0&&(n.interleavedBuffers={}),n.interleavedBuffers[this.data.uuid]===void 0&&(n.interleavedBuffers[this.data.uuid]=this.data.toJSON(n)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}Dd.prototype.isInterleavedBufferAttribute=!0;class Bx extends da{constructor(n){super();this.type="SpriteMaterial",this.color=new On(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(n)}copy(n){return super.copy(n),this.color.copy(n.color),this.map=n.map,this.alphaMap=n.alphaMap,this.rotation=n.rotation,this.sizeAttenuation=n.sizeAttenuation,this}}Bx.prototype.isSpriteMaterial=!0;let Ph;const Od=new Ze,Dh=new Ze,Oh=new Ze,Ih=new Wt,Id=new Wt,HT=new jn,ug=new Ze,kd=new Ze,hg=new Ze,zT=new Wt,Nx=new Wt,GT=new Wt;class VT extends ei{constructor(n){super();if(this.type="Sprite",Ph===void 0){Ph=new Zr;const r=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),a=new Pd(r,5);Ph.setIndex([0,1,2,0,2,3]),Ph.setAttribute("position",new Dd(a,3,0,!1)),Ph.setAttribute("uv",new Dd(a,2,3,!1))}this.geometry=Ph,this.material=n!==void 0?n:new Bx,this.center=new Wt(.5,.5)}raycast(n,r){n.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Dh.setFromMatrixScale(this.matrixWorld),HT.copy(n.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(n.camera.matrixWorldInverse,this.matrixWorld),Oh.setFromMatrixPosition(this.modelViewMatrix),n.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Dh.multiplyScalar(-Oh.z);const a=this.material.rotation;let s,o;a!==0&&(o=Math.cos(a),s=Math.sin(a));const u=this.center;fg(ug.set(-.5,-.5,0),Oh,u,Dh,s,o),fg(kd.set(.5,-.5,0),Oh,u,Dh,s,o),fg(hg.set(.5,.5,0),Oh,u,Dh,s,o),zT.set(0,0),Nx.set(1,0),GT.set(1,1);let f=n.ray.intersectTriangle(ug,kd,hg,!1,Od);if(f===null&&(fg(kd.set(-.5,.5,0),Oh,u,Dh,s,o),Nx.set(0,1),f=n.ray.intersectTriangle(ug,hg,kd,!1,Od),f===null))return;const v=n.ray.origin.distanceTo(Od);v<n.near||v>n.far||r.push({distance:v,point:Od.clone(),uv:Hi.getUV(Od,ug,kd,hg,zT,Nx,GT,new Wt),face:null,object:this})}copy(n){return super.copy(n),n.center!==void 0&&this.center.copy(n.center),this.material=n.material,this}}VT.prototype.isSprite=!0;function fg(i,n,r,a,s,o){Ih.subVectors(i,r).addScalar(.5).multiply(a),s!==void 0?(Id.x=o*Ih.x-s*Ih.y,Id.y=s*Ih.x+o*Ih.y):Id.copy(Ih),i.copy(n),i.x+=Id.x,i.y+=Id.y,i.applyMatrix4(HT)}const WT=new Ze,jT=new ci,XT=new ci,gG=new Ze,qT=new jn;class YT extends ra{constructor(n,r){super(n,r);this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new jn,this.bindMatrixInverse=new jn}copy(n){return super.copy(n),this.bindMode=n.bindMode,this.bindMatrix.copy(n.bindMatrix),this.bindMatrixInverse.copy(n.bindMatrixInverse),this.skeleton=n.skeleton,this}bind(n,r){this.skeleton=n,r===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),r=this.matrixWorld),this.bindMatrix.copy(r),this.bindMatrixInverse.copy(r).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const n=new ci,r=this.geometry.attributes.skinWeight;for(let a=0,s=r.count;a<s;a++){n.x=r.getX(a),n.y=r.getY(a),n.z=r.getZ(a),n.w=r.getW(a);const o=1/n.manhattanLength();o!==1/0?n.multiplyScalar(o):n.set(1,0,0,0),r.setXYZW(a,n.x,n.y,n.z,n.w)}}updateMatrixWorld(n){super.updateMatrixWorld(n),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(n,r){const a=this.skeleton,s=this.geometry;jT.fromBufferAttribute(s.attributes.skinIndex,n),XT.fromBufferAttribute(s.attributes.skinWeight,n),WT.copy(r).applyMatrix4(this.bindMatrix),r.set(0,0,0);for(let o=0;o<4;o++){const u=XT.getComponent(o);if(u!==0){const f=jT.getComponent(o);qT.multiplyMatrices(a.bones[f].matrixWorld,a.boneInverses[f]),r.addScaledVector(gG.copy(WT).applyMatrix4(qT),u)}}return r.applyMatrix4(this.bindMatrixInverse)}}YT.prototype.isSkinnedMesh=!0;class yG extends ei{constructor(){super();this.type="Bone"}}yG.prototype.isBone=!0;class bG extends qi{constructor(n=null,r=1,a=1,s,o,u,f,v,m=Xi,g=Xi,y,b){super(null,u,f,v,m,g,s,o,y,b);this.image={data:n,width:r,height:a},this.magFilter=m,this.minFilter=g,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}bG.prototype.isDataTexture=!0;class Ux extends zi{constructor(n,r,a,s=1){typeof a=="number"&&(s=a,a=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument."));super(n,r,a);this.meshPerAttribute=s}copy(n){return super.copy(n),this.meshPerAttribute=n.meshPerAttribute,this}toJSON(){const n=super.toJSON();return n.meshPerAttribute=this.meshPerAttribute,n.isInstancedBufferAttribute=!0,n}}Ux.prototype.isInstancedBufferAttribute=!0;const $T=new jn,KT=new jn,dg=[],Fd=new ra;class xG extends ra{constructor(n,r,a){super(n,r);this.instanceMatrix=new Ux(new Float32Array(a*16),16),this.instanceColor=null,this.count=a,this.frustumCulled=!1}copy(n){return super.copy(n),this.instanceMatrix.copy(n.instanceMatrix),n.instanceColor!==null&&(this.instanceColor=n.instanceColor.clone()),this.count=n.count,this}getColorAt(n,r){r.fromArray(this.instanceColor.array,n*3)}getMatrixAt(n,r){r.fromArray(this.instanceMatrix.array,n*16)}raycast(n,r){const a=this.matrixWorld,s=this.count;if(Fd.geometry=this.geometry,Fd.material=this.material,Fd.material!==void 0)for(let o=0;o<s;o++){this.getMatrixAt(o,$T),KT.multiplyMatrices(a,$T),Fd.matrixWorld=KT,Fd.raycast(n,dg);for(let u=0,f=dg.length;u<f;u++){const v=dg[u];v.instanceId=o,v.object=this,r.push(v)}dg.length=0}}setColorAt(n,r){this.instanceColor===null&&(this.instanceColor=new Ux(new Float32Array(this.instanceMatrix.count*3),3)),r.toArray(this.instanceColor.array,n*3)}setMatrixAt(n,r){r.toArray(this.instanceMatrix.array,n*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}xG.prototype.isInstancedMesh=!0;class kh extends da{constructor(n){super();this.type="LineBasicMaterial",this.color=new On(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(n)}copy(n){return super.copy(n),this.color.copy(n.color),this.linewidth=n.linewidth,this.linecap=n.linecap,this.linejoin=n.linejoin,this}}kh.prototype.isLineBasicMaterial=!0;const ZT=new Ze,QT=new Ze,JT=new jn,Hx=new jc,pg=new mh;class mg extends ei{constructor(n=new Zr,r=new kh){super();this.type="Line",this.geometry=n,this.material=r,this.updateMorphTargets()}copy(n){return super.copy(n),this.material=n.material,this.geometry=n.geometry,this}computeLineDistances(){const n=this.geometry;if(n.isBufferGeometry)if(n.index===null){const r=n.attributes.position,a=[0];for(let s=1,o=r.count;s<o;s++)ZT.fromBufferAttribute(r,s-1),QT.fromBufferAttribute(r,s),a[s]=a[s-1],a[s]+=ZT.distanceTo(QT);n.setAttribute("lineDistance",new Xr(a,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else n.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(n,r){const a=this.geometry,s=this.matrixWorld,o=n.params.Line.threshold,u=a.drawRange;if(a.boundingSphere===null&&a.computeBoundingSphere(),pg.copy(a.boundingSphere),pg.applyMatrix4(s),pg.radius+=o,n.ray.intersectsSphere(pg)===!1)return;JT.copy(s).invert(),Hx.copy(n.ray).applyMatrix4(JT);const f=o/((this.scale.x+this.scale.y+this.scale.z)/3),v=f*f,m=new Ze,g=new Ze,y=new Ze,b=new Ze,w=this.isLineSegments?2:1;if(a.isBufferGeometry){const A=a.index,S=a.attributes.position;if(A!==null){const E=Math.max(0,u.start),T=Math.min(A.count,u.start+u.count);for(let C=E,L=T-1;C<L;C+=w){const P=A.getX(C),N=A.getX(C+1);if(m.fromBufferAttribute(S,P),g.fromBufferAttribute(S,N),Hx.distanceSqToSegment(m,g,b,y)>v)continue;b.applyMatrix4(this.matrixWorld);const X=n.ray.origin.distanceTo(b);X<n.near||X>n.far||r.push({distance:X,point:y.clone().applyMatrix4(this.matrixWorld),index:C,face:null,faceIndex:null,object:this})}}else{const E=Math.max(0,u.start),T=Math.min(S.count,u.start+u.count);for(let C=E,L=T-1;C<L;C+=w){if(m.fromBufferAttribute(S,C),g.fromBufferAttribute(S,C+1),Hx.distanceSqToSegment(m,g,b,y)>v)continue;b.applyMatrix4(this.matrixWorld);const N=n.ray.origin.distanceTo(b);N<n.near||N>n.far||r.push({distance:N,point:y.clone().applyMatrix4(this.matrixWorld),index:C,face:null,faceIndex:null,object:this})}}}else a.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const n=this.geometry;if(n.isBufferGeometry){const r=n.morphAttributes,a=Object.keys(r);if(a.length>0){const s=r[a[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,u=s.length;o<u;o++){const f=s[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[f]=o}}}}else{const r=n.morphTargets;r!==void 0&&r.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}mg.prototype.isLine=!0;const e2=new Ze,t2=new Ze;class zx extends mg{constructor(n,r){super(n,r);this.type="LineSegments"}computeLineDistances(){const n=this.geometry;if(n.isBufferGeometry)if(n.index===null){const r=n.attributes.position,a=[];for(let s=0,o=r.count;s<o;s+=2)e2.fromBufferAttribute(r,s),t2.fromBufferAttribute(r,s+1),a[s]=s===0?0:a[s-1],a[s+1]=a[s]+e2.distanceTo(t2);n.setAttribute("lineDistance",new Xr(a,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else n.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}zx.prototype.isLineSegments=!0;class wG extends mg{constructor(n,r){super(n,r);this.type="LineLoop"}}wG.prototype.isLineLoop=!0;class n2 extends da{constructor(n){super();this.type="PointsMaterial",this.color=new On(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(n)}copy(n){return super.copy(n),this.color.copy(n.color),this.map=n.map,this.alphaMap=n.alphaMap,this.size=n.size,this.sizeAttenuation=n.sizeAttenuation,this}}n2.prototype.isPointsMaterial=!0;const r2=new jn,Gx=new jc,vg=new mh,gg=new Ze;class AG extends ei{constructor(n=new Zr,r=new n2){super();this.type="Points",this.geometry=n,this.material=r,this.updateMorphTargets()}copy(n){return super.copy(n),this.material=n.material,this.geometry=n.geometry,this}raycast(n,r){const a=this.geometry,s=this.matrixWorld,o=n.params.Points.threshold,u=a.drawRange;if(a.boundingSphere===null&&a.computeBoundingSphere(),vg.copy(a.boundingSphere),vg.applyMatrix4(s),vg.radius+=o,n.ray.intersectsSphere(vg)===!1)return;r2.copy(s).invert(),Gx.copy(n.ray).applyMatrix4(r2);const f=o/((this.scale.x+this.scale.y+this.scale.z)/3),v=f*f;if(a.isBufferGeometry){const m=a.index,y=a.attributes.position;if(m!==null){const b=Math.max(0,u.start),w=Math.min(m.count,u.start+u.count);for(let A=b,M=w;A<M;A++){const S=m.getX(A);gg.fromBufferAttribute(y,S),i2(gg,S,v,s,n,r,this)}}else{const b=Math.max(0,u.start),w=Math.min(y.count,u.start+u.count);for(let A=b,M=w;A<M;A++)gg.fromBufferAttribute(y,A),i2(gg,A,v,s,n,r,this)}}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const n=this.geometry;if(n.isBufferGeometry){const r=n.morphAttributes,a=Object.keys(r);if(a.length>0){const s=r[a[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,u=s.length;o<u;o++){const f=s[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[f]=o}}}}else{const r=n.morphTargets;r!==void 0&&r.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}AG.prototype.isPoints=!0;function i2(i,n,r,a,s,o,u){const f=Gx.distanceSqToPoint(i);if(f<r){const v=new Ze;Gx.closestPointToPoint(i,v),v.applyMatrix4(a);const m=s.ray.origin.distanceTo(v);if(m<s.near||m>s.far)return;o.push({distance:m,distanceToRay:Math.sqrt(f),point:v,index:n,face:null,object:u})}}class EG extends qi{constructor(n,r,a,s,o,u,f,v,m){super(n,r,a,s,o,u,f,v,m);this.format=f!==void 0?f:ah,this.minFilter=u!==void 0?u:Ra,this.magFilter=o!==void 0?o:Ra,this.generateMipmaps=!1;const g=this;function y(){g.needsUpdate=!0,n.requestVideoFrameCallback(y)}"requestVideoFrameCallback"in n&&n.requestVideoFrameCallback(y)}clone(){return new this.constructor(this.image).copy(this)}update(){const n=this.image;"requestVideoFrameCallback"in n===!1&&n.readyState>=n.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}EG.prototype.isVideoTexture=!0;class _G extends qi{constructor(n,r,a,s,o,u,f,v,m,g,y,b){super(null,u,f,v,m,g,s,o,y,b);this.image={width:r,height:a},this.mipmaps=n,this.flipY=!1,this.generateMipmaps=!1}}_G.prototype.isCompressedTexture=!0;class MG extends qi{constructor(n,r,a,s,o,u,f,v,m){super(n,r,a,s,o,u,f,v,m);this.needsUpdate=!0}}MG.prototype.isCanvasTexture=!0;class SG extends qi{constructor(n,r,a,s,o,u,f,v,m,g){if(g=g!==void 0?g:oh,g!==oh&&g!==wd)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");a===void 0&&g===oh&&(a=Iv),a===void 0&&g===wd&&(a=xd);super(null,s,o,u,f,v,g,a,m);this.image={width:n,height:r},this.magFilter=f!==void 0?f:Xi,this.minFilter=v!==void 0?v:Xi,this.flipY=!1,this.generateMipmaps=!1}}SG.prototype.isDepthTexture=!0;class yg extends Zr{constructor(n=1,r=1,a=1,s=8,o=1,u=!1,f=0,v=Math.PI*2){super();this.type="CylinderGeometry",this.parameters={radiusTop:n,radiusBottom:r,height:a,radialSegments:s,heightSegments:o,openEnded:u,thetaStart:f,thetaLength:v};const m=this;s=Math.floor(s),o=Math.floor(o);const g=[],y=[],b=[],w=[];let A=0;const M=[],S=a/2;let E=0;T(),u===!1&&(n>0&&C(!0),r>0&&C(!1)),this.setIndex(g),this.setAttribute("position",new Xr(y,3)),this.setAttribute("normal",new Xr(b,3)),this.setAttribute("uv",new Xr(w,2));function T(){const L=new Ze,P=new Ze;let N=0;const F=(r-n)/a;for(let X=0;X<=o;X++){const Y=[],ae=X/o,$=ae*(r-n)+n;for(let de=0;de<=s;de++){const D=de/s,I=D*v+f,k=Math.sin(I),U=Math.cos(I);P.x=$*k,P.y=-ae*a+S,P.z=$*U,y.push(P.x,P.y,P.z),L.set(k,F,U).normalize(),b.push(L.x,L.y,L.z),w.push(D,1-ae),Y.push(A++)}M.push(Y)}for(let X=0;X<s;X++)for(let Y=0;Y<o;Y++){const ae=M[Y][X],$=M[Y+1][X],de=M[Y+1][X+1],D=M[Y][X+1];g.push(ae,$,D),g.push($,de,D),N+=6}m.addGroup(E,N,0),E+=N}function C(L){const P=A,N=new Wt,F=new Ze;let X=0;const Y=L===!0?n:r,ae=L===!0?1:-1;for(let de=1;de<=s;de++)y.push(0,S*ae,0),b.push(0,ae,0),w.push(.5,.5),A++;const $=A;for(let de=0;de<=s;de++){const I=de/s*v+f,k=Math.cos(I),U=Math.sin(I);F.x=Y*U,F.y=S*ae,F.z=Y*k,y.push(F.x,F.y,F.z),b.push(0,ae,0),N.x=k*.5+.5,N.y=U*.5*ae+.5,w.push(N.x,N.y),A++}for(let de=0;de<s;de++){const D=P+de,I=$+de;L===!0?g.push(I,I+1,D):g.push(I+1,I,D),X+=3}m.addGroup(E,X,L===!0?1:2),E+=X}}static fromJSON(n){return new yg(n.radiusTop,n.radiusBottom,n.height,n.radialSegments,n.heightSegments,n.openEnded,n.thetaStart,n.thetaLength)}}class Vx extends yg{constructor(n=1,r=1,a=8,s=1,o=!1,u=0,f=Math.PI*2){super(0,n,r,a,s,o,u,f);this.type="ConeGeometry",this.parameters={radius:n,height:r,radialSegments:a,heightSegments:s,openEnded:o,thetaStart:u,thetaLength:f}}static fromJSON(n){return new Vx(n.radius,n.height,n.radialSegments,n.heightSegments,n.openEnded,n.thetaStart,n.thetaLength)}}new Ze;new Ze;new Ze;new Hi;class fo{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(n,r){const a=this.getUtoTmapping(n);return this.getPoint(a,r)}getPoints(n=5){const r=[];for(let a=0;a<=n;a++)r.push(this.getPoint(a/n));return r}getSpacedPoints(n=5){const r=[];for(let a=0;a<=n;a++)r.push(this.getPointAt(a/n));return r}getLength(){const n=this.getLengths();return n[n.length-1]}getLengths(n=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===n+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const r=[];let a,s=this.getPoint(0),o=0;r.push(0);for(let u=1;u<=n;u++)a=this.getPoint(u/n),o+=a.distanceTo(s),r.push(o),s=a;return this.cacheArcLengths=r,r}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(n,r){const a=this.getLengths();let s=0;const o=a.length;let u;r?u=r:u=n*a[o-1];let f=0,v=o-1,m;for(;f<=v;)if(s=Math.floor(f+(v-f)/2),m=a[s]-u,m<0)f=s+1;else if(m>0)v=s-1;else{v=s;break}if(s=v,a[s]===u)return s/(o-1);const g=a[s],b=a[s+1]-g,w=(u-g)/b;return(s+w)/(o-1)}getTangent(n,r){const a=1e-4;let s=n-a,o=n+a;s<0&&(s=0),o>1&&(o=1);const u=this.getPoint(s),f=this.getPoint(o),v=r||(u.isVector2?new Wt:new Ze);return v.copy(f).sub(u).normalize(),v}getTangentAt(n,r){const a=this.getUtoTmapping(n);return this.getTangent(a,r)}computeFrenetFrames(n,r){const a=new Ze,s=[],o=[],u=[],f=new Ze,v=new jn;for(let w=0;w<=n;w++){const A=w/n;s[w]=this.getTangentAt(A,new Ze)}o[0]=new Ze,u[0]=new Ze;let m=Number.MAX_VALUE;const g=Math.abs(s[0].x),y=Math.abs(s[0].y),b=Math.abs(s[0].z);g<=m&&(m=g,a.set(1,0,0)),y<=m&&(m=y,a.set(0,1,0)),b<=m&&a.set(0,0,1),f.crossVectors(s[0],a).normalize(),o[0].crossVectors(s[0],f),u[0].crossVectors(s[0],o[0]);for(let w=1;w<=n;w++){if(o[w]=o[w-1].clone(),u[w]=u[w-1].clone(),f.crossVectors(s[w-1],s[w]),f.length()>Number.EPSILON){f.normalize();const A=Math.acos(Fa(s[w-1].dot(s[w]),-1,1));o[w].applyMatrix4(v.makeRotationAxis(f,A))}u[w].crossVectors(s[w],o[w])}if(r===!0){let w=Math.acos(Fa(o[0].dot(o[n]),-1,1));w/=n,s[0].dot(f.crossVectors(o[0],o[n]))>0&&(w=-w);for(let A=1;A<=n;A++)o[A].applyMatrix4(v.makeRotationAxis(s[A],w*A)),u[A].crossVectors(s[A],o[A])}return{tangents:s,normals:o,binormals:u}}clone(){return new this.constructor().copy(this)}copy(n){return this.arcLengthDivisions=n.arcLengthDivisions,this}toJSON(){const n={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return n.arcLengthDivisions=this.arcLengthDivisions,n.type=this.type,n}fromJSON(n){return this.arcLengthDivisions=n.arcLengthDivisions,this}}class bg extends fo{constructor(n=0,r=0,a=1,s=1,o=0,u=Math.PI*2,f=!1,v=0){super();this.type="EllipseCurve",this.aX=n,this.aY=r,this.xRadius=a,this.yRadius=s,this.aStartAngle=o,this.aEndAngle=u,this.aClockwise=f,this.aRotation=v}getPoint(n,r){const a=r||new Wt,s=Math.PI*2;let o=this.aEndAngle-this.aStartAngle;const u=Math.abs(o)<Number.EPSILON;for(;o<0;)o+=s;for(;o>s;)o-=s;o<Number.EPSILON&&(u?o=0:o=s),this.aClockwise===!0&&!u&&(o===s?o=-s:o=o-s);const f=this.aStartAngle+n*o;let v=this.aX+this.xRadius*Math.cos(f),m=this.aY+this.yRadius*Math.sin(f);if(this.aRotation!==0){const g=Math.cos(this.aRotation),y=Math.sin(this.aRotation),b=v-this.aX,w=m-this.aY;v=b*g-w*y+this.aX,m=b*y+w*g+this.aY}return a.set(v,m)}copy(n){return super.copy(n),this.aX=n.aX,this.aY=n.aY,this.xRadius=n.xRadius,this.yRadius=n.yRadius,this.aStartAngle=n.aStartAngle,this.aEndAngle=n.aEndAngle,this.aClockwise=n.aClockwise,this.aRotation=n.aRotation,this}toJSON(){const n=super.toJSON();return n.aX=this.aX,n.aY=this.aY,n.xRadius=this.xRadius,n.yRadius=this.yRadius,n.aStartAngle=this.aStartAngle,n.aEndAngle=this.aEndAngle,n.aClockwise=this.aClockwise,n.aRotation=this.aRotation,n}fromJSON(n){return super.fromJSON(n),this.aX=n.aX,this.aY=n.aY,this.xRadius=n.xRadius,this.yRadius=n.yRadius,this.aStartAngle=n.aStartAngle,this.aEndAngle=n.aEndAngle,this.aClockwise=n.aClockwise,this.aRotation=n.aRotation,this}}bg.prototype.isEllipseCurve=!0;class a2 extends bg{constructor(n,r,a,s,o,u){super(n,r,a,a,s,o,u);this.type="ArcCurve"}}a2.prototype.isArcCurve=!0;function Wx(){let i=0,n=0,r=0,a=0;function s(o,u,f,v){i=o,n=f,r=-3*o+3*u-2*f-v,a=2*o-2*u+f+v}return{initCatmullRom:function(o,u,f,v,m){s(u,f,m*(f-o),m*(v-u))},initNonuniformCatmullRom:function(o,u,f,v,m,g,y){let b=(u-o)/m-(f-o)/(m+g)+(f-u)/g,w=(f-u)/g-(v-u)/(g+y)+(v-f)/y;b*=g,w*=g,s(u,f,b,w)},calc:function(o){const u=o*o,f=u*o;return i+n*o+r*u+a*f}}}const xg=new Ze,jx=new Wx,Xx=new Wx,qx=new Wx;class o2 extends fo{constructor(n=[],r=!1,a="centripetal",s=.5){super();this.type="CatmullRomCurve3",this.points=n,this.closed=r,this.curveType=a,this.tension=s}getPoint(n,r=new Ze){const a=r,s=this.points,o=s.length,u=(o-(this.closed?0:1))*n;let f=Math.floor(u),v=u-f;this.closed?f+=f>0?0:(Math.floor(Math.abs(f)/o)+1)*o:v===0&&f===o-1&&(f=o-2,v=1);let m,g;this.closed||f>0?m=s[(f-1)%o]:(xg.subVectors(s[0],s[1]).add(s[0]),m=xg);const y=s[f%o],b=s[(f+1)%o];if(this.closed||f+2<o?g=s[(f+2)%o]:(xg.subVectors(s[o-1],s[o-2]).add(s[o-1]),g=xg),this.curveType==="centripetal"||this.curveType==="chordal"){const w=this.curveType==="chordal"?.5:.25;let A=Math.pow(m.distanceToSquared(y),w),M=Math.pow(y.distanceToSquared(b),w),S=Math.pow(b.distanceToSquared(g),w);M<1e-4&&(M=1),A<1e-4&&(A=M),S<1e-4&&(S=M),jx.initNonuniformCatmullRom(m.x,y.x,b.x,g.x,A,M,S),Xx.initNonuniformCatmullRom(m.y,y.y,b.y,g.y,A,M,S),qx.initNonuniformCatmullRom(m.z,y.z,b.z,g.z,A,M,S)}else this.curveType==="catmullrom"&&(jx.initCatmullRom(m.x,y.x,b.x,g.x,this.tension),Xx.initCatmullRom(m.y,y.y,b.y,g.y,this.tension),qx.initCatmullRom(m.z,y.z,b.z,g.z,this.tension));return a.set(jx.calc(v),Xx.calc(v),qx.calc(v)),a}copy(n){super.copy(n),this.points=[];for(let r=0,a=n.points.length;r<a;r++){const s=n.points[r];this.points.push(s.clone())}return this.closed=n.closed,this.curveType=n.curveType,this.tension=n.tension,this}toJSON(){const n=super.toJSON();n.points=[];for(let r=0,a=this.points.length;r<a;r++){const s=this.points[r];n.points.push(s.toArray())}return n.closed=this.closed,n.curveType=this.curveType,n.tension=this.tension,n}fromJSON(n){super.fromJSON(n),this.points=[];for(let r=0,a=n.points.length;r<a;r++){const s=n.points[r];this.points.push(new Ze().fromArray(s))}return this.closed=n.closed,this.curveType=n.curveType,this.tension=n.tension,this}}o2.prototype.isCatmullRomCurve3=!0;function s2(i,n,r,a,s){const o=(a-n)*.5,u=(s-r)*.5,f=i*i,v=i*f;return(2*r-2*a+o+u)*v+(-3*r+3*a-2*o-u)*f+o*i+r}function TG(i,n){const r=1-i;return r*r*n}function CG(i,n){return 2*(1-i)*i*n}function RG(i,n){return i*i*n}function Bd(i,n,r,a){return TG(i,n)+CG(i,r)+RG(i,a)}function LG(i,n){const r=1-i;return r*r*r*n}function PG(i,n){const r=1-i;return 3*r*r*i*n}function DG(i,n){return 3*(1-i)*i*i*n}function OG(i,n){return i*i*i*n}function Nd(i,n,r,a,s){return LG(i,n)+PG(i,r)+DG(i,a)+OG(i,s)}class Yx extends fo{constructor(n=new Wt,r=new Wt,a=new Wt,s=new Wt){super();this.type="CubicBezierCurve",this.v0=n,this.v1=r,this.v2=a,this.v3=s}getPoint(n,r=new Wt){const a=r,s=this.v0,o=this.v1,u=this.v2,f=this.v3;return a.set(Nd(n,s.x,o.x,u.x,f.x),Nd(n,s.y,o.y,u.y,f.y)),a}copy(n){return super.copy(n),this.v0.copy(n.v0),this.v1.copy(n.v1),this.v2.copy(n.v2),this.v3.copy(n.v3),this}toJSON(){const n=super.toJSON();return n.v0=this.v0.toArray(),n.v1=this.v1.toArray(),n.v2=this.v2.toArray(),n.v3=this.v3.toArray(),n}fromJSON(n){return super.fromJSON(n),this.v0.fromArray(n.v0),this.v1.fromArray(n.v1),this.v2.fromArray(n.v2),this.v3.fromArray(n.v3),this}}Yx.prototype.isCubicBezierCurve=!0;class $x extends fo{constructor(n=new Ze,r=new Ze,a=new Ze,s=new Ze){super();this.type="CubicBezierCurve3",this.v0=n,this.v1=r,this.v2=a,this.v3=s}getPoint(n,r=new Ze){const a=r,s=this.v0,o=this.v1,u=this.v2,f=this.v3;return a.set(Nd(n,s.x,o.x,u.x,f.x),Nd(n,s.y,o.y,u.y,f.y),Nd(n,s.z,o.z,u.z,f.z)),a}copy(n){return super.copy(n),this.v0.copy(n.v0),this.v1.copy(n.v1),this.v2.copy(n.v2),this.v3.copy(n.v3),this}toJSON(){const n=super.toJSON();return n.v0=this.v0.toArray(),n.v1=this.v1.toArray(),n.v2=this.v2.toArray(),n.v3=this.v3.toArray(),n}fromJSON(n){return super.fromJSON(n),this.v0.fromArray(n.v0),this.v1.fromArray(n.v1),this.v2.fromArray(n.v2),this.v3.fromArray(n.v3),this}}$x.prototype.isCubicBezierCurve3=!0;class wg extends fo{constructor(n=new Wt,r=new Wt){super();this.type="LineCurve",this.v1=n,this.v2=r}getPoint(n,r=new Wt){const a=r;return n===1?a.copy(this.v2):(a.copy(this.v2).sub(this.v1),a.multiplyScalar(n).add(this.v1)),a}getPointAt(n,r){return this.getPoint(n,r)}getTangent(n,r){const a=r||new Wt;return a.copy(this.v2).sub(this.v1).normalize(),a}copy(n){return super.copy(n),this.v1.copy(n.v1),this.v2.copy(n.v2),this}toJSON(){const n=super.toJSON();return n.v1=this.v1.toArray(),n.v2=this.v2.toArray(),n}fromJSON(n){return super.fromJSON(n),this.v1.fromArray(n.v1),this.v2.fromArray(n.v2),this}}wg.prototype.isLineCurve=!0;class IG extends fo{constructor(n=new Ze,r=new Ze){super();this.type="LineCurve3",this.isLineCurve3=!0,this.v1=n,this.v2=r}getPoint(n,r=new Ze){const a=r;return n===1?a.copy(this.v2):(a.copy(this.v2).sub(this.v1),a.multiplyScalar(n).add(this.v1)),a}getPointAt(n,r){return this.getPoint(n,r)}copy(n){return super.copy(n),this.v1.copy(n.v1),this.v2.copy(n.v2),this}toJSON(){const n=super.toJSON();return n.v1=this.v1.toArray(),n.v2=this.v2.toArray(),n}fromJSON(n){return super.fromJSON(n),this.v1.fromArray(n.v1),this.v2.fromArray(n.v2),this}}class Kx extends fo{constructor(n=new Wt,r=new Wt,a=new Wt){super();this.type="QuadraticBezierCurve",this.v0=n,this.v1=r,this.v2=a}getPoint(n,r=new Wt){const a=r,s=this.v0,o=this.v1,u=this.v2;return a.set(Bd(n,s.x,o.x,u.x),Bd(n,s.y,o.y,u.y)),a}copy(n){return super.copy(n),this.v0.copy(n.v0),this.v1.copy(n.v1),this.v2.copy(n.v2),this}toJSON(){const n=super.toJSON();return n.v0=this.v0.toArray(),n.v1=this.v1.toArray(),n.v2=this.v2.toArray(),n}fromJSON(n){return super.fromJSON(n),this.v0.fromArray(n.v0),this.v1.fromArray(n.v1),this.v2.fromArray(n.v2),this}}Kx.prototype.isQuadraticBezierCurve=!0;class Ag extends fo{constructor(n=new Ze,r=new Ze,a=new Ze){super();this.type="QuadraticBezierCurve3",this.v0=n,this.v1=r,this.v2=a}getPoint(n,r=new Ze){const a=r,s=this.v0,o=this.v1,u=this.v2;return a.set(Bd(n,s.x,o.x,u.x),Bd(n,s.y,o.y,u.y),Bd(n,s.z,o.z,u.z)),a}copy(n){return super.copy(n),this.v0.copy(n.v0),this.v1.copy(n.v1),this.v2.copy(n.v2),this}toJSON(){const n=super.toJSON();return n.v0=this.v0.toArray(),n.v1=this.v1.toArray(),n.v2=this.v2.toArray(),n}fromJSON(n){return super.fromJSON(n),this.v0.fromArray(n.v0),this.v1.fromArray(n.v1),this.v2.fromArray(n.v2),this}}Ag.prototype.isQuadraticBezierCurve3=!0;class Zx extends fo{constructor(n=[]){super();this.type="SplineCurve",this.points=n}getPoint(n,r=new Wt){const a=r,s=this.points,o=(s.length-1)*n,u=Math.floor(o),f=o-u,v=s[u===0?u:u-1],m=s[u],g=s[u>s.length-2?s.length-1:u+1],y=s[u>s.length-3?s.length-1:u+2];return a.set(s2(f,v.x,m.x,g.x,y.x),s2(f,v.y,m.y,g.y,y.y)),a}copy(n){super.copy(n),this.points=[];for(let r=0,a=n.points.length;r<a;r++){const s=n.points[r];this.points.push(s.clone())}return this}toJSON(){const n=super.toJSON();n.points=[];for(let r=0,a=this.points.length;r<a;r++){const s=this.points[r];n.points.push(s.toArray())}return n}fromJSON(n){super.fromJSON(n),this.points=[];for(let r=0,a=n.points.length;r<a;r++){const s=n.points[r];this.points.push(new Wt().fromArray(s))}return this}}Zx.prototype.isSplineCurve=!0;var Qx=Object.freeze({__proto__:null,ArcCurve:a2,CatmullRomCurve3:o2,CubicBezierCurve:Yx,CubicBezierCurve3:$x,EllipseCurve:bg,LineCurve:wg,LineCurve3:IG,QuadraticBezierCurve:Kx,QuadraticBezierCurve3:Ag,SplineCurve:Zx});class kG extends fo{constructor(){super();this.type="CurvePath",this.curves=[],this.autoClose=!1}add(n){this.curves.push(n)}closePath(){const n=this.curves[0].getPoint(0),r=this.curves[this.curves.length-1].getPoint(1);n.equals(r)||this.curves.push(new wg(r,n))}getPoint(n,r){const a=n*this.getLength(),s=this.getCurveLengths();let o=0;for(;o<s.length;){if(s[o]>=a){const u=s[o]-a,f=this.curves[o],v=f.getLength(),m=v===0?0:1-u/v;return f.getPointAt(m,r)}o++}return null}getLength(){const n=this.getCurveLengths();return n[n.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const n=[];let r=0;for(let a=0,s=this.curves.length;a<s;a++)r+=this.curves[a].getLength(),n.push(r);return this.cacheLengths=n,n}getSpacedPoints(n=40){const r=[];for(let a=0;a<=n;a++)r.push(this.getPoint(a/n));return this.autoClose&&r.push(r[0]),r}getPoints(n=12){const r=[];let a;for(let s=0,o=this.curves;s<o.length;s++){const u=o[s],f=u&&u.isEllipseCurve?n*2:u&&(u.isLineCurve||u.isLineCurve3)?1:u&&u.isSplineCurve?n*u.points.length:n,v=u.getPoints(f);for(let m=0;m<v.length;m++){const g=v[m];a&&a.equals(g)||(r.push(g),a=g)}}return this.autoClose&&r.length>1&&!r[r.length-1].equals(r[0])&&r.push(r[0]),r}copy(n){super.copy(n),this.curves=[];for(let r=0,a=n.curves.length;r<a;r++){const s=n.curves[r];this.curves.push(s.clone())}return this.autoClose=n.autoClose,this}toJSON(){const n=super.toJSON();n.autoClose=this.autoClose,n.curves=[];for(let r=0,a=this.curves.length;r<a;r++){const s=this.curves[r];n.curves.push(s.toJSON())}return n}fromJSON(n){super.fromJSON(n),this.autoClose=n.autoClose,this.curves=[];for(let r=0,a=n.curves.length;r<a;r++){const s=n.curves[r];this.curves.push(new Qx[s.type]().fromJSON(s))}return this}}class Jx extends kG{constructor(n){super();this.type="Path",this.currentPoint=new Wt,n&&this.setFromPoints(n)}setFromPoints(n){this.moveTo(n[0].x,n[0].y);for(let r=1,a=n.length;r<a;r++)this.lineTo(n[r].x,n[r].y);return this}moveTo(n,r){return this.currentPoint.set(n,r),this}lineTo(n,r){const a=new wg(this.currentPoint.clone(),new Wt(n,r));return this.curves.push(a),this.currentPoint.set(n,r),this}quadraticCurveTo(n,r,a,s){const o=new Kx(this.currentPoint.clone(),new Wt(n,r),new Wt(a,s));return this.curves.push(o),this.currentPoint.set(a,s),this}bezierCurveTo(n,r,a,s,o,u){const f=new Yx(this.currentPoint.clone(),new Wt(n,r),new Wt(a,s),new Wt(o,u));return this.curves.push(f),this.currentPoint.set(o,u),this}splineThru(n){const r=[this.currentPoint.clone()].concat(n),a=new Zx(r);return this.curves.push(a),this.currentPoint.copy(n[n.length-1]),this}arc(n,r,a,s,o,u){const f=this.currentPoint.x,v=this.currentPoint.y;return this.absarc(n+f,r+v,a,s,o,u),this}absarc(n,r,a,s,o,u){return this.absellipse(n,r,a,a,s,o,u),this}ellipse(n,r,a,s,o,u,f,v){const m=this.currentPoint.x,g=this.currentPoint.y;return this.absellipse(n+m,r+g,a,s,o,u,f,v),this}absellipse(n,r,a,s,o,u,f,v){const m=new bg(n,r,a,s,o,u,f,v);if(this.curves.length>0){const y=m.getPoint(0);y.equals(this.currentPoint)||this.lineTo(y.x,y.y)}this.curves.push(m);const g=m.getPoint(1);return this.currentPoint.copy(g),this}copy(n){return super.copy(n),this.currentPoint.copy(n.currentPoint),this}toJSON(){const n=super.toJSON();return n.currentPoint=this.currentPoint.toArray(),n}fromJSON(n){return super.fromJSON(n),this.currentPoint.fromArray(n.currentPoint),this}}class Ud extends Jx{constructor(n){super(n);this.uuid=is(),this.type="Shape",this.holes=[]}getPointsHoles(n){const r=[];for(let a=0,s=this.holes.length;a<s;a++)r[a]=this.holes[a].getPoints(n);return r}extractPoints(n){return{shape:this.getPoints(n),holes:this.getPointsHoles(n)}}copy(n){super.copy(n),this.holes=[];for(let r=0,a=n.holes.length;r<a;r++){const s=n.holes[r];this.holes.push(s.clone())}return this}toJSON(){const n=super.toJSON();n.uuid=this.uuid,n.holes=[];for(let r=0,a=this.holes.length;r<a;r++){const s=this.holes[r];n.holes.push(s.toJSON())}return n}fromJSON(n){super.fromJSON(n),this.uuid=n.uuid,this.holes=[];for(let r=0,a=n.holes.length;r<a;r++){const s=n.holes[r];this.holes.push(new Jx().fromJSON(s))}return this}}const FG={triangulate:function(i,n,r=2){const a=n&&n.length,s=a?n[0]*r:i.length;let o=l2(i,0,s,r,!0);const u=[];if(!o||o.next===o.prev)return u;let f,v,m,g,y,b,w;if(a&&(o=zG(i,n,o,r)),i.length>80*r){f=m=i[0],v=g=i[1];for(let A=r;A<s;A+=r)y=i[A],b=i[A+1],y<f&&(f=y),b<v&&(v=b),y>m&&(m=y),b>g&&(g=b);w=Math.max(m-f,g-v),w=w!==0?1/w:0}return Hd(o,u,r,f,v,w),u}};function l2(i,n,r,a,s){let o,u;if(s===QG(i,n,r,a)>0)for(o=n;o<r;o+=a)u=h2(o,i[o],i[o+1],u);else for(o=r-a;o>=n;o-=a)u=h2(o,i[o],i[o+1],u);return u&&Eg(u,u.next)&&(Gd(u),u=u.next),u}function Wl(i,n){if(!i)return i;n||(n=i);let r=i,a;do if(a=!1,!r.steiner&&(Eg(r,r.next)||Ei(r.prev,r,r.next)===0)){if(Gd(r),r=n=r.prev,r===r.next)break;a=!0}else r=r.next;while(a||r!==n);return n}function Hd(i,n,r,a,s,o,u){if(!i)return;!u&&o&&XG(i,a,s,o);let f=i,v,m;for(;i.prev!==i.next;){if(v=i.prev,m=i.next,o?NG(i,a,s,o):BG(i)){n.push(v.i/r),n.push(i.i/r),n.push(m.i/r),Gd(i),i=m.next,f=m.next;continue}if(i=m,i===f){u?u===1?(i=UG(Wl(i),n,r),Hd(i,n,r,a,s,o,2)):u===2&&HG(i,n,r,a,s,o):Hd(Wl(i),n,r,a,s,o,1);break}}}function BG(i){const n=i.prev,r=i,a=i.next;if(Ei(n,r,a)>=0)return!1;let s=i.next.next;for(;s!==i.prev;){if(Fh(n.x,n.y,r.x,r.y,a.x,a.y,s.x,s.y)&&Ei(s.prev,s,s.next)>=0)return!1;s=s.next}return!0}function NG(i,n,r,a){const s=i.prev,o=i,u=i.next;if(Ei(s,o,u)>=0)return!1;const f=s.x<o.x?s.x<u.x?s.x:u.x:o.x<u.x?o.x:u.x,v=s.y<o.y?s.y<u.y?s.y:u.y:o.y<u.y?o.y:u.y,m=s.x>o.x?s.x>u.x?s.x:u.x:o.x>u.x?o.x:u.x,g=s.y>o.y?s.y>u.y?s.y:u.y:o.y>u.y?o.y:u.y,y=e1(f,v,n,r,a),b=e1(m,g,n,r,a);let w=i.prevZ,A=i.nextZ;for(;w&&w.z>=y&&A&&A.z<=b;){if(w!==i.prev&&w!==i.next&&Fh(s.x,s.y,o.x,o.y,u.x,u.y,w.x,w.y)&&Ei(w.prev,w,w.next)>=0||(w=w.prevZ,A!==i.prev&&A!==i.next&&Fh(s.x,s.y,o.x,o.y,u.x,u.y,A.x,A.y)&&Ei(A.prev,A,A.next)>=0))return!1;A=A.nextZ}for(;w&&w.z>=y;){if(w!==i.prev&&w!==i.next&&Fh(s.x,s.y,o.x,o.y,u.x,u.y,w.x,w.y)&&Ei(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;A&&A.z<=b;){if(A!==i.prev&&A!==i.next&&Fh(s.x,s.y,o.x,o.y,u.x,u.y,A.x,A.y)&&Ei(A.prev,A,A.next)>=0)return!1;A=A.nextZ}return!0}function UG(i,n,r){let a=i;do{const s=a.prev,o=a.next.next;!Eg(s,o)&&c2(s,a,a.next,o)&&zd(s,o)&&zd(o,s)&&(n.push(s.i/r),n.push(a.i/r),n.push(o.i/r),Gd(a),Gd(a.next),a=i=o),a=a.next}while(a!==i);return Wl(a)}function HG(i,n,r,a,s,o){let u=i;do{let f=u.next.next;for(;f!==u.prev;){if(u.i!==f.i&&$G(u,f)){let v=u2(u,f);u=Wl(u,u.next),v=Wl(v,v.next),Hd(u,n,r,a,s,o),Hd(v,n,r,a,s,o);return}f=f.next}u=u.next}while(u!==i)}function zG(i,n,r,a){const s=[];let o,u,f,v,m;for(o=0,u=n.length;o<u;o++)f=n[o]*a,v=o<u-1?n[o+1]*a:i.length,m=l2(i,f,v,a,!1),m===m.next&&(m.steiner=!0),s.push(YG(m));for(s.sort(GG),o=0;o<s.length;o++)VG(s[o],r),r=Wl(r,r.next);return r}function GG(i,n){return i.x-n.x}function VG(i,n){if(n=WG(i,n),n){const r=u2(n,i);Wl(n,n.next),Wl(r,r.next)}}function WG(i,n){let r=n;const a=i.x,s=i.y;let o=-1/0,u;do{if(s<=r.y&&s>=r.next.y&&r.next.y!==r.y){const b=r.x+(s-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(b<=a&&b>o){if(o=b,b===a){if(s===r.y)return r;if(s===r.next.y)return r.next}u=r.x<r.next.x?r:r.next}}r=r.next}while(r!==n);if(!u)return null;if(a===o)return u;const f=u,v=u.x,m=u.y;let g=1/0,y;r=u;do a>=r.x&&r.x>=v&&a!==r.x&&Fh(s<m?a:o,s,v,m,s<m?o:a,s,r.x,r.y)&&(y=Math.abs(s-r.y)/(a-r.x),zd(r,i)&&(y<g||y===g&&(r.x>u.x||r.x===u.x&&jG(u,r)))&&(u=r,g=y)),r=r.next;while(r!==f);return u}function jG(i,n){return Ei(i.prev,i,n.prev)<0&&Ei(n.next,i,i.next)<0}function XG(i,n,r,a){let s=i;do s.z===null&&(s.z=e1(s.x,s.y,n,r,a)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==i);s.prevZ.nextZ=null,s.prevZ=null,qG(s)}function qG(i){let n,r,a,s,o,u,f,v,m=1;do{for(r=i,i=null,o=null,u=0;r;){for(u++,a=r,f=0,n=0;n<m&&(f++,a=a.nextZ,!!a);n++);for(v=m;f>0||v>0&&a;)f!==0&&(v===0||!a||r.z<=a.z)?(s=r,r=r.nextZ,f--):(s=a,a=a.nextZ,v--),o?o.nextZ=s:i=s,s.prevZ=o,o=s;r=a}o.nextZ=null,m*=2}while(u>1);return i}function e1(i,n,r,a,s){return i=32767*(i-r)*s,n=32767*(n-a)*s,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,i|n<<1}function YG(i){let n=i,r=i;do(n.x<r.x||n.x===r.x&&n.y<r.y)&&(r=n),n=n.next;while(n!==i);return r}function Fh(i,n,r,a,s,o,u,f){return(s-u)*(n-f)-(i-u)*(o-f)>=0&&(i-u)*(a-f)-(r-u)*(n-f)>=0&&(r-u)*(o-f)-(s-u)*(a-f)>=0}function $G(i,n){return i.next.i!==n.i&&i.prev.i!==n.i&&!KG(i,n)&&(zd(i,n)&&zd(n,i)&&ZG(i,n)&&(Ei(i.prev,i,n.prev)||Ei(i,n.prev,n))||Eg(i,n)&&Ei(i.prev,i,i.next)>0&&Ei(n.prev,n,n.next)>0)}function Ei(i,n,r){return(n.y-i.y)*(r.x-n.x)-(n.x-i.x)*(r.y-n.y)}function Eg(i,n){return i.x===n.x&&i.y===n.y}function c2(i,n,r,a){const s=Mg(Ei(i,n,r)),o=Mg(Ei(i,n,a)),u=Mg(Ei(r,a,i)),f=Mg(Ei(r,a,n));return!!(s!==o&&u!==f||s===0&&_g(i,r,n)||o===0&&_g(i,a,n)||u===0&&_g(r,i,a)||f===0&&_g(r,n,a))}function _g(i,n,r){return n.x<=Math.max(i.x,r.x)&&n.x>=Math.min(i.x,r.x)&&n.y<=Math.max(i.y,r.y)&&n.y>=Math.min(i.y,r.y)}function Mg(i){return i>0?1:i<0?-1:0}function KG(i,n){let r=i;do{if(r.i!==i.i&&r.next.i!==i.i&&r.i!==n.i&&r.next.i!==n.i&&c2(r,r.next,i,n))return!0;r=r.next}while(r!==i);return!1}function zd(i,n){return Ei(i.prev,i,i.next)<0?Ei(i,n,i.next)>=0&&Ei(i,i.prev,n)>=0:Ei(i,n,i.prev)<0||Ei(i,i.next,n)<0}function ZG(i,n){let r=i,a=!1;const s=(i.x+n.x)/2,o=(i.y+n.y)/2;do r.y>o!=r.next.y>o&&r.next.y!==r.y&&s<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(a=!a),r=r.next;while(r!==i);return a}function u2(i,n){const r=new t1(i.i,i.x,i.y),a=new t1(n.i,n.x,n.y),s=i.next,o=n.prev;return i.next=n,n.prev=i,r.next=s,s.prev=r,a.next=r,r.prev=a,o.next=a,a.prev=o,a}function h2(i,n,r,a){const s=new t1(i,n,r);return a?(s.next=a.next,s.prev=a,a.next.prev=s,a.next=s):(s.prev=s,s.next=s),s}function Gd(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function t1(i,n,r){this.i=i,this.x=n,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function QG(i,n,r,a){let s=0;for(let o=n,u=r-a;o<r;o+=a)s+=(i[u]-i[o])*(i[o+1]+i[u+1]),u=o;return s}class jl{static area(n){const r=n.length;let a=0;for(let s=r-1,o=0;o<r;s=o++)a+=n[s].x*n[o].y-n[o].x*n[s].y;return a*.5}static isClockWise(n){return jl.area(n)<0}static triangulateShape(n,r){const a=[],s=[],o=[];f2(n),d2(a,n);let u=n.length;r.forEach(f2);for(let v=0;v<r.length;v++)s.push(u),u+=r[v].length,d2(a,r[v]);const f=FG.triangulate(a,s);for(let v=0;v<f.length;v+=3)o.push(f.slice(v,v+3));return o}}function f2(i){const n=i.length;n>2&&i[n-1].equals(i[0])&&i.pop()}function d2(i,n){for(let r=0;r<n.length;r++)i.push(n[r].x),i.push(n[r].y)}class Bh extends Zr{constructor(n=new Ud([new Wt(.5,.5),new Wt(-.5,.5),new Wt(-.5,-.5),new Wt(.5,-.5)]),r={}){super();this.type="ExtrudeGeometry",this.parameters={shapes:n,options:r},n=Array.isArray(n)?n:[n];const a=this,s=[],o=[];for(let f=0,v=n.length;f<v;f++){const m=n[f];u(m)}this.setAttribute("position",new Xr(s,3)),this.setAttribute("uv",new Xr(o,2)),this.computeVertexNormals();function u(f){const v=[],m=r.curveSegments!==void 0?r.curveSegments:12,g=r.steps!==void 0?r.steps:1;let y=r.depth!==void 0?r.depth:1,b=r.bevelEnabled!==void 0?r.bevelEnabled:!0,w=r.bevelThickness!==void 0?r.bevelThickness:.2,A=r.bevelSize!==void 0?r.bevelSize:w-.1,M=r.bevelOffset!==void 0?r.bevelOffset:0,S=r.bevelSegments!==void 0?r.bevelSegments:3;const E=r.extrudePath,T=r.UVGenerator!==void 0?r.UVGenerator:JG;r.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),y=r.amount);let C,L=!1,P,N,F,X;E&&(C=E.getSpacedPoints(g),L=!0,b=!1,P=E.computeFrenetFrames(g,!1),N=new Ze,F=new Ze,X=new Ze),b||(S=0,w=0,A=0,M=0);const Y=f.extractPoints(m);let ae=Y.shape;const $=Y.holes;if(!jl.isClockWise(ae)){ae=ae.reverse();for(let fe=0,H=$.length;fe<H;fe++){const j=$[fe];jl.isClockWise(j)&&($[fe]=j.reverse())}}const D=jl.triangulateShape(ae,$),I=ae;for(let fe=0,H=$.length;fe<H;fe++){const j=$[fe];ae=ae.concat(j)}function k(fe,H,j){return H||console.error("THREE.ExtrudeGeometry: vec does not exist"),H.clone().multiplyScalar(j).add(fe)}const U=ae.length,W=D.length;function ce(fe,H,j){let q,pe,ee;const te=fe.x-H.x,Se=fe.y-H.y,ke=j.x-fe.x,Be=j.y-fe.y,We=te*te+Se*Se,ve=te*Be-Se*ke;if(Math.abs(ve)>Number.EPSILON){const K=Math.sqrt(We),J=Math.sqrt(ke*ke+Be*Be),Ee=H.x-Se/K,xe=H.y+te/K,Je=j.x-Be/J,Xe=j.y+ke/J,Mt=((Je-Ee)*Be-(Xe-xe)*ke)/(te*Be-Se*ke);q=Ee+te*Mt-fe.x,pe=xe+Se*Mt-fe.y;const qe=q*q+pe*pe;if(qe<=2)return new Wt(q,pe);ee=Math.sqrt(qe/2)}else{let K=!1;te>Number.EPSILON?ke>Number.EPSILON&&(K=!0):te<-Number.EPSILON?ke<-Number.EPSILON&&(K=!0):Math.sign(Se)===Math.sign(Be)&&(K=!0),K?(q=-Se,pe=te,ee=Math.sqrt(We)):(q=te,pe=Se,ee=Math.sqrt(We/2))}return new Wt(q/ee,pe/ee)}const oe=[];for(let fe=0,H=I.length,j=H-1,q=fe+1;fe<H;fe++,j++,q++)j===H&&(j=0),q===H&&(q=0),oe[fe]=ce(I[fe],I[j],I[q]);const ge=[];let _e,Ne=oe.concat();for(let fe=0,H=$.length;fe<H;fe++){const j=$[fe];_e=[];for(let q=0,pe=j.length,ee=pe-1,te=q+1;q<pe;q++,ee++,te++)ee===pe&&(ee=0),te===pe&&(te=0),_e[q]=ce(j[q],j[ee],j[te]);ge.push(_e),Ne=Ne.concat(_e)}for(let fe=0;fe<S;fe++){const H=fe/S,j=w*Math.cos(H*Math.PI/2),q=A*Math.sin(H*Math.PI/2)+M;for(let pe=0,ee=I.length;pe<ee;pe++){const te=k(I[pe],oe[pe],q);Me(te.x,te.y,-j)}for(let pe=0,ee=$.length;pe<ee;pe++){const te=$[pe];_e=ge[pe];for(let Se=0,ke=te.length;Se<ke;Se++){const Be=k(te[Se],_e[Se],q);Me(Be.x,Be.y,-j)}}}const Ie=A+M;for(let fe=0;fe<U;fe++){const H=b?k(ae[fe],Ne[fe],Ie):ae[fe];L?(F.copy(P.normals[0]).multiplyScalar(H.x),N.copy(P.binormals[0]).multiplyScalar(H.y),X.copy(C[0]).add(F).add(N),Me(X.x,X.y,X.z)):Me(H.x,H.y,0)}for(let fe=1;fe<=g;fe++)for(let H=0;H<U;H++){const j=b?k(ae[H],Ne[H],Ie):ae[H];L?(F.copy(P.normals[fe]).multiplyScalar(j.x),N.copy(P.binormals[fe]).multiplyScalar(j.y),X.copy(C[fe]).add(F).add(N),Me(X.x,X.y,X.z)):Me(j.x,j.y,y/g*fe)}for(let fe=S-1;fe>=0;fe--){const H=fe/S,j=w*Math.cos(H*Math.PI/2),q=A*Math.sin(H*Math.PI/2)+M;for(let pe=0,ee=I.length;pe<ee;pe++){const te=k(I[pe],oe[pe],q);Me(te.x,te.y,y+j)}for(let pe=0,ee=$.length;pe<ee;pe++){const te=$[pe];_e=ge[pe];for(let Se=0,ke=te.length;Se<ke;Se++){const Be=k(te[Se],_e[Se],q);L?Me(Be.x,Be.y+C[g-1].y,C[g-1].x+j):Me(Be.x,Be.y,y+j)}}}Ve(),Le();function Ve(){const fe=s.length/3;if(b){let H=0,j=U*H;for(let q=0;q<W;q++){const pe=D[q];Qe(pe[2]+j,pe[1]+j,pe[0]+j)}H=g+S*2,j=U*H;for(let q=0;q<W;q++){const pe=D[q];Qe(pe[0]+j,pe[1]+j,pe[2]+j)}}else{for(let H=0;H<W;H++){const j=D[H];Qe(j[2],j[1],j[0])}for(let H=0;H<W;H++){const j=D[H];Qe(j[0]+U*g,j[1]+U*g,j[2]+U*g)}}a.addGroup(fe,s.length/3-fe,0)}function Le(){const fe=s.length/3;let H=0;Fe(I,H),H+=I.length;for(let j=0,q=$.length;j<q;j++){const pe=$[j];Fe(pe,H),H+=pe.length}a.addGroup(fe,s.length/3-fe,1)}function Fe(fe,H){let j=fe.length;for(;--j>=0;){const q=j;let pe=j-1;pe<0&&(pe=fe.length-1);for(let ee=0,te=g+S*2;ee<te;ee++){const Se=U*ee,ke=U*(ee+1),Be=H+q+Se,We=H+pe+Se,ve=H+pe+ke,K=H+q+ke;mt(Be,We,ve,K)}}}function Me(fe,H,j){v.push(fe),v.push(H),v.push(j)}function Qe(fe,H,j){ht(fe),ht(H),ht(j);const q=s.length/3,pe=T.generateTopUV(a,s,q-3,q-2,q-1);ye(pe[0]),ye(pe[1]),ye(pe[2])}function mt(fe,H,j,q){ht(fe),ht(H),ht(q),ht(H),ht(j),ht(q);const pe=s.length/3,ee=T.generateSideWallUV(a,s,pe-6,pe-3,pe-2,pe-1);ye(ee[0]),ye(ee[1]),ye(ee[3]),ye(ee[1]),ye(ee[2]),ye(ee[3])}function ht(fe){s.push(v[fe*3+0]),s.push(v[fe*3+1]),s.push(v[fe*3+2])}function ye(fe){o.push(fe.x),o.push(fe.y)}}}toJSON(){const n=super.toJSON(),r=this.parameters.shapes,a=this.parameters.options;return eV(r,a,n)}static fromJSON(n,r){const a=[];for(let o=0,u=n.shapes.length;o<u;o++){const f=r[n.shapes[o]];a.push(f)}const s=n.options.extrudePath;return s!==void 0&&(n.options.extrudePath=new Qx[s.type]().fromJSON(s)),new Bh(a,n.options)}}const JG={generateTopUV:function(i,n,r,a,s){const o=n[r*3],u=n[r*3+1],f=n[a*3],v=n[a*3+1],m=n[s*3],g=n[s*3+1];return[new Wt(o,u),new Wt(f,v),new Wt(m,g)]},generateSideWallUV:function(i,n,r,a,s,o){const u=n[r*3],f=n[r*3+1],v=n[r*3+2],m=n[a*3],g=n[a*3+1],y=n[a*3+2],b=n[s*3],w=n[s*3+1],A=n[s*3+2],M=n[o*3],S=n[o*3+1],E=n[o*3+2];return Math.abs(f-g)<Math.abs(u-m)?[new Wt(u,1-v),new Wt(m,1-y),new Wt(b,1-A),new Wt(M,1-E)]:[new Wt(f,1-v),new Wt(g,1-y),new Wt(w,1-A),new Wt(S,1-E)]}};function eV(i,n,r){if(r.shapes=[],Array.isArray(i))for(let a=0,s=i.length;a<s;a++){const o=i[a];r.shapes.push(o.uuid)}else r.shapes.push(i.uuid);return n.extrudePath!==void 0&&(r.options.extrudePath=n.extrudePath.toJSON()),r}class n1 extends Zr{constructor(n=new Ud([new Wt(0,.5),new Wt(-.5,-.5),new Wt(.5,-.5)]),r=12){super();this.type="ShapeGeometry",this.parameters={shapes:n,curveSegments:r};const a=[],s=[],o=[],u=[];let f=0,v=0;if(Array.isArray(n)===!1)m(n);else for(let g=0;g<n.length;g++)m(n[g]),this.addGroup(f,v,g),f+=v,v=0;this.setIndex(a),this.setAttribute("position",new Xr(s,3)),this.setAttribute("normal",new Xr(o,3)),this.setAttribute("uv",new Xr(u,2));function m(g){const y=s.length/3,b=g.extractPoints(r);let w=b.shape;const A=b.holes;jl.isClockWise(w)===!1&&(w=w.reverse());for(let S=0,E=A.length;S<E;S++){const T=A[S];jl.isClockWise(T)===!0&&(A[S]=T.reverse())}const M=jl.triangulateShape(w,A);for(let S=0,E=A.length;S<E;S++){const T=A[S];w=w.concat(T)}for(let S=0,E=w.length;S<E;S++){const T=w[S];s.push(T.x,T.y,0),o.push(0,0,1),u.push(T.x,T.y)}for(let S=0,E=M.length;S<E;S++){const T=M[S],C=T[0]+y,L=T[1]+y,P=T[2]+y;a.push(C,L,P),v+=3}}}toJSON(){const n=super.toJSON(),r=this.parameters.shapes;return tV(r,n)}static fromJSON(n,r){const a=[];for(let s=0,o=n.shapes.length;s<o;s++){const u=r[n.shapes[s]];a.push(u)}return new n1(a,n.curveSegments)}}function tV(i,n){if(n.shapes=[],Array.isArray(i))for(let r=0,a=i.length;r<a;r++){const s=i[r];n.shapes.push(s.uuid)}else n.shapes.push(i.uuid);return n}class Sg extends Zr{constructor(n=1,r=32,a=16,s=0,o=Math.PI*2,u=0,f=Math.PI){super();this.type="SphereGeometry",this.parameters={radius:n,widthSegments:r,heightSegments:a,phiStart:s,phiLength:o,thetaStart:u,thetaLength:f},r=Math.max(3,Math.floor(r)),a=Math.max(2,Math.floor(a));const v=Math.min(u+f,Math.PI);let m=0;const g=[],y=new Ze,b=new Ze,w=[],A=[],M=[],S=[];for(let E=0;E<=a;E++){const T=[],C=E/a;let L=0;E==0&&u==0?L=.5/r:E==a&&v==Math.PI&&(L=-.5/r);for(let P=0;P<=r;P++){const N=P/r;y.x=-n*Math.cos(s+N*o)*Math.sin(u+C*f),y.y=n*Math.cos(u+C*f),y.z=n*Math.sin(s+N*o)*Math.sin(u+C*f),A.push(y.x,y.y,y.z),b.copy(y).normalize(),M.push(b.x,b.y,b.z),S.push(N+L,1-C),T.push(m++)}g.push(T)}for(let E=0;E<a;E++)for(let T=0;T<r;T++){const C=g[E][T+1],L=g[E][T],P=g[E+1][T],N=g[E+1][T+1];(E!==0||u>0)&&w.push(C,L,N),(E!==a-1||v<Math.PI)&&w.push(L,P,N)}this.setIndex(w),this.setAttribute("position",new Xr(A,3)),this.setAttribute("normal",new Xr(M,3)),this.setAttribute("uv",new Xr(S,2))}static fromJSON(n){return new Sg(n.radius,n.widthSegments,n.heightSegments,n.phiStart,n.phiLength,n.thetaStart,n.thetaLength)}}class r1 extends Zr{constructor(n=new Ag(new Ze(-1,-1,0),new Ze(-1,1,0),new Ze(1,1,0)),r=64,a=1,s=8,o=!1){super();this.type="TubeGeometry",this.parameters={path:n,tubularSegments:r,radius:a,radialSegments:s,closed:o};const u=n.computeFrenetFrames(r,o);this.tangents=u.tangents,this.normals=u.normals,this.binormals=u.binormals;const f=new Ze,v=new Ze,m=new Wt;let g=new Ze;const y=[],b=[],w=[],A=[];M(),this.setIndex(A),this.setAttribute("position",new Xr(y,3)),this.setAttribute("normal",new Xr(b,3)),this.setAttribute("uv",new Xr(w,2));function M(){for(let C=0;C<r;C++)S(C);S(o===!1?r:0),T(),E()}function S(C){g=n.getPointAt(C/r,g);const L=u.normals[C],P=u.binormals[C];for(let N=0;N<=s;N++){const F=N/s*Math.PI*2,X=Math.sin(F),Y=-Math.cos(F);v.x=Y*L.x+X*P.x,v.y=Y*L.y+X*P.y,v.z=Y*L.z+X*P.z,v.normalize(),b.push(v.x,v.y,v.z),f.x=g.x+a*v.x,f.y=g.y+a*v.y,f.z=g.z+a*v.z,y.push(f.x,f.y,f.z)}}function E(){for(let C=1;C<=r;C++)for(let L=1;L<=s;L++){const P=(s+1)*(C-1)+(L-1),N=(s+1)*C+(L-1),F=(s+1)*C+L,X=(s+1)*(C-1)+L;A.push(P,N,X),A.push(N,F,X)}}function T(){for(let C=0;C<=r;C++)for(let L=0;L<=s;L++)m.x=C/r,m.y=L/s,w.push(m.x,m.y)}}toJSON(){const n=super.toJSON();return n.path=this.parameters.path.toJSON(),n}static fromJSON(n){return new r1(new Qx[n.path.type]().fromJSON(n.path),n.tubularSegments,n.radius,n.radialSegments,n.closed)}}class nV extends da{constructor(n){super();this.type="ShadowMaterial",this.color=new On(0),this.transparent=!0,this.setValues(n)}copy(n){return super.copy(n),this.color.copy(n.color),this}}nV.prototype.isShadowMaterial=!0;class p2 extends da{constructor(n){super();this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new On(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new On(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ch,this.normalScale=new Wt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(n)}copy(n){return super.copy(n),this.defines={STANDARD:""},this.color.copy(n.color),this.roughness=n.roughness,this.metalness=n.metalness,this.map=n.map,this.lightMap=n.lightMap,this.lightMapIntensity=n.lightMapIntensity,this.aoMap=n.aoMap,this.aoMapIntensity=n.aoMapIntensity,this.emissive.copy(n.emissive),this.emissiveMap=n.emissiveMap,this.emissiveIntensity=n.emissiveIntensity,this.bumpMap=n.bumpMap,this.bumpScale=n.bumpScale,this.normalMap=n.normalMap,this.normalMapType=n.normalMapType,this.normalScale.copy(n.normalScale),this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this.roughnessMap=n.roughnessMap,this.metalnessMap=n.metalnessMap,this.alphaMap=n.alphaMap,this.envMap=n.envMap,this.envMapIntensity=n.envMapIntensity,this.refractionRatio=n.refractionRatio,this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.wireframeLinecap=n.wireframeLinecap,this.wireframeLinejoin=n.wireframeLinejoin,this.flatShading=n.flatShading,this}}p2.prototype.isMeshStandardMaterial=!0;class rV extends p2{constructor(n){super();this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Wt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Fa(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(r){this.ior=(1+.4*r)/(1-.4*r)}}),this.sheenColor=new On(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=.01,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new On(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new On(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(n)}get sheen(){return this._sheen}set sheen(n){this._sheen>0!=n>0&&this.version++,this._sheen=n}get clearcoat(){return this._clearcoat}set clearcoat(n){this._clearcoat>0!=n>0&&this.version++,this._clearcoat=n}get transmission(){return this._transmission}set transmission(n){this._transmission>0!=n>0&&this.version++,this._transmission=n}copy(n){return super.copy(n),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=n.clearcoat,this.clearcoatMap=n.clearcoatMap,this.clearcoatRoughness=n.clearcoatRoughness,this.clearcoatRoughnessMap=n.clearcoatRoughnessMap,this.clearcoatNormalMap=n.clearcoatNormalMap,this.clearcoatNormalScale.copy(n.clearcoatNormalScale),this.ior=n.ior,this.sheen=n.sheen,this.sheenColor.copy(n.sheenColor),this.sheenColorMap=n.sheenColorMap,this.sheenRoughness=n.sheenRoughness,this.sheenRoughnessMap=n.sheenRoughnessMap,this.transmission=n.transmission,this.transmissionMap=n.transmissionMap,this.thickness=n.thickness,this.thicknessMap=n.thicknessMap,this.attenuationDistance=n.attenuationDistance,this.attenuationColor.copy(n.attenuationColor),this.specularIntensity=n.specularIntensity,this.specularIntensityMap=n.specularIntensityMap,this.specularColor.copy(n.specularColor),this.specularColorMap=n.specularColorMap,this}}rV.prototype.isMeshPhysicalMaterial=!0;class iV extends da{constructor(n){super();this.type="MeshPhongMaterial",this.color=new On(16777215),this.specular=new On(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new On(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ch,this.normalScale=new Wt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Pv,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(n)}copy(n){return super.copy(n),this.color.copy(n.color),this.specular.copy(n.specular),this.shininess=n.shininess,this.map=n.map,this.lightMap=n.lightMap,this.lightMapIntensity=n.lightMapIntensity,this.aoMap=n.aoMap,this.aoMapIntensity=n.aoMapIntensity,this.emissive.copy(n.emissive),this.emissiveMap=n.emissiveMap,this.emissiveIntensity=n.emissiveIntensity,this.bumpMap=n.bumpMap,this.bumpScale=n.bumpScale,this.normalMap=n.normalMap,this.normalMapType=n.normalMapType,this.normalScale.copy(n.normalScale),this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this.specularMap=n.specularMap,this.alphaMap=n.alphaMap,this.envMap=n.envMap,this.combine=n.combine,this.reflectivity=n.reflectivity,this.refractionRatio=n.refractionRatio,this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.wireframeLinecap=n.wireframeLinecap,this.wireframeLinejoin=n.wireframeLinejoin,this.flatShading=n.flatShading,this}}iV.prototype.isMeshPhongMaterial=!0;class aV extends da{constructor(n){super();this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new On(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new On(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ch,this.normalScale=new Wt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(n)}copy(n){return super.copy(n),this.color.copy(n.color),this.map=n.map,this.gradientMap=n.gradientMap,this.lightMap=n.lightMap,this.lightMapIntensity=n.lightMapIntensity,this.aoMap=n.aoMap,this.aoMapIntensity=n.aoMapIntensity,this.emissive.copy(n.emissive),this.emissiveMap=n.emissiveMap,this.emissiveIntensity=n.emissiveIntensity,this.bumpMap=n.bumpMap,this.bumpScale=n.bumpScale,this.normalMap=n.normalMap,this.normalMapType=n.normalMapType,this.normalScale.copy(n.normalScale),this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this.alphaMap=n.alphaMap,this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.wireframeLinecap=n.wireframeLinecap,this.wireframeLinejoin=n.wireframeLinejoin,this}}aV.prototype.isMeshToonMaterial=!0;class oV extends da{constructor(n){super();this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ch,this.normalScale=new Wt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(n)}copy(n){return super.copy(n),this.bumpMap=n.bumpMap,this.bumpScale=n.bumpScale,this.normalMap=n.normalMap,this.normalMapType=n.normalMapType,this.normalScale.copy(n.normalScale),this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.flatShading=n.flatShading,this}}oV.prototype.isMeshNormalMaterial=!0;class m2 extends da{constructor(n){super();this.type="MeshLambertMaterial",this.color=new On(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new On(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Pv,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(n)}copy(n){return super.copy(n),this.color.copy(n.color),this.map=n.map,this.lightMap=n.lightMap,this.lightMapIntensity=n.lightMapIntensity,this.aoMap=n.aoMap,this.aoMapIntensity=n.aoMapIntensity,this.emissive.copy(n.emissive),this.emissiveMap=n.emissiveMap,this.emissiveIntensity=n.emissiveIntensity,this.specularMap=n.specularMap,this.alphaMap=n.alphaMap,this.envMap=n.envMap,this.combine=n.combine,this.reflectivity=n.reflectivity,this.refractionRatio=n.refractionRatio,this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.wireframeLinecap=n.wireframeLinecap,this.wireframeLinejoin=n.wireframeLinejoin,this}}m2.prototype.isMeshLambertMaterial=!0;class sV extends da{constructor(n){super();this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new On(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ch,this.normalScale=new Wt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(n)}copy(n){return super.copy(n),this.defines={MATCAP:""},this.color.copy(n.color),this.matcap=n.matcap,this.map=n.map,this.bumpMap=n.bumpMap,this.bumpScale=n.bumpScale,this.normalMap=n.normalMap,this.normalMapType=n.normalMapType,this.normalScale.copy(n.normalScale),this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this.alphaMap=n.alphaMap,this.flatShading=n.flatShading,this}}sV.prototype.isMeshMatcapMaterial=!0;class lV extends kh{constructor(n){super();this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(n)}copy(n){return super.copy(n),this.scale=n.scale,this.dashSize=n.dashSize,this.gapSize=n.gapSize,this}}lV.prototype.isLineDashedMaterial=!0;const xi={arraySlice:function(i,n,r){return xi.isTypedArray(i)?new i.constructor(i.subarray(n,r!==void 0?r:i.length)):i.slice(n,r)},convertArray:function(i,n,r){return!i||!r&&i.constructor===n?i:typeof n.BYTES_PER_ELEMENT=="number"?new n(i):Array.prototype.slice.call(i)},isTypedArray:function(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)},getKeyframeOrder:function(i){function n(s,o){return i[s]-i[o]}const r=i.length,a=new Array(r);for(let s=0;s!==r;++s)a[s]=s;return a.sort(n),a},sortedArray:function(i,n,r){const a=i.length,s=new i.constructor(a);for(let o=0,u=0;u!==a;++o){const f=r[o]*n;for(let v=0;v!==n;++v)s[u++]=i[f+v]}return s},flattenJSON:function(i,n,r,a){let s=1,o=i[0];for(;o!==void 0&&o[a]===void 0;)o=i[s++];if(o===void 0)return;let u=o[a];if(u!==void 0)if(Array.isArray(u))do u=o[a],u!==void 0&&(n.push(o.time),r.push.apply(r,u)),o=i[s++];while(o!==void 0);else if(u.toArray!==void 0)do u=o[a],u!==void 0&&(n.push(o.time),u.toArray(r,r.length)),o=i[s++];while(o!==void 0);else do u=o[a],u!==void 0&&(n.push(o.time),r.push(u)),o=i[s++];while(o!==void 0)},subclip:function(i,n,r,a,s=30){const o=i.clone();o.name=n;const u=[];for(let v=0;v<o.tracks.length;++v){const m=o.tracks[v],g=m.getValueSize(),y=[],b=[];for(let w=0;w<m.times.length;++w){const A=m.times[w]*s;if(!(A<r||A>=a)){y.push(m.times[w]);for(let M=0;M<g;++M)b.push(m.values[w*g+M])}}y.length!==0&&(m.times=xi.convertArray(y,m.times.constructor),m.values=xi.convertArray(b,m.values.constructor),u.push(m))}o.tracks=u;let f=1/0;for(let v=0;v<o.tracks.length;++v)f>o.tracks[v].times[0]&&(f=o.tracks[v].times[0]);for(let v=0;v<o.tracks.length;++v)o.tracks[v].shift(-1*f);return o.resetDuration(),o},makeClipAdditive:function(i,n=0,r=i,a=30){a<=0&&(a=30);const s=r.tracks.length,o=n/a;for(let u=0;u<s;++u){const f=r.tracks[u],v=f.ValueTypeName;if(v==="bool"||v==="string")continue;const m=i.tracks.find(function(E){return E.name===f.name&&E.ValueTypeName===v});if(m===void 0)continue;let g=0;const y=f.getValueSize();f.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(g=y/3);let b=0;const w=m.getValueSize();m.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(b=w/3);const A=f.times.length-1;let M;if(o<=f.times[0]){const E=g,T=y-g;M=xi.arraySlice(f.values,E,T)}else if(o>=f.times[A]){const E=A*y+g,T=E+y-g;M=xi.arraySlice(f.values,E,T)}else{const E=f.createInterpolant(),T=g,C=y-g;E.evaluate(o),M=xi.arraySlice(E.resultBuffer,T,C)}v==="quaternion"&&new Ui().fromArray(M).normalize().conjugate().toArray(M);const S=m.times.length;for(let E=0;E<S;++E){const T=E*w+b;if(v==="quaternion")Ui.multiplyQuaternionsFlat(m.values,T,M,0,m.values,T);else{const C=w-b*2;for(let L=0;L<C;++L)m.values[T+L]-=M[L]}}}return i.blendMode=PS,i}};class Xl{constructor(n,r,a,s){this.parameterPositions=n,this._cachedIndex=0,this.resultBuffer=s!==void 0?s:new r.constructor(a),this.sampleValues=r,this.valueSize=a,this.settings=null,this.DefaultSettings_={}}evaluate(n){const r=this.parameterPositions;let a=this._cachedIndex,s=r[a],o=r[a-1];e:{t:{let u;n:{r:if(!(n<s)){for(let f=a+2;;){if(s===void 0){if(n<o)break r;return a=r.length,this._cachedIndex=a,this.afterEnd_(a-1,n,o)}if(a===f)break;if(o=s,s=r[++a],n<s)break t}u=r.length;break n}if(!(n>=o)){const f=r[1];n<f&&(a=2,o=f);for(let v=a-2;;){if(o===void 0)return this._cachedIndex=0,this.beforeStart_(0,n,s);if(a===v)break;if(s=o,o=r[--a-1],n>=o)break t}u=a,a=0;break n}break e}for(;a<u;){const f=a+u>>>1;n<r[f]?u=f:a=f+1}if(s=r[a],o=r[a-1],o===void 0)return this._cachedIndex=0,this.beforeStart_(0,n,s);if(s===void 0)return a=r.length,this._cachedIndex=a,this.afterEnd_(a-1,o,n)}this._cachedIndex=a,this.intervalChanged_(a,o,s)}return this.interpolate_(a,o,n,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(n){const r=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=n*s;for(let u=0;u!==s;++u)r[u]=a[o+u];return r}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}Xl.prototype.beforeStart_=Xl.prototype.copySampleValue_;Xl.prototype.afterEnd_=Xl.prototype.copySampleValue_;class cV extends Xl{constructor(n,r,a,s){super(n,r,a,s);this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:sh,endingEnd:sh}}intervalChanged_(n,r,a){const s=this.parameterPositions;let o=n-2,u=n+1,f=s[o],v=s[u];if(f===void 0)switch(this.getSettings_().endingStart){case lh:o=n,f=2*r-a;break;case Nv:o=s.length-2,f=r+s[o]-s[o+1];break;default:o=n,f=a}if(v===void 0)switch(this.getSettings_().endingEnd){case lh:u=n,v=2*a-r;break;case Nv:u=1,v=a+s[1]-s[0];break;default:u=n-1,v=r}const m=(a-r)*.5,g=this.valueSize;this._weightPrev=m/(r-f),this._weightNext=m/(v-a),this._offsetPrev=o*g,this._offsetNext=u*g}interpolate_(n,r,a,s){const o=this.resultBuffer,u=this.sampleValues,f=this.valueSize,v=n*f,m=v-f,g=this._offsetPrev,y=this._offsetNext,b=this._weightPrev,w=this._weightNext,A=(a-r)/(s-r),M=A*A,S=M*A,E=-b*S+2*b*M-b*A,T=(1+b)*S+(-1.5-2*b)*M+(-.5+b)*A+1,C=(-1-w)*S+(1.5+w)*M+.5*A,L=w*S-w*M;for(let P=0;P!==f;++P)o[P]=E*u[g+P]+T*u[m+P]+C*u[v+P]+L*u[y+P];return o}}class v2 extends Xl{constructor(n,r,a,s){super(n,r,a,s)}interpolate_(n,r,a,s){const o=this.resultBuffer,u=this.sampleValues,f=this.valueSize,v=n*f,m=v-f,g=(a-r)/(s-r),y=1-g;for(let b=0;b!==f;++b)o[b]=u[m+b]*y+u[v+b]*g;return o}}class uV extends Xl{constructor(n,r,a,s){super(n,r,a,s)}interpolate_(n){return this.copySampleValue_(n-1)}}class ls{constructor(n,r,a,s){if(n===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(r===void 0||r.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+n);this.name=n,this.times=xi.convertArray(r,this.TimeBufferType),this.values=xi.convertArray(a,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(n){const r=n.constructor;let a;if(r.toJSON!==this.toJSON)a=r.toJSON(n);else{a={name:n.name,times:xi.convertArray(n.times,Array),values:xi.convertArray(n.values,Array)};const s=n.getInterpolation();s!==n.DefaultInterpolation&&(a.interpolation=s)}return a.type=n.ValueTypeName,a}InterpolantFactoryMethodDiscrete(n){return new uV(this.times,this.values,this.getValueSize(),n)}InterpolantFactoryMethodLinear(n){return new v2(this.times,this.values,this.getValueSize(),n)}InterpolantFactoryMethodSmooth(n){return new cV(this.times,this.values,this.getValueSize(),n)}setInterpolation(n){let r;switch(n){case Fv:r=this.InterpolantFactoryMethodDiscrete;break;case Bv:r=this.InterpolantFactoryMethodLinear;break;case Yb:r=this.InterpolantFactoryMethodSmooth;break}if(r===void 0){const a="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(n!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(a);return console.warn("THREE.KeyframeTrack:",a),this}return this.createInterpolant=r,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Fv;case this.InterpolantFactoryMethodLinear:return Bv;case this.InterpolantFactoryMethodSmooth:return Yb}}getValueSize(){return this.values.length/this.times.length}shift(n){if(n!==0){const r=this.times;for(let a=0,s=r.length;a!==s;++a)r[a]+=n}return this}scale(n){if(n!==1){const r=this.times;for(let a=0,s=r.length;a!==s;++a)r[a]*=n}return this}trim(n,r){const a=this.times,s=a.length;let o=0,u=s-1;for(;o!==s&&a[o]<n;)++o;for(;u!==-1&&a[u]>r;)--u;if(++u,o!==0||u!==s){o>=u&&(u=Math.max(u,1),o=u-1);const f=this.getValueSize();this.times=xi.arraySlice(a,o,u),this.values=xi.arraySlice(this.values,o*f,u*f)}return this}validate(){let n=!0;const r=this.getValueSize();r-Math.floor(r)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),n=!1);const a=this.times,s=this.values,o=a.length;o===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),n=!1);let u=null;for(let f=0;f!==o;f++){const v=a[f];if(typeof v=="number"&&isNaN(v)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,f,v),n=!1;break}if(u!==null&&u>v){console.error("THREE.KeyframeTrack: Out of order keys.",this,f,v,u),n=!1;break}u=v}if(s!==void 0&&xi.isTypedArray(s))for(let f=0,v=s.length;f!==v;++f){const m=s[f];if(isNaN(m)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,f,m),n=!1;break}}return n}optimize(){const n=xi.arraySlice(this.times),r=xi.arraySlice(this.values),a=this.getValueSize(),s=this.getInterpolation()===Yb,o=n.length-1;let u=1;for(let f=1;f<o;++f){let v=!1;const m=n[f],g=n[f+1];if(m!==g&&(f!==1||m!==n[0]))if(s)v=!0;else{const y=f*a,b=y-a,w=y+a;for(let A=0;A!==a;++A){const M=r[y+A];if(M!==r[b+A]||M!==r[w+A]){v=!0;break}}}if(v){if(f!==u){n[u]=n[f];const y=f*a,b=u*a;for(let w=0;w!==a;++w)r[b+w]=r[y+w]}++u}}if(o>0){n[u]=n[o];for(let f=o*a,v=u*a,m=0;m!==a;++m)r[v+m]=r[f+m];++u}return u!==n.length?(this.times=xi.arraySlice(n,0,u),this.values=xi.arraySlice(r,0,u*a)):(this.times=n,this.values=r),this}clone(){const n=xi.arraySlice(this.times,0),r=xi.arraySlice(this.values,0),a=this.constructor,s=new a(this.name,n,r);return s.createInterpolant=this.createInterpolant,s}}ls.prototype.TimeBufferType=Float32Array;ls.prototype.ValueBufferType=Float32Array;ls.prototype.DefaultInterpolation=Bv;class Nh extends ls{}Nh.prototype.ValueTypeName="bool";Nh.prototype.ValueBufferType=Array;Nh.prototype.DefaultInterpolation=Fv;Nh.prototype.InterpolantFactoryMethodLinear=void 0;Nh.prototype.InterpolantFactoryMethodSmooth=void 0;class g2 extends ls{}g2.prototype.ValueTypeName="color";class Tg extends ls{}Tg.prototype.ValueTypeName="number";class hV extends Xl{constructor(n,r,a,s){super(n,r,a,s)}interpolate_(n,r,a,s){const o=this.resultBuffer,u=this.sampleValues,f=this.valueSize,v=(a-r)/(s-r);let m=n*f;for(let g=m+f;m!==g;m+=4)Ui.slerpFlat(o,0,u,m-f,u,m,v);return o}}class Vd extends ls{InterpolantFactoryMethodLinear(n){return new hV(this.times,this.values,this.getValueSize(),n)}}Vd.prototype.ValueTypeName="quaternion";Vd.prototype.DefaultInterpolation=Bv;Vd.prototype.InterpolantFactoryMethodSmooth=void 0;class Uh extends ls{}Uh.prototype.ValueTypeName="string";Uh.prototype.ValueBufferType=Array;Uh.prototype.DefaultInterpolation=Fv;Uh.prototype.InterpolantFactoryMethodLinear=void 0;Uh.prototype.InterpolantFactoryMethodSmooth=void 0;class Cg extends ls{}Cg.prototype.ValueTypeName="vector";class y2{constructor(n,r=-1,a,s=$b){this.name=n,this.tracks=a,this.duration=r,this.blendMode=s,this.uuid=is(),this.duration<0&&this.resetDuration()}static parse(n){const r=[],a=n.tracks,s=1/(n.fps||1);for(let u=0,f=a.length;u!==f;++u)r.push(dV(a[u]).scale(s));const o=new this(n.name,n.duration,r,n.blendMode);return o.uuid=n.uuid,o}static toJSON(n){const r=[],a=n.tracks,s={name:n.name,duration:n.duration,tracks:r,uuid:n.uuid,blendMode:n.blendMode};for(let o=0,u=a.length;o!==u;++o)r.push(ls.toJSON(a[o]));return s}static CreateFromMorphTargetSequence(n,r,a,s){const o=r.length,u=[];for(let f=0;f<o;f++){let v=[],m=[];v.push((f+o-1)%o,f,(f+1)%o),m.push(0,1,0);const g=xi.getKeyframeOrder(v);v=xi.sortedArray(v,1,g),m=xi.sortedArray(m,1,g),!s&&v[0]===0&&(v.push(o),m.push(m[0])),u.push(new Tg(".morphTargetInfluences["+r[f].name+"]",v,m).scale(1/a))}return new this(n,-1,u)}static findByName(n,r){let a=n;if(!Array.isArray(n)){const s=n;a=s.geometry&&s.geometry.animations||s.animations}for(let s=0;s<a.length;s++)if(a[s].name===r)return a[s];return null}static CreateClipsFromMorphTargetSequences(n,r,a){const s={},o=/^([\w-]*?)([\d]+)$/;for(let f=0,v=n.length;f<v;f++){const m=n[f],g=m.name.match(o);if(g&&g.length>1){const y=g[1];let b=s[y];b||(s[y]=b=[]),b.push(m)}}const u=[];for(const f in s)u.push(this.CreateFromMorphTargetSequence(f,s[f],r,a));return u}static parseAnimation(n,r){if(!n)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const a=function(y,b,w,A,M){if(w.length!==0){const S=[],E=[];xi.flattenJSON(w,S,E,A),S.length!==0&&M.push(new y(b,S,E))}},s=[],o=n.name||"default",u=n.fps||30,f=n.blendMode;let v=n.length||-1;const m=n.hierarchy||[];for(let y=0;y<m.length;y++){const b=m[y].keys;if(!(!b||b.length===0))if(b[0].morphTargets){const w={};let A;for(A=0;A<b.length;A++)if(b[A].morphTargets)for(let M=0;M<b[A].morphTargets.length;M++)w[b[A].morphTargets[M]]=-1;for(const M in w){const S=[],E=[];for(let T=0;T!==b[A].morphTargets.length;++T){const C=b[A];S.push(C.time),E.push(C.morphTarget===M?1:0)}s.push(new Tg(".morphTargetInfluence["+M+"]",S,E))}v=w.length*(u||1)}else{const w=".bones["+r[y].name+"]";a(Cg,w+".position",b,"pos",s),a(Vd,w+".quaternion",b,"rot",s),a(Cg,w+".scale",b,"scl",s)}}return s.length===0?null:new this(o,v,s,f)}resetDuration(){const n=this.tracks;let r=0;for(let a=0,s=n.length;a!==s;++a){const o=this.tracks[a];r=Math.max(r,o.times[o.times.length-1])}return this.duration=r,this}trim(){for(let n=0;n<this.tracks.length;n++)this.tracks[n].trim(0,this.duration);return this}validate(){let n=!0;for(let r=0;r<this.tracks.length;r++)n=n&&this.tracks[r].validate();return n}optimize(){for(let n=0;n<this.tracks.length;n++)this.tracks[n].optimize();return this}clone(){const n=[];for(let r=0;r<this.tracks.length;r++)n.push(this.tracks[r].clone());return new this.constructor(this.name,this.duration,n,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function fV(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Tg;case"vector":case"vector2":case"vector3":case"vector4":return Cg;case"color":return g2;case"quaternion":return Vd;case"bool":case"boolean":return Nh;case"string":return Uh}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}function dV(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const n=fV(i.type);if(i.times===void 0){const r=[],a=[];xi.flattenJSON(i.keys,r,a,"value"),i.times=r,i.values=a}return n.parse!==void 0?n.parse(i):new n(i.name,i.times,i.values,i.interpolation)}const Hh={enabled:!1,files:{},add:function(i,n){this.enabled!==!1&&(this.files[i]=n)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};class pV{constructor(n,r,a){const s=this;let o=!1,u=0,f=0,v;const m=[];this.onStart=void 0,this.onLoad=n,this.onProgress=r,this.onError=a,this.itemStart=function(g){f++,o===!1&&s.onStart!==void 0&&s.onStart(g,u,f),o=!0},this.itemEnd=function(g){u++,s.onProgress!==void 0&&s.onProgress(g,u,f),u===f&&(o=!1,s.onLoad!==void 0&&s.onLoad())},this.itemError=function(g){s.onError!==void 0&&s.onError(g)},this.resolveURL=function(g){return v?v(g):g},this.setURLModifier=function(g){return v=g,this},this.addHandler=function(g,y){return m.push(g,y),this},this.removeHandler=function(g){const y=m.indexOf(g);return y!==-1&&m.splice(y,2),this},this.getHandler=function(g){for(let y=0,b=m.length;y<b;y+=2){const w=m[y],A=m[y+1];if(w.global&&(w.lastIndex=0),w.test(g))return A}return null}}}const mV=new pV;class ql{constructor(n){this.manager=n!==void 0?n:mV,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(n,r){const a=this;return new Promise(function(s,o){a.load(n,s,r,o)})}parse(){}setCrossOrigin(n){return this.crossOrigin=n,this}setWithCredentials(n){return this.withCredentials=n,this}setPath(n){return this.path=n,this}setResourcePath(n){return this.resourcePath=n,this}setRequestHeader(n){return this.requestHeader=n,this}}const Hs={};class vV extends ql{constructor(n){super(n)}load(n,r,a,s){n===void 0&&(n=""),this.path!==void 0&&(n=this.path+n),n=this.manager.resolveURL(n);const o=Hh.get(n);if(o!==void 0)return this.manager.itemStart(n),setTimeout(()=>{r&&r(o),this.manager.itemEnd(n)},0),o;if(Hs[n]!==void 0){Hs[n].push({onLoad:r,onProgress:a,onError:s});return}Hs[n]=[],Hs[n].push({onLoad:r,onProgress:a,onError:s});const u=new Request(n,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"});fetch(u).then(f=>{if(f.status===200||f.status===0){f.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received.");const v=Hs[n],m=f.body.getReader(),g=f.headers.get("Content-Length"),y=g?parseInt(g):0,b=y!==0;let w=0;return new ReadableStream({start(A){M();function M(){m.read().then(({done:S,value:E})=>{if(S)A.close();else{w+=E.byteLength;const T=new ProgressEvent("progress",{lengthComputable:b,loaded:w,total:y});for(let C=0,L=v.length;C<L;C++){const P=v[C];P.onProgress&&P.onProgress(T)}A.enqueue(E),M()}})}}})}else throw Error(`fetch for "${f.url}" responded with ${f.status}: ${f.statusText}`)}).then(f=>{const v=new Response(f);switch(this.responseType){case"arraybuffer":return v.arrayBuffer();case"blob":return v.blob();case"document":return v.text().then(m=>new DOMParser().parseFromString(m,this.mimeType));case"json":return v.json();default:return v.text()}}).then(f=>{Hh.add(n,f);const v=Hs[n];delete Hs[n];for(let m=0,g=v.length;m<g;m++){const y=v[m];y.onLoad&&y.onLoad(f)}this.manager.itemEnd(n)}).catch(f=>{const v=Hs[n];delete Hs[n];for(let m=0,g=v.length;m<g;m++){const y=v[m];y.onError&&y.onError(f)}this.manager.itemError(n),this.manager.itemEnd(n)}),this.manager.itemStart(n)}setResponseType(n){return this.responseType=n,this}setMimeType(n){return this.mimeType=n,this}}class b2 extends ql{constructor(n){super(n)}load(n,r,a,s){this.path!==void 0&&(n=this.path+n),n=this.manager.resolveURL(n);const o=this,u=Hh.get(n);if(u!==void 0)return o.manager.itemStart(n),setTimeout(function(){r&&r(u),o.manager.itemEnd(n)},0),u;const f=Hv("img");function v(){g(),Hh.add(n,this),r&&r(this),o.manager.itemEnd(n)}function m(y){g(),s&&s(y),o.manager.itemError(n),o.manager.itemEnd(n)}function g(){f.removeEventListener("load",v,!1),f.removeEventListener("error",m,!1)}return f.addEventListener("load",v,!1),f.addEventListener("error",m,!1),n.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(f.crossOrigin=this.crossOrigin),o.manager.itemStart(n),f.src=n,f}}class gV extends ql{constructor(n){super(n)}load(n,r,a,s){const o=new ig,u=new b2(this.manager);u.setCrossOrigin(this.crossOrigin),u.setPath(this.path);let f=0;function v(m){u.load(n[m],function(g){o.images[m]=g,f++,f===6&&(o.needsUpdate=!0,r&&r(o))},void 0,s)}for(let m=0;m<n.length;++m)v(m);return o}}class x2 extends ql{constructor(n){super(n)}load(n,r,a,s){const o=new qi,u=new b2(this.manager);return u.setCrossOrigin(this.crossOrigin),u.setPath(this.path),u.load(n,function(f){o.image=f,o.needsUpdate=!0,r!==void 0&&r(o)},a,s),o}}class cs extends ei{constructor(n,r=1){super();this.type="Light",this.color=new On(n),this.intensity=r}dispose(){}copy(n){return super.copy(n),this.color.copy(n.color),this.intensity=n.intensity,this}toJSON(n){const r=super.toJSON(n);return r.object.color=this.color.getHex(),r.object.intensity=this.intensity,this.groundColor!==void 0&&(r.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(r.object.distance=this.distance),this.angle!==void 0&&(r.object.angle=this.angle),this.decay!==void 0&&(r.object.decay=this.decay),this.penumbra!==void 0&&(r.object.penumbra=this.penumbra),this.shadow!==void 0&&(r.object.shadow=this.shadow.toJSON()),r}}cs.prototype.isLight=!0;class yV extends cs{constructor(n,r,a){super(n,a);this.type="HemisphereLight",this.position.copy(ei.DefaultUp),this.updateMatrix(),this.groundColor=new On(r)}copy(n){return cs.prototype.copy.call(this,n),this.groundColor.copy(n.groundColor),this}}yV.prototype.isHemisphereLight=!0;const w2=new jn,A2=new Ze,E2=new Ze;class i1{constructor(n){this.camera=n,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Wt(512,512),this.map=null,this.mapPass=null,this.matrix=new jn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new og,this._frameExtents=new Wt(1,1),this._viewportCount=1,this._viewports=[new ci(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(n){const r=this.camera,a=this.matrix;A2.setFromMatrixPosition(n.matrixWorld),r.position.copy(A2),E2.setFromMatrixPosition(n.target.matrixWorld),r.lookAt(E2),r.updateMatrixWorld(),w2.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(w2),a.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),a.multiply(r.projectionMatrix),a.multiply(r.matrixWorldInverse)}getViewport(n){return this._viewports[n]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(n){return this.camera=n.camera.clone(),this.bias=n.bias,this.radius=n.radius,this.mapSize.copy(n.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const n={};return this.bias!==0&&(n.bias=this.bias),this.normalBias!==0&&(n.normalBias=this.normalBias),this.radius!==1&&(n.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(n.mapSize=this.mapSize.toArray()),n.camera=this.camera.toJSON(!1).object,delete n.camera.matrix,n}}class _2 extends i1{constructor(){super(new La(50,1,.5,500));this.focus=1}updateMatrices(n){const r=this.camera,a=ex*2*n.angle*this.focus,s=this.mapSize.width/this.mapSize.height,o=n.distance||r.far;(a!==r.fov||s!==r.aspect||o!==r.far)&&(r.fov=a,r.aspect=s,r.far=o,r.updateProjectionMatrix()),super.updateMatrices(n)}copy(n){return super.copy(n),this.focus=n.focus,this}}_2.prototype.isSpotLightShadow=!0;class bV extends cs{constructor(n,r,a=0,s=Math.PI/3,o=0,u=1){super(n,r);this.type="SpotLight",this.position.copy(ei.DefaultUp),this.updateMatrix(),this.target=new ei,this.distance=a,this.angle=s,this.penumbra=o,this.decay=u,this.shadow=new _2}get power(){return this.intensity*Math.PI}set power(n){this.intensity=n/Math.PI}dispose(){this.shadow.dispose()}copy(n){return super.copy(n),this.distance=n.distance,this.angle=n.angle,this.penumbra=n.penumbra,this.decay=n.decay,this.target=n.target.clone(),this.shadow=n.shadow.clone(),this}}bV.prototype.isSpotLight=!0;const M2=new jn,Wd=new Ze,a1=new Ze;class S2 extends i1{constructor(){super(new La(90,1,.5,500));this._frameExtents=new Wt(4,2),this._viewportCount=6,this._viewports=[new ci(2,1,1,1),new ci(0,1,1,1),new ci(3,1,1,1),new ci(1,1,1,1),new ci(3,0,1,1),new ci(1,0,1,1)],this._cubeDirections=[new Ze(1,0,0),new Ze(-1,0,0),new Ze(0,0,1),new Ze(0,0,-1),new Ze(0,1,0),new Ze(0,-1,0)],this._cubeUps=[new Ze(0,1,0),new Ze(0,1,0),new Ze(0,1,0),new Ze(0,1,0),new Ze(0,0,1),new Ze(0,0,-1)]}updateMatrices(n,r=0){const a=this.camera,s=this.matrix,o=n.distance||a.far;o!==a.far&&(a.far=o,a.updateProjectionMatrix()),Wd.setFromMatrixPosition(n.matrixWorld),a.position.copy(Wd),a1.copy(a.position),a1.add(this._cubeDirections[r]),a.up.copy(this._cubeUps[r]),a.lookAt(a1),a.updateMatrixWorld(),s.makeTranslation(-Wd.x,-Wd.y,-Wd.z),M2.multiplyMatrices(a.projectionMatrix,a.matrixWorldInverse),this._frustum.setFromProjectionMatrix(M2)}}S2.prototype.isPointLightShadow=!0;class xV extends cs{constructor(n,r,a=0,s=1){super(n,r);this.type="PointLight",this.distance=a,this.decay=s,this.shadow=new S2}get power(){return this.intensity*4*Math.PI}set power(n){this.intensity=n/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(n){return super.copy(n),this.distance=n.distance,this.decay=n.decay,this.shadow=n.shadow.clone(),this}}xV.prototype.isPointLight=!0;class T2 extends i1{constructor(){super(new Cd(-5,5,5,-5,.5,500))}}T2.prototype.isDirectionalLightShadow=!0;class C2 extends cs{constructor(n,r){super(n,r);this.type="DirectionalLight",this.position.copy(ei.DefaultUp),this.updateMatrix(),this.target=new ei,this.shadow=new T2}dispose(){this.shadow.dispose()}copy(n){return super.copy(n),this.target=n.target.clone(),this.shadow=n.shadow.clone(),this}}C2.prototype.isDirectionalLight=!0;class R2 extends cs{constructor(n,r){super(n,r);this.type="AmbientLight"}}R2.prototype.isAmbientLight=!0;class wV extends cs{constructor(n,r,a=10,s=10){super(n,r);this.type="RectAreaLight",this.width=a,this.height=s}get power(){return this.intensity*this.width*this.height*Math.PI}set power(n){this.intensity=n/(this.width*this.height*Math.PI)}copy(n){return super.copy(n),this.width=n.width,this.height=n.height,this}toJSON(n){const r=super.toJSON(n);return r.object.width=this.width,r.object.height=this.height,r}}wV.prototype.isRectAreaLight=!0;class L2{constructor(){this.coefficients=[];for(let n=0;n<9;n++)this.coefficients.push(new Ze)}set(n){for(let r=0;r<9;r++)this.coefficients[r].copy(n[r]);return this}zero(){for(let n=0;n<9;n++)this.coefficients[n].set(0,0,0);return this}getAt(n,r){const a=n.x,s=n.y,o=n.z,u=this.coefficients;return r.copy(u[0]).multiplyScalar(.282095),r.addScaledVector(u[1],.488603*s),r.addScaledVector(u[2],.488603*o),r.addScaledVector(u[3],.488603*a),r.addScaledVector(u[4],1.092548*(a*s)),r.addScaledVector(u[5],1.092548*(s*o)),r.addScaledVector(u[6],.315392*(3*o*o-1)),r.addScaledVector(u[7],1.092548*(a*o)),r.addScaledVector(u[8],.546274*(a*a-s*s)),r}getIrradianceAt(n,r){const a=n.x,s=n.y,o=n.z,u=this.coefficients;return r.copy(u[0]).multiplyScalar(.886227),r.addScaledVector(u[1],2*.511664*s),r.addScaledVector(u[2],2*.511664*o),r.addScaledVector(u[3],2*.511664*a),r.addScaledVector(u[4],2*.429043*a*s),r.addScaledVector(u[5],2*.429043*s*o),r.addScaledVector(u[6],.743125*o*o-.247708),r.addScaledVector(u[7],2*.429043*a*o),r.addScaledVector(u[8],.429043*(a*a-s*s)),r}add(n){for(let r=0;r<9;r++)this.coefficients[r].add(n.coefficients[r]);return this}addScaledSH(n,r){for(let a=0;a<9;a++)this.coefficients[a].addScaledVector(n.coefficients[a],r);return this}scale(n){for(let r=0;r<9;r++)this.coefficients[r].multiplyScalar(n);return this}lerp(n,r){for(let a=0;a<9;a++)this.coefficients[a].lerp(n.coefficients[a],r);return this}equals(n){for(let r=0;r<9;r++)if(!this.coefficients[r].equals(n.coefficients[r]))return!1;return!0}copy(n){return this.set(n.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(n,r=0){const a=this.coefficients;for(let s=0;s<9;s++)a[s].fromArray(n,r+s*3);return this}toArray(n=[],r=0){const a=this.coefficients;for(let s=0;s<9;s++)a[s].toArray(n,r+s*3);return n}static getBasisAt(n,r){const a=n.x,s=n.y,o=n.z;r[0]=.282095,r[1]=.488603*s,r[2]=.488603*o,r[3]=.488603*a,r[4]=1.092548*a*s,r[5]=1.092548*s*o,r[6]=.315392*(3*o*o-1),r[7]=1.092548*a*o,r[8]=.546274*(a*a-s*s)}}L2.prototype.isSphericalHarmonics3=!0;class o1 extends cs{constructor(n=new L2,r=1){super(void 0,r);this.sh=n}copy(n){return super.copy(n),this.sh.copy(n.sh),this}fromJSON(n){return this.intensity=n.intensity,this.sh.fromArray(n.sh),this}toJSON(n){const r=super.toJSON(n);return r.object.sh=this.sh.toArray(),r}}o1.prototype.isLightProbe=!0;class AV{static decodeText(n){if(typeof TextDecoder!="undefined")return new TextDecoder().decode(n);let r="";for(let a=0,s=n.length;a<s;a++)r+=String.fromCharCode(n[a]);try{return decodeURIComponent(escape(r))}catch{return r}}static extractUrlBase(n){const r=n.lastIndexOf("/");return r===-1?"./":n.substr(0,r+1)}static resolveURL(n,r){return typeof n!="string"||n===""?"":(/^https?:\/\//i.test(r)&&/^\//.test(n)&&(r=r.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(n)||/^data:.*,.*$/i.test(n)||/^blob:.*$/i.test(n)?n:r+n)}}class EV extends Zr{constructor(){super();this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(n){return super.copy(n),this.instanceCount=n.instanceCount,this}clone(){return new this.constructor().copy(this)}toJSON(){const n=super.toJSON(this);return n.instanceCount=this.instanceCount,n.isInstancedBufferGeometry=!0,n}}EV.prototype.isInstancedBufferGeometry=!0;class _V extends ql{constructor(n){super(n);typeof createImageBitmap=="undefined"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch=="undefined"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(n){return this.options=n,this}load(n,r,a,s){n===void 0&&(n=""),this.path!==void 0&&(n=this.path+n),n=this.manager.resolveURL(n);const o=this,u=Hh.get(n);if(u!==void 0)return o.manager.itemStart(n),setTimeout(function(){r&&r(u),o.manager.itemEnd(n)},0),u;const f={};f.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",f.headers=this.requestHeader,fetch(n,f).then(function(v){return v.blob()}).then(function(v){return createImageBitmap(v,Object.assign(o.options,{colorSpaceConversion:"none"}))}).then(function(v){Hh.add(n,v),r&&r(v),o.manager.itemEnd(n)}).catch(function(v){s&&s(v),o.manager.itemError(n),o.manager.itemEnd(n)}),o.manager.itemStart(n)}}_V.prototype.isImageBitmapLoader=!0;let Rg;const MV={getContext:function(){return Rg===void 0&&(Rg=new(window.AudioContext||window.webkitAudioContext)),Rg},setContext:function(i){Rg=i}};class SV extends ql{constructor(n){super(n)}load(n,r,a,s){const o=this,u=new vV(this.manager);u.setResponseType("arraybuffer"),u.setPath(this.path),u.setRequestHeader(this.requestHeader),u.setWithCredentials(this.withCredentials),u.load(n,function(f){try{const v=f.slice(0);MV.getContext().decodeAudioData(v,function(g){r(g)})}catch(v){s?s(v):console.error(v),o.manager.itemError(n)}},a,s)}}class TV extends o1{constructor(n,r,a=1){super(void 0,a);const s=new On().set(n),o=new On().set(r),u=new Ze(s.r,s.g,s.b),f=new Ze(o.r,o.g,o.b),v=Math.sqrt(Math.PI),m=v*Math.sqrt(.75);this.sh.coefficients[0].copy(u).add(f).multiplyScalar(v),this.sh.coefficients[1].copy(u).sub(f).multiplyScalar(m)}}TV.prototype.isHemisphereLightProbe=!0;class CV extends o1{constructor(n,r=1){super(void 0,r);const a=new On().set(n);this.sh.coefficients[0].set(a.r,a.g,a.b).multiplyScalar(2*Math.sqrt(Math.PI))}}CV.prototype.isAmbientLightProbe=!0;class P2{constructor(n=!0){this.autoStart=n,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=D2(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let n=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const r=D2();n=(r-this.oldTime)/1e3,this.oldTime=r,this.elapsedTime+=n}return n}}function D2(){return(typeof performance=="undefined"?Date:performance).now()}class RV extends ei{constructor(n){super();this.type="Audio",this.listener=n,this.context=n.context,this.gain=this.context.createGain(),this.gain.connect(n.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(n){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=n,this.connect(),this}setMediaElementSource(n){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(n),this.connect(),this}setMediaStreamSource(n){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(n),this.connect(),this}setBuffer(n){return this.buffer=n,this.sourceType="buffer",this.autoplay&&this.play(),this}play(n=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+n;const r=this.context.createBufferSource();return r.buffer=this.buffer,r.loop=this.loop,r.loopStart=this.loopStart,r.loopEnd=this.loopEnd,r.onended=this.onEnded.bind(this),r.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=r,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let n=1,r=this.filters.length;n<r;n++)this.filters[n-1].connect(this.filters[n]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let n=1,r=this.filters.length;n<r;n++)this.filters[n-1].disconnect(this.filters[n]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(n){return n||(n=[]),this._connected===!0?(this.disconnect(),this.filters=n.slice(),this.connect()):this.filters=n.slice(),this}setDetune(n){if(this.detune=n,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(n){return this.setFilters(n?[n]:[])}setPlaybackRate(n){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=n,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(n){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=n,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(n){return this.loopStart=n,this}setLoopEnd(n){return this.loopEnd=n,this}getVolume(){return this.gain.gain.value}setVolume(n){return this.gain.gain.setTargetAtTime(n,this.context.currentTime,.01),this}}class LV{constructor(n,r,a){this.binding=n,this.valueSize=a;let s,o,u;switch(r){case"quaternion":s=this._slerp,o=this._slerpAdditive,u=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(a*6),this._workIndex=5;break;case"string":case"bool":s=this._select,o=this._select,u=this._setAdditiveIdentityOther,this.buffer=new Array(a*5);break;default:s=this._lerp,o=this._lerpAdditive,u=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(a*5)}this._mixBufferRegion=s,this._mixBufferRegionAdditive=o,this._setIdentity=u,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(n,r){const a=this.buffer,s=this.valueSize,o=n*s+s;let u=this.cumulativeWeight;if(u===0){for(let f=0;f!==s;++f)a[o+f]=a[f];u=r}else{u+=r;const f=r/u;this._mixBufferRegion(a,o,0,f,s)}this.cumulativeWeight=u}accumulateAdditive(n){const r=this.buffer,a=this.valueSize,s=a*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(r,s,0,n,a),this.cumulativeWeightAdditive+=n}apply(n){const r=this.valueSize,a=this.buffer,s=n*r+r,o=this.cumulativeWeight,u=this.cumulativeWeightAdditive,f=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,o<1){const v=r*this._origIndex;this._mixBufferRegion(a,s,v,1-o,r)}u>0&&this._mixBufferRegionAdditive(a,s,this._addIndex*r,1,r);for(let v=r,m=r+r;v!==m;++v)if(a[v]!==a[v+r]){f.setValue(a,s);break}}saveOriginalState(){const n=this.binding,r=this.buffer,a=this.valueSize,s=a*this._origIndex;n.getValue(r,s);for(let o=a,u=s;o!==u;++o)r[o]=r[s+o%a];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const n=this.valueSize*3;this.binding.setValue(this.buffer,n)}_setAdditiveIdentityNumeric(){const n=this._addIndex*this.valueSize,r=n+this.valueSize;for(let a=n;a<r;a++)this.buffer[a]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const n=this._origIndex*this.valueSize,r=this._addIndex*this.valueSize;for(let a=0;a<this.valueSize;a++)this.buffer[r+a]=this.buffer[n+a]}_select(n,r,a,s,o){if(s>=.5)for(let u=0;u!==o;++u)n[r+u]=n[a+u]}_slerp(n,r,a,s){Ui.slerpFlat(n,r,n,r,n,a,s)}_slerpAdditive(n,r,a,s,o){const u=this._workIndex*o;Ui.multiplyQuaternionsFlat(n,u,n,r,n,a),Ui.slerpFlat(n,r,n,r,n,u,s)}_lerp(n,r,a,s,o){const u=1-s;for(let f=0;f!==o;++f){const v=r+f;n[v]=n[v]*u+n[a+f]*s}}_lerpAdditive(n,r,a,s,o){for(let u=0;u!==o;++u){const f=r+u;n[f]=n[f]+n[a+u]*s}}}const s1="\\[\\]\\.:\\/",PV=new RegExp("["+s1+"]","g"),l1="[^"+s1+"]",DV="[^"+s1.replace("\\.","")+"]",OV=/((?:WC+[\/:])*)/.source.replace("WC",l1),IV=/(WCOD+)?/.source.replace("WCOD",DV),kV=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",l1),FV=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",l1),BV=new RegExp("^"+OV+IV+kV+FV+"$"),NV=["material","materials","bones"];class UV{constructor(n,r,a){const s=a||ni.parseTrackName(r);this._targetGroup=n,this._bindings=n.subscribe_(r,s)}getValue(n,r){this.bind();const a=this._targetGroup.nCachedObjects_,s=this._bindings[a];s!==void 0&&s.getValue(n,r)}setValue(n,r){const a=this._bindings;for(let s=this._targetGroup.nCachedObjects_,o=a.length;s!==o;++s)a[s].setValue(n,r)}bind(){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,a=n.length;r!==a;++r)n[r].bind()}unbind(){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,a=n.length;r!==a;++r)n[r].unbind()}}class ni{constructor(n,r,a){this.path=r,this.parsedPath=a||ni.parseTrackName(r),this.node=ni.findNode(n,this.parsedPath.nodeName)||n,this.rootNode=n,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(n,r,a){return n&&n.isAnimationObjectGroup?new ni.Composite(n,r,a):new ni(n,r,a)}static sanitizeNodeName(n){return n.replace(/\s/g,"_").replace(PV,"")}static parseTrackName(n){const r=BV.exec(n);if(!r)throw new Error("PropertyBinding: Cannot parse trackName: "+n);const a={nodeName:r[2],objectName:r[3],objectIndex:r[4],propertyName:r[5],propertyIndex:r[6]},s=a.nodeName&&a.nodeName.lastIndexOf(".");if(s!==void 0&&s!==-1){const o=a.nodeName.substring(s+1);NV.indexOf(o)!==-1&&(a.nodeName=a.nodeName.substring(0,s),a.objectName=o)}if(a.propertyName===null||a.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+n);return a}static findNode(n,r){if(!r||r===""||r==="."||r===-1||r===n.name||r===n.uuid)return n;if(n.skeleton){const a=n.skeleton.getBoneByName(r);if(a!==void 0)return a}if(n.children){const a=function(o){for(let u=0;u<o.length;u++){const f=o[u];if(f.name===r||f.uuid===r)return f;const v=a(f.children);if(v)return v}return null},s=a(n.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(n,r){n[r]=this.targetObject[this.propertyName]}_getValue_array(n,r){const a=this.resolvedProperty;for(let s=0,o=a.length;s!==o;++s)n[r++]=a[s]}_getValue_arrayElement(n,r){n[r]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(n,r){this.resolvedProperty.toArray(n,r)}_setValue_direct(n,r){this.targetObject[this.propertyName]=n[r]}_setValue_direct_setNeedsUpdate(n,r){this.targetObject[this.propertyName]=n[r],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(n,r){this.targetObject[this.propertyName]=n[r],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(n,r){const a=this.resolvedProperty;for(let s=0,o=a.length;s!==o;++s)a[s]=n[r++]}_setValue_array_setNeedsUpdate(n,r){const a=this.resolvedProperty;for(let s=0,o=a.length;s!==o;++s)a[s]=n[r++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(n,r){const a=this.resolvedProperty;for(let s=0,o=a.length;s!==o;++s)a[s]=n[r++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(n,r){this.resolvedProperty[this.propertyIndex]=n[r]}_setValue_arrayElement_setNeedsUpdate(n,r){this.resolvedProperty[this.propertyIndex]=n[r],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(n,r){this.resolvedProperty[this.propertyIndex]=n[r],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(n,r){this.resolvedProperty.fromArray(n,r)}_setValue_fromArray_setNeedsUpdate(n,r){this.resolvedProperty.fromArray(n,r),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(n,r){this.resolvedProperty.fromArray(n,r),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(n,r){this.bind(),this.getValue(n,r)}_setValue_unbound(n,r){this.bind(),this.setValue(n,r)}bind(){let n=this.node;const r=this.parsedPath,a=r.objectName,s=r.propertyName;let o=r.propertyIndex;if(n||(n=ni.findNode(this.rootNode,r.nodeName)||this.rootNode,this.node=n),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!n){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(a){let m=r.objectIndex;switch(a){case"materials":if(!n.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!n.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}n=n.material.materials;break;case"bones":if(!n.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}n=n.skeleton.bones;for(let g=0;g<n.length;g++)if(n[g].name===m){m=g;break}break;default:if(n[a]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}n=n[a]}if(m!==void 0){if(n[m]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,n);return}n=n[m]}}const u=n[s];if(u===void 0){const m=r.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+m+"."+s+" but it wasn't found.",n);return}let f=this.Versioning.None;this.targetObject=n,n.needsUpdate!==void 0?f=this.Versioning.NeedsUpdate:n.matrixWorldNeedsUpdate!==void 0&&(f=this.Versioning.MatrixWorldNeedsUpdate);let v=this.BindingType.Direct;if(o!==void 0){if(s==="morphTargetInfluences"){if(!n.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(n.geometry.isBufferGeometry){if(!n.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}n.morphTargetDictionary[o]!==void 0&&(o=n.morphTargetDictionary[o])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}v=this.BindingType.ArrayElement,this.resolvedProperty=u,this.propertyIndex=o}else u.fromArray!==void 0&&u.toArray!==void 0?(v=this.BindingType.HasFromToArray,this.resolvedProperty=u):Array.isArray(u)?(v=this.BindingType.EntireArray,this.resolvedProperty=u):this.propertyName=s;this.getValue=this.GetterByBindingType[v],this.setValue=this.SetterByBindingTypeAndVersioning[v][f]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}ni.Composite=UV;ni.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};ni.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};ni.prototype.GetterByBindingType=[ni.prototype._getValue_direct,ni.prototype._getValue_array,ni.prototype._getValue_arrayElement,ni.prototype._getValue_toArray];ni.prototype.SetterByBindingTypeAndVersioning=[[ni.prototype._setValue_direct,ni.prototype._setValue_direct_setNeedsUpdate,ni.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[ni.prototype._setValue_array,ni.prototype._setValue_array_setNeedsUpdate,ni.prototype._setValue_array_setMatrixWorldNeedsUpdate],[ni.prototype._setValue_arrayElement,ni.prototype._setValue_arrayElement_setNeedsUpdate,ni.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[ni.prototype._setValue_fromArray,ni.prototype._setValue_fromArray_setNeedsUpdate,ni.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class HV{constructor(n,r,a=null,s=r.blendMode){this._mixer=n,this._clip=r,this._localRoot=a,this.blendMode=s;const o=r.tracks,u=o.length,f=new Array(u),v={endingStart:sh,endingEnd:sh};for(let m=0;m!==u;++m){const g=o[m].createInterpolant(null);f[m]=g,g.settings=v}this._interpolantSettings=v,this._interpolants=f,this._propertyBindings=new Array(u),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=S6,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(n){return this._startTime=n,this}setLoop(n,r){return this.loop=n,this.repetitions=r,this}setEffectiveWeight(n){return this.weight=n,this._effectiveWeight=this.enabled?n:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(n){return this._scheduleFading(n,0,1)}fadeOut(n){return this._scheduleFading(n,1,0)}crossFadeFrom(n,r,a){if(n.fadeOut(r),this.fadeIn(r),a){const s=this._clip.duration,o=n._clip.duration,u=o/s,f=s/o;n.warp(1,u,r),this.warp(f,1,r)}return this}crossFadeTo(n,r,a){return n.crossFadeFrom(this,r,a)}stopFading(){const n=this._weightInterpolant;return n!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(n)),this}setEffectiveTimeScale(n){return this.timeScale=n,this._effectiveTimeScale=this.paused?0:n,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(n){return this.timeScale=this._clip.duration/n,this.stopWarping()}syncWith(n){return this.time=n.time,this.timeScale=n.timeScale,this.stopWarping()}halt(n){return this.warp(this._effectiveTimeScale,0,n)}warp(n,r,a){const s=this._mixer,o=s.time,u=this.timeScale;let f=this._timeScaleInterpolant;f===null&&(f=s._lendControlInterpolant(),this._timeScaleInterpolant=f);const v=f.parameterPositions,m=f.sampleValues;return v[0]=o,v[1]=o+a,m[0]=n/u,m[1]=r/u,this}stopWarping(){const n=this._timeScaleInterpolant;return n!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(n)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(n,r,a,s){if(!this.enabled){this._updateWeight(n);return}const o=this._startTime;if(o!==null){const v=(n-o)*a;if(v<0||a===0)return;this._startTime=null,r=a*v}r*=this._updateTimeScale(n);const u=this._updateTime(r),f=this._updateWeight(n);if(f>0){const v=this._interpolants,m=this._propertyBindings;switch(this.blendMode){case PS:for(let g=0,y=v.length;g!==y;++g)v[g].evaluate(u),m[g].accumulateAdditive(f);break;case $b:default:for(let g=0,y=v.length;g!==y;++g)v[g].evaluate(u),m[g].accumulate(s,f)}}}_updateWeight(n){let r=0;if(this.enabled){r=this.weight;const a=this._weightInterpolant;if(a!==null){const s=a.evaluate(n)[0];r*=s,n>a.parameterPositions[1]&&(this.stopFading(),s===0&&(this.enabled=!1))}}return this._effectiveWeight=r,r}_updateTimeScale(n){let r=0;if(!this.paused){r=this.timeScale;const a=this._timeScaleInterpolant;a!==null&&(r*=a.evaluate(n)[0],n>a.parameterPositions[1]&&(this.stopWarping(),r===0?this.paused=!0:this.timeScale=r))}return this._effectiveTimeScale=r,r}_updateTime(n){const r=this._clip.duration,a=this.loop;let s=this.time+n,o=this._loopCount;const u=a===T6;if(n===0)return o===-1?s:u&&(o&1)==1?r-s:s;if(a===M6){o===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(s>=r)s=r;else if(s<0)s=0;else{this.time=s;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:n<0?-1:1})}}else{if(o===-1&&(n>=0?(o=0,this._setEndings(!0,this.repetitions===0,u)):this._setEndings(this.repetitions===0,!0,u)),s>=r||s<0){const f=Math.floor(s/r);s-=r*f,o+=Math.abs(f);const v=this.repetitions-o;if(v<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,s=n>0?r:0,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:n>0?1:-1});else{if(v===1){const m=n<0;this._setEndings(m,!m,u)}else this._setEndings(!1,!1,u);this._loopCount=o,this.time=s,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:f})}}else this.time=s;if(u&&(o&1)==1)return r-s}return s}_setEndings(n,r,a){const s=this._interpolantSettings;a?(s.endingStart=lh,s.endingEnd=lh):(n?s.endingStart=this.zeroSlopeAtStart?lh:sh:s.endingStart=Nv,r?s.endingEnd=this.zeroSlopeAtEnd?lh:sh:s.endingEnd=Nv)}_scheduleFading(n,r,a){const s=this._mixer,o=s.time;let u=this._weightInterpolant;u===null&&(u=s._lendControlInterpolant(),this._weightInterpolant=u);const f=u.parameterPositions,v=u.sampleValues;return f[0]=o,v[0]=r,f[1]=o+n,v[1]=a,this}}class zV extends uo{constructor(n){super();this._root=n,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(n,r){const a=n._localRoot||this._root,s=n._clip.tracks,o=s.length,u=n._propertyBindings,f=n._interpolants,v=a.uuid,m=this._bindingsByRootAndName;let g=m[v];g===void 0&&(g={},m[v]=g);for(let y=0;y!==o;++y){const b=s[y],w=b.name;let A=g[w];if(A!==void 0)u[y]=A;else{if(A=u[y],A!==void 0){A._cacheIndex===null&&(++A.referenceCount,this._addInactiveBinding(A,v,w));continue}const M=r&&r._propertyBindings[y].binding.parsedPath;A=new LV(ni.create(a,w,M),b.ValueTypeName,b.getValueSize()),++A.referenceCount,this._addInactiveBinding(A,v,w),u[y]=A}f[y].resultBuffer=A.buffer}}_activateAction(n){if(!this._isActiveAction(n)){if(n._cacheIndex===null){const a=(n._localRoot||this._root).uuid,s=n._clip.uuid,o=this._actionsByClip[s];this._bindAction(n,o&&o.knownActions[0]),this._addInactiveAction(n,s,a)}const r=n._propertyBindings;for(let a=0,s=r.length;a!==s;++a){const o=r[a];o.useCount++==0&&(this._lendBinding(o),o.saveOriginalState())}this._lendAction(n)}}_deactivateAction(n){if(this._isActiveAction(n)){const r=n._propertyBindings;for(let a=0,s=r.length;a!==s;++a){const o=r[a];--o.useCount==0&&(o.restoreOriginalState(),this._takeBackBinding(o))}this._takeBackAction(n)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const n=this;this.stats={actions:{get total(){return n._actions.length},get inUse(){return n._nActiveActions}},bindings:{get total(){return n._bindings.length},get inUse(){return n._nActiveBindings}},controlInterpolants:{get total(){return n._controlInterpolants.length},get inUse(){return n._nActiveControlInterpolants}}}}_isActiveAction(n){const r=n._cacheIndex;return r!==null&&r<this._nActiveActions}_addInactiveAction(n,r,a){const s=this._actions,o=this._actionsByClip;let u=o[r];if(u===void 0)u={knownActions:[n],actionByRoot:{}},n._byClipCacheIndex=0,o[r]=u;else{const f=u.knownActions;n._byClipCacheIndex=f.length,f.push(n)}n._cacheIndex=s.length,s.push(n),u.actionByRoot[a]=n}_removeInactiveAction(n){const r=this._actions,a=r[r.length-1],s=n._cacheIndex;a._cacheIndex=s,r[s]=a,r.pop(),n._cacheIndex=null;const o=n._clip.uuid,u=this._actionsByClip,f=u[o],v=f.knownActions,m=v[v.length-1],g=n._byClipCacheIndex;m._byClipCacheIndex=g,v[g]=m,v.pop(),n._byClipCacheIndex=null;const y=f.actionByRoot,b=(n._localRoot||this._root).uuid;delete y[b],v.length===0&&delete u[o],this._removeInactiveBindingsForAction(n)}_removeInactiveBindingsForAction(n){const r=n._propertyBindings;for(let a=0,s=r.length;a!==s;++a){const o=r[a];--o.referenceCount==0&&this._removeInactiveBinding(o)}}_lendAction(n){const r=this._actions,a=n._cacheIndex,s=this._nActiveActions++,o=r[s];n._cacheIndex=s,r[s]=n,o._cacheIndex=a,r[a]=o}_takeBackAction(n){const r=this._actions,a=n._cacheIndex,s=--this._nActiveActions,o=r[s];n._cacheIndex=s,r[s]=n,o._cacheIndex=a,r[a]=o}_addInactiveBinding(n,r,a){const s=this._bindingsByRootAndName,o=this._bindings;let u=s[r];u===void 0&&(u={},s[r]=u),u[a]=n,n._cacheIndex=o.length,o.push(n)}_removeInactiveBinding(n){const r=this._bindings,a=n.binding,s=a.rootNode.uuid,o=a.path,u=this._bindingsByRootAndName,f=u[s],v=r[r.length-1],m=n._cacheIndex;v._cacheIndex=m,r[m]=v,r.pop(),delete f[o],Object.keys(f).length===0&&delete u[s]}_lendBinding(n){const r=this._bindings,a=n._cacheIndex,s=this._nActiveBindings++,o=r[s];n._cacheIndex=s,r[s]=n,o._cacheIndex=a,r[a]=o}_takeBackBinding(n){const r=this._bindings,a=n._cacheIndex,s=--this._nActiveBindings,o=r[s];n._cacheIndex=s,r[s]=n,o._cacheIndex=a,r[a]=o}_lendControlInterpolant(){const n=this._controlInterpolants,r=this._nActiveControlInterpolants++;let a=n[r];return a===void 0&&(a=new v2(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),a.__cacheIndex=r,n[r]=a),a}_takeBackControlInterpolant(n){const r=this._controlInterpolants,a=n.__cacheIndex,s=--this._nActiveControlInterpolants,o=r[s];n.__cacheIndex=s,r[s]=n,o.__cacheIndex=a,r[a]=o}clipAction(n,r,a){const s=r||this._root,o=s.uuid;let u=typeof n=="string"?y2.findByName(s,n):n;const f=u!==null?u.uuid:n,v=this._actionsByClip[f];let m=null;if(a===void 0&&(u!==null?a=u.blendMode:a=$b),v!==void 0){const y=v.actionByRoot[o];if(y!==void 0&&y.blendMode===a)return y;m=v.knownActions[0],u===null&&(u=m._clip)}if(u===null)return null;const g=new HV(this,u,r,a);return this._bindAction(g,m),this._addInactiveAction(g,f,o),g}existingAction(n,r){const a=r||this._root,s=a.uuid,o=typeof n=="string"?y2.findByName(a,n):n,u=o?o.uuid:n,f=this._actionsByClip[u];return f!==void 0&&f.actionByRoot[s]||null}stopAllAction(){const n=this._actions,r=this._nActiveActions;for(let a=r-1;a>=0;--a)n[a].stop();return this}update(n){n*=this.timeScale;const r=this._actions,a=this._nActiveActions,s=this.time+=n,o=Math.sign(n),u=this._accuIndex^=1;for(let m=0;m!==a;++m)r[m]._update(s,n,o,u);const f=this._bindings,v=this._nActiveBindings;for(let m=0;m!==v;++m)f[m].apply(u);return this}setTime(n){this.time=0;for(let r=0;r<this._actions.length;r++)this._actions[r].time=0;return this.update(n)}getRoot(){return this._root}uncacheClip(n){const r=this._actions,a=n.uuid,s=this._actionsByClip,o=s[a];if(o!==void 0){const u=o.knownActions;for(let f=0,v=u.length;f!==v;++f){const m=u[f];this._deactivateAction(m);const g=m._cacheIndex,y=r[r.length-1];m._cacheIndex=null,m._byClipCacheIndex=null,y._cacheIndex=g,r[g]=y,r.pop(),this._removeInactiveBindingsForAction(m)}delete s[a]}}uncacheRoot(n){const r=n.uuid,a=this._actionsByClip;for(const u in a){const f=a[u].actionByRoot,v=f[r];v!==void 0&&(this._deactivateAction(v),this._removeInactiveAction(v))}const s=this._bindingsByRootAndName,o=s[r];if(o!==void 0)for(const u in o){const f=o[u];f.restoreOriginalState(),this._removeInactiveBinding(f)}}uncacheAction(n,r){const a=this.existingAction(n,r);a!==null&&(this._deactivateAction(a),this._removeInactiveAction(a))}}zV.prototype._controlInterpolantsResultBuffer=new Float32Array(1);class GV extends Pd{constructor(n,r,a=1){super(n,r);this.meshPerAttribute=a}copy(n){return super.copy(n),this.meshPerAttribute=n.meshPerAttribute,this}clone(n){const r=super.clone(n);return r.meshPerAttribute=this.meshPerAttribute,r}toJSON(n){const r=super.toJSON(n);return r.isInstancedInterleavedBuffer=!0,r.meshPerAttribute=this.meshPerAttribute,r}}GV.prototype.isInstancedInterleavedBuffer=!0;class O2{constructor(n,r,a=0,s=1/0){this.ray=new jc(n,r),this.near=a,this.far=s,this.camera=null,this.layers=new WS,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(n,r){this.ray.set(n,r)}setFromCamera(n,r){r&&r.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(r.matrixWorld),this.ray.direction.set(n.x,n.y,.5).unproject(r).sub(this.ray.origin).normalize(),this.camera=r):r&&r.isOrthographicCamera?(this.ray.origin.set(n.x,n.y,(r.near+r.far)/(r.near-r.far)).unproject(r),this.ray.direction.set(0,0,-1).transformDirection(r.matrixWorld),this.camera=r):console.error("THREE.Raycaster: Unsupported camera type: "+r.type)}intersectObject(n,r=!0,a=[]){return c1(n,this,a,r),a.sort(I2),a}intersectObjects(n,r=!0,a=[]){for(let s=0,o=n.length;s<o;s++)c1(n[s],this,a,r);return a.sort(I2),a}}function I2(i,n){return i.distance-n.distance}function c1(i,n,r,a){if(i.layers.test(n.layers)&&i.raycast(n,r),a===!0){const s=i.children;for(let o=0,u=s.length;o<u;o++)c1(s[o],n,r,!0)}}class u1{constructor(n=1,r=0,a=0){return this.radius=n,this.phi=r,this.theta=a,this}set(n,r,a){return this.radius=n,this.phi=r,this.theta=a,this}copy(n){return this.radius=n.radius,this.phi=n.phi,this.theta=n.theta,this}makeSafe(){const n=1e-6;return this.phi=Math.max(n,Math.min(Math.PI-n,this.phi)),this}setFromVector3(n){return this.setFromCartesianCoords(n.x,n.y,n.z)}setFromCartesianCoords(n,r,a){return this.radius=Math.sqrt(n*n+r*r+a*a),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(n,a),this.phi=Math.acos(Fa(r/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}const Yl=new Ze,Lg=new jn,h1=new jn;class VV extends zx{constructor(n){const r=k2(n),a=new Zr,s=[],o=[],u=new On(0,0,1),f=new On(0,1,0);for(let m=0;m<r.length;m++){const g=r[m];g.parent&&g.parent.isBone&&(s.push(0,0,0),s.push(0,0,0),o.push(u.r,u.g,u.b),o.push(f.r,f.g,f.b))}a.setAttribute("position",new Xr(s,3)),a.setAttribute("color",new Xr(o,3));const v=new kh({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(a,v);this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=n,this.bones=r,this.matrix=n.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(n){const r=this.bones,a=this.geometry,s=a.getAttribute("position");h1.copy(this.root.matrixWorld).invert();for(let o=0,u=0;o<r.length;o++){const f=r[o];f.parent&&f.parent.isBone&&(Lg.multiplyMatrices(h1,f.matrixWorld),Yl.setFromMatrixPosition(Lg),s.setXYZ(u,Yl.x,Yl.y,Yl.z),Lg.multiplyMatrices(h1,f.parent.matrixWorld),Yl.setFromMatrixPosition(Lg),s.setXYZ(u+1,Yl.x,Yl.y,Yl.z),u+=2)}a.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(n)}}function k2(i){const n=[];i&&i.isBone&&n.push(i);for(let r=0;r<i.children.length;r++)n.push.apply(n,k2(i.children[r]));return n}class WV extends zx{constructor(n=10,r=10,a=4473924,s=8947848){a=new On(a),s=new On(s);const o=r/2,u=n/r,f=n/2,v=[],m=[];for(let b=0,w=0,A=-f;b<=r;b++,A+=u){v.push(-f,0,A,f,0,A),v.push(A,0,-f,A,0,f);const M=b===o?a:s;M.toArray(m,w),w+=3,M.toArray(m,w),w+=3,M.toArray(m,w),w+=3,M.toArray(m,w),w+=3}const g=new Zr;g.setAttribute("position",new Xr(v,3)),g.setAttribute("color",new Xr(m,3));const y=new kh({vertexColors:!0,toneMapped:!1});super(g,y);this.type="GridHelper"}}const jV=new Float32Array(1);new Int32Array(jV.buffer);fo.create=function(i,n){return console.log("THREE.Curve.create() has been deprecated"),i.prototype=Object.create(fo.prototype),i.prototype.constructor=i,i.prototype.getPoint=n,i};Jx.prototype.fromPoints=function(i){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(i)};WV.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")};VV.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")};ql.prototype.extractUrlBase=function(i){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),AV.extractUrlBase(i)};ql.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}};Ja.prototype.center=function(i){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(i)};Ja.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()};Ja.prototype.isIntersectionBox=function(i){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(i)};Ja.prototype.isIntersectionSphere=function(i){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(i)};Ja.prototype.size=function(i){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(i)};mh.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()};og.prototype.setFromMatrix=function(i){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(i)};na.prototype.flattenToArrayOffset=function(i,n){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(i,n)};na.prototype.multiplyVector3=function(i){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),i.applyMatrix3(this)};na.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")};na.prototype.applyToBufferAttribute=function(i){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),i.applyMatrix3(this)};na.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")};na.prototype.getInverse=function(i){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(i).invert()};jn.prototype.extractPosition=function(i){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(i)};jn.prototype.flattenToArrayOffset=function(i,n){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(i,n)};jn.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new Ze().setFromMatrixColumn(this,3)};jn.prototype.setRotationFromQuaternion=function(i){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(i)};jn.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")};jn.prototype.multiplyVector3=function(i){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),i.applyMatrix4(this)};jn.prototype.multiplyVector4=function(i){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),i.applyMatrix4(this)};jn.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")};jn.prototype.rotateAxis=function(i){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),i.transformDirection(this)};jn.prototype.crossVector=function(i){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),i.applyMatrix4(this)};jn.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")};jn.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")};jn.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")};jn.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")};jn.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")};jn.prototype.applyToBufferAttribute=function(i){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),i.applyMatrix4(this)};jn.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")};jn.prototype.makeFrustum=function(i,n,r,a,s,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(i,n,a,r,s,o)};jn.prototype.getInverse=function(i){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(i).invert()};as.prototype.isIntersectionLine=function(i){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(i)};Ui.prototype.multiplyVector3=function(i){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),i.applyQuaternion(this)};Ui.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()};jc.prototype.isIntersectionBox=function(i){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(i)};jc.prototype.isIntersectionPlane=function(i){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(i)};jc.prototype.isIntersectionSphere=function(i){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(i)};Hi.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()};Hi.prototype.barycoordFromPoint=function(i,n){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(i,n)};Hi.prototype.midpoint=function(i){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(i)};Hi.prototypenormal=function(i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(i)};Hi.prototype.plane=function(i){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(i)};Hi.barycoordFromPoint=function(i,n,r,a,s){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Hi.getBarycoord(i,n,r,a,s)};Hi.normal=function(i,n,r,a){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Hi.getNormal(i,n,r,a)};Ud.prototype.extractAllPoints=function(i){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(i)};Ud.prototype.extrude=function(i){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Bh(this,i)};Ud.prototype.makeGeometry=function(i){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new n1(this,i)};Wt.prototype.fromAttribute=function(i,n,r){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(i,n,r)};Wt.prototype.distanceToManhattan=function(i){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(i)};Wt.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()};Ze.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")};Ze.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")};Ze.prototype.getPositionFromMatrix=function(i){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(i)};Ze.prototype.getScaleFromMatrix=function(i){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(i)};Ze.prototype.getColumnFromMatrix=function(i,n){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(n,i)};Ze.prototype.applyProjection=function(i){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(i)};Ze.prototype.fromAttribute=function(i,n,r){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(i,n,r)};Ze.prototype.distanceToManhattan=function(i){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(i)};Ze.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()};ci.prototype.fromAttribute=function(i,n,r){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(i,n,r)};ci.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()};ei.prototype.getChildByName=function(i){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(i)};ei.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")};ei.prototype.translate=function(i,n){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(n,i)};ei.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")};ei.prototype.applyMatrix=function(i){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(i)};Object.defineProperties(ei.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(i){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=i}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}});ra.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")};Object.defineProperties(ra.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),C6},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}});YT.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")};La.prototype.setLens=function(i,n){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),n!==void 0&&(this.filmGauge=n),this.setFocalLength(i)};Object.defineProperties(cs.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(i){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=i}},shadowCameraLeft:{set:function(i){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=i}},shadowCameraRight:{set:function(i){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=i}},shadowCameraTop:{set:function(i){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=i}},shadowCameraBottom:{set:function(i){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=i}},shadowCameraNear:{set:function(i){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=i}},shadowCameraFar:{set:function(i){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=i}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(i){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=i}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(i){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=i}},shadowMapHeight:{set:function(i){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=i}}});Object.defineProperties(zi.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Uv},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Uv)}}});zi.prototype.setDynamic=function(i){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(i===!0?Uv:Ad),this};zi.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},zi.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")};Zr.prototype.addIndex=function(i){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(i)};Zr.prototype.addAttribute=function(i,n){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),!(n&&n.isBufferAttribute)&&!(n&&n.isInterleavedBufferAttribute)?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(i,new zi(arguments[1],arguments[2]))):i==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(n),this):this.setAttribute(i,n)};Zr.prototype.addDrawCall=function(i,n,r){r!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(i,n)};Zr.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()};Zr.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")};Zr.prototype.removeAttribute=function(i){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(i)};Zr.prototype.applyMatrix=function(i){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(i)};Object.defineProperties(Zr.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}});Pd.prototype.setDynamic=function(i){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(i===!0?Uv:Ad),this};Pd.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")};Bh.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")};Bh.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")};Bh.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")};Fx.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")};Object.defineProperties(da.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new On}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(i){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=i===uS}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(i){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=i}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}});Object.defineProperties(Us.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(i){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=i}}});ti.prototype.clearTarget=function(i,n,r,a){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(i),this.clear(n,r,a)};ti.prototype.animate=function(i){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(i)};ti.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()};ti.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()};ti.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision};ti.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()};ti.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")};ti.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")};ti.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")};ti.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")};ti.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")};ti.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")};ti.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures};ti.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")};ti.prototype.enableScissorTest=function(i){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(i)};ti.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")};ti.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")};ti.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")};ti.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")};ti.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")};ti.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")};ti.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")};ti.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")};ti.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")};ti.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()};Object.defineProperties(ti.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(i){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=i}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(i){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=i}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(i){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=i===!0?Gc:fa}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}});Object.defineProperties(NT.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}});Object.defineProperties(Do.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(i){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=i}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(i){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=i}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(i){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=i}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(i){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=i}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(i){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=i}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(i){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=i}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(i){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=i}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(i){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=i}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(i){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=i}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(i){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=i}}});RV.prototype.load=function(i){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const n=this;return new SV().load(i,function(a){n.setBuffer(a)}),this};Mx.prototype.updateCubeMap=function(i,n){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(i,n)};Mx.prototype.clear=function(i,n,r,a){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(i,n,r,a)};hh.crossOrigin=void 0;hh.loadTexture=function(i,n,r,a){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const s=new x2;s.setCrossOrigin(this.crossOrigin);const o=s.load(i,r,void 0,a);return n&&(o.mapping=n),o};hh.loadTextureCube=function(i,n,r,a){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const s=new gV;s.setCrossOrigin(this.crossOrigin);const o=s.load(i,r,void 0,a);return n&&(o.mapping=n),o};hh.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")};hh.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:sS}}));typeof window!="undefined"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=sS);function XV(i,n){if(!(i instanceof n))throw new TypeError("Cannot call a class as a function")}function F2(i,n){for(var r=0;r<n.length;r++){var a=n[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(i,a.key,a)}}function qV(i,n,r){return n&&F2(i.prototype,n),r&&F2(i,r),i}function YV(i,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(n&&n.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),n&&f1(i,n)}function Pg(i){return Pg=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Pg(i)}function f1(i,n){return f1=Object.setPrototypeOf||function(a,s){return a.__proto__=s,a},f1(i,n)}function $V(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function KV(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function ZV(i,n){if(n&&(typeof n=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KV(i)}function QV(i){var n=$V();return function(){var a=Pg(i),s;if(n){var o=Pg(this).constructor;s=Reflect.construct(a,arguments,o)}else s=a.apply(this,arguments);return ZV(this,s)}}function B2(i,n){return e7(i)||n7(i,n)||N2(i,n)||i7()}function Dg(i){return JV(i)||t7(i)||N2(i)||r7()}function JV(i){if(Array.isArray(i))return d1(i)}function e7(i){if(Array.isArray(i))return i}function t7(i){if(typeof Symbol!="undefined"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function n7(i,n){var r=i==null?null:typeof Symbol!="undefined"&&i[Symbol.iterator]||i["@@iterator"];if(r!=null){var a=[],s=!0,o=!1,u,f;try{for(r=r.call(i);!(s=(u=r.next()).done)&&(a.push(u.value),!(n&&a.length===n));s=!0);}catch(v){o=!0,f=v}finally{try{!s&&r.return!=null&&r.return()}finally{if(o)throw f}}return a}}function N2(i,n){if(!!i){if(typeof i=="string")return d1(i,n);var r=Object.prototype.toString.call(i).slice(8,-1);if(r==="Object"&&i.constructor&&(r=i.constructor.name),r==="Map"||r==="Set")return Array.from(i);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d1(i,n)}}function d1(i,n){(n==null||n>i.length)&&(n=i.length);for(var r=0,a=new Array(n);r<n;r++)a[r]=i[r];return a}function r7(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function i7(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var jd=typeof window!="undefined"&&window.THREE?window.THREE:{LinearFilter:Ra,Sprite:VT,SpriteMaterial:Bx,Texture:qi},zZ=function(i){YV(r,i);var n=QV(r);function r(){var a,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:10,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"rgba(255, 255, 255, 1)";return XV(this,r),a=n.call(this,new jd.SpriteMaterial({map:new jd.Texture})),a._text="".concat(s),a._textHeight=o,a._color=u,a._backgroundColor=!1,a._padding=0,a._borderWidth=0,a._borderRadius=0,a._borderColor="white",a._strokeWidth=0,a._strokeColor="white",a._fontFace="Arial",a._fontSize=90,a._fontWeight="normal",a._canvas=document.createElement("canvas"),a._texture=a.material.map,a._texture.minFilter=jd.LinearFilter,a._genCanvas(),a}return qV(r,[{key:"text",get:function(){return this._text},set:function(s){this._text=s,this._genCanvas()}},{key:"textHeight",get:function(){return this._textHeight},set:function(s){this._textHeight=s,this._genCanvas()}},{key:"color",get:function(){return this._color},set:function(s){this._color=s,this._genCanvas()}},{key:"backgroundColor",get:function(){return this._backgroundColor},set:function(s){this._backgroundColor=s,this._genCanvas()}},{key:"padding",get:function(){return this._padding},set:function(s){this._padding=s,this._genCanvas()}},{key:"borderWidth",get:function(){return this._borderWidth},set:function(s){this._borderWidth=s,this._genCanvas()}},{key:"borderRadius",get:function(){return this._borderRadius},set:function(s){this._borderRadius=s,this._genCanvas()}},{key:"borderColor",get:function(){return this._borderColor},set:function(s){this._borderColor=s,this._genCanvas()}},{key:"fontFace",get:function(){return this._fontFace},set:function(s){this._fontFace=s,this._genCanvas()}},{key:"fontSize",get:function(){return this._fontSize},set:function(s){this._fontSize=s,this._genCanvas()}},{key:"fontWeight",get:function(){return this._fontWeight},set:function(s){this._fontWeight=s,this._genCanvas()}},{key:"strokeWidth",get:function(){return this._strokeWidth},set:function(s){this._strokeWidth=s,this._genCanvas()}},{key:"strokeColor",get:function(){return this._strokeColor},set:function(s){this._strokeColor=s,this._genCanvas()}},{key:"_genCanvas",value:function(){var s=this,o=this._canvas,u=o.getContext("2d"),f=Array.isArray(this.borderWidth)?this.borderWidth:[this.borderWidth,this.borderWidth],v=f.map(function(F){return F*s.fontSize*.1}),m=Array.isArray(this.borderRadius)?this.borderRadius:[this.borderRadius,this.borderRadius,this.borderRadius,this.borderRadius],g=m.map(function(F){return F*s.fontSize*.1}),y=Array.isArray(this.padding)?this.padding:[this.padding,this.padding],b=y.map(function(F){return F*s.fontSize*.1}),w=this.text.split(`
`),A="".concat(this.fontWeight," ").concat(this.fontSize,"px ").concat(this.fontFace);u.font=A;var M=Math.max.apply(Math,Dg(w.map(function(F){return u.measureText(F).width}))),S=this.fontSize*w.length;if(o.width=M+v[0]*2+b[0]*2,o.height=S+v[1]*2+b[1]*2,this.borderWidth){if(u.strokeStyle=this.borderColor,v[0]){var E=v[0]/2;u.lineWidth=v[0],u.beginPath(),u.moveTo(E,g[0]),u.lineTo(E,o.height-g[3]),u.moveTo(o.width-E,g[1]),u.lineTo(o.width-E,o.height-g[2]),u.stroke()}if(v[1]){var T=v[1]/2;u.lineWidth=v[1],u.beginPath(),u.moveTo(Math.max(v[0],g[0]),T),u.lineTo(o.width-Math.max(v[0],g[1]),T),u.moveTo(Math.max(v[0],g[3]),o.height-T),u.lineTo(o.width-Math.max(v[0],g[2]),o.height-T),u.stroke()}if(this.borderRadius){var C=Math.max.apply(Math,Dg(v)),L=C/2;u.lineWidth=C,u.beginPath(),[!!g[0]&&[g[0],L,L,g[0]],!!g[1]&&[o.width-g[1],o.width-L,L,g[1]],!!g[2]&&[o.width-g[2],o.width-L,o.height-L,o.height-g[2]],!!g[3]&&[g[3],L,o.height-L,o.height-g[3]]].filter(function(F){return F}).forEach(function(F){var X=B2(F,4),Y=X[0],ae=X[1],$=X[2],de=X[3];u.moveTo(Y,$),u.quadraticCurveTo(ae,$,ae,de)}),u.stroke()}}this.backgroundColor&&(u.fillStyle=this.backgroundColor,this.borderRadius?(u.beginPath(),u.moveTo(v[0],g[0]),[[v[0],g[0],o.width-g[1],v[1],v[1],v[1]],[o.width-v[0],o.width-v[0],o.width-v[0],v[1],g[1],o.height-g[2]],[o.width-v[0],o.width-g[2],g[3],o.height-v[1],o.height-v[1],o.height-v[1]],[v[0],v[0],v[0],o.height-v[1],o.height-g[3],g[0]]].forEach(function(F){var X=B2(F,6),Y=X[0],ae=X[1],$=X[2],de=X[3],D=X[4],I=X[5];u.quadraticCurveTo(Y,de,ae,D),u.lineTo($,I)}),u.closePath(),u.fill()):u.fillRect(v[0],v[1],o.width-v[0]*2,o.height-v[1]*2)),u.translate.apply(u,Dg(v)),u.translate.apply(u,Dg(b)),u.font=A,u.fillStyle=this.color,u.textBaseline="bottom";var P=this.strokeWidth>0;P&&(u.lineWidth=this.strokeWidth*this.fontSize/10,u.strokeStyle=this.strokeColor),w.forEach(function(F,X){var Y=(M-u.measureText(F).width)/2,ae=(X+1)*s.fontSize;P&&u.strokeText(F,Y,ae),u.fillText(F,Y,ae)}),this._texture.image=o,this._texture.needsUpdate=!0;var N=this.textHeight*w.length+f[1]*2+y[1]*2;this.scale.set(N*o.width/o.height,N,0)}},{key:"clone",value:function(){return new this.constructor(this.text,this.textHeight,this.color).copy(this)}},{key:"copy",value:function(s){return jd.Sprite.prototype.copy.call(this,s),this.color=s.color,this.backgroundColor=s.backgroundColor,this.padding=s.padding,this.borderWidth=s.borderWidth,this.borderColor=s.borderColor,this.fontFace=s.fontFace,this.fontSize=s.fontSize,this.fontWeight=s.fontWeight,this.strokeWidth=s.strokeWidth,this.strokeColor=s.strokeColor,this}}]),r}(jd.Sprite);const Xd=(i,n)=>{if(i.install=function(r){for(const a of[i,...Object.values(n!=null?n:{})])r.component(a.name,a)},n)for(const[r,a]of Object.entries(n))i[r]=a;return i},a7=i=>(i.install=()=>{},i);function U2(i,...n){!i.token&&(i.token=Symbol()),ed(i.token,i(...n))}function H2(i){const n=typeof i=="symbol"?i:i.token;return es(n)}let z2=i=>i,G2=i=>i;function o7(i,n){return Object.fromEntries(Object.keys(i).filter(r=>!n.includes(r)).map(r=>[r,i[r]]))}function Og(i,n){const{wrapperElementType:r="div",methodNames:a=[],initPropNames:s=[],props:o={},name:u=""}=n;return td({name:u,props:o,setup(f,{expose:v,slots:m}){const g=hb(null),y=i(A());U2(z2,y);const b=o7(f,[...a,...s]),w=Object.fromEntries(a.map(T=>[T,y[T]]));function A(){return Object.fromEntries(s.filter(T=>f.hasOwnProperty(T)).map(T=>[T,f[T]]))}function M(T,...C){y[T]instanceof Function&&y[T](...C)}MM(()=>{Object.keys(b).forEach(T=>{f[T]!==void 0&&M(T,f[T])})});function S(){y(g.value),E(),window.addEventListener("resize",E)}function E(){y.height(window.innerHeight).width(window.innerWidth)}return mb(()=>{S()}),vb(()=>{y._destructor instanceof Function&&y._destructor(),window.removeEventListener("resize",E)}),v(Object.assign(Object.assign({},w),{graphContext:y})),()=>Sv(r,{},[Sv(r,{ref:g}),m.default!==void 0?m.default():void 0])}})}var p1="http://www.w3.org/1999/xhtml",V2={svg:"http://www.w3.org/2000/svg",xhtml:p1,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Ig(i){var n=i+="",r=n.indexOf(":");return r>=0&&(n=i.slice(0,r))!=="xmlns"&&(i=i.slice(r+1)),V2.hasOwnProperty(n)?{space:V2[n],local:i}:i}function s7(i){return function(){var n=this.ownerDocument,r=this.namespaceURI;return r===p1&&n.documentElement.namespaceURI===p1?n.createElement(i):n.createElementNS(r,i)}}function l7(i){return function(){return this.ownerDocument.createElementNS(i.space,i.local)}}function W2(i){var n=Ig(i);return(n.local?l7:s7)(n)}function c7(){}function m1(i){return i==null?c7:function(){return this.querySelector(i)}}function u7(i){typeof i!="function"&&(i=m1(i));for(var n=this._groups,r=n.length,a=new Array(r),s=0;s<r;++s)for(var o=n[s],u=o.length,f=a[s]=new Array(u),v,m,g=0;g<u;++g)(v=o[g])&&(m=i.call(v,v.__data__,g,o))&&("__data__"in v&&(m.__data__=v.__data__),f[g]=m);return new no(a,this._parents)}function h7(i){return i==null?[]:Array.isArray(i)?i:Array.from(i)}function f7(){return[]}function j2(i){return i==null?f7:function(){return this.querySelectorAll(i)}}function d7(i){return function(){return h7(i.apply(this,arguments))}}function p7(i){typeof i=="function"?i=d7(i):i=j2(i);for(var n=this._groups,r=n.length,a=[],s=[],o=0;o<r;++o)for(var u=n[o],f=u.length,v,m=0;m<f;++m)(v=u[m])&&(a.push(i.call(v,v.__data__,m,u)),s.push(v));return new no(a,s)}function X2(i){return function(){return this.matches(i)}}function q2(i){return function(n){return n.matches(i)}}var m7=Array.prototype.find;function v7(i){return function(){return m7.call(this.children,i)}}function g7(){return this.firstElementChild}function y7(i){return this.select(i==null?g7:v7(typeof i=="function"?i:q2(i)))}var b7=Array.prototype.filter;function x7(){return Array.from(this.children)}function w7(i){return function(){return b7.call(this.children,i)}}function A7(i){return this.selectAll(i==null?x7:w7(typeof i=="function"?i:q2(i)))}function E7(i){typeof i!="function"&&(i=X2(i));for(var n=this._groups,r=n.length,a=new Array(r),s=0;s<r;++s)for(var o=n[s],u=o.length,f=a[s]=[],v,m=0;m<u;++m)(v=o[m])&&i.call(v,v.__data__,m,o)&&f.push(v);return new no(a,this._parents)}function Y2(i){return new Array(i.length)}function _7(){return new no(this._enter||this._groups.map(Y2),this._parents)}function kg(i,n){this.ownerDocument=i.ownerDocument,this.namespaceURI=i.namespaceURI,this._next=null,this._parent=i,this.__data__=n}kg.prototype={constructor:kg,appendChild:function(i){return this._parent.insertBefore(i,this._next)},insertBefore:function(i,n){return this._parent.insertBefore(i,n)},querySelector:function(i){return this._parent.querySelector(i)},querySelectorAll:function(i){return this._parent.querySelectorAll(i)}};function M7(i){return function(){return i}}function S7(i,n,r,a,s,o){for(var u=0,f,v=n.length,m=o.length;u<m;++u)(f=n[u])?(f.__data__=o[u],a[u]=f):r[u]=new kg(i,o[u]);for(;u<v;++u)(f=n[u])&&(s[u]=f)}function T7(i,n,r,a,s,o,u){var f,v,m=new Map,g=n.length,y=o.length,b=new Array(g),w;for(f=0;f<g;++f)(v=n[f])&&(b[f]=w=u.call(v,v.__data__,f,n)+"",m.has(w)?s[f]=v:m.set(w,v));for(f=0;f<y;++f)w=u.call(i,o[f],f,o)+"",(v=m.get(w))?(a[f]=v,v.__data__=o[f],m.delete(w)):r[f]=new kg(i,o[f]);for(f=0;f<g;++f)(v=n[f])&&m.get(b[f])===v&&(s[f]=v)}function C7(i){return i.__data__}function R7(i,n){if(!arguments.length)return Array.from(this,C7);var r=n?T7:S7,a=this._parents,s=this._groups;typeof i!="function"&&(i=M7(i));for(var o=s.length,u=new Array(o),f=new Array(o),v=new Array(o),m=0;m<o;++m){var g=a[m],y=s[m],b=y.length,w=L7(i.call(g,g&&g.__data__,m,a)),A=w.length,M=f[m]=new Array(A),S=u[m]=new Array(A),E=v[m]=new Array(b);r(g,y,M,S,E,w,n);for(var T=0,C=0,L,P;T<A;++T)if(L=M[T]){for(T>=C&&(C=T+1);!(P=S[C])&&++C<A;);L._next=P||null}}return u=new no(u,a),u._enter=f,u._exit=v,u}function L7(i){return typeof i=="object"&&"length"in i?i:Array.from(i)}function P7(){return new no(this._exit||this._groups.map(Y2),this._parents)}function D7(i,n,r){var a=this.enter(),s=this,o=this.exit();return typeof i=="function"?(a=i(a),a&&(a=a.selection())):a=a.append(i+""),n!=null&&(s=n(s),s&&(s=s.selection())),r==null?o.remove():r(o),a&&s?a.merge(s).order():s}function O7(i){for(var n=i.selection?i.selection():i,r=this._groups,a=n._groups,s=r.length,o=a.length,u=Math.min(s,o),f=new Array(s),v=0;v<u;++v)for(var m=r[v],g=a[v],y=m.length,b=f[v]=new Array(y),w,A=0;A<y;++A)(w=m[A]||g[A])&&(b[A]=w);for(;v<s;++v)f[v]=r[v];return new no(f,this._parents)}function I7(){for(var i=this._groups,n=-1,r=i.length;++n<r;)for(var a=i[n],s=a.length-1,o=a[s],u;--s>=0;)(u=a[s])&&(o&&u.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(u,o),o=u);return this}function k7(i){i||(i=F7);function n(y,b){return y&&b?i(y.__data__,b.__data__):!y-!b}for(var r=this._groups,a=r.length,s=new Array(a),o=0;o<a;++o){for(var u=r[o],f=u.length,v=s[o]=new Array(f),m,g=0;g<f;++g)(m=u[g])&&(v[g]=m);v.sort(n)}return new no(s,this._parents).order()}function F7(i,n){return i<n?-1:i>n?1:i>=n?0:NaN}function B7(){var i=arguments[0];return arguments[0]=this,i.apply(null,arguments),this}function N7(){return Array.from(this)}function U7(){for(var i=this._groups,n=0,r=i.length;n<r;++n)for(var a=i[n],s=0,o=a.length;s<o;++s){var u=a[s];if(u)return u}return null}function H7(){let i=0;for(const n of this)++i;return i}function z7(){return!this.node()}function G7(i){for(var n=this._groups,r=0,a=n.length;r<a;++r)for(var s=n[r],o=0,u=s.length,f;o<u;++o)(f=s[o])&&i.call(f,f.__data__,o,s);return this}function V7(i){return function(){this.removeAttribute(i)}}function W7(i){return function(){this.removeAttributeNS(i.space,i.local)}}function j7(i,n){return function(){this.setAttribute(i,n)}}function X7(i,n){return function(){this.setAttributeNS(i.space,i.local,n)}}function q7(i,n){return function(){var r=n.apply(this,arguments);r==null?this.removeAttribute(i):this.setAttribute(i,r)}}function Y7(i,n){return function(){var r=n.apply(this,arguments);r==null?this.removeAttributeNS(i.space,i.local):this.setAttributeNS(i.space,i.local,r)}}function $7(i,n){var r=Ig(i);if(arguments.length<2){var a=this.node();return r.local?a.getAttributeNS(r.space,r.local):a.getAttribute(r)}return this.each((n==null?r.local?W7:V7:typeof n=="function"?r.local?Y7:q7:r.local?X7:j7)(r,n))}function $2(i){return i.ownerDocument&&i.ownerDocument.defaultView||i.document&&i||i.defaultView}function K7(i){return function(){this.style.removeProperty(i)}}function Z7(i,n,r){return function(){this.style.setProperty(i,n,r)}}function Q7(i,n,r){return function(){var a=n.apply(this,arguments);a==null?this.style.removeProperty(i):this.style.setProperty(i,a,r)}}function J7(i,n,r){return arguments.length>1?this.each((n==null?K7:typeof n=="function"?Q7:Z7)(i,n,r==null?"":r)):zh(this.node(),i)}function zh(i,n){return i.style.getPropertyValue(n)||$2(i).getComputedStyle(i,null).getPropertyValue(n)}function e9(i){return function(){delete this[i]}}function t9(i,n){return function(){this[i]=n}}function n9(i,n){return function(){var r=n.apply(this,arguments);r==null?delete this[i]:this[i]=r}}function r9(i,n){return arguments.length>1?this.each((n==null?e9:typeof n=="function"?n9:t9)(i,n)):this.node()[i]}function K2(i){return i.trim().split(/^|\s+/)}function v1(i){return i.classList||new Z2(i)}function Z2(i){this._node=i,this._names=K2(i.getAttribute("class")||"")}Z2.prototype={add:function(i){var n=this._names.indexOf(i);n<0&&(this._names.push(i),this._node.setAttribute("class",this._names.join(" ")))},remove:function(i){var n=this._names.indexOf(i);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(i){return this._names.indexOf(i)>=0}};function Q2(i,n){for(var r=v1(i),a=-1,s=n.length;++a<s;)r.add(n[a])}function J2(i,n){for(var r=v1(i),a=-1,s=n.length;++a<s;)r.remove(n[a])}function i9(i){return function(){Q2(this,i)}}function a9(i){return function(){J2(this,i)}}function o9(i,n){return function(){(n.apply(this,arguments)?Q2:J2)(this,i)}}function s9(i,n){var r=K2(i+"");if(arguments.length<2){for(var a=v1(this.node()),s=-1,o=r.length;++s<o;)if(!a.contains(r[s]))return!1;return!0}return this.each((typeof n=="function"?o9:n?i9:a9)(r,n))}function l9(){this.textContent=""}function c9(i){return function(){this.textContent=i}}function u9(i){return function(){var n=i.apply(this,arguments);this.textContent=n==null?"":n}}function h9(i){return arguments.length?this.each(i==null?l9:(typeof i=="function"?u9:c9)(i)):this.node().textContent}function f9(){this.innerHTML=""}function d9(i){return function(){this.innerHTML=i}}function p9(i){return function(){var n=i.apply(this,arguments);this.innerHTML=n==null?"":n}}function m9(i){return arguments.length?this.each(i==null?f9:(typeof i=="function"?p9:d9)(i)):this.node().innerHTML}function v9(){this.nextSibling&&this.parentNode.appendChild(this)}function g9(){return this.each(v9)}function y9(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function b9(){return this.each(y9)}function x9(i){var n=typeof i=="function"?i:W2(i);return this.select(function(){return this.appendChild(n.apply(this,arguments))})}function w9(){return null}function A9(i,n){var r=typeof i=="function"?i:W2(i),a=n==null?w9:typeof n=="function"?n:m1(n);return this.select(function(){return this.insertBefore(r.apply(this,arguments),a.apply(this,arguments)||null)})}function E9(){var i=this.parentNode;i&&i.removeChild(this)}function _9(){return this.each(E9)}function M9(){var i=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(i,this.nextSibling):i}function S9(){var i=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(i,this.nextSibling):i}function T9(i){return this.select(i?S9:M9)}function C9(i){return arguments.length?this.property("__data__",i):this.node().__data__}function R9(i){return function(n){i.call(this,n,this.__data__)}}function L9(i){return i.trim().split(/^|\s+/).map(function(n){var r="",a=n.indexOf(".");return a>=0&&(r=n.slice(a+1),n=n.slice(0,a)),{type:n,name:r}})}function P9(i){return function(){var n=this.__on;if(!!n){for(var r=0,a=-1,s=n.length,o;r<s;++r)o=n[r],(!i.type||o.type===i.type)&&o.name===i.name?this.removeEventListener(o.type,o.listener,o.options):n[++a]=o;++a?n.length=a:delete this.__on}}}function D9(i,n,r){return function(){var a=this.__on,s,o=R9(n);if(a){for(var u=0,f=a.length;u<f;++u)if((s=a[u]).type===i.type&&s.name===i.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=o,s.options=r),s.value=n;return}}this.addEventListener(i.type,o,r),s={type:i.type,name:i.name,value:n,listener:o,options:r},a?a.push(s):this.__on=[s]}}function O9(i,n,r){var a=L9(i+""),s,o=a.length,u;if(arguments.length<2){var f=this.node().__on;if(f){for(var v=0,m=f.length,g;v<m;++v)for(s=0,g=f[v];s<o;++s)if((u=a[s]).type===g.type&&u.name===g.name)return g.value}return}for(f=n?D9:P9,s=0;s<o;++s)this.each(f(a[s],n,r));return this}function eC(i,n,r){var a=$2(i),s=a.CustomEvent;typeof s=="function"?s=new s(n,r):(s=a.document.createEvent("Event"),r?(s.initEvent(n,r.bubbles,r.cancelable),s.detail=r.detail):s.initEvent(n,!1,!1)),i.dispatchEvent(s)}function I9(i,n){return function(){return eC(this,i,n)}}function k9(i,n){return function(){return eC(this,i,n.apply(this,arguments))}}function F9(i,n){return this.each((typeof n=="function"?k9:I9)(i,n))}function*B9(){for(var i=this._groups,n=0,r=i.length;n<r;++n)for(var a=i[n],s=0,o=a.length,u;s<o;++s)(u=a[s])&&(yield u)}var tC=[null];function no(i,n){this._groups=i,this._parents=n}function qd(){return new no([[document.documentElement]],tC)}function N9(){return this}no.prototype=qd.prototype={constructor:no,select:u7,selectAll:p7,selectChild:y7,selectChildren:A7,filter:E7,data:R7,enter:_7,exit:P7,join:D7,merge:O7,selection:N9,order:I7,sort:k7,call:B7,nodes:N7,node:U7,size:H7,empty:z7,each:G7,attr:$7,style:J7,property:r9,classed:s9,text:h9,html:m9,raise:g9,lower:b9,append:x9,insert:A9,remove:_9,clone:T9,datum:C9,on:O9,dispatch:F9,[Symbol.iterator]:B9};function Fo(i){return typeof i=="string"?new no([[document.querySelector(i)]],[document.documentElement]):new no([[i]],tC)}function U9(i){let n;for(;n=i.sourceEvent;)i=n;return i}function zs(i,n){if(i=U9(i),n===void 0&&(n=i.currentTarget),n){var r=n.ownerSVGElement||n;if(r.createSVGPoint){var a=r.createSVGPoint();return a.x=i.clientX,a.y=i.clientY,a=a.matrixTransform(n.getScreenCTM().inverse()),[a.x,a.y]}if(n.getBoundingClientRect){var s=n.getBoundingClientRect();return[i.clientX-s.left-n.clientLeft,i.clientY-s.top-n.clientTop]}}return[i.pageX,i.pageY]}var H9={value:()=>{}};function Yd(){for(var i=0,n=arguments.length,r={},a;i<n;++i){if(!(a=arguments[i]+"")||a in r||/[\s.]/.test(a))throw new Error("illegal type: "+a);r[a]=[]}return new Fg(r)}function Fg(i){this._=i}function z9(i,n){return i.trim().split(/^|\s+/).map(function(r){var a="",s=r.indexOf(".");if(s>=0&&(a=r.slice(s+1),r=r.slice(0,s)),r&&!n.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:a}})}Fg.prototype=Yd.prototype={constructor:Fg,on:function(i,n){var r=this._,a=z9(i+"",r),s,o=-1,u=a.length;if(arguments.length<2){for(;++o<u;)if((s=(i=a[o]).type)&&(s=G9(r[s],i.name)))return s;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++o<u;)if(s=(i=a[o]).type)r[s]=nC(r[s],i.name,n);else if(n==null)for(s in r)r[s]=nC(r[s],i.name,null);return this},copy:function(){var i={},n=this._;for(var r in n)i[r]=n[r].slice();return new Fg(i)},call:function(i,n){if((s=arguments.length-2)>0)for(var r=new Array(s),a=0,s,o;a<s;++a)r[a]=arguments[a+2];if(!this._.hasOwnProperty(i))throw new Error("unknown type: "+i);for(o=this._[i],a=0,s=o.length;a<s;++a)o[a].value.apply(n,r)},apply:function(i,n,r){if(!this._.hasOwnProperty(i))throw new Error("unknown type: "+i);for(var a=this._[i],s=0,o=a.length;s<o;++s)a[s].value.apply(n,r)}};function G9(i,n){for(var r=0,a=i.length,s;r<a;++r)if((s=i[r]).name===n)return s.value}function nC(i,n,r){for(var a=0,s=i.length;a<s;++a)if(i[a].name===n){i[a]=H9,i=i.slice(0,a).concat(i.slice(a+1));break}return r!=null&&i.push({name:n,value:r}),i}const V9={passive:!1},$d={capture:!0,passive:!1};function g1(i){i.stopImmediatePropagation()}function Gh(i){i.preventDefault(),i.stopImmediatePropagation()}function rC(i){var n=i.document.documentElement,r=Fo(i).on("dragstart.drag",Gh,$d);"onselectstart"in n?r.on("selectstart.drag",Gh,$d):(n.__noselect=n.style.MozUserSelect,n.style.MozUserSelect="none")}function iC(i,n){var r=i.document.documentElement,a=Fo(i).on("dragstart.drag",null);n&&(a.on("click.drag",Gh,$d),setTimeout(function(){a.on("click.drag",null)},0)),"onselectstart"in r?a.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}var Bg=i=>()=>i;function y1(i,{sourceEvent:n,subject:r,target:a,identifier:s,active:o,x:u,y:f,dx:v,dy:m,dispatch:g}){Object.defineProperties(this,{type:{value:i,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:a,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:u,enumerable:!0,configurable:!0},y:{value:f,enumerable:!0,configurable:!0},dx:{value:v,enumerable:!0,configurable:!0},dy:{value:m,enumerable:!0,configurable:!0},_:{value:g}})}y1.prototype.on=function(){var i=this._.on.apply(this._,arguments);return i===this._?this:i};function W9(i){return!i.ctrlKey&&!i.button}function j9(){return this.parentNode}function X9(i,n){return n==null?{x:i.x,y:i.y}:n}function q9(){return navigator.maxTouchPoints||"ontouchstart"in this}function Y9(){var i=W9,n=j9,r=X9,a=q9,s={},o=Yd("start","drag","end"),u=0,f,v,m,g,y=0;function b(L){L.on("mousedown.drag",w).filter(a).on("touchstart.drag",S).on("touchmove.drag",E,V9).on("touchend.drag touchcancel.drag",T).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function w(L,P){if(!(g||!i.call(this,L,P))){var N=C(this,n.call(this,L,P),L,P,"mouse");!N||(Fo(L.view).on("mousemove.drag",A,$d).on("mouseup.drag",M,$d),rC(L.view),g1(L),m=!1,f=L.clientX,v=L.clientY,N("start",L))}}function A(L){if(Gh(L),!m){var P=L.clientX-f,N=L.clientY-v;m=P*P+N*N>y}s.mouse("drag",L)}function M(L){Fo(L.view).on("mousemove.drag mouseup.drag",null),iC(L.view,m),Gh(L),s.mouse("end",L)}function S(L,P){if(!!i.call(this,L,P)){var N=L.changedTouches,F=n.call(this,L,P),X=N.length,Y,ae;for(Y=0;Y<X;++Y)(ae=C(this,F,L,P,N[Y].identifier,N[Y]))&&(g1(L),ae("start",L,N[Y]))}}function E(L){var P=L.changedTouches,N=P.length,F,X;for(F=0;F<N;++F)(X=s[P[F].identifier])&&(Gh(L),X("drag",L,P[F]))}function T(L){var P=L.changedTouches,N=P.length,F,X;for(g&&clearTimeout(g),g=setTimeout(function(){g=null},500),F=0;F<N;++F)(X=s[P[F].identifier])&&(g1(L),X("end",L,P[F]))}function C(L,P,N,F,X,Y){var ae=o.copy(),$=zs(Y||N,P),de,D,I;if((I=r.call(L,new y1("beforestart",{sourceEvent:N,target:b,identifier:X,active:u,x:$[0],y:$[1],dx:0,dy:0,dispatch:ae}),F))!=null)return de=I.x-$[0]||0,D=I.y-$[1]||0,function k(U,W,ce){var oe=$,ge;switch(U){case"start":s[X]=k,ge=u++;break;case"end":delete s[X],--u;case"drag":$=zs(ce||W,P),ge=u;break}ae.call(U,L,new y1(U,{sourceEvent:W,subject:I,target:b,identifier:X,active:ge,x:$[0]+de,y:$[1]+D,dx:$[0]-oe[0],dy:$[1]-oe[1],dispatch:ae}),F)}}return b.filter=function(L){return arguments.length?(i=typeof L=="function"?L:Bg(!!L),b):i},b.container=function(L){return arguments.length?(n=typeof L=="function"?L:Bg(L),b):n},b.subject=function(L){return arguments.length?(r=typeof L=="function"?L:Bg(L),b):r},b.touchable=function(L){return arguments.length?(a=typeof L=="function"?L:Bg(!!L),b):a},b.on=function(){var L=o.on.apply(o,arguments);return L===o?b:L},b.clickDistance=function(L){return arguments.length?(y=(L=+L)*L,b):Math.sqrt(y)},b}function b1(i,n,r){i.prototype=n.prototype=r,r.constructor=i}function aC(i,n){var r=Object.create(i.prototype);for(var a in n)r[a]=n[a];return r}function Kd(){}var Zd=.7,Ng=1/Zd,Vh="\\s*([+-]?\\d+)\\s*",Qd="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",us="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",$9=/^#([0-9a-f]{3,8})$/,K9=new RegExp("^rgb\\("+[Vh,Vh,Vh]+"\\)$"),Z9=new RegExp("^rgb\\("+[us,us,us]+"\\)$"),Q9=new RegExp("^rgba\\("+[Vh,Vh,Vh,Qd]+"\\)$"),J9=new RegExp("^rgba\\("+[us,us,us,Qd]+"\\)$"),eW=new RegExp("^hsl\\("+[Qd,us,us]+"\\)$"),tW=new RegExp("^hsla\\("+[Qd,us,us,Qd]+"\\)$"),oC={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};b1(Kd,Jd,{copy:function(i){return Object.assign(new this.constructor,this,i)},displayable:function(){return this.rgb().displayable()},hex:sC,formatHex:sC,formatHsl:nW,formatRgb:lC,toString:lC});function sC(){return this.rgb().formatHex()}function nW(){return dC(this).formatHsl()}function lC(){return this.rgb().formatRgb()}function Jd(i){var n,r;return i=(i+"").trim().toLowerCase(),(n=$9.exec(i))?(r=n[1].length,n=parseInt(n[1],16),r===6?cC(n):r===3?new ro(n>>8&15|n>>4&240,n>>4&15|n&240,(n&15)<<4|n&15,1):r===8?Ug(n>>24&255,n>>16&255,n>>8&255,(n&255)/255):r===4?Ug(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|n&240,((n&15)<<4|n&15)/255):null):(n=K9.exec(i))?new ro(n[1],n[2],n[3],1):(n=Z9.exec(i))?new ro(n[1]*255/100,n[2]*255/100,n[3]*255/100,1):(n=Q9.exec(i))?Ug(n[1],n[2],n[3],n[4]):(n=J9.exec(i))?Ug(n[1]*255/100,n[2]*255/100,n[3]*255/100,n[4]):(n=eW.exec(i))?fC(n[1],n[2]/100,n[3]/100,1):(n=tW.exec(i))?fC(n[1],n[2]/100,n[3]/100,n[4]):oC.hasOwnProperty(i)?cC(oC[i]):i==="transparent"?new ro(NaN,NaN,NaN,0):null}function cC(i){return new ro(i>>16&255,i>>8&255,i&255,1)}function Ug(i,n,r,a){return a<=0&&(i=n=r=NaN),new ro(i,n,r,a)}function rW(i){return i instanceof Kd||(i=Jd(i)),i?(i=i.rgb(),new ro(i.r,i.g,i.b,i.opacity)):new ro}function x1(i,n,r,a){return arguments.length===1?rW(i):new ro(i,n,r,a==null?1:a)}function ro(i,n,r,a){this.r=+i,this.g=+n,this.b=+r,this.opacity=+a}b1(ro,x1,aC(Kd,{brighter:function(i){return i=i==null?Ng:Math.pow(Ng,i),new ro(this.r*i,this.g*i,this.b*i,this.opacity)},darker:function(i){return i=i==null?Zd:Math.pow(Zd,i),new ro(this.r*i,this.g*i,this.b*i,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:uC,formatHex:uC,formatRgb:hC,toString:hC}));function uC(){return"#"+w1(this.r)+w1(this.g)+w1(this.b)}function hC(){var i=this.opacity;return i=isNaN(i)?1:Math.max(0,Math.min(1,i)),(i===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(i===1?")":", "+i+")")}function w1(i){return i=Math.max(0,Math.min(255,Math.round(i)||0)),(i<16?"0":"")+i.toString(16)}function fC(i,n,r,a){return a<=0?i=n=r=NaN:r<=0||r>=1?i=n=NaN:n<=0&&(i=NaN),new hs(i,n,r,a)}function dC(i){if(i instanceof hs)return new hs(i.h,i.s,i.l,i.opacity);if(i instanceof Kd||(i=Jd(i)),!i)return new hs;if(i instanceof hs)return i;i=i.rgb();var n=i.r/255,r=i.g/255,a=i.b/255,s=Math.min(n,r,a),o=Math.max(n,r,a),u=NaN,f=o-s,v=(o+s)/2;return f?(n===o?u=(r-a)/f+(r<a)*6:r===o?u=(a-n)/f+2:u=(n-r)/f+4,f/=v<.5?o+s:2-o-s,u*=60):f=v>0&&v<1?0:u,new hs(u,f,v,i.opacity)}function iW(i,n,r,a){return arguments.length===1?dC(i):new hs(i,n,r,a==null?1:a)}function hs(i,n,r,a){this.h=+i,this.s=+n,this.l=+r,this.opacity=+a}b1(hs,iW,aC(Kd,{brighter:function(i){return i=i==null?Ng:Math.pow(Ng,i),new hs(this.h,this.s,this.l*i,this.opacity)},darker:function(i){return i=i==null?Zd:Math.pow(Zd,i),new hs(this.h,this.s,this.l*i,this.opacity)},rgb:function(){var i=this.h%360+(this.h<0)*360,n=isNaN(i)||isNaN(this.s)?0:this.s,r=this.l,a=r+(r<.5?r:1-r)*n,s=2*r-a;return new ro(A1(i>=240?i-240:i+120,s,a),A1(i,s,a),A1(i<120?i+240:i-120,s,a),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var i=this.opacity;return i=isNaN(i)?1:Math.max(0,Math.min(1,i)),(i===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(i===1?")":", "+i+")")}}));function A1(i,n,r){return(i<60?n+(r-n)*i/60:i<180?r:i<240?n+(r-n)*(240-i)/60:n)*255}var pC=i=>()=>i;function aW(i,n){return function(r){return i+r*n}}function oW(i,n,r){return i=Math.pow(i,r),n=Math.pow(n,r)-i,r=1/r,function(a){return Math.pow(i+a*n,r)}}function sW(i){return(i=+i)==1?mC:function(n,r){return r-n?oW(n,r,i):pC(isNaN(n)?r:n)}}function mC(i,n){var r=n-i;return r?aW(i,r):pC(isNaN(i)?n:i)}var vC=function i(n){var r=sW(n);function a(s,o){var u=r((s=x1(s)).r,(o=x1(o)).r),f=r(s.g,o.g),v=r(s.b,o.b),m=mC(s.opacity,o.opacity);return function(g){return s.r=u(g),s.g=f(g),s.b=v(g),s.opacity=m(g),s+""}}return a.gamma=i,a}(1);function $l(i,n){return i=+i,n=+n,function(r){return i*(1-r)+n*r}}var E1=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,_1=new RegExp(E1.source,"g");function lW(i){return function(){return i}}function cW(i){return function(n){return i(n)+""}}function uW(i,n){var r=E1.lastIndex=_1.lastIndex=0,a,s,o,u=-1,f=[],v=[];for(i=i+"",n=n+"";(a=E1.exec(i))&&(s=_1.exec(n));)(o=s.index)>r&&(o=n.slice(r,o),f[u]?f[u]+=o:f[++u]=o),(a=a[0])===(s=s[0])?f[u]?f[u]+=s:f[++u]=s:(f[++u]=null,v.push({i:u,x:$l(a,s)})),r=_1.lastIndex;return r<n.length&&(o=n.slice(r),f[u]?f[u]+=o:f[++u]=o),f.length<2?v[0]?cW(v[0].x):lW(n):(n=v.length,function(m){for(var g=0,y;g<n;++g)f[(y=v[g]).i]=y.x(m);return f.join("")})}var gC=180/Math.PI,M1={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function yC(i,n,r,a,s,o){var u,f,v;return(u=Math.sqrt(i*i+n*n))&&(i/=u,n/=u),(v=i*r+n*a)&&(r-=i*v,a-=n*v),(f=Math.sqrt(r*r+a*a))&&(r/=f,a/=f,v/=f),i*a<n*r&&(i=-i,n=-n,v=-v,u=-u),{translateX:s,translateY:o,rotate:Math.atan2(n,i)*gC,skewX:Math.atan(v)*gC,scaleX:u,scaleY:f}}var Hg;function hW(i){const n=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(i+"");return n.isIdentity?M1:yC(n.a,n.b,n.c,n.d,n.e,n.f)}function fW(i){return i==null||(Hg||(Hg=document.createElementNS("http://www.w3.org/2000/svg","g")),Hg.setAttribute("transform",i),!(i=Hg.transform.baseVal.consolidate()))?M1:(i=i.matrix,yC(i.a,i.b,i.c,i.d,i.e,i.f))}function bC(i,n,r,a){function s(m){return m.length?m.pop()+" ":""}function o(m,g,y,b,w,A){if(m!==y||g!==b){var M=w.push("translate(",null,n,null,r);A.push({i:M-4,x:$l(m,y)},{i:M-2,x:$l(g,b)})}else(y||b)&&w.push("translate("+y+n+b+r)}function u(m,g,y,b){m!==g?(m-g>180?g+=360:g-m>180&&(m+=360),b.push({i:y.push(s(y)+"rotate(",null,a)-2,x:$l(m,g)})):g&&y.push(s(y)+"rotate("+g+a)}function f(m,g,y,b){m!==g?b.push({i:y.push(s(y)+"skewX(",null,a)-2,x:$l(m,g)}):g&&y.push(s(y)+"skewX("+g+a)}function v(m,g,y,b,w,A){if(m!==y||g!==b){var M=w.push(s(w)+"scale(",null,",",null,")");A.push({i:M-4,x:$l(m,y)},{i:M-2,x:$l(g,b)})}else(y!==1||b!==1)&&w.push(s(w)+"scale("+y+","+b+")")}return function(m,g){var y=[],b=[];return m=i(m),g=i(g),o(m.translateX,m.translateY,g.translateX,g.translateY,y,b),u(m.rotate,g.rotate,y,b),f(m.skewX,g.skewX,y,b),v(m.scaleX,m.scaleY,g.scaleX,g.scaleY,y,b),m=g=null,function(w){for(var A=-1,M=b.length,S;++A<M;)y[(S=b[A]).i]=S.x(w);return y.join("")}}}var dW=bC(hW,"px, ","px)","deg)"),pW=bC(fW,", ",")",")"),mW=1e-12;function xC(i){return((i=Math.exp(i))+1/i)/2}function vW(i){return((i=Math.exp(i))-1/i)/2}function gW(i){return((i=Math.exp(2*i))-1)/(i+1)}var yW=function i(n,r,a){function s(o,u){var f=o[0],v=o[1],m=o[2],g=u[0],y=u[1],b=u[2],w=g-f,A=y-v,M=w*w+A*A,S,E;if(M<mW)E=Math.log(b/m)/n,S=function(F){return[f+F*w,v+F*A,m*Math.exp(n*F*E)]};else{var T=Math.sqrt(M),C=(b*b-m*m+a*M)/(2*m*r*T),L=(b*b-m*m-a*M)/(2*b*r*T),P=Math.log(Math.sqrt(C*C+1)-C),N=Math.log(Math.sqrt(L*L+1)-L);E=(N-P)/n,S=function(F){var X=F*E,Y=xC(P),ae=m/(r*T)*(Y*gW(n*X+P)-vW(P));return[f+ae*w,v+ae*A,m*Y/xC(n*X+P)]}}return S.duration=E*1e3*n/Math.SQRT2,S}return s.rho=function(o){var u=Math.max(.001,+o),f=u*u,v=f*f;return i(u,f,v)},s}(Math.SQRT2,2,4),Wh=0,ep=0,tp=0,wC=1e3,zg,np,Gg=0,$c=0,Vg=0,rp=typeof performance=="object"&&performance.now?performance:Date,AC=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(i){setTimeout(i,17)};function S1(){return $c||(AC(bW),$c=rp.now()+Vg)}function bW(){$c=0}function Wg(){this._call=this._time=this._next=null}Wg.prototype=T1.prototype={constructor:Wg,restart:function(i,n,r){if(typeof i!="function")throw new TypeError("callback is not a function");r=(r==null?S1():+r)+(n==null?0:+n),!this._next&&np!==this&&(np?np._next=this:zg=this,np=this),this._call=i,this._time=r,C1()},stop:function(){this._call&&(this._call=null,this._time=1/0,C1())}};function T1(i,n,r){var a=new Wg;return a.restart(i,n,r),a}function xW(){S1(),++Wh;for(var i=zg,n;i;)(n=$c-i._time)>=0&&i._call.call(void 0,n),i=i._next;--Wh}function EC(){$c=(Gg=rp.now())+Vg,Wh=ep=0;try{xW()}finally{Wh=0,AW(),$c=0}}function wW(){var i=rp.now(),n=i-Gg;n>wC&&(Vg-=n,Gg=i)}function AW(){for(var i,n=zg,r,a=1/0;n;)n._call?(a>n._time&&(a=n._time),i=n,n=n._next):(r=n._next,n._next=null,n=i?i._next=r:zg=r);np=i,C1(a)}function C1(i){if(!Wh){ep&&(ep=clearTimeout(ep));var n=i-$c;n>24?(i<1/0&&(ep=setTimeout(EC,i-rp.now()-Vg)),tp&&(tp=clearInterval(tp))):(tp||(Gg=rp.now(),tp=setInterval(wW,wC)),Wh=1,AC(EC))}}function _C(i,n,r){var a=new Wg;return n=n==null?0:+n,a.restart(s=>{a.stop(),i(s+n)},n,r),a}var EW=Yd("start","end","cancel","interrupt"),_W=[],MC=0,SC=1,R1=2,jg=3,TC=4,L1=5,Xg=6;function qg(i,n,r,a,s,o){var u=i.__transition;if(!u)i.__transition={};else if(r in u)return;MW(i,r,{name:n,index:a,group:s,on:EW,tween:_W,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:MC})}function P1(i,n){var r=Bo(i,n);if(r.state>MC)throw new Error("too late; already scheduled");return r}function fs(i,n){var r=Bo(i,n);if(r.state>jg)throw new Error("too late; already running");return r}function Bo(i,n){var r=i.__transition;if(!r||!(r=r[n]))throw new Error("transition not found");return r}function MW(i,n,r){var a=i.__transition,s;a[n]=r,r.timer=T1(o,0,r.time);function o(m){r.state=SC,r.timer.restart(u,r.delay,r.time),r.delay<=m&&u(m-r.delay)}function u(m){var g,y,b,w;if(r.state!==SC)return v();for(g in a)if(w=a[g],w.name===r.name){if(w.state===jg)return _C(u);w.state===TC?(w.state=Xg,w.timer.stop(),w.on.call("interrupt",i,i.__data__,w.index,w.group),delete a[g]):+g<n&&(w.state=Xg,w.timer.stop(),w.on.call("cancel",i,i.__data__,w.index,w.group),delete a[g])}if(_C(function(){r.state===jg&&(r.state=TC,r.timer.restart(f,r.delay,r.time),f(m))}),r.state=R1,r.on.call("start",i,i.__data__,r.index,r.group),r.state===R1){for(r.state=jg,s=new Array(b=r.tween.length),g=0,y=-1;g<b;++g)(w=r.tween[g].value.call(i,i.__data__,r.index,r.group))&&(s[++y]=w);s.length=y+1}}function f(m){for(var g=m<r.duration?r.ease.call(null,m/r.duration):(r.timer.restart(v),r.state=L1,1),y=-1,b=s.length;++y<b;)s[y].call(i,g);r.state===L1&&(r.on.call("end",i,i.__data__,r.index,r.group),v())}function v(){r.state=Xg,r.timer.stop(),delete a[n];for(var m in a)return;delete i.__transition}}function Yg(i,n){var r=i.__transition,a,s,o=!0,u;if(!!r){n=n==null?null:n+"";for(u in r){if((a=r[u]).name!==n){o=!1;continue}s=a.state>R1&&a.state<L1,a.state=Xg,a.timer.stop(),a.on.call(s?"interrupt":"cancel",i,i.__data__,a.index,a.group),delete r[u]}o&&delete i.__transition}}function SW(i){return this.each(function(){Yg(this,i)})}function TW(i,n){var r,a;return function(){var s=fs(this,i),o=s.tween;if(o!==r){a=r=o;for(var u=0,f=a.length;u<f;++u)if(a[u].name===n){a=a.slice(),a.splice(u,1);break}}s.tween=a}}function CW(i,n,r){var a,s;if(typeof r!="function")throw new Error;return function(){var o=fs(this,i),u=o.tween;if(u!==a){s=(a=u).slice();for(var f={name:n,value:r},v=0,m=s.length;v<m;++v)if(s[v].name===n){s[v]=f;break}v===m&&s.push(f)}o.tween=s}}function RW(i,n){var r=this._id;if(i+="",arguments.length<2){for(var a=Bo(this.node(),r).tween,s=0,o=a.length,u;s<o;++s)if((u=a[s]).name===i)return u.value;return null}return this.each((n==null?TW:CW)(r,i,n))}function D1(i,n,r){var a=i._id;return i.each(function(){var s=fs(this,a);(s.value||(s.value={}))[n]=r.apply(this,arguments)}),function(s){return Bo(s,a).value[n]}}function CC(i,n){var r;return(typeof n=="number"?$l:n instanceof Jd?vC:(r=Jd(n))?(n=r,vC):uW)(i,n)}function LW(i){return function(){this.removeAttribute(i)}}function PW(i){return function(){this.removeAttributeNS(i.space,i.local)}}function DW(i,n,r){var a,s=r+"",o;return function(){var u=this.getAttribute(i);return u===s?null:u===a?o:o=n(a=u,r)}}function OW(i,n,r){var a,s=r+"",o;return function(){var u=this.getAttributeNS(i.space,i.local);return u===s?null:u===a?o:o=n(a=u,r)}}function IW(i,n,r){var a,s,o;return function(){var u,f=r(this),v;return f==null?void this.removeAttribute(i):(u=this.getAttribute(i),v=f+"",u===v?null:u===a&&v===s?o:(s=v,o=n(a=u,f)))}}function kW(i,n,r){var a,s,o;return function(){var u,f=r(this),v;return f==null?void this.removeAttributeNS(i.space,i.local):(u=this.getAttributeNS(i.space,i.local),v=f+"",u===v?null:u===a&&v===s?o:(s=v,o=n(a=u,f)))}}function FW(i,n){var r=Ig(i),a=r==="transform"?pW:CC;return this.attrTween(i,typeof n=="function"?(r.local?kW:IW)(r,a,D1(this,"attr."+i,n)):n==null?(r.local?PW:LW)(r):(r.local?OW:DW)(r,a,n))}function BW(i,n){return function(r){this.setAttribute(i,n.call(this,r))}}function NW(i,n){return function(r){this.setAttributeNS(i.space,i.local,n.call(this,r))}}function UW(i,n){var r,a;function s(){var o=n.apply(this,arguments);return o!==a&&(r=(a=o)&&NW(i,o)),r}return s._value=n,s}function HW(i,n){var r,a;function s(){var o=n.apply(this,arguments);return o!==a&&(r=(a=o)&&BW(i,o)),r}return s._value=n,s}function zW(i,n){var r="attr."+i;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(n==null)return this.tween(r,null);if(typeof n!="function")throw new Error;var a=Ig(i);return this.tween(r,(a.local?UW:HW)(a,n))}function GW(i,n){return function(){P1(this,i).delay=+n.apply(this,arguments)}}function VW(i,n){return n=+n,function(){P1(this,i).delay=n}}function WW(i){var n=this._id;return arguments.length?this.each((typeof i=="function"?GW:VW)(n,i)):Bo(this.node(),n).delay}function jW(i,n){return function(){fs(this,i).duration=+n.apply(this,arguments)}}function XW(i,n){return n=+n,function(){fs(this,i).duration=n}}function qW(i){var n=this._id;return arguments.length?this.each((typeof i=="function"?jW:XW)(n,i)):Bo(this.node(),n).duration}function YW(i,n){if(typeof n!="function")throw new Error;return function(){fs(this,i).ease=n}}function $W(i){var n=this._id;return arguments.length?this.each(YW(n,i)):Bo(this.node(),n).ease}function KW(i,n){return function(){var r=n.apply(this,arguments);if(typeof r!="function")throw new Error;fs(this,i).ease=r}}function ZW(i){if(typeof i!="function")throw new Error;return this.each(KW(this._id,i))}function QW(i){typeof i!="function"&&(i=X2(i));for(var n=this._groups,r=n.length,a=new Array(r),s=0;s<r;++s)for(var o=n[s],u=o.length,f=a[s]=[],v,m=0;m<u;++m)(v=o[m])&&i.call(v,v.__data__,m,o)&&f.push(v);return new Gs(a,this._parents,this._name,this._id)}function JW(i){if(i._id!==this._id)throw new Error;for(var n=this._groups,r=i._groups,a=n.length,s=r.length,o=Math.min(a,s),u=new Array(a),f=0;f<o;++f)for(var v=n[f],m=r[f],g=v.length,y=u[f]=new Array(g),b,w=0;w<g;++w)(b=v[w]||m[w])&&(y[w]=b);for(;f<a;++f)u[f]=n[f];return new Gs(u,this._parents,this._name,this._id)}function ej(i){return(i+"").trim().split(/^|\s+/).every(function(n){var r=n.indexOf(".");return r>=0&&(n=n.slice(0,r)),!n||n==="start"})}function tj(i,n,r){var a,s,o=ej(n)?P1:fs;return function(){var u=o(this,i),f=u.on;f!==a&&(s=(a=f).copy()).on(n,r),u.on=s}}function nj(i,n){var r=this._id;return arguments.length<2?Bo(this.node(),r).on.on(i):this.each(tj(r,i,n))}function rj(i){return function(){var n=this.parentNode;for(var r in this.__transition)if(+r!==i)return;n&&n.removeChild(this)}}function ij(){return this.on("end.remove",rj(this._id))}function aj(i){var n=this._name,r=this._id;typeof i!="function"&&(i=m1(i));for(var a=this._groups,s=a.length,o=new Array(s),u=0;u<s;++u)for(var f=a[u],v=f.length,m=o[u]=new Array(v),g,y,b=0;b<v;++b)(g=f[b])&&(y=i.call(g,g.__data__,b,f))&&("__data__"in g&&(y.__data__=g.__data__),m[b]=y,qg(m[b],n,r,b,m,Bo(g,r)));return new Gs(o,this._parents,n,r)}function oj(i){var n=this._name,r=this._id;typeof i!="function"&&(i=j2(i));for(var a=this._groups,s=a.length,o=[],u=[],f=0;f<s;++f)for(var v=a[f],m=v.length,g,y=0;y<m;++y)if(g=v[y]){for(var b=i.call(g,g.__data__,y,v),w,A=Bo(g,r),M=0,S=b.length;M<S;++M)(w=b[M])&&qg(w,n,r,M,b,A);o.push(b),u.push(g)}return new Gs(o,u,n,r)}var sj=qd.prototype.constructor;function lj(){return new sj(this._groups,this._parents)}function cj(i,n){var r,a,s;return function(){var o=zh(this,i),u=(this.style.removeProperty(i),zh(this,i));return o===u?null:o===r&&u===a?s:s=n(r=o,a=u)}}function RC(i){return function(){this.style.removeProperty(i)}}function uj(i,n,r){var a,s=r+"",o;return function(){var u=zh(this,i);return u===s?null:u===a?o:o=n(a=u,r)}}function hj(i,n,r){var a,s,o;return function(){var u=zh(this,i),f=r(this),v=f+"";return f==null&&(v=f=(this.style.removeProperty(i),zh(this,i))),u===v?null:u===a&&v===s?o:(s=v,o=n(a=u,f))}}function fj(i,n){var r,a,s,o="style."+n,u="end."+o,f;return function(){var v=fs(this,i),m=v.on,g=v.value[o]==null?f||(f=RC(n)):void 0;(m!==r||s!==g)&&(a=(r=m).copy()).on(u,s=g),v.on=a}}function dj(i,n,r){var a=(i+="")==="transform"?dW:CC;return n==null?this.styleTween(i,cj(i,a)).on("end.style."+i,RC(i)):typeof n=="function"?this.styleTween(i,hj(i,a,D1(this,"style."+i,n))).each(fj(this._id,i)):this.styleTween(i,uj(i,a,n),r).on("end.style."+i,null)}function pj(i,n,r){return function(a){this.style.setProperty(i,n.call(this,a),r)}}function mj(i,n,r){var a,s;function o(){var u=n.apply(this,arguments);return u!==s&&(a=(s=u)&&pj(i,u,r)),a}return o._value=n,o}function vj(i,n,r){var a="style."+(i+="");if(arguments.length<2)return(a=this.tween(a))&&a._value;if(n==null)return this.tween(a,null);if(typeof n!="function")throw new Error;return this.tween(a,mj(i,n,r==null?"":r))}function gj(i){return function(){this.textContent=i}}function yj(i){return function(){var n=i(this);this.textContent=n==null?"":n}}function bj(i){return this.tween("text",typeof i=="function"?yj(D1(this,"text",i)):gj(i==null?"":i+""))}function xj(i){return function(n){this.textContent=i.call(this,n)}}function wj(i){var n,r;function a(){var s=i.apply(this,arguments);return s!==r&&(n=(r=s)&&xj(s)),n}return a._value=i,a}function Aj(i){var n="text";if(arguments.length<1)return(n=this.tween(n))&&n._value;if(i==null)return this.tween(n,null);if(typeof i!="function")throw new Error;return this.tween(n,wj(i))}function Ej(){for(var i=this._name,n=this._id,r=LC(),a=this._groups,s=a.length,o=0;o<s;++o)for(var u=a[o],f=u.length,v,m=0;m<f;++m)if(v=u[m]){var g=Bo(v,n);qg(v,i,r,m,u,{time:g.time+g.delay+g.duration,delay:0,duration:g.duration,ease:g.ease})}return new Gs(a,this._parents,i,r)}function _j(){var i,n,r=this,a=r._id,s=r.size();return new Promise(function(o,u){var f={value:u},v={value:function(){--s==0&&o()}};r.each(function(){var m=fs(this,a),g=m.on;g!==i&&(n=(i=g).copy(),n._.cancel.push(f),n._.interrupt.push(f),n._.end.push(v)),m.on=n}),s===0&&o()})}var Mj=0;function Gs(i,n,r,a){this._groups=i,this._parents=n,this._name=r,this._id=a}function LC(){return++Mj}var Vs=qd.prototype;Gs.prototype={constructor:Gs,select:aj,selectAll:oj,selectChild:Vs.selectChild,selectChildren:Vs.selectChildren,filter:QW,merge:JW,selection:lj,transition:Ej,call:Vs.call,nodes:Vs.nodes,node:Vs.node,size:Vs.size,empty:Vs.empty,each:Vs.each,on:nj,attr:FW,attrTween:zW,style:dj,styleTween:vj,text:bj,textTween:Aj,remove:ij,tween:RW,delay:WW,duration:qW,ease:$W,easeVarying:ZW,end:_j,[Symbol.iterator]:Vs[Symbol.iterator]};function Sj(i){return((i*=2)<=1?i*i*i:(i-=2)*i*i+2)/2}var Tj={time:null,delay:0,duration:250,ease:Sj};function Cj(i,n){for(var r;!(r=i.__transition)||!(r=r[n]);)if(!(i=i.parentNode))throw new Error(`transition ${n} not found`);return r}function Rj(i){var n,r;i instanceof Gs?(n=i._id,i=i._name):(n=LC(),(r=Tj).time=S1(),i=i==null?null:i+"");for(var a=this._groups,s=a.length,o=0;o<s;++o)for(var u=a[o],f=u.length,v,m=0;m<f;++m)(v=u[m])&&qg(v,i,n,m,u,r||Cj(v,n));return new Gs(a,this._parents,i,n)}qd.prototype.interrupt=SW;qd.prototype.transition=Rj;var $g=i=>()=>i;function Lj(i,{sourceEvent:n,target:r,transform:a,dispatch:s}){Object.defineProperties(this,{type:{value:i,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:a,enumerable:!0,configurable:!0},_:{value:s}})}function Ws(i,n,r){this.k=i,this.x=n,this.y=r}Ws.prototype={constructor:Ws,scale:function(i){return i===1?this:new Ws(this.k*i,this.x,this.y)},translate:function(i,n){return i===0&n===0?this:new Ws(this.k,this.x+this.k*i,this.y+this.k*n)},apply:function(i){return[i[0]*this.k+this.x,i[1]*this.k+this.y]},applyX:function(i){return i*this.k+this.x},applyY:function(i){return i*this.k+this.y},invert:function(i){return[(i[0]-this.x)/this.k,(i[1]-this.y)/this.k]},invertX:function(i){return(i-this.x)/this.k},invertY:function(i){return(i-this.y)/this.k},rescaleX:function(i){return i.copy().domain(i.range().map(this.invertX,this).map(i.invert,i))},rescaleY:function(i){return i.copy().domain(i.range().map(this.invertY,this).map(i.invert,i))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var O1=new Ws(1,0,0);ds.prototype=Ws.prototype;function ds(i){for(;!i.__zoom;)if(!(i=i.parentNode))return O1;return i.__zoom}function I1(i){i.stopImmediatePropagation()}function ip(i){i.preventDefault(),i.stopImmediatePropagation()}function Pj(i){return(!i.ctrlKey||i.type==="wheel")&&!i.button}function Dj(){var i=this;return i instanceof SVGElement?(i=i.ownerSVGElement||i,i.hasAttribute("viewBox")?(i=i.viewBox.baseVal,[[i.x,i.y],[i.x+i.width,i.y+i.height]]):[[0,0],[i.width.baseVal.value,i.height.baseVal.value]]):[[0,0],[i.clientWidth,i.clientHeight]]}function PC(){return this.__zoom||O1}function Oj(i){return-i.deltaY*(i.deltaMode===1?.05:i.deltaMode?1:.002)*(i.ctrlKey?10:1)}function Ij(){return navigator.maxTouchPoints||"ontouchstart"in this}function kj(i,n,r){var a=i.invertX(n[0][0])-r[0][0],s=i.invertX(n[1][0])-r[1][0],o=i.invertY(n[0][1])-r[0][1],u=i.invertY(n[1][1])-r[1][1];return i.translate(s>a?(a+s)/2:Math.min(0,a)||Math.max(0,s),u>o?(o+u)/2:Math.min(0,o)||Math.max(0,u))}function Fj(){var i=Pj,n=Dj,r=kj,a=Oj,s=Ij,o=[0,1/0],u=[[-1/0,-1/0],[1/0,1/0]],f=250,v=yW,m=Yd("start","zoom","end"),g,y,b,w=500,A=150,M=0,S=10;function E(I){I.property("__zoom",PC).on("wheel.zoom",X,{passive:!1}).on("mousedown.zoom",Y).on("dblclick.zoom",ae).filter(s).on("touchstart.zoom",$).on("touchmove.zoom",de).on("touchend.zoom touchcancel.zoom",D).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}E.transform=function(I,k,U,W){var ce=I.selection?I.selection():I;ce.property("__zoom",PC),I!==ce?P(I,k,U,W):ce.interrupt().each(function(){N(this,arguments).event(W).start().zoom(null,typeof k=="function"?k.apply(this,arguments):k).end()})},E.scaleBy=function(I,k,U,W){E.scaleTo(I,function(){var ce=this.__zoom.k,oe=typeof k=="function"?k.apply(this,arguments):k;return ce*oe},U,W)},E.scaleTo=function(I,k,U,W){E.transform(I,function(){var ce=n.apply(this,arguments),oe=this.__zoom,ge=U==null?L(ce):typeof U=="function"?U.apply(this,arguments):U,_e=oe.invert(ge),Ne=typeof k=="function"?k.apply(this,arguments):k;return r(C(T(oe,Ne),ge,_e),ce,u)},U,W)},E.translateBy=function(I,k,U,W){E.transform(I,function(){return r(this.__zoom.translate(typeof k=="function"?k.apply(this,arguments):k,typeof U=="function"?U.apply(this,arguments):U),n.apply(this,arguments),u)},null,W)},E.translateTo=function(I,k,U,W,ce){E.transform(I,function(){var oe=n.apply(this,arguments),ge=this.__zoom,_e=W==null?L(oe):typeof W=="function"?W.apply(this,arguments):W;return r(O1.translate(_e[0],_e[1]).scale(ge.k).translate(typeof k=="function"?-k.apply(this,arguments):-k,typeof U=="function"?-U.apply(this,arguments):-U),oe,u)},W,ce)};function T(I,k){return k=Math.max(o[0],Math.min(o[1],k)),k===I.k?I:new Ws(k,I.x,I.y)}function C(I,k,U){var W=k[0]-U[0]*I.k,ce=k[1]-U[1]*I.k;return W===I.x&&ce===I.y?I:new Ws(I.k,W,ce)}function L(I){return[(+I[0][0]+ +I[1][0])/2,(+I[0][1]+ +I[1][1])/2]}function P(I,k,U,W){I.on("start.zoom",function(){N(this,arguments).event(W).start()}).on("interrupt.zoom end.zoom",function(){N(this,arguments).event(W).end()}).tween("zoom",function(){var ce=this,oe=arguments,ge=N(ce,oe).event(W),_e=n.apply(ce,oe),Ne=U==null?L(_e):typeof U=="function"?U.apply(ce,oe):U,Ie=Math.max(_e[1][0]-_e[0][0],_e[1][1]-_e[0][1]),Ve=ce.__zoom,Le=typeof k=="function"?k.apply(ce,oe):k,Fe=v(Ve.invert(Ne).concat(Ie/Ve.k),Le.invert(Ne).concat(Ie/Le.k));return function(Me){if(Me===1)Me=Le;else{var Qe=Fe(Me),mt=Ie/Qe[2];Me=new Ws(mt,Ne[0]-Qe[0]*mt,Ne[1]-Qe[1]*mt)}ge.zoom(null,Me)}})}function N(I,k,U){return!U&&I.__zooming||new F(I,k)}function F(I,k){this.that=I,this.args=k,this.active=0,this.sourceEvent=null,this.extent=n.apply(I,k),this.taps=0}F.prototype={event:function(I){return I&&(this.sourceEvent=I),this},start:function(){return++this.active==1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(I,k){return this.mouse&&I!=="mouse"&&(this.mouse[1]=k.invert(this.mouse[0])),this.touch0&&I!=="touch"&&(this.touch0[1]=k.invert(this.touch0[0])),this.touch1&&I!=="touch"&&(this.touch1[1]=k.invert(this.touch1[0])),this.that.__zoom=k,this.emit("zoom"),this},end:function(){return--this.active==0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(I){var k=Fo(this.that).datum();m.call(I,this.that,new Lj(I,{sourceEvent:this.sourceEvent,target:E,type:I,transform:this.that.__zoom,dispatch:m}),k)}};function X(I,...k){if(!i.apply(this,arguments))return;var U=N(this,k).event(I),W=this.__zoom,ce=Math.max(o[0],Math.min(o[1],W.k*Math.pow(2,a.apply(this,arguments)))),oe=zs(I);if(U.wheel)(U.mouse[0][0]!==oe[0]||U.mouse[0][1]!==oe[1])&&(U.mouse[1]=W.invert(U.mouse[0]=oe)),clearTimeout(U.wheel);else{if(W.k===ce)return;U.mouse=[oe,W.invert(oe)],Yg(this),U.start()}ip(I),U.wheel=setTimeout(ge,A),U.zoom("mouse",r(C(T(W,ce),U.mouse[0],U.mouse[1]),U.extent,u));function ge(){U.wheel=null,U.end()}}function Y(I,...k){if(b||!i.apply(this,arguments))return;var U=I.currentTarget,W=N(this,k,!0).event(I),ce=Fo(I.view).on("mousemove.zoom",Ne,!0).on("mouseup.zoom",Ie,!0),oe=zs(I,U),ge=I.clientX,_e=I.clientY;rC(I.view),I1(I),W.mouse=[oe,this.__zoom.invert(oe)],Yg(this),W.start();function Ne(Ve){if(ip(Ve),!W.moved){var Le=Ve.clientX-ge,Fe=Ve.clientY-_e;W.moved=Le*Le+Fe*Fe>M}W.event(Ve).zoom("mouse",r(C(W.that.__zoom,W.mouse[0]=zs(Ve,U),W.mouse[1]),W.extent,u))}function Ie(Ve){ce.on("mousemove.zoom mouseup.zoom",null),iC(Ve.view,W.moved),ip(Ve),W.event(Ve).end()}}function ae(I,...k){if(!!i.apply(this,arguments)){var U=this.__zoom,W=zs(I.changedTouches?I.changedTouches[0]:I,this),ce=U.invert(W),oe=U.k*(I.shiftKey?.5:2),ge=r(C(T(U,oe),W,ce),n.apply(this,k),u);ip(I),f>0?Fo(this).transition().duration(f).call(P,ge,W,I):Fo(this).call(E.transform,ge,W,I)}}function $(I,...k){if(!!i.apply(this,arguments)){var U=I.touches,W=U.length,ce=N(this,k,I.changedTouches.length===W).event(I),oe,ge,_e,Ne;for(I1(I),ge=0;ge<W;++ge)_e=U[ge],Ne=zs(_e,this),Ne=[Ne,this.__zoom.invert(Ne),_e.identifier],ce.touch0?!ce.touch1&&ce.touch0[2]!==Ne[2]&&(ce.touch1=Ne,ce.taps=0):(ce.touch0=Ne,oe=!0,ce.taps=1+!!g);g&&(g=clearTimeout(g)),oe&&(ce.taps<2&&(y=Ne[0],g=setTimeout(function(){g=null},w)),Yg(this),ce.start())}}function de(I,...k){if(!!this.__zooming){var U=N(this,k).event(I),W=I.changedTouches,ce=W.length,oe,ge,_e,Ne;for(ip(I),oe=0;oe<ce;++oe)ge=W[oe],_e=zs(ge,this),U.touch0&&U.touch0[2]===ge.identifier?U.touch0[0]=_e:U.touch1&&U.touch1[2]===ge.identifier&&(U.touch1[0]=_e);if(ge=U.that.__zoom,U.touch1){var Ie=U.touch0[0],Ve=U.touch0[1],Le=U.touch1[0],Fe=U.touch1[1],Me=(Me=Le[0]-Ie[0])*Me+(Me=Le[1]-Ie[1])*Me,Qe=(Qe=Fe[0]-Ve[0])*Qe+(Qe=Fe[1]-Ve[1])*Qe;ge=T(ge,Math.sqrt(Me/Qe)),_e=[(Ie[0]+Le[0])/2,(Ie[1]+Le[1])/2],Ne=[(Ve[0]+Fe[0])/2,(Ve[1]+Fe[1])/2]}else if(U.touch0)_e=U.touch0[0],Ne=U.touch0[1];else return;U.zoom("touch",r(C(ge,_e,Ne),U.extent,u))}}function D(I,...k){if(!!this.__zooming){var U=N(this,k).event(I),W=I.changedTouches,ce=W.length,oe,ge;for(I1(I),b&&clearTimeout(b),b=setTimeout(function(){b=null},w),oe=0;oe<ce;++oe)ge=W[oe],U.touch0&&U.touch0[2]===ge.identifier?delete U.touch0:U.touch1&&U.touch1[2]===ge.identifier&&delete U.touch1;if(U.touch1&&!U.touch0&&(U.touch0=U.touch1,delete U.touch1),U.touch0)U.touch0[1]=this.__zoom.invert(U.touch0[0]);else if(U.end(),U.taps===2&&(ge=zs(ge,this),Math.hypot(y[0]-ge[0],y[1]-ge[1])<S)){var _e=Fo(this).on("dblclick.zoom");_e&&_e.apply(this,arguments)}}}return E.wheelDelta=function(I){return arguments.length?(a=typeof I=="function"?I:$g(+I),E):a},E.filter=function(I){return arguments.length?(i=typeof I=="function"?I:$g(!!I),E):i},E.touchable=function(I){return arguments.length?(s=typeof I=="function"?I:$g(!!I),E):s},E.extent=function(I){return arguments.length?(n=typeof I=="function"?I:$g([[+I[0][0],+I[0][1]],[+I[1][0],+I[1][1]]]),E):n},E.scaleExtent=function(I){return arguments.length?(o[0]=+I[0],o[1]=+I[1],E):[o[0],o[1]]},E.translateExtent=function(I){return arguments.length?(u[0][0]=+I[0][0],u[1][0]=+I[1][0],u[0][1]=+I[0][1],u[1][1]=+I[1][1],E):[[u[0][0],u[0][1]],[u[1][0],u[1][1]]]},E.constrain=function(I){return arguments.length?(r=I,E):r},E.duration=function(I){return arguments.length?(f=+I,E):f},E.interpolate=function(I){return arguments.length?(v=I,E):v},E.on=function(){var I=m.on.apply(m,arguments);return I===m?E:I},E.clickDistance=function(I){return arguments.length?(M=(I=+I)*I,E):Math.sqrt(M)},E.tapDistance=function(I){return arguments.length?(S=+I,E):S},E}class DC extends Map{constructor(n,r=Uj){super();if(Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),n!=null)for(const[a,s]of n)this.set(a,s)}get(n){return super.get(OC(this,n))}has(n){return super.has(OC(this,n))}set(n,r){return super.set(Bj(this,n),r)}delete(n){return super.delete(Nj(this,n))}}function OC({_intern:i,_key:n},r){const a=n(r);return i.has(a)?i.get(a):r}function Bj({_intern:i,_key:n},r){const a=n(r);return i.has(a)?i.get(a):(i.set(a,r),r)}function Nj({_intern:i,_key:n},r){const a=n(r);return i.has(a)&&(r=i.get(a),i.delete(a)),r}function Uj(i){return i!==null&&typeof i=="object"?i.valueOf():i}function k1(i,n){let r;if(n===void 0)for(const a of i)a!=null&&(r<a||r===void 0&&a>=a)&&(r=a);else{let a=-1;for(let s of i)(s=n(s,++a,i))!=null&&(r<s||r===void 0&&s>=s)&&(r=s)}return r}function F1(i,n){let r;if(n===void 0)for(const a of i)a!=null&&(r>a||r===void 0&&a>=a)&&(r=a);else{let a=-1;for(let s of i)(s=n(s,++a,i))!=null&&(r>s||r===void 0&&s>=s)&&(r=s)}return r}var Ba=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function IC(i){if(i.__esModule)return i;var n=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(i).forEach(function(r){var a=Object.getOwnPropertyDescriptor(i,r);Object.defineProperty(n,r,a.get?a:{enumerable:!0,get:function(){return i[r]}})}),n}function Kg(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var kC="Expected a function",FC=0/0,Hj="[object Symbol]",zj=/^\s+|\s+$/g,Gj=/^[-+]0x[0-9a-f]+$/i,Vj=/^0b[01]+$/i,Wj=/^0o[0-7]+$/i,jj=parseInt,Xj=typeof Ba=="object"&&Ba&&Ba.Object===Object&&Ba,qj=typeof self=="object"&&self&&self.Object===Object&&self,Yj=Xj||qj||Function("return this")(),$j=Object.prototype,Kj=$j.toString,Zj=Math.max,Qj=Math.min,B1=function(){return Yj.Date.now()};function Jj(i,n,r){var a,s,o,u,f,v,m=0,g=!1,y=!1,b=!0;if(typeof i!="function")throw new TypeError(kC);n=BC(n)||0,Zg(r)&&(g=!!r.leading,y="maxWait"in r,o=y?Zj(BC(r.maxWait)||0,n):o,b="trailing"in r?!!r.trailing:b);function w(N){var F=a,X=s;return a=s=void 0,m=N,u=i.apply(X,F),u}function A(N){return m=N,f=setTimeout(E,n),g?w(N):u}function M(N){var F=N-v,X=N-m,Y=n-F;return y?Qj(Y,o-X):Y}function S(N){var F=N-v,X=N-m;return v===void 0||F>=n||F<0||y&&X>=o}function E(){var N=B1();if(S(N))return T(N);f=setTimeout(E,M(N))}function T(N){return f=void 0,b&&a?w(N):(a=s=void 0,u)}function C(){f!==void 0&&clearTimeout(f),m=0,a=v=s=f=void 0}function L(){return f===void 0?u:T(B1())}function P(){var N=B1(),F=S(N);if(a=arguments,s=this,v=N,F){if(f===void 0)return A(v);if(y)return f=setTimeout(E,n),w(v)}return f===void 0&&(f=setTimeout(E,n)),u}return P.cancel=C,P.flush=L,P}function eX(i,n,r){var a=!0,s=!0;if(typeof i!="function")throw new TypeError(kC);return Zg(r)&&(a="leading"in r?!!r.leading:a,s="trailing"in r?!!r.trailing:s),Jj(i,n,{leading:a,maxWait:n,trailing:s})}function Zg(i){var n=typeof i;return!!i&&(n=="object"||n=="function")}function tX(i){return!!i&&typeof i=="object"}function nX(i){return typeof i=="symbol"||tX(i)&&Kj.call(i)==Hj}function BC(i){if(typeof i=="number")return i;if(nX(i))return FC;if(Zg(i)){var n=typeof i.valueOf=="function"?i.valueOf():i;i=Zg(n)?n+"":n}if(typeof i!="string")return i===0?i:+i;i=i.replace(zj,"");var r=Vj.test(i);return r||Wj.test(i)?jj(i.slice(2),r?2:8):Gj.test(i)?FC:+i}var rX=eX,ap={Linear:{None:function(i){return i}},Quadratic:{In:function(i){return i*i},Out:function(i){return i*(2-i)},InOut:function(i){return(i*=2)<1?.5*i*i:-.5*(--i*(i-2)-1)}},Cubic:{In:function(i){return i*i*i},Out:function(i){return--i*i*i+1},InOut:function(i){return(i*=2)<1?.5*i*i*i:.5*((i-=2)*i*i+2)}},Quartic:{In:function(i){return i*i*i*i},Out:function(i){return 1- --i*i*i*i},InOut:function(i){return(i*=2)<1?.5*i*i*i*i:-.5*((i-=2)*i*i*i-2)}},Quintic:{In:function(i){return i*i*i*i*i},Out:function(i){return--i*i*i*i*i+1},InOut:function(i){return(i*=2)<1?.5*i*i*i*i*i:.5*((i-=2)*i*i*i*i+2)}},Sinusoidal:{In:function(i){return 1-Math.cos(i*Math.PI/2)},Out:function(i){return Math.sin(i*Math.PI/2)},InOut:function(i){return .5*(1-Math.cos(Math.PI*i))}},Exponential:{In:function(i){return i===0?0:Math.pow(1024,i-1)},Out:function(i){return i===1?1:1-Math.pow(2,-10*i)},InOut:function(i){return i===0?0:i===1?1:(i*=2)<1?.5*Math.pow(1024,i-1):.5*(-Math.pow(2,-10*(i-1))+2)}},Circular:{In:function(i){return 1-Math.sqrt(1-i*i)},Out:function(i){return Math.sqrt(1- --i*i)},InOut:function(i){return(i*=2)<1?-.5*(Math.sqrt(1-i*i)-1):.5*(Math.sqrt(1-(i-=2)*i)+1)}},Elastic:{In:function(i){return i===0?0:i===1?1:-Math.pow(2,10*(i-1))*Math.sin((i-1.1)*5*Math.PI)},Out:function(i){return i===0?0:i===1?1:Math.pow(2,-10*i)*Math.sin((i-.1)*5*Math.PI)+1},InOut:function(i){return i===0?0:i===1?1:(i*=2,i<1?-.5*Math.pow(2,10*(i-1))*Math.sin((i-1.1)*5*Math.PI):.5*Math.pow(2,-10*(i-1))*Math.sin((i-1.1)*5*Math.PI)+1)}},Back:{In:function(i){var n=1.70158;return i*i*((n+1)*i-n)},Out:function(i){var n=1.70158;return--i*i*((n+1)*i+n)+1},InOut:function(i){var n=1.70158*1.525;return(i*=2)<1?.5*(i*i*((n+1)*i-n)):.5*((i-=2)*i*((n+1)*i+n)+2)}},Bounce:{In:function(i){return 1-ap.Bounce.Out(1-i)},Out:function(i){return i<1/2.75?7.5625*i*i:i<2/2.75?7.5625*(i-=1.5/2.75)*i+.75:i<2.5/2.75?7.5625*(i-=2.25/2.75)*i+.9375:7.5625*(i-=2.625/2.75)*i+.984375},InOut:function(i){return i<.5?ap.Bounce.In(i*2)*.5:ap.Bounce.Out(i*2-1)*.5+.5}}},op;typeof self=="undefined"&&typeof process!="undefined"&&process.hrtime?op=function(){var i=process.hrtime();return i[0]*1e3+i[1]/1e6}:typeof self!="undefined"&&self.performance!==void 0&&self.performance.now!==void 0?op=self.performance.now.bind(self.performance):Date.now!==void 0?op=Date.now:op=function(){return new Date().getTime()};var Kc=op,NC=function(){function i(){this._tweens={},this._tweensAddedDuringUpdate={}}return i.prototype.getAll=function(){var n=this;return Object.keys(this._tweens).map(function(r){return n._tweens[r]})},i.prototype.removeAll=function(){this._tweens={}},i.prototype.add=function(n){this._tweens[n.getId()]=n,this._tweensAddedDuringUpdate[n.getId()]=n},i.prototype.remove=function(n){delete this._tweens[n.getId()],delete this._tweensAddedDuringUpdate[n.getId()]},i.prototype.update=function(n,r){n===void 0&&(n=Kc()),r===void 0&&(r=!1);var a=Object.keys(this._tweens);if(a.length===0)return!1;for(;a.length>0;){this._tweensAddedDuringUpdate={};for(var s=0;s<a.length;s++){var o=this._tweens[a[s]],u=!r;o&&o.update(n,u)===!1&&!r&&delete this._tweens[a[s]]}a=Object.keys(this._tweensAddedDuringUpdate)}return!0},i}(),jh={Linear:function(i,n){var r=i.length-1,a=r*n,s=Math.floor(a),o=jh.Utils.Linear;return n<0?o(i[0],i[1],a):n>1?o(i[r],i[r-1],r-a):o(i[s],i[s+1>r?r:s+1],a-s)},Bezier:function(i,n){for(var r=0,a=i.length-1,s=Math.pow,o=jh.Utils.Bernstein,u=0;u<=a;u++)r+=s(1-n,a-u)*s(n,u)*i[u]*o(a,u);return r},CatmullRom:function(i,n){var r=i.length-1,a=r*n,s=Math.floor(a),o=jh.Utils.CatmullRom;return i[0]===i[r]?(n<0&&(s=Math.floor(a=r*(1+n))),o(i[(s-1+r)%r],i[s],i[(s+1)%r],i[(s+2)%r],a-s)):n<0?i[0]-(o(i[0],i[0],i[1],i[1],-a)-i[0]):n>1?i[r]-(o(i[r],i[r],i[r-1],i[r-1],a-r)-i[r]):o(i[s?s-1:0],i[s],i[r<s+1?r:s+1],i[r<s+2?r:s+2],a-s)},Utils:{Linear:function(i,n,r){return(n-i)*r+i},Bernstein:function(i,n){var r=jh.Utils.Factorial;return r(i)/r(n)/r(i-n)},Factorial:function(){var i=[1];return function(n){var r=1;if(i[n])return i[n];for(var a=n;a>1;a--)r*=a;return i[n]=r,r}}(),CatmullRom:function(i,n,r,a,s){var o=(r-i)*.5,u=(a-n)*.5,f=s*s,v=s*f;return(2*n-2*r+o+u)*v+(-3*n+3*r-2*o-u)*f+o*s+n}}},N1=function(){function i(){}return i.nextId=function(){return i._nextId++},i._nextId=0,i}(),UC=new NC,iX=function(){function i(n,r){r===void 0&&(r=UC),this._object=n,this._group=r,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=ap.Linear.None,this._interpolationFunction=jh.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._id=N1.nextId(),this._isChainStopped=!1,this._goToEnd=!1}return i.prototype.getId=function(){return this._id},i.prototype.isPlaying=function(){return this._isPlaying},i.prototype.isPaused=function(){return this._isPaused},i.prototype.to=function(n,r){return this._valuesEnd=Object.create(n),r!==void 0&&(this._duration=r),this},i.prototype.duration=function(n){return this._duration=n,this},i.prototype.start=function(n){if(this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var r in this._valuesStartRepeat)this._swapEndStartRepeatValues(r),this._valuesStart[r]=this._valuesStartRepeat[r]}return this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=n!==void 0?typeof n=="string"?Kc()+parseFloat(n):n:Kc(),this._startTime+=this._delayTime,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat),this},i.prototype._setupProperties=function(n,r,a,s){for(var o in a){var u=n[o],f=Array.isArray(u),v=f?"array":typeof u,m=!f&&Array.isArray(a[o]);if(!(v==="undefined"||v==="function")){if(m){var g=a[o];if(g.length===0)continue;g=g.map(this._handleRelativeValue.bind(this,u)),a[o]=[u].concat(g)}if((v==="object"||f)&&u&&!m){r[o]=f?[]:{};for(var y in u)r[o][y]=u[y];s[o]=f?[]:{},this._setupProperties(u,r[o],a[o],s[o])}else typeof r[o]=="undefined"&&(r[o]=u),f||(r[o]*=1),m?s[o]=a[o].slice().reverse():s[o]=r[o]||0}}},i.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},i.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},i.prototype.pause=function(n){return n===void 0&&(n=Kc()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=n,this._group&&this._group.remove(this),this)},i.prototype.resume=function(n){return n===void 0&&(n=Kc()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=n-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this)},i.prototype.stopChainedTweens=function(){for(var n=0,r=this._chainedTweens.length;n<r;n++)this._chainedTweens[n].stop();return this},i.prototype.group=function(n){return this._group=n,this},i.prototype.delay=function(n){return this._delayTime=n,this},i.prototype.repeat=function(n){return this._initialRepeat=n,this._repeat=n,this},i.prototype.repeatDelay=function(n){return this._repeatDelayTime=n,this},i.prototype.yoyo=function(n){return this._yoyo=n,this},i.prototype.easing=function(n){return this._easingFunction=n,this},i.prototype.interpolation=function(n){return this._interpolationFunction=n,this},i.prototype.chain=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return this._chainedTweens=n,this},i.prototype.onStart=function(n){return this._onStartCallback=n,this},i.prototype.onUpdate=function(n){return this._onUpdateCallback=n,this},i.prototype.onRepeat=function(n){return this._onRepeatCallback=n,this},i.prototype.onComplete=function(n){return this._onCompleteCallback=n,this},i.prototype.onStop=function(n){return this._onStopCallback=n,this},i.prototype.update=function(n,r){if(n===void 0&&(n=Kc()),r===void 0&&(r=!0),this._isPaused)return!0;var a,s,o=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(n>o)return!1;r&&this.start(n)}if(this._goToEnd=!1,n<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),s=(n-this._startTime)/this._duration,s=this._duration===0||s>1?1:s;var u=this._easingFunction(s);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,u),this._onUpdateCallback&&this._onUpdateCallback(this._object,s),s===1)if(this._repeat>0){isFinite(this._repeat)&&this._repeat--;for(a in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[a]=="string"&&(this._valuesStartRepeat[a]=this._valuesStartRepeat[a]+parseFloat(this._valuesEnd[a])),this._yoyo&&this._swapEndStartRepeatValues(a),this._valuesStart[a]=this._valuesStartRepeat[a];return this._yoyo&&(this._reversed=!this._reversed),this._repeatDelayTime!==void 0?this._startTime=n+this._repeatDelayTime:this._startTime=n+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var f=0,v=this._chainedTweens.length;f<v;f++)this._chainedTweens[f].start(this._startTime+this._duration);return this._isPlaying=!1,!1}return!0},i.prototype._updateProperties=function(n,r,a,s){for(var o in a)if(r[o]!==void 0){var u=r[o]||0,f=a[o],v=Array.isArray(n[o]),m=Array.isArray(f),g=!v&&m;g?n[o]=this._interpolationFunction(f,s):typeof f=="object"&&f?this._updateProperties(n[o],u,f,s):(f=this._handleRelativeValue(u,f),typeof f=="number"&&(n[o]=u+(f-u)*s))}},i.prototype._handleRelativeValue=function(n,r){return typeof r!="string"?r:r.charAt(0)==="+"||r.charAt(0)==="-"?n+parseFloat(r):parseFloat(r)},i.prototype._swapEndStartRepeatValues=function(n){var r=this._valuesStartRepeat[n],a=this._valuesEnd[n];typeof a=="string"?this._valuesStartRepeat[n]=this._valuesStartRepeat[n]+parseFloat(a):this._valuesStartRepeat[n]=this._valuesEnd[n],this._valuesEnd[n]=r},i}(),aX="18.6.4",oX=N1.nextId,ps=UC,sX=ps.getAll.bind(ps),lX=ps.removeAll.bind(ps),cX=ps.add.bind(ps),uX=ps.remove.bind(ps),hX=ps.update.bind(ps),ms={Easing:ap,Group:NC,Interpolation:jh,now:Kc,Sequence:N1,nextId:oX,Tween:iX,VERSION:aX,getAll:sX,removeAll:lX,add:cX,remove:uX,update:hX};function U1(i,n,r){var a,s,o,u,f;n==null&&(n=100);function v(){var g=Date.now()-u;g<n&&g>=0?a=setTimeout(v,n-g):(a=null,r||(f=i.apply(o,s),o=s=null))}var m=function(){o=this,s=arguments,u=Date.now();var g=r&&!a;return a||(a=setTimeout(v,n)),g&&(f=i.apply(o,s),o=s=null),f};return m.clear=function(){a&&(clearTimeout(a),a=null)},m.flush=function(){a&&(f=i.apply(o,s),o=s=null,clearTimeout(a),a=null)},m}U1.debounce=U1;var fX=U1;function dX(i,n){if(!(i instanceof n))throw new TypeError("Cannot call a class as a function")}function pX(i,n){return mX(i)||vX(i,n)||gX(i,n)||yX()}function mX(i){if(Array.isArray(i))return i}function vX(i,n){var r=i&&(typeof Symbol!="undefined"&&i[Symbol.iterator]||i["@@iterator"]);if(r!=null){var a=[],s=!0,o=!1,u,f;try{for(r=r.call(i);!(s=(u=r.next()).done)&&(a.push(u.value),!(n&&a.length===n));s=!0);}catch(v){o=!0,f=v}finally{try{!s&&r.return!=null&&r.return()}finally{if(o)throw f}}return a}}function gX(i,n){if(!!i){if(typeof i=="string")return HC(i,n);var r=Object.prototype.toString.call(i).slice(8,-1);if(r==="Object"&&i.constructor&&(r=i.constructor.name),r==="Map"||r==="Set")return Array.from(i);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HC(i,n)}}function HC(i,n){(n==null||n>i.length)&&(n=i.length);for(var r=0,a=new Array(n);r<n;r++)a[r]=i[r];return a}function yX(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var bX=function i(n,r){var a=r.default,s=a===void 0?null:a,o=r.triggerUpdate,u=o===void 0?!0:o,f=r.onChange,v=f===void 0?function(m,g){}:f;dX(this,i),this.name=n,this.defaultVal=s,this.triggerUpdate=u,this.onChange=v};function Zc(i){var n=i.stateInit,r=n===void 0?function(){return{}}:n,a=i.props,s=a===void 0?{}:a,o=i.methods,u=o===void 0?{}:o,f=i.aliases,v=f===void 0?{}:f,m=i.init,g=m===void 0?function(){}:m,y=i.update,b=y===void 0?function(){}:y,w=Object.keys(s).map(function(A){return new bX(A,s[A])});return function(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},M=Object.assign({},r instanceof Function?r(A):r,{initialised:!1}),S={};function E(L){return T(L,A),C(),E}var T=function(P,N){g.call(E,P,M,N),M.initialised=!0},C=fX(function(){!M.initialised||(b.call(E,M,S),S={})},1);return w.forEach(function(L){E[L.name]=P(L);function P(N){var F=N.name,X=N.triggerUpdate,Y=X===void 0?!1:X,ae=N.onChange,$=ae===void 0?function(I,k){}:ae,de=N.defaultVal,D=de===void 0?null:de;return function(I){var k=M[F];if(!arguments.length)return k;var U=I===void 0?D:I;return M[F]=U,$.call(E,U,M,k),!S.hasOwnProperty(F)&&(S[F]=k),Y&&C(),E}}}),Object.keys(u).forEach(function(L){E[L]=function(){for(var P,N=arguments.length,F=new Array(N),X=0;X<N;X++)F[X]=arguments[X];return(P=u[L]).call.apply(P,[E,M].concat(F))}}),Object.entries(v).forEach(function(L){var P=pX(L,2),N=P[0],F=P[1];return E[N]=E[F]}),E.resetProps=function(){return w.forEach(function(L){E[L.name](L.defaultVal)}),E},E.resetProps(),M._rerender=C,E}}var Ln=function(i){return i instanceof Function?i:typeof i=="string"?function(n){return n[i]}:function(n){return i}},zC={exports:{}};(function(i){(function(n){var r=/^\s+/,a=/\s+$/,s=0,o=n.round,u=n.min,f=n.max,v=n.random;function m(H,j){if(H=H||"",j=j||{},H instanceof m)return H;if(!(this instanceof m))return new m(H,j);var q=g(H);this._originalInput=H,this._r=q.r,this._g=q.g,this._b=q.b,this._a=q.a,this._roundA=o(100*this._a)/100,this._format=j.format||q.format,this._gradientType=j.gradientType,this._r<1&&(this._r=o(this._r)),this._g<1&&(this._g=o(this._g)),this._b<1&&(this._b=o(this._b)),this._ok=q.ok,this._tc_id=s++}m.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var H=this.toRgb();return(H.r*299+H.g*587+H.b*114)/1e3},getLuminance:function(){var H=this.toRgb(),j,q,pe,ee,te,Se;return j=H.r/255,q=H.g/255,pe=H.b/255,j<=.03928?ee=j/12.92:ee=n.pow((j+.055)/1.055,2.4),q<=.03928?te=q/12.92:te=n.pow((q+.055)/1.055,2.4),pe<=.03928?Se=pe/12.92:Se=n.pow((pe+.055)/1.055,2.4),.2126*ee+.7152*te+.0722*Se},setAlpha:function(H){return this._a=oe(H),this._roundA=o(100*this._a)/100,this},toHsv:function(){var H=A(this._r,this._g,this._b);return{h:H.h*360,s:H.s,v:H.v,a:this._a}},toHsvString:function(){var H=A(this._r,this._g,this._b),j=o(H.h*360),q=o(H.s*100),pe=o(H.v*100);return this._a==1?"hsv("+j+", "+q+"%, "+pe+"%)":"hsva("+j+", "+q+"%, "+pe+"%, "+this._roundA+")"},toHsl:function(){var H=b(this._r,this._g,this._b);return{h:H.h*360,s:H.s,l:H.l,a:this._a}},toHslString:function(){var H=b(this._r,this._g,this._b),j=o(H.h*360),q=o(H.s*100),pe=o(H.l*100);return this._a==1?"hsl("+j+", "+q+"%, "+pe+"%)":"hsla("+j+", "+q+"%, "+pe+"%, "+this._roundA+")"},toHex:function(H){return S(this._r,this._g,this._b,H)},toHexString:function(H){return"#"+this.toHex(H)},toHex8:function(H){return E(this._r,this._g,this._b,this._a,H)},toHex8String:function(H){return"#"+this.toHex8(H)},toRgb:function(){return{r:o(this._r),g:o(this._g),b:o(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+o(this._r)+", "+o(this._g)+", "+o(this._b)+")":"rgba("+o(this._r)+", "+o(this._g)+", "+o(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:o(ge(this._r,255)*100)+"%",g:o(ge(this._g,255)*100)+"%",b:o(ge(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+o(ge(this._r,255)*100)+"%, "+o(ge(this._g,255)*100)+"%, "+o(ge(this._b,255)*100)+"%)":"rgba("+o(ge(this._r,255)*100)+"%, "+o(ge(this._g,255)*100)+"%, "+o(ge(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:W[S(this._r,this._g,this._b,!0)]||!1},toFilter:function(H){var j="#"+T(this._r,this._g,this._b,this._a),q=j,pe=this._gradientType?"GradientType = 1, ":"";if(H){var ee=m(H);q="#"+T(ee._r,ee._g,ee._b,ee._a)}return"progid:DXImageTransform.Microsoft.gradient("+pe+"startColorstr="+j+",endColorstr="+q+")"},toString:function(H){var j=!!H;H=H||this._format;var q=!1,pe=this._a<1&&this._a>=0,ee=!j&&pe&&(H==="hex"||H==="hex6"||H==="hex3"||H==="hex4"||H==="hex8"||H==="name");return ee?H==="name"&&this._a===0?this.toName():this.toRgbString():(H==="rgb"&&(q=this.toRgbString()),H==="prgb"&&(q=this.toPercentageRgbString()),(H==="hex"||H==="hex6")&&(q=this.toHexString()),H==="hex3"&&(q=this.toHexString(!0)),H==="hex4"&&(q=this.toHex8String(!0)),H==="hex8"&&(q=this.toHex8String()),H==="name"&&(q=this.toName()),H==="hsl"&&(q=this.toHslString()),H==="hsv"&&(q=this.toHsvString()),q||this.toHexString())},clone:function(){return m(this.toString())},_applyModification:function(H,j){var q=H.apply(null,[this].concat([].slice.call(j)));return this._r=q._r,this._g=q._g,this._b=q._b,this.setAlpha(q._a),this},lighten:function(){return this._applyModification(N,arguments)},brighten:function(){return this._applyModification(F,arguments)},darken:function(){return this._applyModification(X,arguments)},desaturate:function(){return this._applyModification(C,arguments)},saturate:function(){return this._applyModification(L,arguments)},greyscale:function(){return this._applyModification(P,arguments)},spin:function(){return this._applyModification(Y,arguments)},_applyCombination:function(H,j){return H.apply(null,[this].concat([].slice.call(j)))},analogous:function(){return this._applyCombination(I,arguments)},complement:function(){return this._applyCombination(ae,arguments)},monochromatic:function(){return this._applyCombination(k,arguments)},splitcomplement:function(){return this._applyCombination(D,arguments)},triad:function(){return this._applyCombination($,arguments)},tetrad:function(){return this._applyCombination(de,arguments)}},m.fromRatio=function(H,j){if(typeof H=="object"){var q={};for(var pe in H)H.hasOwnProperty(pe)&&(pe==="a"?q[pe]=H[pe]:q[pe]=Fe(H[pe]));H=q}return m(H,j)};function g(H){var j={r:0,g:0,b:0},q=1,pe=null,ee=null,te=null,Se=!1,ke=!1;return typeof H=="string"&&(H=ye(H)),typeof H=="object"&&(ht(H.r)&&ht(H.g)&&ht(H.b)?(j=y(H.r,H.g,H.b),Se=!0,ke=String(H.r).substr(-1)==="%"?"prgb":"rgb"):ht(H.h)&&ht(H.s)&&ht(H.v)?(pe=Fe(H.s),ee=Fe(H.v),j=M(H.h,pe,ee),Se=!0,ke="hsv"):ht(H.h)&&ht(H.s)&&ht(H.l)&&(pe=Fe(H.s),te=Fe(H.l),j=w(H.h,pe,te),Se=!0,ke="hsl"),H.hasOwnProperty("a")&&(q=H.a)),q=oe(q),{ok:Se,format:H.format||ke,r:u(255,f(j.r,0)),g:u(255,f(j.g,0)),b:u(255,f(j.b,0)),a:q}}function y(H,j,q){return{r:ge(H,255)*255,g:ge(j,255)*255,b:ge(q,255)*255}}function b(H,j,q){H=ge(H,255),j=ge(j,255),q=ge(q,255);var pe=f(H,j,q),ee=u(H,j,q),te,Se,ke=(pe+ee)/2;if(pe==ee)te=Se=0;else{var Be=pe-ee;switch(Se=ke>.5?Be/(2-pe-ee):Be/(pe+ee),pe){case H:te=(j-q)/Be+(j<q?6:0);break;case j:te=(q-H)/Be+2;break;case q:te=(H-j)/Be+4;break}te/=6}return{h:te,s:Se,l:ke}}function w(H,j,q){var pe,ee,te;H=ge(H,360),j=ge(j,100),q=ge(q,100);function Se(We,ve,K){return K<0&&(K+=1),K>1&&(K-=1),K<1/6?We+(ve-We)*6*K:K<1/2?ve:K<2/3?We+(ve-We)*(2/3-K)*6:We}if(j===0)pe=ee=te=q;else{var ke=q<.5?q*(1+j):q+j-q*j,Be=2*q-ke;pe=Se(Be,ke,H+1/3),ee=Se(Be,ke,H),te=Se(Be,ke,H-1/3)}return{r:pe*255,g:ee*255,b:te*255}}function A(H,j,q){H=ge(H,255),j=ge(j,255),q=ge(q,255);var pe=f(H,j,q),ee=u(H,j,q),te,Se,ke=pe,Be=pe-ee;if(Se=pe===0?0:Be/pe,pe==ee)te=0;else{switch(pe){case H:te=(j-q)/Be+(j<q?6:0);break;case j:te=(q-H)/Be+2;break;case q:te=(H-j)/Be+4;break}te/=6}return{h:te,s:Se,v:ke}}function M(H,j,q){H=ge(H,360)*6,j=ge(j,100),q=ge(q,100);var pe=n.floor(H),ee=H-pe,te=q*(1-j),Se=q*(1-ee*j),ke=q*(1-(1-ee)*j),Be=pe%6,We=[q,Se,te,te,ke,q][Be],ve=[ke,q,q,Se,te,te][Be],K=[te,te,ke,q,q,Se][Be];return{r:We*255,g:ve*255,b:K*255}}function S(H,j,q,pe){var ee=[Le(o(H).toString(16)),Le(o(j).toString(16)),Le(o(q).toString(16))];return pe&&ee[0].charAt(0)==ee[0].charAt(1)&&ee[1].charAt(0)==ee[1].charAt(1)&&ee[2].charAt(0)==ee[2].charAt(1)?ee[0].charAt(0)+ee[1].charAt(0)+ee[2].charAt(0):ee.join("")}function E(H,j,q,pe,ee){var te=[Le(o(H).toString(16)),Le(o(j).toString(16)),Le(o(q).toString(16)),Le(Me(pe))];return ee&&te[0].charAt(0)==te[0].charAt(1)&&te[1].charAt(0)==te[1].charAt(1)&&te[2].charAt(0)==te[2].charAt(1)&&te[3].charAt(0)==te[3].charAt(1)?te[0].charAt(0)+te[1].charAt(0)+te[2].charAt(0)+te[3].charAt(0):te.join("")}function T(H,j,q,pe){var ee=[Le(Me(pe)),Le(o(H).toString(16)),Le(o(j).toString(16)),Le(o(q).toString(16))];return ee.join("")}m.equals=function(H,j){return!H||!j?!1:m(H).toRgbString()==m(j).toRgbString()},m.random=function(){return m.fromRatio({r:v(),g:v(),b:v()})};function C(H,j){j=j===0?0:j||10;var q=m(H).toHsl();return q.s-=j/100,q.s=_e(q.s),m(q)}function L(H,j){j=j===0?0:j||10;var q=m(H).toHsl();return q.s+=j/100,q.s=_e(q.s),m(q)}function P(H){return m(H).desaturate(100)}function N(H,j){j=j===0?0:j||10;var q=m(H).toHsl();return q.l+=j/100,q.l=_e(q.l),m(q)}function F(H,j){j=j===0?0:j||10;var q=m(H).toRgb();return q.r=f(0,u(255,q.r-o(255*-(j/100)))),q.g=f(0,u(255,q.g-o(255*-(j/100)))),q.b=f(0,u(255,q.b-o(255*-(j/100)))),m(q)}function X(H,j){j=j===0?0:j||10;var q=m(H).toHsl();return q.l-=j/100,q.l=_e(q.l),m(q)}function Y(H,j){var q=m(H).toHsl(),pe=(q.h+j)%360;return q.h=pe<0?360+pe:pe,m(q)}function ae(H){var j=m(H).toHsl();return j.h=(j.h+180)%360,m(j)}function $(H){var j=m(H).toHsl(),q=j.h;return[m(H),m({h:(q+120)%360,s:j.s,l:j.l}),m({h:(q+240)%360,s:j.s,l:j.l})]}function de(H){var j=m(H).toHsl(),q=j.h;return[m(H),m({h:(q+90)%360,s:j.s,l:j.l}),m({h:(q+180)%360,s:j.s,l:j.l}),m({h:(q+270)%360,s:j.s,l:j.l})]}function D(H){var j=m(H).toHsl(),q=j.h;return[m(H),m({h:(q+72)%360,s:j.s,l:j.l}),m({h:(q+216)%360,s:j.s,l:j.l})]}function I(H,j,q){j=j||6,q=q||30;var pe=m(H).toHsl(),ee=360/q,te=[m(H)];for(pe.h=(pe.h-(ee*j>>1)+720)%360;--j;)pe.h=(pe.h+ee)%360,te.push(m(pe));return te}function k(H,j){j=j||6;for(var q=m(H).toHsv(),pe=q.h,ee=q.s,te=q.v,Se=[],ke=1/j;j--;)Se.push(m({h:pe,s:ee,v:te})),te=(te+ke)%1;return Se}m.mix=function(H,j,q){q=q===0?0:q||50;var pe=m(H).toRgb(),ee=m(j).toRgb(),te=q/100,Se={r:(ee.r-pe.r)*te+pe.r,g:(ee.g-pe.g)*te+pe.g,b:(ee.b-pe.b)*te+pe.b,a:(ee.a-pe.a)*te+pe.a};return m(Se)},m.readability=function(H,j){var q=m(H),pe=m(j);return(n.max(q.getLuminance(),pe.getLuminance())+.05)/(n.min(q.getLuminance(),pe.getLuminance())+.05)},m.isReadable=function(H,j,q){var pe=m.readability(H,j),ee,te;switch(te=!1,ee=fe(q),ee.level+ee.size){case"AAsmall":case"AAAlarge":te=pe>=4.5;break;case"AAlarge":te=pe>=3;break;case"AAAsmall":te=pe>=7;break}return te},m.mostReadable=function(H,j,q){var pe=null,ee=0,te,Se,ke,Be;q=q||{},Se=q.includeFallbackColors,ke=q.level,Be=q.size;for(var We=0;We<j.length;We++)te=m.readability(H,j[We]),te>ee&&(ee=te,pe=m(j[We]));return m.isReadable(H,pe,{level:ke,size:Be})||!Se?pe:(q.includeFallbackColors=!1,m.mostReadable(H,["#fff","#000"],q))};var U=m.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},W=m.hexNames=ce(U);function ce(H){var j={};for(var q in H)H.hasOwnProperty(q)&&(j[H[q]]=q);return j}function oe(H){return H=parseFloat(H),(isNaN(H)||H<0||H>1)&&(H=1),H}function ge(H,j){Ie(H)&&(H="100%");var q=Ve(H);return H=u(j,f(0,parseFloat(H))),q&&(H=parseInt(H*j,10)/100),n.abs(H-j)<1e-6?1:H%j/parseFloat(j)}function _e(H){return u(1,f(0,H))}function Ne(H){return parseInt(H,16)}function Ie(H){return typeof H=="string"&&H.indexOf(".")!=-1&&parseFloat(H)===1}function Ve(H){return typeof H=="string"&&H.indexOf("%")!=-1}function Le(H){return H.length==1?"0"+H:""+H}function Fe(H){return H<=1&&(H=H*100+"%"),H}function Me(H){return n.round(parseFloat(H)*255).toString(16)}function Qe(H){return Ne(H)/255}var mt=function(){var H="[-\\+]?\\d+%?",j="[-\\+]?\\d*\\.\\d+%?",q="(?:"+j+")|(?:"+H+")",pe="[\\s|\\(]+("+q+")[,|\\s]+("+q+")[,|\\s]+("+q+")\\s*\\)?",ee="[\\s|\\(]+("+q+")[,|\\s]+("+q+")[,|\\s]+("+q+")[,|\\s]+("+q+")\\s*\\)?";return{CSS_UNIT:new RegExp(q),rgb:new RegExp("rgb"+pe),rgba:new RegExp("rgba"+ee),hsl:new RegExp("hsl"+pe),hsla:new RegExp("hsla"+ee),hsv:new RegExp("hsv"+pe),hsva:new RegExp("hsva"+ee),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function ht(H){return!!mt.CSS_UNIT.exec(H)}function ye(H){H=H.replace(r,"").replace(a,"").toLowerCase();var j=!1;if(U[H])H=U[H],j=!0;else if(H=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var q;return(q=mt.rgb.exec(H))?{r:q[1],g:q[2],b:q[3]}:(q=mt.rgba.exec(H))?{r:q[1],g:q[2],b:q[3],a:q[4]}:(q=mt.hsl.exec(H))?{h:q[1],s:q[2],l:q[3]}:(q=mt.hsla.exec(H))?{h:q[1],s:q[2],l:q[3],a:q[4]}:(q=mt.hsv.exec(H))?{h:q[1],s:q[2],v:q[3]}:(q=mt.hsva.exec(H))?{h:q[1],s:q[2],v:q[3],a:q[4]}:(q=mt.hex8.exec(H))?{r:Ne(q[1]),g:Ne(q[2]),b:Ne(q[3]),a:Qe(q[4]),format:j?"name":"hex8"}:(q=mt.hex6.exec(H))?{r:Ne(q[1]),g:Ne(q[2]),b:Ne(q[3]),format:j?"name":"hex"}:(q=mt.hex4.exec(H))?{r:Ne(q[1]+""+q[1]),g:Ne(q[2]+""+q[2]),b:Ne(q[3]+""+q[3]),a:Qe(q[4]+""+q[4]),format:j?"name":"hex8"}:(q=mt.hex3.exec(H))?{r:Ne(q[1]+""+q[1]),g:Ne(q[2]+""+q[2]),b:Ne(q[3]+""+q[3]),format:j?"name":"hex"}:!1}function fe(H){var j,q;return H=H||{level:"AA",size:"small"},j=(H.level||"AA").toUpperCase(),q=(H.size||"small").toLowerCase(),j!=="AA"&&j!=="AAA"&&(j="AA"),q!=="small"&&q!=="large"&&(q="small"),{level:j,size:q}}i.exports?i.exports=m:window.tinycolor=m})(Math)})(zC);var H1=zC.exports;function xX(i,n){if(!(i instanceof n))throw new TypeError("Cannot call a class as a function")}function GC(i,n){for(var r=0;r<n.length;r++){var a=n[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(i,a.key,a)}}function wX(i,n,r){return n&&GC(i.prototype,n),r&&GC(i,r),i}function AX(i){return EX(i)||_X(i)||MX(i)||SX()}function EX(i){if(Array.isArray(i))return z1(i)}function _X(i){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(i))return Array.from(i)}function MX(i,n){if(!!i){if(typeof i=="string")return z1(i,n);var r=Object.prototype.toString.call(i).slice(8,-1);if(r==="Object"&&i.constructor&&(r=i.constructor.name),r==="Map"||r==="Set")return Array.from(i);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return z1(i,n)}}function z1(i,n){(n==null||n>i.length)&&(n=i.length);for(var r=0,a=new Array(n);r<n;r++)a[r]=i[r];return a}function SX(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var TX=123,CX=function(n){return"#".concat(Math.min(n,Math.pow(2,24)).toString(16).padStart(6,"0"))},VC=function(n,r,a){return(n<<16)+(r<<8)+a},RX=function(n){var r=H1(n).toRgb(),a=r.r,s=r.g,o=r.b;return VC(a,s,o)},WC=function(n,r){return n*TX%Math.pow(2,r)},LX=function(){function i(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:6;xX(this,i),this.csBits=n,this.registry=["__reserved for background__"]}return wX(i,[{key:"register",value:function(r){if(this.registry.length>=Math.pow(2,24-this.csBits))return null;var a=this.registry.length,s=WC(a,this.csBits),o=CX(a+(s<<24-this.csBits));return this.registry.push(r),o}},{key:"lookup",value:function(r){var a=typeof r=="string"?RX(r):VC.apply(void 0,AX(r));if(!a)return null;var s=a&Math.pow(2,24-this.csBits)-1,o=a>>24-this.csBits&Math.pow(2,this.csBits)-1;return WC(s,this.csBits)!==o||s>=this.registry.length?null:this.registry[s]}}]),i}();function jC(i,n,r){var a,s=1;i==null&&(i=0),n==null&&(n=0),r==null&&(r=0);function o(){var u,f=a.length,v,m=0,g=0,y=0;for(u=0;u<f;++u)v=a[u],m+=v.x||0,g+=v.y||0,y+=v.z||0;for(m=(m/f-i)*s,g=(g/f-n)*s,y=(y/f-r)*s,u=0;u<f;++u)v=a[u],m&&(v.x-=m),g&&(v.y-=g),y&&(v.z-=y)}return o.initialize=function(u){a=u},o.x=function(u){return arguments.length?(i=+u,o):i},o.y=function(u){return arguments.length?(n=+u,o):n},o.z=function(u){return arguments.length?(r=+u,o):r},o.strength=function(u){return arguments.length?(s=+u,o):s},o}function PX(i){var n=+this._x.call(null,i);return XC(this.cover(n),n,i)}function XC(i,n,r){if(isNaN(n))return i;var a,s=i._root,o={data:r},u=i._x0,f=i._x1,v,m,g,y,b;if(!s)return i._root=o,i;for(;s.length;)if((g=n>=(v=(u+f)/2))?u=v:f=v,a=s,!(s=s[y=+g]))return a[y]=o,i;if(m=+i._x.call(null,s.data),n===m)return o.next=s,a?a[y]=o:i._root=o,i;do a=a?a[y]=new Array(2):i._root=new Array(2),(g=n>=(v=(u+f)/2))?u=v:f=v;while((y=+g)==(b=+(m>=v)));return a[b]=s,a[y]=o,i}function DX(i){var n,r=i.length,a,s=new Array(r),o=1/0,u=-1/0;for(n=0;n<r;++n)isNaN(a=+this._x.call(null,i[n]))||(s[n]=a,a<o&&(o=a),a>u&&(u=a));if(o>u)return this;for(this.cover(o).cover(u),n=0;n<r;++n)XC(this,s[n],i[n]);return this}function OX(i){if(isNaN(i=+i))return this;var n=this._x0,r=this._x1;if(isNaN(n))r=(n=Math.floor(i))+1;else{for(var a=r-n||1,s=this._root,o,u;n>i||i>=r;)switch(u=+(i<n),o=new Array(2),o[u]=s,s=o,a*=2,u){case 0:r=n+a;break;case 1:n=r-a;break}this._root&&this._root.length&&(this._root=s)}return this._x0=n,this._x1=r,this}function IX(){var i=[];return this.visit(function(n){if(!n.length)do i.push(n.data);while(n=n.next)}),i}function kX(i){return arguments.length?this.cover(+i[0][0]).cover(+i[1][0]):isNaN(this._x0)?void 0:[[this._x0],[this._x1]]}function js(i,n,r){this.node=i,this.x0=n,this.x1=r}function FX(i,n){var r,a=this._x0,s,o,u=this._x1,f=[],v=this._root,m,g;for(v&&f.push(new js(v,a,u)),n==null?n=1/0:(a=i-n,u=i+n);m=f.pop();)if(!(!(v=m.node)||(s=m.x0)>u||(o=m.x1)<a))if(v.length){var y=(s+o)/2;f.push(new js(v[1],y,o),new js(v[0],s,y)),(g=+(i>=y))&&(m=f[f.length-1],f[f.length-1]=f[f.length-1-g],f[f.length-1-g]=m)}else{var b=Math.abs(i-+this._x.call(null,v.data));b<n&&(n=b,a=i-b,u=i+b,r=v.data)}return r}function BX(i){if(isNaN(v=+this._x.call(null,i)))return this;var n,r=this._root,a,s,o,u=this._x0,f=this._x1,v,m,g,y,b;if(!r)return this;if(r.length)for(;;){if((g=v>=(m=(u+f)/2))?u=m:f=m,n=r,!(r=r[y=+g]))return this;if(!r.length)break;n[y+1&1]&&(a=n,b=y)}for(;r.data!==i;)if(s=r,!(r=r.next))return this;return(o=r.next)&&delete r.next,s?(o?s.next=o:delete s.next,this):n?(o?n[y]=o:delete n[y],(r=n[0]||n[1])&&r===(n[1]||n[0])&&!r.length&&(a?a[b]=r:this._root=r),this):(this._root=o,this)}function NX(i){for(var n=0,r=i.length;n<r;++n)this.remove(i[n]);return this}function UX(){return this._root}function HX(){var i=0;return this.visit(function(n){if(!n.length)do++i;while(n=n.next)}),i}function zX(i){var n=[],r,a=this._root,s,o,u;for(a&&n.push(new js(a,this._x0,this._x1));r=n.pop();)if(!i(a=r.node,o=r.x0,u=r.x1)&&a.length){var f=(o+u)/2;(s=a[1])&&n.push(new js(s,f,u)),(s=a[0])&&n.push(new js(s,o,f))}return this}function GX(i){var n=[],r=[],a;for(this._root&&n.push(new js(this._root,this._x0,this._x1));a=n.pop();){var s=a.node;if(s.length){var o,u=a.x0,f=a.x1,v=(u+f)/2;(o=s[0])&&n.push(new js(o,u,v)),(o=s[1])&&n.push(new js(o,v,f))}r.push(a)}for(;a=r.pop();)i(a.node,a.x0,a.x1);return this}function VX(i){return i[0]}function WX(i){return arguments.length?(this._x=i,this):this._x}function qC(i,n){var r=new G1(n==null?VX:n,NaN,NaN);return i==null?r:r.addAll(i)}function G1(i,n,r){this._x=i,this._x0=n,this._x1=r,this._root=void 0}function YC(i){for(var n={data:i.data},r=n;i=i.next;)r=r.next={data:i.data};return n}var Na=qC.prototype=G1.prototype;Na.copy=function(){var i=new G1(this._x,this._x0,this._x1),n=this._root,r,a;if(!n)return i;if(!n.length)return i._root=YC(n),i;for(r=[{source:n,target:i._root=new Array(2)}];n=r.pop();)for(var s=0;s<2;++s)(a=n.source[s])&&(a.length?r.push({source:a,target:n.target[s]=new Array(2)}):n.target[s]=YC(a));return i};Na.add=PX;Na.addAll=DX;Na.cover=OX;Na.data=IX;Na.extent=kX;Na.find=FX;Na.remove=BX;Na.removeAll=NX;Na.root=UX;Na.size=HX;Na.visit=zX;Na.visitAfter=GX;Na.x=WX;function jX(i){const n=+this._x.call(null,i),r=+this._y.call(null,i);return $C(this.cover(n,r),n,r,i)}function $C(i,n,r,a){if(isNaN(n)||isNaN(r))return i;var s,o=i._root,u={data:a},f=i._x0,v=i._y0,m=i._x1,g=i._y1,y,b,w,A,M,S,E,T;if(!o)return i._root=u,i;for(;o.length;)if((M=n>=(y=(f+m)/2))?f=y:m=y,(S=r>=(b=(v+g)/2))?v=b:g=b,s=o,!(o=o[E=S<<1|M]))return s[E]=u,i;if(w=+i._x.call(null,o.data),A=+i._y.call(null,o.data),n===w&&r===A)return u.next=o,s?s[E]=u:i._root=u,i;do s=s?s[E]=new Array(4):i._root=new Array(4),(M=n>=(y=(f+m)/2))?f=y:m=y,(S=r>=(b=(v+g)/2))?v=b:g=b;while((E=S<<1|M)==(T=(A>=b)<<1|w>=y));return s[T]=o,s[E]=u,i}function XX(i){var n,r,a=i.length,s,o,u=new Array(a),f=new Array(a),v=1/0,m=1/0,g=-1/0,y=-1/0;for(r=0;r<a;++r)isNaN(s=+this._x.call(null,n=i[r]))||isNaN(o=+this._y.call(null,n))||(u[r]=s,f[r]=o,s<v&&(v=s),s>g&&(g=s),o<m&&(m=o),o>y&&(y=o));if(v>g||m>y)return this;for(this.cover(v,m).cover(g,y),r=0;r<a;++r)$C(this,u[r],f[r],i[r]);return this}function qX(i,n){if(isNaN(i=+i)||isNaN(n=+n))return this;var r=this._x0,a=this._y0,s=this._x1,o=this._y1;if(isNaN(r))s=(r=Math.floor(i))+1,o=(a=Math.floor(n))+1;else{for(var u=s-r||1,f=this._root,v,m;r>i||i>=s||a>n||n>=o;)switch(m=(n<a)<<1|i<r,v=new Array(4),v[m]=f,f=v,u*=2,m){case 0:s=r+u,o=a+u;break;case 1:r=s-u,o=a+u;break;case 2:s=r+u,a=o-u;break;case 3:r=s-u,a=o-u;break}this._root&&this._root.length&&(this._root=f)}return this._x0=r,this._y0=a,this._x1=s,this._y1=o,this}function YX(){var i=[];return this.visit(function(n){if(!n.length)do i.push(n.data);while(n=n.next)}),i}function $X(i){return arguments.length?this.cover(+i[0][0],+i[0][1]).cover(+i[1][0],+i[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Da(i,n,r,a,s){this.node=i,this.x0=n,this.y0=r,this.x1=a,this.y1=s}function KX(i,n,r){var a,s=this._x0,o=this._y0,u,f,v,m,g=this._x1,y=this._y1,b=[],w=this._root,A,M;for(w&&b.push(new Da(w,s,o,g,y)),r==null?r=1/0:(s=i-r,o=n-r,g=i+r,y=n+r,r*=r);A=b.pop();)if(!(!(w=A.node)||(u=A.x0)>g||(f=A.y0)>y||(v=A.x1)<s||(m=A.y1)<o))if(w.length){var S=(u+v)/2,E=(f+m)/2;b.push(new Da(w[3],S,E,v,m),new Da(w[2],u,E,S,m),new Da(w[1],S,f,v,E),new Da(w[0],u,f,S,E)),(M=(n>=E)<<1|i>=S)&&(A=b[b.length-1],b[b.length-1]=b[b.length-1-M],b[b.length-1-M]=A)}else{var T=i-+this._x.call(null,w.data),C=n-+this._y.call(null,w.data),L=T*T+C*C;if(L<r){var P=Math.sqrt(r=L);s=i-P,o=n-P,g=i+P,y=n+P,a=w.data}}return a}function ZX(i){if(isNaN(g=+this._x.call(null,i))||isNaN(y=+this._y.call(null,i)))return this;var n,r=this._root,a,s,o,u=this._x0,f=this._y0,v=this._x1,m=this._y1,g,y,b,w,A,M,S,E;if(!r)return this;if(r.length)for(;;){if((A=g>=(b=(u+v)/2))?u=b:v=b,(M=y>=(w=(f+m)/2))?f=w:m=w,n=r,!(r=r[S=M<<1|A]))return this;if(!r.length)break;(n[S+1&3]||n[S+2&3]||n[S+3&3])&&(a=n,E=S)}for(;r.data!==i;)if(s=r,!(r=r.next))return this;return(o=r.next)&&delete r.next,s?(o?s.next=o:delete s.next,this):n?(o?n[S]=o:delete n[S],(r=n[0]||n[1]||n[2]||n[3])&&r===(n[3]||n[2]||n[1]||n[0])&&!r.length&&(a?a[E]=r:this._root=r),this):(this._root=o,this)}function QX(i){for(var n=0,r=i.length;n<r;++n)this.remove(i[n]);return this}function JX(){return this._root}function eq(){var i=0;return this.visit(function(n){if(!n.length)do++i;while(n=n.next)}),i}function tq(i){var n=[],r,a=this._root,s,o,u,f,v;for(a&&n.push(new Da(a,this._x0,this._y0,this._x1,this._y1));r=n.pop();)if(!i(a=r.node,o=r.x0,u=r.y0,f=r.x1,v=r.y1)&&a.length){var m=(o+f)/2,g=(u+v)/2;(s=a[3])&&n.push(new Da(s,m,g,f,v)),(s=a[2])&&n.push(new Da(s,o,g,m,v)),(s=a[1])&&n.push(new Da(s,m,u,f,g)),(s=a[0])&&n.push(new Da(s,o,u,m,g))}return this}function nq(i){var n=[],r=[],a;for(this._root&&n.push(new Da(this._root,this._x0,this._y0,this._x1,this._y1));a=n.pop();){var s=a.node;if(s.length){var o,u=a.x0,f=a.y0,v=a.x1,m=a.y1,g=(u+v)/2,y=(f+m)/2;(o=s[0])&&n.push(new Da(o,u,f,g,y)),(o=s[1])&&n.push(new Da(o,g,f,v,y)),(o=s[2])&&n.push(new Da(o,u,y,g,m)),(o=s[3])&&n.push(new Da(o,g,y,v,m))}r.push(a)}for(;a=r.pop();)i(a.node,a.x0,a.y0,a.x1,a.y1);return this}function rq(i){return i[0]}function iq(i){return arguments.length?(this._x=i,this):this._x}function aq(i){return i[1]}function oq(i){return arguments.length?(this._y=i,this):this._y}function KC(i,n,r){var a=new V1(n==null?rq:n,r==null?aq:r,NaN,NaN,NaN,NaN);return i==null?a:a.addAll(i)}function V1(i,n,r,a,s,o){this._x=i,this._y=n,this._x0=r,this._y0=a,this._x1=s,this._y1=o,this._root=void 0}function ZC(i){for(var n={data:i.data},r=n;i=i.next;)r=r.next={data:i.data};return n}var Oa=KC.prototype=V1.prototype;Oa.copy=function(){var i=new V1(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root,r,a;if(!n)return i;if(!n.length)return i._root=ZC(n),i;for(r=[{source:n,target:i._root=new Array(4)}];n=r.pop();)for(var s=0;s<4;++s)(a=n.source[s])&&(a.length?r.push({source:a,target:n.target[s]=new Array(4)}):n.target[s]=ZC(a));return i};Oa.add=jX;Oa.addAll=XX;Oa.cover=qX;Oa.data=YX;Oa.extent=$X;Oa.find=KX;Oa.remove=ZX;Oa.removeAll=QX;Oa.root=JX;Oa.size=eq;Oa.visit=tq;Oa.visitAfter=nq;Oa.x=iq;Oa.y=oq;function sq(i){var n=+this._x.call(null,i),r=+this._y.call(null,i),a=+this._z.call(null,i);return QC(this.cover(n,r,a),n,r,a,i)}function QC(i,n,r,a,s){if(isNaN(n)||isNaN(r)||isNaN(a))return i;var o,u=i._root,f={data:s},v=i._x0,m=i._y0,g=i._z0,y=i._x1,b=i._y1,w=i._z1,A,M,S,E,T,C,L,P,N,F,X;if(!u)return i._root=f,i;for(;u.length;)if((L=n>=(A=(v+y)/2))?v=A:y=A,(P=r>=(M=(m+b)/2))?m=M:b=M,(N=a>=(S=(g+w)/2))?g=S:w=S,o=u,!(u=u[F=N<<2|P<<1|L]))return o[F]=f,i;if(E=+i._x.call(null,u.data),T=+i._y.call(null,u.data),C=+i._z.call(null,u.data),n===E&&r===T&&a===C)return f.next=u,o?o[F]=f:i._root=f,i;do o=o?o[F]=new Array(8):i._root=new Array(8),(L=n>=(A=(v+y)/2))?v=A:y=A,(P=r>=(M=(m+b)/2))?m=M:b=M,(N=a>=(S=(g+w)/2))?g=S:w=S;while((F=N<<2|P<<1|L)==(X=(C>=S)<<2|(T>=M)<<1|E>=A));return o[X]=u,o[F]=f,i}function lq(i){var n,r,a=i.length,s,o,u,f=new Array(a),v=new Array(a),m=new Array(a),g=1/0,y=1/0,b=1/0,w=-1/0,A=-1/0,M=-1/0;for(r=0;r<a;++r)isNaN(s=+this._x.call(null,n=i[r]))||isNaN(o=+this._y.call(null,n))||isNaN(u=+this._z.call(null,n))||(f[r]=s,v[r]=o,m[r]=u,s<g&&(g=s),s>w&&(w=s),o<y&&(y=o),o>A&&(A=o),u<b&&(b=u),u>M&&(M=u));if(g>w||y>A||b>M)return this;for(this.cover(g,y,b).cover(w,A,M),r=0;r<a;++r)QC(this,f[r],v[r],m[r],i[r]);return this}function cq(i,n,r){if(isNaN(i=+i)||isNaN(n=+n)||isNaN(r=+r))return this;var a=this._x0,s=this._y0,o=this._z0,u=this._x1,f=this._y1,v=this._z1;if(isNaN(a))u=(a=Math.floor(i))+1,f=(s=Math.floor(n))+1,v=(o=Math.floor(r))+1;else{for(var m=u-a||1,g=this._root,y,b;a>i||i>=u||s>n||n>=f||o>r||r>=v;)switch(b=(r<o)<<2|(n<s)<<1|i<a,y=new Array(8),y[b]=g,g=y,m*=2,b){case 0:u=a+m,f=s+m,v=o+m;break;case 1:a=u-m,f=s+m,v=o+m;break;case 2:u=a+m,s=f-m,v=o+m;break;case 3:a=u-m,s=f-m,v=o+m;break;case 4:u=a+m,f=s+m,o=v-m;break;case 5:a=u-m,f=s+m,o=v-m;break;case 6:u=a+m,s=f-m,o=v-m;break;case 7:a=u-m,s=f-m,o=v-m;break}this._root&&this._root.length&&(this._root=g)}return this._x0=a,this._y0=s,this._z0=o,this._x1=u,this._y1=f,this._z1=v,this}function uq(){var i=[];return this.visit(function(n){if(!n.length)do i.push(n.data);while(n=n.next)}),i}function hq(i){return arguments.length?this.cover(+i[0][0],+i[0][1],+i[0][2]).cover(+i[1][0],+i[1][1],+i[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]}function ui(i,n,r,a,s,o,u){this.node=i,this.x0=n,this.y0=r,this.z0=a,this.x1=s,this.y1=o,this.z1=u}function fq(i,n,r,a){var s,o=this._x0,u=this._y0,f=this._z0,v,m,g,y,b,w,A=this._x1,M=this._y1,S=this._z1,E=[],T=this._root,C,L;for(T&&E.push(new ui(T,o,u,f,A,M,S)),a==null?a=1/0:(o=i-a,u=n-a,f=r-a,A=i+a,M=n+a,S=r+a,a*=a);C=E.pop();)if(!(!(T=C.node)||(v=C.x0)>A||(m=C.y0)>M||(g=C.z0)>S||(y=C.x1)<o||(b=C.y1)<u||(w=C.z1)<f))if(T.length){var P=(v+y)/2,N=(m+b)/2,F=(g+w)/2;E.push(new ui(T[7],P,N,F,y,b,w),new ui(T[6],v,N,F,P,b,w),new ui(T[5],P,m,F,y,N,w),new ui(T[4],v,m,F,P,N,w),new ui(T[3],P,N,g,y,b,F),new ui(T[2],v,N,g,P,b,F),new ui(T[1],P,m,g,y,N,F),new ui(T[0],v,m,g,P,N,F)),(L=(r>=F)<<2|(n>=N)<<1|i>=P)&&(C=E[E.length-1],E[E.length-1]=E[E.length-1-L],E[E.length-1-L]=C)}else{var X=i-+this._x.call(null,T.data),Y=n-+this._y.call(null,T.data),ae=r-+this._z.call(null,T.data),$=X*X+Y*Y+ae*ae;if($<a){var de=Math.sqrt(a=$);o=i-de,u=n-de,f=r-de,A=i+de,M=n+de,S=r+de,s=T.data}}return s}function dq(i){if(isNaN(b=+this._x.call(null,i))||isNaN(w=+this._y.call(null,i))||isNaN(A=+this._z.call(null,i)))return this;var n,r=this._root,a,s,o,u=this._x0,f=this._y0,v=this._z0,m=this._x1,g=this._y1,y=this._z1,b,w,A,M,S,E,T,C,L,P,N;if(!r)return this;if(r.length)for(;;){if((T=b>=(M=(u+m)/2))?u=M:m=M,(C=w>=(S=(f+g)/2))?f=S:g=S,(L=A>=(E=(v+y)/2))?v=E:y=E,n=r,!(r=r[P=L<<2|C<<1|T]))return this;if(!r.length)break;(n[P+1&7]||n[P+2&7]||n[P+3&7]||n[P+4&7]||n[P+5&7]||n[P+6&7]||n[P+7&7])&&(a=n,N=P)}for(;r.data!==i;)if(s=r,!(r=r.next))return this;return(o=r.next)&&delete r.next,s?(o?s.next=o:delete s.next,this):n?(o?n[P]=o:delete n[P],(r=n[0]||n[1]||n[2]||n[3]||n[4]||n[5]||n[6]||n[7])&&r===(n[7]||n[6]||n[5]||n[4]||n[3]||n[2]||n[1]||n[0])&&!r.length&&(a?a[N]=r:this._root=r),this):(this._root=o,this)}function pq(i){for(var n=0,r=i.length;n<r;++n)this.remove(i[n]);return this}function mq(){return this._root}function vq(){var i=0;return this.visit(function(n){if(!n.length)do++i;while(n=n.next)}),i}function gq(i){var n=[],r,a=this._root,s,o,u,f,v,m,g;for(a&&n.push(new ui(a,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));r=n.pop();)if(!i(a=r.node,o=r.x0,u=r.y0,f=r.z0,v=r.x1,m=r.y1,g=r.z1)&&a.length){var y=(o+v)/2,b=(u+m)/2,w=(f+g)/2;(s=a[7])&&n.push(new ui(s,y,b,w,v,m,g)),(s=a[6])&&n.push(new ui(s,o,b,w,y,m,g)),(s=a[5])&&n.push(new ui(s,y,u,w,v,b,g)),(s=a[4])&&n.push(new ui(s,o,u,w,y,b,g)),(s=a[3])&&n.push(new ui(s,y,b,f,v,m,w)),(s=a[2])&&n.push(new ui(s,o,b,f,y,m,w)),(s=a[1])&&n.push(new ui(s,y,u,f,v,b,w)),(s=a[0])&&n.push(new ui(s,o,u,f,y,b,w))}return this}function yq(i){var n=[],r=[],a;for(this._root&&n.push(new ui(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));a=n.pop();){var s=a.node;if(s.length){var o,u=a.x0,f=a.y0,v=a.z0,m=a.x1,g=a.y1,y=a.z1,b=(u+m)/2,w=(f+g)/2,A=(v+y)/2;(o=s[0])&&n.push(new ui(o,u,f,v,b,w,A)),(o=s[1])&&n.push(new ui(o,b,f,v,m,w,A)),(o=s[2])&&n.push(new ui(o,u,w,v,b,g,A)),(o=s[3])&&n.push(new ui(o,b,w,v,m,g,A)),(o=s[4])&&n.push(new ui(o,u,f,A,b,w,y)),(o=s[5])&&n.push(new ui(o,b,f,A,m,w,y)),(o=s[6])&&n.push(new ui(o,u,w,A,b,g,y)),(o=s[7])&&n.push(new ui(o,b,w,A,m,g,y))}r.push(a)}for(;a=r.pop();)i(a.node,a.x0,a.y0,a.z0,a.x1,a.y1,a.z1);return this}function bq(i){return i[0]}function xq(i){return arguments.length?(this._x=i,this):this._x}function wq(i){return i[1]}function Aq(i){return arguments.length?(this._y=i,this):this._y}function Eq(i){return i[2]}function _q(i){return arguments.length?(this._z=i,this):this._z}function JC(i,n,r,a){var s=new W1(n==null?bq:n,r==null?wq:r,a==null?Eq:a,NaN,NaN,NaN,NaN,NaN,NaN);return i==null?s:s.addAll(i)}function W1(i,n,r,a,s,o,u,f,v){this._x=i,this._y=n,this._z=r,this._x0=a,this._y0=s,this._z0=o,this._x1=u,this._y1=f,this._z1=v,this._root=void 0}function e3(i){for(var n={data:i.data},r=n;i=i.next;)r=r.next={data:i.data};return n}var va=JC.prototype=W1.prototype;va.copy=function(){var i=new W1(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),n=this._root,r,a;if(!n)return i;if(!n.length)return i._root=e3(n),i;for(r=[{source:n,target:i._root=new Array(8)}];n=r.pop();)for(var s=0;s<8;++s)(a=n.source[s])&&(a.length?r.push({source:a,target:n.target[s]=new Array(8)}):n.target[s]=e3(a));return i};va.add=sq;va.addAll=lq;va.cover=cq;va.data=uq;va.extent=hq;va.find=fq;va.remove=dq;va.removeAll=pq;va.root=mq;va.size=vq;va.visit=gq;va.visitAfter=yq;va.x=xq;va.y=Aq;va.z=_q;function Xs(i){return function(){return i}}function qs(i){return(i()-.5)*1e-6}function Mq(i){return i.index}function t3(i,n){var r=i.get(n);if(!r)throw new Error("node not found: "+n);return r}function n3(i){var n=Mq,r=b,a,s=Xs(30),o,u,f,v,m,g,y=1;i==null&&(i=[]);function b(E){return 1/Math.min(v[E.source.index],v[E.target.index])}function w(E){for(var T=0,C=i.length;T<y;++T)for(var L=0,P,N,F,X=0,Y=0,ae=0,$,de;L<C;++L)P=i[L],N=P.source,F=P.target,X=F.x+F.vx-N.x-N.vx||qs(g),f>1&&(Y=F.y+F.vy-N.y-N.vy||qs(g)),f>2&&(ae=F.z+F.vz-N.z-N.vz||qs(g)),$=Math.sqrt(X*X+Y*Y+ae*ae),$=($-o[L])/$*E*a[L],X*=$,Y*=$,ae*=$,F.vx-=X*(de=m[L]),f>1&&(F.vy-=Y*de),f>2&&(F.vz-=ae*de),N.vx+=X*(de=1-de),f>1&&(N.vy+=Y*de),f>2&&(N.vz+=ae*de)}function A(){if(!!u){var E,T=u.length,C=i.length,L=new Map(u.map((N,F)=>[n(N,F,u),N])),P;for(E=0,v=new Array(T);E<C;++E)P=i[E],P.index=E,typeof P.source!="object"&&(P.source=t3(L,P.source)),typeof P.target!="object"&&(P.target=t3(L,P.target)),v[P.source.index]=(v[P.source.index]||0)+1,v[P.target.index]=(v[P.target.index]||0)+1;for(E=0,m=new Array(C);E<C;++E)P=i[E],m[E]=v[P.source.index]/(v[P.source.index]+v[P.target.index]);a=new Array(C),M(),o=new Array(C),S()}}function M(){if(!!u)for(var E=0,T=i.length;E<T;++E)a[E]=+r(i[E],E,i)}function S(){if(!!u)for(var E=0,T=i.length;E<T;++E)o[E]=+s(i[E],E,i)}return w.initialize=function(E,...T){u=E,g=T.find(C=>typeof C=="function")||Math.random,f=T.find(C=>[1,2,3].includes(C))||2,A()},w.links=function(E){return arguments.length?(i=E,A(),w):i},w.id=function(E){return arguments.length?(n=E,w):n},w.iterations=function(E){return arguments.length?(y=+E,w):y},w.strength=function(E){return arguments.length?(r=typeof E=="function"?E:Xs(+E),M(),w):r},w.distance=function(E){return arguments.length?(s=typeof E=="function"?E:Xs(+E),S(),w):s},w}const Sq=1664525,Tq=1013904223,r3=4294967296;function Cq(){let i=1;return()=>(i=(Sq*i+Tq)%r3)/r3}var i3=3;function j1(i){return i.x}function a3(i){return i.y}function Rq(i){return i.z}var Lq=10,Pq=Math.PI*(3-Math.sqrt(5)),Dq=Math.PI*20/(9+Math.sqrt(221));function o3(i,n){n=n||2;var r=Math.min(i3,Math.max(1,Math.round(n))),a,s=1,o=.001,u=1-Math.pow(o,1/300),f=0,v=.6,m=new Map,g=T1(w),y=Yd("tick","end"),b=Cq();i==null&&(i=[]);function w(){A(),y.call("tick",a),s<o&&(g.stop(),y.call("end",a))}function A(E){var T,C=i.length,L;E===void 0&&(E=1);for(var P=0;P<E;++P)for(s+=(f-s)*u,m.forEach(function(N){N(s)}),T=0;T<C;++T)L=i[T],L.fx==null?L.x+=L.vx*=v:(L.x=L.fx,L.vx=0),r>1&&(L.fy==null?L.y+=L.vy*=v:(L.y=L.fy,L.vy=0)),r>2&&(L.fz==null?L.z+=L.vz*=v:(L.z=L.fz,L.vz=0));return a}function M(){for(var E=0,T=i.length,C;E<T;++E){if(C=i[E],C.index=E,C.fx!=null&&(C.x=C.fx),C.fy!=null&&(C.y=C.fy),C.fz!=null&&(C.z=C.fz),isNaN(C.x)||r>1&&isNaN(C.y)||r>2&&isNaN(C.z)){var L=Lq*(r>2?Math.cbrt(.5+E):r>1?Math.sqrt(.5+E):E),P=E*Pq,N=E*Dq;r===1?C.x=L:r===2?(C.x=L*Math.cos(P),C.y=L*Math.sin(P)):(C.x=L*Math.sin(P)*Math.cos(N),C.y=L*Math.cos(P),C.z=L*Math.sin(P)*Math.sin(N))}(isNaN(C.vx)||r>1&&isNaN(C.vy)||r>2&&isNaN(C.vz))&&(C.vx=0,r>1&&(C.vy=0),r>2&&(C.vz=0))}}function S(E){return E.initialize&&E.initialize(i,b,r),E}return M(),a={tick:A,restart:function(){return g.restart(w),a},stop:function(){return g.stop(),a},numDimensions:function(E){return arguments.length?(r=Math.min(i3,Math.max(1,Math.round(E))),m.forEach(S),a):r},nodes:function(E){return arguments.length?(i=E,M(),m.forEach(S),a):i},alpha:function(E){return arguments.length?(s=+E,a):s},alphaMin:function(E){return arguments.length?(o=+E,a):o},alphaDecay:function(E){return arguments.length?(u=+E,a):+u},alphaTarget:function(E){return arguments.length?(f=+E,a):f},velocityDecay:function(E){return arguments.length?(v=1-E,a):1-v},randomSource:function(E){return arguments.length?(b=E,m.forEach(S),a):b},force:function(E,T){return arguments.length>1?(T==null?m.delete(E):m.set(E,S(T)),a):m.get(E)},find:function(){var E=Array.prototype.slice.call(arguments),T=E.shift()||0,C=(r>1?E.shift():null)||0,L=(r>2?E.shift():null)||0,P=E.shift()||1/0,N=0,F=i.length,X,Y,ae,$,de,D;for(P*=P,N=0;N<F;++N)de=i[N],X=T-de.x,Y=C-(de.y||0),ae=L-(de.z||0),$=X*X+Y*Y+ae*ae,$<P&&(D=de,P=$);return D},on:function(E,T){return arguments.length>1?(y.on(E,T),a):y.on(E)}}}function s3(){var i,n,r,a,s,o=Xs(-30),u,f=1,v=1/0,m=.81;function g(A){var M,S=i.length,E=(n===1?qC(i,j1):n===2?KC(i,j1,a3):n===3?JC(i,j1,a3,Rq):null).visitAfter(b);for(s=A,M=0;M<S;++M)r=i[M],E.visit(w)}function y(){if(!!i){var A,M=i.length,S;for(u=new Array(M),A=0;A<M;++A)S=i[A],u[S.index]=+o(S,A,i)}}function b(A){var M=0,S,E,T=0,C,L,P,N,F=A.length;if(F){for(C=L=P=N=0;N<F;++N)(S=A[N])&&(E=Math.abs(S.value))&&(M+=S.value,T+=E,C+=E*(S.x||0),L+=E*(S.y||0),P+=E*(S.z||0));M*=Math.sqrt(4/F),A.x=C/T,n>1&&(A.y=L/T),n>2&&(A.z=P/T)}else{S=A,S.x=S.data.x,n>1&&(S.y=S.data.y),n>2&&(S.z=S.data.z);do M+=u[S.data.index];while(S=S.next)}A.value=M}function w(A,M,S,E,T){if(!A.value)return!0;var C=[S,E,T][n-1],L=A.x-r.x,P=n>1?A.y-r.y:0,N=n>2?A.z-r.z:0,F=C-M,X=L*L+P*P+N*N;if(F*F/m<X)return X<v&&(L===0&&(L=qs(a),X+=L*L),n>1&&P===0&&(P=qs(a),X+=P*P),n>2&&N===0&&(N=qs(a),X+=N*N),X<f&&(X=Math.sqrt(f*X)),r.vx+=L*A.value*s/X,n>1&&(r.vy+=P*A.value*s/X),n>2&&(r.vz+=N*A.value*s/X)),!0;if(A.length||X>=v)return;(A.data!==r||A.next)&&(L===0&&(L=qs(a),X+=L*L),n>1&&P===0&&(P=qs(a),X+=P*P),n>2&&N===0&&(N=qs(a),X+=N*N),X<f&&(X=Math.sqrt(f*X)));do A.data!==r&&(F=u[A.data.index]*s/X,r.vx+=L*F,n>1&&(r.vy+=P*F),n>2&&(r.vz+=N*F));while(A=A.next)}return g.initialize=function(A,...M){i=A,a=M.find(S=>typeof S=="function")||Math.random,n=M.find(S=>[1,2,3].includes(S))||2,y()},g.strength=function(A){return arguments.length?(o=typeof A=="function"?A:Xs(+A),y(),g):o},g.distanceMin=function(A){return arguments.length?(f=A*A,g):Math.sqrt(f)},g.distanceMax=function(A){return arguments.length?(v=A*A,g):Math.sqrt(v)},g.theta=function(A){return arguments.length?(m=A*A,g):Math.sqrt(m)},g}function l3(i,n,r,a){var s,o,u=Xs(.1),f,v;typeof i!="function"&&(i=Xs(+i)),n==null&&(n=0),r==null&&(r=0),a==null&&(a=0);function m(y){for(var b=0,w=s.length;b<w;++b){var A=s[b],M=A.x-n||1e-6,S=(A.y||0)-r||1e-6,E=(A.z||0)-a||1e-6,T=Math.sqrt(M*M+S*S+E*E),C=(v[b]-T)*f[b]*y/T;A.vx+=M*C,o>1&&(A.vy+=S*C),o>2&&(A.vz+=E*C)}}function g(){if(!!s){var y,b=s.length;for(f=new Array(b),v=new Array(b),y=0;y<b;++y)v[y]=+i(s[y],y,s),f[y]=isNaN(v[y])?0:+u(s[y],y,s)}}return m.initialize=function(y,...b){s=y,o=b.find(w=>[1,2,3].includes(w))||2,g()},m.strength=function(y){return arguments.length?(u=typeof y=="function"?y:Xs(+y),g(),m):u},m.radius=function(y){return arguments.length?(i=typeof y=="function"?y:Xs(+y),g(),m):i},m.x=function(y){return arguments.length?(n=+y,m):n},m.y=function(y){return arguments.length?(r=+y,m):r},m.z=function(y){return arguments.length?(a=+y,m):a},m}const{abs:sp,cos:Ys,sin:Xh,acos:Oq,atan2:lp,sqrt:Kl,pow:po}=Math;function cp(i){return i<0?-po(-i,1/3):po(i,1/3)}const c3=Math.PI,Qg=2*c3,Zl=c3/2,Iq=1e-6,X1=Number.MAX_SAFE_INTEGER||9007199254740991,q1=Number.MIN_SAFE_INTEGER||-9007199254740991,kq={x:0,y:0,z:0},nn={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(i,n){const r=n(i);let a=r.x*r.x+r.y*r.y;return typeof r.z!="undefined"&&(a+=r.z*r.z),Kl(a)},compute:function(i,n,r){if(i===0)return n[0].t=0,n[0];const a=n.length-1;if(i===1)return n[a].t=1,n[a];const s=1-i;let o=n;if(a===0)return n[0].t=i,n[0];if(a===1){const f={x:s*o[0].x+i*o[1].x,y:s*o[0].y+i*o[1].y,t:i};return r&&(f.z=s*o[0].z+i*o[1].z),f}if(a<4){let f=s*s,v=i*i,m,g,y,b=0;a===2?(o=[o[0],o[1],o[2],kq],m=f,g=s*i*2,y=v):a===3&&(m=f*s,g=f*i*3,y=s*v*3,b=i*v);const w={x:m*o[0].x+g*o[1].x+y*o[2].x+b*o[3].x,y:m*o[0].y+g*o[1].y+y*o[2].y+b*o[3].y,t:i};return r&&(w.z=m*o[0].z+g*o[1].z+y*o[2].z+b*o[3].z),w}const u=JSON.parse(JSON.stringify(n));for(;u.length>1;){for(let f=0;f<u.length-1;f++)u[f]={x:u[f].x+(u[f+1].x-u[f].x)*i,y:u[f].y+(u[f+1].y-u[f].y)*i},typeof u[f].z!="undefined"&&(u[f]=u[f].z+(u[f+1].z-u[f].z)*i);u.splice(u.length-1,1)}return u[0].t=i,u[0]},computeWithRatios:function(i,n,r,a){const s=1-i,o=r,u=n;let f=o[0],v=o[1],m=o[2],g=o[3],y;if(f*=s,v*=i,u.length===2)return y=f+v,{x:(f*u[0].x+v*u[1].x)/y,y:(f*u[0].y+v*u[1].y)/y,z:a?(f*u[0].z+v*u[1].z)/y:!1,t:i};if(f*=s,v*=2*s,m*=i*i,u.length===3)return y=f+v+m,{x:(f*u[0].x+v*u[1].x+m*u[2].x)/y,y:(f*u[0].y+v*u[1].y+m*u[2].y)/y,z:a?(f*u[0].z+v*u[1].z+m*u[2].z)/y:!1,t:i};if(f*=s,v*=1.5*s,m*=3*s,g*=i*i*i,u.length===4)return y=f+v+m+g,{x:(f*u[0].x+v*u[1].x+m*u[2].x+g*u[3].x)/y,y:(f*u[0].y+v*u[1].y+m*u[2].y+g*u[3].y)/y,z:a?(f*u[0].z+v*u[1].z+m*u[2].z+g*u[3].z)/y:!1,t:i}},derive:function(i,n){const r=[];for(let a=i,s=a.length,o=s-1;s>1;s--,o--){const u=[];for(let f=0,v;f<o;f++)v={x:o*(a[f+1].x-a[f].x),y:o*(a[f+1].y-a[f].y)},n&&(v.z=o*(a[f+1].z-a[f].z)),u.push(v);r.push(u),a=u}return r},between:function(i,n,r){return n<=i&&i<=r||nn.approximately(i,n)||nn.approximately(i,r)},approximately:function(i,n,r){return sp(i-n)<=(r||Iq)},length:function(i){const n=.5,r=nn.Tvalues.length;let a=0;for(let s=0,o;s<r;s++)o=n*nn.Tvalues[s]+n,a+=nn.Cvalues[s]*nn.arcfn(o,i);return n*a},map:function(i,n,r,a,s){const o=r-n,u=s-a,f=i-n,v=f/o;return a+u*v},lerp:function(i,n,r){const a={x:n.x+i*(r.x-n.x),y:n.y+i*(r.y-n.y)};return n.z!==void 0&&r.z!==void 0&&(a.z=n.z+i*(r.z-n.z)),a},pointToString:function(i){let n=i.x+"/"+i.y;return typeof i.z!="undefined"&&(n+="/"+i.z),n},pointsToString:function(i){return"["+i.map(nn.pointToString).join(", ")+"]"},copy:function(i){return JSON.parse(JSON.stringify(i))},angle:function(i,n,r){const a=n.x-i.x,s=n.y-i.y,o=r.x-i.x,u=r.y-i.y,f=a*u-s*o,v=a*o+s*u;return lp(f,v)},round:function(i,n){const r=""+i,a=r.indexOf(".");return parseFloat(r.substring(0,a+1+n))},dist:function(i,n){const r=i.x-n.x,a=i.y-n.y;return Kl(r*r+a*a)},closest:function(i,n){let r=po(2,63),a,s;return i.forEach(function(o,u){s=nn.dist(n,o),s<r&&(r=s,a=u)}),{mdist:r,mpos:a}},abcratio:function(i,n){if(n!==2&&n!==3)return!1;if(typeof i=="undefined")i=.5;else if(i===0||i===1)return i;const r=po(i,n)+po(1-i,n),a=r-1;return sp(a/r)},projectionratio:function(i,n){if(n!==2&&n!==3)return!1;if(typeof i=="undefined")i=.5;else if(i===0||i===1)return i;const r=po(1-i,n),a=po(i,n)+r;return r/a},lli8:function(i,n,r,a,s,o,u,f){const v=(i*a-n*r)*(s-u)-(i-r)*(s*f-o*u),m=(i*a-n*r)*(o-f)-(n-a)*(s*f-o*u),g=(i-r)*(o-f)-(n-a)*(s-u);return g==0?!1:{x:v/g,y:m/g}},lli4:function(i,n,r,a){const s=i.x,o=i.y,u=n.x,f=n.y,v=r.x,m=r.y,g=a.x,y=a.y;return nn.lli8(s,o,u,f,v,m,g,y)},lli:function(i,n){return nn.lli4(i,i.c,n,n.c)},makeline:function(i,n){const r=i.x,a=i.y,s=n.x,o=n.y,u=(s-r)/3,f=(o-a)/3;return new Ci(r,a,r+u,a+f,r+2*u,a+2*f,s,o)},findbbox:function(i){let n=X1,r=X1,a=q1,s=q1;return i.forEach(function(o){const u=o.bbox();n>u.x.min&&(n=u.x.min),r>u.y.min&&(r=u.y.min),a<u.x.max&&(a=u.x.max),s<u.y.max&&(s=u.y.max)}),{x:{min:n,mid:(n+a)/2,max:a,size:a-n},y:{min:r,mid:(r+s)/2,max:s,size:s-r}}},shapeintersections:function(i,n,r,a,s){if(!nn.bboxoverlap(n,a))return[];const o=[],u=[i.startcap,i.forward,i.back,i.endcap],f=[r.startcap,r.forward,r.back,r.endcap];return u.forEach(function(v){v.virtual||f.forEach(function(m){if(m.virtual)return;const g=v.intersects(m,s);g.length>0&&(g.c1=v,g.c2=m,g.s1=i,g.s2=r,o.push(g))})}),o},makeshape:function(i,n,r){const a=n.points.length,s=i.points.length,o=nn.makeline(n.points[a-1],i.points[0]),u=nn.makeline(i.points[s-1],n.points[0]),f={startcap:o,forward:i,back:n,endcap:u,bbox:nn.findbbox([o,i,n,u])};return f.intersections=function(v){return nn.shapeintersections(f,f.bbox,v,v.bbox,r)},f},getminmax:function(i,n,r){if(!r)return{min:0,max:0};let a=X1,s=q1,o,u;r.indexOf(0)===-1&&(r=[0].concat(r)),r.indexOf(1)===-1&&r.push(1);for(let f=0,v=r.length;f<v;f++)o=r[f],u=i.get(o),u[n]<a&&(a=u[n]),u[n]>s&&(s=u[n]);return{min:a,mid:(a+s)/2,max:s,size:s-a}},align:function(i,n){const r=n.p1.x,a=n.p1.y,s=-lp(n.p2.y-a,n.p2.x-r),o=function(u){return{x:(u.x-r)*Ys(s)-(u.y-a)*Xh(s),y:(u.x-r)*Xh(s)+(u.y-a)*Ys(s)}};return i.map(o)},roots:function(i,n){n=n||{p1:{x:0,y:0},p2:{x:1,y:0}};const r=i.length-1,a=nn.align(i,n),s=function(F){return 0<=F&&F<=1};if(r===2){const F=a[0].y,X=a[1].y,Y=a[2].y,ae=F-2*X+Y;if(ae!==0){const $=-Kl(X*X-F*Y),de=-F+X,D=-($+de)/ae,I=-(-$+de)/ae;return[D,I].filter(s)}else if(X!==Y&&ae===0)return[(2*X-Y)/(2*X-2*Y)].filter(s);return[]}const o=a[0].y,u=a[1].y,f=a[2].y,v=a[3].y;let m=-o+3*u-3*f+v,g=3*o-6*u+3*f,y=-3*o+3*u,b=o;if(nn.approximately(m,0)){if(nn.approximately(g,0))return nn.approximately(y,0)?[]:[-b/y].filter(s);const F=Kl(y*y-4*g*b),X=2*g;return[(F-y)/X,(-y-F)/X].filter(s)}g/=m,y/=m,b/=m;const w=(3*y-g*g)/3,A=w/3,M=(2*g*g*g-9*g*y+27*b)/27,S=M/2,E=S*S+A*A*A;let T,C,L,P,N;if(E<0){const F=-w/3,X=F*F*F,Y=Kl(X),ae=-M/(2*Y),$=ae<-1?-1:ae>1?1:ae,de=Oq($),D=cp(Y),I=2*D;return L=I*Ys(de/3)-g/3,P=I*Ys((de+Qg)/3)-g/3,N=I*Ys((de+2*Qg)/3)-g/3,[L,P,N].filter(s)}else{if(E===0)return T=S<0?cp(-S):-cp(S),L=2*T-g/3,P=-T-g/3,[L,P].filter(s);{const F=Kl(E);return T=cp(-S+F),C=cp(S+F),[T-C-g/3].filter(s)}}},droots:function(i){if(i.length===3){const n=i[0],r=i[1],a=i[2],s=n-2*r+a;if(s!==0){const o=-Kl(r*r-n*a),u=-n+r,f=-(o+u)/s,v=-(-o+u)/s;return[f,v]}else if(r!==a&&s===0)return[(2*r-a)/(2*(r-a))];return[]}if(i.length===2){const n=i[0],r=i[1];return n!==r?[n/(n-r)]:[]}return[]},curvature:function(i,n,r,a,s){let o,u,f,v,m=0,g=0;const y=nn.compute(i,n),b=nn.compute(i,r),w=y.x*y.x+y.y*y.y;if(a?(o=Kl(po(y.y*b.z-b.y*y.z,2)+po(y.z*b.x-b.z*y.x,2)+po(y.x*b.y-b.x*y.y,2)),u=po(w+y.z*y.z,3/2)):(o=y.x*b.y-y.y*b.x,u=po(w,3/2)),o===0||u===0)return{k:0,r:0};if(m=o/u,g=u/o,!s){const A=nn.curvature(i-.001,n,r,a,!0).k,M=nn.curvature(i+.001,n,r,a,!0).k;v=(M-m+(m-A))/2,f=(sp(M-m)+sp(m-A))/2}return{k:m,r:g,dk:v,adk:f}},inflections:function(i){if(i.length<4)return[];const n=nn.align(i,{p1:i[0],p2:i.slice(-1)[0]}),r=n[2].x*n[1].y,a=n[3].x*n[1].y,s=n[1].x*n[2].y,o=n[3].x*n[2].y,u=18*(-3*r+2*a+3*s-o),f=18*(3*r-a-3*s),v=18*(s-r);if(nn.approximately(u,0)){if(!nn.approximately(f,0)){let b=-v/f;if(0<=b&&b<=1)return[b]}return[]}const m=f*f-4*u*v,g=Math.sqrt(m),y=2*u;return nn.approximately(y,0)?[]:[(g-f)/y,-(f+g)/y].filter(function(b){return 0<=b&&b<=1})},bboxoverlap:function(i,n){const r=["x","y"],a=r.length;for(let s=0,o,u,f,v;s<a;s++)if(o=r[s],u=i[o].mid,f=n[o].mid,v=(i[o].size+n[o].size)/2,sp(u-f)>=v)return!1;return!0},expandbox:function(i,n){n.x.min<i.x.min&&(i.x.min=n.x.min),n.y.min<i.y.min&&(i.y.min=n.y.min),n.z&&n.z.min<i.z.min&&(i.z.min=n.z.min),n.x.max>i.x.max&&(i.x.max=n.x.max),n.y.max>i.y.max&&(i.y.max=n.y.max),n.z&&n.z.max>i.z.max&&(i.z.max=n.z.max),i.x.mid=(i.x.min+i.x.max)/2,i.y.mid=(i.y.min+i.y.max)/2,i.z&&(i.z.mid=(i.z.min+i.z.max)/2),i.x.size=i.x.max-i.x.min,i.y.size=i.y.max-i.y.min,i.z&&(i.z.size=i.z.max-i.z.min)},pairiteration:function(i,n,r){const a=i.bbox(),s=n.bbox(),o=1e5,u=r||.5;if(a.x.size+a.y.size<u&&s.x.size+s.y.size<u)return[(o*(i._t1+i._t2)/2|0)/o+"/"+(o*(n._t1+n._t2)/2|0)/o];let f=i.split(.5),v=n.split(.5),m=[{left:f.left,right:v.left},{left:f.left,right:v.right},{left:f.right,right:v.right},{left:f.right,right:v.left}];m=m.filter(function(y){return nn.bboxoverlap(y.left.bbox(),y.right.bbox())});let g=[];return m.length===0||(m.forEach(function(y){g=g.concat(nn.pairiteration(y.left,y.right,u))}),g=g.filter(function(y,b){return g.indexOf(y)===b})),g},getccenter:function(i,n,r){const a=n.x-i.x,s=n.y-i.y,o=r.x-n.x,u=r.y-n.y,f=a*Ys(Zl)-s*Xh(Zl),v=a*Xh(Zl)+s*Ys(Zl),m=o*Ys(Zl)-u*Xh(Zl),g=o*Xh(Zl)+u*Ys(Zl),y=(i.x+n.x)/2,b=(i.y+n.y)/2,w=(n.x+r.x)/2,A=(n.y+r.y)/2,M=y+f,S=b+v,E=w+m,T=A+g,C=nn.lli8(y,b,M,S,w,A,E,T),L=nn.dist(C,i);let P=lp(i.y-C.y,i.x-C.x),N=lp(n.y-C.y,n.x-C.x),F=lp(r.y-C.y,r.x-C.x),X;return P<F?((P>N||N>F)&&(P+=Qg),P>F&&(X=F,F=P,P=X)):F<N&&N<P?(X=F,F=P,P=X):F+=Qg,C.s=P,C.e=F,C.r=L,C},numberSort:function(i,n){return i-n}};class Jg{constructor(n){this.curves=[],this._3d=!1,n&&(this.curves=n,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map(function(n){return nn.pointsToString(n.points)}).join(", ")+"]"}addCurve(n){this.curves.push(n),this._3d=this._3d||n._3d}length(){return this.curves.map(function(n){return n.length()}).reduce(function(n,r){return n+r})}curve(n){return this.curves[n]}bbox(){const n=this.curves;for(var r=n[0].bbox(),a=1;a<n.length;a++)nn.expandbox(r,n[a].bbox());return r}offset(n){const r=[];return this.curves.forEach(function(a){r.push(...a.offset(n))}),new Jg(r)}}const{abs:up,min:u3,max:h3,cos:Fq,sin:Bq,acos:Nq,sqrt:hp}=Math,Uq=Math.PI;class Ci{constructor(n){let r=n&&n.forEach?n:Array.from(arguments).slice(),a=!1;if(typeof r[0]=="object"){a=r.length;const b=[];r.forEach(function(w){["x","y","z"].forEach(function(A){typeof w[A]!="undefined"&&b.push(w[A])})}),r=b}let s=!1;const o=r.length;if(a){if(a>4){if(arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");s=!0}}else if(o!==6&&o!==8&&o!==9&&o!==12&&arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const u=this._3d=!s&&(o===9||o===12)||n&&n[0]&&typeof n[0].z!="undefined",f=this.points=[];for(let b=0,w=u?3:2;b<o;b+=w){var v={x:r[b],y:r[b+1]};u&&(v.z=r[b+2]),f.push(v)}const m=this.order=f.length-1,g=this.dims=["x","y"];u&&g.push("z"),this.dimlen=g.length;const y=nn.align(f,{p1:f[0],p2:f[m]});this._linear=!y.some(b=>up(b.y)>1e-4),this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(n,r,a,s){if(typeof s=="undefined"&&(s=.5),s===0)return new Ci(r,r,a);if(s===1)return new Ci(n,r,r);const o=Ci.getABC(2,n,r,a,s);return new Ci(n,o.A,a)}static cubicFromPoints(n,r,a,s,o){typeof s=="undefined"&&(s=.5);const u=Ci.getABC(3,n,r,a,s);typeof o=="undefined"&&(o=nn.dist(r,u.C));const f=o*(1-s)/s,v=nn.dist(n,a),m=(a.x-n.x)/v,g=(a.y-n.y)/v,y=o*m,b=o*g,w=f*m,A=f*g,M={x:r.x-y,y:r.y-b},S={x:r.x+w,y:r.y+A},E=u.A,T={x:E.x+(M.x-E.x)/(1-s),y:E.y+(M.y-E.y)/(1-s)},C={x:E.x+(S.x-E.x)/s,y:E.y+(S.y-E.y)/s},L={x:n.x+(T.x-n.x)/s,y:n.y+(T.y-n.y)/s},P={x:a.x+(C.x-a.x)/(1-s),y:a.y+(C.y-a.y)/(1-s)};return new Ci(n,L,P,a)}static getUtils(){return nn}getUtils(){return Ci.getUtils()}static get PolyBezier(){return Jg}valueOf(){return this.toString()}toString(){return nn.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const n=this.points,r=n[0].x,a=n[0].y,s=["M",r,a,this.order===2?"Q":"C"];for(let o=1,u=n.length;o<u;o++)s.push(n[o].x),s.push(n[o].y);return s.join(" ")}setRatios(n){if(n.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=n,this._lut=[]}verify(){const n=this.coordDigest();n!==this._print&&(this._print=n,this.update())}coordDigest(){return this.points.map(function(n,r){return""+r+n.x+n.y+(n.z?n.z:0)}).join("")}update(){this._lut=[],this.dpoints=nn.derive(this.points,this._3d),this.computedirection()}computedirection(){const n=this.points,r=nn.angle(n[0],n[this.order],n[1]);this.clockwise=r>0}length(){return nn.length(this.derivative.bind(this))}static getABC(n=2,r,a,s,o=.5){const u=nn.projectionratio(o,n),f=1-u,v={x:u*r.x+f*s.x,y:u*r.y+f*s.y},m=nn.abcratio(o,n);return{A:{x:a.x+(a.x-v.x)/m,y:a.y+(a.y-v.y)/m},B:a,C:v,S:r,E:s}}getABC(n,r){r=r||this.get(n);let a=this.points[0],s=this.points[this.order];return Ci.getABC(this.order,a,r,s,n)}getLUT(n){if(this.verify(),n=n||100,this._lut.length===n)return this._lut;this._lut=[],n--;for(let r=0,a,s;r<n;r++)s=r/(n-1),a=this.compute(s),a.t=s,this._lut.push(a);return this._lut}on(n,r){r=r||5;const a=this.getLUT(),s=[];for(let o=0,u,f=0;o<a.length;o++)u=a[o],nn.dist(u,n)<r&&(s.push(u),f+=o/a.length);return s.length?t/=s.length:!1}project(n){const r=this.getLUT(),a=r.length-1,s=nn.closest(r,n),o=s.mpos,u=(o-1)/a,f=(o+1)/a,v=.1/a;let m=s.mdist,g=u,y=g,b;m+=1;for(let w;g<f+v;g+=v)b=this.compute(g),w=nn.dist(n,b),w<m&&(m=w,y=g);return y=y<0?0:y>1?1:y,b=this.compute(y),b.t=y,b.d=m,b}get(n){return this.compute(n)}point(n){return this.points[n]}compute(n){return this.ratios?nn.computeWithRatios(n,this.points,this.ratios,this._3d):nn.compute(n,this.points,this._3d,this.ratios)}raise(){const n=this.points,r=[n[0]],a=n.length;for(let s=1,o,u;s<a;s++)o=n[s],u=n[s-1],r[s]={x:(a-s)/a*o.x+s/a*u.x,y:(a-s)/a*o.y+s/a*u.y};return r[a]=n[a-1],new Ci(r)}derivative(n){return nn.compute(n,this.dpoints[0],this._3d)}dderivative(n){return nn.compute(n,this.dpoints[1],this._3d)}align(){let n=this.points;return new Ci(nn.align(n,{p1:n[0],p2:n[n.length-1]}))}curvature(n){return nn.curvature(n,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return nn.inflections(this.points)}normal(n){return this._3d?this.__normal3(n):this.__normal2(n)}__normal2(n){const r=this.derivative(n),a=hp(r.x*r.x+r.y*r.y);return{x:-r.y/a,y:r.x/a}}__normal3(n){const r=this.derivative(n),a=this.derivative(n+.01),s=hp(r.x*r.x+r.y*r.y+r.z*r.z),o=hp(a.x*a.x+a.y*a.y+a.z*a.z);r.x/=s,r.y/=s,r.z/=s,a.x/=o,a.y/=o,a.z/=o;const u={x:a.y*r.z-a.z*r.y,y:a.z*r.x-a.x*r.z,z:a.x*r.y-a.y*r.x},f=hp(u.x*u.x+u.y*u.y+u.z*u.z);u.x/=f,u.y/=f,u.z/=f;const v=[u.x*u.x,u.x*u.y-u.z,u.x*u.z+u.y,u.x*u.y+u.z,u.y*u.y,u.y*u.z-u.x,u.x*u.z-u.y,u.y*u.z+u.x,u.z*u.z];return{x:v[0]*r.x+v[1]*r.y+v[2]*r.z,y:v[3]*r.x+v[4]*r.y+v[5]*r.z,z:v[6]*r.x+v[7]*r.y+v[8]*r.z}}hull(n){let r=this.points,a=[],s=[],o=0;for(s[o++]=r[0],s[o++]=r[1],s[o++]=r[2],this.order===3&&(s[o++]=r[3]);r.length>1;){a=[];for(let u=0,f,v=r.length-1;u<v;u++)f=nn.lerp(n,r[u],r[u+1]),s[o++]=f,a.push(f);r=a}return s}split(n,r){if(n===0&&!!r)return this.split(r).left;if(r===1)return this.split(n).right;const a=this.hull(n),s={left:this.order===2?new Ci([a[0],a[3],a[5]]):new Ci([a[0],a[4],a[7],a[9]]),right:this.order===2?new Ci([a[5],a[4],a[2]]):new Ci([a[9],a[8],a[6],a[3]]),span:a};return s.left._t1=nn.map(0,0,1,this._t1,this._t2),s.left._t2=nn.map(n,0,1,this._t1,this._t2),s.right._t1=nn.map(n,0,1,this._t1,this._t2),s.right._t2=nn.map(1,0,1,this._t1,this._t2),r?(r=nn.map(r,n,1,0,1),s.right.split(r).left):s}extrema(){const n={};let r=[];return this.dims.forEach(function(a){let s=function(u){return u[a]},o=this.dpoints[0].map(s);n[a]=nn.droots(o),this.order===3&&(o=this.dpoints[1].map(s),n[a]=n[a].concat(nn.droots(o))),n[a]=n[a].filter(function(u){return u>=0&&u<=1}),r=r.concat(n[a].sort(nn.numberSort))}.bind(this)),n.values=r.sort(nn.numberSort).filter(function(a,s){return r.indexOf(a)===s}),n}bbox(){const n=this.extrema(),r={};return this.dims.forEach(function(a){r[a]=nn.getminmax(this,a,n[a])}.bind(this)),r}overlaps(n){const r=this.bbox(),a=n.bbox();return nn.bboxoverlap(r,a)}offset(n,r){if(typeof r!="undefined"){const a=this.get(n),s=this.normal(n),o={c:a,n:s,x:a.x+s.x*r,y:a.y+s.y*r};return this._3d&&(o.z=a.z+s.z*r),o}if(this._linear){const a=this.normal(0),s=this.points.map(function(o){const u={x:o.x+n*a.x,y:o.y+n*a.y};return o.z&&a.z&&(u.z=o.z+n*a.z),u});return[new Ci(s)]}return this.reduce().map(function(a){return a._linear?a.offset(n)[0]:a.scale(n)})}simple(){if(this.order===3){const s=nn.angle(this.points[0],this.points[3],this.points[1]),o=nn.angle(this.points[0],this.points[3],this.points[2]);if(s>0&&o<0||s<0&&o>0)return!1}const n=this.normal(0),r=this.normal(1);let a=n.x*r.x+n.y*r.y;return this._3d&&(a+=n.z*r.z),up(Nq(a))<Uq/3}reduce(){let n,r=0,a=0,s=.01,o,u=[],f=[],v=this.extrema().values;for(v.indexOf(0)===-1&&(v=[0].concat(v)),v.indexOf(1)===-1&&v.push(1),r=v[0],n=1;n<v.length;n++)a=v[n],o=this.split(r,a),o._t1=r,o._t2=a,u.push(o),r=a;return u.forEach(function(m){for(r=0,a=0;a<=1;)for(a=r+s;a<=1+s;a+=s)if(o=m.split(r,a),!o.simple()){if(a-=s,up(r-a)<s)return[];o=m.split(r,a),o._t1=nn.map(r,0,1,m._t1,m._t2),o._t2=nn.map(a,0,1,m._t1,m._t2),f.push(o),r=a;break}r<1&&(o=m.split(r,1),o._t1=nn.map(r,0,1,m._t1,m._t2),o._t2=m._t2,f.push(o))}),f}scale(n){const r=this.order;let a=!1;if(typeof n=="function"&&(a=n),a&&r===2)return this.raise().scale(a);const s=this.clockwise,o=a?a(0):n,u=a?a(1):n,f=[this.offset(0,10),this.offset(1,10)],v=this.points,m=[],g=nn.lli4(f[0],f[0].c,f[1],f[1].c);if(!g)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach(function(y){const b=m[y*r]=nn.copy(v[y*r]);b.x+=(y?u:o)*f[y].n.x,b.y+=(y?u:o)*f[y].n.y}),a?([0,1].forEach(function(y){if(!(r===2&&!!y)){var b=v[y+1],w={x:b.x-g.x,y:b.y-g.y},A=a?a((y+1)/r):n;a&&!s&&(A=-A);var M=hp(w.x*w.x+w.y*w.y);w.x/=M,w.y/=M,m[y+1]={x:b.x+A*w.x,y:b.y+A*w.y}}}),new Ci(m)):([0,1].forEach(y=>{if(r===2&&!!y)return;const b=m[y*r],w=this.derivative(y),A={x:b.x+w.x,y:b.y+w.y};m[y+1]=nn.lli4(b,A,g,v[y+1])}),new Ci(m))}outline(n,r,a,s){r=typeof r=="undefined"?n:r;const o=this.reduce(),u=o.length,f=[];let v=[],m,g=0,y=this.length();const b=typeof a!="undefined"&&typeof s!="undefined";function w(P,N,F,X,Y){return function(ae){const $=X/F,de=(X+Y)/F,D=N-P;return nn.map(ae,0,1,P+$*D,P+de*D)}}o.forEach(function(P){const N=P.length();b?(f.push(P.scale(w(n,a,y,g,N))),v.push(P.scale(w(-r,-s,y,g,N)))):(f.push(P.scale(n)),v.push(P.scale(-r))),g+=N}),v=v.map(function(P){return m=P.points,m[3]?P.points=[m[3],m[2],m[1],m[0]]:P.points=[m[2],m[1],m[0]],P}).reverse();const A=f[0].points[0],M=f[u-1].points[f[u-1].points.length-1],S=v[u-1].points[v[u-1].points.length-1],E=v[0].points[0],T=nn.makeline(S,A),C=nn.makeline(M,E),L=[T].concat(f).concat([C]).concat(v);return L.length,new Jg(L)}outlineshapes(n,r,a){r=r||n;const s=this.outline(n,r).curves,o=[];for(let u=1,f=s.length;u<f/2;u++){const v=nn.makeshape(s[u],s[f-u],a);v.startcap.virtual=u>1,v.endcap.virtual=u<f/2-1,o.push(v)}return o}intersects(n,r){return n?n.p1&&n.p2?this.lineIntersects(n):(n instanceof Ci&&(n=n.reduce()),this.curveintersects(this.reduce(),n,r)):this.selfintersects(r)}lineIntersects(n){const r=u3(n.p1.x,n.p2.x),a=u3(n.p1.y,n.p2.y),s=h3(n.p1.x,n.p2.x),o=h3(n.p1.y,n.p2.y);return nn.roots(this.points,n).filter(u=>{var f=this.get(u);return nn.between(f.x,r,s)&&nn.between(f.y,a,o)})}selfintersects(n){const r=this.reduce(),a=r.length-2,s=[];for(let o=0,u,f,v;o<a;o++)f=r.slice(o,o+1),v=r.slice(o+2),u=this.curveintersects(f,v,n),s.push(...u);return s}curveintersects(n,r,a){const s=[];n.forEach(function(u){r.forEach(function(f){u.overlaps(f)&&s.push({left:u,right:f})})});let o=[];return s.forEach(function(u){const f=nn.pairiteration(u.left,u.right,a);f.length>0&&(o=o.concat(f))}),o}arcs(n){return n=n||.5,this._iterate(n,[])}_error(n,r,a,s){const o=(s-a)/4,u=this.get(a+o),f=this.get(s-o),v=nn.dist(n,r),m=nn.dist(n,u),g=nn.dist(n,f);return up(m-v)+up(g-v)}_iterate(n,r){let a=0,s=1,o;do{o=0,s=1;let u=this.get(a),f,v,m,g,y=!1,b=!1,w,A=s,M=1;do if(b=y,g=m,A=(a+s)/2,f=this.get(A),v=this.get(s),m=nn.getccenter(u,f,v),m.interval={start:a,end:s},y=this._error(m,u,a,s)<=n,w=b&&!y,w||(M=s),y){if(s>=1){if(m.interval.end=M=1,g=m,s>1){let E={x:m.x+m.r*Fq(m.e),y:m.y+m.r*Bq(m.e)};m.e+=nn.angle({x:m.x,y:m.y},E,this.get(1))}break}s=s+(s-a)/2}else s=A;while(!w&&o++<100);if(o>=100)break;g=g||m,r.push(g),a=M}while(s<1);return r}}function Hq(i,n){if(i==null)return{};var r={},a=Object.keys(i),s,o;for(o=0;o<a.length;o++)s=a[o],!(n.indexOf(s)>=0)&&(r[s]=i[s]);return r}function zq(i,n){if(i==null)return{};var r=Hq(i,n),a,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(i);for(s=0;s<o.length;s++)a=o[s],!(n.indexOf(a)>=0)&&(!Object.prototype.propertyIsEnumerable.call(i,a)||(r[a]=i[a]))}return r}function Gq(i,n){return jq(i)||qq(i,n)||f3(i,n)||$q()}function Vq(i){return Wq(i)||Xq(i)||f3(i)||Yq()}function Wq(i){if(Array.isArray(i))return Y1(i)}function jq(i){if(Array.isArray(i))return i}function Xq(i){if(typeof Symbol!="undefined"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function qq(i,n){var r=i&&(typeof Symbol!="undefined"&&i[Symbol.iterator]||i["@@iterator"]);if(r!=null){var a=[],s=!0,o=!1,u,f;try{for(r=r.call(i);!(s=(u=r.next()).done)&&(a.push(u.value),!(n&&a.length===n));s=!0);}catch(v){o=!0,f=v}finally{try{!s&&r.return!=null&&r.return()}finally{if(o)throw f}}return a}}function f3(i,n){if(!!i){if(typeof i=="string")return Y1(i,n);var r=Object.prototype.toString.call(i).slice(8,-1);if(r==="Object"&&i.constructor&&(r=i.constructor.name),r==="Map"||r==="Set")return Array.from(i);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Y1(i,n)}}function Y1(i,n){(n==null||n>i.length)&&(n=i.length);for(var r=0,a=new Array(n);r<n;r++)a[r]=i[r];return a}function Yq(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $q(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kq(i,n){if(typeof i!="object"||i===null)return i;var r=i[Symbol.toPrimitive];if(r!==void 0){var a=r.call(i,n||"default");if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(i)}function Zq(i){var n=Kq(i,"string");return typeof n=="symbol"?n:String(n)}var $1=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=(n instanceof Array?n.length?n:[void 0]:[n]).map(function(f){return{keyAccessor:f,isProp:!(f instanceof Function)}}),o=i.reduce(function(f,v){var m=f,g=v;return s.forEach(function(y,b){var w=y.keyAccessor,A=y.isProp,M;if(A){var S=g,E=S[w],T=zq(S,[w].map(Zq));M=E,g=T}else M=w(g,b);b+1<s.length?(m.hasOwnProperty(M)||(m[M]={}),m=m[M]):r?(m.hasOwnProperty(M)||(m[M]=[]),m[M].push(g)):m[M]=g}),f},{});r instanceof Function&&function f(v){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;m===s.length?Object.keys(v).forEach(function(g){return v[g]=r(v[g])}):Object.values(v).forEach(function(g){return f(g,m+1)})}(o);var u=o;return a&&(u=[],function f(v){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];m.length===s.length?u.push({keys:m,vals:v}):Object.entries(v).forEach(function(g){var y=Gq(g,2),b=y[0],w=y[1];return f(w,[].concat(Vq(m),[b]))})}(o),n instanceof Array&&n.length===0&&u.length===1&&(u[0].keys=[])),u};function Qq(i,n){switch(arguments.length){case 0:break;case 1:this.range(i);break;default:this.range(n).domain(i);break}return this}const d3=Symbol("implicit");function K1(){var i=new DC,n=[],r=[],a=d3;function s(o){let u=i.get(o);if(u===void 0){if(a!==d3)return a;i.set(o,u=n.push(o)-1)}return r[u%r.length]}return s.domain=function(o){if(!arguments.length)return n.slice();n=[],i=new DC;for(const u of o)i.has(u)||i.set(u,n.push(u)-1);return s},s.range=function(o){return arguments.length?(r=Array.from(o),s):r.slice()},s.unknown=function(o){return arguments.length?(a=o,s):a},s.copy=function(){return K1(n,r).unknown(a)},Qq.apply(s,arguments),s}function Jq(i){for(var n=i.length/6|0,r=new Array(n),a=0;a<n;)r[a]="#"+i.slice(a*6,++a*6);return r}var p3=Jq("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928");function eY(i,n){n===void 0&&(n={});var r=n.insertAt;if(!(!i||typeof document=="undefined")){var a=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",r==="top"&&a.firstChild?a.insertBefore(s,a.firstChild):a.appendChild(s),s.styleSheet?s.styleSheet.cssText=i:s.appendChild(document.createTextNode(i))}}var tY=`.force-graph-container canvas {
  display: block;
  user-select: none;
  outline: none;
  -webkit-tap-highlight-color: transparent;
}

.force-graph-container .graph-tooltip {
  position: absolute;
  transform: translate(-50%, 25px);
  font-family: sans-serif;
  font-size: 16px;
  padding: 4px;
  border-radius: 3px;
  color: #eee;
  background: rgba(0,0,0,0.65);
  visibility: hidden; /* by default */
}

.force-graph-container .clickable {
  cursor: pointer;
}

.force-graph-container .grabbable {
  cursor: move;
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

.force-graph-container .grabbable:active {
  cursor: grabbing;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
}
`;eY(tY);function m3(i,n){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);n&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(i,s).enumerable})),r.push.apply(r,a)}return r}function qh(i){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?m3(Object(r),!0).forEach(function(a){fp(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):m3(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}function e0(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?e0=function(n){return typeof n}:e0=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},e0(i)}function fp(i,n,r){return n in i?Object.defineProperty(i,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):i[n]=r,i}function Z1(i,n){return Z1=Object.setPrototypeOf||function(a,s){return a.__proto__=s,a},Z1(i,n)}function nY(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dp(i,n,r){return nY()?dp=Reflect.construct:dp=function(s,o,u){var f=[null];f.push.apply(f,o);var v=Function.bind.apply(s,f),m=new v;return u&&Z1(m,u.prototype),m},dp.apply(null,arguments)}function pp(i,n){return iY(i)||oY(i,n)||v3(i,n)||lY()}function mo(i){return rY(i)||aY(i)||v3(i)||sY()}function rY(i){if(Array.isArray(i))return Q1(i)}function iY(i){if(Array.isArray(i))return i}function aY(i){if(typeof Symbol!="undefined"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function oY(i,n){var r=i==null?null:typeof Symbol!="undefined"&&i[Symbol.iterator]||i["@@iterator"];if(r!=null){var a=[],s=!0,o=!1,u,f;try{for(r=r.call(i);!(s=(u=r.next()).done)&&(a.push(u.value),!(n&&a.length===n));s=!0);}catch(v){o=!0,f=v}finally{try{!s&&r.return!=null&&r.return()}finally{if(o)throw f}}return a}}function v3(i,n){if(!!i){if(typeof i=="string")return Q1(i,n);var r=Object.prototype.toString.call(i).slice(8,-1);if(r==="Object"&&i.constructor&&(r=i.constructor.name),r==="Map"||r==="Set")return Array.from(i);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Q1(i,n)}}function Q1(i,n){(n==null||n>i.length)&&(n=i.length);for(var r=0,a=new Array(n);r<n;r++)a[r]=i[r];return a}function sY(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lY(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var cY=K1(p3);function g3(i,n,r){!n||typeof r!="string"||i.filter(function(a){return!a[r]}).forEach(function(a){a[r]=cY(n(a))})}function uY(i,n){var r=i.nodes,a=i.links,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=s.nodeFilter,u=o===void 0?function(){return!0}:o,f=s.onLoopError,v=f===void 0?function(w){throw"Invalid DAG structure! Found cycle in node path: ".concat(w.join(" -> "),".")}:f,m={};r.forEach(function(w){return m[n(w)]={data:w,out:[],depth:-1,skip:!u(w)}}),a.forEach(function(w){var A=w.source,M=w.target,S=L(A),E=L(M);if(!m.hasOwnProperty(S))throw"Missing source node with id: ".concat(S);if(!m.hasOwnProperty(E))throw"Missing target node with id: ".concat(E);var T=m[S],C=m[E];T.out.push(C);function L(P){return e0(P)==="object"?n(P):P}});var g=[];b(Object.values(m));var y=Object.assign.apply(Object,[{}].concat(mo(Object.entries(m).filter(function(w){var A=pp(w,2),M=A[1];return!M.skip}).map(function(w){var A=pp(w,2),M=A[0],S=A[1];return fp({},M,S.depth)}))));return y;function b(w){for(var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,S=0,E=w.length;S<E;S++){var T=w[S];if(A.indexOf(T)!==-1){var C=function(){var L=[].concat(mo(A.slice(A.indexOf(T))),[T]).map(function(P){return n(P.data)});return g.some(function(P){return P.length===L.length&&P.every(function(N,F){return N===L[F]})})||(g.push(L),v(L)),"continue"}();if(C==="continue")continue}M>T.depth&&(T.depth=M,b(T.out,[].concat(mo(A),[T]),M+(T.skip?0:1)))}}}var hY=2,ga=function(n,r){return r.onNeedsRedraw&&r.onNeedsRedraw()},t0=Zc({props:{graphData:{default:{nodes:[],links:[]},onChange:function(n,r){r.engineRunning=!1}},dagMode:{onChange:function(n,r){!n&&(r.graphData.nodes||[]).forEach(function(a){return a.fx=a.fy=void 0})}},dagLevelDistance:{},dagNodeFilter:{default:function(n){return!0}},onDagError:{triggerUpdate:!1},nodeRelSize:{default:4,triggerUpdate:!1,onChange:ga},nodeId:{default:"id"},nodeVal:{default:"val",triggerUpdate:!1,onChange:ga},nodeColor:{default:"color",triggerUpdate:!1,onChange:ga},nodeAutoColorBy:{},nodeCanvasObject:{triggerUpdate:!1,onChange:ga},nodeCanvasObjectMode:{default:function(){return"replace"},triggerUpdate:!1,onChange:ga},nodeVisibility:{default:!0,triggerUpdate:!1,onChange:ga},linkSource:{default:"source"},linkTarget:{default:"target"},linkVisibility:{default:!0,triggerUpdate:!1,onChange:ga},linkColor:{default:"color",triggerUpdate:!1,onChange:ga},linkAutoColorBy:{},linkLineDash:{triggerUpdate:!1,onChange:ga},linkWidth:{default:1,triggerUpdate:!1,onChange:ga},linkCurvature:{default:0,triggerUpdate:!1,onChange:ga},linkCanvasObject:{triggerUpdate:!1,onChange:ga},linkCanvasObjectMode:{default:function(){return"replace"},triggerUpdate:!1,onChange:ga},linkDirectionalArrowLength:{default:0,triggerUpdate:!1,onChange:ga},linkDirectionalArrowColor:{triggerUpdate:!1,onChange:ga},linkDirectionalArrowRelPos:{default:.5,triggerUpdate:!1,onChange:ga},linkDirectionalParticles:{default:0},linkDirectionalParticleSpeed:{default:.01,triggerUpdate:!1},linkDirectionalParticleWidth:{default:4,triggerUpdate:!1},linkDirectionalParticleColor:{triggerUpdate:!1},globalScale:{default:1,triggerUpdate:!1},d3AlphaMin:{default:0,triggerUpdate:!1},d3AlphaDecay:{default:.0228,triggerUpdate:!1,onChange:function(n,r){r.forceLayout.alphaDecay(n)}},d3AlphaTarget:{default:0,triggerUpdate:!1,onChange:function(n,r){r.forceLayout.alphaTarget(n)}},d3VelocityDecay:{default:.4,triggerUpdate:!1,onChange:function(n,r){r.forceLayout.velocityDecay(n)}},warmupTicks:{default:0,triggerUpdate:!1},cooldownTicks:{default:1/0,triggerUpdate:!1},cooldownTime:{default:15e3,triggerUpdate:!1},onUpdate:{default:function(){},triggerUpdate:!1},onFinishUpdate:{default:function(){},triggerUpdate:!1},onEngineTick:{default:function(){},triggerUpdate:!1},onEngineStop:{default:function(){},triggerUpdate:!1},onNeedsRedraw:{triggerUpdate:!1},isShadow:{default:!1,triggerUpdate:!1}},methods:{d3Force:function(n,r,a){return a===void 0?n.forceLayout.force(r):(n.forceLayout.force(r,a),this)},d3ReheatSimulation:function(n){return n.forceLayout.alpha(1),this.resetCountdown(),this},resetCountdown:function(n){return n.cntTicks=0,n.startTickTime=new Date,n.engineRunning=!0,this},isEngineRunning:function(n){return!!n.engineRunning},tickFrame:function(n){return!n.isShadow&&r(),s(),!n.isShadow&&o(),!n.isShadow&&u(),a(),this;function r(){n.engineRunning&&(++n.cntTicks>n.cooldownTicks||new Date-n.startTickTime>n.cooldownTime||n.d3AlphaMin>0&&n.forceLayout.alpha()<n.d3AlphaMin?(n.engineRunning=!1,n.onEngineStop()):(n.forceLayout.tick(),n.onEngineTick()))}function a(){var f=Ln(n.nodeVisibility),v=Ln(n.nodeVal),m=Ln(n.nodeColor),g=Ln(n.nodeCanvasObjectMode),y=n.ctx,b=n.isShadow/n.globalScale,w=n.graphData.nodes.filter(f);y.save(),w.forEach(function(A){var M=g(A);if(n.nodeCanvasObject&&(M==="before"||M==="replace")&&(n.nodeCanvasObject(A,y,n.globalScale),M==="replace")){y.restore();return}var S=Math.sqrt(Math.max(0,v(A)||1))*n.nodeRelSize+b;y.beginPath(),y.arc(A.x,A.y,S,0,2*Math.PI,!1),y.fillStyle=m(A)||"rgba(31, 120, 180, 0.92)",y.fill(),n.nodeCanvasObject&&M==="after"&&n.nodeCanvasObject(A,n.ctx,n.globalScale)}),y.restore()}function s(){var f=Ln(n.linkVisibility),v=Ln(n.linkColor),m=Ln(n.linkWidth),g=Ln(n.linkLineDash),y=Ln(n.linkCurvature),b=Ln(n.linkCanvasObjectMode),w=n.ctx,A=n.isShadow*2,M=n.graphData.links.filter(f);M.forEach(N);var S=[],E=[],T=M;if(n.linkCanvasObject){var C=[],L=[];M.forEach(function(F){return({before:S,after:E,replace:C}[b(F)]||L).push(F)}),T=[].concat(mo(S),E,L),S=S.concat(C)}w.save(),S.forEach(function(F){return n.linkCanvasObject(F,w,n.globalScale)}),w.restore();var P=$1(T,[v,m,g]);w.save(),Object.entries(P).forEach(function(F){var X=pp(F,2),Y=X[0],ae=X[1],$=!Y||Y==="undefined"?"rgba(0,0,0,0.15)":Y;Object.entries(ae).forEach(function(de){var D=pp(de,2),I=D[0],k=D[1],U=(I||1)/n.globalScale+A;Object.entries(k).forEach(function(W){var ce=pp(W,2);ce[0];var oe=ce[1],ge=g(oe[0]);w.beginPath(),oe.forEach(function(_e){var Ne=_e.source,Ie=_e.target;if(!(!Ne||!Ie||!Ne.hasOwnProperty("x")||!Ie.hasOwnProperty("x"))){w.moveTo(Ne.x,Ne.y);var Ve=_e.__controlPoints;Ve?w[Ve.length===2?"quadraticCurveTo":"bezierCurveTo"].apply(w,mo(Ve).concat([Ie.x,Ie.y])):w.lineTo(Ie.x,Ie.y)}}),w.strokeStyle=$,w.lineWidth=U,w.setLineDash(ge||[]),w.stroke()})})}),w.restore(),w.save(),E.forEach(function(F){return n.linkCanvasObject(F,w,n.globalScale)}),w.restore();function N(F){var X=y(F);if(!X){F.__controlPoints=null;return}var Y=F.source,ae=F.target;if(!(!Y||!ae||!Y.hasOwnProperty("x")||!ae.hasOwnProperty("x"))){var $=Math.sqrt(Math.pow(ae.x-Y.x,2)+Math.pow(ae.y-Y.y,2));if($>0){var de=Math.atan2(ae.y-Y.y,ae.x-Y.x),D=$*X,I={x:(Y.x+ae.x)/2+D*Math.cos(de-Math.PI/2),y:(Y.y+ae.y)/2+D*Math.sin(de-Math.PI/2)};F.__controlPoints=[I.x,I.y]}else{var k=X*70;F.__controlPoints=[ae.x,ae.y-k,ae.x+k,ae.y]}}}}function o(){var f=1.6,v=.2,m=Ln(n.linkDirectionalArrowLength),g=Ln(n.linkDirectionalArrowRelPos),y=Ln(n.linkVisibility),b=Ln(n.linkDirectionalArrowColor||n.linkColor),w=Ln(n.nodeVal),A=n.ctx;A.save(),n.graphData.links.filter(y).forEach(function(M){var S=m(M);if(!(!S||S<0)){var E=M.source,T=M.target;if(!(!E||!T||!E.hasOwnProperty("x")||!T.hasOwnProperty("x"))){var C=Math.sqrt(Math.max(0,w(E)||1))*n.nodeRelSize,L=Math.sqrt(Math.max(0,w(T)||1))*n.nodeRelSize,P=Math.min(1,Math.max(0,g(M))),N=b(M)||"rgba(0,0,0,0.28)",F=S/f/2,X=M.__controlPoints&&dp(Ci,[E.x,E.y].concat(mo(M.__controlPoints),[T.x,T.y])),Y=X?function(U){return X.get(U)}:function(U){return{x:E.x+(T.x-E.x)*U||0,y:E.y+(T.y-E.y)*U||0}},ae=X?X.length():Math.sqrt(Math.pow(T.x-E.x,2)+Math.pow(T.y-E.y,2)),$=C+S+(ae-C-L-S)*P,de=Y($/ae),D=Y(($-S)/ae),I=Y(($-S*(1-v))/ae),k=Math.atan2(de.y-D.y,de.x-D.x)-Math.PI/2;A.beginPath(),A.moveTo(de.x,de.y),A.lineTo(D.x+F*Math.cos(k),D.y+F*Math.sin(k)),A.lineTo(I.x,I.y),A.lineTo(D.x-F*Math.cos(k),D.y-F*Math.sin(k)),A.fillStyle=N,A.fill()}}}),A.restore()}function u(){var f=Ln(n.linkDirectionalParticles),v=Ln(n.linkDirectionalParticleSpeed),m=Ln(n.linkDirectionalParticleWidth),g=Ln(n.linkVisibility),y=Ln(n.linkDirectionalParticleColor||n.linkColor),b=n.ctx;b.save(),n.graphData.links.filter(g).forEach(function(w){var A=f(w);if(!(!w.hasOwnProperty("__photons")||!w.__photons.length)){var M=w.source,S=w.target;if(!(!M||!S||!M.hasOwnProperty("x")||!S.hasOwnProperty("x"))){var E=v(w),T=w.__photons||[],C=Math.max(0,m(w)/2)/Math.sqrt(n.globalScale),L=y(w)||"rgba(0,0,0,0.28)";b.fillStyle=L;var P=w.__controlPoints?dp(Ci,[M.x,M.y].concat(mo(w.__controlPoints),[S.x,S.y])):null,N=0,F=!1;T.forEach(function(X){var Y=!!X.__singleHop;if(X.hasOwnProperty("__progressRatio")||(X.__progressRatio=Y?0:N/A),!Y&&N++,X.__progressRatio+=E,X.__progressRatio>=1)if(!Y)X.__progressRatio=X.__progressRatio%1;else{F=!0;return}var ae=X.__progressRatio,$=P?P.get(ae):{x:M.x+(S.x-M.x)*ae||0,y:M.y+(S.y-M.y)*ae||0};b.beginPath(),b.arc($.x,$.y,C,0,2*Math.PI,!1),b.fill()}),F&&(w.__photons=w.__photons.filter(function(X){return!X.__singleHop||X.__progressRatio<=1}))}}}),b.restore()}},emitParticle:function(n,r){return r&&(!r.__photons&&(r.__photons=[]),r.__photons.push({__singleHop:!0})),this}},stateInit:function(){return{forceLayout:o3().force("link",n3()).force("charge",s3()).force("center",jC()).force("dagRadial",null).stop(),engineRunning:!1}},init:function(n,r){r.ctx=n},update:function(n){if(n.engineRunning=!1,n.onUpdate(),n.nodeAutoColorBy!==null&&g3(n.graphData.nodes,Ln(n.nodeAutoColorBy),n.nodeColor),n.linkAutoColorBy!==null&&g3(n.graphData.links,Ln(n.linkAutoColorBy),n.linkColor),n.graphData.links.forEach(function(y){y.source=y[n.linkSource],y.target=y[n.linkTarget]}),!n.isShadow){var r=Ln(n.linkDirectionalParticles);n.graphData.links.forEach(function(y){var b=Math.round(Math.abs(r(y)));b?y.__photons=mo(Array(b)).map(function(){return{}}):delete y.__photons})}n.forceLayout.stop().alpha(1).nodes(n.graphData.nodes);var a=n.forceLayout.force("link");a&&a.id(function(y){return y[n.nodeId]}).links(n.graphData.links);var s=n.dagMode&&uY(n.graphData,function(y){return y[n.nodeId]},{nodeFilter:n.dagNodeFilter,onLoopError:n.onDagError||void 0}),o=Math.max.apply(Math,mo(Object.values(s||[]))),u=n.dagLevelDistance||n.graphData.nodes.length/(o||1)*hY*(["radialin","radialout"].indexOf(n.dagMode)!==-1?.7:1);if(n.dagMode){var f=function(b,w){return function(A){return b?(s[A[n.nodeId]]-o/2)*u*(w?-1:1):void 0}},v=f(["lr","rl"].indexOf(n.dagMode)!==-1,n.dagMode==="rl"),m=f(["td","bu"].indexOf(n.dagMode)!==-1,n.dagMode==="bu");n.graphData.nodes.filter(n.dagNodeFilter).forEach(function(y){y.fx=v(y),y.fy=m(y)})}n.forceLayout.force("dagRadial",["radialin","radialout"].indexOf(n.dagMode)!==-1?l3(function(y){var b=s[y[n.nodeId]]||-1;return(n.dagMode==="radialin"?o-b:b)*u}).strength(function(y){return n.dagNodeFilter(y)?1:0}):null);for(var g=0;g<n.warmupTicks&&!(n.d3AlphaMin>0&&n.forceLayout.alpha()<n.d3AlphaMin);g++)n.forceLayout.tick();this.resetCountdown(),n.onFinishUpdate()}});function y3(i,n){var r=i instanceof Array?i:[i],a=new n;return{linkProp:function(o){return{default:a[o](),onChange:function(f,v){r.forEach(function(m){return v[m][o](f)})},triggerUpdate:!1}},linkMethod:function(o){return function(u){for(var f=arguments.length,v=new Array(f>1?f-1:0),m=1;m<f;m++)v[m-1]=arguments[m];var g=[];return r.forEach(function(y){var b=u[y],w=b[o].apply(b,v);w!==b&&g.push(w)}),g.length?g[0]:this}}}}var fY=800,dY=4,b3=y3("forceGraph",t0),pY=y3(["forceGraph","shadowGraph"],t0),mY=Object.assign.apply(Object,mo(["nodeColor","nodeAutoColorBy","nodeCanvasObject","nodeCanvasObjectMode","linkColor","linkAutoColorBy","linkLineDash","linkWidth","linkCanvasObject","linkCanvasObjectMode","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","dagMode","dagLevelDistance","dagNodeFilter","onDagError","d3AlphaMin","d3AlphaDecay","d3VelocityDecay","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"].map(function(i){return fp({},i,b3.linkProp(i))})).concat(mo(["nodeRelSize","nodeId","nodeVal","nodeVisibility","linkSource","linkTarget","linkVisibility","linkCurvature"].map(function(i){return fp({},i,pY.linkProp(i))})))),vY=Object.assign.apply(Object,mo(["d3Force","d3ReheatSimulation","emitParticle"].map(function(i){return fp({},i,b3.linkMethod(i))})));function J1(i){if(i.canvas){var n=i.canvas.width,r=i.canvas.height;n===300&&r===150&&(n=r=0);var a=window.devicePixelRatio;n/=a,r/=a,[i.canvas,i.shadowCanvas].forEach(function(o){o.style.width="".concat(i.width,"px"),o.style.height="".concat(i.height,"px"),o.width=i.width*a,o.height=i.height*a,!n&&!r&&o.getContext("2d").scale(a,a)});var s=ds(i.canvas).k;i.zoom.translateBy(i.zoom.__baseElem,(i.width-n)/2/s,(i.height-r)/2/s),i.needsRedraw=!0}}function x3(i){var n=window.devicePixelRatio;i.setTransform(n,0,0,n,0,0)}function w3(i,n,r){i.save(),x3(i),i.clearRect(0,0,n,r),i.restore()}var gY=Zc({props:qh({width:{default:window.innerWidth,onChange:function(n,r){return J1(r)},triggerUpdate:!1},height:{default:window.innerHeight,onChange:function(n,r){return J1(r)},triggerUpdate:!1},graphData:{default:{nodes:[],links:[]},onChange:function(n,r){[{type:"Node",objs:n.nodes},{type:"Link",objs:n.links}].forEach(a),r.forceGraph.graphData(n),r.shadowGraph.graphData(n);function a(s){var o=s.type,u=s.objs;u.filter(function(f){if(!f.hasOwnProperty("__indexColor"))return!0;var v=r.colorTracker.lookup(f.__indexColor);return!v||!v.hasOwnProperty("d")||v.d!==f}).forEach(function(f){f.__indexColor=r.colorTracker.register({type:o,d:f})})}},triggerUpdate:!1},backgroundColor:{onChange:function(n,r){r.canvas&&n&&(r.canvas.style.background=n)},triggerUpdate:!1},nodeLabel:{default:"name",triggerUpdate:!1},nodePointerAreaPaint:{onChange:function(n,r){r.shadowGraph.nodeCanvasObject(n?function(a,s,o){return n(a,a.__indexColor,s,o)}:null),r.flushShadowCanvas&&r.flushShadowCanvas()},triggerUpdate:!1},linkPointerAreaPaint:{onChange:function(n,r){r.shadowGraph.linkCanvasObject(n?function(a,s,o){return n(a,a.__indexColor,s,o)}:null),r.flushShadowCanvas&&r.flushShadowCanvas()},triggerUpdate:!1},linkLabel:{default:"name",triggerUpdate:!1},linkHoverPrecision:{default:4,triggerUpdate:!1},minZoom:{default:.01,onChange:function(n,r){r.zoom.scaleExtent([n,r.zoom.scaleExtent()[1]])},triggerUpdate:!1},maxZoom:{default:1e3,onChange:function(n,r){r.zoom.scaleExtent([r.zoom.scaleExtent()[0],n])},triggerUpdate:!1},enableNodeDrag:{default:!0,triggerUpdate:!1},enableZoomInteraction:{default:!0,triggerUpdate:!1},enablePanInteraction:{default:!0,triggerUpdate:!1},enableZoomPanInteraction:{default:!0,triggerUpdate:!1},enablePointerInteraction:{default:!0,onChange:function(n,r){r.hoverObj=null},triggerUpdate:!1},autoPauseRedraw:{default:!0,triggerUpdate:!1},onNodeDrag:{default:function(){},triggerUpdate:!1},onNodeDragEnd:{default:function(){},triggerUpdate:!1},onNodeClick:{triggerUpdate:!1},onNodeRightClick:{triggerUpdate:!1},onNodeHover:{triggerUpdate:!1},onLinkClick:{triggerUpdate:!1},onLinkRightClick:{triggerUpdate:!1},onLinkHover:{triggerUpdate:!1},onBackgroundClick:{triggerUpdate:!1},onBackgroundRightClick:{triggerUpdate:!1},onZoom:{triggerUpdate:!1},onZoomEnd:{triggerUpdate:!1},onRenderFramePre:{triggerUpdate:!1},onRenderFramePost:{triggerUpdate:!1}},mY),aliases:{stopAnimation:"pauseAnimation"},methods:qh({graph2ScreenCoords:function(n,r,a){var s=ds(n.canvas);return{x:r*s.k+s.x,y:a*s.k+s.y}},screen2GraphCoords:function(n,r,a){var s=ds(n.canvas);return{x:(r-s.x)/s.k,y:(a-s.y)/s.k}},centerAt:function(n,r,a,s){if(!n.canvas)return null;if(r!==void 0||a!==void 0){var o=Object.assign({},r!==void 0?{x:r}:{},a!==void 0?{y:a}:{});return s?new ms.Tween(u()).to(o,s).easing(ms.Easing.Quadratic.Out).onUpdate(f).start():f(o),this}return u();function u(){var v=ds(n.canvas);return{x:(n.width/2-v.x)/v.k,y:(n.height/2-v.y)/v.k}}function f(v){var m=v.x,g=v.y;n.zoom.translateTo(n.zoom.__baseElem,m===void 0?u().x:m,g===void 0?u().y:g),n.needsRedraw=!0}},zoom:function(n,r,a){if(!n.canvas)return null;if(r!==void 0)return a?new ms.Tween({k:s()}).to({k:r},a).easing(ms.Easing.Quadratic.Out).onUpdate(function(u){var f=u.k;return o(f)}).start():o(r),this;return s();function s(){return ds(n.canvas).k}function o(u){n.zoom.scaleTo(n.zoom.__baseElem,u),n.needsRedraw=!0}},zoomToFit:function(n){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,s=arguments.length,o=new Array(s>3?s-3:0),u=3;u<s;u++)o[u-3]=arguments[u];var f=this.getGraphBbox.apply(this,o);if(f){var v={x:(f.x[0]+f.x[1])/2,y:(f.y[0]+f.y[1])/2},m=Math.max(1e-12,Math.min(1e12,(n.width-a*2)/(f.x[1]-f.x[0]),(n.height-a*2)/(f.y[1]-f.y[0])));this.centerAt(v.x,v.y,r),this.zoom(m,r)}return this},getGraphBbox:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0},a=Ln(n.nodeVal),s=function(f){return Math.sqrt(Math.max(0,a(f)||1))*n.nodeRelSize},o=n.graphData.nodes.filter(r).map(function(u){return{x:u.x,y:u.y,r:s(u)}});return o.length?{x:[F1(o,function(u){return u.x-u.r}),k1(o,function(u){return u.x+u.r})],y:[F1(o,function(u){return u.y-u.r}),k1(o,function(u){return u.y+u.r})]}:null},pauseAnimation:function(n){return n.animationFrameRequestId&&(cancelAnimationFrame(n.animationFrameRequestId),n.animationFrameRequestId=null),this},resumeAnimation:function(n){return n.animationFrameRequestId||this._animationCycle(),this},_destructor:function(){this.pauseAnimation(),this.graphData({nodes:[],links:[]})}},vY),stateInit:function(){return{lastSetZoom:1,zoom:Fj(),forceGraph:new t0,shadowGraph:new t0().cooldownTicks(0).nodeColor("__indexColor").linkColor("__indexColor").isShadow(!0),colorTracker:new LX}},init:function(n,r){var a=this;n.innerHTML="";var s=document.createElement("div");s.classList.add("force-graph-container"),s.style.position="relative",n.appendChild(s),r.canvas=document.createElement("canvas"),r.backgroundColor&&(r.canvas.style.background=r.backgroundColor),s.appendChild(r.canvas),r.shadowCanvas=document.createElement("canvas");var o=r.canvas.getContext("2d"),u=r.shadowCanvas.getContext("2d"),f={x:-1e12,y:-1e12},v=function(){var b=null,w=window.devicePixelRatio,A=f.x>0&&f.y>0?u.getImageData(f.x*w,f.y*w,1,1):null;return A&&(b=r.colorTracker.lookup(A.data)),b};Fo(r.canvas).call(Y9().subject(function(){if(!r.enableNodeDrag)return null;var y=v();return y&&y.type==="Node"?y.d:null}).on("start",function(y){var b=y.subject;b.__initialDragPos={x:b.x,y:b.y,fx:b.fx,fy:b.fy},y.active||(b.fx=b.x,b.fy=b.y),r.canvas.classList.add("grabbable")}).on("drag",function(y){var b=y.subject,w=b.__initialDragPos,A=y,M=ds(r.canvas).k,S={x:w.x+(A.x-w.x)/M-b.x,y:w.y+(A.y-w.y)/M-b.y};["x","y"].forEach(function(E){return b["f".concat(E)]=b[E]=w[E]+(A[E]-w[E])/M}),r.forceGraph.d3AlphaTarget(.3).resetCountdown(),r.isPointerDragging=!0,b.__dragged=!0,r.onNodeDrag(b,S)}).on("end",function(y){var b=y.subject,w=b.__initialDragPos,A={x:b.x-w.x,y:b.y-w.y};w.fx===void 0&&(b.fx=void 0),w.fy===void 0&&(b.fy=void 0),delete b.__initialDragPos,r.forceGraph.d3AlphaTarget()&&r.forceGraph.d3AlphaTarget(0).resetCountdown(),r.canvas.classList.remove("grabbable"),r.isPointerDragging=!1,b.__dragged&&(delete b.__dragged,r.onNodeDragEnd(b,A))})),r.zoom(r.zoom.__baseElem=Fo(r.canvas)),r.zoom.__baseElem.on("dblclick.zoom",null),r.zoom.filter(function(y){return!y.button&&r.enableZoomPanInteraction&&(r.enableZoomInteraction||y.type!=="wheel")&&(r.enablePanInteraction||y.type==="wheel")}).on("zoom",function(y){var b=y.transform;[o,u].forEach(function(w){x3(w),w.translate(b.x,b.y),w.scale(b.k,b.k)}),r.onZoom&&r.onZoom(qh(qh({},b),a.centerAt())),r.needsRedraw=!0}).on("end",function(y){return r.onZoomEnd&&r.onZoomEnd(qh(qh({},y.transform),a.centerAt()))}),J1(r),r.forceGraph.onNeedsRedraw(function(){return r.needsRedraw=!0}).onFinishUpdate(function(){ds(r.canvas).k===r.lastSetZoom&&r.graphData.nodes.length&&(r.zoom.scaleTo(r.zoom.__baseElem,r.lastSetZoom=dY/Math.cbrt(r.graphData.nodes.length)),r.needsRedraw=!0)});var m=document.createElement("div");m.classList.add("graph-tooltip"),s.appendChild(m),["pointermove","pointerdown"].forEach(function(y){return s.addEventListener(y,function(b){y==="pointerdown"&&(r.isPointerPressed=!0,r.pointerDownEvent=b),!r.isPointerDragging&&b.type==="pointermove"&&r.onBackgroundClick&&(b.pressure>0||r.isPointerPressed)&&(b.pointerType!=="touch"||b.movementX===void 0||[b.movementX,b.movementY].some(function(M){return Math.abs(M)>1}))&&(r.isPointerDragging=!0);var w=A(s);f.x=b.pageX-w.left,f.y=b.pageY-w.top,m.style.top="".concat(f.y,"px"),m.style.left="".concat(f.x,"px");function A(M){var S=M.getBoundingClientRect(),E=window.pageXOffset||document.documentElement.scrollLeft,T=window.pageYOffset||document.documentElement.scrollTop;return{top:S.top+T,left:S.left+E}}},{passive:!0})}),s.addEventListener("pointerup",function(y){if(r.isPointerPressed=!1,r.isPointerDragging){r.isPointerDragging=!1;return}var b=[y,r.pointerDownEvent];requestAnimationFrame(function(){if(y.button===0)if(r.hoverObj){var w=r["on".concat(r.hoverObj.type,"Click")];w&&w.apply(void 0,[r.hoverObj.d].concat(b))}else r.onBackgroundClick&&r.onBackgroundClick.apply(r,b);if(y.button===2)if(r.hoverObj){var A=r["on".concat(r.hoverObj.type,"RightClick")];A&&A.apply(void 0,[r.hoverObj.d].concat(b))}else r.onBackgroundRightClick&&r.onBackgroundRightClick.apply(r,b)})},{passive:!0}),s.addEventListener("contextmenu",function(y){return!r.onBackgroundRightClick&&!r.onNodeRightClick&&!r.onLinkRightClick?!0:(y.preventDefault(),!1)}),r.forceGraph(o),r.shadowGraph(u);var g=rX(function(){w3(u,r.width,r.height),r.shadowGraph.linkWidth(function(b){return Ln(r.linkWidth)(b)+r.linkHoverPrecision});var y=ds(r.canvas);r.shadowGraph.globalScale(y.k).tickFrame()},fY);r.flushShadowCanvas=g.flush,(this._animationCycle=function y(){var b=!r.autoPauseRedraw||!!r.needsRedraw||r.forceGraph.isEngineRunning()||r.graphData.links.some(function(P){return P.__photons&&P.__photons.length});if(r.needsRedraw=!1,r.enablePointerInteraction){var w=r.isPointerDragging?null:v();if(w!==r.hoverObj){var A=r.hoverObj,M=A?A.type:null,S=w?w.type:null;if(M&&M!==S){var E=r["on".concat(M,"Hover")];E&&E(null,A.d)}if(S){var T=r["on".concat(S,"Hover")];T&&T(w.d,M===S?A.d:null)}var C=w&&Ln(r["".concat(w.type.toLowerCase(),"Label")])(w.d)||"";m.style.visibility=C?"visible":"hidden",m.innerHTML=C,r.canvas.classList[w&&r["on".concat(S,"Click")]||!w&&r.onBackgroundClick?"add":"remove"]("clickable"),r.hoverObj=w}b&&g()}if(b){w3(o,r.width,r.height);var L=ds(r.canvas).k;r.onRenderFramePre&&r.onRenderFramePre(o,L),r.forceGraph.globalScale(L).tickFrame(),r.onRenderFramePost&&r.onRenderFramePost(o,L)}ms.update(),r.animationFrameRequestId=requestAnimationFrame(y)})()},update:function(n){}});const yY={width:Number,height:Number,graphData:{type:Object,required:!0,validator(i){return i.nodes&&i.links}},backgroundColor:String,nodeRelSize:Number,nodeId:String,nodeLabel:[String,Function],nodeVal:[Number,String,Function],nodeVisibility:{type:[Boolean,String,Function],default:!0},nodeColor:[String,Function],nodeAutoColorBy:[String,Function],onNodeHover:Function,onNodeClick:Function,linkSource:String,linkTarget:String,linkLabel:[String,Function],linkVisibility:{type:[Boolean,String,Function],default:!0},linkColor:[String,Function],linkAutoColorBy:[String,Function],linkWidth:[Number,String,Function],linkCurvature:[Number,String,Function],linkDirectionalArrowLength:[Number,String,Function],linkDirectionalArrowColor:[String,Function],linkDirectionalArrowRelPos:[Number,String,Function],linkDirectionalParticles:[Number,String,Function],linkDirectionalParticleSpeed:[Number,String,Function],linkDirectionalParticleWidth:[Number,String,Function],linkDirectionalParticleColor:[String,Function],onLinkHover:Function,onLinkClick:Function,dagMode:{validator(i){return["td","bu","lr","rl","zin","zout","radialin","radialout"].includes(i)}},dagLevelDistance:Number,dagNodeFilter:Function,onDagError:Function,d3AlphaMin:Number,d3AlphaDecay:Number,d3VelocityDecay:Number,warmupTicks:Number,cooldownTicks:Number,cooldownTime:Number,onEngineTick:Function,onEngineStop:Function,getGraphBbox:Function,zoomToFit:Function,onNodeRightClick:Function,onNodeDrag:Function,onNodeDragEnd:Function,onLinkRightClick:Function,linkHoverPrecision:Number,onBackgroundClick:Function,onBackgroundRightClick:Function,enablePointerInteraction:{type:Boolean,default:!0},enableNodeDrag:{type:Boolean,default:!0},linkLineDash:{type:[Array,String,Function],validator(i){return Array.isArray(i)?i.every(n=>typeof n=="number"):typeof i=="string"||typeof i=="function"}},nodeCanvasObjectMode:[String,Function],nodeCanvasObject:Function,nodePointerAreaPaint:Function,linkCanvasObjectMode:[String,Function],linkCanvasObject:Function,linkPointerAreaPaint:Function,autoPauseRedraw:Boolean,minZoom:Number,maxZoom:Number,enableZoomInteraction:{type:Boolean,default:!0},enablePanInteraction:{type:Boolean,default:!0},onZoom:Function,onZoomEnd:Function,onRenderFramePre:Function,onRenderFramePost:Function};var A3=Og(gY,{methodNames:["emitParticle","d3Force","d3ReheatSimulation","stopAnimation","pauseAnimation","resumeAnimation","centerAt","zoom","zoomToFit","getGraphBbox","screen2GraphCoords","graph2ScreenCoords"],props:yY,name:"VueForceGraph2D"});A3.__file="packages/components/vue-force-graph-2d/src/vue-force-graph-2d.vue";const GZ=Xd(A3),Yh=new as,Qc=new O2,mp=new Wt,E3=new Ze,n0=new Ze,ew=new Ze,_3=new jn;class bY extends uo{constructor(n,r,a){super();a.style.touchAction="none";let s=null,o=null;const u=[],f=this;function v(){a.addEventListener("pointermove",b),a.addEventListener("pointerdown",w),a.addEventListener("pointerup",A),a.addEventListener("pointerleave",A)}function m(){a.removeEventListener("pointermove",b),a.removeEventListener("pointerdown",w),a.removeEventListener("pointerup",A),a.removeEventListener("pointerleave",A),a.style.cursor=""}function g(){m()}function y(){return n}function b(S){if(f.enabled!==!1){if(M(S),Qc.setFromCamera(mp,r),s){Qc.ray.intersectPlane(Yh,n0)&&s.position.copy(n0.sub(E3).applyMatrix4(_3)),f.dispatchEvent({type:"drag",object:s});return}if(S.pointerType==="mouse"||S.pointerType==="pen")if(u.length=0,Qc.setFromCamera(mp,r),Qc.intersectObjects(n,!0,u),u.length>0){const E=u[0].object;Yh.setFromNormalAndCoplanarPoint(r.getWorldDirection(Yh.normal),ew.setFromMatrixPosition(E.matrixWorld)),o!==E&&o!==null&&(f.dispatchEvent({type:"hoveroff",object:o}),a.style.cursor="auto",o=null),o!==E&&(f.dispatchEvent({type:"hoveron",object:E}),a.style.cursor="pointer",o=E)}else o!==null&&(f.dispatchEvent({type:"hoveroff",object:o}),a.style.cursor="auto",o=null)}}function w(S){f.enabled!==!1&&(M(S),u.length=0,Qc.setFromCamera(mp,r),Qc.intersectObjects(n,!0,u),u.length>0&&(s=f.transformGroup===!0?n[0]:u[0].object,Yh.setFromNormalAndCoplanarPoint(r.getWorldDirection(Yh.normal),ew.setFromMatrixPosition(s.matrixWorld)),Qc.ray.intersectPlane(Yh,n0)&&(_3.copy(s.parent.matrixWorld).invert(),E3.copy(n0).sub(ew.setFromMatrixPosition(s.matrixWorld))),a.style.cursor="move",f.dispatchEvent({type:"dragstart",object:s})))}function A(){f.enabled!==!1&&(s&&(f.dispatchEvent({type:"dragend",object:s}),s=null),a.style.cursor=o?"pointer":"auto")}function M(S){const E=a.getBoundingClientRect();mp.x=(S.clientX-E.left)/E.width*2-1,mp.y=-(S.clientY-E.top)/E.height*2+1}v(),this.enabled=!0,this.transformGroup=!1,this.activate=v,this.deactivate=m,this.dispose=g,this.getObjects=y}}var tw=function(n){wY(n);var r=xY(n);return n.on=r.on,n.off=r.off,n.fire=r.fire,n};function xY(i){var n=Object.create(null);return{on:function(r,a,s){if(typeof a!="function")throw new Error("callback is expected to be a function");var o=n[r];return o||(o=n[r]=[]),o.push({callback:a,ctx:s}),i},off:function(r,a){var s=typeof r=="undefined";if(s)return n=Object.create(null),i;if(n[r]){var o=typeof a!="function";if(o)delete n[r];else for(var u=n[r],f=0;f<u.length;++f)u[f].callback===a&&u.splice(f,1)}return i},fire:function(r){var a=n[r];if(!a)return i;var s;arguments.length>1&&(s=Array.prototype.splice.call(arguments,1));for(var o=0;o<a.length;++o){var u=a[o];u.callback.apply(u.ctx,s)}return i}}}function wY(i){if(!i)throw new Error("Eventify cannot use falsy object as events subject");for(var n=["on","fire","off"],r=0;r<n.length;++r)if(i.hasOwnProperty(n[r]))throw new Error("Subject cannot be eventified, since it already has property '"+n[r]+"'")}var AY=_Y,EY=tw;function _Y(i){if(i=i||{},"uniqueLinkId"in i&&(console.warn("ngraph.graph: Starting from version 0.14 `uniqueLinkId` is deprecated.\nUse `multigraph` option instead\n",`
`,`Note: there is also change in default behavior: From now on each graph
is considered to be not a multigraph by default (each edge is unique).`),i.multigraph=i.uniqueLinkId),i.multigraph===void 0&&(i.multigraph=!1),typeof Map!="function")throw new Error("ngraph.graph requires `Map` to be defined. Please polyfill it before using ngraph");var n=new Map,r=[],a={},s=0,o=i.multigraph?L:C,u=[],f=k,v=k,m=k,g=k,y={addNode:M,addLink:T,removeLink:X,removeNode:E,getNode:S,getNodeCount:P,getLinkCount:N,getLinksCount:N,getNodesCount:P,getLinks:F,forEachNode:ce,forEachLinkedNode:de,forEachLink:$,beginUpdate:m,endUpdate:g,clear:ae,hasLink:Y,hasNode:S,getLink:Y};return EY(y),b(),y;function b(){var oe=y.on;y.on=ge;function ge(){return y.beginUpdate=m=U,y.endUpdate=g=W,f=w,v=A,y.on=oe,oe.apply(y,arguments)}}function w(oe,ge){u.push({link:oe,changeType:ge})}function A(oe,ge){u.push({node:oe,changeType:ge})}function M(oe,ge){if(oe===void 0)throw new Error("Invalid node identifier");m();var _e=S(oe);return _e?(_e.data=ge,v(_e,"update")):(_e=new MY(oe,ge),v(_e,"add")),n.set(oe,_e),g(),_e}function S(oe){return n.get(oe)}function E(oe){var ge=S(oe);if(!ge)return!1;m();var _e=ge.links;if(_e){ge.links=null;for(var Ne=0;Ne<_e.length;++Ne)X(_e[Ne])}return n.delete(oe),v(ge,"remove"),g(),!0}function T(oe,ge,_e){m();var Ne=S(oe)||M(oe),Ie=S(ge)||M(ge),Ve=o(oe,ge,_e);return r.push(Ve),M3(Ne,Ve),oe!==ge&&M3(Ie,Ve),f(Ve,"add"),g(),Ve}function C(oe,ge,_e){var Ne=rw(oe,ge);return new S3(oe,ge,_e,Ne)}function L(oe,ge,_e){var Ne=rw(oe,ge),Ie=a.hasOwnProperty(Ne);if(Ie||Y(oe,ge)){Ie||(a[Ne]=0);var Ve="@"+ ++a[Ne];Ne=rw(oe+Ve,ge+Ve)}return new S3(oe,ge,_e,Ne)}function P(){return n.size}function N(){return r.length}function F(oe){var ge=S(oe);return ge?ge.links:null}function X(oe){if(!oe)return!1;var ge=nw(oe,r);if(ge<0)return!1;m(),r.splice(ge,1);var _e=S(oe.fromId),Ne=S(oe.toId);return _e&&(ge=nw(oe,_e.links),ge>=0&&_e.links.splice(ge,1)),Ne&&(ge=nw(oe,Ne.links),ge>=0&&Ne.links.splice(ge,1)),f(oe,"remove"),g(),!0}function Y(oe,ge){var _e=S(oe),Ne;if(!_e||!_e.links)return null;for(Ne=0;Ne<_e.links.length;++Ne){var Ie=_e.links[Ne];if(Ie.fromId===oe&&Ie.toId===ge)return Ie}return null}function ae(){m(),ce(function(oe){E(oe.id)}),g()}function $(oe){var ge,_e;if(typeof oe=="function")for(ge=0,_e=r.length;ge<_e;++ge)oe(r[ge])}function de(oe,ge,_e){var Ne=S(oe);if(Ne&&Ne.links&&typeof ge=="function")return _e?I(Ne.links,oe,ge):D(Ne.links,oe,ge)}function D(oe,ge,_e){for(var Ne,Ie=0;Ie<oe.length;++Ie){var Ve=oe[Ie],Le=Ve.fromId===ge?Ve.toId:Ve.fromId;if(Ne=_e(n.get(Le),Ve),Ne)return!0}}function I(oe,ge,_e){for(var Ne,Ie=0;Ie<oe.length;++Ie){var Ve=oe[Ie];if(Ve.fromId===ge&&(Ne=_e(n.get(Ve.toId),Ve),Ne))return!0}}function k(){}function U(){s+=1}function W(){s-=1,s===0&&u.length>0&&(y.fire("changed",u),u.length=0)}function ce(oe){if(typeof oe!="function")throw new Error("Function is expected to iterate over graph nodes. You passed "+oe);for(var ge=n.values(),_e=ge.next();!_e.done;){if(oe(_e.value))return!0;_e=ge.next()}}}function nw(i,n){if(!n)return-1;if(n.indexOf)return n.indexOf(i);var r=n.length,a;for(a=0;a<r;a+=1)if(n[a]===i)return a;return-1}function MY(i,n){this.id=i,this.links=null,this.data=n}function M3(i,n){i.links?i.links.push(n):i.links=[n]}function S3(i,n,r,a){this.fromId=i,this.toId=n,this.data=r,this.id=a}function rw(i,n){return i.toString()+"\u{1F449} "+n.toString()}var iw={exports:{}},vp={exports:{}},T3=function(n){return n===0?"x":n===1?"y":n===2?"z":"c"+(n+1)};const SY=T3;var $h=function(n){return r;function r(a,s){let o=s&&s.indent||0,u=s&&s.join!==void 0?s.join:`
`,f=Array(o+1).join(" "),v=[];for(let m=0;m<n;++m){let g=SY(m),y=m===0?"":f;v.push(y+a.replace(/{var}/g,g))}return v.join(u)}};const C3=$h;vp.exports=TY;vp.exports.generateCreateBodyFunctionBody=R3;vp.exports.getVectorCode=P3;vp.exports.getBodyCode=L3;function TY(i,n){let r=R3(i,n),{Body:a}=new Function(r)();return a}function R3(i,n){return`
${P3(i,n)}
${L3(i)}
return {Body: Body, Vector: Vector};
`}function L3(i){let n=C3(i),r=n("{var}",{join:", "});return`
function Body(${r}) {
  this.isPinned = false;
  this.pos = new Vector(${r});
  this.force = new Vector();
  this.velocity = new Vector();
  this.mass = 1;

  this.springCount = 0;
  this.springLength = 0;
}

Body.prototype.reset = function() {
  this.force.reset();
  this.springCount = 0;
  this.springLength = 0;
}

Body.prototype.setPosition = function (${r}) {
  ${n("this.pos.{var} = {var} || 0;",{indent:2})}
};`}function P3(i,n){let r=C3(i),a="";return n&&(a=`${r(`
   var v{var};
Object.defineProperty(this, '{var}', {
  set: function(v) { 
    if (!Number.isFinite(v)) throw new Error('Cannot set non-numbers to {var}');
    v{var} = v; 
  },
  get: function() { return v{var}; }
});`)}`),`function Vector(${r("{var}",{join:", "})}) {
  ${a}
    if (typeof arguments[0] === 'object') {
      // could be another vector
      let v = arguments[0];
      ${r('if (!Number.isFinite(v.{var})) throw new Error("Expected value is not a finite number at Vector constructor ({var})");',{indent:4})}
      ${r("this.{var} = v.{var};",{indent:4})}
    } else {
      ${r('this.{var} = typeof {var} === "number" ? {var} : 0;',{indent:4})}
    }
  }
  
  Vector.prototype.reset = function () {
    ${r("this.{var} = ",{join:""})}0;
  };`}var Ql={exports:{}};const aw=$h,Jl=T3;Ql.exports=CY;Ql.exports.generateQuadTreeFunctionBody=D3;Ql.exports.getInsertStackCode=B3;Ql.exports.getQuadNodeCode=F3;Ql.exports.isSamePosition=O3;Ql.exports.getChildBodyCode=k3;Ql.exports.setChildBodyCode=I3;function CY(i){let n=D3(i);return new Function(n)()}function D3(i){let n=aw(i),r=Math.pow(2,i);return`
${B3()}
${F3(i)}
${O3(i)}
${k3(i)}
${I3(i)}

function createQuadTree(options, random) {
  options = options || {};
  options.gravity = typeof options.gravity === 'number' ? options.gravity : -1;
  options.theta = typeof options.theta === 'number' ? options.theta : 0.8;

  var gravity = options.gravity;
  var updateQueue = [];
  var insertStack = new InsertStack();
  var theta = options.theta;

  var nodesCache = [];
  var currentInCache = 0;
  var root = newNode();

  return {
    insertBodies: insertBodies,

    /**
     * Gets root node if it is present
     */
    getRoot: function() {
      return root;
    },

    updateBodyForce: update,

    options: function(newOptions) {
      if (newOptions) {
        if (typeof newOptions.gravity === 'number') {
          gravity = newOptions.gravity;
        }
        if (typeof newOptions.theta === 'number') {
          theta = newOptions.theta;
        }

        return this;
      }

      return {
        gravity: gravity,
        theta: theta
      };
    }
  };

  function newNode() {
    // To avoid pressure on GC we reuse nodes.
    var node = nodesCache[currentInCache];
    if (node) {
${u("      node.")}
      node.body = null;
      node.mass = ${n("node.mass_{var} = ",{join:""})}0;
      ${n("node.min_{var} = node.max_{var} = ",{join:""})}0;
    } else {
      node = new QuadNode();
      nodesCache[currentInCache] = node;
    }

    ++currentInCache;
    return node;
  }

  function update(sourceBody) {
    var queue = updateQueue;
    var v;
    ${n("var d{var};",{indent:4})}
    var r; 
    ${n("var f{var} = 0;",{indent:4})}
    var queueLength = 1;
    var shiftIdx = 0;
    var pushIdx = 1;

    queue[0] = root;

    while (queueLength) {
      var node = queue[shiftIdx];
      var body = node.body;

      queueLength -= 1;
      shiftIdx += 1;
      var differentBody = (body !== sourceBody);
      if (body && differentBody) {
        // If the current node is a leaf node (and it is not source body),
        // calculate the force exerted by the current node on body, and add this
        // amount to body's net force.
        ${n("d{var} = body.pos.{var} - sourceBody.pos.{var};",{indent:8})}
        r = Math.sqrt(${n("d{var} * d{var}",{join:" + "})});

        if (r === 0) {
          // Poor man's protection against zero distance.
          ${n("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:10})}
          r = Math.sqrt(${n("d{var} * d{var}",{join:" + "})});
        }

        // This is standard gravitation force calculation but we divide
        // by r^3 to save two operations when normalizing force vector.
        v = gravity * body.mass * sourceBody.mass / (r * r * r);
        ${n("f{var} += v * d{var};",{indent:8})}
      } else if (differentBody) {
        // Otherwise, calculate the ratio s / r,  where s is the width of the region
        // represented by the internal node, and r is the distance between the body
        // and the node's center-of-mass
        ${n("d{var} = node.mass_{var} / node.mass - sourceBody.pos.{var};",{indent:8})}
        r = Math.sqrt(${n("d{var} * d{var}",{join:" + "})});

        if (r === 0) {
          // Sorry about code duplication. I don't want to create many functions
          // right away. Just want to see performance first.
          ${n("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:10})}
          r = Math.sqrt(${n("d{var} * d{var}",{join:" + "})});
        }
        // If s / r < \u03B8, treat this internal node as a single body, and calculate the
        // force it exerts on sourceBody, and add this amount to sourceBody's net force.
        if ((node.max_${Jl(0)} - node.min_${Jl(0)}) / r < theta) {
          // in the if statement above we consider node's width only
          // because the region was made into square during tree creation.
          // Thus there is no difference between using width or height.
          v = gravity * node.mass * sourceBody.mass / (r * r * r);
          ${n("f{var} += v * d{var};",{indent:10})}
        } else {
          // Otherwise, run the procedure recursively on each of the current node's children.

          // I intentionally unfolded this loop, to save several CPU cycles.
${o()}
        }
      }
    }

    ${n("sourceBody.force.{var} += f{var};",{indent:4})}
  }

  function insertBodies(bodies) {
    ${n("var {var}min = Number.MAX_VALUE;",{indent:4})}
    ${n("var {var}max = Number.MIN_VALUE;",{indent:4})}
    var i = bodies.length;

    // To reduce quad tree depth we are looking for exact bounding box of all particles.
    while (i--) {
      var pos = bodies[i].pos;
      ${n("if (pos.{var} < {var}min) {var}min = pos.{var};",{indent:6})}
      ${n("if (pos.{var} > {var}max) {var}max = pos.{var};",{indent:6})}
    }

    // Makes the bounds square.
    var maxSideLength = -Infinity;
    ${n("if ({var}max - {var}min > maxSideLength) maxSideLength = {var}max - {var}min ;",{indent:4})}

    currentInCache = 0;
    root = newNode();
    ${n("root.min_{var} = {var}min;",{indent:4})}
    ${n("root.max_{var} = {var}min + maxSideLength;",{indent:4})}

    i = bodies.length - 1;
    if (i >= 0) {
      root.body = bodies[i];
    }
    while (i--) {
      insert(bodies[i], root);
    }
  }

  function insert(newBody) {
    insertStack.reset();
    insertStack.push(root, newBody);

    while (!insertStack.isEmpty()) {
      var stackItem = insertStack.pop();
      var node = stackItem.node;
      var body = stackItem.body;

      if (!node.body) {
        // This is internal node. Update the total mass of the node and center-of-mass.
        ${n("var {var} = body.pos.{var};",{indent:8})}
        node.mass += body.mass;
        ${n("node.mass_{var} += body.mass * {var};",{indent:8})}

        // Recursively insert the body in the appropriate quadrant.
        // But first find the appropriate quadrant.
        var quadIdx = 0; // Assume we are in the 0's quad.
        ${n("var min_{var} = node.min_{var};",{indent:8})}
        ${n("var max_{var} = (min_{var} + node.max_{var}) / 2;",{indent:8})}

${s(8)}

        var child = getChild(node, quadIdx);

        if (!child) {
          // The node is internal but this quadrant is not taken. Add
          // subnode to it.
          child = newNode();
          ${n("child.min_{var} = min_{var};",{indent:10})}
          ${n("child.max_{var} = max_{var};",{indent:10})}
          child.body = body;

          setChild(node, quadIdx, child);
        } else {
          // continue searching in this quadrant.
          insertStack.push(child, body);
        }
      } else {
        // We are trying to add to the leaf node.
        // We have to convert current leaf into internal node
        // and continue adding two nodes.
        var oldBody = node.body;
        node.body = null; // internal nodes do not cary bodies

        if (isSamePosition(oldBody.pos, body.pos)) {
          // Prevent infinite subdivision by bumping one node
          // anywhere in this quadrant
          var retriesCount = 3;
          do {
            var offset = random.nextDouble();
            ${n("var d{var} = (node.max_{var} - node.min_{var}) * offset;",{indent:12})}

            ${n("oldBody.pos.{var} = node.min_{var} + d{var};",{indent:12})}
            retriesCount -= 1;
            // Make sure we don't bump it out of the box. If we do, next iteration should fix it
          } while (retriesCount > 0 && isSamePosition(oldBody.pos, body.pos));

          if (retriesCount === 0 && isSamePosition(oldBody.pos, body.pos)) {
            // This is very bad, we ran out of precision.
            // if we do not return from the method we'll get into
            // infinite loop here. So we sacrifice correctness of layout, and keep the app running
            // Next layout iteration should get larger bounding box in the first step and fix this
            return;
          }
        }
        // Next iteration should subdivide node further.
        insertStack.push(node, oldBody);
        insertStack.push(node, body);
      }
    }
  }
}
return createQuadTree;

`;function s(f){let v=[],m=Array(f+1).join(" ");for(let g=0;g<i;++g)v.push(m+`if (${Jl(g)} > max_${Jl(g)}) {`),v.push(m+`  quadIdx = quadIdx + ${Math.pow(2,g)};`),v.push(m+`  min_${Jl(g)} = max_${Jl(g)};`),v.push(m+`  max_${Jl(g)} = node.max_${Jl(g)};`),v.push(m+"}");return v.join(`
`)}function o(){let f=Array(11).join(" "),v=[];for(let m=0;m<r;++m)v.push(f+`if (node.quad${m}) {`),v.push(f+`  queue[pushIdx] = node.quad${m};`),v.push(f+"  queueLength += 1;"),v.push(f+"  pushIdx += 1;"),v.push(f+"}");return v.join(`
`)}function u(f){let v=[];for(let m=0;m<r;++m)v.push(`${f}quad${m} = null;`);return v.join(`
`)}}function O3(i){let n=aw(i);return`
  function isSamePosition(point1, point2) {
    ${n("var d{var} = Math.abs(point1.{var} - point2.{var});",{indent:2})}
  
    return ${n("d{var} < 1e-8",{join:" && "})};
  }  
`}function I3(i){var n=Math.pow(2,i);return`
function setChild(node, idx, child) {
  ${r()}
}`;function r(){let a=[];for(let s=0;s<n;++s){let o=s===0?"  ":"  else ";a.push(`${o}if (idx === ${s}) node.quad${s} = child;`)}return a.join(`
`)}}function k3(i){return`function getChild(node, idx) {
${n()}
  return null;
}`;function n(){let r=[],a=Math.pow(2,i);for(let s=0;s<a;++s)r.push(`  if (idx === ${s}) return node.quad${s};`);return r.join(`
`)}}function F3(i){let n=aw(i),r=Math.pow(2,i);var a=`
function QuadNode() {
  // body stored inside this node. In quad tree only leaf nodes (by construction)
  // contain bodies:
  this.body = null;

  // Child nodes are stored in quads. Each quad is presented by number:
  // 0 | 1
  // -----
  // 2 | 3
${s("  this.")}

  // Total mass of current node
  this.mass = 0;

  // Center of mass coordinates
  ${n("this.mass_{var} = 0;",{indent:2})}

  // bounding box coordinates
  ${n("this.min_{var} = 0;",{indent:2})}
  ${n("this.max_{var} = 0;",{indent:2})}
}
`;return a;function s(o){let u=[];for(let f=0;f<r;++f)u.push(`${o}quad${f} = null;`);return u.join(`
`)}}function B3(){return`
/**
 * Our implementation of QuadTree is non-recursive to avoid GC hit
 * This data structure represent stack of elements
 * which we are trying to insert into quad tree.
 */
function InsertStack () {
    this.stack = [];
    this.popIdx = 0;
}

InsertStack.prototype = {
    isEmpty: function() {
        return this.popIdx === 0;
    },
    push: function (node, body) {
        var item = this.stack[this.popIdx];
        if (!item) {
            // we are trying to avoid memory pressure: create new element
            // only when absolutely necessary
            this.stack[this.popIdx] = new InsertStackElement(node, body);
        } else {
            item.node = node;
            item.body = body;
        }
        ++this.popIdx;
    },
    pop: function () {
        if (this.popIdx > 0) {
            return this.stack[--this.popIdx];
        }
    },
    reset: function () {
        this.popIdx = 0;
    }
};

function InsertStackElement(node, body) {
    this.node = node; // QuadTree node
    this.body = body; // physical body which needs to be inserted to node
}
`}var ow={exports:{}};ow.exports=LY;ow.exports.generateFunctionBody=N3;const RY=$h;function LY(i){let n=N3(i);return new Function("bodies","settings","random",n)}function N3(i){let n=RY(i);return`
  var boundingBox = {
    ${n("min_{var}: 0, max_{var}: 0,",{indent:4})}
  };

  return {
    box: boundingBox,

    update: updateBoundingBox,

    reset: resetBoundingBox,

    getBestNewPosition: function (neighbors) {
      var ${n("base_{var} = 0",{join:", "})};

      if (neighbors.length) {
        for (var i = 0; i < neighbors.length; ++i) {
          let neighborPos = neighbors[i].pos;
          ${n("base_{var} += neighborPos.{var};",{indent:10})}
        }

        ${n("base_{var} /= neighbors.length;",{indent:8})}
      } else {
        ${n("base_{var} = (boundingBox.min_{var} + boundingBox.max_{var}) / 2;",{indent:8})}
      }

      var springLength = settings.springLength;
      return {
        ${n("{var}: base_{var} + (random.nextDouble() - 0.5) * springLength,",{indent:8})}
      };
    }
  };

  function updateBoundingBox() {
    var i = bodies.length;
    if (i === 0) return; // No bodies - no borders.

    ${n("var max_{var} = -Infinity;",{indent:4})}
    ${n("var min_{var} = Infinity;",{indent:4})}

    while(i--) {
      // this is O(n), it could be done faster with quadtree, if we check the root node bounds
      var bodyPos = bodies[i].pos;
      ${n("if (bodyPos.{var} < min_{var}) min_{var} = bodyPos.{var};",{indent:6})}
      ${n("if (bodyPos.{var} > max_{var}) max_{var} = bodyPos.{var};",{indent:6})}
    }

    ${n("boundingBox.min_{var} = min_{var};",{indent:4})}
    ${n("boundingBox.max_{var} = max_{var};",{indent:4})}
  }

  function resetBoundingBox() {
    ${n("boundingBox.min_{var} = boundingBox.max_{var} = 0;",{indent:4})}
  }
`}var sw={exports:{}};const PY=$h;sw.exports=DY;sw.exports.generateCreateDragForceFunctionBody=U3;function DY(i){let n=U3(i);return new Function("options",n)}function U3(i){return`
  if (!Number.isFinite(options.dragCoefficient)) throw new Error('dragCoefficient is not a finite number');

  return {
    update: function(body) {
      ${PY(i)("body.force.{var} -= options.dragCoefficient * body.velocity.{var};",{indent:6})}
    }
  };
`}var lw={exports:{}};const OY=$h;lw.exports=IY;lw.exports.generateCreateSpringForceFunctionBody=H3;function IY(i){let n=H3(i);return new Function("options","random",n)}function H3(i){let n=OY(i);return`
  if (!Number.isFinite(options.springCoefficient)) throw new Error('Spring coefficient is not a number');
  if (!Number.isFinite(options.springLength)) throw new Error('Spring length is not a number');

  return {
    /**
     * Updates forces acting on a spring
     */
    update: function (spring) {
      var body1 = spring.from;
      var body2 = spring.to;
      var length = spring.length < 0 ? options.springLength : spring.length;
      ${n("var d{var} = body2.pos.{var} - body1.pos.{var};",{indent:6})}
      var r = Math.sqrt(${n("d{var} * d{var}",{join:" + "})});

      if (r === 0) {
        ${n("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:8})}
        r = Math.sqrt(${n("d{var} * d{var}",{join:" + "})});
      }

      var d = r - length;
      var coefficient = ((spring.coefficient > 0) ? spring.coefficient : options.springCoefficient) * d / r;

      ${n("body1.force.{var} += coefficient * d{var}",{indent:6})};
      body1.springCount += 1;
      body1.springLength += r;

      ${n("body2.force.{var} -= coefficient * d{var}",{indent:6})};
      body2.springCount += 1;
      body2.springLength += r;
    }
  };
`}var cw={exports:{}};const kY=$h;cw.exports=FY;cw.exports.generateIntegratorFunctionBody=z3;function FY(i){let n=z3(i);return new Function("bodies","timeStep","adaptiveTimeStepWeight",n)}function z3(i){let n=kY(i);return`
  var length = bodies.length;
  if (length === 0) return 0;

  ${n("var d{var} = 0, t{var} = 0;",{indent:2})}

  for (var i = 0; i < length; ++i) {
    var body = bodies[i];
    if (body.isPinned) continue;

    if (adaptiveTimeStepWeight && body.springCount) {
      timeStep = (adaptiveTimeStepWeight * body.springLength/body.springCount);
    }

    var coeff = timeStep / body.mass;

    ${n("body.velocity.{var} += coeff * body.force.{var};",{indent:4})}
    ${n("var v{var} = body.velocity.{var};",{indent:4})}
    var v = Math.sqrt(${n("v{var} * v{var}",{join:" + "})});

    if (v > 1) {
      // We normalize it so that we move within timeStep range. 
      // for the case when v <= 1 - we let velocity to fade out.
      ${n("body.velocity.{var} = v{var} / v;",{indent:6})}
    }

    ${n("d{var} = timeStep * body.velocity.{var};",{indent:4})}

    ${n("body.pos.{var} += d{var};",{indent:4})}

    ${n("t{var} += Math.abs(d{var});",{indent:4})}
  }

  return (${n("t{var} * t{var}",{join:" + "})})/length;
`}var BY=NY;function NY(i,n,r,a){this.from=i,this.to=n,this.length=r,this.coefficient=a}var UY=G3;function G3(i,n){var r;if(i||(i={}),n){for(r in n)if(n.hasOwnProperty(r)){var a=i.hasOwnProperty(r),s=typeof n[r],o=!a||typeof i[r]!==s;o?i[r]=n[r]:s==="object"&&(i[r]=G3(i[r],n[r]))}}return i}var r0={exports:{}};r0.exports=uw;r0.exports.random=uw,r0.exports.randomIterator=VY;function uw(i){var n=typeof i=="number"?i:+new Date;return new Kh(n)}function Kh(i){this.seed=i}Kh.prototype.next=GY;Kh.prototype.nextDouble=W3;Kh.prototype.uniform=W3;Kh.prototype.gaussian=HY;function HY(){var i,n,r;do n=this.nextDouble()*2-1,r=this.nextDouble()*2-1,i=n*n+r*r;while(i>=1||i===0);return n*Math.sqrt(-2*Math.log(i)/i)}Kh.prototype.levy=zY;function zY(){var i=3/2,n=Math.pow(V3(1+i)*Math.sin(Math.PI*i/2)/(V3((1+i)/2)*i*Math.pow(2,(i-1)/2)),1/i);return this.gaussian()*n/Math.pow(Math.abs(this.gaussian()),1/i)}function V3(i){return Math.sqrt(2*Math.PI/i)*Math.pow(1/Math.E*(i+1/(12*i-1/(10*i))),i)}function W3(){var i=this.seed;return i=i+2127912214+(i<<12)&4294967295,i=(i^3345072700^i>>>19)&4294967295,i=i+374761393+(i<<5)&4294967295,i=(i+3550635116^i<<9)&4294967295,i=i+4251993797+(i<<3)&4294967295,i=(i^3042594569^i>>>16)&4294967295,this.seed=i,(i&268435455)/268435456}function GY(i){return Math.floor(this.nextDouble()*i)}function VY(i,n){var r=n||uw();if(typeof r.next!="function")throw new Error("customRandom does not match expected API: next() function is missing");return{forEach:s,shuffle:a};function a(){var o,u,f;for(o=i.length-1;o>0;--o)u=r.next(o+1),f=i[u],i[u]=i[o],i[o]=f;return i}function s(o){var u,f,v;for(u=i.length-1;u>0;--u)f=r.next(u+1),v=i[f],i[f]=i[u],i[u]=v,o(v);i.length&&o(i[0])}}var j3=KY,WY=vp.exports,jY=Ql.exports,XY=ow.exports,qY=sw.exports,YY=lw.exports,$Y=cw.exports,X3={};function KY(i){var n=BY,r=UY,a=tw;if(i){if(i.springCoeff!==void 0)throw new Error("springCoeff was renamed to springCoefficient");if(i.dragCoeff!==void 0)throw new Error("dragCoeff was renamed to dragCoefficient")}i=r(i,{springLength:10,springCoefficient:.8,gravity:-12,theta:.8,dragCoefficient:.9,timeStep:.5,adaptiveTimeStepWeight:0,dimensions:2,debug:!1});var s=X3[i.dimensions];if(!s){var o=i.dimensions;s={Body:WY(o,i.debug),createQuadTree:jY(o),createBounds:XY(o),createDragForce:qY(o),createSpringForce:YY(o),integrate:$Y(o)},X3[o]=s}var u=s.Body,f=s.createQuadTree,v=s.createBounds,m=s.createDragForce,g=s.createSpringForce,y=s.integrate,b=k=>new u(k),w=r0.exports.random(42),A=[],M=[],S=f(i,w),E=v(A,i,w),T=g(i,w),C=m(i),L=0,P=[],N=new Map,F=0;ae("nbody",D),ae("spring",I);var X={bodies:A,quadTree:S,springs:M,settings:i,addForce:ae,removeForce:$,getForces:de,step:function(){for(var k=0;k<P.length;++k)P[k](F);var U=y(A,i.timeStep,i.adaptiveTimeStepWeight);return F+=1,U},addBody:function(k){if(!k)throw new Error("Body is required");return A.push(k),k},addBodyAt:function(k){if(!k)throw new Error("Body position is required");var U=b(k);return A.push(U),U},removeBody:function(k){if(!!k){var U=A.indexOf(k);if(!(U<0))return A.splice(U,1),A.length===0&&E.reset(),!0}},addSpring:function(k,U,W,ce){if(!k||!U)throw new Error("Cannot add null spring to force simulator");typeof W!="number"&&(W=-1);var oe=new n(k,U,W,ce>=0?ce:-1);return M.push(oe),oe},getTotalMovement:function(){return L},removeSpring:function(k){if(!!k){var U=M.indexOf(k);if(U>-1)return M.splice(U,1),!0}},getBestNewBodyPosition:function(k){return E.getBestNewPosition(k)},getBBox:Y,getBoundingBox:Y,invalidateBBox:function(){console.warn("invalidateBBox() is deprecated, bounds always recomputed on `getBBox()` call")},gravity:function(k){return k!==void 0?(i.gravity=k,S.options({gravity:k}),this):i.gravity},theta:function(k){return k!==void 0?(i.theta=k,S.options({theta:k}),this):i.theta},random:w};return ZY(i,X),a(X),X;function Y(){return E.update(),E.box}function ae(k,U){if(N.has(k))throw new Error("Force "+k+" is already added");N.set(k,U),P.push(U)}function $(k){var U=P.indexOf(N.get(k));U<0||(P.splice(U,1),N.delete(k))}function de(){return N}function D(){if(A.length!==0){S.insertBodies(A);for(var k=A.length;k--;){var U=A[k];U.isPinned||(U.reset(),S.updateBodyForce(U),C.update(U))}}}function I(){for(var k=M.length;k--;)T.update(M[k])}}function ZY(i,n){for(var r in i)QY(i,n,r)}function QY(i,n,r){if(!!i.hasOwnProperty(r)&&typeof n[r]!="function"){var a=Number.isFinite(i[r]);a?n[r]=function(s){if(s!==void 0){if(!Number.isFinite(s))throw new Error("Value of "+r+" should be a valid number.");return i[r]=s,n}return i[r]}:n[r]=function(s){return s!==void 0?(i[r]=s,n):i[r]}}}iw.exports=e$;iw.exports.simulator=j3;var JY=tw;function e$(i,n){if(!i)throw new Error("Graph structure cannot be undefined");var r=n&&n.createSimulator||j3,a=r(n);if(Array.isArray(n))throw new Error("Physics settings is expected to be an object");var s=i.version>19?D:de;n&&typeof n.nodeMass=="function"&&(s=n.nodeMass);var o=new Map,u={},f=0,v=a.settings.springTransform||t$;C(),S();var m=!1,g={step:function(){if(f===0)return y(!0),!0;var I=a.step();g.lastMove=I,g.fire("step");var k=I/f,U=k<=.01;return y(U),U},getNodePosition:function(I){return $(I).pos},setNodePosition:function(I){var k=$(I);k.setPosition.apply(k,Array.prototype.slice.call(arguments,1))},getLinkPosition:function(I){var k=u[I];if(k)return{from:k.from.pos,to:k.to.pos}},getGraphRect:function(){return a.getBBox()},forEachBody:b,pinNode:function(I,k){var U=$(I.id);U.isPinned=!!k},isNodePinned:function(I){return $(I.id).isPinned},dispose:function(){i.off("changed",T),g.fire("disposed")},getBody:M,getSpring:A,getForceVectorLength:w,simulator:a,graph:i,lastMove:0};return JY(g),g;function y(I){m!==I&&(m=I,E(I))}function b(I){o.forEach(I)}function w(){var I=0,k=0;return b(function(U){I+=Math.abs(U.force.x),k+=Math.abs(U.force.y)}),Math.sqrt(I*I+k*k)}function A(I,k){var U;if(k===void 0)typeof I!="object"?U=I:U=I.id;else{var W=i.hasLink(I,k);if(!W)return;U=W.id}return u[U]}function M(I){return o.get(I)}function S(){i.on("changed",T)}function E(I){g.fire("stable",I)}function T(I){for(var k=0;k<I.length;++k){var U=I[k];U.changeType==="add"?(U.node&&L(U.node.id),U.link&&N(U.link)):U.changeType==="remove"&&(U.node&&P(U.node),U.link&&F(U.link))}f=i.getNodesCount()}function C(){f=0,i.forEachNode(function(I){L(I.id),f+=1}),i.forEachLink(N)}function L(I){var k=o.get(I);if(!k){var U=i.getNode(I);if(!U)throw new Error("initBody() was called with unknown node id");var W=U.position;if(!W){var ce=X(U);W=a.getBestNewBodyPosition(ce)}k=a.addBodyAt(W),k.id=I,o.set(I,k),Y(I),ae(U)&&(k.isPinned=!0)}}function P(I){var k=I.id,U=o.get(k);U&&(o.delete(k),a.removeBody(U))}function N(I){Y(I.fromId),Y(I.toId);var k=o.get(I.fromId),U=o.get(I.toId),W=a.addSpring(k,U,I.length);v(I,W),u[I.id]=W}function F(I){var k=u[I.id];if(k){var U=i.getNode(I.fromId),W=i.getNode(I.toId);U&&Y(U.id),W&&Y(W.id),delete u[I.id],a.removeSpring(k)}}function X(I){var k=[];if(!I.links)return k;for(var U=Math.min(I.links.length,2),W=0;W<U;++W){var ce=I.links[W],oe=ce.fromId!==I.id?o.get(ce.fromId):o.get(ce.toId);oe&&oe.pos&&k.push(oe)}return k}function Y(I){var k=o.get(I);if(k.mass=s(I),Number.isNaN(k.mass))throw new Error("Node mass should be a number")}function ae(I){return I&&(I.isPinned||I.data&&I.data.isPinned)}function $(I){var k=o.get(I);return k||(L(I),k=o.get(I)),k}function de(I){var k=i.getLinks(I);return k?1+k.length/3:1}function D(I){var k=i.getLinks(I);return k?1+k.size/3:1}}function t$(){}var n$=iw.exports;function q3(i,n){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);n&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(i,s).enumerable})),r.push.apply(r,a)}return r}function r$(i){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?q3(Object(r),!0).forEach(function(a){Y3(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):q3(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}function Y3(i,n,r){return n in i?Object.defineProperty(i,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):i[n]=r,i}function i$(i,n){if(i==null)return{};var r={},a=Object.keys(i),s,o;for(o=0;o<a.length;o++)s=a[o],!(n.indexOf(s)>=0)&&(r[s]=i[s]);return r}function a$(i,n){if(i==null)return{};var r=i$(i,n),a,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(i);for(s=0;s<o.length;s++)a=o[s],!(n.indexOf(a)>=0)&&(!Object.prototype.propertyIsEnumerable.call(i,a)||(r[a]=i[a]))}return r}function $3(i,n){return s$(i)||c$(i,n)||K3(i,n)||h$()}function i0(i){return o$(i)||l$(i)||K3(i)||u$()}function o$(i){if(Array.isArray(i))return hw(i)}function s$(i){if(Array.isArray(i))return i}function l$(i){if(typeof Symbol!="undefined"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function c$(i,n){var r=i&&(typeof Symbol!="undefined"&&i[Symbol.iterator]||i["@@iterator"]);if(r!=null){var a=[],s=!0,o=!1,u,f;try{for(r=r.call(i);!(s=(u=r.next()).done)&&(a.push(u.value),!(n&&a.length===n));s=!0);}catch(v){o=!0,f=v}finally{try{!s&&r.return!=null&&r.return()}finally{if(o)throw f}}return a}}function K3(i,n){if(!!i){if(typeof i=="string")return hw(i,n);var r=Object.prototype.toString.call(i).slice(8,-1);if(r==="Object"&&i.constructor&&(r=i.constructor.name),r==="Map"||r==="Set")return Array.from(i);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hw(i,n)}}function hw(i,n){(n==null||n>i.length)&&(n=i.length);for(var r=0,a=new Array(n);r<n;r++)a[r]=i[r];return a}function u$(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function h$(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function f$(i,n,r){var a={enter:[],update:[],exit:[]};if(r){var u=$1(i,r,!1),f=$1(n,r,!1),v=Object.assign({},u,f);Object.entries(v).forEach(function(m){var g=$3(m,2),y=g[0],b=g[1],w=u.hasOwnProperty(y)?f.hasOwnProperty(y)?"update":"exit":"enter";a[w].push(w==="update"?[u[y],f[y]]:b)})}else{var s=new Set(i),o=new Set(n);new Set([].concat(i0(s),i0(o))).forEach(function(m){var g=s.has(m)?o.has(m)?"update":"exit":"enter";a[g].push(g==="update"?[m,m]:m)})}return a}function d$(i,n,r){var a=r.objBindAttr,s=a===void 0?"__obj":a,o=r.dataBindAttr,u=o===void 0?"__data":o,f=r.idAccessor,v=r.purge,m=v===void 0?!1:v,g=function(S){return S.hasOwnProperty(u)},y=n.filter(function(M){return!g(M)}),b=n.filter(g).map(function(M){return M[u]}),w=i,A=m?{enter:w,exit:b,update:[]}:f$(b,w,f);return A.update=A.update.map(function(M){var S=$3(M,2),E=S[0],T=S[1];return E!==T&&(T[s]=E[s],T[s][u]=T),T}),A.exit=A.exit.concat(y.map(function(M){return Y3({},s,M)})),A}function p$(i,n,r,a,s){var o=s.createObj,u=o===void 0?function(X){return{}}:o,f=s.updateObj,v=f===void 0?function(X,Y){}:f,m=s.exitObj,g=m===void 0?function(X){}:m,y=s.objBindAttr,b=y===void 0?"__obj":y,w=s.dataBindAttr,A=w===void 0?"__data":w,M=a$(s,["createObj","updateObj","exitObj","objBindAttr","dataBindAttr"]),S=d$(i,n,r$({objBindAttr:b,dataBindAttr:A},M)),E=S.enter,T=S.update,C=S.exit;C.forEach(function(X){var Y=X[b];delete X[b],g(Y),a(Y)});var L=N(E),P=[].concat(i0(E),i0(T));F(P),L.forEach(r);function N(X){var Y=[];return X.forEach(function(ae){var $=u(ae);$&&($[A]=ae,ae[b]=$,Y.push($))}),Y}function F(X){X.forEach(function(Y){var ae=Y[b];ae&&(ae[A]=Y,v(ae,Y))})}}function Z3(i,n){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);n&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(i,s).enumerable})),r.push.apply(r,a)}return r}function Q3(i){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?Z3(Object(r),!0).forEach(function(a){fw(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):Z3(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}function a0(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?a0=function(n){return typeof n}:a0=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},a0(i)}function m$(i,n){if(!(i instanceof n))throw new TypeError("Cannot call a class as a function")}function fw(i,n,r){return n in i?Object.defineProperty(i,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):i[n]=r,i}function v$(i,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(n&&n.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),n&&s0(i,n)}function o0(i){return o0=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},o0(i)}function s0(i,n){return s0=Object.setPrototypeOf||function(a,s){return a.__proto__=s,a},s0(i,n)}function J3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function l0(i,n,r){return J3()?l0=Reflect.construct:l0=function(s,o,u){var f=[null];f.push.apply(f,o);var v=Function.bind.apply(s,f),m=new v;return u&&s0(m,u.prototype),m},l0.apply(null,arguments)}function g$(i,n){if(i==null)return{};var r={},a=Object.keys(i),s,o;for(o=0;o<a.length;o++)s=a[o],!(n.indexOf(s)>=0)&&(r[s]=i[s]);return r}function y$(i,n){if(i==null)return{};var r=g$(i,n),a,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(i);for(s=0;s<o.length;s++)a=o[s],!(n.indexOf(a)>=0)&&(!Object.prototype.propertyIsEnumerable.call(i,a)||(r[a]=i[a]))}return r}function eR(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function b$(i,n){return n&&(typeof n=="object"||typeof n=="function")?n:eR(i)}function x$(i){var n=J3();return function(){var a=o0(i),s;if(n){var o=o0(this).constructor;s=Reflect.construct(a,arguments,o)}else s=a.apply(this,arguments);return b$(this,s)}}function tR(i,n){return A$(i)||_$(i,n)||nR(i,n)||S$()}function No(i){return w$(i)||E$(i)||nR(i)||M$()}function w$(i){if(Array.isArray(i))return dw(i)}function A$(i){if(Array.isArray(i))return i}function E$(i){if(typeof Symbol!="undefined"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function _$(i,n){var r=i==null?null:typeof Symbol!="undefined"&&i[Symbol.iterator]||i["@@iterator"];if(r!=null){var a=[],s=!0,o=!1,u,f;try{for(r=r.call(i);!(s=(u=r.next()).done)&&(a.push(u.value),!(n&&a.length===n));s=!0);}catch(v){o=!0,f=v}finally{try{!s&&r.return!=null&&r.return()}finally{if(o)throw f}}return a}}function nR(i,n){if(!!i){if(typeof i=="string")return dw(i,n);var r=Object.prototype.toString.call(i).slice(8,-1);if(r==="Object"&&i.constructor&&(r=i.constructor.name),r==="Map"||r==="Set")return Array.from(i);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dw(i,n)}}function dw(i,n){(n==null||n>i.length)&&(n=i.length);for(var r=0,a=new Array(n);r<n;r++)a[r]=i[r];return a}function M$(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function S$(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var T$=function i(n){n instanceof Array?n.forEach(i):(n.map&&n.map.dispose(),n.dispose())},C$=function i(n){n.geometry&&n.geometry.dispose(),n.material&&T$(n.material),n.texture&&n.texture.dispose(),n.children&&n.children.forEach(i)},rR=function(n){for(;n.children.length;){var r=n.children[0];n.remove(r),C$(r)}},R$=["objFilter"];function gp(i,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=r.objFilter,s=a===void 0?function(){return!0}:a,o=y$(r,R$);return p$(i,n.children.filter(s),function(u){return n.add(u)},function(u){n.remove(u),rR(u)},Q3({objBindAttr:"__threeObj"},o))}var c0=function(n){return isNaN(n)?parseInt(H1(n).toHex(),16):n},iR=function(n){return isNaN(n)?H1(n).getAlpha():1},L$=K1(p3);function aR(i,n,r){!n||typeof r!="string"||i.filter(function(a){return!a[r]}).forEach(function(a){a[r]=L$(n(a))})}function P$(i,n){var r=i.nodes,a=i.links,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=s.nodeFilter,u=o===void 0?function(){return!0}:o,f=s.onLoopError,v=f===void 0?function(w){throw"Invalid DAG structure! Found cycle in node path: ".concat(w.join(" -> "),".")}:f,m={};r.forEach(function(w){return m[n(w)]={data:w,out:[],depth:-1,skip:!u(w)}}),a.forEach(function(w){var A=w.source,M=w.target,S=L(A),E=L(M);if(!m.hasOwnProperty(S))throw"Missing source node with id: ".concat(S);if(!m.hasOwnProperty(E))throw"Missing target node with id: ".concat(E);var T=m[S],C=m[E];T.out.push(C);function L(P){return a0(P)==="object"?n(P):P}});var g=[];b(Object.values(m));var y=Object.assign.apply(Object,[{}].concat(No(Object.entries(m).filter(function(w){var A=tR(w,2),M=A[1];return!M.skip}).map(function(w){var A=tR(w,2),M=A[0],S=A[1];return fw({},M,S.depth)}))));return y;function b(w){for(var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,S=0,E=w.length;S<E;S++){var T=w[S];if(A.indexOf(T)!==-1){var C=function(){var L=[].concat(No(A.slice(A.indexOf(T))),[T]).map(function(P){return n(P.data)});return g.some(function(P){return P.length===L.length&&P.every(function(N,F){return N===L[F]})})||(g.push(L),v(L)),"continue"}();if(C==="continue")continue}M>T.depth&&(T.depth=M,b(T.out,[].concat(No(A),[T]),M+(T.skip?0:1)))}}}var Qn=window.THREE?window.THREE:{Group:Yc,Mesh:ra,MeshLambertMaterial:m2,Color:On,BufferGeometry:Zr,BufferAttribute:zi,Matrix4:jn,Vector3:Ze,SphereBufferGeometry:Sg,CylinderBufferGeometry:yg,TubeBufferGeometry:r1,ConeBufferGeometry:Vx,Line:mg,LineBasicMaterial:kh,QuadraticBezierCurve3:Ag,CubicBezierCurve3:$x,Box3:Ja},oR={graph:AY,forcelayout:n$},D$=2,sR=new Qn.BufferGeometry().setAttribute?"setAttribute":"addAttribute",u0=new Qn.BufferGeometry().applyMatrix4?"applyMatrix4":"applyMatrix",O$=Zc({props:{jsonUrl:{onChange:function(n,r){var a=this;n&&!r.fetchingJson&&(r.fetchingJson=!0,r.onLoading(),fetch(n).then(function(s){return s.json()}).then(function(s){r.fetchingJson=!1,r.onFinishLoading(s),a.graphData(s)}))},triggerUpdate:!1},graphData:{default:{nodes:[],links:[]},onChange:function(n,r){r.engineRunning=!1}},numDimensions:{default:3,onChange:function(n,r){var a=r.d3ForceLayout.force("charge");a&&a.strength(n>2?-60:-30),n<3&&s(r.graphData.nodes,"z"),n<2&&s(r.graphData.nodes,"y");function s(o,u){o.forEach(function(f){delete f[u],delete f["v".concat(u)]})}}},dagMode:{onChange:function(n,r){!n&&r.forceEngine==="d3"&&(r.graphData.nodes||[]).forEach(function(a){return a.fx=a.fy=a.fz=void 0})}},dagLevelDistance:{},dagNodeFilter:{default:function(n){return!0}},onDagError:{triggerUpdate:!1},nodeRelSize:{default:4},nodeId:{default:"id"},nodeVal:{default:"val"},nodeResolution:{default:8},nodeColor:{default:"color"},nodeAutoColorBy:{},nodeOpacity:{default:.75},nodeVisibility:{default:!0},nodeThreeObject:{},nodeThreeObjectExtend:{default:!1},linkSource:{default:"source"},linkTarget:{default:"target"},linkVisibility:{default:!0},linkColor:{default:"color"},linkAutoColorBy:{},linkOpacity:{default:.2},linkWidth:{},linkResolution:{default:6},linkCurvature:{default:0,triggerUpdate:!1},linkCurveRotation:{default:0,triggerUpdate:!1},linkMaterial:{},linkThreeObject:{},linkThreeObjectExtend:{default:!1},linkPositionUpdate:{triggerUpdate:!1},linkDirectionalArrowLength:{default:0},linkDirectionalArrowColor:{},linkDirectionalArrowRelPos:{default:.5,triggerUpdate:!1},linkDirectionalArrowResolution:{default:8},linkDirectionalParticles:{default:0},linkDirectionalParticleSpeed:{default:.01,triggerUpdate:!1},linkDirectionalParticleWidth:{default:.5},linkDirectionalParticleColor:{},linkDirectionalParticleResolution:{default:4},forceEngine:{default:"d3"},d3AlphaMin:{default:0},d3AlphaDecay:{default:.0228,triggerUpdate:!1,onChange:function(n,r){r.d3ForceLayout.alphaDecay(n)}},d3AlphaTarget:{default:0,triggerUpdate:!1,onChange:function(n,r){r.d3ForceLayout.alphaTarget(n)}},d3VelocityDecay:{default:.4,triggerUpdate:!1,onChange:function(n,r){r.d3ForceLayout.velocityDecay(n)}},ngraphPhysics:{default:{timeStep:20,gravity:-1.2,theta:.8,springLength:30,springCoefficient:8e-4,dragCoefficient:.02}},warmupTicks:{default:0,triggerUpdate:!1},cooldownTicks:{default:1/0,triggerUpdate:!1},cooldownTime:{default:15e3,triggerUpdate:!1},onLoading:{default:function(){},triggerUpdate:!1},onFinishLoading:{default:function(){},triggerUpdate:!1},onUpdate:{default:function(){},triggerUpdate:!1},onFinishUpdate:{default:function(){},triggerUpdate:!1},onEngineTick:{default:function(){},triggerUpdate:!1},onEngineStop:{default:function(){},triggerUpdate:!1}},methods:{refresh:function(n){return n._flushObjects=!0,n._rerender(),this},d3Force:function(n,r,a){return a===void 0?n.d3ForceLayout.force(r):(n.d3ForceLayout.force(r,a),this)},d3ReheatSimulation:function(n){return n.d3ForceLayout.alpha(1),this.resetCountdown(),this},resetCountdown:function(n){return n.cntTicks=0,n.startTickTime=new Date,n.engineRunning=!0,this},tickFrame:function(n){var r=n.forceEngine!=="ngraph";return n.engineRunning&&a(),s(),o(),this;function a(){++n.cntTicks>n.cooldownTicks||new Date-n.startTickTime>n.cooldownTime||r&&n.d3AlphaMin>0&&n.d3ForceLayout.alpha()<n.d3AlphaMin?(n.engineRunning=!1,n.onEngineStop()):(n.layout[r?"tick":"step"](),n.onEngineTick()),n.graphData.nodes.forEach(function(y){var b=y.__threeObj;if(!!b){var w=r?y:n.layout.getNodePosition(y[n.nodeId]);b.position.x=w.x,b.position.y=w.y||0,b.position.z=w.z||0}});var u=Ln(n.linkWidth),f=Ln(n.linkCurvature),v=Ln(n.linkCurveRotation),m=Ln(n.linkThreeObjectExtend);n.graphData.links.forEach(function(y){var b=y.__lineObj;if(!!b){var w=r?y:n.layout.getLinkPosition(n.layout.graph.getLink(y.source,y.target).id),A=w[r?"source":"from"],M=w[r?"target":"to"];if(!(!A||!M||!A.hasOwnProperty("x")||!M.hasOwnProperty("x"))){g(y);var S=m(y);if(!(n.linkPositionUpdate&&n.linkPositionUpdate(S?b.children[1]:b,{start:{x:A.x,y:A.y,z:A.z},end:{x:M.x,y:M.y,z:M.z}},y)&&!S)){var E=30,T=y.__curve,C=b.children.length?b.children[0]:b;if(C.type==="Line"){if(T)C.geometry.setFromPoints(T.getPoints(E));else{var L=C.geometry.getAttribute("position");(!L||!L.array||L.array.length!==6)&&C.geometry[sR]("position",L=new Qn.BufferAttribute(new Float32Array(2*3),3)),L.array[0]=A.x,L.array[1]=A.y||0,L.array[2]=A.z||0,L.array[3]=M.x,L.array[4]=M.y||0,L.array[5]=M.z||0,L.needsUpdate=!0}C.geometry.computeBoundingSphere()}else if(C.type==="Mesh")if(T){C.geometry.type.match(/^Tube(Buffer)?Geometry$/)||(C.position.set(0,0,0),C.rotation.set(0,0,0),C.scale.set(1,1,1));var $=Math.ceil(u(y)*10)/10,de=$/2,D=new Qn.TubeBufferGeometry(T,E,de,n.linkResolution,!1);C.geometry.dispose(),C.geometry=D}else{if(!C.geometry.type.match(/^Cylinder(Buffer)?Geometry$/)){var P=Math.ceil(u(y)*10)/10,N=P/2,F=new Qn.CylinderBufferGeometry(N,N,1,n.linkResolution,1,!1);F[u0](new Qn.Matrix4().makeTranslation(0,1/2,0)),F[u0](new Qn.Matrix4().makeRotationX(Math.PI/2)),C.geometry.dispose(),C.geometry=F}var X=new Qn.Vector3(A.x,A.y||0,A.z||0),Y=new Qn.Vector3(M.x,M.y||0,M.z||0),ae=X.distanceTo(Y);C.position.x=X.x,C.position.y=X.y,C.position.z=X.z,C.scale.z=ae,C.parent.localToWorld(Y),C.lookAt(Y)}}}}});function g(y){var b=r?y:n.layout.getLinkPosition(n.layout.graph.getLink(y.source,y.target).id),w=b[r?"source":"from"],A=b[r?"target":"to"];if(!(!w||!A||!w.hasOwnProperty("x")||!A.hasOwnProperty("x"))){var M=f(y);if(!M)y.__curve=null;else{var S=new Qn.Vector3(w.x,w.y||0,w.z||0),E=new Qn.Vector3(A.x,A.y||0,A.z||0),T=S.distanceTo(E),C,L=v(y);if(T>0){var P=A.x-w.x,N=A.y-w.y||0,F=new Qn.Vector3().subVectors(E,S),X=F.clone().multiplyScalar(M).cross(P!==0||N!==0?new Qn.Vector3(0,0,1):new Qn.Vector3(0,1,0)).applyAxisAngle(F.normalize(),L).add(new Qn.Vector3().addVectors(S,E).divideScalar(2));C=new Qn.QuadraticBezierCurve3(S,X,E)}else{var Y=M*70,ae=-L,$=ae+Math.PI/2;C=new Qn.CubicBezierCurve3(S,new Qn.Vector3(Y*Math.cos($),Y*Math.sin($),0).add(S),new Qn.Vector3(Y*Math.cos(ae),Y*Math.sin(ae),0).add(S),E)}y.__curve=C}}}}function s(){var u=Ln(n.linkDirectionalArrowRelPos),f=Ln(n.linkDirectionalArrowLength),v=Ln(n.nodeVal);n.graphData.links.forEach(function(m){var g=m.__arrowObj;if(!!g){var y=r?m:n.layout.getLinkPosition(n.layout.graph.getLink(m.source,m.target).id),b=y[r?"source":"from"],w=y[r?"target":"to"];if(!(!b||!w||!b.hasOwnProperty("x")||!w.hasOwnProperty("x"))){var A=Math.sqrt(Math.max(0,v(b)||1))*n.nodeRelSize,M=Math.sqrt(Math.max(0,v(w)||1))*n.nodeRelSize,S=f(m),E=u(m),T=m.__curve?function(X){return m.__curve.getPoint(X)}:function(X){var Y=function($,de,D,I){return de[$]+(D[$]-de[$])*I||0};return{x:Y("x",b,w,X),y:Y("y",b,w,X),z:Y("z",b,w,X)}},C=m.__curve?m.__curve.getLength():Math.sqrt(["x","y","z"].map(function(X){return Math.pow((w[X]||0)-(b[X]||0),2)}).reduce(function(X,Y){return X+Y},0)),L=A+S+(C-A-M-S)*E,P=T(L/C),N=T((L-S)/C);["x","y","z"].forEach(function(X){return g.position[X]=N[X]});var F=l0(Qn.Vector3,No(["x","y","z"].map(function(X){return P[X]})));g.parent.localToWorld(F),g.lookAt(F)}}})}function o(){var u=Ln(n.linkDirectionalParticleSpeed);n.graphData.links.forEach(function(f){var v=f.__photonsObj&&f.__photonsObj.children,m=f.__singleHopPhotonsObj&&f.__singleHopPhotonsObj.children;if(!((!m||!m.length)&&(!v||!v.length))){var g=r?f:n.layout.getLinkPosition(n.layout.graph.getLink(f.source,f.target).id),y=g[r?"source":"from"],b=g[r?"target":"to"];if(!(!y||!b||!y.hasOwnProperty("x")||!b.hasOwnProperty("x"))){var w=u(f),A=f.__curve?function(S){return f.__curve.getPoint(S)}:function(S){var E=function(C,L,P,N){return L[C]+(P[C]-L[C])*N||0};return{x:E("x",y,b,S),y:E("y",y,b,S),z:E("z",y,b,S)}},M=[].concat(No(v||[]),No(m||[]));M.forEach(function(S,E){var T=S.parent.__linkThreeObjType==="singleHopPhotons";if(S.hasOwnProperty("__progressRatio")||(S.__progressRatio=T?0:E/v.length),S.__progressRatio+=w,S.__progressRatio>=1)if(!T)S.__progressRatio=S.__progressRatio%1;else{S.parent.remove(S),rR(S);return}var C=S.__progressRatio,L=A(C);["x","y","z"].forEach(function(P){return S.position[P]=L[P]})})}}})}},emitParticle:function(n,r){if(r){if(!r.__singleHopPhotonsObj){var a=new Qn.Group;a.__linkThreeObjType="singleHopPhotons",r.__singleHopPhotonsObj=a,n.graphScene.add(a)}var s=Ln(n.linkDirectionalParticleWidth),o=Math.ceil(s(r)*10)/10/2,u=n.linkDirectionalParticleResolution,f=new Qn.SphereBufferGeometry(o,u,u),v=Ln(n.linkColor),m=Ln(n.linkDirectionalParticleColor),g=m(r)||v(r)||"#f0f0f0",y=new Qn.Color(c0(g)),b=n.linkOpacity*3,w=new Qn.MeshLambertMaterial({color:y,transparent:!0,opacity:b});r.__singleHopPhotonsObj.add(new Qn.Mesh(f,w))}return this},getGraphBbox:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0};if(!n.initialised)return null;var a=function s(o){var u=[];if(o.geometry){o.geometry.computeBoundingBox();var f=new Qn.Box3;f.copy(o.geometry.boundingBox).applyMatrix4(o.matrixWorld),u.push(f)}return u.concat.apply(u,No((o.children||[]).filter(function(v){return!v.hasOwnProperty("__graphObjType")||v.__graphObjType==="node"&&r(v.__data)}).map(s)))}(n.graphScene);return a.length?Object.assign.apply(Object,No(["x","y","z"].map(function(s){return fw({},s,[F1(a,function(o){return o.min[s]}),k1(a,function(o){return o.max[s]})])}))):null}},stateInit:function(){return{d3ForceLayout:o3().force("link",n3()).force("charge",s3()).force("center",jC()).force("dagRadial",null).stop(),engineRunning:!1}},init:function(n,r){r.graphScene=n},update:function(n,r){var a=function(Le){return Le.some(function(Fe){return r.hasOwnProperty(Fe)})};if(n.engineRunning=!1,n.onUpdate(),n.nodeAutoColorBy!==null&&a(["nodeAutoColorBy","graphData","nodeColor"])&&aR(n.graphData.nodes,Ln(n.nodeAutoColorBy),n.nodeColor),n.linkAutoColorBy!==null&&a(["linkAutoColorBy","graphData","linkColor"])&&aR(n.graphData.links,Ln(n.linkAutoColorBy),n.linkColor),n._flushObjects||a(["graphData","nodeThreeObject","nodeThreeObjectExtend","nodeVal","nodeColor","nodeVisibility","nodeRelSize","nodeResolution","nodeOpacity"])){var s=Ln(n.nodeThreeObject),o=Ln(n.nodeThreeObjectExtend),u=Ln(n.nodeVal),f=Ln(n.nodeColor),v=Ln(n.nodeVisibility),m={},g={};gp(n.graphData.nodes.filter(v),n.graphScene,{purge:n._flushObjects||a(["nodeThreeObject","nodeThreeObjectExtend"]),objFilter:function(Le){return Le.__graphObjType==="node"},createObj:function(Le){var Fe=s(Le),Me=o(Le);Fe&&n.nodeThreeObject===Fe&&(Fe=Fe.clone());var Qe;return Fe&&!Me?Qe=Fe:(Qe=new Qn.Mesh,Qe.__graphDefaultObj=!0,Fe&&Me&&Qe.add(Fe)),Qe.__graphObjType="node",Qe},updateObj:function(Le,Fe){if(Le.__graphDefaultObj){var Me=u(Fe)||1,Qe=Math.cbrt(Me)*n.nodeRelSize,mt=n.nodeResolution;(!Le.geometry.type.match(/^Sphere(Buffer)?Geometry$/)||Le.geometry.parameters.radius!==Qe||Le.geometry.parameters.widthSegments!==mt)&&(m.hasOwnProperty(Me)||(m[Me]=new Qn.SphereBufferGeometry(Qe,mt,mt)),Le.geometry.dispose(),Le.geometry=m[Me]);var ht=f(Fe),ye=new Qn.Color(c0(ht||"#ffffaa")),fe=n.nodeOpacity*iR(ht);(Le.material.type!=="MeshLambertMaterial"||!Le.material.color.equals(ye)||Le.material.opacity!==fe)&&(g.hasOwnProperty(ht)||(g[ht]=new Qn.MeshLambertMaterial({color:ye,transparent:!0,opacity:fe})),Le.material.dispose(),Le.material=g[ht])}}})}if(n._flushObjects||a(["graphData","linkThreeObject","linkThreeObjectExtend","linkMaterial","linkColor","linkWidth","linkVisibility","linkResolution","linkOpacity","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution"])){var y=Ln(n.linkThreeObject),b=Ln(n.linkThreeObjectExtend),w=Ln(n.linkMaterial),A=Ln(n.linkVisibility),M=Ln(n.linkColor),S=Ln(n.linkWidth),E={},T={},C={},L=n.graphData.links.filter(A);if(gp(L,n.graphScene,{objBindAttr:"__lineObj",purge:n._flushObjects||a(["linkThreeObject","linkThreeObjectExtend","linkWidth"]),objFilter:function(Le){return Le.__graphObjType==="link"},createObj:function(Le){var Fe=y(Le),Me=b(Le);Fe&&n.linkThreeObject===Fe&&(Fe=Fe.clone());var Qe;if(!Fe||Me){var mt=!!S(Le);if(mt)Qe=new Qn.Mesh;else{var ht=new Qn.BufferGeometry;ht[sR]("position",new Qn.BufferAttribute(new Float32Array(2*3),3)),Qe=new Qn.Line(ht)}}var ye;return Fe?Me?(ye=new Qn.Group,ye.__graphDefaultObj=!0,ye.add(Qe),ye.add(Fe)):ye=Fe:(ye=Qe,ye.__graphDefaultObj=!0),ye.renderOrder=10,ye.__graphObjType="link",ye},updateObj:function(Le,Fe){if(Le.__graphDefaultObj){var Me=Le.children.length?Le.children[0]:Le,Qe=Math.ceil(S(Fe)*10)/10,mt=!!Qe;if(mt){var ht=Qe/2,ye=n.linkResolution;if(!Me.geometry.type.match(/^Cylinder(Buffer)?Geometry$/)||Me.geometry.parameters.radiusTop!==ht||Me.geometry.parameters.radialSegments!==ye){if(!E.hasOwnProperty(Qe)){var fe=new Qn.CylinderBufferGeometry(ht,ht,1,ye,1,!1);fe[u0](new Qn.Matrix4().makeTranslation(0,1/2,0)),fe[u0](new Qn.Matrix4().makeRotationX(Math.PI/2)),E[Qe]=fe}Me.geometry.dispose(),Me.geometry=E[Qe]}}var H=w(Fe);if(H)Me.material=H;else{var j=M(Fe),q=new Qn.Color(c0(j||"#f0f0f0")),pe=n.linkOpacity*iR(j),ee=mt?"MeshLambertMaterial":"LineBasicMaterial";if(Me.material.type!==ee||!Me.material.color.equals(q)||Me.material.opacity!==pe){var te=mt?T:C;te.hasOwnProperty(j)||(te[j]=new Qn[ee]({color:q,transparent:pe<1,opacity:pe,depthWrite:pe>=1})),Me.material.dispose(),Me.material=te[j]}}}}}),n.linkDirectionalArrowLength||r.hasOwnProperty("linkDirectionalArrowLength")){var P=Ln(n.linkDirectionalArrowLength),N=Ln(n.linkDirectionalArrowColor);gp(L.filter(P),n.graphScene,{objBindAttr:"__arrowObj",objFilter:function(Le){return Le.__linkThreeObjType==="arrow"},createObj:function(){var Le=new Qn.Mesh(void 0,new Qn.MeshLambertMaterial({transparent:!0}));return Le.__linkThreeObjType="arrow",Le},updateObj:function(Le,Fe){var Me=P(Fe),Qe=n.linkDirectionalArrowResolution;if(!Le.geometry.type.match(/^Cone(Buffer)?Geometry$/)||Le.geometry.parameters.height!==Me||Le.geometry.parameters.radialSegments!==Qe){var mt=new Qn.ConeBufferGeometry(Me*.25,Me,Qe);mt.translate(0,Me/2,0),mt.rotateX(Math.PI/2),Le.geometry.dispose(),Le.geometry=mt}Le.material.color=new Qn.Color(N(Fe)||M(Fe)||"#f0f0f0"),Le.material.opacity=n.linkOpacity*3}})}if(n.linkDirectionalParticles||r.hasOwnProperty("linkDirectionalParticles")){var F=Ln(n.linkDirectionalParticles),X=Ln(n.linkDirectionalParticleWidth),Y=Ln(n.linkDirectionalParticleColor),ae={},$={};gp(L.filter(F),n.graphScene,{objBindAttr:"__photonsObj",objFilter:function(Le){return Le.__linkThreeObjType==="photons"},createObj:function(){var Le=new Qn.Group;return Le.__linkThreeObjType="photons",Le},updateObj:function(Le,Fe){var Me=Math.round(Math.abs(F(Fe))),Qe=!!Le.children.length&&Le.children[0],mt=Math.ceil(X(Fe)*10)/10/2,ht=n.linkDirectionalParticleResolution,ye;Qe&&Qe.geometry.parameters.radius===mt&&Qe.geometry.parameters.widthSegments===ht?ye=Qe.geometry:($.hasOwnProperty(mt)||($[mt]=new Qn.SphereBufferGeometry(mt,ht,ht)),ye=$[mt],Qe&&Qe.geometry.dispose());var fe=Y(Fe)||M(Fe)||"#f0f0f0",H=new Qn.Color(c0(fe)),j=n.linkOpacity*3,q;Qe&&Qe.material.color.equals(H)&&Qe.material.opacity===j?q=Qe.material:(ae.hasOwnProperty(fe)||(ae[fe]=new Qn.MeshLambertMaterial({color:H,transparent:!0,opacity:j})),q=ae[fe],Qe&&Qe.material.dispose()),gp(No(new Array(Me)).map(function(pe,ee){return{idx:ee}}),Le,{idAccessor:function(ee){return ee.idx},createObj:function(){return new Qn.Mesh(ye,q)},updateObj:function(ee){ee.geometry=ye,ee.material=q}})}})}}if(n._flushObjects=!1,a(["graphData","nodeId","linkSource","linkTarget","numDimensions","forceEngine","dagMode","dagNodeFilter","dagLevelDistance"])){n.engineRunning=!1,n.graphData.links.forEach(function(Ve){Ve.source=Ve[n.linkSource],Ve.target=Ve[n.linkTarget]});var de=n.forceEngine!=="ngraph",D;if(de){(D=n.d3ForceLayout).stop().alpha(1).numDimensions(n.numDimensions).nodes(n.graphData.nodes);var I=n.d3ForceLayout.force("link");I&&I.id(function(Ve){return Ve[n.nodeId]}).links(n.graphData.links);var k=n.dagMode&&P$(n.graphData,function(Ve){return Ve[n.nodeId]},{nodeFilter:n.dagNodeFilter,onLoopError:n.onDagError||void 0}),U=Math.max.apply(Math,No(Object.values(k||[]))),W=n.dagLevelDistance||n.graphData.nodes.length/(U||1)*D$*(["radialin","radialout"].indexOf(n.dagMode)!==-1?.7:1);if(n.dagMode){var ce=function(Le,Fe){return function(Me){return Le?(k[Me[n.nodeId]]-U/2)*W*(Fe?-1:1):void 0}},oe=ce(["lr","rl"].indexOf(n.dagMode)!==-1,n.dagMode==="rl"),ge=ce(["td","bu"].indexOf(n.dagMode)!==-1,n.dagMode==="td"),_e=ce(["zin","zout"].indexOf(n.dagMode)!==-1,n.dagMode==="zout");n.graphData.nodes.filter(n.dagNodeFilter).forEach(function(Ve){Ve.fx=oe(Ve),Ve.fy=ge(Ve),Ve.fz=_e(Ve)})}n.d3ForceLayout.force("dagRadial",["radialin","radialout"].indexOf(n.dagMode)!==-1?l3(function(Ve){var Le=k[Ve[n.nodeId]]||-1;return(n.dagMode==="radialin"?U-Le:Le)*W}).strength(function(Ve){return n.dagNodeFilter(Ve)?1:0}):null)}else{var Ne=oR.graph();n.graphData.nodes.forEach(function(Ve){Ne.addNode(Ve[n.nodeId])}),n.graphData.links.forEach(function(Ve){Ne.addLink(Ve.source,Ve.target)}),D=oR.forcelayout(Ne,Q3({dimensions:n.numDimensions},n.ngraphPhysics)),D.graph=Ne}for(var Ie=0;Ie<n.warmupTicks&&!(de&&n.d3AlphaMin>0&&n.d3ForceLayout.alpha()<n.d3AlphaMin);Ie++)D[de?"tick":"step"]();n.layout=D,this.resetCountdown()}n.engineRunning=!0,n.onFinishUpdate()}});function I$(i){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Object,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=function(s){v$(u,s);var o=x$(u);function u(){var f;m$(this,u);for(var v=arguments.length,m=new Array(v),g=0;g<v;g++)m[g]=arguments[g];return f=o.call.apply(o,[this].concat(m)),f.__kapsuleInstance=i().apply(void 0,[].concat(No(r?[eR(f)]:[]),m)),f}return u}(n);return Object.keys(i()).forEach(function(s){return a.prototype[s]=function(){var o,u=(o=this.__kapsuleInstance)[s].apply(o,arguments);return u===this.__kapsuleInstance?this:u}}),a}var k$=window.THREE?window.THREE:{Group:Yc},pw=I$(O$,k$.Group,!0),F$=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:pw});const mw={type:"change"},vw={type:"start"},gw={type:"end"};class B$ extends uo{constructor(n,r){super();r===void 0&&console.warn('THREE.TrackballControls: The second parameter "domElement" is now mandatory.'),r===document&&console.error('THREE.TrackballControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.');const a=this,s={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=n,this.domElement=r,this.domElement.style.touchAction="none",this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:rs.ROTATE,MIDDLE:rs.DOLLY,RIGHT:rs.PAN},this.target=new Ze;const o=1e-6,u=new Ze;let f=1,v=s.NONE,m=s.NONE,g=0,y=0,b=0;const w=new Ze,A=new Wt,M=new Wt,S=new Ze,E=new Wt,T=new Wt,C=new Wt,L=new Wt,P=[],N={};this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom,this.handleResize=function(){const Me=a.domElement.getBoundingClientRect(),Qe=a.domElement.ownerDocument.documentElement;a.screen.left=Me.left+window.pageXOffset-Qe.clientLeft,a.screen.top=Me.top+window.pageYOffset-Qe.clientTop,a.screen.width=Me.width,a.screen.height=Me.height};const F=function(){const Me=new Wt;return function(mt,ht){return Me.set((mt-a.screen.left)/a.screen.width,(ht-a.screen.top)/a.screen.height),Me}}(),X=function(){const Me=new Wt;return function(mt,ht){return Me.set((mt-a.screen.width*.5-a.screen.left)/(a.screen.width*.5),(a.screen.height+2*(a.screen.top-ht))/a.screen.width),Me}}();this.rotateCamera=function(){const Me=new Ze,Qe=new Ui,mt=new Ze,ht=new Ze,ye=new Ze,fe=new Ze;return function(){fe.set(M.x-A.x,M.y-A.y,0);let j=fe.length();j?(w.copy(a.object.position).sub(a.target),mt.copy(w).normalize(),ht.copy(a.object.up).normalize(),ye.crossVectors(ht,mt).normalize(),ht.setLength(M.y-A.y),ye.setLength(M.x-A.x),fe.copy(ht.add(ye)),Me.crossVectors(fe,w).normalize(),j*=a.rotateSpeed,Qe.setFromAxisAngle(Me,j),w.applyQuaternion(Qe),a.object.up.applyQuaternion(Qe),S.copy(Me),b=j):!a.staticMoving&&b&&(b*=Math.sqrt(1-a.dynamicDampingFactor),w.copy(a.object.position).sub(a.target),Qe.setFromAxisAngle(S,b),w.applyQuaternion(Qe),a.object.up.applyQuaternion(Qe)),A.copy(M)}}(),this.zoomCamera=function(){let Me;v===s.TOUCH_ZOOM_PAN?(Me=g/y,g=y,a.object.isPerspectiveCamera?w.multiplyScalar(Me):a.object.isOrthographicCamera?(a.object.zoom/=Me,a.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(Me=1+(T.y-E.y)*a.zoomSpeed,Me!==1&&Me>0&&(a.object.isPerspectiveCamera?w.multiplyScalar(Me):a.object.isOrthographicCamera?(a.object.zoom/=Me,a.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),a.staticMoving?E.copy(T):E.y+=(T.y-E.y)*this.dynamicDampingFactor)},this.panCamera=function(){const Me=new Wt,Qe=new Ze,mt=new Ze;return function(){if(Me.copy(L).sub(C),Me.lengthSq()){if(a.object.isOrthographicCamera){const ye=(a.object.right-a.object.left)/a.object.zoom/a.domElement.clientWidth,fe=(a.object.top-a.object.bottom)/a.object.zoom/a.domElement.clientWidth;Me.x*=ye,Me.y*=fe}Me.multiplyScalar(w.length()*a.panSpeed),mt.copy(w).cross(a.object.up).setLength(Me.x),mt.add(Qe.copy(a.object.up).setLength(Me.y)),a.object.position.add(mt),a.target.add(mt),a.staticMoving?C.copy(L):C.add(Me.subVectors(L,C).multiplyScalar(a.dynamicDampingFactor))}}}(),this.checkDistances=function(){(!a.noZoom||!a.noPan)&&(w.lengthSq()>a.maxDistance*a.maxDistance&&(a.object.position.addVectors(a.target,w.setLength(a.maxDistance)),E.copy(T)),w.lengthSq()<a.minDistance*a.minDistance&&(a.object.position.addVectors(a.target,w.setLength(a.minDistance)),E.copy(T)))},this.update=function(){w.subVectors(a.object.position,a.target),a.noRotate||a.rotateCamera(),a.noZoom||a.zoomCamera(),a.noPan||a.panCamera(),a.object.position.addVectors(a.target,w),a.object.isPerspectiveCamera?(a.checkDistances(),a.object.lookAt(a.target),u.distanceToSquared(a.object.position)>o&&(a.dispatchEvent(mw),u.copy(a.object.position))):a.object.isOrthographicCamera?(a.object.lookAt(a.target),(u.distanceToSquared(a.object.position)>o||f!==a.object.zoom)&&(a.dispatchEvent(mw),u.copy(a.object.position),f=a.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type")},this.reset=function(){v=s.NONE,m=s.NONE,a.target.copy(a.target0),a.object.position.copy(a.position0),a.object.up.copy(a.up0),a.object.zoom=a.zoom0,a.object.updateProjectionMatrix(),w.subVectors(a.object.position,a.target),a.object.lookAt(a.target),a.dispatchEvent(mw),u.copy(a.object.position),f=a.object.zoom};function Y(Me){a.enabled!==!1&&(P.length===0&&(a.domElement.setPointerCapture(Me.pointerId),a.domElement.addEventListener("pointermove",ae),a.domElement.addEventListener("pointerup",$)),Ie(Me),Me.pointerType==="touch"?oe(Me):k(Me))}function ae(Me){a.enabled!==!1&&(Me.pointerType==="touch"?ge(Me):U(Me))}function $(Me){a.enabled!==!1&&(Me.pointerType==="touch"?_e(Me):W(),Ve(Me),P.length===0&&(a.domElement.releasePointerCapture(Me.pointerId),a.domElement.removeEventListener("pointermove",ae),a.domElement.removeEventListener("pointerup",$)))}function de(Me){Ve(Me)}function D(Me){a.enabled!==!1&&(window.removeEventListener("keydown",D),m===s.NONE&&(Me.code===a.keys[s.ROTATE]&&!a.noRotate?m=s.ROTATE:Me.code===a.keys[s.ZOOM]&&!a.noZoom?m=s.ZOOM:Me.code===a.keys[s.PAN]&&!a.noPan&&(m=s.PAN)))}function I(){a.enabled!==!1&&(m=s.NONE,window.addEventListener("keydown",D))}function k(Me){if(v===s.NONE)switch(Me.button){case a.mouseButtons.LEFT:v=s.ROTATE;break;case a.mouseButtons.MIDDLE:v=s.ZOOM;break;case a.mouseButtons.RIGHT:v=s.PAN;break;default:v=s.NONE}const Qe=m!==s.NONE?m:v;Qe===s.ROTATE&&!a.noRotate?(M.copy(X(Me.pageX,Me.pageY)),A.copy(M)):Qe===s.ZOOM&&!a.noZoom?(E.copy(F(Me.pageX,Me.pageY)),T.copy(E)):Qe===s.PAN&&!a.noPan&&(C.copy(F(Me.pageX,Me.pageY)),L.copy(C)),a.dispatchEvent(vw)}function U(Me){const Qe=m!==s.NONE?m:v;Qe===s.ROTATE&&!a.noRotate?(A.copy(M),M.copy(X(Me.pageX,Me.pageY))):Qe===s.ZOOM&&!a.noZoom?T.copy(F(Me.pageX,Me.pageY)):Qe===s.PAN&&!a.noPan&&L.copy(F(Me.pageX,Me.pageY))}function W(){v=s.NONE,a.dispatchEvent(gw)}function ce(Me){if(a.enabled!==!1&&a.noZoom!==!0){switch(Me.preventDefault(),Me.deltaMode){case 2:E.y-=Me.deltaY*.025;break;case 1:E.y-=Me.deltaY*.01;break;default:E.y-=Me.deltaY*25e-5;break}a.dispatchEvent(vw),a.dispatchEvent(gw)}}function oe(Me){switch(Le(Me),P.length){case 1:v=s.TOUCH_ROTATE,M.copy(X(P[0].pageX,P[0].pageY)),A.copy(M);break;default:v=s.TOUCH_ZOOM_PAN;const Qe=P[0].pageX-P[1].pageX,mt=P[0].pageY-P[1].pageY;y=g=Math.sqrt(Qe*Qe+mt*mt);const ht=(P[0].pageX+P[1].pageX)/2,ye=(P[0].pageY+P[1].pageY)/2;C.copy(F(ht,ye)),L.copy(C);break}a.dispatchEvent(vw)}function ge(Me){switch(Le(Me),P.length){case 1:A.copy(M),M.copy(X(Me.pageX,Me.pageY));break;default:const Qe=Fe(Me),mt=Me.pageX-Qe.x,ht=Me.pageY-Qe.y;y=Math.sqrt(mt*mt+ht*ht);const ye=(Me.pageX+Qe.x)/2,fe=(Me.pageY+Qe.y)/2;L.copy(F(ye,fe));break}}function _e(Me){switch(P.length){case 0:v=s.NONE;break;case 1:v=s.TOUCH_ROTATE,M.copy(X(Me.pageX,Me.pageY)),A.copy(M);break;case 2:v=s.TOUCH_ZOOM_PAN,M.copy(X(Me.pageX-A.pageX,Me.pageY-A.pageY)),A.copy(M);break}a.dispatchEvent(gw)}function Ne(Me){a.enabled!==!1&&Me.preventDefault()}function Ie(Me){P.push(Me)}function Ve(Me){delete N[Me.pointerId];for(let Qe=0;Qe<P.length;Qe++)if(P[Qe].pointerId==Me.pointerId){P.splice(Qe,1);return}}function Le(Me){let Qe=N[Me.pointerId];Qe===void 0&&(Qe=new Wt,N[Me.pointerId]=Qe),Qe.set(Me.pageX,Me.pageY)}function Fe(Me){const Qe=Me.pointerId===P[0].pointerId?P[1]:P[0];return N[Qe.pointerId]}this.dispose=function(){a.domElement.removeEventListener("contextmenu",Ne),a.domElement.removeEventListener("pointerdown",Y),a.domElement.removeEventListener("pointercancel",de),a.domElement.removeEventListener("wheel",ce),a.domElement.removeEventListener("pointermove",ae),a.domElement.removeEventListener("pointerup",$),window.removeEventListener("keydown",D),window.removeEventListener("keyup",I)},this.domElement.addEventListener("contextmenu",Ne),this.domElement.addEventListener("pointerdown",Y),this.domElement.addEventListener("pointercancel",de),this.domElement.addEventListener("wheel",ce,{passive:!1}),window.addEventListener("keydown",D),window.addEventListener("keyup",I),this.handleResize(),this.update()}}const lR={type:"change"},yw={type:"start"},bw={type:"end"};class N$ extends uo{constructor(n,r){super();r===void 0&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),r===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=n,this.domElement=r,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new Ze,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:rs.ROTATE,MIDDLE:rs.DOLLY,RIGHT:rs.PAN},this.touches={ONE:th.ROTATE,TWO:th.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return f.phi},this.getAzimuthalAngle=function(){return f.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(qe){qe.addEventListener("keydown",We),this._domElementKeyEvents=qe},this.saveState=function(){a.target0.copy(a.target),a.position0.copy(a.object.position),a.zoom0=a.object.zoom},this.reset=function(){a.target.copy(a.target0),a.object.position.copy(a.position0),a.object.zoom=a.zoom0,a.object.updateProjectionMatrix(),a.dispatchEvent(lR),a.update(),o=s.NONE},this.update=function(){const qe=new Ze,It=new Ui().setFromUnitVectors(n.up,new Ze(0,1,0)),rn=It.clone().invert(),Yt=new Ze,Tn=new Ui,Jt=2*Math.PI;return function(){const mr=a.object.position;qe.copy(mr).sub(a.target),qe.applyQuaternion(It),f.setFromVector3(qe),a.autoRotate&&o===s.NONE&&Y(F()),a.enableDamping?(f.theta+=v.theta*a.dampingFactor,f.phi+=v.phi*a.dampingFactor):(f.theta+=v.theta,f.phi+=v.phi);let fr=a.minAzimuthAngle,Dt=a.maxAzimuthAngle;return isFinite(fr)&&isFinite(Dt)&&(fr<-Math.PI?fr+=Jt:fr>Math.PI&&(fr-=Jt),Dt<-Math.PI?Dt+=Jt:Dt>Math.PI&&(Dt-=Jt),fr<=Dt?f.theta=Math.max(fr,Math.min(Dt,f.theta)):f.theta=f.theta>(fr+Dt)/2?Math.max(fr,f.theta):Math.min(Dt,f.theta)),f.phi=Math.max(a.minPolarAngle,Math.min(a.maxPolarAngle,f.phi)),f.makeSafe(),f.radius*=m,f.radius=Math.max(a.minDistance,Math.min(a.maxDistance,f.radius)),a.enableDamping===!0?a.target.addScaledVector(g,a.dampingFactor):a.target.add(g),qe.setFromSpherical(f),qe.applyQuaternion(rn),mr.copy(a.target).add(qe),a.object.lookAt(a.target),a.enableDamping===!0?(v.theta*=1-a.dampingFactor,v.phi*=1-a.dampingFactor,g.multiplyScalar(1-a.dampingFactor)):(v.set(0,0,0),g.set(0,0,0)),m=1,y||Yt.distanceToSquared(a.object.position)>u||8*(1-Tn.dot(a.object.quaternion))>u?(a.dispatchEvent(lR),Yt.copy(a.object.position),Tn.copy(a.object.quaternion),y=!1,!0):!1}}(),this.dispose=function(){a.domElement.removeEventListener("contextmenu",Ee),a.domElement.removeEventListener("pointerdown",j),a.domElement.removeEventListener("pointercancel",ee),a.domElement.removeEventListener("wheel",Be),a.domElement.removeEventListener("pointermove",q),a.domElement.removeEventListener("pointerup",pe),a._domElementKeyEvents!==null&&a._domElementKeyEvents.removeEventListener("keydown",We)};const a=this,s={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let o=s.NONE;const u=1e-6,f=new u1,v=new u1;let m=1;const g=new Ze;let y=!1;const b=new Wt,w=new Wt,A=new Wt,M=new Wt,S=new Wt,E=new Wt,T=new Wt,C=new Wt,L=new Wt,P=[],N={};function F(){return 2*Math.PI/60/60*a.autoRotateSpeed}function X(){return Math.pow(.95,a.zoomSpeed)}function Y(qe){v.theta-=qe}function ae(qe){v.phi-=qe}const $=function(){const qe=new Ze;return function(rn,Yt){qe.setFromMatrixColumn(Yt,0),qe.multiplyScalar(-rn),g.add(qe)}}(),de=function(){const qe=new Ze;return function(rn,Yt){a.screenSpacePanning===!0?qe.setFromMatrixColumn(Yt,1):(qe.setFromMatrixColumn(Yt,0),qe.crossVectors(a.object.up,qe)),qe.multiplyScalar(rn),g.add(qe)}}(),D=function(){const qe=new Ze;return function(rn,Yt){const Tn=a.domElement;if(a.object.isPerspectiveCamera){const Jt=a.object.position;qe.copy(Jt).sub(a.target);let Fn=qe.length();Fn*=Math.tan(a.object.fov/2*Math.PI/180),$(2*rn*Fn/Tn.clientHeight,a.object.matrix),de(2*Yt*Fn/Tn.clientHeight,a.object.matrix)}else a.object.isOrthographicCamera?($(rn*(a.object.right-a.object.left)/a.object.zoom/Tn.clientWidth,a.object.matrix),de(Yt*(a.object.top-a.object.bottom)/a.object.zoom/Tn.clientHeight,a.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),a.enablePan=!1)}}();function I(qe){a.object.isPerspectiveCamera?m/=qe:a.object.isOrthographicCamera?(a.object.zoom=Math.max(a.minZoom,Math.min(a.maxZoom,a.object.zoom*qe)),a.object.updateProjectionMatrix(),y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),a.enableZoom=!1)}function k(qe){a.object.isPerspectiveCamera?m*=qe:a.object.isOrthographicCamera?(a.object.zoom=Math.max(a.minZoom,Math.min(a.maxZoom,a.object.zoom/qe)),a.object.updateProjectionMatrix(),y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),a.enableZoom=!1)}function U(qe){b.set(qe.clientX,qe.clientY)}function W(qe){T.set(qe.clientX,qe.clientY)}function ce(qe){M.set(qe.clientX,qe.clientY)}function oe(qe){w.set(qe.clientX,qe.clientY),A.subVectors(w,b).multiplyScalar(a.rotateSpeed);const It=a.domElement;Y(2*Math.PI*A.x/It.clientHeight),ae(2*Math.PI*A.y/It.clientHeight),b.copy(w),a.update()}function ge(qe){C.set(qe.clientX,qe.clientY),L.subVectors(C,T),L.y>0?I(X()):L.y<0&&k(X()),T.copy(C),a.update()}function _e(qe){S.set(qe.clientX,qe.clientY),E.subVectors(S,M).multiplyScalar(a.panSpeed),D(E.x,E.y),M.copy(S),a.update()}function Ne(qe){qe.deltaY<0?k(X()):qe.deltaY>0&&I(X()),a.update()}function Ie(qe){let It=!1;switch(qe.code){case a.keys.UP:D(0,a.keyPanSpeed),It=!0;break;case a.keys.BOTTOM:D(0,-a.keyPanSpeed),It=!0;break;case a.keys.LEFT:D(a.keyPanSpeed,0),It=!0;break;case a.keys.RIGHT:D(-a.keyPanSpeed,0),It=!0;break}It&&(qe.preventDefault(),a.update())}function Ve(){if(P.length===1)b.set(P[0].pageX,P[0].pageY);else{const qe=.5*(P[0].pageX+P[1].pageX),It=.5*(P[0].pageY+P[1].pageY);b.set(qe,It)}}function Le(){if(P.length===1)M.set(P[0].pageX,P[0].pageY);else{const qe=.5*(P[0].pageX+P[1].pageX),It=.5*(P[0].pageY+P[1].pageY);M.set(qe,It)}}function Fe(){const qe=P[0].pageX-P[1].pageX,It=P[0].pageY-P[1].pageY,rn=Math.sqrt(qe*qe+It*It);T.set(0,rn)}function Me(){a.enableZoom&&Fe(),a.enablePan&&Le()}function Qe(){a.enableZoom&&Fe(),a.enableRotate&&Ve()}function mt(qe){if(P.length==1)w.set(qe.pageX,qe.pageY);else{const rn=Mt(qe),Yt=.5*(qe.pageX+rn.x),Tn=.5*(qe.pageY+rn.y);w.set(Yt,Tn)}A.subVectors(w,b).multiplyScalar(a.rotateSpeed);const It=a.domElement;Y(2*Math.PI*A.x/It.clientHeight),ae(2*Math.PI*A.y/It.clientHeight),b.copy(w)}function ht(qe){if(P.length===1)S.set(qe.pageX,qe.pageY);else{const It=Mt(qe),rn=.5*(qe.pageX+It.x),Yt=.5*(qe.pageY+It.y);S.set(rn,Yt)}E.subVectors(S,M).multiplyScalar(a.panSpeed),D(E.x,E.y),M.copy(S)}function ye(qe){const It=Mt(qe),rn=qe.pageX-It.x,Yt=qe.pageY-It.y,Tn=Math.sqrt(rn*rn+Yt*Yt);C.set(0,Tn),L.set(0,Math.pow(C.y/T.y,a.zoomSpeed)),I(L.y),T.copy(C)}function fe(qe){a.enableZoom&&ye(qe),a.enablePan&&ht(qe)}function H(qe){a.enableZoom&&ye(qe),a.enableRotate&&mt(qe)}function j(qe){a.enabled!==!1&&(P.length===0&&(a.domElement.setPointerCapture(qe.pointerId),a.domElement.addEventListener("pointermove",q),a.domElement.addEventListener("pointerup",pe)),xe(qe),qe.pointerType==="touch"?ve(qe):te(qe))}function q(qe){a.enabled!==!1&&(qe.pointerType==="touch"?K(qe):Se(qe))}function pe(qe){a.enabled!==!1&&(qe.pointerType==="touch"?J():ke(),Je(qe),P.length===0&&(a.domElement.releasePointerCapture(qe.pointerId),a.domElement.removeEventListener("pointermove",q),a.domElement.removeEventListener("pointerup",pe)))}function ee(qe){Je(qe)}function te(qe){let It;switch(qe.button){case 0:It=a.mouseButtons.LEFT;break;case 1:It=a.mouseButtons.MIDDLE;break;case 2:It=a.mouseButtons.RIGHT;break;default:It=-1}switch(It){case rs.DOLLY:if(a.enableZoom===!1)return;W(qe),o=s.DOLLY;break;case rs.ROTATE:if(qe.ctrlKey||qe.metaKey||qe.shiftKey){if(a.enablePan===!1)return;ce(qe),o=s.PAN}else{if(a.enableRotate===!1)return;U(qe),o=s.ROTATE}break;case rs.PAN:if(qe.ctrlKey||qe.metaKey||qe.shiftKey){if(a.enableRotate===!1)return;U(qe),o=s.ROTATE}else{if(a.enablePan===!1)return;ce(qe),o=s.PAN}break;default:o=s.NONE}o!==s.NONE&&a.dispatchEvent(yw)}function Se(qe){if(a.enabled!==!1)switch(o){case s.ROTATE:if(a.enableRotate===!1)return;oe(qe);break;case s.DOLLY:if(a.enableZoom===!1)return;ge(qe);break;case s.PAN:if(a.enablePan===!1)return;_e(qe);break}}function ke(qe){a.dispatchEvent(bw),o=s.NONE}function Be(qe){a.enabled===!1||a.enableZoom===!1||o!==s.NONE||(qe.preventDefault(),a.dispatchEvent(yw),Ne(qe),a.dispatchEvent(bw))}function We(qe){a.enabled===!1||a.enablePan===!1||Ie(qe)}function ve(qe){switch(Xe(qe),P.length){case 1:switch(a.touches.ONE){case th.ROTATE:if(a.enableRotate===!1)return;Ve(),o=s.TOUCH_ROTATE;break;case th.PAN:if(a.enablePan===!1)return;Le(),o=s.TOUCH_PAN;break;default:o=s.NONE}break;case 2:switch(a.touches.TWO){case th.DOLLY_PAN:if(a.enableZoom===!1&&a.enablePan===!1)return;Me(),o=s.TOUCH_DOLLY_PAN;break;case th.DOLLY_ROTATE:if(a.enableZoom===!1&&a.enableRotate===!1)return;Qe(),o=s.TOUCH_DOLLY_ROTATE;break;default:o=s.NONE}break;default:o=s.NONE}o!==s.NONE&&a.dispatchEvent(yw)}function K(qe){switch(Xe(qe),o){case s.TOUCH_ROTATE:if(a.enableRotate===!1)return;mt(qe),a.update();break;case s.TOUCH_PAN:if(a.enablePan===!1)return;ht(qe),a.update();break;case s.TOUCH_DOLLY_PAN:if(a.enableZoom===!1&&a.enablePan===!1)return;fe(qe),a.update();break;case s.TOUCH_DOLLY_ROTATE:if(a.enableZoom===!1&&a.enableRotate===!1)return;H(qe),a.update();break;default:o=s.NONE}}function J(qe){a.dispatchEvent(bw),o=s.NONE}function Ee(qe){a.enabled!==!1&&qe.preventDefault()}function xe(qe){P.push(qe)}function Je(qe){delete N[qe.pointerId];for(let It=0;It<P.length;It++)if(P[It].pointerId==qe.pointerId){P.splice(It,1);return}}function Xe(qe){let It=N[qe.pointerId];It===void 0&&(It=new Wt,N[qe.pointerId]=It),It.set(qe.pageX,qe.pageY)}function Mt(qe){const It=qe.pointerId===P[0].pointerId?P[1]:P[0];return N[It.pointerId]}a.domElement.addEventListener("contextmenu",Ee),a.domElement.addEventListener("pointerdown",j),a.domElement.addEventListener("pointercancel",ee),a.domElement.addEventListener("wheel",Be,{passive:!1}),this.update()}}const U$={type:"change"};class H$ extends uo{constructor(n,r){super();r===void 0&&(console.warn('THREE.FlyControls: The second parameter "domElement" is now mandatory.'),r=document),this.object=n,this.domElement=r,this.movementSpeed=1,this.rollSpeed=.005,this.dragToLook=!1,this.autoForward=!1;const a=this,s=1e-6,o=new Ui,u=new Ze;this.tmpQuaternion=new Ui,this.mouseStatus=0,this.moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0},this.moveVector=new Ze(0,0,0),this.rotationVector=new Ze(0,0,0),this.keydown=function(b){if(!b.altKey){switch(b.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=.1;break;case"KeyW":this.moveState.forward=1;break;case"KeyS":this.moveState.back=1;break;case"KeyA":this.moveState.left=1;break;case"KeyD":this.moveState.right=1;break;case"KeyR":this.moveState.up=1;break;case"KeyF":this.moveState.down=1;break;case"ArrowUp":this.moveState.pitchUp=1;break;case"ArrowDown":this.moveState.pitchDown=1;break;case"ArrowLeft":this.moveState.yawLeft=1;break;case"ArrowRight":this.moveState.yawRight=1;break;case"KeyQ":this.moveState.rollLeft=1;break;case"KeyE":this.moveState.rollRight=1;break}this.updateMovementVector(),this.updateRotationVector()}},this.keyup=function(b){switch(b.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=1;break;case"KeyW":this.moveState.forward=0;break;case"KeyS":this.moveState.back=0;break;case"KeyA":this.moveState.left=0;break;case"KeyD":this.moveState.right=0;break;case"KeyR":this.moveState.up=0;break;case"KeyF":this.moveState.down=0;break;case"ArrowUp":this.moveState.pitchUp=0;break;case"ArrowDown":this.moveState.pitchDown=0;break;case"ArrowLeft":this.moveState.yawLeft=0;break;case"ArrowRight":this.moveState.yawRight=0;break;case"KeyQ":this.moveState.rollLeft=0;break;case"KeyE":this.moveState.rollRight=0;break}this.updateMovementVector(),this.updateRotationVector()},this.mousedown=function(b){if(this.dragToLook)this.mouseStatus++;else{switch(b.button){case 0:this.moveState.forward=1;break;case 2:this.moveState.back=1;break}this.updateMovementVector()}},this.mousemove=function(b){if(!this.dragToLook||this.mouseStatus>0){const w=this.getContainerDimensions(),A=w.size[0]/2,M=w.size[1]/2;this.moveState.yawLeft=-(b.pageX-w.offset[0]-A)/A,this.moveState.pitchDown=(b.pageY-w.offset[1]-M)/M,this.updateRotationVector()}},this.mouseup=function(b){if(this.dragToLook)this.mouseStatus--,this.moveState.yawLeft=this.moveState.pitchDown=0;else{switch(b.button){case 0:this.moveState.forward=0;break;case 2:this.moveState.back=0;break}this.updateMovementVector()}this.updateRotationVector()},this.update=function(b){const w=b*a.movementSpeed,A=b*a.rollSpeed;a.object.translateX(a.moveVector.x*w),a.object.translateY(a.moveVector.y*w),a.object.translateZ(a.moveVector.z*w),a.tmpQuaternion.set(a.rotationVector.x*A,a.rotationVector.y*A,a.rotationVector.z*A,1).normalize(),a.object.quaternion.multiply(a.tmpQuaternion),(u.distanceToSquared(a.object.position)>s||8*(1-o.dot(a.object.quaternion))>s)&&(a.dispatchEvent(U$),o.copy(a.object.quaternion),u.copy(a.object.position))},this.updateMovementVector=function(){const b=this.moveState.forward||this.autoForward&&!this.moveState.back?1:0;this.moveVector.x=-this.moveState.left+this.moveState.right,this.moveVector.y=-this.moveState.down+this.moveState.up,this.moveVector.z=-b+this.moveState.back},this.updateRotationVector=function(){this.rotationVector.x=-this.moveState.pitchDown+this.moveState.pitchUp,this.rotationVector.y=-this.moveState.yawRight+this.moveState.yawLeft,this.rotationVector.z=-this.moveState.rollRight+this.moveState.rollLeft},this.getContainerDimensions=function(){return this.domElement!=document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}},this.dispose=function(){this.domElement.removeEventListener("contextmenu",cR),this.domElement.removeEventListener("mousedown",v),this.domElement.removeEventListener("mousemove",f),this.domElement.removeEventListener("mouseup",m),window.removeEventListener("keydown",g),window.removeEventListener("keyup",y)};const f=this.mousemove.bind(this),v=this.mousedown.bind(this),m=this.mouseup.bind(this),g=this.keydown.bind(this),y=this.keyup.bind(this);this.domElement.addEventListener("contextmenu",cR),this.domElement.addEventListener("mousemove",f),this.domElement.addEventListener("mousedown",v),this.domElement.addEventListener("mouseup",m),window.addEventListener("keydown",g),window.addEventListener("keyup",y),this.updateMovementVector(),this.updateRotationVector()}}function cR(i){i.preventDefault()}var uR={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = opacity * texel;

		}`};class h0{constructor(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}const z$=new Cd(-1,1,1,-1,0,1),xw=new Zr;xw.setAttribute("position",new Xr([-1,3,0,-1,-1,0,3,-1,0],3));xw.setAttribute("uv",new Xr([0,2,0,0,2,0],2));class G${constructor(n){this._mesh=new ra(xw,n)}dispose(){this._mesh.geometry.dispose()}render(n){n.render(this._mesh,z$)}get material(){return this._mesh.material}set material(n){this._mesh.material=n}}class hR extends h0{constructor(n,r){super();this.textureID=r!==void 0?r:"tDiffuse",n instanceof Us?(this.uniforms=n.uniforms,this.material=n):n&&(this.uniforms=tT.clone(n.uniforms),this.material=new Us({defines:Object.assign({},n.defines),uniforms:this.uniforms,vertexShader:n.vertexShader,fragmentShader:n.fragmentShader})),this.fsQuad=new G$(this.material)}render(n,r,a){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=a.texture),this.fsQuad.material=this.material,this.renderToScreen?(n.setRenderTarget(null),this.fsQuad.render(n)):(n.setRenderTarget(r),this.clear&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),this.fsQuad.render(n))}}class fR extends h0{constructor(n,r){super();this.scene=n,this.camera=r,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(n,r,a){const s=n.getContext(),o=n.state;o.buffers.color.setMask(!1),o.buffers.depth.setMask(!1),o.buffers.color.setLocked(!0),o.buffers.depth.setLocked(!0);let u,f;this.inverse?(u=0,f=1):(u=1,f=0),o.buffers.stencil.setTest(!0),o.buffers.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),o.buffers.stencil.setFunc(s.ALWAYS,u,4294967295),o.buffers.stencil.setClear(f),o.buffers.stencil.setLocked(!0),n.setRenderTarget(a),this.clear&&n.clear(),n.render(this.scene,this.camera),n.setRenderTarget(r),this.clear&&n.clear(),n.render(this.scene,this.camera),o.buffers.color.setLocked(!1),o.buffers.depth.setLocked(!1),o.buffers.stencil.setLocked(!1),o.buffers.stencil.setFunc(s.EQUAL,1,4294967295),o.buffers.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),o.buffers.stencil.setLocked(!0)}}class V$ extends h0{constructor(){super();this.needsSwap=!1}render(n){n.state.buffers.stencil.setLocked(!1),n.state.buffers.stencil.setTest(!1)}}class W${constructor(n,r){if(this.renderer=n,r===void 0){const a={minFilter:Ra,magFilter:Ra,format:ha},s=n.getSize(new Wt);this._pixelRatio=n.getPixelRatio(),this._width=s.width,this._height=s.height,r=new Do(this._width*this._pixelRatio,this._height*this._pixelRatio,a),r.texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=r.width,this._height=r.height;this.renderTarget1=r,this.renderTarget2=r.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],uR===void 0&&console.error("THREE.EffectComposer relies on CopyShader"),hR===void 0&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new hR(uR),this.clock=new P2}swapBuffers(){const n=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=n}addPass(n){this.passes.push(n),n.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(n,r){this.passes.splice(r,0,n),n.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(n){const r=this.passes.indexOf(n);r!==-1&&this.passes.splice(r,1)}isLastEnabledPass(n){for(let r=n+1;r<this.passes.length;r++)if(this.passes[r].enabled)return!1;return!0}render(n){n===void 0&&(n=this.clock.getDelta());const r=this.renderer.getRenderTarget();let a=!1;for(let s=0,o=this.passes.length;s<o;s++){const u=this.passes[s];if(u.enabled!==!1){if(u.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(s),u.render(this.renderer,this.writeBuffer,this.readBuffer,n,a),u.needsSwap){if(a){const f=this.renderer.getContext(),v=this.renderer.state.buffers.stencil;v.setFunc(f.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,n),v.setFunc(f.EQUAL,1,4294967295)}this.swapBuffers()}fR!==void 0&&(u instanceof fR?a=!0:u instanceof V$&&(a=!1))}}this.renderer.setRenderTarget(r)}reset(n){if(n===void 0){const r=this.renderer.getSize(new Wt);this._pixelRatio=this.renderer.getPixelRatio(),this._width=r.width,this._height=r.height,n=this.renderTarget1.clone(),n.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=n,this.renderTarget2=n.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(n,r){this._width=n,this._height=r;const a=this._width*this._pixelRatio,s=this._height*this._pixelRatio;this.renderTarget1.setSize(a,s),this.renderTarget2.setSize(a,s);for(let o=0;o<this.passes.length;o++)this.passes[o].setSize(a,s)}setPixelRatio(n){this._pixelRatio=n,this.setSize(this._width,this._height)}}new Cd(-1,1,1,-1,0,1);const dR=new Zr;dR.setAttribute("position",new Xr([-1,3,0,-1,-1,0,3,-1,0],3));dR.setAttribute("uv",new Xr([0,2,0,0,2,0],2));class j$ extends h0{constructor(n,r,a,s,o){super();this.scene=n,this.camera=r,this.overrideMaterial=a,this.clearColor=s,this.clearAlpha=o!==void 0?o:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new On}render(n,r,a){const s=n.autoClear;n.autoClear=!1;let o,u;this.overrideMaterial!==void 0&&(u=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(n.getClearColor(this._oldClearColor),o=n.getClearAlpha(),n.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&n.clearDepth(),n.setRenderTarget(this.renderToScreen?null:a),this.clear&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),n.render(this.scene,this.camera),this.clearColor&&n.setClearColor(this._oldClearColor,o),this.overrideMaterial!==void 0&&(this.scene.overrideMaterial=u),n.autoClear=s}}function ww(){return ww=Object.assign||function(i){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(i[a]=r[a])}return i},ww.apply(this,arguments)}function X$(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function yp(i,n){return yp=Object.setPrototypeOf||function(a,s){return a.__proto__=s,a},yp(i,n)}function q$(i,n){i.prototype=Object.create(n.prototype),i.prototype.constructor=i,yp(i,n)}function Aw(i){return Aw=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)},Aw(i)}function Y$(i){return Function.toString.call(i).indexOf("[native code]")!==-1}function $$(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function f0(i,n,r){return $$()?f0=Reflect.construct:f0=function(s,o,u){var f=[null];f.push.apply(f,o);var v=Function.bind.apply(s,f),m=new v;return u&&yp(m,u.prototype),m},f0.apply(null,arguments)}function Ew(i){var n=typeof Map=="function"?new Map:void 0;return Ew=function(a){if(a===null||!Y$(a))return a;if(typeof a!="function")throw new TypeError("Super expression must either be null or a function");if(typeof n!="undefined"){if(n.has(a))return n.get(a);n.set(a,s)}function s(){return f0(a,arguments,Aw(this).constructor)}return s.prototype=Object.create(a.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),yp(s,a)},Ew(i)}var Zh=function(i){q$(n,i);function n(r){var a;return a=i.call(this,"An error occurred. See https://github.com/styled-components/polished/blob/main/src/internalHelpers/errors.md#"+r+" for more information.")||this,X$(a)}return n}(Ew(Error));function _w(i){return Math.round(i*255)}function K$(i,n,r){return _w(i)+","+_w(n)+","+_w(r)}function pR(i,n,r,a){if(a===void 0&&(a=K$),n===0)return a(r,r,r);var s=(i%360+360)%360/60,o=(1-Math.abs(2*r-1))*n,u=o*(1-Math.abs(s%2-1)),f=0,v=0,m=0;s>=0&&s<1?(f=o,v=u):s>=1&&s<2?(f=u,v=o):s>=2&&s<3?(v=o,m=u):s>=3&&s<4?(v=u,m=o):s>=4&&s<5?(f=u,m=o):s>=5&&s<6&&(f=o,m=u);var g=r-o/2,y=f+g,b=v+g,w=m+g;return a(y,b,w)}var mR={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};function Z$(i){if(typeof i!="string")return i;var n=i.toLowerCase();return mR[n]?"#"+mR[n]:i}var Q$=/^#[a-fA-F0-9]{6}$/,J$=/^#[a-fA-F0-9]{8}$/,eK=/^#[a-fA-F0-9]{3}$/,tK=/^#[a-fA-F0-9]{4}$/,Mw=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/i,nK=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([-+]?[0-9]*[.]?[0-9]+)\s*\)$/i,rK=/^hsl\(\s*(\d{0,3}[.]?[0-9]+)\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*\)$/i,iK=/^hsla\(\s*(\d{0,3}[.]?[0-9]+)\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*,\s*([-+]?[0-9]*[.]?[0-9]+)\s*\)$/i;function Sw(i){if(typeof i!="string")throw new Zh(3);var n=Z$(i);if(n.match(Q$))return{red:parseInt(""+n[1]+n[2],16),green:parseInt(""+n[3]+n[4],16),blue:parseInt(""+n[5]+n[6],16)};if(n.match(J$)){var r=parseFloat((parseInt(""+n[7]+n[8],16)/255).toFixed(2));return{red:parseInt(""+n[1]+n[2],16),green:parseInt(""+n[3]+n[4],16),blue:parseInt(""+n[5]+n[6],16),alpha:r}}if(n.match(eK))return{red:parseInt(""+n[1]+n[1],16),green:parseInt(""+n[2]+n[2],16),blue:parseInt(""+n[3]+n[3],16)};if(n.match(tK)){var a=parseFloat((parseInt(""+n[4]+n[4],16)/255).toFixed(2));return{red:parseInt(""+n[1]+n[1],16),green:parseInt(""+n[2]+n[2],16),blue:parseInt(""+n[3]+n[3],16),alpha:a}}var s=Mw.exec(n);if(s)return{red:parseInt(""+s[1],10),green:parseInt(""+s[2],10),blue:parseInt(""+s[3],10)};var o=nK.exec(n.substring(0,50));if(o)return{red:parseInt(""+o[1],10),green:parseInt(""+o[2],10),blue:parseInt(""+o[3],10),alpha:parseFloat(""+o[4])};var u=rK.exec(n);if(u){var f=parseInt(""+u[1],10),v=parseInt(""+u[2],10)/100,m=parseInt(""+u[3],10)/100,g="rgb("+pR(f,v,m)+")",y=Mw.exec(g);if(!y)throw new Zh(4,n,g);return{red:parseInt(""+y[1],10),green:parseInt(""+y[2],10),blue:parseInt(""+y[3],10)}}var b=iK.exec(n.substring(0,50));if(b){var w=parseInt(""+b[1],10),A=parseInt(""+b[2],10)/100,M=parseInt(""+b[3],10)/100,S="rgb("+pR(w,A,M)+")",E=Mw.exec(S);if(!E)throw new Zh(4,n,S);return{red:parseInt(""+E[1],10),green:parseInt(""+E[2],10),blue:parseInt(""+E[3],10),alpha:parseFloat(""+b[4])}}throw new Zh(5)}var vR=function(n){return n.length===7&&n[1]===n[2]&&n[3]===n[4]&&n[5]===n[6]?"#"+n[1]+n[3]+n[5]:n};function Qh(i){var n=i.toString(16);return n.length===1?"0"+n:n}function gR(i,n,r){if(typeof i=="number"&&typeof n=="number"&&typeof r=="number")return vR("#"+Qh(i)+Qh(n)+Qh(r));if(typeof i=="object"&&n===void 0&&r===void 0)return vR("#"+Qh(i.red)+Qh(i.green)+Qh(i.blue));throw new Zh(6)}function aK(i,n,r,a){if(typeof i=="string"&&typeof n=="number"){var s=Sw(i);return"rgba("+s.red+","+s.green+","+s.blue+","+n+")"}else{if(typeof i=="number"&&typeof n=="number"&&typeof r=="number"&&typeof a=="number")return a>=1?gR(i,n,r):"rgba("+i+","+n+","+r+","+a+")";if(typeof i=="object"&&n===void 0&&r===void 0&&a===void 0)return i.alpha>=1?gR(i.red,i.green,i.blue):"rgba("+i.red+","+i.green+","+i.blue+","+i.alpha+")"}throw new Zh(7)}function yR(i,n,r){return function(){var s=r.concat(Array.prototype.slice.call(arguments));return s.length>=n?i.apply(this,s):yR(i,n,s)}}function oK(i){return yR(i,i.length,[])}function sK(i,n,r){return Math.max(i,Math.min(n,r))}function lK(i,n){if(n==="transparent")return n;var r=Sw(n),a=typeof r.alpha=="number"?r.alpha:1,s=ww({},r,{alpha:sK(0,1,(a*100+parseFloat(i)*100)/100)});return aK(s)}var cK=oK(lK);function uK(i,n){n===void 0&&(n={});var r=n.insertAt;if(!(!i||typeof document=="undefined")){var a=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",r==="top"&&a.firstChild?a.insertBefore(s,a.firstChild):a.appendChild(s),s.styleSheet?s.styleSheet.cssText=i:s.appendChild(document.createTextNode(i))}}var hK=`.scene-nav-info {
  bottom: 5px;
  width: 100%;
  text-align: center;
  color: slategrey;
  opacity: 0.7;
  font-size: 10px;
}

.scene-tooltip {
  color: lavender;
  font-size: 15px;
}

.scene-nav-info, .scene-tooltip {
  position: absolute;
  font-family: sans-serif;
  pointer-events: none;
}

.scene-container canvas:focus {
  outline: none;
}`;uK(hK);function fK(i,n,r){return n in i?Object.defineProperty(i,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):i[n]=r,i}function dK(i,n){return mK(i)||gK(i,n)||bR(i,n)||bK()}function bp(i){return pK(i)||vK(i)||bR(i)||yK()}function pK(i){if(Array.isArray(i))return Tw(i)}function mK(i){if(Array.isArray(i))return i}function vK(i){if(typeof Symbol!="undefined"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function gK(i,n){var r=i==null?null:typeof Symbol!="undefined"&&i[Symbol.iterator]||i["@@iterator"];if(r!=null){var a=[],s=!0,o=!1,u,f;try{for(r=r.call(i);!(s=(u=r.next()).done)&&(a.push(u.value),!(n&&a.length===n));s=!0);}catch(v){o=!0,f=v}finally{try{!s&&r.return!=null&&r.return()}finally{if(o)throw f}}return a}}function bR(i,n){if(!!i){if(typeof i=="string")return Tw(i,n);var r=Object.prototype.toString.call(i).slice(8,-1);if(r==="Object"&&i.constructor&&(r=i.constructor.name),r==="Map"||r==="Set")return Array.from(i);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Tw(i,n)}}function Tw(i,n){(n==null||n>i.length)&&(n=i.length);for(var r=0,a=new Array(n);r<n;r++)a[r]=i[r];return a}function yK(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bK(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var _i=window.THREE?window.THREE:{WebGLRenderer:ti,Scene:Fx,PerspectiveCamera:La,Raycaster:O2,TextureLoader:x2,Vector2:Wt,Vector3:Ze,Box3:Ja,Color:On,Mesh:ra,SphereGeometry:Sg,MeshBasicMaterial:Yv,BackSide:Ni,EventDispatcher:uo,MOUSE:rs,Quaternion:Ui,Spherical:u1,Clock:P2},xR=Zc({props:{width:{default:window.innerWidth,onChange:function(n,r,a){isNaN(n)&&(r.width=a)}},height:{default:window.innerHeight,onChange:function(n,r,a){isNaN(n)&&(r.height=a)}},backgroundColor:{default:"#000011"},backgroundImageUrl:{},onBackgroundImageLoaded:{},showNavInfo:{default:!0},skyRadius:{default:5e4},objects:{default:[]},enablePointerInteraction:{default:!0,onChange:function(n,r){r.hoverObj=null,r.toolTipElem&&(r.toolTipElem.innerHTML="")},triggerUpdate:!1},lineHoverPrecision:{default:1,triggerUpdate:!1},hoverOrderComparator:{default:function(){return-1},triggerUpdate:!1},hoverFilter:{default:function(){return!0},triggerUpdate:!1},tooltipContent:{triggerUpdate:!1},hoverDuringDrag:{default:!1,triggerUpdate:!1},clickAfterDrag:{default:!1,triggerUpdate:!1},onHover:{default:function(){},triggerUpdate:!1},onClick:{default:function(){},triggerUpdate:!1},onRightClick:{triggerUpdate:!1}},methods:{tick:function(n){if(n.initialised){if(n.controls.update&&n.controls.update(n.clock.getDelta()),n.postProcessingComposer?n.postProcessingComposer.render():n.renderer.render(n.scene,n.camera),n.extraRenderers.forEach(function(o){return o.render(n.scene,n.camera)}),n.enablePointerInteraction){var r=null;if(n.hoverDuringDrag||!n.isPointerDragging){var a=this.intersectingObjects(n.pointerPos.x,n.pointerPos.y).filter(function(o){return n.hoverFilter(o.object)}).sort(function(o,u){return n.hoverOrderComparator(o.object,u.object)}),s=a.length?a[0]:null;r=s?s.object:null,n.intersectionPoint=s?s.point:null}r!==n.hoverObj&&(n.onHover(r,n.hoverObj),n.toolTipElem.innerHTML=r&&Ln(n.tooltipContent)(r)||"",n.hoverObj=r)}ms.update()}return this},getPointerPos:function(n){var r=n.pointerPos,a=r.x,s=r.y;return{x:a,y:s}},cameraPosition:function(n,r,a,s){var o=n.camera;if(r&&n.initialised){var u=r,f=a||{x:0,y:0,z:0};if(!s)g(u),y(f);else{var v=Object.assign({},o.position),m=b();new ms.Tween(v).to(u,s).easing(ms.Easing.Quadratic.Out).onUpdate(g).start(),new ms.Tween(m).to(f,s/3).easing(ms.Easing.Quadratic.Out).onUpdate(y).start()}return this}return Object.assign({},o.position,{lookAt:b()});function g(w){var A=w.x,M=w.y,S=w.z;A!==void 0&&(o.position.x=A),M!==void 0&&(o.position.y=M),S!==void 0&&(o.position.z=S)}function y(w){n.controls.target=new _i.Vector3(w.x,w.y,w.z)}function b(){return Object.assign(new _i.Vector3(0,0,-1e3).applyQuaternion(o.quaternion).add(o.position))}},zoomToFit:function(n){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,s=arguments.length,o=new Array(s>3?s-3:0),u=3;u<s;u++)o[u-3]=arguments[u];return this.fitToBbox(this.getBbox.apply(this,o),r,a)},fitToBbox:function(n,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:10,o=n.camera;if(r){var u=new _i.Vector3(0,0,0),f=Math.max.apply(Math,bp(Object.entries(r).map(function(w){var A=dK(w,2),M=A[0],S=A[1];return Math.max.apply(Math,bp(S.map(function(E){return Math.abs(u[M]-E)})))})))*2,v=(1-s*2/n.height)*o.fov,m=f/Math.atan(v*Math.PI/180),g=m/o.aspect,y=Math.max(m,g);if(y>0){var b=u.clone().sub(o.position).normalize().multiplyScalar(-y);this.cameraPosition(b,u,a)}}return this},getBbox:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0},a=new _i.Box3(new _i.Vector3(0,0,0),new _i.Vector3(0,0,0)),s=n.objects.filter(r);return s.length?(s.forEach(function(o){return a.expandByObject(o)}),Object.assign.apply(Object,bp(["x","y","z"].map(function(o){return fK({},o,[a.min[o],a.max[o]])})))):null},getScreenCoords:function(n,r,a,s){var o=new _i.Vector3(r,a,s);return o.project(this.camera()),{x:(o.x+1)*n.width/2,y:-(o.y-1)*n.height/2}},getSceneCoords:function(n,r,a){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=new _i.Vector2(r/n.width*2-1,-(a/n.height)*2+1),u=new _i.Raycaster;return u.setFromCamera(o,n.camera),Object.assign({},u.ray.at(s,new _i.Vector3))},intersectingObjects:function(n,r,a){var s=new _i.Vector2(r/n.width*2-1,-(a/n.height)*2+1),o=new _i.Raycaster;return o.params.Line.threshold=n.lineHoverPrecision,o.setFromCamera(s,n.camera),o.intersectObjects(n.objects,!0)},renderer:function(n){return n.renderer},scene:function(n){return n.scene},camera:function(n){return n.camera},postProcessingComposer:function(n){return n.postProcessingComposer},controls:function(n){return n.controls},tbControls:function(n){return n.controls}},stateInit:function(){return{scene:new _i.Scene,camera:new _i.PerspectiveCamera,clock:new _i.Clock}},init:function(n,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=a.controlType,o=s===void 0?"trackball":s,u=a.rendererConfig,f=u===void 0?{}:u,v=a.extraRenderers,m=v===void 0?[]:v,g=a.waitForLoadComplete,y=g===void 0?!0:g;n.innerHTML="",n.appendChild(r.container=document.createElement("div")),r.container.className="scene-container",r.container.style.position="relative",r.container.appendChild(r.navInfo=document.createElement("div")),r.navInfo.className="scene-nav-info",r.navInfo.textContent={orbit:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",trackball:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",fly:"WASD: move, R|F: up | down, Q|E: roll, up|down: pitch, left|right: yaw"}[o]||"",r.navInfo.style.display=r.showNavInfo?null:"none",r.toolTipElem=document.createElement("div"),r.toolTipElem.classList.add("scene-tooltip"),r.container.appendChild(r.toolTipElem),r.pointerPos=new _i.Vector2,r.pointerPos.x=-2,r.pointerPos.y=-2,["pointermove","pointerdown"].forEach(function(b){return r.container.addEventListener(b,function(w){if(b==="pointerdown"&&(r.isPointerPressed=!0),!r.isPointerDragging&&w.type==="pointermove"&&(w.pressure>0||r.isPointerPressed)&&(w.pointerType!=="touch"||w.movementX===void 0||[w.movementX,w.movementY].some(function(S){return Math.abs(S)>1}))&&(r.isPointerDragging=!0),r.enablePointerInteraction){var A=M(r.container);r.pointerPos.x=w.pageX-A.left,r.pointerPos.y=w.pageY-A.top,r.toolTipElem.style.top="".concat(r.pointerPos.y,"px"),r.toolTipElem.style.left="".concat(r.pointerPos.x,"px"),r.toolTipElem.style.transform="translate(-".concat(r.pointerPos.x/r.width*100,"%, 21px)")}function M(S){var E=S.getBoundingClientRect(),T=window.pageXOffset||document.documentElement.scrollLeft,C=window.pageYOffset||document.documentElement.scrollTop;return{top:E.top+C,left:E.left+T}}},{passive:!0})}),r.container.addEventListener("pointerup",function(b){r.isPointerPressed=!1,!(r.isPointerDragging&&(r.isPointerDragging=!1,!r.clickAfterDrag))&&requestAnimationFrame(function(){b.button===0&&r.onClick(r.hoverObj||null,b,r.intersectionPoint),b.button===2&&r.onRightClick&&r.onRightClick(r.hoverObj||null,b,r.intersectionPoint)})},{passive:!0,capture:!0}),r.container.addEventListener("contextmenu",function(b){r.onRightClick&&b.preventDefault()}),r.renderer=new _i.WebGLRenderer(Object.assign({antialias:!0,alpha:!0},f)),r.renderer.setPixelRatio(Math.min(2,window.devicePixelRatio)),r.container.appendChild(r.renderer.domElement),r.extraRenderers=m,r.extraRenderers.forEach(function(b){b.domElement.style.position="absolute",b.domElement.style.top="0px",b.domElement.style.pointerEvents="none",r.container.appendChild(b.domElement)}),r.postProcessingComposer=new W$(r.renderer),r.postProcessingComposer.addPass(new j$(r.scene,r.camera)),r.controls=new{trackball:B$,orbit:N$,fly:H$}[o](r.camera,r.renderer.domElement),o==="fly"&&(r.controls.movementSpeed=300,r.controls.rollSpeed=Math.PI/6,r.controls.dragToLook=!0),(o==="trackball"||o==="orbit")&&(r.controls.minDistance=.1,r.controls.maxDistance=r.skyRadius,r.controls.addEventListener("start",function(){r.controlsEngaged=!0}),r.controls.addEventListener("change",function(){r.controlsEngaged&&(r.controlsDragging=!0)}),r.controls.addEventListener("end",function(){r.controlsEngaged=!1,r.controlsDragging=!1})),[r.renderer,r.postProcessingComposer].concat(bp(r.extraRenderers)).forEach(function(b){return b.setSize(r.width,r.height)}),r.camera.aspect=r.width/r.height,r.camera.updateProjectionMatrix(),r.camera.position.z=1e3,r.scene.add(r.skysphere=new _i.Mesh),r.skysphere.visible=!1,r.loadComplete=r.scene.visible=!y,window.scene=r.scene},update:function(n,r){if(n.width&&n.height&&(r.hasOwnProperty("width")||r.hasOwnProperty("height"))&&(n.container.style.width=n.width,n.container.style.height=n.height,[n.renderer,n.postProcessingComposer].concat(bp(n.extraRenderers)).forEach(function(o){return o.setSize(n.width,n.height)}),n.camera.aspect=n.width/n.height,n.camera.updateProjectionMatrix()),r.hasOwnProperty("skyRadius")&&n.skyRadius&&(n.controls.hasOwnProperty("maxDistance")&&r.skyRadius&&(n.controls.maxDistance=n.skyRadius),n.camera.far=n.skyRadius*2.5,n.camera.updateProjectionMatrix(),n.skysphere.geometry=new _i.SphereGeometry(n.skyRadius)),r.hasOwnProperty("backgroundColor")){var a=Sw(n.backgroundColor).alpha;a===void 0&&(a=1),n.renderer.setClearColor(new _i.Color(cK(1,n.backgroundColor)),a)}r.hasOwnProperty("backgroundImageUrl")&&(n.backgroundImageUrl?new _i.TextureLoader().load(n.backgroundImageUrl,function(o){n.skysphere.material=new _i.MeshBasicMaterial({map:o,side:_i.BackSide}),n.skysphere.visible=!0,n.onBackgroundImageLoaded&&setTimeout(n.onBackgroundImageLoaded),!n.loadComplete&&s()}):(n.skysphere.visible=!1,n.skysphere.material.map=null,!n.loadComplete&&s())),r.hasOwnProperty("showNavInfo")&&(n.navInfo.style.display=n.showNavInfo?null:"none"),r.hasOwnProperty("objects")&&((r.objects||[]).forEach(function(o){return n.scene.remove(o)}),n.objects.forEach(function(o){return n.scene.add(o)}));function s(){n.loadComplete=n.scene.visible=!0}}});function xK(i,n){n===void 0&&(n={});var r=n.insertAt;if(!(!i||typeof document=="undefined")){var a=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",r==="top"&&a.firstChild?a.insertBefore(s,a.firstChild):a.appendChild(s),s.styleSheet?s.styleSheet.cssText=i:s.appendChild(document.createTextNode(i))}}var wK=`.graph-info-msg {
  top: 50%;
  width: 100%;
  text-align: center;
  color: lavender;
  opacity: 0.7;
  font-size: 22px;
  position: absolute;
  font-family: Sans-serif;
}

.scene-container .clickable {
  cursor: pointer;
}

.scene-container .grabbable {
  cursor: move;
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

.scene-container .grabbable:active {
  cursor: grabbing;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
}`;xK(wK);function wR(i,n){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);n&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(i,s).enumerable})),r.push.apply(r,a)}return r}function d0(i){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?wR(Object(r),!0).forEach(function(a){xp(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):wR(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}function xp(i,n,r){return n in i?Object.defineProperty(i,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):i[n]=r,i}function p0(i){return AK(i)||EK(i)||_K(i)||MK()}function AK(i){if(Array.isArray(i))return Cw(i)}function EK(i){if(typeof Symbol!="undefined"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function _K(i,n){if(!!i){if(typeof i=="string")return Cw(i,n);var r=Object.prototype.toString.call(i).slice(8,-1);if(r==="Object"&&i.constructor&&(r=i.constructor.name),r==="Map"||r==="Set")return Array.from(i);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Cw(i,n)}}function Cw(i,n){(n==null||n>i.length)&&(n=i.length);for(var r=0,a=new Array(n);r<n;r++)a[r]=i[r];return a}function MK(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AR(i,n){var r=new n;return{linkProp:function(s){return{default:r[s](),onChange:function(u,f){f[i][s](u)},triggerUpdate:!1}},linkMethod:function(s){return function(o){for(var u=o[i],f=arguments.length,v=new Array(f>1?f-1:0),m=1;m<f;m++)v[m-1]=arguments[m];var g=u[s].apply(u,v);return g===u?this:g}}}}var ER=window.THREE?window.THREE:{AmbientLight:R2,DirectionalLight:C2,Vector3:Ze},SK=170,_R=AR("forceGraph",pw),TK=Object.assign.apply(Object,p0(["jsonUrl","graphData","numDimensions","dagMode","dagLevelDistance","dagNodeFilter","onDagError","nodeRelSize","nodeId","nodeVal","nodeResolution","nodeColor","nodeAutoColorBy","nodeOpacity","nodeVisibility","nodeThreeObject","nodeThreeObjectExtend","linkSource","linkTarget","linkVisibility","linkColor","linkAutoColorBy","linkOpacity","linkWidth","linkResolution","linkCurvature","linkCurveRotation","linkMaterial","linkThreeObject","linkThreeObjectExtend","linkPositionUpdate","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution","forceEngine","d3AlphaDecay","d3VelocityDecay","d3AlphaMin","ngraphPhysics","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"].map(function(i){return xp({},i,_R.linkProp(i))}))),CK=Object.assign.apply(Object,p0(["refresh","getGraphBbox","d3Force","d3ReheatSimulation","emitParticle"].map(function(i){return xp({},i,_R.linkMethod(i))}))),m0=AR("renderObjs",xR),RK=Object.assign.apply(Object,p0(["width","height","backgroundColor","showNavInfo","enablePointerInteraction"].map(function(i){return xp({},i,m0.linkProp(i))}))),LK=Object.assign.apply(Object,p0(["cameraPosition","postProcessingComposer"].map(function(i){return xp({},i,m0.linkMethod(i))})).concat([{graph2ScreenCoords:m0.linkMethod("getScreenCoords"),screen2GraphCoords:m0.linkMethod("getSceneCoords")}])),PK=Zc({props:d0(d0({nodeLabel:{default:"name",triggerUpdate:!1},linkLabel:{default:"name",triggerUpdate:!1},linkHoverPrecision:{default:1,onChange:function(n,r){return r.renderObjs.lineHoverPrecision(n)},triggerUpdate:!1},enableNavigationControls:{default:!0,onChange:function(n,r){var a=r.renderObjs.controls();a&&(a.enabled=n)},triggerUpdate:!1},enableNodeDrag:{default:!0,triggerUpdate:!1},onNodeDrag:{default:function(){},triggerUpdate:!1},onNodeDragEnd:{default:function(){},triggerUpdate:!1},onNodeClick:{triggerUpdate:!1},onNodeRightClick:{triggerUpdate:!1},onNodeHover:{triggerUpdate:!1},onLinkClick:{triggerUpdate:!1},onLinkRightClick:{triggerUpdate:!1},onLinkHover:{triggerUpdate:!1},onBackgroundClick:{triggerUpdate:!1},onBackgroundRightClick:{triggerUpdate:!1}},TK),RK),methods:d0(d0({zoomToFit:function(n,r,a){for(var s,o=arguments.length,u=new Array(o>3?o-3:0),f=3;f<o;f++)u[f-3]=arguments[f];return n.renderObjs.fitToBbox((s=n.forceGraph).getGraphBbox.apply(s,u),r,a),this},pauseAnimation:function(n){return n.animationFrameRequestId!==null&&(cancelAnimationFrame(n.animationFrameRequestId),n.animationFrameRequestId=null),this},resumeAnimation:function(n){return n.animationFrameRequestId===null&&this._animationCycle(),this},_animationCycle:function(n){n.enablePointerInteraction&&(this.renderer().domElement.style.cursor=null),n.forceGraph.tickFrame(),n.renderObjs.tick(),n.animationFrameRequestId=requestAnimationFrame(this._animationCycle)},scene:function(n){return n.renderObjs.scene()},camera:function(n){return n.renderObjs.camera()},renderer:function(n){return n.renderObjs.renderer()},controls:function(n){return n.renderObjs.controls()},tbControls:function(n){return n.renderObjs.tbControls()},_destructor:function(){this.pauseAnimation(),this.graphData({nodes:[],links:[]})}},CK),LK),stateInit:function(n){var r=n.controlType,a=n.rendererConfig,s=n.extraRenderers;return{forceGraph:new pw,renderObjs:xR({controlType:r,rendererConfig:a,extraRenderers:s})}},init:function(n,r){n.innerHTML="",n.appendChild(r.container=document.createElement("div")),r.container.style.position="relative";var a=document.createElement("div");r.container.appendChild(a),r.renderObjs(a);var s=r.renderObjs.camera(),o=r.renderObjs.renderer(),u=r.renderObjs.controls();u.enabled=!!r.enableNavigationControls,r.lastSetCameraZ=s.position.z;var f;r.container.appendChild(f=document.createElement("div")),f.className="graph-info-msg",f.textContent="",r.forceGraph.onLoading(function(){f.textContent="Loading..."}).onFinishLoading(function(){f.textContent=""}).onUpdate(function(){r.graphData=r.forceGraph.graphData(),s.position.x===0&&s.position.y===0&&s.position.z===r.lastSetCameraZ&&r.graphData.nodes.length&&(s.lookAt(r.forceGraph.position),r.lastSetCameraZ=s.position.z=Math.cbrt(r.graphData.nodes.length)*SK)}).onFinishUpdate(function(){if(r._dragControls){var v=r.graphData.nodes.find(function(g){return g.__initialFixedPos&&!g.__disposeControlsAfterDrag});v?v.__disposeControlsAfterDrag=!0:r._dragControls.dispose(),r._dragControls=void 0}if(r.enableNodeDrag&&r.enablePointerInteraction&&r.forceEngine==="d3"){var m=r._dragControls=new bY(r.graphData.nodes.map(function(g){return g.__threeObj}).filter(function(g){return g}),s,o.domElement);m.addEventListener("dragstart",function(g){u.enabled=!1,g.object.__initialPos=g.object.position.clone(),g.object.__prevPos=g.object.position.clone();var y=$s(g.object).__data;!y.__initialFixedPos&&(y.__initialFixedPos={fx:y.fx,fy:y.fy,fz:y.fz}),!y.__initialPos&&(y.__initialPos={x:y.x,y:y.y,z:y.z}),["x","y","z"].forEach(function(b){return y["f".concat(b)]=y[b]}),o.domElement.classList.add("grabbable")}),m.addEventListener("drag",function(g){var y=$s(g.object);if(!g.object.hasOwnProperty("__graphObjType")){var b=g.object.__initialPos,w=g.object.__prevPos,A=g.object.position;y.position.add(A.clone().sub(w)),w.copy(A),A.copy(b)}var M=y.__data,S=y.position,E={x:S.x-M.x,y:S.y-M.y,z:S.z-M.z};["x","y","z"].forEach(function(T){return M["f".concat(T)]=M[T]=S[T]}),r.forceGraph.d3AlphaTarget(.3).resetCountdown(),M.__dragged=!0,r.onNodeDrag(M,E)}),m.addEventListener("dragend",function(g){delete g.object.__initialPos,delete g.object.__prevPos;var y=$s(g.object).__data;y.__disposeControlsAfterDrag&&(m.dispose(),delete y.__disposeControlsAfterDrag);var b=y.__initialFixedPos,w=y.__initialPos,A={x:w.x-y.x,y:w.y-y.y,z:w.z-y.z};b&&(["x","y","z"].forEach(function(M){var S="f".concat(M);b[S]===void 0&&delete y[S]}),delete y.__initialFixedPos,delete y.__initialPos,y.__dragged&&(delete y.__dragged,r.onNodeDragEnd(y,A))),r.forceGraph.d3AlphaTarget(0).resetCountdown(),r.enableNavigationControls&&(u.enabled=!0,u.domElement&&u.domElement.ownerDocument&&u.domElement.ownerDocument.dispatchEvent(new PointerEvent("pointerup",{pointerType:"touch"}))),o.domElement.classList.remove("grabbable")})}}),r.renderObjs.objects([new ER.AmbientLight(12303291),new ER.DirectionalLight(16777215,.6),r.forceGraph]).hoverOrderComparator(function(v,m){var g=$s(v);if(!g)return 1;var y=$s(m);if(!y)return-1;var b=function(A){return A.__graphObjType==="node"};return b(y)-b(g)}).tooltipContent(function(v){var m=$s(v);return m&&Ln(r["".concat(m.__graphObjType,"Label")])(m.__data)||""}).hoverDuringDrag(!1).onHover(function(v){var m=$s(v);if(m!==r.hoverObj){var g=r.hoverObj?r.hoverObj.__graphObjType:null,y=r.hoverObj?r.hoverObj.__data:null,b=m?m.__graphObjType:null,w=m?m.__data:null;if(g&&g!==b){var A=r["on".concat(g==="node"?"Node":"Link","Hover")];A&&A(null,y)}if(b){var M=r["on".concat(b==="node"?"Node":"Link","Hover")];M&&M(w,g===b?y:null)}o.domElement.classList[m&&r["on".concat(b==="node"?"Node":"Link","Click")]||!m&&r.onBackgroundClick?"add":"remove"]("clickable"),r.hoverObj=m}}).clickAfterDrag(!1).onClick(function(v,m){var g=$s(v);if(g){var y=r["on".concat(g.__graphObjType==="node"?"Node":"Link","Click")];y&&y(g.__data,m)}else r.onBackgroundClick&&r.onBackgroundClick(m)}).onRightClick(function(v,m){var g=$s(v);if(g){var y=r["on".concat(g.__graphObjType==="node"?"Node":"Link","RightClick")];y&&y(g.__data,m)}else r.onBackgroundRightClick&&r.onBackgroundRightClick(m)}),this._animationCycle()}});function $s(i){for(var n=i;n&&!n.hasOwnProperty("__graphObjType");)n=n.parent;return n}const DK={width:Number,height:Number,graphData:{type:Object,required:!0,validator(i){return i.nodes&&i.links}},backgroundColor:String,nodeRelSize:Number,nodeId:String,nodeLabel:[String,Function],nodeVal:[Number,String,Function],nodeVisibility:{type:[Boolean,String,Function],default:!0},nodeColor:[String,Function],nodeAutoColorBy:[String,Function],onNodeHover:Function,onNodeClick:Function,linkSource:String,linkTarget:String,linkLabel:[String,Function],linkVisibility:{type:[Boolean,String,Function],default:!0},linkColor:[String,Function],linkAutoColorBy:[String,Function],linkWidth:[Number,String,Function],linkCurvature:[Number,String,Function],linkDirectionalArrowLength:[Number,String,Function],linkDirectionalArrowColor:[String,Function],linkDirectionalArrowRelPos:[Number,String,Function],linkDirectionalParticles:[Number,String,Function],linkDirectionalParticleSpeed:[Number,String,Function],linkDirectionalParticleWidth:[Number,String,Function],linkDirectionalParticleColor:[String,Function],onLinkHover:Function,onLinkClick:Function,dagMode:{validator(i){return["td","bu","lr","rl","zin","zout","radialin","radialout"].includes(i)}},dagLevelDistance:Number,dagNodeFilter:Function,onDagError:Function,d3AlphaMin:Number,d3AlphaDecay:Number,d3VelocityDecay:Number,warmupTicks:Number,cooldownTicks:Number,cooldownTime:Number,onEngineTick:Function,onEngineStop:Function,getGraphBbox:Function,zoomToFit:Function,onNodeRightClick:Function,onNodeDrag:Function,onNodeDragEnd:Function,onLinkRightClick:Function,linkHoverPrecision:Number,onBackgroundClick:Function,onBackgroundRightClick:Function,enablePointerInteraction:{type:Boolean,default:!0},enableNodeDrag:{type:Boolean,default:!0},showNavInfo:{type:Boolean,default:!0},nodeOpacity:Number,nodeResolution:Number,nodeThreeObject:[Object,String,Function],nodeThreeObjectExtend:{type:[Boolean,String,Function],default:!1},linkOpacity:Number,linkResolution:Number,linkCurveRotation:[Number,String,Function],linkMaterial:[Object,String,Function],linkThreeObject:[Object,String,Function],linkThreeObjectExtend:{type:[Boolean,String,Function],default:!1},linkPositionUpdate:Function,linkDirectionalArrowResolution:Number,linkDirectionalParticleResolution:Number,forceEngine:{validator(i){return["d3","ngraph"].includes(i)}},ngraphPhysics:Object,numDimensions:{validator(i){return[1,2,3].includes(i)}},enableNavigationControls:{type:Boolean,default:!0},controlType:{validator(i){return["trackball","orbit","fly"].includes(i)}},rendererConfig:Object,extraRenderers:{type:Array,validator(i){return i==null?void 0:i.every(n=>n.render)}}};var MR=Og(PK,{methodNames:["emitParticle","d3Force","d3ReheatSimulation","stopAnimation","pauseAnimation","resumeAnimation","cameraPosition","zoomToFit","getGraphBbox","screen2GraphCoords","graph2ScreenCoords","postProcessingComposer","scene","camera","renderer","controls","refresh"],initPropNames:["controlType","rendererConfig","extraRenderers"],props:DK,name:"VueForceGraph3D"});MR.__file="packages/components/vue-force-graph-3d/src/vue-force-graph-3d.vue";const VZ=Xd(MR);var OK={exports:{}};(function(i,n){(function(r){i.exports=r()})(function(){return function(){function r(a,s,o){function u(m,g){if(!s[m]){if(!a[m]){var y=typeof Kg=="function"&&Kg;if(!g&&y)return y(m,!0);if(f)return f(m,!0);var b=new Error("Cannot find module '"+m+"'");throw b.code="MODULE_NOT_FOUND",b}var w=s[m]={exports:{}};a[m][0].call(w.exports,function(A){var M=a[m][1][A];return u(M||A)},w,w.exports,r,a,s,o)}return s[m].exports}for(var f=typeof Kg=="function"&&Kg,v=0;v<o.length;v++)u(o[v]);return u}return r}()({1:[function(r,a,s){var o=Object.prototype.toString;a.exports=u;function u(f){return f.BYTES_PER_ELEMENT&&o.call(f.buffer)==="[object ArrayBuffer]"||Array.isArray(f)}},{}],2:[function(r,a,s){a.exports=function(u,f){return typeof u=="number"?u:typeof f=="number"?f:0}},{}],3:[function(r,a,s){s.byteLength=b,s.toByteArray=A,s.fromByteArray=E;for(var o=[],u=[],f=typeof Uint8Array!="undefined"?Uint8Array:Array,v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",m=0,g=v.length;m<g;++m)o[m]=v[m],u[v.charCodeAt(m)]=m;u["-".charCodeAt(0)]=62,u["_".charCodeAt(0)]=63;function y(T){var C=T.length;if(C%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var L=T.indexOf("=");L===-1&&(L=C);var P=L===C?0:4-L%4;return[L,P]}function b(T){var C=y(T),L=C[0],P=C[1];return(L+P)*3/4-P}function w(T,C,L){return(C+L)*3/4-L}function A(T){for(var C,L=y(T),P=L[0],N=L[1],F=new f(w(T,P,N)),X=0,Y=N>0?P-4:P,ae=0;ae<Y;ae+=4)C=u[T.charCodeAt(ae)]<<18|u[T.charCodeAt(ae+1)]<<12|u[T.charCodeAt(ae+2)]<<6|u[T.charCodeAt(ae+3)],F[X++]=C>>16&255,F[X++]=C>>8&255,F[X++]=C&255;return N===2&&(C=u[T.charCodeAt(ae)]<<2|u[T.charCodeAt(ae+1)]>>4,F[X++]=C&255),N===1&&(C=u[T.charCodeAt(ae)]<<10|u[T.charCodeAt(ae+1)]<<4|u[T.charCodeAt(ae+2)]>>2,F[X++]=C>>8&255,F[X++]=C&255),F}function M(T){return o[T>>18&63]+o[T>>12&63]+o[T>>6&63]+o[T&63]}function S(T,C,L){for(var P,N=[],F=C;F<L;F+=3)P=(T[F]<<16&16711680)+(T[F+1]<<8&65280)+(T[F+2]&255),N.push(M(P));return N.join("")}function E(T){for(var C,L=T.length,P=L%3,N=[],F=16383,X=0,Y=L-P;X<Y;X+=F)N.push(S(T,X,X+F>Y?Y:X+F));return P===1?(C=T[L-1],N.push(o[C>>2]+o[C<<4&63]+"==")):P===2&&(C=(T[L-2]<<8)+T[L-1],N.push(o[C>>10]+o[C>>4&63]+o[C<<2&63]+"=")),N.join("")}},{}],4:[function(r,a,s){a.exports={createLink:function(o,u){var f=document.head||document.getElementsByTagName("head")[0],v=document.createElement("link");v.href=o,v.rel="stylesheet";for(var m in u)if(!!u.hasOwnProperty(m)){var g=u[m];v.setAttribute("data-"+m,g)}f.appendChild(v)},createStyle:function(o,u){var f=document.head||document.getElementsByTagName("head")[0],v=document.createElement("style");v.type="text/css";for(var m in u)if(!!u.hasOwnProperty(m)){var g=u[m];v.setAttribute("data-"+m,g)}v.sheet?(v.innerHTML=o,v.sheet.cssText=o,f.appendChild(v)):v.styleSheet?(f.appendChild(v),v.styleSheet.cssText=o):(v.appendChild(document.createTextNode(o)),f.appendChild(v))}}},{}],5:[function(r,a,s){var o=r("buffer").Buffer;a.exports=function(u,f){if(!!o.isBuffer(u)&&!!o.isBuffer(f)){if(typeof u.equals=="function")return u.equals(f);if(u.length!==f.length)return!1;for(var v=0;v<u.length;v++)if(u[v]!==f[v])return!1;return!0}}},{buffer:6}],6:[function(r,a,s){(function(o,u){var f=r("base64-js"),v=r("ieee754"),m=r("isarray");s.Buffer=u,s.SlowBuffer=N,s.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=o.TYPED_ARRAY_SUPPORT!==void 0?o.TYPED_ARRAY_SUPPORT:g(),s.kMaxLength=y();function g(){try{var ve=new Uint8Array(1);return ve.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},ve.foo()===42&&typeof ve.subarray=="function"&&ve.subarray(1,1).byteLength===0}catch{return!1}}function y(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function b(ve,K){if(y()<K)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(ve=new Uint8Array(K),ve.__proto__=u.prototype):(ve===null&&(ve=new u(K)),ve.length=K),ve}function u(ve,K,J){if(!u.TYPED_ARRAY_SUPPORT&&!(this instanceof u))return new u(ve,K,J);if(typeof ve=="number"){if(typeof K=="string")throw new Error("If encoding is specified then the first argument must be a string");return S(this,ve)}return w(this,ve,K,J)}u.poolSize=8192,u._augment=function(ve){return ve.__proto__=u.prototype,ve};function w(ve,K,J,Ee){if(typeof K=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer!="undefined"&&K instanceof ArrayBuffer?C(ve,K,J,Ee):typeof K=="string"?E(ve,K,J):L(ve,K)}u.from=function(ve,K,J){return w(null,ve,K,J)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,typeof Symbol!="undefined"&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0}));function A(ve){if(typeof ve!="number")throw new TypeError('"size" argument must be a number');if(ve<0)throw new RangeError('"size" argument must not be negative')}function M(ve,K,J,Ee){return A(K),K<=0?b(ve,K):J!==void 0?typeof Ee=="string"?b(ve,K).fill(J,Ee):b(ve,K).fill(J):b(ve,K)}u.alloc=function(ve,K,J){return M(null,ve,K,J)};function S(ve,K){if(A(K),ve=b(ve,K<0?0:P(K)|0),!u.TYPED_ARRAY_SUPPORT)for(var J=0;J<K;++J)ve[J]=0;return ve}u.allocUnsafe=function(ve){return S(null,ve)},u.allocUnsafeSlow=function(ve){return S(null,ve)};function E(ve,K,J){if((typeof J!="string"||J==="")&&(J="utf8"),!u.isEncoding(J))throw new TypeError('"encoding" must be a valid string encoding');var Ee=F(K,J)|0;ve=b(ve,Ee);var xe=ve.write(K,J);return xe!==Ee&&(ve=ve.slice(0,xe)),ve}function T(ve,K){var J=K.length<0?0:P(K.length)|0;ve=b(ve,J);for(var Ee=0;Ee<J;Ee+=1)ve[Ee]=K[Ee]&255;return ve}function C(ve,K,J,Ee){if(K.byteLength,J<0||K.byteLength<J)throw new RangeError("'offset' is out of bounds");if(K.byteLength<J+(Ee||0))throw new RangeError("'length' is out of bounds");return J===void 0&&Ee===void 0?K=new Uint8Array(K):Ee===void 0?K=new Uint8Array(K,J):K=new Uint8Array(K,J,Ee),u.TYPED_ARRAY_SUPPORT?(ve=K,ve.__proto__=u.prototype):ve=T(ve,K),ve}function L(ve,K){if(u.isBuffer(K)){var J=P(K.length)|0;return ve=b(ve,J),ve.length===0||K.copy(ve,0,0,J),ve}if(K){if(typeof ArrayBuffer!="undefined"&&K.buffer instanceof ArrayBuffer||"length"in K)return typeof K.length!="number"||We(K.length)?b(ve,0):T(ve,K);if(K.type==="Buffer"&&m(K.data))return T(ve,K.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function P(ve){if(ve>=y())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+y().toString(16)+" bytes");return ve|0}function N(ve){return+ve!=ve&&(ve=0),u.alloc(+ve)}u.isBuffer=function(K){return!!(K!=null&&K._isBuffer)},u.compare=function(K,J){if(!u.isBuffer(K)||!u.isBuffer(J))throw new TypeError("Arguments must be Buffers");if(K===J)return 0;for(var Ee=K.length,xe=J.length,Je=0,Xe=Math.min(Ee,xe);Je<Xe;++Je)if(K[Je]!==J[Je]){Ee=K[Je],xe=J[Je];break}return Ee<xe?-1:xe<Ee?1:0},u.isEncoding=function(K){switch(String(K).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(K,J){if(!m(K))throw new TypeError('"list" argument must be an Array of Buffers');if(K.length===0)return u.alloc(0);var Ee;if(J===void 0)for(J=0,Ee=0;Ee<K.length;++Ee)J+=K[Ee].length;var xe=u.allocUnsafe(J),Je=0;for(Ee=0;Ee<K.length;++Ee){var Xe=K[Ee];if(!u.isBuffer(Xe))throw new TypeError('"list" argument must be an Array of Buffers');Xe.copy(xe,Je),Je+=Xe.length}return xe};function F(ve,K){if(u.isBuffer(ve))return ve.length;if(typeof ArrayBuffer!="undefined"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(ve)||ve instanceof ArrayBuffer))return ve.byteLength;typeof ve!="string"&&(ve=""+ve);var J=ve.length;if(J===0)return 0;for(var Ee=!1;;)switch(K){case"ascii":case"latin1":case"binary":return J;case"utf8":case"utf-8":case void 0:return ee(ve).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return J*2;case"hex":return J>>>1;case"base64":return ke(ve).length;default:if(Ee)return ee(ve).length;K=(""+K).toLowerCase(),Ee=!0}}u.byteLength=F;function X(ve,K,J){var Ee=!1;if((K===void 0||K<0)&&(K=0),K>this.length||((J===void 0||J>this.length)&&(J=this.length),J<=0)||(J>>>=0,K>>>=0,J<=K))return"";for(ve||(ve="utf8");;)switch(ve){case"hex":return Ve(this,K,J);case"utf8":case"utf-8":return oe(this,K,J);case"ascii":return Ne(this,K,J);case"latin1":case"binary":return Ie(this,K,J);case"base64":return ce(this,K,J);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Le(this,K,J);default:if(Ee)throw new TypeError("Unknown encoding: "+ve);ve=(ve+"").toLowerCase(),Ee=!0}}u.prototype._isBuffer=!0;function Y(ve,K,J){var Ee=ve[K];ve[K]=ve[J],ve[J]=Ee}u.prototype.swap16=function(){var K=this.length;if(K%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var J=0;J<K;J+=2)Y(this,J,J+1);return this},u.prototype.swap32=function(){var K=this.length;if(K%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var J=0;J<K;J+=4)Y(this,J,J+3),Y(this,J+1,J+2);return this},u.prototype.swap64=function(){var K=this.length;if(K%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var J=0;J<K;J+=8)Y(this,J,J+7),Y(this,J+1,J+6),Y(this,J+2,J+5),Y(this,J+3,J+4);return this},u.prototype.toString=function(){var K=this.length|0;return K===0?"":arguments.length===0?oe(this,0,K):X.apply(this,arguments)},u.prototype.equals=function(K){if(!u.isBuffer(K))throw new TypeError("Argument must be a Buffer");return this===K?!0:u.compare(this,K)===0},u.prototype.inspect=function(){var K="",J=s.INSPECT_MAX_BYTES;return this.length>0&&(K=this.toString("hex",0,J).match(/.{2}/g).join(" "),this.length>J&&(K+=" ... ")),"<Buffer "+K+">"},u.prototype.compare=function(K,J,Ee,xe,Je){if(!u.isBuffer(K))throw new TypeError("Argument must be a Buffer");if(J===void 0&&(J=0),Ee===void 0&&(Ee=K?K.length:0),xe===void 0&&(xe=0),Je===void 0&&(Je=this.length),J<0||Ee>K.length||xe<0||Je>this.length)throw new RangeError("out of range index");if(xe>=Je&&J>=Ee)return 0;if(xe>=Je)return-1;if(J>=Ee)return 1;if(J>>>=0,Ee>>>=0,xe>>>=0,Je>>>=0,this===K)return 0;for(var Xe=Je-xe,Mt=Ee-J,qe=Math.min(Xe,Mt),It=this.slice(xe,Je),rn=K.slice(J,Ee),Yt=0;Yt<qe;++Yt)if(It[Yt]!==rn[Yt]){Xe=It[Yt],Mt=rn[Yt];break}return Xe<Mt?-1:Mt<Xe?1:0};function ae(ve,K,J,Ee,xe){if(ve.length===0)return-1;if(typeof J=="string"?(Ee=J,J=0):J>2147483647?J=2147483647:J<-2147483648&&(J=-2147483648),J=+J,isNaN(J)&&(J=xe?0:ve.length-1),J<0&&(J=ve.length+J),J>=ve.length){if(xe)return-1;J=ve.length-1}else if(J<0)if(xe)J=0;else return-1;if(typeof K=="string"&&(K=u.from(K,Ee)),u.isBuffer(K))return K.length===0?-1:$(ve,K,J,Ee,xe);if(typeof K=="number")return K=K&255,u.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?xe?Uint8Array.prototype.indexOf.call(ve,K,J):Uint8Array.prototype.lastIndexOf.call(ve,K,J):$(ve,[K],J,Ee,xe);throw new TypeError("val must be string, number or Buffer")}function $(ve,K,J,Ee,xe){var Je=1,Xe=ve.length,Mt=K.length;if(Ee!==void 0&&(Ee=String(Ee).toLowerCase(),Ee==="ucs2"||Ee==="ucs-2"||Ee==="utf16le"||Ee==="utf-16le")){if(ve.length<2||K.length<2)return-1;Je=2,Xe/=2,Mt/=2,J/=2}function qe(Jt,Fn){return Je===1?Jt[Fn]:Jt.readUInt16BE(Fn*Je)}var It;if(xe){var rn=-1;for(It=J;It<Xe;It++)if(qe(ve,It)===qe(K,rn===-1?0:It-rn)){if(rn===-1&&(rn=It),It-rn+1===Mt)return rn*Je}else rn!==-1&&(It-=It-rn),rn=-1}else for(J+Mt>Xe&&(J=Xe-Mt),It=J;It>=0;It--){for(var Yt=!0,Tn=0;Tn<Mt;Tn++)if(qe(ve,It+Tn)!==qe(K,Tn)){Yt=!1;break}if(Yt)return It}return-1}u.prototype.includes=function(K,J,Ee){return this.indexOf(K,J,Ee)!==-1},u.prototype.indexOf=function(K,J,Ee){return ae(this,K,J,Ee,!0)},u.prototype.lastIndexOf=function(K,J,Ee){return ae(this,K,J,Ee,!1)};function de(ve,K,J,Ee){J=Number(J)||0;var xe=ve.length-J;Ee?(Ee=Number(Ee),Ee>xe&&(Ee=xe)):Ee=xe;var Je=K.length;if(Je%2!=0)throw new TypeError("Invalid hex string");Ee>Je/2&&(Ee=Je/2);for(var Xe=0;Xe<Ee;++Xe){var Mt=parseInt(K.substr(Xe*2,2),16);if(isNaN(Mt))return Xe;ve[J+Xe]=Mt}return Xe}function D(ve,K,J,Ee){return Be(ee(K,ve.length-J),ve,J,Ee)}function I(ve,K,J,Ee){return Be(te(K),ve,J,Ee)}function k(ve,K,J,Ee){return I(ve,K,J,Ee)}function U(ve,K,J,Ee){return Be(ke(K),ve,J,Ee)}function W(ve,K,J,Ee){return Be(Se(K,ve.length-J),ve,J,Ee)}u.prototype.write=function(K,J,Ee,xe){if(J===void 0)xe="utf8",Ee=this.length,J=0;else if(Ee===void 0&&typeof J=="string")xe=J,Ee=this.length,J=0;else if(isFinite(J))J=J|0,isFinite(Ee)?(Ee=Ee|0,xe===void 0&&(xe="utf8")):(xe=Ee,Ee=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var Je=this.length-J;if((Ee===void 0||Ee>Je)&&(Ee=Je),K.length>0&&(Ee<0||J<0)||J>this.length)throw new RangeError("Attempt to write outside buffer bounds");xe||(xe="utf8");for(var Xe=!1;;)switch(xe){case"hex":return de(this,K,J,Ee);case"utf8":case"utf-8":return D(this,K,J,Ee);case"ascii":return I(this,K,J,Ee);case"latin1":case"binary":return k(this,K,J,Ee);case"base64":return U(this,K,J,Ee);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return W(this,K,J,Ee);default:if(Xe)throw new TypeError("Unknown encoding: "+xe);xe=(""+xe).toLowerCase(),Xe=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ce(ve,K,J){return K===0&&J===ve.length?f.fromByteArray(ve):f.fromByteArray(ve.slice(K,J))}function oe(ve,K,J){J=Math.min(ve.length,J);for(var Ee=[],xe=K;xe<J;){var Je=ve[xe],Xe=null,Mt=Je>239?4:Je>223?3:Je>191?2:1;if(xe+Mt<=J){var qe,It,rn,Yt;switch(Mt){case 1:Je<128&&(Xe=Je);break;case 2:qe=ve[xe+1],(qe&192)==128&&(Yt=(Je&31)<<6|qe&63,Yt>127&&(Xe=Yt));break;case 3:qe=ve[xe+1],It=ve[xe+2],(qe&192)==128&&(It&192)==128&&(Yt=(Je&15)<<12|(qe&63)<<6|It&63,Yt>2047&&(Yt<55296||Yt>57343)&&(Xe=Yt));break;case 4:qe=ve[xe+1],It=ve[xe+2],rn=ve[xe+3],(qe&192)==128&&(It&192)==128&&(rn&192)==128&&(Yt=(Je&15)<<18|(qe&63)<<12|(It&63)<<6|rn&63,Yt>65535&&Yt<1114112&&(Xe=Yt))}}Xe===null?(Xe=65533,Mt=1):Xe>65535&&(Xe-=65536,Ee.push(Xe>>>10&1023|55296),Xe=56320|Xe&1023),Ee.push(Xe),xe+=Mt}return _e(Ee)}var ge=4096;function _e(ve){var K=ve.length;if(K<=ge)return String.fromCharCode.apply(String,ve);for(var J="",Ee=0;Ee<K;)J+=String.fromCharCode.apply(String,ve.slice(Ee,Ee+=ge));return J}function Ne(ve,K,J){var Ee="";J=Math.min(ve.length,J);for(var xe=K;xe<J;++xe)Ee+=String.fromCharCode(ve[xe]&127);return Ee}function Ie(ve,K,J){var Ee="";J=Math.min(ve.length,J);for(var xe=K;xe<J;++xe)Ee+=String.fromCharCode(ve[xe]);return Ee}function Ve(ve,K,J){var Ee=ve.length;(!K||K<0)&&(K=0),(!J||J<0||J>Ee)&&(J=Ee);for(var xe="",Je=K;Je<J;++Je)xe+=pe(ve[Je]);return xe}function Le(ve,K,J){for(var Ee=ve.slice(K,J),xe="",Je=0;Je<Ee.length;Je+=2)xe+=String.fromCharCode(Ee[Je]+Ee[Je+1]*256);return xe}u.prototype.slice=function(K,J){var Ee=this.length;K=~~K,J=J===void 0?Ee:~~J,K<0?(K+=Ee,K<0&&(K=0)):K>Ee&&(K=Ee),J<0?(J+=Ee,J<0&&(J=0)):J>Ee&&(J=Ee),J<K&&(J=K);var xe;if(u.TYPED_ARRAY_SUPPORT)xe=this.subarray(K,J),xe.__proto__=u.prototype;else{var Je=J-K;xe=new u(Je,void 0);for(var Xe=0;Xe<Je;++Xe)xe[Xe]=this[Xe+K]}return xe};function Fe(ve,K,J){if(ve%1!=0||ve<0)throw new RangeError("offset is not uint");if(ve+K>J)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUIntLE=function(K,J,Ee){K=K|0,J=J|0,Ee||Fe(K,J,this.length);for(var xe=this[K],Je=1,Xe=0;++Xe<J&&(Je*=256);)xe+=this[K+Xe]*Je;return xe},u.prototype.readUIntBE=function(K,J,Ee){K=K|0,J=J|0,Ee||Fe(K,J,this.length);for(var xe=this[K+--J],Je=1;J>0&&(Je*=256);)xe+=this[K+--J]*Je;return xe},u.prototype.readUInt8=function(K,J){return J||Fe(K,1,this.length),this[K]},u.prototype.readUInt16LE=function(K,J){return J||Fe(K,2,this.length),this[K]|this[K+1]<<8},u.prototype.readUInt16BE=function(K,J){return J||Fe(K,2,this.length),this[K]<<8|this[K+1]},u.prototype.readUInt32LE=function(K,J){return J||Fe(K,4,this.length),(this[K]|this[K+1]<<8|this[K+2]<<16)+this[K+3]*16777216},u.prototype.readUInt32BE=function(K,J){return J||Fe(K,4,this.length),this[K]*16777216+(this[K+1]<<16|this[K+2]<<8|this[K+3])},u.prototype.readIntLE=function(K,J,Ee){K=K|0,J=J|0,Ee||Fe(K,J,this.length);for(var xe=this[K],Je=1,Xe=0;++Xe<J&&(Je*=256);)xe+=this[K+Xe]*Je;return Je*=128,xe>=Je&&(xe-=Math.pow(2,8*J)),xe},u.prototype.readIntBE=function(K,J,Ee){K=K|0,J=J|0,Ee||Fe(K,J,this.length);for(var xe=J,Je=1,Xe=this[K+--xe];xe>0&&(Je*=256);)Xe+=this[K+--xe]*Je;return Je*=128,Xe>=Je&&(Xe-=Math.pow(2,8*J)),Xe},u.prototype.readInt8=function(K,J){return J||Fe(K,1,this.length),this[K]&128?(255-this[K]+1)*-1:this[K]},u.prototype.readInt16LE=function(K,J){J||Fe(K,2,this.length);var Ee=this[K]|this[K+1]<<8;return Ee&32768?Ee|4294901760:Ee},u.prototype.readInt16BE=function(K,J){J||Fe(K,2,this.length);var Ee=this[K+1]|this[K]<<8;return Ee&32768?Ee|4294901760:Ee},u.prototype.readInt32LE=function(K,J){return J||Fe(K,4,this.length),this[K]|this[K+1]<<8|this[K+2]<<16|this[K+3]<<24},u.prototype.readInt32BE=function(K,J){return J||Fe(K,4,this.length),this[K]<<24|this[K+1]<<16|this[K+2]<<8|this[K+3]},u.prototype.readFloatLE=function(K,J){return J||Fe(K,4,this.length),v.read(this,K,!0,23,4)},u.prototype.readFloatBE=function(K,J){return J||Fe(K,4,this.length),v.read(this,K,!1,23,4)},u.prototype.readDoubleLE=function(K,J){return J||Fe(K,8,this.length),v.read(this,K,!0,52,8)},u.prototype.readDoubleBE=function(K,J){return J||Fe(K,8,this.length),v.read(this,K,!1,52,8)};function Me(ve,K,J,Ee,xe,Je){if(!u.isBuffer(ve))throw new TypeError('"buffer" argument must be a Buffer instance');if(K>xe||K<Je)throw new RangeError('"value" argument is out of bounds');if(J+Ee>ve.length)throw new RangeError("Index out of range")}u.prototype.writeUIntLE=function(K,J,Ee,xe){if(K=+K,J=J|0,Ee=Ee|0,!xe){var Je=Math.pow(2,8*Ee)-1;Me(this,K,J,Ee,Je,0)}var Xe=1,Mt=0;for(this[J]=K&255;++Mt<Ee&&(Xe*=256);)this[J+Mt]=K/Xe&255;return J+Ee},u.prototype.writeUIntBE=function(K,J,Ee,xe){if(K=+K,J=J|0,Ee=Ee|0,!xe){var Je=Math.pow(2,8*Ee)-1;Me(this,K,J,Ee,Je,0)}var Xe=Ee-1,Mt=1;for(this[J+Xe]=K&255;--Xe>=0&&(Mt*=256);)this[J+Xe]=K/Mt&255;return J+Ee},u.prototype.writeUInt8=function(K,J,Ee){return K=+K,J=J|0,Ee||Me(this,K,J,1,255,0),u.TYPED_ARRAY_SUPPORT||(K=Math.floor(K)),this[J]=K&255,J+1};function Qe(ve,K,J,Ee){K<0&&(K=65535+K+1);for(var xe=0,Je=Math.min(ve.length-J,2);xe<Je;++xe)ve[J+xe]=(K&255<<8*(Ee?xe:1-xe))>>>(Ee?xe:1-xe)*8}u.prototype.writeUInt16LE=function(K,J,Ee){return K=+K,J=J|0,Ee||Me(this,K,J,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[J]=K&255,this[J+1]=K>>>8):Qe(this,K,J,!0),J+2},u.prototype.writeUInt16BE=function(K,J,Ee){return K=+K,J=J|0,Ee||Me(this,K,J,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[J]=K>>>8,this[J+1]=K&255):Qe(this,K,J,!1),J+2};function mt(ve,K,J,Ee){K<0&&(K=4294967295+K+1);for(var xe=0,Je=Math.min(ve.length-J,4);xe<Je;++xe)ve[J+xe]=K>>>(Ee?xe:3-xe)*8&255}u.prototype.writeUInt32LE=function(K,J,Ee){return K=+K,J=J|0,Ee||Me(this,K,J,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[J+3]=K>>>24,this[J+2]=K>>>16,this[J+1]=K>>>8,this[J]=K&255):mt(this,K,J,!0),J+4},u.prototype.writeUInt32BE=function(K,J,Ee){return K=+K,J=J|0,Ee||Me(this,K,J,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[J]=K>>>24,this[J+1]=K>>>16,this[J+2]=K>>>8,this[J+3]=K&255):mt(this,K,J,!1),J+4},u.prototype.writeIntLE=function(K,J,Ee,xe){if(K=+K,J=J|0,!xe){var Je=Math.pow(2,8*Ee-1);Me(this,K,J,Ee,Je-1,-Je)}var Xe=0,Mt=1,qe=0;for(this[J]=K&255;++Xe<Ee&&(Mt*=256);)K<0&&qe===0&&this[J+Xe-1]!==0&&(qe=1),this[J+Xe]=(K/Mt>>0)-qe&255;return J+Ee},u.prototype.writeIntBE=function(K,J,Ee,xe){if(K=+K,J=J|0,!xe){var Je=Math.pow(2,8*Ee-1);Me(this,K,J,Ee,Je-1,-Je)}var Xe=Ee-1,Mt=1,qe=0;for(this[J+Xe]=K&255;--Xe>=0&&(Mt*=256);)K<0&&qe===0&&this[J+Xe+1]!==0&&(qe=1),this[J+Xe]=(K/Mt>>0)-qe&255;return J+Ee},u.prototype.writeInt8=function(K,J,Ee){return K=+K,J=J|0,Ee||Me(this,K,J,1,127,-128),u.TYPED_ARRAY_SUPPORT||(K=Math.floor(K)),K<0&&(K=255+K+1),this[J]=K&255,J+1},u.prototype.writeInt16LE=function(K,J,Ee){return K=+K,J=J|0,Ee||Me(this,K,J,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[J]=K&255,this[J+1]=K>>>8):Qe(this,K,J,!0),J+2},u.prototype.writeInt16BE=function(K,J,Ee){return K=+K,J=J|0,Ee||Me(this,K,J,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[J]=K>>>8,this[J+1]=K&255):Qe(this,K,J,!1),J+2},u.prototype.writeInt32LE=function(K,J,Ee){return K=+K,J=J|0,Ee||Me(this,K,J,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[J]=K&255,this[J+1]=K>>>8,this[J+2]=K>>>16,this[J+3]=K>>>24):mt(this,K,J,!0),J+4},u.prototype.writeInt32BE=function(K,J,Ee){return K=+K,J=J|0,Ee||Me(this,K,J,4,2147483647,-2147483648),K<0&&(K=4294967295+K+1),u.TYPED_ARRAY_SUPPORT?(this[J]=K>>>24,this[J+1]=K>>>16,this[J+2]=K>>>8,this[J+3]=K&255):mt(this,K,J,!1),J+4};function ht(ve,K,J,Ee,xe,Je){if(J+Ee>ve.length)throw new RangeError("Index out of range");if(J<0)throw new RangeError("Index out of range")}function ye(ve,K,J,Ee,xe){return xe||ht(ve,K,J,4),v.write(ve,K,J,Ee,23,4),J+4}u.prototype.writeFloatLE=function(K,J,Ee){return ye(this,K,J,!0,Ee)},u.prototype.writeFloatBE=function(K,J,Ee){return ye(this,K,J,!1,Ee)};function fe(ve,K,J,Ee,xe){return xe||ht(ve,K,J,8),v.write(ve,K,J,Ee,52,8),J+8}u.prototype.writeDoubleLE=function(K,J,Ee){return fe(this,K,J,!0,Ee)},u.prototype.writeDoubleBE=function(K,J,Ee){return fe(this,K,J,!1,Ee)},u.prototype.copy=function(K,J,Ee,xe){if(Ee||(Ee=0),!xe&&xe!==0&&(xe=this.length),J>=K.length&&(J=K.length),J||(J=0),xe>0&&xe<Ee&&(xe=Ee),xe===Ee||K.length===0||this.length===0)return 0;if(J<0)throw new RangeError("targetStart out of bounds");if(Ee<0||Ee>=this.length)throw new RangeError("sourceStart out of bounds");if(xe<0)throw new RangeError("sourceEnd out of bounds");xe>this.length&&(xe=this.length),K.length-J<xe-Ee&&(xe=K.length-J+Ee);var Je=xe-Ee,Xe;if(this===K&&Ee<J&&J<xe)for(Xe=Je-1;Xe>=0;--Xe)K[Xe+J]=this[Xe+Ee];else if(Je<1e3||!u.TYPED_ARRAY_SUPPORT)for(Xe=0;Xe<Je;++Xe)K[Xe+J]=this[Xe+Ee];else Uint8Array.prototype.set.call(K,this.subarray(Ee,Ee+Je),J);return Je},u.prototype.fill=function(K,J,Ee,xe){if(typeof K=="string"){if(typeof J=="string"?(xe=J,J=0,Ee=this.length):typeof Ee=="string"&&(xe=Ee,Ee=this.length),K.length===1){var Je=K.charCodeAt(0);Je<256&&(K=Je)}if(xe!==void 0&&typeof xe!="string")throw new TypeError("encoding must be a string");if(typeof xe=="string"&&!u.isEncoding(xe))throw new TypeError("Unknown encoding: "+xe)}else typeof K=="number"&&(K=K&255);if(J<0||this.length<J||this.length<Ee)throw new RangeError("Out of range index");if(Ee<=J)return this;J=J>>>0,Ee=Ee===void 0?this.length:Ee>>>0,K||(K=0);var Xe;if(typeof K=="number")for(Xe=J;Xe<Ee;++Xe)this[Xe]=K;else{var Mt=u.isBuffer(K)?K:ee(new u(K,xe).toString()),qe=Mt.length;for(Xe=0;Xe<Ee-J;++Xe)this[Xe+J]=Mt[Xe%qe]}return this};var H=/[^+\/0-9A-Za-z-_]/g;function j(ve){if(ve=q(ve).replace(H,""),ve.length<2)return"";for(;ve.length%4!=0;)ve=ve+"=";return ve}function q(ve){return ve.trim?ve.trim():ve.replace(/^\s+|\s+$/g,"")}function pe(ve){return ve<16?"0"+ve.toString(16):ve.toString(16)}function ee(ve,K){K=K||1/0;for(var J,Ee=ve.length,xe=null,Je=[],Xe=0;Xe<Ee;++Xe){if(J=ve.charCodeAt(Xe),J>55295&&J<57344){if(!xe){if(J>56319){(K-=3)>-1&&Je.push(239,191,189);continue}else if(Xe+1===Ee){(K-=3)>-1&&Je.push(239,191,189);continue}xe=J;continue}if(J<56320){(K-=3)>-1&&Je.push(239,191,189),xe=J;continue}J=(xe-55296<<10|J-56320)+65536}else xe&&(K-=3)>-1&&Je.push(239,191,189);if(xe=null,J<128){if((K-=1)<0)break;Je.push(J)}else if(J<2048){if((K-=2)<0)break;Je.push(J>>6|192,J&63|128)}else if(J<65536){if((K-=3)<0)break;Je.push(J>>12|224,J>>6&63|128,J&63|128)}else if(J<1114112){if((K-=4)<0)break;Je.push(J>>18|240,J>>12&63|128,J>>6&63|128,J&63|128)}else throw new Error("Invalid code point")}return Je}function te(ve){for(var K=[],J=0;J<ve.length;++J)K.push(ve.charCodeAt(J)&255);return K}function Se(ve,K){for(var J,Ee,xe,Je=[],Xe=0;Xe<ve.length&&!((K-=2)<0);++Xe)J=ve.charCodeAt(Xe),Ee=J>>8,xe=J%256,Je.push(xe),Je.push(Ee);return Je}function ke(ve){return f.toByteArray(j(ve))}function Be(ve,K,J,Ee){for(var xe=0;xe<Ee&&!(xe+J>=K.length||xe>=ve.length);++xe)K[xe+J]=ve[xe];return xe}function We(ve){return ve!==ve}}).call(this,typeof Ba!="undefined"?Ba:typeof self!="undefined"?self:typeof window!="undefined"?window:{},r("buffer").Buffer)},{"base64-js":3,buffer:6,ieee754:29,isarray:35}],7:[function(r,a,s){(function(){if(typeof window!="undefined")try{var o=new window.CustomEvent("test",{cancelable:!0});if(o.preventDefault(),o.defaultPrevented!==!0)throw new Error("Could not prevent default")}catch{var u=function(v,m){var g,y;return m=m||{},m.bubbles=!!m.bubbles,m.cancelable=!!m.cancelable,g=document.createEvent("CustomEvent"),g.initCustomEvent(v,m.bubbles,m.cancelable,m.detail),y=g.preventDefault,g.preventDefault=function(){y.call(this);try{Object.defineProperty(this,"defaultPrevented",{get:function(){return!0}})}catch{this.defaultPrevented=!0}},g};u.prototype=window.Event.prototype,window.CustomEvent=u}})()},{}],8:[function(r,a,s){s=a.exports=r("./debug"),s.log=f,s.formatArgs=u,s.save=v,s.load=m,s.useColors=o,s.storage=typeof chrome!="undefined"&&typeof chrome.storage!="undefined"?chrome.storage.local:g(),s.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function o(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}s.formatters.j=function(y){return JSON.stringify(y)};function u(){var y=arguments,b=this.useColors;if(y[0]=(b?"%c":"")+this.namespace+(b?" %c":" ")+y[0]+(b?"%c ":" "),!b)return y;var w="color: "+this.color;y=[y[0],w,"color: inherit"].concat(Array.prototype.slice.call(y,1));var A=0,M=0;return y[0].replace(/%[a-z%]/g,function(S){S!=="%%"&&(A++,S==="%c"&&(M=A))}),y.splice(M,0,w),y}function f(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function v(y){try{y==null?s.storage.removeItem("debug"):s.storage.debug=y}catch{}}function m(){var y;try{y=s.storage.debug}catch{}return y}s.enable(m());function g(){try{return window.localStorage}catch{}}},{"./debug":9}],9:[function(r,a,s){s=a.exports=f,s.coerce=y,s.disable=m,s.enable=v,s.enabled=g,s.names=[],s.skips=[],s.formatters={};var o=0;function u(){return s.colors[o++%s.colors.length]}function f(b){function w(){}w.enabled=!1;function A(){var S=A;S.useColors==null&&(S.useColors=s.useColors()),S.color==null&&S.useColors&&(S.color=u());var E=Array.prototype.slice.call(arguments);E[0]=s.coerce(E[0]),typeof E[0]!="string"&&(E=["%o"].concat(E));var T=0;E[0]=E[0].replace(/%([a-z%])/g,function(L,P){if(L==="%%")return L;T++;var N=s.formatters[P];if(typeof N=="function"){var F=E[T];L=N.call(S,F),E.splice(T,1),T--}return L}),typeof s.formatArgs=="function"&&(E=s.formatArgs.apply(S,E));var C=A.log||s.log||console.log.bind(console);C.apply(S,E)}A.enabled=!0;var M=s.enabled(b)?A:w;return M.namespace=b,M}function v(b){s.save(b);for(var w=(b||"").split(/[\s,]+/),A=w.length,M=0;M<A;M++)!w[M]||(b=w[M].replace(/\*/g,".*?"),b[0]==="-"?s.skips.push(new RegExp("^"+b.substr(1)+"$")):s.names.push(new RegExp("^"+b+"$")))}function m(){s.enable("")}function g(b){var w,A;for(w=0,A=s.skips.length;w<A;w++)if(s.skips[w].test(b))return!1;for(w=0,A=s.names.length;w<A;w++)if(s.names[w].test(b))return!0;return!1}function y(b){return b instanceof Error?b.stack||b.message:b}},{}],10:[function(r,a,s){var o=r("is-obj"),u=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable;function v(y){if(y==null)throw new TypeError("Sources cannot be null or undefined");return Object(y)}function m(y,b,w){var A=b[w];if(A!=null){if(u.call(y,w)&&(y[w]===void 0||y[w]===null))throw new TypeError("Cannot convert undefined or null to object ("+w+")");!u.call(y,w)||!o(A)?y[w]=A:y[w]=g(Object(y[w]),b[w])}}function g(y,b){if(y===b)return y;b=Object(b);for(var w in b)u.call(b,w)&&m(y,b,w);if(Object.getOwnPropertySymbols)for(var A=Object.getOwnPropertySymbols(b),M=0;M<A.length;M++)f.call(b,A[M])&&m(y,b,A[M]);return y}a.exports=function(b){b=v(b);for(var w=1;w<arguments.length;w++)g(b,arguments[w]);return b}},{"is-obj":34}],11:[function(r,a,s){var o=r("object-keys"),u=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",f=Object.prototype.toString,v=Array.prototype.concat,m=Object.defineProperty,g=function(M){return typeof M=="function"&&f.call(M)==="[object Function]"},y=function(){var M={};try{m(M,"x",{enumerable:!1,value:M});for(var S in M)return!1;return M.x===M}catch{return!1}},b=m&&y(),w=function(M,S,E,T){S in M&&(!g(T)||!T())||(b?m(M,S,{configurable:!0,enumerable:!1,value:E,writable:!0}):M[S]=E)},A=function(M,S){var E=arguments.length>2?arguments[2]:{},T=o(S);u&&(T=v.call(T,Object.getOwnPropertySymbols(S)));for(var C=0;C<T.length;C+=1)w(M,T[C],S[T[C]],E[T[C]])};A.supportsDescriptors=!!b,a.exports=A},{"object-keys":41}],12:[function(r,a,s){/*! (C) WebReflection Mit Style License */(function(o,u,f,v){function m(Dt,Ft){for(var $t=0,Pn=Dt.length;$t<Pn;$t++)P(Dt[$t],Ft)}function g(Dt){for(var Ft=0,$t=Dt.length,Pn;Ft<$t;Ft++)Pn=Dt[Ft],fr(Pn,_e[b(Pn)])}function y(Dt){return function(Ft){Se(Ft)&&(P(Ft,Dt),m(Ft.querySelectorAll(Ne),Dt))}}function b(Dt){var Ft=We.call(Dt,"is"),$t=Dt.nodeName.toUpperCase(),Pn=Ve.call(ge,Ft?W+Ft.toUpperCase():U+$t);return Ft&&-1<Pn&&!w($t,Ft)?-1:Pn}function w(Dt,Ft){return-1<Ne.indexOf(Dt+'[is="'+Ft+'"]')}function A(Dt){var Ft=Dt.currentTarget,$t=Dt.attrChange,Pn=Dt.attrName,In=Dt.target;rn&&(!In||In===Ft)&&Ft.attributeChangedCallback&&Pn!=="style"&&Dt.prevValue!==Dt.newValue&&Ft.attributeChangedCallback(Pn,$t===Dt[ae]?null:Dt.prevValue,$t===Dt[de]?null:Dt.newValue)}function M(Dt){var Ft=y(Dt);return function($t){Je.push(Ft,$t.target)}}function S(Dt){It&&(It=!1,Dt.currentTarget.removeEventListener(I,S)),m((Dt.target||u).querySelectorAll(Ne),Dt.detail===X?X:F),te&&C()}function E(Dt,Ft){var $t=this;ve.call($t,Dt,Ft),Yt.call($t,{target:$t})}function T(Dt,Ft){q(Dt,Ft),Fn?Fn.observe(Dt,Ee):(qe&&(Dt.setAttribute=E,Dt[N]=Jt(Dt),Dt.addEventListener(k,Yt)),Dt.addEventListener(D,A)),Dt.createdCallback&&rn&&(Dt.created=!0,Dt.createdCallback(),Dt.created=!1)}function C(){for(var Dt,Ft=0,$t=ke.length;Ft<$t;Ft++)Dt=ke[Ft],Ie.contains(Dt)||($t--,ke.splice(Ft--,1),P(Dt,X))}function L(Dt){throw new Error("A "+Dt+" type is already registered")}function P(Dt,Ft){var $t,Pn=b(Dt);-1<Pn&&(mr(Dt,_e[Pn]),Pn=0,Ft===F&&!Dt[F]?(Dt[X]=!1,Dt[F]=!0,Pn=1,te&&Ve.call(ke,Dt)<0&&ke.push(Dt)):Ft===X&&!Dt[X]&&(Dt[F]=!1,Dt[X]=!0,Pn=1),Pn&&($t=Dt[Ft+"Callback"])&&$t.call(Dt))}if(!(v in u)){var N="__"+v+(Math.random()*1e5>>0),F="attached",X="detached",Y="extends",ae="ADDITION",$="MODIFICATION",de="REMOVAL",D="DOMAttrModified",I="DOMContentLoaded",k="DOMSubtreeModified",U="<",W="=",ce=/^[A-Z][A-Z0-9]*(?:-[A-Z0-9]+)+$/,oe=["ANNOTATION-XML","COLOR-PROFILE","FONT-FACE","FONT-FACE-SRC","FONT-FACE-URI","FONT-FACE-FORMAT","FONT-FACE-NAME","MISSING-GLYPH"],ge=[],_e=[],Ne="",Ie=u.documentElement,Ve=ge.indexOf||function(Dt){for(var Ft=this.length;Ft--&&this[Ft]!==Dt;);return Ft},Le=f.prototype,Fe=Le.hasOwnProperty,Me=Le.isPrototypeOf,Qe=f.defineProperty,mt=f.getOwnPropertyDescriptor,ht=f.getOwnPropertyNames,ye=f.getPrototypeOf,fe=f.setPrototypeOf,H=!!f.__proto__,j=f.create||function Dt(Ft){return Ft?(Dt.prototype=Ft,new Dt):this},q=fe||(H?function(Dt,Ft){return Dt.__proto__=Ft,Dt}:ht&&mt?function(){function Dt(Ft,$t){for(var Pn,In=ht($t),zn=0,bn=In.length;zn<bn;zn++)Pn=In[zn],Fe.call(Ft,Pn)||Qe(Ft,Pn,mt($t,Pn))}return function(Ft,$t){do Dt(Ft,$t);while(($t=ye($t))&&!Me.call($t,Ft));return Ft}}():function(Dt,Ft){for(var $t in Ft)Dt[$t]=Ft[$t];return Dt}),pe=o.MutationObserver||o.WebKitMutationObserver,ee=(o.HTMLElement||o.Element||o.Node).prototype,te=!Me.call(ee,Ie),Se=te?function(Dt){return Dt.nodeType===1}:function(Dt){return Me.call(ee,Dt)},ke=te&&[],Be=ee.cloneNode,We=ee.getAttribute,ve=ee.setAttribute,K=ee.removeAttribute,J=u.createElement,Ee=pe&&{attributes:!0,characterData:!0,attributeOldValue:!0},xe=pe||function(Dt){qe=!1,Ie.removeEventListener(D,xe)},Je,Xe=o.requestAnimationFrame||o.webkitRequestAnimationFrame||o.mozRequestAnimationFrame||o.msRequestAnimationFrame||function(Dt){setTimeout(Dt,10)},Mt=!1,qe=!0,It=!0,rn=!0,Yt,Tn,Jt,Fn,mr,fr;fe||H?(mr=function(Dt,Ft){Me.call(Ft,Dt)||T(Dt,Ft)},fr=T):(mr=function(Dt,Ft){Dt[N]||(Dt[N]=f(!0),T(Dt,Ft))},fr=mr),te?(qe=!1,function(){var Dt=mt(ee,"addEventListener"),Ft=Dt.value,$t=function(zn){var bn=new CustomEvent(D,{bubbles:!0});bn.attrName=zn,bn.prevValue=We.call(this,zn),bn.newValue=null,bn[de]=bn.attrChange=2,K.call(this,zn),this.dispatchEvent(bn)},Pn=function(zn,bn){var Jn=this.hasAttribute(zn),Er=Jn&&We.call(this,zn);e=new CustomEvent(D,{bubbles:!0}),ve.call(this,zn,bn),e.attrName=zn,e.prevValue=Jn?Er:null,e.newValue=bn,Jn?e[$]=e.attrChange=1:e[ae]=e.attrChange=0,this.dispatchEvent(e)},In=function(zn){var bn=zn.currentTarget,Jn=bn[N],Er=zn.propertyName,cr;Jn.hasOwnProperty(Er)&&(Jn=Jn[Er],cr=new CustomEvent(D,{bubbles:!0}),cr.attrName=Jn.name,cr.prevValue=Jn.value||null,cr.newValue=Jn.value=bn[Er]||null,cr.prevValue==null?cr[ae]=cr.attrChange=0:cr[$]=cr.attrChange=1,bn.dispatchEvent(cr))};Dt.value=function(zn,bn,Jn){zn===D&&this.attributeChangedCallback&&this.setAttribute!==Pn&&(this[N]={className:{name:"class",value:this.className}},this.setAttribute=Pn,this.removeAttribute=$t,Ft.call(this,"propertychange",In)),Ft.call(this,zn,bn,Jn)},Qe(ee,"addEventListener",Dt)}()):pe||(Ie.addEventListener(D,xe),Ie.setAttribute(N,1),Ie.removeAttribute(N),qe&&(Yt=function(Dt){var Ft=this,$t,Pn,In;if(Ft===Dt.target){$t=Ft[N],Ft[N]=Pn=Jt(Ft);for(In in Pn){if(!(In in $t))return Tn(0,Ft,In,$t[In],Pn[In],ae);if(Pn[In]!==$t[In])return Tn(1,Ft,In,$t[In],Pn[In],$)}for(In in $t)if(!(In in Pn))return Tn(2,Ft,In,$t[In],Pn[In],de)}},Tn=function(Dt,Ft,$t,Pn,In,zn){var bn={attrChange:Dt,currentTarget:Ft,attrName:$t,prevValue:Pn,newValue:In};bn[zn]=Dt,A(bn)},Jt=function(Dt){for(var Ft,$t,Pn={},In=Dt.attributes,zn=0,bn=In.length;zn<bn;zn++)Ft=In[zn],$t=Ft.name,$t!=="setAttribute"&&(Pn[$t]=Ft.value);return Pn})),u[v]=function(Dt,Ft){if(bn=Dt.toUpperCase(),Mt||(Mt=!0,pe?(Fn=function(Er,cr){function gi(Lr,vr){for(var je=0,_t=Lr.length;je<_t;vr(Lr[je++]));}return new pe(function(Lr){for(var vr,je,_t,Ot=0,At=Lr.length;Ot<At;Ot++)vr=Lr[Ot],vr.type==="childList"?(gi(vr.addedNodes,Er),gi(vr.removedNodes,cr)):(je=vr.target,rn&&je.attributeChangedCallback&&vr.attributeName!=="style"&&(_t=We.call(je,vr.attributeName),_t!==vr.oldValue&&je.attributeChangedCallback(vr.attributeName,vr.oldValue,_t)))})}(y(F),y(X)),Fn.observe(u,{childList:!0,subtree:!0})):(Je=[],Xe(function Er(){for(;Je.length;)Je.shift().call(null,Je.shift());Xe(Er)}),u.addEventListener("DOMNodeInserted",M(F)),u.addEventListener("DOMNodeRemoved",M(X))),u.addEventListener(I,S),u.addEventListener("readystatechange",S),u.createElement=function(Er,cr){var gi=J.apply(u,arguments),Lr=""+Er,vr=Ve.call(ge,(cr?W:U)+(cr||Lr).toUpperCase()),je=-1<vr;return cr&&(gi.setAttribute("is",cr=cr.toLowerCase()),je&&(je=w(Lr.toUpperCase(),cr))),rn=!u.createElement.innerHTMLHelper,je&&fr(gi,_e[vr]),gi},ee.cloneNode=function(Er){var cr=Be.call(this,!!Er),gi=b(cr);return-1<gi&&fr(cr,_e[gi]),Er&&g(cr.querySelectorAll(Ne)),cr}),-2<Ve.call(ge,W+bn)+Ve.call(ge,U+bn)&&L(Dt),!ce.test(bn)||-1<Ve.call(oe,bn))throw new Error("The type "+Dt+" is invalid");var $t=function(){return In?u.createElement(zn,bn):u.createElement(zn)},Pn=Ft||Le,In=Fe.call(Pn,Y),zn=In?Ft[Y].toUpperCase():bn,bn,Jn;return In&&-1<Ve.call(ge,U+zn)&&L(zn),Jn=ge.push((In?W:U)+bn)-1,Ne=Ne.concat(Ne.length?",":"",In?zn+'[is="'+Dt.toLowerCase()+'"]':zn),$t.prototype=_e[Jn]=Fe.call(Pn,"prototype")?Pn.prototype:j(ee),m(u.querySelectorAll(Ne),F),$t}}})(window,document,Object,"registerElement")},{}],13:[function(r,a,s){a.exports=function(o){switch(o){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],14:[function(r,a,s){var o,u=Object.getOwnPropertyDescriptor?function(){return Object.getOwnPropertyDescriptor(arguments,"callee").get}():function(){throw new TypeError},f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol",v=Object.getPrototypeOf||function(A){return A.__proto__},m=o,g=o,y=o,b=typeof Uint8Array=="undefined"?o:v(Uint8Array),w={"$ %Array%":Array,"$ %ArrayBuffer%":typeof ArrayBuffer=="undefined"?o:ArrayBuffer,"$ %ArrayBufferPrototype%":typeof ArrayBuffer=="undefined"?o:ArrayBuffer.prototype,"$ %ArrayIteratorPrototype%":f?v([][Symbol.iterator]()):o,"$ %ArrayPrototype%":Array.prototype,"$ %ArrayProto_entries%":Array.prototype.entries,"$ %ArrayProto_forEach%":Array.prototype.forEach,"$ %ArrayProto_keys%":Array.prototype.keys,"$ %ArrayProto_values%":Array.prototype.values,"$ %AsyncFromSyncIteratorPrototype%":o,"$ %AsyncFunction%":g,"$ %AsyncFunctionPrototype%":o,"$ %AsyncGenerator%":o,"$ %AsyncGeneratorFunction%":y,"$ %AsyncGeneratorPrototype%":o,"$ %AsyncIteratorPrototype%":o,"$ %Atomics%":typeof Atomics=="undefined"?o:Atomics,"$ %Boolean%":Boolean,"$ %BooleanPrototype%":Boolean.prototype,"$ %DataView%":typeof DataView=="undefined"?o:DataView,"$ %DataViewPrototype%":typeof DataView=="undefined"?o:DataView.prototype,"$ %Date%":Date,"$ %DatePrototype%":Date.prototype,"$ %decodeURI%":decodeURI,"$ %decodeURIComponent%":decodeURIComponent,"$ %encodeURI%":encodeURI,"$ %encodeURIComponent%":encodeURIComponent,"$ %Error%":Error,"$ %ErrorPrototype%":Error.prototype,"$ %eval%":eval,"$ %EvalError%":EvalError,"$ %EvalErrorPrototype%":EvalError.prototype,"$ %Float32Array%":typeof Float32Array=="undefined"?o:Float32Array,"$ %Float32ArrayPrototype%":typeof Float32Array=="undefined"?o:Float32Array.prototype,"$ %Float64Array%":typeof Float64Array=="undefined"?o:Float64Array,"$ %Float64ArrayPrototype%":typeof Float64Array=="undefined"?o:Float64Array.prototype,"$ %Function%":Function,"$ %FunctionPrototype%":Function.prototype,"$ %Generator%":o,"$ %GeneratorFunction%":m,"$ %GeneratorPrototype%":o,"$ %Int8Array%":typeof Int8Array=="undefined"?o:Int8Array,"$ %Int8ArrayPrototype%":typeof Int8Array=="undefined"?o:Int8Array.prototype,"$ %Int16Array%":typeof Int16Array=="undefined"?o:Int16Array,"$ %Int16ArrayPrototype%":typeof Int16Array=="undefined"?o:Int8Array.prototype,"$ %Int32Array%":typeof Int32Array=="undefined"?o:Int32Array,"$ %Int32ArrayPrototype%":typeof Int32Array=="undefined"?o:Int32Array.prototype,"$ %isFinite%":isFinite,"$ %isNaN%":isNaN,"$ %IteratorPrototype%":f?v(v([][Symbol.iterator]())):o,"$ %JSON%":JSON,"$ %JSONParse%":JSON.parse,"$ %Map%":typeof Map=="undefined"?o:Map,"$ %MapIteratorPrototype%":typeof Map=="undefined"||!f?o:v(new Map()[Symbol.iterator]()),"$ %MapPrototype%":typeof Map=="undefined"?o:Map.prototype,"$ %Math%":Math,"$ %Number%":Number,"$ %NumberPrototype%":Number.prototype,"$ %Object%":Object,"$ %ObjectPrototype%":Object.prototype,"$ %ObjProto_toString%":Object.prototype.toString,"$ %ObjProto_valueOf%":Object.prototype.valueOf,"$ %parseFloat%":parseFloat,"$ %parseInt%":parseInt,"$ %Promise%":typeof Promise=="undefined"?o:Promise,"$ %PromisePrototype%":typeof Promise=="undefined"?o:Promise.prototype,"$ %PromiseProto_then%":typeof Promise=="undefined"?o:Promise.prototype.then,"$ %Promise_all%":typeof Promise=="undefined"?o:Promise.all,"$ %Promise_reject%":typeof Promise=="undefined"?o:Promise.reject,"$ %Promise_resolve%":typeof Promise=="undefined"?o:Promise.resolve,"$ %Proxy%":typeof Proxy=="undefined"?o:Proxy,"$ %RangeError%":RangeError,"$ %RangeErrorPrototype%":RangeError.prototype,"$ %ReferenceError%":ReferenceError,"$ %ReferenceErrorPrototype%":ReferenceError.prototype,"$ %Reflect%":typeof Reflect=="undefined"?o:Reflect,"$ %RegExp%":RegExp,"$ %RegExpPrototype%":RegExp.prototype,"$ %Set%":typeof Set=="undefined"?o:Set,"$ %SetIteratorPrototype%":typeof Set=="undefined"||!f?o:v(new Set()[Symbol.iterator]()),"$ %SetPrototype%":typeof Set=="undefined"?o:Set.prototype,"$ %SharedArrayBuffer%":typeof SharedArrayBuffer=="undefined"?o:SharedArrayBuffer,"$ %SharedArrayBufferPrototype%":typeof SharedArrayBuffer=="undefined"?o:SharedArrayBuffer.prototype,"$ %String%":String,"$ %StringIteratorPrototype%":f?v(""[Symbol.iterator]()):o,"$ %StringPrototype%":String.prototype,"$ %Symbol%":f?Symbol:o,"$ %SymbolPrototype%":f?Symbol.prototype:o,"$ %SyntaxError%":SyntaxError,"$ %SyntaxErrorPrototype%":SyntaxError.prototype,"$ %ThrowTypeError%":u,"$ %TypedArray%":b,"$ %TypedArrayPrototype%":b?b.prototype:o,"$ %TypeError%":TypeError,"$ %TypeErrorPrototype%":TypeError.prototype,"$ %Uint8Array%":typeof Uint8Array=="undefined"?o:Uint8Array,"$ %Uint8ArrayPrototype%":typeof Uint8Array=="undefined"?o:Uint8Array.prototype,"$ %Uint8ClampedArray%":typeof Uint8ClampedArray=="undefined"?o:Uint8ClampedArray,"$ %Uint8ClampedArrayPrototype%":typeof Uint8ClampedArray=="undefined"?o:Uint8ClampedArray.prototype,"$ %Uint16Array%":typeof Uint16Array=="undefined"?o:Uint16Array,"$ %Uint16ArrayPrototype%":typeof Uint16Array=="undefined"?o:Uint16Array.prototype,"$ %Uint32Array%":typeof Uint32Array=="undefined"?o:Uint32Array,"$ %Uint32ArrayPrototype%":typeof Uint32Array=="undefined"?o:Uint32Array.prototype,"$ %URIError%":URIError,"$ %URIErrorPrototype%":URIError.prototype,"$ %WeakMap%":typeof WeakMap=="undefined"?o:WeakMap,"$ %WeakMapPrototype%":typeof WeakMap=="undefined"?o:WeakMap.prototype,"$ %WeakSet%":typeof WeakSet=="undefined"?o:WeakSet,"$ %WeakSetPrototype%":typeof WeakSet=="undefined"?o:WeakSet.prototype};a.exports=function(M,S){if(arguments.length>1&&typeof S!="boolean")throw new TypeError('"allowMissing" argument must be a boolean');var E="$ "+M;if(!(E in w))throw new SyntaxError("intrinsic "+M+" does not exist!");if(typeof w[E]=="undefined"&&!S)throw new TypeError("intrinsic "+M+" exists, but is not available. Please file an issue!");return w[E]}},{}],15:[function(r,a,s){var o=r("./GetIntrinsic"),u=o("%Object%"),f=o("%TypeError%"),v=o("%String%"),m=r("./helpers/assertRecord"),g=r("./helpers/isNaN"),y=r("./helpers/isFinite"),b=r("./helpers/sign"),w=r("./helpers/mod"),A=r("is-callable"),M=r("es-to-primitive/es5"),S=r("has"),E={ToPrimitive:M,ToBoolean:function(C){return!!C},ToNumber:function(C){return+C},ToInteger:function(C){var L=this.ToNumber(C);return g(L)?0:L===0||!y(L)?L:b(L)*Math.floor(Math.abs(L))},ToInt32:function(C){return this.ToNumber(C)>>0},ToUint32:function(C){return this.ToNumber(C)>>>0},ToUint16:function(C){var L=this.ToNumber(C);if(g(L)||L===0||!y(L))return 0;var P=b(L)*Math.floor(Math.abs(L));return w(P,65536)},ToString:function(C){return v(C)},ToObject:function(C){return this.CheckObjectCoercible(C),u(C)},CheckObjectCoercible:function(C,L){if(C==null)throw new f(L||"Cannot call method on "+C);return C},IsCallable:A,SameValue:function(C,L){return C===L?C===0?1/C==1/L:!0:g(C)&&g(L)},Type:function(C){if(C===null)return"Null";if(typeof C=="undefined")return"Undefined";if(typeof C=="function"||typeof C=="object")return"Object";if(typeof C=="number")return"Number";if(typeof C=="boolean")return"Boolean";if(typeof C=="string")return"String"},IsPropertyDescriptor:function(C){if(this.Type(C)!=="Object")return!1;var L={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var P in C)if(S(C,P)&&!L[P])return!1;var N=S(C,"[[Value]]"),F=S(C,"[[Get]]")||S(C,"[[Set]]");if(N&&F)throw new f("Property Descriptors may not be both accessor and data descriptors");return!0},IsAccessorDescriptor:function(C){return!(typeof C=="undefined"||(m(this,"Property Descriptor","Desc",C),!S(C,"[[Get]]")&&!S(C,"[[Set]]")))},IsDataDescriptor:function(C){return!(typeof C=="undefined"||(m(this,"Property Descriptor","Desc",C),!S(C,"[[Value]]")&&!S(C,"[[Writable]]")))},IsGenericDescriptor:function(C){return typeof C=="undefined"?!1:(m(this,"Property Descriptor","Desc",C),!this.IsAccessorDescriptor(C)&&!this.IsDataDescriptor(C))},FromPropertyDescriptor:function(C){if(typeof C=="undefined")return C;if(m(this,"Property Descriptor","Desc",C),this.IsDataDescriptor(C))return{value:C["[[Value]]"],writable:!!C["[[Writable]]"],enumerable:!!C["[[Enumerable]]"],configurable:!!C["[[Configurable]]"]};if(this.IsAccessorDescriptor(C))return{get:C["[[Get]]"],set:C["[[Set]]"],enumerable:!!C["[[Enumerable]]"],configurable:!!C["[[Configurable]]"]};throw new f("FromPropertyDescriptor must be called with a fully populated Property Descriptor")},ToPropertyDescriptor:function(C){if(this.Type(C)!=="Object")throw new f("ToPropertyDescriptor requires an object");var L={};if(S(C,"enumerable")&&(L["[[Enumerable]]"]=this.ToBoolean(C.enumerable)),S(C,"configurable")&&(L["[[Configurable]]"]=this.ToBoolean(C.configurable)),S(C,"value")&&(L["[[Value]]"]=C.value),S(C,"writable")&&(L["[[Writable]]"]=this.ToBoolean(C.writable)),S(C,"get")){var P=C.get;if(typeof P!="undefined"&&!this.IsCallable(P))throw new TypeError("getter must be a function");L["[[Get]]"]=P}if(S(C,"set")){var N=C.set;if(typeof N!="undefined"&&!this.IsCallable(N))throw new f("setter must be a function");L["[[Set]]"]=N}if((S(L,"[[Get]]")||S(L,"[[Set]]"))&&(S(L,"[[Value]]")||S(L,"[[Writable]]")))throw new f("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return L}};a.exports=E},{"./GetIntrinsic":14,"./helpers/assertRecord":16,"./helpers/isFinite":17,"./helpers/isNaN":18,"./helpers/mod":19,"./helpers/sign":20,"es-to-primitive/es5":21,has:28,"is-callable":32}],16:[function(r,a,s){var o=r("../GetIntrinsic"),u=o("%TypeError%"),f=o("%SyntaxError%"),v=r("has"),m={"Property Descriptor":function(y,b){if(y.Type(b)!=="Object")return!1;var w={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var A in b)if(v(b,A)&&!w[A])return!1;var M=v(b,"[[Value]]"),S=v(b,"[[Get]]")||v(b,"[[Set]]");if(M&&S)throw new u("Property Descriptors may not be both accessor and data descriptors");return!0}};a.exports=function(y,b,w,A){var M=m[b];if(typeof M!="function")throw new f("unknown record type: "+b);if(!M(y,A))throw new u(w+" must be a "+b);console.log(M(y,A),A)}},{"../GetIntrinsic":14,has:28}],17:[function(r,a,s){var o=Number.isNaN||function(u){return u!==u};a.exports=Number.isFinite||function(u){return typeof u=="number"&&!o(u)&&u!==1/0&&u!==-1/0}},{}],18:[function(r,a,s){a.exports=Number.isNaN||function(u){return u!==u}},{}],19:[function(r,a,s){a.exports=function(u,f){var v=u%f;return Math.floor(v>=0?v:v+f)}},{}],20:[function(r,a,s){a.exports=function(u){return u>=0?1:-1}},{}],21:[function(r,a,s){var o=Object.prototype.toString,u=r("./helpers/isPrimitive"),f=r("is-callable"),v={"[[DefaultValue]]":function(m){var g;if(arguments.length>1?g=arguments[1]:g=o.call(m)==="[object Date]"?String:Number,g===String||g===Number){var y=g===String?["toString","valueOf"]:["valueOf","toString"],b,w;for(w=0;w<y.length;++w)if(f(m[y[w]])&&(b=m[y[w]](),u(b)))return b;throw new TypeError("No default value")}throw new TypeError("invalid [[DefaultValue]] hint supplied")}};a.exports=function(g){return u(g)?g:arguments.length>1?v["[[DefaultValue]]"](g,arguments[1]):v["[[DefaultValue]]"](g)}},{"./helpers/isPrimitive":22,"is-callable":32}],22:[function(r,a,s){a.exports=function(u){return u===null||typeof u!="function"&&typeof u!="object"}},{}],23:[function(r,a,s){var o=r("dtype");a.exports=u;function u(f,v,m){if(!f)throw new TypeError("must specify data as first parameter");if(m=+(m||0)|0,Array.isArray(f)&&f[0]&&typeof f[0][0]=="number"){var g=f[0].length,y=f.length*g,b,w,A,M;(!v||typeof v=="string")&&(v=new(o(v||"float32"))(y+m));var S=v.length-m;if(y!==S)throw new Error("source length "+y+" ("+g+"x"+f.length+") does not match destination length "+S);for(b=0,A=m;b<f.length;b++)for(w=0;w<g;w++)v[A++]=f[b][w]===null?NaN:f[b][w]}else if(!v||typeof v=="string"){var E=o(v||"float32");if(Array.isArray(f)||v==="array")for(v=new E(f.length+m),b=0,A=m,M=v.length;A<M;A++,b++)v[A]=f[b]===null?NaN:f[b];else m===0?v=new E(f):(v=new E(f.length+m),v.set(f,m))}else v.set(f,m);return v}},{dtype:13}],24:[function(r,a,s){var o=r("is-callable"),u=Object.prototype.toString,f=Object.prototype.hasOwnProperty,v=function(w,A,M){for(var S=0,E=w.length;S<E;S++)f.call(w,S)&&(M==null?A(w[S],S,w):A.call(M,w[S],S,w))},m=function(w,A,M){for(var S=0,E=w.length;S<E;S++)M==null?A(w.charAt(S),S,w):A.call(M,w.charAt(S),S,w)},g=function(w,A,M){for(var S in w)f.call(w,S)&&(M==null?A(w[S],S,w):A.call(M,w[S],S,w))},y=function(w,A,M){if(!o(A))throw new TypeError("iterator must be a function");var S;arguments.length>=3&&(S=M),u.call(w)==="[object Array]"?v(w,A,S):typeof w=="string"?m(w,A,S):g(w,A,S)};a.exports=y},{"is-callable":32}],25:[function(r,a,s){var o="Function.prototype.bind called on incompatible ",u=Array.prototype.slice,f=Object.prototype.toString,v="[object Function]";a.exports=function(g){var y=this;if(typeof y!="function"||f.call(y)!==v)throw new TypeError(o+y);for(var b=u.call(arguments,1),w,A=function(){if(this instanceof w){var C=y.apply(this,b.concat(u.call(arguments)));return Object(C)===C?C:this}else return y.apply(g,b.concat(u.call(arguments)))},M=Math.max(0,y.length-b.length),S=[],E=0;E<M;E++)S.push("$"+E);if(w=Function("binder","return function ("+S.join(",")+"){ return binder.apply(this,arguments); }")(A),y.prototype){var T=function(){};T.prototype=y.prototype,w.prototype=new T,T.prototype=null}return w}},{}],26:[function(r,a,s){var o=r("./implementation");a.exports=Function.prototype.bind||o},{"./implementation":25}],27:[function(r,a,s){(function(o){var u;typeof window!="undefined"?u=window:typeof o!="undefined"?u=o:typeof self!="undefined"?u=self:u={},a.exports=u}).call(this,typeof Ba!="undefined"?Ba:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],28:[function(r,a,s){var o=r("function-bind");a.exports=o.call(Function.call,Object.prototype.hasOwnProperty)},{"function-bind":26}],29:[function(r,a,s){s.read=function(o,u,f,v,m){var g,y,b=m*8-v-1,w=(1<<b)-1,A=w>>1,M=-7,S=f?m-1:0,E=f?-1:1,T=o[u+S];for(S+=E,g=T&(1<<-M)-1,T>>=-M,M+=b;M>0;g=g*256+o[u+S],S+=E,M-=8);for(y=g&(1<<-M)-1,g>>=-M,M+=v;M>0;y=y*256+o[u+S],S+=E,M-=8);if(g===0)g=1-A;else{if(g===w)return y?NaN:(T?-1:1)*(1/0);y=y+Math.pow(2,v),g=g-A}return(T?-1:1)*y*Math.pow(2,g-v)},s.write=function(o,u,f,v,m,g){var y,b,w,A=g*8-m-1,M=(1<<A)-1,S=M>>1,E=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,T=v?0:g-1,C=v?1:-1,L=u<0||u===0&&1/u<0?1:0;for(u=Math.abs(u),isNaN(u)||u===1/0?(b=isNaN(u)?1:0,y=M):(y=Math.floor(Math.log(u)/Math.LN2),u*(w=Math.pow(2,-y))<1&&(y--,w*=2),y+S>=1?u+=E/w:u+=E*Math.pow(2,1-S),u*w>=2&&(y++,w/=2),y+S>=M?(b=0,y=M):y+S>=1?(b=(u*w-1)*Math.pow(2,m),y=y+S):(b=u*Math.pow(2,S-1)*Math.pow(2,m),y=0));m>=8;o[f+T]=b&255,T+=C,b/=256,m-=8);for(y=y<<m|b,A+=m;A>0;o[f+T]=y&255,T+=C,y/=256,A-=8);o[f+T-C]|=L*128}},{}],30:[function(r,a,s){typeof Object.create=="function"?a.exports=function(u,f){f&&(u.super_=f,u.prototype=Object.create(f.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}))}:a.exports=function(u,f){if(f){u.super_=f;var v=function(){};v.prototype=f.prototype,u.prototype=new v,u.prototype.constructor=u}}},{}],31:[function(r,a,s){/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */a.exports=function(f){return f!=null&&(o(f)||u(f)||!!f._isBuffer)};function o(f){return!!f.constructor&&typeof f.constructor.isBuffer=="function"&&f.constructor.isBuffer(f)}function u(f){return typeof f.readFloatLE=="function"&&typeof f.slice=="function"&&o(f.slice(0,0))}},{}],32:[function(r,a,s){var o=Function.prototype.toString,u=/^\s*class\b/,f=function(A){try{var M=o.call(A);return u.test(M)}catch{return!1}},v=function(A){try{return f(A)?!1:(o.call(A),!0)}catch{return!1}},m=Object.prototype.toString,g="[object Function]",y="[object GeneratorFunction]",b=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol";a.exports=function(A){if(!A||typeof A!="function"&&typeof A!="object")return!1;if(typeof A=="function"&&!A.prototype)return!0;if(b)return v(A);if(f(A))return!1;var M=m.call(A);return M===g||M===y}},{}],33:[function(r,a,s){a.exports=u;var o=Object.prototype.toString;function u(f){var v=o.call(f);return v==="[object Function]"||typeof f=="function"&&v!=="[object RegExp]"||typeof window!="undefined"&&(f===window.setTimeout||f===window.alert||f===window.confirm||f===window.prompt)}},{}],34:[function(r,a,s){a.exports=function(o){var u=typeof o;return o!==null&&(u==="object"||u==="function")}},{}],35:[function(r,a,s){var o={}.toString;a.exports=Array.isArray||function(u){return o.call(u)=="[object Array]"}},{}],36:[function(r,a,s){var o=r("word-wrapper"),u=r("xtend"),f=r("as-number"),v=["x","e","a","o","n","s","r","c","u","m","v","w","z"],m=["m","w"],g=["H","I","N","E","F","K","L","T","U","V","W","X","Y","Z"],y="	".charCodeAt(0),b=" ".charCodeAt(0),w=0,A=1,M=2;a.exports=function($){return new S($)};function S(ae){this.glyphs=[],this._measure=this.computeMetrics.bind(this),this.update(ae)}S.prototype.update=function(ae){if(ae=u({measure:this._measure},ae),this._opt=ae,this._opt.tabSize=f(this._opt.tabSize,4),!ae.font)throw new Error("must provide a valid bitmap font");var $=this.glyphs,de=ae.text||"",D=ae.font;this._setupSpaceGlyphs(D);var I=o.lines(de,ae),k=ae.width||0;$.length=0;var U=I.reduce(function(Fe,Me){return Math.max(Fe,Me.width,k)},0),W=0,ce=0,oe=f(ae.lineHeight,D.common.lineHeight),ge=D.common.base,_e=oe-ge,Ne=ae.letterSpacing||0,Ie=oe*I.length-_e,Ve=X(this._opt.align);ce-=Ie,this._width=U,this._height=Ie,this._descender=oe-ge,this._baseline=ge,this._xHeight=L(D),this._capHeight=N(D),this._lineHeight=oe,this._ascender=oe-_e-this._xHeight;var Le=this;I.forEach(function(Fe,Me){for(var Qe=Fe.start,mt=Fe.end,ht=Fe.width,ye,fe=Qe;fe<mt;fe++){var H=de.charCodeAt(fe),j=Le.getGlyph(D,H);if(j){ye&&(W+=F(D,ye.id,j.id));var q=W;Ve===A?q+=(U-ht)/2:Ve===M&&(q+=U-ht),$.push({position:[q,ce],data:j,index:fe,line:Me}),W+=j.xadvance+Ne,ye=j}}ce+=oe,W=0}),this._linesTotal=I.length},S.prototype._setupSpaceGlyphs=function(ae){if(this._fallbackSpaceGlyph=null,this._fallbackTabGlyph=null,!(!ae.chars||ae.chars.length===0)){var $=C(ae,b)||P(ae)||ae.chars[0],de=this._opt.tabSize*$.xadvance;this._fallbackSpaceGlyph=$,this._fallbackTabGlyph=u($,{x:0,y:0,xadvance:de,id:y,xoffset:0,yoffset:0,width:0,height:0})}},S.prototype.getGlyph=function(ae,$){var de=C(ae,$);return de||($===y?this._fallbackTabGlyph:$===b?this._fallbackSpaceGlyph:null)},S.prototype.computeMetrics=function(ae,$,de,D){var I=this._opt.letterSpacing||0,k=this._opt.font,U=0,W=0,ce=0,oe,ge;if(!k.chars||k.chars.length===0)return{start:$,end:$,width:0};de=Math.min(ae.length,de);for(var _e=$;_e<de;_e++){var Ne=ae.charCodeAt(_e),oe=this.getGlyph(k,Ne);if(oe){oe.xoffset;var Ie=ge?F(k,ge.id,oe.id):0;U+=Ie;var Ve=U+oe.xadvance+I,Le=U+oe.width;if(Le>=D||Ve>=D)break;U=Ve,W=Le,ge=oe}ce++}return ge&&(W+=ge.xoffset),{start:$,end:$+ce,width:W}},["width","height","descender","ascender","xHeight","baseline","capHeight","lineHeight"].forEach(E);function E(ae){Object.defineProperty(S.prototype,ae,{get:T(ae),configurable:!0})}function T(ae){return new Function(["return function "+ae+"() {","  return this._"+ae,"}"].join(`
`))()}function C(ae,$){if(!ae.chars||ae.chars.length===0)return null;var de=Y(ae.chars,$);return de>=0?ae.chars[de]:null}function L(ae){for(var $=0;$<v.length;$++){var de=v[$].charCodeAt(0),D=Y(ae.chars,de);if(D>=0)return ae.chars[D].height}return 0}function P(ae){for(var $=0;$<m.length;$++){var de=m[$].charCodeAt(0),D=Y(ae.chars,de);if(D>=0)return ae.chars[D]}return 0}function N(ae){for(var $=0;$<g.length;$++){var de=g[$].charCodeAt(0),D=Y(ae.chars,de);if(D>=0)return ae.chars[D].height}return 0}function F(ae,$,de){if(!ae.kernings||ae.kernings.length===0)return 0;for(var D=ae.kernings,I=0;I<D.length;I++){var k=D[I];if(k.first===$&&k.second===de)return k.amount}return 0}function X(ae){return ae==="center"?A:ae==="right"?M:w}function Y(ae,$,de){de=de||0;for(var D=de;D<ae.length;D++)if(ae[D].id===$)return D;return-1}},{"as-number":2,"word-wrapper":69,xtend:72}],37:[function(r,a,s){(function(o){var u=r("xhr"),f=function(){},v=r("parse-bmfont-ascii"),m=r("parse-bmfont-xml"),g=r("parse-bmfont-binary"),y=r("./lib/is-binary"),b=r("xtend"),w=function(){return self.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}();a.exports=function(S,E){E=typeof E=="function"?E:f,typeof S=="string"?S={uri:S}:S||(S={});var T=S.binary;T&&(S=M(S)),u(S,function(C,L,P){if(C)return E(C);if(!/^2/.test(L.statusCode))return E(new Error("http status code: "+L.statusCode));if(!P)return E(new Error("no body result"));var N=!1;if(A(P)){var F=new Uint8Array(P);P=new o(F,"binary")}y(P)&&(N=!0,typeof P=="string"&&(P=new o(P,"binary"))),N||(o.isBuffer(P)&&(P=P.toString(S.encoding)),P=P.trim());var X;try{var Y=L.headers["content-type"];N?X=g(P):/json/.test(Y)||P.charAt(0)==="{"?X=JSON.parse(P):/xml/.test(Y)||P.charAt(0)==="<"?X=m(P):X=v(P)}catch(ae){E(new Error("error parsing font "+ae.message)),E=f}E(null,X)})};function A(S){var E=Object.prototype.toString;return E.call(S)==="[object ArrayBuffer]"}function M(S){if(w)return b(S,{responseType:"arraybuffer"});if(typeof self.XMLHttpRequest=="undefined")throw new Error("your browser does not support XHR loading");var E=new self.XMLHttpRequest;return E.overrideMimeType("text/plain; charset=x-user-defined"),b({xhr:E},S)}}).call(this,r("buffer").Buffer)},{"./lib/is-binary":38,buffer:6,"parse-bmfont-ascii":43,"parse-bmfont-binary":44,"parse-bmfont-xml":45,xhr:70,xtend:72}],38:[function(r,a,s){(function(o){var u=r("buffer-equal"),f=new o([66,77,70,3]);a.exports=function(v){return typeof v=="string"?v.substring(0,3)==="BMF":v.length>4&&u(v.slice(0,4),f)}}).call(this,r("buffer").Buffer)},{buffer:6,"buffer-equal":5}],39:[function(r,a,s){var o=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable;function v(g){if(g==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(g)}function m(){try{if(!Object.assign)return!1;var g=new String("abc");if(g[5]="de",Object.getOwnPropertyNames(g)[0]==="5")return!1;for(var y={},b=0;b<10;b++)y["_"+String.fromCharCode(b)]=b;var w=Object.getOwnPropertyNames(y).map(function(M){return y[M]});if(w.join("")!=="0123456789")return!1;var A={};return"abcdefghijklmnopqrst".split("").forEach(function(M){A[M]=M}),Object.keys(Object.assign({},A)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}a.exports=m()?Object.assign:function(g,y){for(var b,w=v(g),A,M=1;M<arguments.length;M++){b=Object(arguments[M]);for(var S in b)u.call(b,S)&&(w[S]=b[S]);if(o){A=o(b);for(var E=0;E<A.length;E++)f.call(b,A[E])&&(w[A[E]]=b[A[E]])}}return w}},{}],40:[function(r,a,s){var o;if(!Object.keys){var u=Object.prototype.hasOwnProperty,f=Object.prototype.toString,v=r("./isArguments"),m=Object.prototype.propertyIsEnumerable,g=!m.call({toString:null},"toString"),y=m.call(function(){},"prototype"),b=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],w=function(E){var T=E.constructor;return T&&T.prototype===E},A={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},M=function(){if(typeof window=="undefined")return!1;for(var E in window)try{if(!A["$"+E]&&u.call(window,E)&&window[E]!==null&&typeof window[E]=="object")try{w(window[E])}catch{return!0}}catch{return!0}return!1}(),S=function(E){if(typeof window=="undefined"||!M)return w(E);try{return w(E)}catch{return!1}};o=function(T){var C=T!==null&&typeof T=="object",L=f.call(T)==="[object Function]",P=v(T),N=C&&f.call(T)==="[object String]",F=[];if(!C&&!L&&!P)throw new TypeError("Object.keys called on a non-object");var X=y&&L;if(N&&T.length>0&&!u.call(T,0))for(var Y=0;Y<T.length;++Y)F.push(String(Y));if(P&&T.length>0)for(var ae=0;ae<T.length;++ae)F.push(String(ae));else for(var $ in T)!(X&&$==="prototype")&&u.call(T,$)&&F.push(String($));if(g)for(var de=S(T),D=0;D<b.length;++D)!(de&&b[D]==="constructor")&&u.call(T,b[D])&&F.push(b[D]);return F}}a.exports=o},{"./isArguments":42}],41:[function(r,a,s){var o=Array.prototype.slice,u=r("./isArguments"),f=Object.keys,v=f?function(y){return f(y)}:r("./implementation"),m=Object.keys;v.shim=function(){if(Object.keys){var y=function(){var b=Object.keys(arguments);return b&&b.length===arguments.length}(1,2);y||(Object.keys=function(w){return u(w)?m(o.call(w)):m(w)})}else Object.keys=v;return Object.keys||v},a.exports=v},{"./implementation":40,"./isArguments":42}],42:[function(r,a,s){var o=Object.prototype.toString;a.exports=function(f){var v=o.call(f),m=v==="[object Arguments]";return m||(m=v!=="[object Array]"&&f!==null&&typeof f=="object"&&typeof f.length=="number"&&f.length>=0&&o.call(f.callee)==="[object Function]"),m}},{}],43:[function(r,a,s){a.exports=function(m){if(!m)throw new Error("no data provided");m=m.toString().trim();var g={pages:[],chars:[],kernings:[]},y=m.split(/\r\n?|\n/g);if(y.length===0)throw new Error("no data in BMFont file");for(var b=0;b<y.length;b++){var w=o(y[b],b);if(!!w)if(w.key==="page"){if(typeof w.data.id!="number")throw new Error("malformed file at line "+b+" -- needs page id=N");if(typeof w.data.file!="string")throw new Error("malformed file at line "+b+' -- needs page file="path"');g.pages[w.data.id]=w.data.file}else w.key==="chars"||w.key==="kernings"||(w.key==="char"?g.chars.push(w.data):w.key==="kerning"?g.kernings.push(w.data):g[w.key]=w.data)}return g};function o(v,m){if(v=v.replace(/\t+/g," ").trim(),!v)return null;var g=v.indexOf(" ");if(g===-1)throw new Error("no named row at line "+m);var y=v.substring(0,g);v=v.substring(g+1),v=v.replace(/letter=[\'\"]\S+[\'\"]/gi,""),v=v.split("="),v=v.map(function(S){return S.trim().match(/(".*?"|[^"\s]+)+(?=\s*|\s*$)/g)});for(var b=[],w=0;w<v.length;w++){var A=v[w];w===0?b.push({key:A[0],data:""}):w===v.length-1?b[b.length-1].data=u(A[0]):(b[b.length-1].data=u(A[0]),b.push({key:A[1],data:""}))}var M={key:y,data:{}};return b.forEach(function(S){M.data[S.key]=S.data}),M}function u(v){return!v||v.length===0?"":v.indexOf('"')===0||v.indexOf("'")===0?v.substring(1,v.length-1):v.indexOf(",")!==-1?f(v):parseInt(v,10)}function f(v){return v.split(",").map(function(m){return parseInt(m,10)})}},{}],44:[function(r,a,s){var o=[66,77,70];a.exports=function(M){if(M.length<6)throw new Error("invalid buffer length for BMFont");var S=o.every(function(P,N){return M.readUInt8(N)===P});if(!S)throw new Error("BMFont missing BMF byte header");var E=3,T=M.readUInt8(E++);if(T>3)throw new Error("Only supports BMFont Binary v3 (BMFont App v1.10)");for(var C={kernings:[],chars:[]},L=0;L<5;L++)E+=u(C,M,E);return C};function u(A,M,S){if(S>M.length-1)return 0;var E=M.readUInt8(S++),T=M.readInt32LE(S);switch(S+=4,E){case 1:A.info=f(M,S);break;case 2:A.common=v(M,S);break;case 3:A.pages=m(M,S,T);break;case 4:A.chars=g(M,S,T);break;case 5:A.kernings=y(M,S,T);break}return 5+T}function f(A,M){var S={};S.size=A.readInt16LE(M);var E=A.readUInt8(M+2);return S.smooth=E>>7&1,S.unicode=E>>6&1,S.italic=E>>5&1,S.bold=E>>4&1,E>>3&1&&(S.fixedHeight=1),S.charset=A.readUInt8(M+3)||"",S.stretchH=A.readUInt16LE(M+4),S.aa=A.readUInt8(M+6),S.padding=[A.readInt8(M+7),A.readInt8(M+8),A.readInt8(M+9),A.readInt8(M+10)],S.spacing=[A.readInt8(M+11),A.readInt8(M+12)],S.outline=A.readUInt8(M+13),S.face=w(A,M+14),S}function v(A,M){var S={};return S.lineHeight=A.readUInt16LE(M),S.base=A.readUInt16LE(M+2),S.scaleW=A.readUInt16LE(M+4),S.scaleH=A.readUInt16LE(M+6),S.pages=A.readUInt16LE(M+8),A.readUInt8(M+10),S.packed=0,S.alphaChnl=A.readUInt8(M+11),S.redChnl=A.readUInt8(M+12),S.greenChnl=A.readUInt8(M+13),S.blueChnl=A.readUInt8(M+14),S}function m(A,M,S){for(var E=[],T=b(A,M),C=T.length+1,L=S/C,P=0;P<L;P++)E[P]=A.slice(M,M+T.length).toString("utf8"),M+=C;return E}function g(A,M,S){for(var E=[],T=S/20,C=0;C<T;C++){var L={},P=C*20;L.id=A.readUInt32LE(M+0+P),L.x=A.readUInt16LE(M+4+P),L.y=A.readUInt16LE(M+6+P),L.width=A.readUInt16LE(M+8+P),L.height=A.readUInt16LE(M+10+P),L.xoffset=A.readInt16LE(M+12+P),L.yoffset=A.readInt16LE(M+14+P),L.xadvance=A.readInt16LE(M+16+P),L.page=A.readUInt8(M+18+P),L.chnl=A.readUInt8(M+19+P),E[C]=L}return E}function y(A,M,S){for(var E=[],T=S/10,C=0;C<T;C++){var L={},P=C*10;L.first=A.readUInt32LE(M+0+P),L.second=A.readUInt32LE(M+4+P),L.amount=A.readInt16LE(M+8+P),E[C]=L}return E}function b(A,M){for(var S=M;S<A.length&&A[S]!==0;S++);return A.slice(M,S)}function w(A,M){return b(A,M).toString("utf8")}},{}],45:[function(r,a,s){var o=r("./parse-attribs"),u=r("xml-parse-from-string"),f={scaleh:"scaleH",scalew:"scaleW",stretchh:"stretchH",lineheight:"lineHeight",alphachnl:"alphaChnl",redchnl:"redChnl",greenchnl:"greenChnl",bluechnl:"blueChnl"};a.exports=function(b){b=b.toString();var w=u(b),A={pages:[],chars:[],kernings:[]};["info","common"].forEach(function(P){var N=w.getElementsByTagName(P)[0];N&&(A[P]=o(v(N)))});var M=w.getElementsByTagName("pages")[0];if(!M)throw new Error("malformed file -- no <pages> element");for(var S=M.getElementsByTagName("page"),E=0;E<S.length;E++){var T=S[E],C=parseInt(T.getAttribute("id"),10),L=T.getAttribute("file");if(isNaN(C))throw new Error('malformed file -- page "id" attribute is NaN');if(!L)throw new Error('malformed file -- needs page "file" attribute');A.pages[parseInt(C,10)]=L}return["chars","kernings"].forEach(function(P){var N=w.getElementsByTagName(P)[0];if(!!N)for(var F=P.substring(0,P.length-1),X=N.getElementsByTagName(F),Y=0;Y<X.length;Y++){var ae=X[Y];A[P].push(o(v(ae)))}}),A};function v(y){var b=m(y);return b.reduce(function(w,A){var M=g(A.nodeName);return w[M]=A.nodeValue,w},{})}function m(y){for(var b=[],w=0;w<y.attributes.length;w++)b.push(y.attributes[w]);return b}function g(y){return f[y.toLowerCase()]||y}},{"./parse-attribs":46,"xml-parse-from-string":71}],46:[function(r,a,s){var o="chasrset";a.exports=function(v){o in v&&(v.charset=v[o],delete v[o]);for(var m in v)m==="face"||m==="charset"||(m==="padding"||m==="spacing"?v[m]=u(v[m]):v[m]=parseInt(v[m],10));return v};function u(f){return f.split(",").map(function(v){return parseInt(v,10)})}},{}],47:[function(r,a,s){var o=r("string.prototype.trim"),u=r("for-each"),f=function(v){return Object.prototype.toString.call(v)==="[object Array]"};a.exports=function(v){if(!v)return{};var m={};return u(o(v).split(`
`),function(g){var y=g.indexOf(":"),b=o(g.slice(0,y)).toLowerCase(),w=o(g.slice(y+1));typeof m[b]=="undefined"?m[b]=w:f(m[b])?m[b].push(w):m[b]=[m[b],w]}),m}},{"for-each":24,"string.prototype.trim":53}],48:[function(r,a,s){(function(o){var u=o.performance||{},f=function(){for(var v=["now","webkitNow","msNow","mozNow","oNow"];v.length;){var m=v.shift();if(m in u)return u[m].bind(u)}var g=Date.now||function(){return new Date().getTime()},y=(u.timing||{}).navigationStart||g();return function(){return g()-y}}();f.performanceNow=u.now,f.noConflict=function(){u.now=f.performanceNow},f.conflict=function(){u.now=f},f.conflict(),a.exports=f}).call(this,typeof Ba!="undefined"?Ba:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],49:[function(r,a,s){var o=a.exports={},u,f;function v(){throw new Error("setTimeout has not been defined")}function m(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?u=setTimeout:u=v}catch{u=v}try{typeof clearTimeout=="function"?f=clearTimeout:f=m}catch{f=m}})();function g(L){if(u===setTimeout)return setTimeout(L,0);if((u===v||!u)&&setTimeout)return u=setTimeout,setTimeout(L,0);try{return u(L,0)}catch{try{return u.call(null,L,0)}catch{return u.call(this,L,0)}}}function y(L){if(f===clearTimeout)return clearTimeout(L);if((f===m||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(L);try{return f(L)}catch{try{return f.call(null,L)}catch{return f.call(this,L)}}}var b=[],w=!1,A,M=-1;function S(){!w||!A||(w=!1,A.length?b=A.concat(b):M=-1,b.length&&E())}function E(){if(!w){var L=g(S);w=!0;for(var P=b.length;P;){for(A=b,b=[];++M<P;)A&&A[M].run();M=-1,P=b.length}A=null,w=!1,y(L)}}o.nextTick=function(L){var P=new Array(arguments.length-1);if(arguments.length>1)for(var N=1;N<arguments.length;N++)P[N-1]=arguments[N];b.push(new T(L,P)),b.length===1&&!w&&g(E)};function T(L,P){this.fun=L,this.array=P}T.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={};function C(){}o.on=C,o.addListener=C,o.once=C,o.off=C,o.removeListener=C,o.removeAllListeners=C,o.emit=C,o.prependListener=C,o.prependOnceListener=C,o.listeners=function(L){return[]},o.binding=function(L){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(L){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],50:[function(r,a,s){(function(o){(function(u){var f=setTimeout,v=typeof o=="function"&&o||function(T){f(T,1)};function m(T,C){return function(){T.apply(C,arguments)}}var g=Array.isArray||function(T){return Object.prototype.toString.call(T)==="[object Array]"};function y(T){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");if(typeof T!="function")throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],E(T,m(w,this),m(A,this))}function b(T){var C=this;if(this._state===null){this._deferreds.push(T);return}v(function(){var L=C._state?T.onFulfilled:T.onRejected;if(L===null){(C._state?T.resolve:T.reject)(C._value);return}var P;try{P=L(C._value)}catch(N){T.reject(N);return}T.resolve(P)})}function w(T){try{if(T===this)throw new TypeError("A promise cannot be resolved with itself.");if(T&&(typeof T=="object"||typeof T=="function")){var C=T.then;if(typeof C=="function"){E(m(C,T),m(w,this),m(A,this));return}}this._state=!0,this._value=T,M.call(this)}catch(L){A.call(this,L)}}function A(T){this._state=!1,this._value=T,M.call(this)}function M(){for(var T=0,C=this._deferreds.length;T<C;T++)b.call(this,this._deferreds[T]);this._deferreds=null}function S(T,C,L,P){this.onFulfilled=typeof T=="function"?T:null,this.onRejected=typeof C=="function"?C:null,this.resolve=L,this.reject=P}function E(T,C,L){var P=!1;try{T(function(N){P||(P=!0,C(N))},function(N){P||(P=!0,L(N))})}catch(N){if(P)return;P=!0,L(N)}}y.prototype.catch=function(T){return this.then(null,T)},y.prototype.then=function(T,C){var L=this;return new y(function(P,N){b.call(L,new S(T,C,P,N))})},y.all=function(){var T=Array.prototype.slice.call(arguments.length===1&&g(arguments[0])?arguments[0]:arguments);return new y(function(C,L){if(T.length===0)return C([]);var P=T.length;function N(X,Y){try{if(Y&&(typeof Y=="object"||typeof Y=="function")){var ae=Y.then;if(typeof ae=="function"){ae.call(Y,function($){N(X,$)},L);return}}T[X]=Y,--P==0&&C(T)}catch($){L($)}}for(var F=0;F<T.length;F++)N(F,T[F])})},y.resolve=function(T){return T&&typeof T=="object"&&T.constructor===y?T:new y(function(C){C(T)})},y.reject=function(T){return new y(function(C,L){L(T)})},y.race=function(T){return new y(function(C,L){for(var P=0,N=T.length;P<N;P++)T[P].then(C,L)})},y._setImmediateFn=function(C){v=C},typeof a!="undefined"&&a.exports?a.exports=y:u.Promise||(u.Promise=y)})(this)}).call(this,r("timers").setImmediate)},{timers:67}],51:[function(r,a,s){var o=r("dtype"),u=r("an-array"),f=r("is-buffer"),v=[0,2,3],m=[2,1,3];a.exports=function(y,b){(!y||!(u(y)||f(y)))&&(b=y||{},y=null),typeof b=="number"?b={count:b}:b=b||{};for(var w=typeof b.type=="string"?b.type:"uint16",A=typeof b.count=="number"?b.count:1,M=b.start||0,S=b.clockwise!==!1?v:m,E=S[0],T=S[1],C=S[2],L=A*6,P=y||new(o(w))(L),N=0,F=0;N<L;N+=6,F+=4){var X=N+M;P[X+0]=F+0,P[X+1]=F+1,P[X+2]=F+2,P[X+3]=F+E,P[X+4]=F+T,P[X+5]=F+C}return P}},{"an-array":1,dtype:13,"is-buffer":31}],52:[function(r,a,s){var o=r("function-bind"),u=r("es-abstract/es5"),f=o.call(Function.call,String.prototype.replace),v=/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,m=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/;a.exports=function(){var y=u.ToString(u.CheckObjectCoercible(this));return f(f(y,v,""),m,"")}},{"es-abstract/es5":15,"function-bind":26}],53:[function(r,a,s){var o=r("function-bind"),u=r("define-properties"),f=r("./implementation"),v=r("./polyfill"),m=r("./shim"),g=o.call(Function.call,v());u(g,{getPolyfill:v,implementation:f,shim:m}),a.exports=g},{"./implementation":52,"./polyfill":54,"./shim":55,"define-properties":11,"function-bind":26}],54:[function(r,a,s){var o=r("./implementation"),u="\u200B";a.exports=function(){return String.prototype.trim&&u.trim()===u?String.prototype.trim:o}},{"./implementation":52}],55:[function(r,a,s){var o=r("define-properties"),u=r("./polyfill");a.exports=function(){var v=u();return o(String.prototype,{trim:v},{trim:function(){return String.prototype.trim!==v}}),v}},{"./polyfill":54,"define-properties":11}],56:[function(r,a,s){var o={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0},u={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},f=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective"],v={CSS:{},springs:{}};function m(De,Ye,ct){return Math.min(Math.max(De,Ye),ct)}function g(De,Ye){return De.indexOf(Ye)>-1}function y(De,Ye){return De.apply(null,Ye)}var b=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i,w=/^rgb/,A=/^hsl/,M={arr:function(De){return Array.isArray(De)},obj:function(De){return g(Object.prototype.toString.call(De),"Object")},pth:function(De){return M.obj(De)&&De.hasOwnProperty("totalLength")},svg:function(De){return De instanceof SVGElement},inp:function(De){return De instanceof HTMLInputElement},dom:function(De){return De.nodeType||M.svg(De)},str:function(De){return typeof De=="string"},fnc:function(De){return typeof De=="function"},und:function(De){return typeof De=="undefined"},hex:function(De){return b.test(De)},rgb:function(De){return w.test(De)},hsl:function(De){return A.test(De)},col:function(De){return M.hex(De)||M.rgb(De)||M.hsl(De)},key:function(De){return!o.hasOwnProperty(De)&&!u.hasOwnProperty(De)&&De!=="targets"&&De!=="keyframes"}},S=/\(([^)]+)\)/;function E(De){var Ye=S.exec(De);return Ye?Ye[1].split(",").map(function(ct){return parseFloat(ct)}):[]}function T(De,Ye){var ct=E(De),bt=m(M.und(ct[0])?1:ct[0],.1,100),yt=m(M.und(ct[1])?100:ct[1],.1,100),zt=m(M.und(ct[2])?10:ct[2],.1,100),kt=m(M.und(ct[3])?0:ct[3],.1,100),sn=Math.sqrt(yt/bt),jt=zt/(2*Math.sqrt(yt*bt)),Nt=jt<1?sn*Math.sqrt(1-jt*jt):0,mn=1,An=jt<1?(jt*sn+-kt)/Nt:-kt+sn;function Cn(tr){var Rn=Ye?Ye*tr/1e3:tr;return jt<1?Rn=Math.exp(-Rn*jt*sn)*(mn*Math.cos(Nt*Rn)+An*Math.sin(Nt*Rn)):Rn=(mn+An*Rn)*Math.exp(-Rn*sn),tr===0||tr===1?tr:1-Rn}function Gn(){var tr=v.springs[De];if(tr)return tr;for(var Rn=1/6,_r=0,Nr=0;;)if(_r+=Rn,Cn(_r)===1){if(Nr++,Nr>=16)break}else Nr=0;var Fi=_r*Rn*1e3;return v.springs[De]=Fi,Fi}return Ye?Cn:Gn}function C(De,Ye){De===void 0&&(De=1),Ye===void 0&&(Ye=.5);var ct=m(De,1,10),bt=m(Ye,.1,2);return function(yt){return yt===0||yt===1?yt:-ct*Math.pow(2,10*(yt-1))*Math.sin((yt-1-bt/(Math.PI*2)*Math.asin(1/ct))*(Math.PI*2)/bt)}}function L(De){return De===void 0&&(De=10),function(Ye){return Math.round(Ye*De)*(1/De)}}var P=function(){var De=11,Ye=1/(De-1);function ct(mn,An){return 1-3*An+3*mn}function bt(mn,An){return 3*An-6*mn}function yt(mn){return 3*mn}function zt(mn,An,Cn){return((ct(An,Cn)*mn+bt(An,Cn))*mn+yt(An))*mn}function kt(mn,An,Cn){return 3*ct(An,Cn)*mn*mn+2*bt(An,Cn)*mn+yt(An)}function sn(mn,An,Cn,Gn,tr){var Rn,_r,Nr=0;do _r=An+(Cn-An)/2,Rn=zt(_r,Gn,tr)-mn,Rn>0?Cn=_r:An=_r;while(Math.abs(Rn)>1e-7&&++Nr<10);return _r}function jt(mn,An,Cn,Gn){for(var tr=0;tr<4;++tr){var Rn=kt(An,Cn,Gn);if(Rn===0)return An;var _r=zt(An,Cn,Gn)-mn;An-=_r/Rn}return An}function Nt(mn,An,Cn,Gn){if(!(0<=mn&&mn<=1&&0<=Cn&&Cn<=1))return;var tr=new Float32Array(De);if(mn!==An||Cn!==Gn)for(var Rn=0;Rn<De;++Rn)tr[Rn]=zt(Rn*Ye,mn,Cn);function _r(Nr){for(var Fi=0,Xn=1,dr=De-1;Xn!==dr&&tr[Xn]<=Nr;++Xn)Fi+=Ye;--Xn;var ur=(Nr-tr[Xn])/(tr[Xn+1]-tr[Xn]),$i=Fi+ur*Ye,qr=kt($i,mn,Cn);return qr>=.001?jt(Nr,$i,mn,Cn):qr===0?$i:sn(Nr,Fi,Fi+Ye,mn,Cn)}return function(Nr){return mn===An&&Cn===Gn||Nr===0||Nr===1?Nr:zt(_r(Nr),An,Gn)}}return Nt}(),N=function(){var De=["Quad","Cubic","Quart","Quint","Sine","Expo","Circ","Back","Elastic"],Ye={In:[[.55,.085,.68,.53],[.55,.055,.675,.19],[.895,.03,.685,.22],[.755,.05,.855,.06],[.47,0,.745,.715],[.95,.05,.795,.035],[.6,.04,.98,.335],[.6,-.28,.735,.045],C],Out:[[.25,.46,.45,.94],[.215,.61,.355,1],[.165,.84,.44,1],[.23,1,.32,1],[.39,.575,.565,1],[.19,1,.22,1],[.075,.82,.165,1],[.175,.885,.32,1.275],function(kt,sn){return function(jt){return 1-C(kt,sn)(1-jt)}}],InOut:[[.455,.03,.515,.955],[.645,.045,.355,1],[.77,0,.175,1],[.86,0,.07,1],[.445,.05,.55,.95],[1,0,0,1],[.785,.135,.15,.86],[.68,-.55,.265,1.55],function(kt,sn){return function(jt){return jt<.5?C(kt,sn)(jt*2)/2:1-C(kt,sn)(jt*-2+2)/2}}]},ct={linear:[.25,.25,.75,.75]};for(var bt in Ye)for(var yt=0,zt=Ye[bt].length;yt<zt;yt++)ct["ease"+bt+De[yt]]=Ye[bt][yt];return ct}();function F(De,Ye){if(M.fnc(De))return De;var ct=De.split("(")[0],bt=N[ct],yt=E(De);switch(ct){case"spring":return T(De,Ye);case"cubicBezier":return y(P,yt);case"steps":return y(L,yt);default:return M.fnc(bt)?y(bt,yt):y(P,bt)}}function X(De){try{var Ye=document.querySelectorAll(De);return Ye}catch{return}}var Y=[];function ae(De,Ye){for(var ct=Y,bt=De.length,yt=arguments.length>=2?arguments[1]:void 0,zt=0;zt<bt;zt++)if(zt in De){var kt=De[zt];Ye.call(yt,kt,zt,De)&&ct.push(kt)}return Y=De,Y.length=0,ct}function $(De,Ye){Ye||(Ye=[]);for(var ct=0,bt=De.length;ct<bt;ct++){var yt=De[ct];Array.isArray(yt)?$(yt,Ye):Ye.push(yt)}return Ye}function de(De){return M.arr(De)?De:(M.str(De)&&(De=X(De)||De),De instanceof NodeList||De instanceof HTMLCollection?[].slice.call(De):[De])}function D(De,Ye){return De.some(function(ct){return ct===Ye})}function I(De){var Ye={};for(var ct in De)Ye[ct]=De[ct];return Ye}function k(De,Ye){var ct=I(De);for(var bt in De)ct[bt]=Ye.hasOwnProperty(bt)?Ye[bt]:De[bt];return ct}function U(De,Ye){var ct=I(De);for(var bt in Ye)ct[bt]=M.und(De[bt])?Ye[bt]:De[bt];return ct}var W=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g;function ce(De){var Ye=W.exec(De);return Ye?"rgba("+Ye[1]+",1)":De}var oe=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,ge=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;function _e(De){var Ye=De.replace(oe,function(kt,sn,jt,Nt){return sn+sn+jt+jt+Nt+Nt}),ct=ge.exec(Ye),bt=parseInt(ct[1],16),yt=parseInt(ct[2],16),zt=parseInt(ct[3],16);return"rgba("+bt+","+yt+","+zt+",1)"}var Ne=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g,Ie=/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g;function Ve(De){var Ye=Ne.exec(De)||Ie.exec(De),ct=parseInt(Ye[1],10)/360,bt=parseInt(Ye[2],10)/100,yt=parseInt(Ye[3],10)/100,zt=Ye[4]||1;function kt(Cn,Gn,tr){return tr<0&&(tr+=1),tr>1&&(tr-=1),tr<1/6?Cn+(Gn-Cn)*6*tr:tr<1/2?Gn:tr<2/3?Cn+(Gn-Cn)*(2/3-tr)*6:Cn}var sn,jt,Nt;if(bt==0)sn=jt=Nt=yt;else{var mn=yt<.5?yt*(1+bt):yt+bt-yt*bt,An=2*yt-mn;sn=kt(An,mn,ct+1/3),jt=kt(An,mn,ct),Nt=kt(An,mn,ct-1/3)}return"rgba("+sn*255+","+jt*255+","+Nt*255+","+zt+")"}function Le(De){if(M.rgb(De))return ce(De);if(M.hex(De))return _e(De);if(M.hsl(De))return Ve(De)}var Fe=/([\+\-]?[0-9#\.]+)(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/;function Me(De){var Ye=Fe.exec(De);if(Ye)return Ye[2]}function Qe(De){if(g(De,"translate")||De==="perspective")return"px";if(g(De,"rotate")||g(De,"skew"))return"deg"}function mt(De,Ye){return M.fnc(De)?De(Ye.target,Ye.id,Ye.total):De}function ht(De,Ye){return De.getAttribute(Ye)}function ye(De,Ye,ct){var bt=Me(Ye);if(D([ct,"deg","rad","turn"],bt))return Ye;var yt=v.CSS[Ye+ct];if(!M.und(yt))return yt;var zt=100,kt=document.createElement(De.tagName),sn=De.parentNode&&De.parentNode!==document?De.parentNode:document.body;sn.appendChild(kt),kt.style.position="absolute",kt.style.width=zt+ct;var jt=zt/kt.offsetWidth;sn.removeChild(kt);var Nt=jt*parseFloat(Ye);return v.CSS[Ye+ct]=Nt,Nt}function fe(De,Ye,ct){if(Ye in De.style){var bt=Ye.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),yt=De.style[Ye]||getComputedStyle(De).getPropertyValue(bt)||"0";return ct?ye(De,yt,ct):yt}}function H(De,Ye){if(M.dom(De)&&!M.inp(De)&&(ht(De,Ye)||M.svg(De)&&De[Ye]))return"attribute";if(M.dom(De)&&D(f,Ye))return"transform";if(M.dom(De)&&Ye!=="transform"&&fe(De,Ye))return"css";if(De[Ye]!=null)return"object"}var j=/(\w+)\(([^)]*)\)/g;function q(De){if(!!M.dom(De)){for(var Ye=De.style.transform||"",ct=new Map,bt;bt=j.exec(Ye);)ct.set(bt[1],bt[2]);return ct}}function pe(De,Ye,ct,bt){var yt=g(Ye,"scale")?1:0+Qe(Ye),zt=q(De).get(Ye)||yt;return ct&&(ct.transforms.list.set(Ye,zt),ct.transforms.last=Ye),bt?ye(De,zt,bt):zt}function ee(De,Ye,ct,bt){switch(H(De,Ye)){case"transform":return pe(De,Ye,bt,ct);case"css":return fe(De,Ye,ct);case"attribute":return ht(De,Ye);default:return De[Ye]||0}}var te=/^(\*=|\+=|-=)/;function Se(De,Ye){var ct=te.exec(De);if(!ct)return De;var bt=Me(De)||0,yt=parseFloat(Ye),zt=parseFloat(De.replace(ct[0],""));switch(ct[0][0]){case"+":return yt+zt+bt;case"-":return yt-zt+bt;case"*":return yt*zt+bt}}var ke=/\s/g;function Be(De,Ye){if(M.col(De))return Le(De);var ct=Me(De),bt=ct?De.substr(0,De.length-ct.length):De;return Ye&&!ke.test(De)?bt+Ye:bt}function We(De,Ye){return Math.sqrt(Math.pow(Ye.x-De.x,2)+Math.pow(Ye.y-De.y,2))}function ve(De){return Math.PI*2*ht(De,"r")}function K(De){return ht(De,"width")*2+ht(De,"height")*2}function J(De){return We({x:ht(De,"x1"),y:ht(De,"y1")},{x:ht(De,"x2"),y:ht(De,"y2")})}function Ee(De){for(var Ye=De.points,ct=0,bt,yt=0;yt<Ye.numberOfItems;yt++){var zt=Ye.getItem(yt);yt>0&&(ct+=We(bt,zt)),bt=zt}return ct}function xe(De){var Ye=De.points;return Ee(De)+We(Ye.getItem(Ye.numberOfItems-1),Ye.getItem(0))}function Je(De){if(De.getTotalLength)return De.getTotalLength();switch(De.tagName.toLowerCase()){case"circle":return ve(De);case"rect":return K(De);case"line":return J(De);case"polyline":return Ee(De);case"polygon":return xe(De)}}function Xe(De){var Ye=Je(De);return De.setAttribute("stroke-dasharray",Ye),Ye}function Mt(De){for(var Ye=De.parentNode;M.svg(Ye)&&(Ye=Ye.parentNode,!!M.svg(Ye.parentNode)););return Ye}function qe(De,Ye){var ct=Ye||{},bt=ct.el||Mt(De),yt=bt.getBoundingClientRect(),zt=ht(bt,"viewBox"),kt=yt.width,sn=yt.height,jt=ct.viewBox||(zt?zt.split(" "):[0,0,kt,sn]);return{el:bt,viewBox:jt,x:jt[0]/1,y:jt[1]/1,w:kt/jt[2],h:sn/jt[3]}}function It(De,Ye){var ct=M.str(De)?X(De)[0]:De,bt=Ye||100;return function(yt){return{property:yt,el:ct,svg:qe(ct),totalLength:Je(ct)*(bt/100)}}}function rn(De,Ye){function ct(sn){sn===void 0&&(sn=0);var jt=Ye+sn>=1?Ye+sn:0;return De.el.getPointAtLength(jt)}var bt=qe(De.el,De.svg),yt=ct(),zt=ct(-1),kt=ct(1);switch(De.property){case"x":return(yt.x-bt.x)*bt.w;case"y":return(yt.y-bt.y)*bt.h;case"angle":return Math.atan2(kt.y-zt.y,kt.x-zt.x)*180/Math.PI}}var Yt=/-?\d*\.?\d+/g;function Tn(De,Ye){var ct=Be(M.pth(De)?De.totalLength:De,Ye)+"";return{original:ct,numbers:ct.match(Yt)?ct.match(Yt).map(Number):[0],strings:M.str(De)||Ye?ct.split(Yt):[]}}function Jt(De){var Ye=De?$(M.arr(De)?De.map(de):de(De)):[];return ae(Ye,function(ct,bt,yt){return yt.indexOf(ct)===bt})}function Fn(De){var Ye=Jt(De);return Ye.map(function(ct,bt){return{target:ct,id:bt,total:Ye.length,transforms:{list:q(ct)}}})}var mr=/^spring/;function fr(De,Ye){var ct=I(Ye);if(mr.test(ct.easing)&&(ct.duration=T(ct.easing)),M.arr(De)){var bt=De.length,yt=bt===2&&!M.obj(De[0]);yt?De={value:De}:M.fnc(Ye.duration)||(ct.duration=Ye.duration/bt)}var zt=M.arr(De)?De:[De];return zt.map(function(kt,sn){var jt=M.obj(kt)&&!M.pth(kt)?kt:{value:kt};return M.und(jt.delay)&&(jt.delay=sn?0:Ye.delay),M.und(jt.endDelay)&&(jt.endDelay=sn===zt.length-1?Ye.endDelay:0),jt}).map(function(kt){return U(kt,ct)})}function Dt(De){for(var Ye=ae($(De.map(function(zt){return Object.keys(zt)})),function(zt){return M.key(zt)}).reduce(function(zt,kt){return zt.indexOf(kt)<0&&zt.push(kt),zt},[]),ct={},bt=function(zt){var kt=Ye[zt];ct[kt]=De.map(function(sn){var jt={};for(var Nt in sn)M.key(Nt)?Nt==kt&&(jt.value=sn[Nt]):jt[Nt]=sn[Nt];return jt})},yt=0;yt<Ye.length;yt++)bt(yt);return ct}function Ft(De,Ye){var ct=[],bt=Ye.keyframes;bt&&(Ye=U(Dt(bt),Ye));for(var yt in Ye)M.key(yt)&&ct.push({name:yt,tweens:fr(Ye[yt],De)});return ct}function $t(De,Ye){var ct={};for(var bt in De){var yt=mt(De[bt],Ye);M.arr(yt)&&(yt=yt.map(function(zt){return mt(zt,Ye)}),yt.length===1&&(yt=yt[0])),ct[bt]=yt}return ct.duration=parseFloat(ct.duration),ct.delay=parseFloat(ct.delay),ct}function Pn(De,Ye){var ct;return De.tweens.map(function(bt){var yt=$t(bt,Ye),zt=yt.value,kt=M.arr(zt)?zt[1]:zt,sn=Me(kt),jt=ee(Ye.target,De.name,sn,Ye),Nt=ct?ct.to.original:jt,mn=M.arr(zt)?zt[0]:Nt,An=Me(mn)||Me(jt),Cn=sn||An;return M.und(kt)&&(kt=Nt),yt.from=Tn(mn,Cn),yt.to=Tn(Se(kt,mn),Cn),yt.start=ct?ct.end:0,yt.end=yt.start+yt.delay+yt.duration+yt.endDelay,yt.easing=F(yt.easing,yt.duration),yt.isPath=M.pth(zt),yt.isColor=M.col(yt.from.original),yt.isColor&&(yt.round=1),ct=yt,yt})}var In={css:function(De,Ye,ct){return De.style[Ye]=ct},attribute:function(De,Ye,ct){return De.setAttribute(Ye,ct)},object:function(De,Ye,ct){return De[Ye]=ct},transform:function(De,Ye,ct,bt,yt){if(bt.list.set(Ye,ct),Ye===bt.last||yt){var zt="";bt.list.forEach(function(kt,sn){zt+=sn+"("+kt+") "}),De.style.transform=zt}}};function zn(De,Ye){for(var ct=Fn(De),bt=0,yt=ct.length;bt<yt;bt++){var zt=ct[bt];for(var kt in Ye){var sn=mt(Ye[kt],zt),jt=zt.target,Nt=Me(sn),mn=ee(jt,kt,Nt,zt),An=Nt||Me(mn),Cn=Se(Be(sn,An),mn),Gn=H(jt,kt);In[Gn](jt,kt,Cn,zt.transforms,!0)}}}function bn(De,Ye){var ct=H(De.target,Ye.name);if(ct){var bt=Pn(Ye,De),yt=bt[bt.length-1];return{type:ct,property:Ye.name,animatable:De,tweens:bt,duration:yt.end,delay:bt[0].delay,endDelay:yt.endDelay}}}function Jn(De,Ye){return ae($(De.map(function(ct){return Ye.map(function(bt){return bn(ct,bt)})})),function(ct){return!M.und(ct)})}function Er(De,Ye){var ct=De.length,bt=function(zt){return zt.timelineOffset?zt.timelineOffset:0},yt={};return yt.duration=ct?Math.max.apply(Math,De.map(function(zt){return bt(zt)+zt.duration})):Ye.duration,yt.delay=ct?Math.min.apply(Math,De.map(function(zt){return bt(zt)+zt.delay})):Ye.delay,yt.endDelay=ct?yt.duration-Math.max.apply(Math,De.map(function(zt){return bt(zt)+zt.duration-zt.endDelay})):Ye.endDelay,yt}var cr=0;function gi(De){var Ye=k(o,De),ct=k(u,De),bt=Ft(ct,De),yt=Fn(De.targets),zt=Jn(yt,bt),kt=Er(zt,ct),sn=cr;return cr++,U(Ye,{id:sn,children:[],animatables:yt,animations:zt,duration:kt.duration,delay:kt.delay,endDelay:kt.endDelay})}var Lr=[],vr=[],je,_t=function(){function De(){je=requestAnimationFrame(Ye)}function Ye(ct){var bt=Lr.length;if(bt){for(var yt=0;yt<bt;){var zt=Lr[yt];if(!zt.paused)zt.tick(ct);else{var kt=Lr.indexOf(zt);kt>-1&&(Lr.splice(kt,1),bt=Lr.length)}yt++}De()}else je=cancelAnimationFrame(je)}return De}();function Ot(){if(document.hidden){for(var De=0,Ye=Lr.length;De<Ye;De++)activeInstance[De].pause();vr=Lr.slice(0),Lr=[]}else for(var ct=0,bt=vr.length;ct<bt;ct++)vr[ct].play()}document.addEventListener("visibilitychange",Ot);function At(De){De===void 0&&(De={});var Ye=0,ct=0,bt=0,yt,zt=0,kt=null;function sn(){return window.Promise&&new Promise(function(Xn){return kt=Xn})}var jt=sn(),Nt=gi(De);function mn(){Nt.reversed=!Nt.reversed;for(var Xn=0,dr=yt.length;Xn<dr;Xn++)yt[Xn].reversed=Nt.reversed}function An(Xn){return Nt.reversed?Nt.duration-Xn:Xn}function Cn(){Ye=0,ct=An(Nt.currentTime)*(1/At.speed)}function Gn(Xn,dr){dr&&dr.seek(Xn-dr.timelineOffset)}function tr(Xn){if(Nt.reversePlayback)for(var ur=zt;ur--;)Gn(Xn,yt[ur]);else for(var dr=0;dr<zt;dr++)Gn(Xn,yt[dr])}function Rn(Xn){for(var dr=0,ur=Nt.animations,$i=ur.length;dr<$i;){var qr=ur[dr],Qr=qr.animatable,Z=qr.tweens,ie=Z.length-1,be=Z[ie];ie&&(be=ae(Z,function(Kt){return Xn<Kt.end})[0]||be);for(var Ae=m(Xn-be.start-be.delay,0,be.duration)/be.duration,ze=isNaN(Ae)?1:be.easing(Ae),ft=be.to.strings,Ct=be.round,Xt=[],Et=be.to.numbers.length,wt=void 0,se=0;se<Et;se++){var he=void 0,Te=be.to.numbers[se],Pe=be.from.numbers[se]||0;be.isPath?he=rn(be.value,ze*Te):he=Pe+ze*(Te-Pe),Ct&&(be.isColor&&se>2||(he=Math.round(he*Ct)/Ct)),Xt.push(he)}var Ce=ft.length;if(!Ce)wt=Xt[0];else{wt=ft[0];for(var pt=0;pt<Ce;pt++){ft[pt];var Rt=ft[pt+1],Bt=Xt[pt];isNaN(Bt)||(Rt?wt+=Bt+Rt:wt+=Bt+" ")}}In[qr.type](Qr.target,qr.property,wt,Qr.transforms),qr.currentValue=wt,dr++}}function _r(Xn){Nt[Xn]&&!Nt.passThrough&&Nt[Xn](Nt)}function Nr(){Nt.remaining&&Nt.remaining!==!0&&Nt.remaining--}function Fi(Xn){var dr=Nt.duration,ur=Nt.delay,$i=dr-Nt.endDelay,qr=An(Xn);Nt.progress=m(qr/dr*100,0,100),Nt.reversePlayback=qr<Nt.currentTime,yt&&tr(qr),!Nt.began&&Nt.currentTime>0&&(Nt.began=!0,_r("begin"),_r("loopBegin")),qr<=ur&&Nt.currentTime!==0&&Rn(0),(qr>=$i&&Nt.currentTime!==dr||!dr)&&Rn(dr),qr>ur&&qr<$i?(Nt.changeBegan||(Nt.changeBegan=!0,Nt.changeCompleted=!1,_r("changeBegin")),_r("change"),Rn(qr)):Nt.changeBegan&&(Nt.changeCompleted=!0,Nt.changeBegan=!1,_r("changeComplete")),Nt.currentTime=m(qr,0,dr),Nt.began&&_r("update"),Xn>=dr&&(ct=0,Nr(),Nt.remaining?(Ye=bt,_r("loopComplete"),_r("loopBegin"),Nt.direction==="alternate"&&mn()):(Nt.paused=!0,Nt.completed||(Nt.completed=!0,_r("loopComplete"),_r("complete"),"Promise"in window&&(kt(),jt=sn()))))}return Nt.reset=function(){var Xn=Nt.direction;Nt.passThrough=!1,Nt.currentTime=0,Nt.progress=0,Nt.paused=!0,Nt.began=!1,Nt.changeBegan=!1,Nt.completed=!1,Nt.changeCompleted=!1,Nt.reversePlayback=!1,Nt.reversed=Xn==="reverse",Nt.remaining=Nt.loop,yt=Nt.children,zt=yt.length;for(var dr=zt;dr--;)Nt.children[dr].reset();(Nt.reversed&&Nt.loop!==!0||Xn==="alternate"&&Nt.loop===1)&&Nt.remaining++,Rn(0)},Nt.set=function(Xn,dr){return zn(Xn,dr),Nt},Nt.tick=function(Xn){bt=Xn,Ye||(Ye=bt),Fi((bt+(ct-Ye))*At.speed)},Nt.seek=function(Xn){Fi(An(Xn))},Nt.pause=function(){Nt.paused=!0,Cn()},Nt.play=function(){!Nt.paused||(Nt.paused=!1,Lr.push(Nt),Cn(),je||_t())},Nt.reverse=function(){mn(),Cn()},Nt.restart=function(){Nt.reset(),Nt.play()},Nt.finished=jt,Nt.reset(),Nt.autoplay&&Nt.play(),Nt}function Gt(De,Ye){for(var ct=Ye.length;ct--;)D(De,Ye[ct].animatable.target)&&Ye.splice(ct,1)}function En(De){for(var Ye=Jt(De),ct=Lr.length;ct--;){var bt=Lr[ct],yt=bt.animations,zt=bt.children;Gt(Ye,yt);for(var kt=zt.length;kt--;){var sn=zt[kt],jt=sn.animations;Gt(Ye,jt),!jt.length&&!sn.children.length&&zt.splice(kt,1)}!yt.length&&!zt.length&&bt.pause()}}function Sn(De,Ye){Ye===void 0&&(Ye={});var ct=Ye.direction||"normal",bt=Ye.easing?F(Ye.easing):null,yt=Ye.grid,zt=Ye.axis,kt=Ye.from||0,sn=kt==="first",jt=kt==="center",Nt=kt==="last",mn=M.arr(De),An=parseFloat(mn?De[0]:De),Cn=mn?parseFloat(De[1]):0,Gn=Me(mn?De[1]:De)||0,tr=Ye.start||0+(mn?An:0),Rn=[],_r=0;return function(Nr,Fi,Xn){if(sn&&(kt=0),jt&&(kt=(Xn-1)/2),Nt&&(kt=Xn-1),!Rn.length){for(var dr=0;dr<Xn;dr++){if(!yt)Rn.push(Math.abs(kt-dr));else{var ur=jt?(yt[0]-1)/2:kt%yt[0],$i=jt?(yt[1]-1)/2:Math.floor(kt/yt[0]),qr=dr%yt[0],Qr=Math.floor(dr/yt[0]),Z=ur-qr,ie=$i-Qr,be=Math.sqrt(Z*Z+ie*ie);zt==="x"&&(be=-Z),zt==="y"&&(be=-ie),Rn.push(be)}_r=Math.max.apply(Math,Rn)}bt&&(Rn=Rn.map(function(ze){return bt(ze/_r)*_r})),ct==="reverse"&&(Rn=Rn.map(function(ze){return zt?ze<0?ze*-1:-ze:Math.abs(_r-ze)}))}var Ae=mn?(Cn-An)/_r:An;return tr+Ae*(Math.round(Rn[Fi]*100)/100)+Gn}}function pn(De){De===void 0&&(De={});var Ye=At(De);return Ye.duration=0,Ye.add=function(ct,bt){var yt=Lr.indexOf(Ye),zt=Ye.children;yt>-1&&Lr.splice(yt,1);function kt(Cn){Cn.passThrough=!0}for(var sn=0;sn<zt.length;sn++)kt(zt[sn]);var jt=U(ct,k(u,De));jt.targets=jt.targets||De.targets;var Nt=Ye.duration;jt.autoplay=!1,jt.direction=Ye.direction,jt.timelineOffset=M.und(bt)?Nt:Se(bt,Nt),kt(Ye),Ye.seek(jt.timelineOffset);var mn=At(jt);kt(mn),zt.push(mn);var An=Er(zt,De);return Ye.delay=An.delay,Ye.endDelay=An.endDelay,Ye.duration=An.duration,Ye.seek(0),Ye.reset(),Ye.autoplay&&Ye.play(),Ye},Ye}At.version="3.0.0",At.speed=1,At.running=Lr,At.remove=En,At.get=ee,At.set=zn,At.convertPx=ye,At.path=It,At.setDashoffset=Xe,At.stagger=Sn,At.timeline=pn,At.easing=F,At.penner=N,At.random=function(De,Ye){return Math.floor(Math.random()*(Ye-De+1))+De},a.exports=At},{}],57:[function(r,a,s){(function(o,u){typeof s=="object"&&typeof a!="undefined"?u(s):(o=typeof globalThis!="undefined"?globalThis:o||self,u(o.THREE={}))})(this,function(o){Number.EPSILON===void 0&&(Number.EPSILON=Math.pow(2,-52)),Number.isInteger===void 0&&(Number.isInteger=function(p){return typeof p=="number"&&isFinite(p)&&Math.floor(p)===p}),Math.sign===void 0&&(Math.sign=function(p){return p<0?-1:p>0?1:+p}),"name"in Function.prototype||Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),Object.assign===void 0&&(Object.assign=function(p){if(p==null)throw new TypeError("Cannot convert undefined or null to object");for(var l=Object(p),d=1;d<arguments.length;d++){var c=arguments[d];if(c!=null)for(var h in c)Object.prototype.hasOwnProperty.call(c,h)&&(l[h]=c[h])}return l});var u=function(p){var l=Object.prototype,d=l.hasOwnProperty,c,h=typeof Symbol=="function"?Symbol:{},x=h.iterator||"@@iterator",_=h.asyncIterator||"@@asyncIterator",R=h.toStringTag||"@@toStringTag";function O(it,Ke,vt){return Object.defineProperty(it,Ke,{value:vt,enumerable:!0,configurable:!0,writable:!0}),it[Ke]}try{O({},"")}catch{O=function(vt,gt,St){return vt[gt]=St}}function B(it,Ke,vt,gt){var St=Ke&&Ke.prototype instanceof me?Ke:me,Tt=Object.create(St.prototype),qt=new et(gt||[]);return Tt._invoke=nt(it,vt,qt),Tt}p.wrap=B;function V(it,Ke,vt){try{return{type:"normal",arg:it.call(Ke,vt)}}catch(gt){return{type:"throw",arg:gt}}}var G="suspendedStart",z="suspendedYield",ne="executing",Q="completed",le={};function me(){}function ue(){}function re(){}var Oe={};Oe[x]=function(){return this};var He=Object.getPrototypeOf,Re=He&&He(He(dt([])));Re&&Re!==l&&d.call(Re,x)&&(Oe=Re);var we=re.prototype=me.prototype=Object.create(Oe);ue.prototype=we.constructor=re,re.constructor=ue,ue.displayName=O(re,R,"GeneratorFunction");function Ue(it){["next","throw","return"].forEach(function(Ke){O(it,Ke,function(vt){return this._invoke(Ke,vt)})})}p.isGeneratorFunction=function(it){var Ke=typeof it=="function"&&it.constructor;return Ke?Ke===ue||(Ke.displayName||Ke.name)==="GeneratorFunction":!1},p.mark=function(it){return Object.setPrototypeOf?Object.setPrototypeOf(it,re):(it.__proto__=re,O(it,R,"GeneratorFunction")),it.prototype=Object.create(we),it},p.awrap=function(it){return{__await:it}};function rt(it,Ke){function vt(Tt,qt,en,_n){var Lt=V(it[Tt],it,qt);if(Lt.type==="throw")_n(Lt.arg);else{var Wn=Lt.arg,gn=Wn.value;return gn&&typeof gn=="object"&&d.call(gn,"__await")?Ke.resolve(gn.__await).then(function(qn){vt("next",qn,en,_n)},function(qn){vt("throw",qn,en,_n)}):Ke.resolve(gn).then(function(qn){Wn.value=qn,en(Wn)},function(qn){return vt("throw",qn,en,_n)})}}var gt;function St(Tt,qt){function en(){return new Ke(function(_n,Lt){vt(Tt,qt,_n,Lt)})}return gt=gt?gt.then(en,en):en()}this._invoke=St}Ue(rt.prototype),rt.prototype[_]=function(){return this},p.AsyncIterator=rt,p.async=function(it,Ke,vt,gt,St){St===void 0&&(St=Promise);var Tt=new rt(B(it,Ke,vt,gt),St);return p.isGeneratorFunction(Ke)?Tt:Tt.next().then(function(qt){return qt.done?qt.value:Tt.next()})};function nt(it,Ke,vt){var gt=G;return function(Tt,qt){if(gt===ne)throw new Error("Generator is already running");if(gt===Q){if(Tt==="throw")throw qt;return at()}for(vt.method=Tt,vt.arg=qt;;){var en=vt.delegate;if(en){var _n=ot(en,vt);if(_n){if(_n===le)continue;return _n}}if(vt.method==="next")vt.sent=vt._sent=vt.arg;else if(vt.method==="throw"){if(gt===G)throw gt=Q,vt.arg;vt.dispatchException(vt.arg)}else vt.method==="return"&&vt.abrupt("return",vt.arg);gt=ne;var Lt=V(it,Ke,vt);if(Lt.type==="normal"){if(gt=vt.done?Q:z,Lt.arg===le)continue;return{value:Lt.arg,done:vt.done}}else Lt.type==="throw"&&(gt=Q,vt.method="throw",vt.arg=Lt.arg)}}}function ot(it,Ke){var vt=it.iterator[Ke.method];if(vt===c){if(Ke.delegate=null,Ke.method==="throw"){if(it.iterator.return&&(Ke.method="return",Ke.arg=c,ot(it,Ke),Ke.method==="throw"))return le;Ke.method="throw",Ke.arg=new TypeError("The iterator does not provide a 'throw' method")}return le}var gt=V(vt,it.iterator,Ke.arg);if(gt.type==="throw")return Ke.method="throw",Ke.arg=gt.arg,Ke.delegate=null,le;var St=gt.arg;if(!St)return Ke.method="throw",Ke.arg=new TypeError("iterator result is not an object"),Ke.delegate=null,le;if(St.done)Ke[it.resultName]=St.value,Ke.next=it.nextLoc,Ke.method!=="return"&&(Ke.method="next",Ke.arg=c);else return St;return Ke.delegate=null,le}Ue(we),O(we,R,"Generator"),we[x]=function(){return this},we.toString=function(){return"[object Generator]"};function ut(it){var Ke={tryLoc:it[0]};1 in it&&(Ke.catchLoc=it[1]),2 in it&&(Ke.finallyLoc=it[2],Ke.afterLoc=it[3]),this.tryEntries.push(Ke)}function st(it){var Ke=it.completion||{};Ke.type="normal",delete Ke.arg,it.completion=Ke}function et(it){this.tryEntries=[{tryLoc:"root"}],it.forEach(ut,this),this.reset(!0)}p.keys=function(it){var Ke=[];for(var vt in it)Ke.push(vt);return Ke.reverse(),function gt(){for(;Ke.length;){var St=Ke.pop();if(St in it)return gt.value=St,gt.done=!1,gt}return gt.done=!0,gt}};function dt(it){if(it){var Ke=it[x];if(Ke)return Ke.call(it);if(typeof it.next=="function")return it;if(!isNaN(it.length)){var vt=-1,gt=function St(){for(;++vt<it.length;)if(d.call(it,vt))return St.value=it[vt],St.done=!1,St;return St.value=c,St.done=!0,St};return gt.next=gt}}return{next:at}}p.values=dt;function at(){return{value:c,done:!0}}return et.prototype={constructor:et,reset:function(Ke){if(this.prev=0,this.next=0,this.sent=this._sent=c,this.done=!1,this.delegate=null,this.method="next",this.arg=c,this.tryEntries.forEach(st),!Ke)for(var vt in this)vt.charAt(0)==="t"&&d.call(this,vt)&&!isNaN(+vt.slice(1))&&(this[vt]=c)},stop:function(){this.done=!0;var Ke=this.tryEntries[0],vt=Ke.completion;if(vt.type==="throw")throw vt.arg;return this.rval},dispatchException:function(Ke){if(this.done)throw Ke;var vt=this;function gt(Lt,Wn){return qt.type="throw",qt.arg=Ke,vt.next=Lt,Wn&&(vt.method="next",vt.arg=c),!!Wn}for(var St=this.tryEntries.length-1;St>=0;--St){var Tt=this.tryEntries[St],qt=Tt.completion;if(Tt.tryLoc==="root")return gt("end");if(Tt.tryLoc<=this.prev){var en=d.call(Tt,"catchLoc"),_n=d.call(Tt,"finallyLoc");if(en&&_n){if(this.prev<Tt.catchLoc)return gt(Tt.catchLoc,!0);if(this.prev<Tt.finallyLoc)return gt(Tt.finallyLoc)}else if(en){if(this.prev<Tt.catchLoc)return gt(Tt.catchLoc,!0)}else if(_n){if(this.prev<Tt.finallyLoc)return gt(Tt.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(Ke,vt){for(var gt=this.tryEntries.length-1;gt>=0;--gt){var St=this.tryEntries[gt];if(St.tryLoc<=this.prev&&d.call(St,"finallyLoc")&&this.prev<St.finallyLoc){var Tt=St;break}}Tt&&(Ke==="break"||Ke==="continue")&&Tt.tryLoc<=vt&&vt<=Tt.finallyLoc&&(Tt=null);var qt=Tt?Tt.completion:{};return qt.type=Ke,qt.arg=vt,Tt?(this.method="next",this.next=Tt.finallyLoc,le):this.complete(qt)},complete:function(Ke,vt){if(Ke.type==="throw")throw Ke.arg;return Ke.type==="break"||Ke.type==="continue"?this.next=Ke.arg:Ke.type==="return"?(this.rval=this.arg=Ke.arg,this.method="return",this.next="end"):Ke.type==="normal"&&vt&&(this.next=vt),le},finish:function(Ke){for(var vt=this.tryEntries.length-1;vt>=0;--vt){var gt=this.tryEntries[vt];if(gt.finallyLoc===Ke)return this.complete(gt.completion,gt.afterLoc),st(gt),le}},catch:function(Ke){for(var vt=this.tryEntries.length-1;vt>=0;--vt){var gt=this.tryEntries[vt];if(gt.tryLoc===Ke){var St=gt.completion;if(St.type==="throw"){var Tt=St.arg;st(gt)}return Tt}}throw new Error("illegal catch attempt")},delegateYield:function(Ke,vt,gt){return this.delegate={iterator:dt(Ke),resultName:vt,nextLoc:gt},this.method==="next"&&(this.arg=c),le}},p}(typeof a=="object"?a.exports:{});try{regeneratorRuntime=u}catch{Function("r","regeneratorRuntime = r")(u)}var f="125",v={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},m={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},g=0,y=1,b=2,w=3,A=0,M=1,S=2,E=3,T=0,C=1,L=2,P=1,N=2,F=0,X=1,Y=2,ae=3,$=4,de=5,D=100,I=101,k=102,U=103,W=104,ce=200,oe=201,ge=202,_e=203,Ne=204,Ie=205,Ve=206,Le=207,Fe=208,Me=209,Qe=210,mt=0,ht=1,ye=2,fe=3,H=4,j=5,q=6,pe=7,ee=0,te=1,Se=2,ke=0,Be=1,We=2,ve=3,K=4,J=5,Ee=300,xe=301,Je=302,Xe=303,Mt=304,qe=306,It=307,rn=1e3,Yt=1001,Tn=1002,Jt=1003,Fn=1004,mr=1004,fr=1005,Dt=1005,Ft=1006,$t=1007,Pn=1007,In=1008,zn=1008,bn=1009,Jn=1010,Er=1011,cr=1012,gi=1013,Lr=1014,vr=1015,je=1016,_t=1017,Ot=1018,At=1019,Gt=1020,En=1021,Sn=1022,pn=1023,De=1024,Ye=1025,ct=pn,bt=1026,yt=1027,zt=1028,kt=1029,sn=1030,jt=1031,Nt=1032,mn=1033,An=33776,Cn=33777,Gn=33778,tr=33779,Rn=35840,_r=35841,Nr=35842,Fi=35843,Xn=36196,dr=37492,ur=37496,$i=37808,qr=37809,Qr=37810,Z=37811,ie=37812,be=37813,Ae=37814,ze=37815,ft=37816,Ct=37817,Xt=37818,Et=37819,wt=37820,se=37821,he=36492,Te=37840,Pe=37841,Ce=37842,pt=37843,Rt=37844,Bt=37845,Kt=37846,hn=37847,Qt=37848,on=37849,$n=37850,kn=37851,Un=37852,fn=37853,Hn=2200,nr=2201,Tr=2202,Dr=2300,Vr=2301,ir=2302,ri=2400,Nn=2401,ya=2402,ba=2500,vo=2501,Qs=0,rc=1,Li=2,xa=3e3,ef=3001,Sp=3007,Tp=3002,zw=3003,A0=3004,E0=3005,_0=3006,Gw=3200,Vw=3201,ic=0,Ww=1,HR=0,Cp=7680,zR=7681,GR=7682,VR=7683,WR=34055,jR=34056,XR=5386,qR=512,YR=513,$R=514,KR=515,ZR=516,QR=517,JR=518,jw=519,tf=35044,ac=35048,eL=35040,tL=35045,nL=35049,rL=35041,iL=35046,aL=35050,oL=35042,sL="100",M0="300 es";function Xw(p,l,d,c,h,x,_){try{var R=p[x](_),O=R.value}catch(B){d(B);return}R.done?l(O):Promise.resolve(O).then(c,h)}function lL(p){return function(){var l=this,d=arguments;return new Promise(function(c,h){var x=p.apply(l,d);function _(O){Xw(x,c,h,_,R,"next",O)}function R(O){Xw(x,c,h,_,R,"throw",O)}_(void 0)})}}function qw(p,l){for(var d=0;d<l.length;d++){var c=l[d];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(p,c.key,c)}}function Rp(p,l,d){return l&&qw(p.prototype,l),d&&qw(p,d),p}function pr(p,l){p.prototype=Object.create(l.prototype),p.prototype.constructor=p,p.__proto__=l}function go(p){if(p===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return p}function cL(p,l){if(!!p){if(typeof p=="string")return Yw(p,l);var d=Object.prototype.toString.call(p).slice(8,-1);if(d==="Object"&&p.constructor&&(d=p.constructor.name),d==="Map"||d==="Set")return Array.from(p);if(d==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(d))return Yw(p,l)}}function Yw(p,l){(l==null||l>p.length)&&(l=p.length);for(var d=0,c=new Array(l);d<l;d++)c[d]=p[d];return c}function uL(p,l){var d;if(typeof Symbol=="undefined"||p[Symbol.iterator]==null){if(Array.isArray(p)||(d=cL(p))||l&&p&&typeof p.length=="number"){d&&(p=d);var c=0;return function(){return c>=p.length?{done:!0}:{done:!1,value:p[c++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}return d=p[Symbol.iterator](),d.next.bind(d)}function Ho(){}Object.assign(Ho.prototype,{addEventListener:function(l,d){this._listeners===void 0&&(this._listeners={});var c=this._listeners;c[l]===void 0&&(c[l]=[]),c[l].indexOf(d)===-1&&c[l].push(d)},hasEventListener:function(l,d){if(this._listeners===void 0)return!1;var c=this._listeners;return c[l]!==void 0&&c[l].indexOf(d)!==-1},removeEventListener:function(l,d){if(this._listeners!==void 0){var c=this._listeners,h=c[l];if(h!==void 0){var x=h.indexOf(d);x!==-1&&h.splice(x,1)}}},dispatchEvent:function(l){if(this._listeners!==void 0){var d=this._listeners,c=d[l.type];if(c!==void 0){l.target=this;for(var h=c.slice(0),x=0,_=h.length;x<_;x++)h[x].call(this,l)}}}});for(var Ki=[],nf=0;nf<256;nf++)Ki[nf]=(nf<16?"0":"")+nf.toString(16);var Lp=1234567,er={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var l=Math.random()*4294967295|0,d=Math.random()*4294967295|0,c=Math.random()*4294967295|0,h=Math.random()*4294967295|0,x=Ki[l&255]+Ki[l>>8&255]+Ki[l>>16&255]+Ki[l>>24&255]+"-"+Ki[d&255]+Ki[d>>8&255]+"-"+Ki[d>>16&15|64]+Ki[d>>24&255]+"-"+Ki[c&63|128]+Ki[c>>8&255]+"-"+Ki[c>>16&255]+Ki[c>>24&255]+Ki[h&255]+Ki[h>>8&255]+Ki[h>>16&255]+Ki[h>>24&255];return x.toUpperCase()},clamp:function(l,d,c){return Math.max(d,Math.min(c,l))},euclideanModulo:function(l,d){return(l%d+d)%d},mapLinear:function(l,d,c,h,x){return h+(l-d)*(x-h)/(c-d)},lerp:function(l,d,c){return(1-c)*l+c*d},damp:function(l,d,c,h){return er.lerp(l,d,1-Math.exp(-c*h))},pingpong:function(l,d){return d===void 0&&(d=1),d-Math.abs(er.euclideanModulo(l,d*2)-d)},smoothstep:function(l,d,c){return l<=d?0:l>=c?1:(l=(l-d)/(c-d),l*l*(3-2*l))},smootherstep:function(l,d,c){return l<=d?0:l>=c?1:(l=(l-d)/(c-d),l*l*l*(l*(l*6-15)+10))},randInt:function(l,d){return l+Math.floor(Math.random()*(d-l+1))},randFloat:function(l,d){return l+Math.random()*(d-l)},randFloatSpread:function(l){return l*(.5-Math.random())},seededRandom:function(l){return l!==void 0&&(Lp=l%2147483647),Lp=Lp*16807%2147483647,(Lp-1)/2147483646},degToRad:function(l){return l*er.DEG2RAD},radToDeg:function(l){return l*er.RAD2DEG},isPowerOfTwo:function(l){return(l&l-1)==0&&l!==0},ceilPowerOfTwo:function(l){return Math.pow(2,Math.ceil(Math.log(l)/Math.LN2))},floorPowerOfTwo:function(l){return Math.pow(2,Math.floor(Math.log(l)/Math.LN2))},setQuaternionFromProperEuler:function(l,d,c,h,x){var _=Math.cos,R=Math.sin,O=_(c/2),B=R(c/2),V=_((d+h)/2),G=R((d+h)/2),z=_((d-h)/2),ne=R((d-h)/2),Q=_((h-d)/2),le=R((h-d)/2);switch(x){case"XYX":l.set(O*G,B*z,B*ne,O*V);break;case"YZY":l.set(B*ne,O*G,B*z,O*V);break;case"ZXZ":l.set(B*z,B*ne,O*G,O*V);break;case"XZX":l.set(O*G,B*le,B*Q,O*V);break;case"YXY":l.set(B*Q,O*G,B*le,O*V);break;case"ZYZ":l.set(B*le,B*Q,O*G,O*V);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+x)}}},Zt=function(){function p(d,c){d===void 0&&(d=0),c===void 0&&(c=0),Object.defineProperty(this,"isVector2",{value:!0}),this.x=d,this.y=c}var l=p.prototype;return l.set=function(c,h){return this.x=c,this.y=h,this},l.setScalar=function(c){return this.x=c,this.y=c,this},l.setX=function(c){return this.x=c,this},l.setY=function(c){return this.y=c,this},l.setComponent=function(c,h){switch(c){case 0:this.x=h;break;case 1:this.y=h;break;default:throw new Error("index is out of range: "+c)}return this},l.getComponent=function(c){switch(c){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+c)}},l.clone=function(){return new this.constructor(this.x,this.y)},l.copy=function(c){return this.x=c.x,this.y=c.y,this},l.add=function(c,h){return h!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(c,h)):(this.x+=c.x,this.y+=c.y,this)},l.addScalar=function(c){return this.x+=c,this.y+=c,this},l.addVectors=function(c,h){return this.x=c.x+h.x,this.y=c.y+h.y,this},l.addScaledVector=function(c,h){return this.x+=c.x*h,this.y+=c.y*h,this},l.sub=function(c,h){return h!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(c,h)):(this.x-=c.x,this.y-=c.y,this)},l.subScalar=function(c){return this.x-=c,this.y-=c,this},l.subVectors=function(c,h){return this.x=c.x-h.x,this.y=c.y-h.y,this},l.multiply=function(c){return this.x*=c.x,this.y*=c.y,this},l.multiplyScalar=function(c){return this.x*=c,this.y*=c,this},l.divide=function(c){return this.x/=c.x,this.y/=c.y,this},l.divideScalar=function(c){return this.multiplyScalar(1/c)},l.applyMatrix3=function(c){var h=this.x,x=this.y,_=c.elements;return this.x=_[0]*h+_[3]*x+_[6],this.y=_[1]*h+_[4]*x+_[7],this},l.min=function(c){return this.x=Math.min(this.x,c.x),this.y=Math.min(this.y,c.y),this},l.max=function(c){return this.x=Math.max(this.x,c.x),this.y=Math.max(this.y,c.y),this},l.clamp=function(c,h){return this.x=Math.max(c.x,Math.min(h.x,this.x)),this.y=Math.max(c.y,Math.min(h.y,this.y)),this},l.clampScalar=function(c,h){return this.x=Math.max(c,Math.min(h,this.x)),this.y=Math.max(c,Math.min(h,this.y)),this},l.clampLength=function(c,h){var x=this.length();return this.divideScalar(x||1).multiplyScalar(Math.max(c,Math.min(h,x)))},l.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},l.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},l.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},l.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},l.negate=function(){return this.x=-this.x,this.y=-this.y,this},l.dot=function(c){return this.x*c.x+this.y*c.y},l.cross=function(c){return this.x*c.y-this.y*c.x},l.lengthSq=function(){return this.x*this.x+this.y*this.y},l.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},l.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)},l.normalize=function(){return this.divideScalar(this.length()||1)},l.angle=function(){var c=Math.atan2(-this.y,-this.x)+Math.PI;return c},l.distanceTo=function(c){return Math.sqrt(this.distanceToSquared(c))},l.distanceToSquared=function(c){var h=this.x-c.x,x=this.y-c.y;return h*h+x*x},l.manhattanDistanceTo=function(c){return Math.abs(this.x-c.x)+Math.abs(this.y-c.y)},l.setLength=function(c){return this.normalize().multiplyScalar(c)},l.lerp=function(c,h){return this.x+=(c.x-this.x)*h,this.y+=(c.y-this.y)*h,this},l.lerpVectors=function(c,h,x){return this.x=c.x+(h.x-c.x)*x,this.y=c.y+(h.y-c.y)*x,this},l.equals=function(c){return c.x===this.x&&c.y===this.y},l.fromArray=function(c,h){return h===void 0&&(h=0),this.x=c[h],this.y=c[h+1],this},l.toArray=function(c,h){return c===void 0&&(c=[]),h===void 0&&(h=0),c[h]=this.x,c[h+1]=this.y,c},l.fromBufferAttribute=function(c,h,x){return x!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=c.getX(h),this.y=c.getY(h),this},l.rotateAround=function(c,h){var x=Math.cos(h),_=Math.sin(h),R=this.x-c.x,O=this.y-c.y;return this.x=R*x-O*_+c.x,this.y=R*_+O*x+c.y,this},l.random=function(){return this.x=Math.random(),this.y=Math.random(),this},Rp(p,[{key:"width",get:function(){return this.x},set:function(c){this.x=c}},{key:"height",get:function(){return this.y},set:function(c){this.y=c}}]),p}(),Ua=function(){function p(){Object.defineProperty(this,"isMatrix3",{value:!0}),this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}var l=p.prototype;return l.set=function(c,h,x,_,R,O,B,V,G){var z=this.elements;return z[0]=c,z[1]=_,z[2]=B,z[3]=h,z[4]=R,z[5]=V,z[6]=x,z[7]=O,z[8]=G,this},l.identity=function(){return this.set(1,0,0,0,1,0,0,0,1),this},l.clone=function(){return new this.constructor().fromArray(this.elements)},l.copy=function(c){var h=this.elements,x=c.elements;return h[0]=x[0],h[1]=x[1],h[2]=x[2],h[3]=x[3],h[4]=x[4],h[5]=x[5],h[6]=x[6],h[7]=x[7],h[8]=x[8],this},l.extractBasis=function(c,h,x){return c.setFromMatrix3Column(this,0),h.setFromMatrix3Column(this,1),x.setFromMatrix3Column(this,2),this},l.setFromMatrix4=function(c){var h=c.elements;return this.set(h[0],h[4],h[8],h[1],h[5],h[9],h[2],h[6],h[10]),this},l.multiply=function(c){return this.multiplyMatrices(this,c)},l.premultiply=function(c){return this.multiplyMatrices(c,this)},l.multiplyMatrices=function(c,h){var x=c.elements,_=h.elements,R=this.elements,O=x[0],B=x[3],V=x[6],G=x[1],z=x[4],ne=x[7],Q=x[2],le=x[5],me=x[8],ue=_[0],re=_[3],Oe=_[6],He=_[1],Re=_[4],we=_[7],Ue=_[2],rt=_[5],nt=_[8];return R[0]=O*ue+B*He+V*Ue,R[3]=O*re+B*Re+V*rt,R[6]=O*Oe+B*we+V*nt,R[1]=G*ue+z*He+ne*Ue,R[4]=G*re+z*Re+ne*rt,R[7]=G*Oe+z*we+ne*nt,R[2]=Q*ue+le*He+me*Ue,R[5]=Q*re+le*Re+me*rt,R[8]=Q*Oe+le*we+me*nt,this},l.multiplyScalar=function(c){var h=this.elements;return h[0]*=c,h[3]*=c,h[6]*=c,h[1]*=c,h[4]*=c,h[7]*=c,h[2]*=c,h[5]*=c,h[8]*=c,this},l.determinant=function(){var c=this.elements,h=c[0],x=c[1],_=c[2],R=c[3],O=c[4],B=c[5],V=c[6],G=c[7],z=c[8];return h*O*z-h*B*G-x*R*z+x*B*V+_*R*G-_*O*V},l.invert=function(){var c=this.elements,h=c[0],x=c[1],_=c[2],R=c[3],O=c[4],B=c[5],V=c[6],G=c[7],z=c[8],ne=z*O-B*G,Q=B*V-z*R,le=G*R-O*V,me=h*ne+x*Q+_*le;if(me===0)return this.set(0,0,0,0,0,0,0,0,0);var ue=1/me;return c[0]=ne*ue,c[1]=(_*G-z*x)*ue,c[2]=(B*x-_*O)*ue,c[3]=Q*ue,c[4]=(z*h-_*V)*ue,c[5]=(_*R-B*h)*ue,c[6]=le*ue,c[7]=(x*V-G*h)*ue,c[8]=(O*h-x*R)*ue,this},l.transpose=function(){var c,h=this.elements;return c=h[1],h[1]=h[3],h[3]=c,c=h[2],h[2]=h[6],h[6]=c,c=h[5],h[5]=h[7],h[7]=c,this},l.getNormalMatrix=function(c){return this.setFromMatrix4(c).copy(this).invert().transpose()},l.transposeIntoArray=function(c){var h=this.elements;return c[0]=h[0],c[1]=h[3],c[2]=h[6],c[3]=h[1],c[4]=h[4],c[5]=h[7],c[6]=h[2],c[7]=h[5],c[8]=h[8],this},l.setUvTransform=function(c,h,x,_,R,O,B){var V=Math.cos(R),G=Math.sin(R);return this.set(x*V,x*G,-x*(V*O+G*B)+O+c,-_*G,_*V,-_*(-G*O+V*B)+B+h,0,0,1),this},l.scale=function(c,h){var x=this.elements;return x[0]*=c,x[3]*=c,x[6]*=c,x[1]*=h,x[4]*=h,x[7]*=h,this},l.rotate=function(c){var h=Math.cos(c),x=Math.sin(c),_=this.elements,R=_[0],O=_[3],B=_[6],V=_[1],G=_[4],z=_[7];return _[0]=h*R+x*V,_[3]=h*O+x*G,_[6]=h*B+x*z,_[1]=-x*R+h*V,_[4]=-x*O+h*G,_[7]=-x*B+h*z,this},l.translate=function(c,h){var x=this.elements;return x[0]+=c*x[2],x[3]+=c*x[5],x[6]+=c*x[8],x[1]+=h*x[2],x[4]+=h*x[5],x[7]+=h*x[8],this},l.equals=function(c){for(var h=this.elements,x=c.elements,_=0;_<9;_++)if(h[_]!==x[_])return!1;return!0},l.fromArray=function(c,h){h===void 0&&(h=0);for(var x=0;x<9;x++)this.elements[x]=c[x+h];return this},l.toArray=function(c,h){c===void 0&&(c=[]),h===void 0&&(h=0);var x=this.elements;return c[h]=x[0],c[h+1]=x[1],c[h+2]=x[2],c[h+3]=x[3],c[h+4]=x[4],c[h+5]=x[5],c[h+6]=x[6],c[h+7]=x[7],c[h+8]=x[8],c},p}(),ru,oc={getDataURL:function(l){if(/^data:/i.test(l.src)||typeof HTMLCanvasElement=="undefined")return l.src;var d;if(l instanceof HTMLCanvasElement)d=l;else{ru===void 0&&(ru=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),ru.width=l.width,ru.height=l.height;var c=ru.getContext("2d");l instanceof ImageData?c.putImageData(l,0,0):c.drawImage(l,0,0,l.width,l.height),d=ru}return d.width>2048||d.height>2048?d.toDataURL("image/jpeg",.6):d.toDataURL("image/png")}},hL=0;function ii(p,l,d,c,h,x,_,R,O,B){p===void 0&&(p=ii.DEFAULT_IMAGE),l===void 0&&(l=ii.DEFAULT_MAPPING),d===void 0&&(d=Yt),c===void 0&&(c=Yt),h===void 0&&(h=Ft),x===void 0&&(x=In),_===void 0&&(_=pn),R===void 0&&(R=bn),O===void 0&&(O=1),B===void 0&&(B=xa),Object.defineProperty(this,"id",{value:hL++}),this.uuid=er.generateUUID(),this.name="",this.image=p,this.mipmaps=[],this.mapping=l,this.wrapS=d,this.wrapT=c,this.magFilter=h,this.minFilter=x,this.anisotropy=O,this.format=_,this.internalFormat=null,this.type=R,this.offset=new Zt(0,0),this.repeat=new Zt(1,1),this.center=new Zt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ua,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=B,this.version=0,this.onUpdate=null}ii.DEFAULT_IMAGE=void 0,ii.DEFAULT_MAPPING=Ee,ii.prototype=Object.assign(Object.create(Ho.prototype),{constructor:ii,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function(l){return this.name=l.name,this.image=l.image,this.mipmaps=l.mipmaps.slice(0),this.mapping=l.mapping,this.wrapS=l.wrapS,this.wrapT=l.wrapT,this.magFilter=l.magFilter,this.minFilter=l.minFilter,this.anisotropy=l.anisotropy,this.format=l.format,this.internalFormat=l.internalFormat,this.type=l.type,this.offset.copy(l.offset),this.repeat.copy(l.repeat),this.center.copy(l.center),this.rotation=l.rotation,this.matrixAutoUpdate=l.matrixAutoUpdate,this.matrix.copy(l.matrix),this.generateMipmaps=l.generateMipmaps,this.premultiplyAlpha=l.premultiplyAlpha,this.flipY=l.flipY,this.unpackAlignment=l.unpackAlignment,this.encoding=l.encoding,this},toJSON:function(l){var d=l===void 0||typeof l=="string";if(!d&&l.textures[this.uuid]!==void 0)return l.textures[this.uuid];var c={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){var h=this.image;if(h.uuid===void 0&&(h.uuid=er.generateUUID()),!d&&l.images[h.uuid]===void 0){var x;if(Array.isArray(h)){x=[];for(var _=0,R=h.length;_<R;_++)h[_].isDataTexture?x.push(S0(h[_].image)):x.push(S0(h[_]))}else x=S0(h);l.images[h.uuid]={uuid:h.uuid,url:x}}c.image=h.uuid}return d||(l.textures[this.uuid]=c),c},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(l){if(this.mapping!==Ee)return l;if(l.applyMatrix3(this.matrix),l.x<0||l.x>1)switch(this.wrapS){case rn:l.x=l.x-Math.floor(l.x);break;case Yt:l.x=l.x<0?0:1;break;case Tn:Math.abs(Math.floor(l.x)%2)===1?l.x=Math.ceil(l.x)-l.x:l.x=l.x-Math.floor(l.x);break}if(l.y<0||l.y>1)switch(this.wrapT){case rn:l.y=l.y-Math.floor(l.y);break;case Yt:l.y=l.y<0?0:1;break;case Tn:Math.abs(Math.floor(l.y)%2)===1?l.y=Math.ceil(l.y)-l.y:l.y=l.y-Math.floor(l.y);break}return this.flipY&&(l.y=1-l.y),l}}),Object.defineProperty(ii.prototype,"needsUpdate",{set:function(l){l===!0&&this.version++}});function S0(p){return typeof HTMLImageElement!="undefined"&&p instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&p instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&p instanceof ImageBitmap?oc.getDataURL(p):p.data?{data:Array.prototype.slice.call(p.data),width:p.width,height:p.height,type:p.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var Yr=function(){function p(d,c,h,x){d===void 0&&(d=0),c===void 0&&(c=0),h===void 0&&(h=0),x===void 0&&(x=1),Object.defineProperty(this,"isVector4",{value:!0}),this.x=d,this.y=c,this.z=h,this.w=x}var l=p.prototype;return l.set=function(c,h,x,_){return this.x=c,this.y=h,this.z=x,this.w=_,this},l.setScalar=function(c){return this.x=c,this.y=c,this.z=c,this.w=c,this},l.setX=function(c){return this.x=c,this},l.setY=function(c){return this.y=c,this},l.setZ=function(c){return this.z=c,this},l.setW=function(c){return this.w=c,this},l.setComponent=function(c,h){switch(c){case 0:this.x=h;break;case 1:this.y=h;break;case 2:this.z=h;break;case 3:this.w=h;break;default:throw new Error("index is out of range: "+c)}return this},l.getComponent=function(c){switch(c){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+c)}},l.clone=function(){return new this.constructor(this.x,this.y,this.z,this.w)},l.copy=function(c){return this.x=c.x,this.y=c.y,this.z=c.z,this.w=c.w!==void 0?c.w:1,this},l.add=function(c,h){return h!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(c,h)):(this.x+=c.x,this.y+=c.y,this.z+=c.z,this.w+=c.w,this)},l.addScalar=function(c){return this.x+=c,this.y+=c,this.z+=c,this.w+=c,this},l.addVectors=function(c,h){return this.x=c.x+h.x,this.y=c.y+h.y,this.z=c.z+h.z,this.w=c.w+h.w,this},l.addScaledVector=function(c,h){return this.x+=c.x*h,this.y+=c.y*h,this.z+=c.z*h,this.w+=c.w*h,this},l.sub=function(c,h){return h!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(c,h)):(this.x-=c.x,this.y-=c.y,this.z-=c.z,this.w-=c.w,this)},l.subScalar=function(c){return this.x-=c,this.y-=c,this.z-=c,this.w-=c,this},l.subVectors=function(c,h){return this.x=c.x-h.x,this.y=c.y-h.y,this.z=c.z-h.z,this.w=c.w-h.w,this},l.multiply=function(c){return this.x*=c.x,this.y*=c.y,this.z*=c.z,this.w*=c.w,this},l.multiplyScalar=function(c){return this.x*=c,this.y*=c,this.z*=c,this.w*=c,this},l.applyMatrix4=function(c){var h=this.x,x=this.y,_=this.z,R=this.w,O=c.elements;return this.x=O[0]*h+O[4]*x+O[8]*_+O[12]*R,this.y=O[1]*h+O[5]*x+O[9]*_+O[13]*R,this.z=O[2]*h+O[6]*x+O[10]*_+O[14]*R,this.w=O[3]*h+O[7]*x+O[11]*_+O[15]*R,this},l.divideScalar=function(c){return this.multiplyScalar(1/c)},l.setAxisAngleFromQuaternion=function(c){this.w=2*Math.acos(c.w);var h=Math.sqrt(1-c.w*c.w);return h<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=c.x/h,this.y=c.y/h,this.z=c.z/h),this},l.setAxisAngleFromRotationMatrix=function(c){var h,x,_,R,O=.01,B=.1,V=c.elements,G=V[0],z=V[4],ne=V[8],Q=V[1],le=V[5],me=V[9],ue=V[2],re=V[6],Oe=V[10];if(Math.abs(z-Q)<O&&Math.abs(ne-ue)<O&&Math.abs(me-re)<O){if(Math.abs(z+Q)<B&&Math.abs(ne+ue)<B&&Math.abs(me+re)<B&&Math.abs(G+le+Oe-3)<B)return this.set(1,0,0,0),this;h=Math.PI;var He=(G+1)/2,Re=(le+1)/2,we=(Oe+1)/2,Ue=(z+Q)/4,rt=(ne+ue)/4,nt=(me+re)/4;return He>Re&&He>we?He<O?(x=0,_=.707106781,R=.707106781):(x=Math.sqrt(He),_=Ue/x,R=rt/x):Re>we?Re<O?(x=.707106781,_=0,R=.707106781):(_=Math.sqrt(Re),x=Ue/_,R=nt/_):we<O?(x=.707106781,_=.707106781,R=0):(R=Math.sqrt(we),x=rt/R,_=nt/R),this.set(x,_,R,h),this}var ot=Math.sqrt((re-me)*(re-me)+(ne-ue)*(ne-ue)+(Q-z)*(Q-z));return Math.abs(ot)<.001&&(ot=1),this.x=(re-me)/ot,this.y=(ne-ue)/ot,this.z=(Q-z)/ot,this.w=Math.acos((G+le+Oe-1)/2),this},l.min=function(c){return this.x=Math.min(this.x,c.x),this.y=Math.min(this.y,c.y),this.z=Math.min(this.z,c.z),this.w=Math.min(this.w,c.w),this},l.max=function(c){return this.x=Math.max(this.x,c.x),this.y=Math.max(this.y,c.y),this.z=Math.max(this.z,c.z),this.w=Math.max(this.w,c.w),this},l.clamp=function(c,h){return this.x=Math.max(c.x,Math.min(h.x,this.x)),this.y=Math.max(c.y,Math.min(h.y,this.y)),this.z=Math.max(c.z,Math.min(h.z,this.z)),this.w=Math.max(c.w,Math.min(h.w,this.w)),this},l.clampScalar=function(c,h){return this.x=Math.max(c,Math.min(h,this.x)),this.y=Math.max(c,Math.min(h,this.y)),this.z=Math.max(c,Math.min(h,this.z)),this.w=Math.max(c,Math.min(h,this.w)),this},l.clampLength=function(c,h){var x=this.length();return this.divideScalar(x||1).multiplyScalar(Math.max(c,Math.min(h,x)))},l.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},l.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},l.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},l.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},l.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},l.dot=function(c){return this.x*c.x+this.y*c.y+this.z*c.z+this.w*c.w},l.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},l.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},l.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},l.normalize=function(){return this.divideScalar(this.length()||1)},l.setLength=function(c){return this.normalize().multiplyScalar(c)},l.lerp=function(c,h){return this.x+=(c.x-this.x)*h,this.y+=(c.y-this.y)*h,this.z+=(c.z-this.z)*h,this.w+=(c.w-this.w)*h,this},l.lerpVectors=function(c,h,x){return this.x=c.x+(h.x-c.x)*x,this.y=c.y+(h.y-c.y)*x,this.z=c.z+(h.z-c.z)*x,this.w=c.w+(h.w-c.w)*x,this},l.equals=function(c){return c.x===this.x&&c.y===this.y&&c.z===this.z&&c.w===this.w},l.fromArray=function(c,h){return h===void 0&&(h=0),this.x=c[h],this.y=c[h+1],this.z=c[h+2],this.w=c[h+3],this},l.toArray=function(c,h){return c===void 0&&(c=[]),h===void 0&&(h=0),c[h]=this.x,c[h+1]=this.y,c[h+2]=this.z,c[h+3]=this.w,c},l.fromBufferAttribute=function(c,h,x){return x!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=c.getX(h),this.y=c.getY(h),this.z=c.getZ(h),this.w=c.getW(h),this},l.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this},Rp(p,[{key:"width",get:function(){return this.z},set:function(c){this.z=c}},{key:"height",get:function(){return this.w},set:function(c){this.w=c}}]),p}(),Js=function(p){pr(l,p);function l(c,h,x){var _;return _=p.call(this)||this,Object.defineProperty(go(_),"isWebGLRenderTarget",{value:!0}),_.width=c,_.height=h,_.scissor=new Yr(0,0,c,h),_.scissorTest=!1,_.viewport=new Yr(0,0,c,h),x=x||{},_.texture=new ii(void 0,x.mapping,x.wrapS,x.wrapT,x.magFilter,x.minFilter,x.format,x.type,x.anisotropy,x.encoding),_.texture.image={},_.texture.image.width=c,_.texture.image.height=h,_.texture.generateMipmaps=x.generateMipmaps!==void 0?x.generateMipmaps:!1,_.texture.minFilter=x.minFilter!==void 0?x.minFilter:Ft,_.depthBuffer=x.depthBuffer!==void 0?x.depthBuffer:!0,_.stencilBuffer=x.stencilBuffer!==void 0?x.stencilBuffer:!1,_.depthTexture=x.depthTexture!==void 0?x.depthTexture:null,_}var d=l.prototype;return d.setSize=function(h,x){(this.width!==h||this.height!==x)&&(this.width=h,this.height=x,this.texture.image.width=h,this.texture.image.height=x,this.dispose()),this.viewport.set(0,0,h,x),this.scissor.set(0,0,h,x)},d.clone=function(){return new this.constructor().copy(this)},d.copy=function(h){return this.width=h.width,this.height=h.height,this.viewport.copy(h.viewport),this.texture=h.texture.clone(),this.depthBuffer=h.depthBuffer,this.stencilBuffer=h.stencilBuffer,this.depthTexture=h.depthTexture,this},d.dispose=function(){this.dispatchEvent({type:"dispose"})},l}(Ho),fL=function(p){pr(l,p);function l(c,h,x){var _;return _=p.call(this,c,h,x)||this,Object.defineProperty(go(_),"isWebGLMultisampleRenderTarget",{value:!0}),_.samples=4,_}var d=l.prototype;return d.copy=function(h){return p.prototype.copy.call(this,h),this.samples=h.samples,this},l}(Js),Zi=function(){function p(d,c,h,x){d===void 0&&(d=0),c===void 0&&(c=0),h===void 0&&(h=0),x===void 0&&(x=1),Object.defineProperty(this,"isQuaternion",{value:!0}),this._x=d,this._y=c,this._z=h,this._w=x}p.slerp=function(c,h,x,_){return x.copy(c).slerp(h,_)},p.slerpFlat=function(c,h,x,_,R,O,B){var V=x[_+0],G=x[_+1],z=x[_+2],ne=x[_+3],Q=R[O+0],le=R[O+1],me=R[O+2],ue=R[O+3];if(ne!==ue||V!==Q||G!==le||z!==me){var re=1-B,Oe=V*Q+G*le+z*me+ne*ue,He=Oe>=0?1:-1,Re=1-Oe*Oe;if(Re>Number.EPSILON){var we=Math.sqrt(Re),Ue=Math.atan2(we,Oe*He);re=Math.sin(re*Ue)/we,B=Math.sin(B*Ue)/we}var rt=B*He;if(V=V*re+Q*rt,G=G*re+le*rt,z=z*re+me*rt,ne=ne*re+ue*rt,re===1-B){var nt=1/Math.sqrt(V*V+G*G+z*z+ne*ne);V*=nt,G*=nt,z*=nt,ne*=nt}}c[h]=V,c[h+1]=G,c[h+2]=z,c[h+3]=ne},p.multiplyQuaternionsFlat=function(c,h,x,_,R,O){var B=x[_],V=x[_+1],G=x[_+2],z=x[_+3],ne=R[O],Q=R[O+1],le=R[O+2],me=R[O+3];return c[h]=B*me+z*ne+V*le-G*Q,c[h+1]=V*me+z*Q+G*ne-B*le,c[h+2]=G*me+z*le+B*Q-V*ne,c[h+3]=z*me-B*ne-V*Q-G*le,c};var l=p.prototype;return l.set=function(c,h,x,_){return this._x=c,this._y=h,this._z=x,this._w=_,this._onChangeCallback(),this},l.clone=function(){return new this.constructor(this._x,this._y,this._z,this._w)},l.copy=function(c){return this._x=c.x,this._y=c.y,this._z=c.z,this._w=c.w,this._onChangeCallback(),this},l.setFromEuler=function(c,h){if(!(c&&c.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var x=c._x,_=c._y,R=c._z,O=c._order,B=Math.cos,V=Math.sin,G=B(x/2),z=B(_/2),ne=B(R/2),Q=V(x/2),le=V(_/2),me=V(R/2);switch(O){case"XYZ":this._x=Q*z*ne+G*le*me,this._y=G*le*ne-Q*z*me,this._z=G*z*me+Q*le*ne,this._w=G*z*ne-Q*le*me;break;case"YXZ":this._x=Q*z*ne+G*le*me,this._y=G*le*ne-Q*z*me,this._z=G*z*me-Q*le*ne,this._w=G*z*ne+Q*le*me;break;case"ZXY":this._x=Q*z*ne-G*le*me,this._y=G*le*ne+Q*z*me,this._z=G*z*me+Q*le*ne,this._w=G*z*ne-Q*le*me;break;case"ZYX":this._x=Q*z*ne-G*le*me,this._y=G*le*ne+Q*z*me,this._z=G*z*me-Q*le*ne,this._w=G*z*ne+Q*le*me;break;case"YZX":this._x=Q*z*ne+G*le*me,this._y=G*le*ne+Q*z*me,this._z=G*z*me-Q*le*ne,this._w=G*z*ne-Q*le*me;break;case"XZY":this._x=Q*z*ne-G*le*me,this._y=G*le*ne-Q*z*me,this._z=G*z*me+Q*le*ne,this._w=G*z*ne+Q*le*me;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+O)}return h!==!1&&this._onChangeCallback(),this},l.setFromAxisAngle=function(c,h){var x=h/2,_=Math.sin(x);return this._x=c.x*_,this._y=c.y*_,this._z=c.z*_,this._w=Math.cos(x),this._onChangeCallback(),this},l.setFromRotationMatrix=function(c){var h=c.elements,x=h[0],_=h[4],R=h[8],O=h[1],B=h[5],V=h[9],G=h[2],z=h[6],ne=h[10],Q=x+B+ne;if(Q>0){var le=.5/Math.sqrt(Q+1);this._w=.25/le,this._x=(z-V)*le,this._y=(R-G)*le,this._z=(O-_)*le}else if(x>B&&x>ne){var me=2*Math.sqrt(1+x-B-ne);this._w=(z-V)/me,this._x=.25*me,this._y=(_+O)/me,this._z=(R+G)/me}else if(B>ne){var ue=2*Math.sqrt(1+B-x-ne);this._w=(R-G)/ue,this._x=(_+O)/ue,this._y=.25*ue,this._z=(V+z)/ue}else{var re=2*Math.sqrt(1+ne-x-B);this._w=(O-_)/re,this._x=(R+G)/re,this._y=(V+z)/re,this._z=.25*re}return this._onChangeCallback(),this},l.setFromUnitVectors=function(c,h){var x=1e-6,_=c.dot(h)+1;return _<x?(_=0,Math.abs(c.x)>Math.abs(c.z)?(this._x=-c.y,this._y=c.x,this._z=0,this._w=_):(this._x=0,this._y=-c.z,this._z=c.y,this._w=_)):(this._x=c.y*h.z-c.z*h.y,this._y=c.z*h.x-c.x*h.z,this._z=c.x*h.y-c.y*h.x,this._w=_),this.normalize()},l.angleTo=function(c){return 2*Math.acos(Math.abs(er.clamp(this.dot(c),-1,1)))},l.rotateTowards=function(c,h){var x=this.angleTo(c);if(x===0)return this;var _=Math.min(1,h/x);return this.slerp(c,_),this},l.identity=function(){return this.set(0,0,0,1)},l.invert=function(){return this.conjugate()},l.conjugate=function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},l.dot=function(c){return this._x*c._x+this._y*c._y+this._z*c._z+this._w*c._w},l.lengthSq=function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},l.length=function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},l.normalize=function(){var c=this.length();return c===0?(this._x=0,this._y=0,this._z=0,this._w=1):(c=1/c,this._x=this._x*c,this._y=this._y*c,this._z=this._z*c,this._w=this._w*c),this._onChangeCallback(),this},l.multiply=function(c,h){return h!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(c,h)):this.multiplyQuaternions(this,c)},l.premultiply=function(c){return this.multiplyQuaternions(c,this)},l.multiplyQuaternions=function(c,h){var x=c._x,_=c._y,R=c._z,O=c._w,B=h._x,V=h._y,G=h._z,z=h._w;return this._x=x*z+O*B+_*G-R*V,this._y=_*z+O*V+R*B-x*G,this._z=R*z+O*G+x*V-_*B,this._w=O*z-x*B-_*V-R*G,this._onChangeCallback(),this},l.slerp=function(c,h){if(h===0)return this;if(h===1)return this.copy(c);var x=this._x,_=this._y,R=this._z,O=this._w,B=O*c._w+x*c._x+_*c._y+R*c._z;if(B<0?(this._w=-c._w,this._x=-c._x,this._y=-c._y,this._z=-c._z,B=-B):this.copy(c),B>=1)return this._w=O,this._x=x,this._y=_,this._z=R,this;var V=1-B*B;if(V<=Number.EPSILON){var G=1-h;return this._w=G*O+h*this._w,this._x=G*x+h*this._x,this._y=G*_+h*this._y,this._z=G*R+h*this._z,this.normalize(),this._onChangeCallback(),this}var z=Math.sqrt(V),ne=Math.atan2(z,B),Q=Math.sin((1-h)*ne)/z,le=Math.sin(h*ne)/z;return this._w=O*Q+this._w*le,this._x=x*Q+this._x*le,this._y=_*Q+this._y*le,this._z=R*Q+this._z*le,this._onChangeCallback(),this},l.equals=function(c){return c._x===this._x&&c._y===this._y&&c._z===this._z&&c._w===this._w},l.fromArray=function(c,h){return h===void 0&&(h=0),this._x=c[h],this._y=c[h+1],this._z=c[h+2],this._w=c[h+3],this._onChangeCallback(),this},l.toArray=function(c,h){return c===void 0&&(c=[]),h===void 0&&(h=0),c[h]=this._x,c[h+1]=this._y,c[h+2]=this._z,c[h+3]=this._w,c},l.fromBufferAttribute=function(c,h){return this._x=c.getX(h),this._y=c.getY(h),this._z=c.getZ(h),this._w=c.getW(h),this},l._onChange=function(c){return this._onChangeCallback=c,this},l._onChangeCallback=function(){},Rp(p,[{key:"x",get:function(){return this._x},set:function(c){this._x=c,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(c){this._y=c,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(c){this._z=c,this._onChangeCallback()}},{key:"w",get:function(){return this._w},set:function(c){this._w=c,this._onChangeCallback()}}]),p}(),Ge=function(){function p(d,c,h){d===void 0&&(d=0),c===void 0&&(c=0),h===void 0&&(h=0),Object.defineProperty(this,"isVector3",{value:!0}),this.x=d,this.y=c,this.z=h}var l=p.prototype;return l.set=function(c,h,x){return x===void 0&&(x=this.z),this.x=c,this.y=h,this.z=x,this},l.setScalar=function(c){return this.x=c,this.y=c,this.z=c,this},l.setX=function(c){return this.x=c,this},l.setY=function(c){return this.y=c,this},l.setZ=function(c){return this.z=c,this},l.setComponent=function(c,h){switch(c){case 0:this.x=h;break;case 1:this.y=h;break;case 2:this.z=h;break;default:throw new Error("index is out of range: "+c)}return this},l.getComponent=function(c){switch(c){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+c)}},l.clone=function(){return new this.constructor(this.x,this.y,this.z)},l.copy=function(c){return this.x=c.x,this.y=c.y,this.z=c.z,this},l.add=function(c,h){return h!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(c,h)):(this.x+=c.x,this.y+=c.y,this.z+=c.z,this)},l.addScalar=function(c){return this.x+=c,this.y+=c,this.z+=c,this},l.addVectors=function(c,h){return this.x=c.x+h.x,this.y=c.y+h.y,this.z=c.z+h.z,this},l.addScaledVector=function(c,h){return this.x+=c.x*h,this.y+=c.y*h,this.z+=c.z*h,this},l.sub=function(c,h){return h!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(c,h)):(this.x-=c.x,this.y-=c.y,this.z-=c.z,this)},l.subScalar=function(c){return this.x-=c,this.y-=c,this.z-=c,this},l.subVectors=function(c,h){return this.x=c.x-h.x,this.y=c.y-h.y,this.z=c.z-h.z,this},l.multiply=function(c,h){return h!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(c,h)):(this.x*=c.x,this.y*=c.y,this.z*=c.z,this)},l.multiplyScalar=function(c){return this.x*=c,this.y*=c,this.z*=c,this},l.multiplyVectors=function(c,h){return this.x=c.x*h.x,this.y=c.y*h.y,this.z=c.z*h.z,this},l.applyEuler=function(c){return c&&c.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion($w.setFromEuler(c))},l.applyAxisAngle=function(c,h){return this.applyQuaternion($w.setFromAxisAngle(c,h))},l.applyMatrix3=function(c){var h=this.x,x=this.y,_=this.z,R=c.elements;return this.x=R[0]*h+R[3]*x+R[6]*_,this.y=R[1]*h+R[4]*x+R[7]*_,this.z=R[2]*h+R[5]*x+R[8]*_,this},l.applyNormalMatrix=function(c){return this.applyMatrix3(c).normalize()},l.applyMatrix4=function(c){var h=this.x,x=this.y,_=this.z,R=c.elements,O=1/(R[3]*h+R[7]*x+R[11]*_+R[15]);return this.x=(R[0]*h+R[4]*x+R[8]*_+R[12])*O,this.y=(R[1]*h+R[5]*x+R[9]*_+R[13])*O,this.z=(R[2]*h+R[6]*x+R[10]*_+R[14])*O,this},l.applyQuaternion=function(c){var h=this.x,x=this.y,_=this.z,R=c.x,O=c.y,B=c.z,V=c.w,G=V*h+O*_-B*x,z=V*x+B*h-R*_,ne=V*_+R*x-O*h,Q=-R*h-O*x-B*_;return this.x=G*V+Q*-R+z*-B-ne*-O,this.y=z*V+Q*-O+ne*-R-G*-B,this.z=ne*V+Q*-B+G*-O-z*-R,this},l.project=function(c){return this.applyMatrix4(c.matrixWorldInverse).applyMatrix4(c.projectionMatrix)},l.unproject=function(c){return this.applyMatrix4(c.projectionMatrixInverse).applyMatrix4(c.matrixWorld)},l.transformDirection=function(c){var h=this.x,x=this.y,_=this.z,R=c.elements;return this.x=R[0]*h+R[4]*x+R[8]*_,this.y=R[1]*h+R[5]*x+R[9]*_,this.z=R[2]*h+R[6]*x+R[10]*_,this.normalize()},l.divide=function(c){return this.x/=c.x,this.y/=c.y,this.z/=c.z,this},l.divideScalar=function(c){return this.multiplyScalar(1/c)},l.min=function(c){return this.x=Math.min(this.x,c.x),this.y=Math.min(this.y,c.y),this.z=Math.min(this.z,c.z),this},l.max=function(c){return this.x=Math.max(this.x,c.x),this.y=Math.max(this.y,c.y),this.z=Math.max(this.z,c.z),this},l.clamp=function(c,h){return this.x=Math.max(c.x,Math.min(h.x,this.x)),this.y=Math.max(c.y,Math.min(h.y,this.y)),this.z=Math.max(c.z,Math.min(h.z,this.z)),this},l.clampScalar=function(c,h){return this.x=Math.max(c,Math.min(h,this.x)),this.y=Math.max(c,Math.min(h,this.y)),this.z=Math.max(c,Math.min(h,this.z)),this},l.clampLength=function(c,h){var x=this.length();return this.divideScalar(x||1).multiplyScalar(Math.max(c,Math.min(h,x)))},l.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},l.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},l.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},l.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},l.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},l.dot=function(c){return this.x*c.x+this.y*c.y+this.z*c.z},l.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z},l.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},l.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},l.normalize=function(){return this.divideScalar(this.length()||1)},l.setLength=function(c){return this.normalize().multiplyScalar(c)},l.lerp=function(c,h){return this.x+=(c.x-this.x)*h,this.y+=(c.y-this.y)*h,this.z+=(c.z-this.z)*h,this},l.lerpVectors=function(c,h,x){return this.x=c.x+(h.x-c.x)*x,this.y=c.y+(h.y-c.y)*x,this.z=c.z+(h.z-c.z)*x,this},l.cross=function(c,h){return h!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(c,h)):this.crossVectors(this,c)},l.crossVectors=function(c,h){var x=c.x,_=c.y,R=c.z,O=h.x,B=h.y,V=h.z;return this.x=_*V-R*B,this.y=R*O-x*V,this.z=x*B-_*O,this},l.projectOnVector=function(c){var h=c.lengthSq();if(h===0)return this.set(0,0,0);var x=c.dot(this)/h;return this.copy(c).multiplyScalar(x)},l.projectOnPlane=function(c){return T0.copy(this).projectOnVector(c),this.sub(T0)},l.reflect=function(c){return this.sub(T0.copy(c).multiplyScalar(2*this.dot(c)))},l.angleTo=function(c){var h=Math.sqrt(this.lengthSq()*c.lengthSq());if(h===0)return Math.PI/2;var x=this.dot(c)/h;return Math.acos(er.clamp(x,-1,1))},l.distanceTo=function(c){return Math.sqrt(this.distanceToSquared(c))},l.distanceToSquared=function(c){var h=this.x-c.x,x=this.y-c.y,_=this.z-c.z;return h*h+x*x+_*_},l.manhattanDistanceTo=function(c){return Math.abs(this.x-c.x)+Math.abs(this.y-c.y)+Math.abs(this.z-c.z)},l.setFromSpherical=function(c){return this.setFromSphericalCoords(c.radius,c.phi,c.theta)},l.setFromSphericalCoords=function(c,h,x){var _=Math.sin(h)*c;return this.x=_*Math.sin(x),this.y=Math.cos(h)*c,this.z=_*Math.cos(x),this},l.setFromCylindrical=function(c){return this.setFromCylindricalCoords(c.radius,c.theta,c.y)},l.setFromCylindricalCoords=function(c,h,x){return this.x=c*Math.sin(h),this.y=x,this.z=c*Math.cos(h),this},l.setFromMatrixPosition=function(c){var h=c.elements;return this.x=h[12],this.y=h[13],this.z=h[14],this},l.setFromMatrixScale=function(c){var h=this.setFromMatrixColumn(c,0).length(),x=this.setFromMatrixColumn(c,1).length(),_=this.setFromMatrixColumn(c,2).length();return this.x=h,this.y=x,this.z=_,this},l.setFromMatrixColumn=function(c,h){return this.fromArray(c.elements,h*4)},l.setFromMatrix3Column=function(c,h){return this.fromArray(c.elements,h*3)},l.equals=function(c){return c.x===this.x&&c.y===this.y&&c.z===this.z},l.fromArray=function(c,h){return h===void 0&&(h=0),this.x=c[h],this.y=c[h+1],this.z=c[h+2],this},l.toArray=function(c,h){return c===void 0&&(c=[]),h===void 0&&(h=0),c[h]=this.x,c[h+1]=this.y,c[h+2]=this.z,c},l.fromBufferAttribute=function(c,h,x){return x!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=c.getX(h),this.y=c.getY(h),this.z=c.getZ(h),this},l.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this},p}(),T0=new Ge,$w=new Zi,vs=function(){function p(d,c){Object.defineProperty(this,"isBox3",{value:!0}),this.min=d!==void 0?d:new Ge(1/0,1/0,1/0),this.max=c!==void 0?c:new Ge(-1/0,-1/0,-1/0)}var l=p.prototype;return l.set=function(c,h){return this.min.copy(c),this.max.copy(h),this},l.setFromArray=function(c){for(var h=1/0,x=1/0,_=1/0,R=-1/0,O=-1/0,B=-1/0,V=0,G=c.length;V<G;V+=3){var z=c[V],ne=c[V+1],Q=c[V+2];z<h&&(h=z),ne<x&&(x=ne),Q<_&&(_=Q),z>R&&(R=z),ne>O&&(O=ne),Q>B&&(B=Q)}return this.min.set(h,x,_),this.max.set(R,O,B),this},l.setFromBufferAttribute=function(c){for(var h=1/0,x=1/0,_=1/0,R=-1/0,O=-1/0,B=-1/0,V=0,G=c.count;V<G;V++){var z=c.getX(V),ne=c.getY(V),Q=c.getZ(V);z<h&&(h=z),ne<x&&(x=ne),Q<_&&(_=Q),z>R&&(R=z),ne>O&&(O=ne),Q>B&&(B=Q)}return this.min.set(h,x,_),this.max.set(R,O,B),this},l.setFromPoints=function(c){this.makeEmpty();for(var h=0,x=c.length;h<x;h++)this.expandByPoint(c[h]);return this},l.setFromCenterAndSize=function(c,h){var x=rf.copy(h).multiplyScalar(.5);return this.min.copy(c).sub(x),this.max.copy(c).add(x),this},l.setFromObject=function(c){return this.makeEmpty(),this.expandByObject(c)},l.clone=function(){return new this.constructor().copy(this)},l.copy=function(c){return this.min.copy(c.min),this.max.copy(c.max),this},l.makeEmpty=function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},l.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},l.getCenter=function(c){return c===void 0&&(console.warn("THREE.Box3: .getCenter() target is now required"),c=new Ge),this.isEmpty()?c.set(0,0,0):c.addVectors(this.min,this.max).multiplyScalar(.5)},l.getSize=function(c){return c===void 0&&(console.warn("THREE.Box3: .getSize() target is now required"),c=new Ge),this.isEmpty()?c.set(0,0,0):c.subVectors(this.max,this.min)},l.expandByPoint=function(c){return this.min.min(c),this.max.max(c),this},l.expandByVector=function(c){return this.min.sub(c),this.max.add(c),this},l.expandByScalar=function(c){return this.min.addScalar(-c),this.max.addScalar(c),this},l.expandByObject=function(c){c.updateWorldMatrix(!1,!1);var h=c.geometry;h!==void 0&&(h.boundingBox===null&&h.computeBoundingBox(),R0.copy(h.boundingBox),R0.applyMatrix4(c.matrixWorld),this.union(R0));for(var x=c.children,_=0,R=x.length;_<R;_++)this.expandByObject(x[_]);return this},l.containsPoint=function(c){return!(c.x<this.min.x||c.x>this.max.x||c.y<this.min.y||c.y>this.max.y||c.z<this.min.z||c.z>this.max.z)},l.containsBox=function(c){return this.min.x<=c.min.x&&c.max.x<=this.max.x&&this.min.y<=c.min.y&&c.max.y<=this.max.y&&this.min.z<=c.min.z&&c.max.z<=this.max.z},l.getParameter=function(c,h){return h===void 0&&(console.warn("THREE.Box3: .getParameter() target is now required"),h=new Ge),h.set((c.x-this.min.x)/(this.max.x-this.min.x),(c.y-this.min.y)/(this.max.y-this.min.y),(c.z-this.min.z)/(this.max.z-this.min.z))},l.intersectsBox=function(c){return!(c.max.x<this.min.x||c.min.x>this.max.x||c.max.y<this.min.y||c.min.y>this.max.y||c.max.z<this.min.z||c.min.z>this.max.z)},l.intersectsSphere=function(c){return this.clampPoint(c.center,rf),rf.distanceToSquared(c.center)<=c.radius*c.radius},l.intersectsPlane=function(c){var h,x;return c.normal.x>0?(h=c.normal.x*this.min.x,x=c.normal.x*this.max.x):(h=c.normal.x*this.max.x,x=c.normal.x*this.min.x),c.normal.y>0?(h+=c.normal.y*this.min.y,x+=c.normal.y*this.max.y):(h+=c.normal.y*this.max.y,x+=c.normal.y*this.min.y),c.normal.z>0?(h+=c.normal.z*this.min.z,x+=c.normal.z*this.max.z):(h+=c.normal.z*this.max.z,x+=c.normal.z*this.min.z),h<=-c.constant&&x>=-c.constant},l.intersectsTriangle=function(c){if(this.isEmpty())return!1;this.getCenter(af),Pp.subVectors(this.max,af),iu.subVectors(c.a,af),au.subVectors(c.b,af),ou.subVectors(c.c,af),el.subVectors(au,iu),tl.subVectors(ou,au),sc.subVectors(iu,ou);var h=[0,-el.z,el.y,0,-tl.z,tl.y,0,-sc.z,sc.y,el.z,0,-el.x,tl.z,0,-tl.x,sc.z,0,-sc.x,-el.y,el.x,0,-tl.y,tl.x,0,-sc.y,sc.x,0];return!C0(h,iu,au,ou,Pp)||(h=[1,0,0,0,1,0,0,0,1],!C0(h,iu,au,ou,Pp))?!1:(Dp.crossVectors(el,tl),h=[Dp.x,Dp.y,Dp.z],C0(h,iu,au,ou,Pp))},l.clampPoint=function(c,h){return h===void 0&&(console.warn("THREE.Box3: .clampPoint() target is now required"),h=new Ge),h.copy(c).clamp(this.min,this.max)},l.distanceToPoint=function(c){var h=rf.copy(c).clamp(this.min,this.max);return h.sub(c).length()},l.getBoundingSphere=function(c){return c===void 0&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(c.center),c.radius=this.getSize(rf).length()*.5,c},l.intersect=function(c){return this.min.max(c.min),this.max.min(c.max),this.isEmpty()&&this.makeEmpty(),this},l.union=function(c){return this.min.min(c.min),this.max.max(c.max),this},l.applyMatrix4=function(c){return this.isEmpty()?this:(gs[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(c),gs[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(c),gs[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(c),gs[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(c),gs[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(c),gs[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(c),gs[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(c),gs[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(c),this.setFromPoints(gs),this)},l.translate=function(c){return this.min.add(c),this.max.add(c),this},l.equals=function(c){return c.min.equals(this.min)&&c.max.equals(this.max)},p}();function C0(p,l,d,c,h){for(var x=0,_=p.length-3;x<=_;x+=3){lc.fromArray(p,x);var R=h.x*Math.abs(lc.x)+h.y*Math.abs(lc.y)+h.z*Math.abs(lc.z),O=l.dot(lc),B=d.dot(lc),V=c.dot(lc);if(Math.max(-Math.max(O,B,V),Math.min(O,B,V))>R)return!1}return!0}var gs=[new Ge,new Ge,new Ge,new Ge,new Ge,new Ge,new Ge,new Ge],rf=new Ge,R0=new vs,iu=new Ge,au=new Ge,ou=new Ge,el=new Ge,tl=new Ge,sc=new Ge,af=new Ge,Pp=new Ge,Dp=new Ge,lc=new Ge,dL=new vs,nl=function(){function p(d,c){this.center=d!==void 0?d:new Ge,this.radius=c!==void 0?c:-1}var l=p.prototype;return l.set=function(c,h){return this.center.copy(c),this.radius=h,this},l.setFromPoints=function(c,h){var x=this.center;h!==void 0?x.copy(h):dL.setFromPoints(c).getCenter(x);for(var _=0,R=0,O=c.length;R<O;R++)_=Math.max(_,x.distanceToSquared(c[R]));return this.radius=Math.sqrt(_),this},l.clone=function(){return new this.constructor().copy(this)},l.copy=function(c){return this.center.copy(c.center),this.radius=c.radius,this},l.isEmpty=function(){return this.radius<0},l.makeEmpty=function(){return this.center.set(0,0,0),this.radius=-1,this},l.containsPoint=function(c){return c.distanceToSquared(this.center)<=this.radius*this.radius},l.distanceToPoint=function(c){return c.distanceTo(this.center)-this.radius},l.intersectsSphere=function(c){var h=this.radius+c.radius;return c.center.distanceToSquared(this.center)<=h*h},l.intersectsBox=function(c){return c.intersectsSphere(this)},l.intersectsPlane=function(c){return Math.abs(c.distanceToPoint(this.center))<=this.radius},l.clampPoint=function(c,h){var x=this.center.distanceToSquared(c);return h===void 0&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),h=new Ge),h.copy(c),x>this.radius*this.radius&&(h.sub(this.center).normalize(),h.multiplyScalar(this.radius).add(this.center)),h},l.getBoundingBox=function(c){return c===void 0&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),c=new vs),this.isEmpty()?(c.makeEmpty(),c):(c.set(this.center,this.center),c.expandByScalar(this.radius),c)},l.applyMatrix4=function(c){return this.center.applyMatrix4(c),this.radius=this.radius*c.getMaxScaleOnAxis(),this},l.translate=function(c){return this.center.add(c),this},l.equals=function(c){return c.center.equals(this.center)&&c.radius===this.radius},p}(),ys=new Ge,L0=new Ge,Op=new Ge,rl=new Ge,P0=new Ge,Ip=new Ge,D0=new Ge,su=function(){function p(d,c){this.origin=d!==void 0?d:new Ge,this.direction=c!==void 0?c:new Ge(0,0,-1)}var l=p.prototype;return l.set=function(c,h){return this.origin.copy(c),this.direction.copy(h),this},l.clone=function(){return new this.constructor().copy(this)},l.copy=function(c){return this.origin.copy(c.origin),this.direction.copy(c.direction),this},l.at=function(c,h){return h===void 0&&(console.warn("THREE.Ray: .at() target is now required"),h=new Ge),h.copy(this.direction).multiplyScalar(c).add(this.origin)},l.lookAt=function(c){return this.direction.copy(c).sub(this.origin).normalize(),this},l.recast=function(c){return this.origin.copy(this.at(c,ys)),this},l.closestPointToPoint=function(c,h){h===void 0&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),h=new Ge),h.subVectors(c,this.origin);var x=h.dot(this.direction);return x<0?h.copy(this.origin):h.copy(this.direction).multiplyScalar(x).add(this.origin)},l.distanceToPoint=function(c){return Math.sqrt(this.distanceSqToPoint(c))},l.distanceSqToPoint=function(c){var h=ys.subVectors(c,this.origin).dot(this.direction);return h<0?this.origin.distanceToSquared(c):(ys.copy(this.direction).multiplyScalar(h).add(this.origin),ys.distanceToSquared(c))},l.distanceSqToSegment=function(c,h,x,_){L0.copy(c).add(h).multiplyScalar(.5),Op.copy(h).sub(c).normalize(),rl.copy(this.origin).sub(L0);var R=c.distanceTo(h)*.5,O=-this.direction.dot(Op),B=rl.dot(this.direction),V=-rl.dot(Op),G=rl.lengthSq(),z=Math.abs(1-O*O),ne,Q,le,me;if(z>0)if(ne=O*V-B,Q=O*B-V,me=R*z,ne>=0)if(Q>=-me)if(Q<=me){var ue=1/z;ne*=ue,Q*=ue,le=ne*(ne+O*Q+2*B)+Q*(O*ne+Q+2*V)+G}else Q=R,ne=Math.max(0,-(O*Q+B)),le=-ne*ne+Q*(Q+2*V)+G;else Q=-R,ne=Math.max(0,-(O*Q+B)),le=-ne*ne+Q*(Q+2*V)+G;else Q<=-me?(ne=Math.max(0,-(-O*R+B)),Q=ne>0?-R:Math.min(Math.max(-R,-V),R),le=-ne*ne+Q*(Q+2*V)+G):Q<=me?(ne=0,Q=Math.min(Math.max(-R,-V),R),le=Q*(Q+2*V)+G):(ne=Math.max(0,-(O*R+B)),Q=ne>0?R:Math.min(Math.max(-R,-V),R),le=-ne*ne+Q*(Q+2*V)+G);else Q=O>0?-R:R,ne=Math.max(0,-(O*Q+B)),le=-ne*ne+Q*(Q+2*V)+G;return x&&x.copy(this.direction).multiplyScalar(ne).add(this.origin),_&&_.copy(Op).multiplyScalar(Q).add(L0),le},l.intersectSphere=function(c,h){ys.subVectors(c.center,this.origin);var x=ys.dot(this.direction),_=ys.dot(ys)-x*x,R=c.radius*c.radius;if(_>R)return null;var O=Math.sqrt(R-_),B=x-O,V=x+O;return B<0&&V<0?null:B<0?this.at(V,h):this.at(B,h)},l.intersectsSphere=function(c){return this.distanceSqToPoint(c.center)<=c.radius*c.radius},l.distanceToPlane=function(c){var h=c.normal.dot(this.direction);if(h===0)return c.distanceToPoint(this.origin)===0?0:null;var x=-(this.origin.dot(c.normal)+c.constant)/h;return x>=0?x:null},l.intersectPlane=function(c,h){var x=this.distanceToPlane(c);return x===null?null:this.at(x,h)},l.intersectsPlane=function(c){var h=c.distanceToPoint(this.origin);if(h===0)return!0;var x=c.normal.dot(this.direction);return x*h<0},l.intersectBox=function(c,h){var x,_,R,O,B,V,G=1/this.direction.x,z=1/this.direction.y,ne=1/this.direction.z,Q=this.origin;return G>=0?(x=(c.min.x-Q.x)*G,_=(c.max.x-Q.x)*G):(x=(c.max.x-Q.x)*G,_=(c.min.x-Q.x)*G),z>=0?(R=(c.min.y-Q.y)*z,O=(c.max.y-Q.y)*z):(R=(c.max.y-Q.y)*z,O=(c.min.y-Q.y)*z),x>O||R>_||((R>x||x!==x)&&(x=R),(O<_||_!==_)&&(_=O),ne>=0?(B=(c.min.z-Q.z)*ne,V=(c.max.z-Q.z)*ne):(B=(c.max.z-Q.z)*ne,V=(c.min.z-Q.z)*ne),x>V||B>_)||((B>x||x!==x)&&(x=B),(V<_||_!==_)&&(_=V),_<0)?null:this.at(x>=0?x:_,h)},l.intersectsBox=function(c){return this.intersectBox(c,ys)!==null},l.intersectTriangle=function(c,h,x,_,R){P0.subVectors(h,c),Ip.subVectors(x,c),D0.crossVectors(P0,Ip);var O=this.direction.dot(D0),B;if(O>0){if(_)return null;B=1}else if(O<0)B=-1,O=-O;else return null;rl.subVectors(this.origin,c);var V=B*this.direction.dot(Ip.crossVectors(rl,Ip));if(V<0)return null;var G=B*this.direction.dot(P0.cross(rl));if(G<0||V+G>O)return null;var z=-B*rl.dot(D0);return z<0?null:this.at(z/O,R)},l.applyMatrix4=function(c){return this.origin.applyMatrix4(c),this.direction.transformDirection(c),this},l.equals=function(c){return c.origin.equals(this.origin)&&c.direction.equals(this.direction)},p}(),br=function(){function p(){Object.defineProperty(this,"isMatrix4",{value:!0}),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}var l=p.prototype;return l.set=function(c,h,x,_,R,O,B,V,G,z,ne,Q,le,me,ue,re){var Oe=this.elements;return Oe[0]=c,Oe[4]=h,Oe[8]=x,Oe[12]=_,Oe[1]=R,Oe[5]=O,Oe[9]=B,Oe[13]=V,Oe[2]=G,Oe[6]=z,Oe[10]=ne,Oe[14]=Q,Oe[3]=le,Oe[7]=me,Oe[11]=ue,Oe[15]=re,this},l.identity=function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},l.clone=function(){return new p().fromArray(this.elements)},l.copy=function(c){var h=this.elements,x=c.elements;return h[0]=x[0],h[1]=x[1],h[2]=x[2],h[3]=x[3],h[4]=x[4],h[5]=x[5],h[6]=x[6],h[7]=x[7],h[8]=x[8],h[9]=x[9],h[10]=x[10],h[11]=x[11],h[12]=x[12],h[13]=x[13],h[14]=x[14],h[15]=x[15],this},l.copyPosition=function(c){var h=this.elements,x=c.elements;return h[12]=x[12],h[13]=x[13],h[14]=x[14],this},l.setFromMatrix3=function(c){var h=c.elements;return this.set(h[0],h[3],h[6],0,h[1],h[4],h[7],0,h[2],h[5],h[8],0,0,0,0,1),this},l.extractBasis=function(c,h,x){return c.setFromMatrixColumn(this,0),h.setFromMatrixColumn(this,1),x.setFromMatrixColumn(this,2),this},l.makeBasis=function(c,h,x){return this.set(c.x,h.x,x.x,0,c.y,h.y,x.y,0,c.z,h.z,x.z,0,0,0,0,1),this},l.extractRotation=function(c){var h=this.elements,x=c.elements,_=1/lu.setFromMatrixColumn(c,0).length(),R=1/lu.setFromMatrixColumn(c,1).length(),O=1/lu.setFromMatrixColumn(c,2).length();return h[0]=x[0]*_,h[1]=x[1]*_,h[2]=x[2]*_,h[3]=0,h[4]=x[4]*R,h[5]=x[5]*R,h[6]=x[6]*R,h[7]=0,h[8]=x[8]*O,h[9]=x[9]*O,h[10]=x[10]*O,h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,this},l.makeRotationFromEuler=function(c){c&&c.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var h=this.elements,x=c.x,_=c.y,R=c.z,O=Math.cos(x),B=Math.sin(x),V=Math.cos(_),G=Math.sin(_),z=Math.cos(R),ne=Math.sin(R);if(c.order==="XYZ"){var Q=O*z,le=O*ne,me=B*z,ue=B*ne;h[0]=V*z,h[4]=-V*ne,h[8]=G,h[1]=le+me*G,h[5]=Q-ue*G,h[9]=-B*V,h[2]=ue-Q*G,h[6]=me+le*G,h[10]=O*V}else if(c.order==="YXZ"){var re=V*z,Oe=V*ne,He=G*z,Re=G*ne;h[0]=re+Re*B,h[4]=He*B-Oe,h[8]=O*G,h[1]=O*ne,h[5]=O*z,h[9]=-B,h[2]=Oe*B-He,h[6]=Re+re*B,h[10]=O*V}else if(c.order==="ZXY"){var we=V*z,Ue=V*ne,rt=G*z,nt=G*ne;h[0]=we-nt*B,h[4]=-O*ne,h[8]=rt+Ue*B,h[1]=Ue+rt*B,h[5]=O*z,h[9]=nt-we*B,h[2]=-O*G,h[6]=B,h[10]=O*V}else if(c.order==="ZYX"){var ot=O*z,ut=O*ne,st=B*z,et=B*ne;h[0]=V*z,h[4]=st*G-ut,h[8]=ot*G+et,h[1]=V*ne,h[5]=et*G+ot,h[9]=ut*G-st,h[2]=-G,h[6]=B*V,h[10]=O*V}else if(c.order==="YZX"){var dt=O*V,at=O*G,it=B*V,Ke=B*G;h[0]=V*z,h[4]=Ke-dt*ne,h[8]=it*ne+at,h[1]=ne,h[5]=O*z,h[9]=-B*z,h[2]=-G*z,h[6]=at*ne+it,h[10]=dt-Ke*ne}else if(c.order==="XZY"){var vt=O*V,gt=O*G,St=B*V,Tt=B*G;h[0]=V*z,h[4]=-ne,h[8]=G*z,h[1]=vt*ne+Tt,h[5]=O*z,h[9]=gt*ne-St,h[2]=St*ne-gt,h[6]=B*z,h[10]=Tt*ne+vt}return h[3]=0,h[7]=0,h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,this},l.makeRotationFromQuaternion=function(c){return this.compose(pL,c,mL)},l.lookAt=function(c,h,x){var _=this.elements;return Ha.subVectors(c,h),Ha.lengthSq()===0&&(Ha.z=1),Ha.normalize(),il.crossVectors(x,Ha),il.lengthSq()===0&&(Math.abs(x.z)===1?Ha.x+=1e-4:Ha.z+=1e-4,Ha.normalize(),il.crossVectors(x,Ha)),il.normalize(),kp.crossVectors(Ha,il),_[0]=il.x,_[4]=kp.x,_[8]=Ha.x,_[1]=il.y,_[5]=kp.y,_[9]=Ha.y,_[2]=il.z,_[6]=kp.z,_[10]=Ha.z,this},l.multiply=function(c,h){return h!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(c,h)):this.multiplyMatrices(this,c)},l.premultiply=function(c){return this.multiplyMatrices(c,this)},l.multiplyMatrices=function(c,h){var x=c.elements,_=h.elements,R=this.elements,O=x[0],B=x[4],V=x[8],G=x[12],z=x[1],ne=x[5],Q=x[9],le=x[13],me=x[2],ue=x[6],re=x[10],Oe=x[14],He=x[3],Re=x[7],we=x[11],Ue=x[15],rt=_[0],nt=_[4],ot=_[8],ut=_[12],st=_[1],et=_[5],dt=_[9],at=_[13],it=_[2],Ke=_[6],vt=_[10],gt=_[14],St=_[3],Tt=_[7],qt=_[11],en=_[15];return R[0]=O*rt+B*st+V*it+G*St,R[4]=O*nt+B*et+V*Ke+G*Tt,R[8]=O*ot+B*dt+V*vt+G*qt,R[12]=O*ut+B*at+V*gt+G*en,R[1]=z*rt+ne*st+Q*it+le*St,R[5]=z*nt+ne*et+Q*Ke+le*Tt,R[9]=z*ot+ne*dt+Q*vt+le*qt,R[13]=z*ut+ne*at+Q*gt+le*en,R[2]=me*rt+ue*st+re*it+Oe*St,R[6]=me*nt+ue*et+re*Ke+Oe*Tt,R[10]=me*ot+ue*dt+re*vt+Oe*qt,R[14]=me*ut+ue*at+re*gt+Oe*en,R[3]=He*rt+Re*st+we*it+Ue*St,R[7]=He*nt+Re*et+we*Ke+Ue*Tt,R[11]=He*ot+Re*dt+we*vt+Ue*qt,R[15]=He*ut+Re*at+we*gt+Ue*en,this},l.multiplyScalar=function(c){var h=this.elements;return h[0]*=c,h[4]*=c,h[8]*=c,h[12]*=c,h[1]*=c,h[5]*=c,h[9]*=c,h[13]*=c,h[2]*=c,h[6]*=c,h[10]*=c,h[14]*=c,h[3]*=c,h[7]*=c,h[11]*=c,h[15]*=c,this},l.determinant=function(){var c=this.elements,h=c[0],x=c[4],_=c[8],R=c[12],O=c[1],B=c[5],V=c[9],G=c[13],z=c[2],ne=c[6],Q=c[10],le=c[14],me=c[3],ue=c[7],re=c[11],Oe=c[15];return me*(+R*V*ne-_*G*ne-R*B*Q+x*G*Q+_*B*le-x*V*le)+ue*(+h*V*le-h*G*Q+R*O*Q-_*O*le+_*G*z-R*V*z)+re*(+h*G*ne-h*B*le-R*O*ne+x*O*le+R*B*z-x*G*z)+Oe*(-_*B*z-h*V*ne+h*B*Q+_*O*ne-x*O*Q+x*V*z)},l.transpose=function(){var c=this.elements,h;return h=c[1],c[1]=c[4],c[4]=h,h=c[2],c[2]=c[8],c[8]=h,h=c[6],c[6]=c[9],c[9]=h,h=c[3],c[3]=c[12],c[12]=h,h=c[7],c[7]=c[13],c[13]=h,h=c[11],c[11]=c[14],c[14]=h,this},l.setPosition=function(c,h,x){var _=this.elements;return c.isVector3?(_[12]=c.x,_[13]=c.y,_[14]=c.z):(_[12]=c,_[13]=h,_[14]=x),this},l.invert=function(){var c=this.elements,h=c[0],x=c[1],_=c[2],R=c[3],O=c[4],B=c[5],V=c[6],G=c[7],z=c[8],ne=c[9],Q=c[10],le=c[11],me=c[12],ue=c[13],re=c[14],Oe=c[15],He=ne*re*G-ue*Q*G+ue*V*le-B*re*le-ne*V*Oe+B*Q*Oe,Re=me*Q*G-z*re*G-me*V*le+O*re*le+z*V*Oe-O*Q*Oe,we=z*ue*G-me*ne*G+me*B*le-O*ue*le-z*B*Oe+O*ne*Oe,Ue=me*ne*V-z*ue*V-me*B*Q+O*ue*Q+z*B*re-O*ne*re,rt=h*He+x*Re+_*we+R*Ue;if(rt===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var nt=1/rt;return c[0]=He*nt,c[1]=(ue*Q*R-ne*re*R-ue*_*le+x*re*le+ne*_*Oe-x*Q*Oe)*nt,c[2]=(B*re*R-ue*V*R+ue*_*G-x*re*G-B*_*Oe+x*V*Oe)*nt,c[3]=(ne*V*R-B*Q*R-ne*_*G+x*Q*G+B*_*le-x*V*le)*nt,c[4]=Re*nt,c[5]=(z*re*R-me*Q*R+me*_*le-h*re*le-z*_*Oe+h*Q*Oe)*nt,c[6]=(me*V*R-O*re*R-me*_*G+h*re*G+O*_*Oe-h*V*Oe)*nt,c[7]=(O*Q*R-z*V*R+z*_*G-h*Q*G-O*_*le+h*V*le)*nt,c[8]=we*nt,c[9]=(me*ne*R-z*ue*R-me*x*le+h*ue*le+z*x*Oe-h*ne*Oe)*nt,c[10]=(O*ue*R-me*B*R+me*x*G-h*ue*G-O*x*Oe+h*B*Oe)*nt,c[11]=(z*B*R-O*ne*R-z*x*G+h*ne*G+O*x*le-h*B*le)*nt,c[12]=Ue*nt,c[13]=(z*ue*_-me*ne*_+me*x*Q-h*ue*Q-z*x*re+h*ne*re)*nt,c[14]=(me*B*_-O*ue*_-me*x*V+h*ue*V+O*x*re-h*B*re)*nt,c[15]=(O*ne*_-z*B*_+z*x*V-h*ne*V-O*x*Q+h*B*Q)*nt,this},l.scale=function(c){var h=this.elements,x=c.x,_=c.y,R=c.z;return h[0]*=x,h[4]*=_,h[8]*=R,h[1]*=x,h[5]*=_,h[9]*=R,h[2]*=x,h[6]*=_,h[10]*=R,h[3]*=x,h[7]*=_,h[11]*=R,this},l.getMaxScaleOnAxis=function(){var c=this.elements,h=c[0]*c[0]+c[1]*c[1]+c[2]*c[2],x=c[4]*c[4]+c[5]*c[5]+c[6]*c[6],_=c[8]*c[8]+c[9]*c[9]+c[10]*c[10];return Math.sqrt(Math.max(h,x,_))},l.makeTranslation=function(c,h,x){return this.set(1,0,0,c,0,1,0,h,0,0,1,x,0,0,0,1),this},l.makeRotationX=function(c){var h=Math.cos(c),x=Math.sin(c);return this.set(1,0,0,0,0,h,-x,0,0,x,h,0,0,0,0,1),this},l.makeRotationY=function(c){var h=Math.cos(c),x=Math.sin(c);return this.set(h,0,x,0,0,1,0,0,-x,0,h,0,0,0,0,1),this},l.makeRotationZ=function(c){var h=Math.cos(c),x=Math.sin(c);return this.set(h,-x,0,0,x,h,0,0,0,0,1,0,0,0,0,1),this},l.makeRotationAxis=function(c,h){var x=Math.cos(h),_=Math.sin(h),R=1-x,O=c.x,B=c.y,V=c.z,G=R*O,z=R*B;return this.set(G*O+x,G*B-_*V,G*V+_*B,0,G*B+_*V,z*B+x,z*V-_*O,0,G*V-_*B,z*V+_*O,R*V*V+x,0,0,0,0,1),this},l.makeScale=function(c,h,x){return this.set(c,0,0,0,0,h,0,0,0,0,x,0,0,0,0,1),this},l.makeShear=function(c,h,x){return this.set(1,h,x,0,c,1,x,0,c,h,1,0,0,0,0,1),this},l.compose=function(c,h,x){var _=this.elements,R=h._x,O=h._y,B=h._z,V=h._w,G=R+R,z=O+O,ne=B+B,Q=R*G,le=R*z,me=R*ne,ue=O*z,re=O*ne,Oe=B*ne,He=V*G,Re=V*z,we=V*ne,Ue=x.x,rt=x.y,nt=x.z;return _[0]=(1-(ue+Oe))*Ue,_[1]=(le+we)*Ue,_[2]=(me-Re)*Ue,_[3]=0,_[4]=(le-we)*rt,_[5]=(1-(Q+Oe))*rt,_[6]=(re+He)*rt,_[7]=0,_[8]=(me+Re)*nt,_[9]=(re-He)*nt,_[10]=(1-(Q+ue))*nt,_[11]=0,_[12]=c.x,_[13]=c.y,_[14]=c.z,_[15]=1,this},l.decompose=function(c,h,x){var _=this.elements,R=lu.set(_[0],_[1],_[2]).length(),O=lu.set(_[4],_[5],_[6]).length(),B=lu.set(_[8],_[9],_[10]).length(),V=this.determinant();V<0&&(R=-R),c.x=_[12],c.y=_[13],c.z=_[14],yo.copy(this);var G=1/R,z=1/O,ne=1/B;return yo.elements[0]*=G,yo.elements[1]*=G,yo.elements[2]*=G,yo.elements[4]*=z,yo.elements[5]*=z,yo.elements[6]*=z,yo.elements[8]*=ne,yo.elements[9]*=ne,yo.elements[10]*=ne,h.setFromRotationMatrix(yo),x.x=R,x.y=O,x.z=B,this},l.makePerspective=function(c,h,x,_,R,O){O===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var B=this.elements,V=2*R/(h-c),G=2*R/(x-_),z=(h+c)/(h-c),ne=(x+_)/(x-_),Q=-(O+R)/(O-R),le=-2*O*R/(O-R);return B[0]=V,B[4]=0,B[8]=z,B[12]=0,B[1]=0,B[5]=G,B[9]=ne,B[13]=0,B[2]=0,B[6]=0,B[10]=Q,B[14]=le,B[3]=0,B[7]=0,B[11]=-1,B[15]=0,this},l.makeOrthographic=function(c,h,x,_,R,O){var B=this.elements,V=1/(h-c),G=1/(x-_),z=1/(O-R),ne=(h+c)*V,Q=(x+_)*G,le=(O+R)*z;return B[0]=2*V,B[4]=0,B[8]=0,B[12]=-ne,B[1]=0,B[5]=2*G,B[9]=0,B[13]=-Q,B[2]=0,B[6]=0,B[10]=-2*z,B[14]=-le,B[3]=0,B[7]=0,B[11]=0,B[15]=1,this},l.equals=function(c){for(var h=this.elements,x=c.elements,_=0;_<16;_++)if(h[_]!==x[_])return!1;return!0},l.fromArray=function(c,h){h===void 0&&(h=0);for(var x=0;x<16;x++)this.elements[x]=c[x+h];return this},l.toArray=function(c,h){c===void 0&&(c=[]),h===void 0&&(h=0);var x=this.elements;return c[h]=x[0],c[h+1]=x[1],c[h+2]=x[2],c[h+3]=x[3],c[h+4]=x[4],c[h+5]=x[5],c[h+6]=x[6],c[h+7]=x[7],c[h+8]=x[8],c[h+9]=x[9],c[h+10]=x[10],c[h+11]=x[11],c[h+12]=x[12],c[h+13]=x[13],c[h+14]=x[14],c[h+15]=x[15],c},p}(),lu=new Ge,yo=new br,pL=new Ge(0,0,0),mL=new Ge(1,1,1),il=new Ge,kp=new Ge,Ha=new Ge,Fp=function(){function p(d,c,h,x){d===void 0&&(d=0),c===void 0&&(c=0),h===void 0&&(h=0),x===void 0&&(x=p.DefaultOrder),Object.defineProperty(this,"isEuler",{value:!0}),this._x=d,this._y=c,this._z=h,this._order=x}var l=p.prototype;return l.set=function(c,h,x,_){return this._x=c,this._y=h,this._z=x,this._order=_||this._order,this._onChangeCallback(),this},l.clone=function(){return new this.constructor(this._x,this._y,this._z,this._order)},l.copy=function(c){return this._x=c._x,this._y=c._y,this._z=c._z,this._order=c._order,this._onChangeCallback(),this},l.setFromRotationMatrix=function(c,h,x){var _=er.clamp,R=c.elements,O=R[0],B=R[4],V=R[8],G=R[1],z=R[5],ne=R[9],Q=R[2],le=R[6],me=R[10];switch(h=h||this._order,h){case"XYZ":this._y=Math.asin(_(V,-1,1)),Math.abs(V)<.9999999?(this._x=Math.atan2(-ne,me),this._z=Math.atan2(-B,O)):(this._x=Math.atan2(le,z),this._z=0);break;case"YXZ":this._x=Math.asin(-_(ne,-1,1)),Math.abs(ne)<.9999999?(this._y=Math.atan2(V,me),this._z=Math.atan2(G,z)):(this._y=Math.atan2(-Q,O),this._z=0);break;case"ZXY":this._x=Math.asin(_(le,-1,1)),Math.abs(le)<.9999999?(this._y=Math.atan2(-Q,me),this._z=Math.atan2(-B,z)):(this._y=0,this._z=Math.atan2(G,O));break;case"ZYX":this._y=Math.asin(-_(Q,-1,1)),Math.abs(Q)<.9999999?(this._x=Math.atan2(le,me),this._z=Math.atan2(G,O)):(this._x=0,this._z=Math.atan2(-B,z));break;case"YZX":this._z=Math.asin(_(G,-1,1)),Math.abs(G)<.9999999?(this._x=Math.atan2(-ne,z),this._y=Math.atan2(-Q,O)):(this._x=0,this._y=Math.atan2(V,me));break;case"XZY":this._z=Math.asin(-_(B,-1,1)),Math.abs(B)<.9999999?(this._x=Math.atan2(le,z),this._y=Math.atan2(V,O)):(this._x=Math.atan2(-ne,me),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+h)}return this._order=h,x!==!1&&this._onChangeCallback(),this},l.setFromQuaternion=function(c,h,x){return Kw.makeRotationFromQuaternion(c),this.setFromRotationMatrix(Kw,h,x)},l.setFromVector3=function(c,h){return this.set(c.x,c.y,c.z,h||this._order)},l.reorder=function(c){return Zw.setFromEuler(this),this.setFromQuaternion(Zw,c)},l.equals=function(c){return c._x===this._x&&c._y===this._y&&c._z===this._z&&c._order===this._order},l.fromArray=function(c){return this._x=c[0],this._y=c[1],this._z=c[2],c[3]!==void 0&&(this._order=c[3]),this._onChangeCallback(),this},l.toArray=function(c,h){return c===void 0&&(c=[]),h===void 0&&(h=0),c[h]=this._x,c[h+1]=this._y,c[h+2]=this._z,c[h+3]=this._order,c},l.toVector3=function(c){return c?c.set(this._x,this._y,this._z):new Ge(this._x,this._y,this._z)},l._onChange=function(c){return this._onChangeCallback=c,this},l._onChangeCallback=function(){},Rp(p,[{key:"x",get:function(){return this._x},set:function(c){this._x=c,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(c){this._y=c,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(c){this._z=c,this._onChangeCallback()}},{key:"order",get:function(){return this._order},set:function(c){this._order=c,this._onChangeCallback()}}]),p}();Fp.DefaultOrder="XYZ",Fp.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];var Kw=new br,Zw=new Zi,O0=function(){function p(){this.mask=1|0}var l=p.prototype;return l.set=function(c){this.mask=1<<c|0},l.enable=function(c){this.mask|=1<<c|0},l.enableAll=function(){this.mask=4294967295|0},l.toggle=function(c){this.mask^=1<<c|0},l.disable=function(c){this.mask&=~(1<<c|0)},l.disableAll=function(){this.mask=0},l.test=function(c){return(this.mask&c.mask)!=0},p}(),vL=0,Qw=new Ge,cu=new Zi,bs=new br,Bp=new Ge,of=new Ge,gL=new Ge,yL=new Zi,Jw=new Ge(1,0,0),eA=new Ge(0,1,0),tA=new Ge(0,0,1),bL={type:"added"},nA={type:"removed"};function Dn(){Object.defineProperty(this,"id",{value:vL++}),this.uuid=er.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Dn.DefaultUp.clone();var p=new Ge,l=new Fp,d=new Zi,c=new Ge(1,1,1);function h(){d.setFromEuler(l,!1)}function x(){l.setFromQuaternion(d,void 0,!1)}l._onChange(h),d._onChange(x),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:p},rotation:{configurable:!0,enumerable:!0,value:l},quaternion:{configurable:!0,enumerable:!0,value:d},scale:{configurable:!0,enumerable:!0,value:c},modelViewMatrix:{value:new br},normalMatrix:{value:new Ua}}),this.matrix=new br,this.matrixWorld=new br,this.matrixAutoUpdate=Dn.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new O0,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}Dn.DefaultUp=new Ge(0,1,0),Dn.DefaultMatrixAutoUpdate=!0,Dn.prototype=Object.assign(Object.create(Ho.prototype),{constructor:Dn,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(l){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(l),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(l){return this.quaternion.premultiply(l),this},setRotationFromAxisAngle:function(l,d){this.quaternion.setFromAxisAngle(l,d)},setRotationFromEuler:function(l){this.quaternion.setFromEuler(l,!0)},setRotationFromMatrix:function(l){this.quaternion.setFromRotationMatrix(l)},setRotationFromQuaternion:function(l){this.quaternion.copy(l)},rotateOnAxis:function(l,d){return cu.setFromAxisAngle(l,d),this.quaternion.multiply(cu),this},rotateOnWorldAxis:function(l,d){return cu.setFromAxisAngle(l,d),this.quaternion.premultiply(cu),this},rotateX:function(l){return this.rotateOnAxis(Jw,l)},rotateY:function(l){return this.rotateOnAxis(eA,l)},rotateZ:function(l){return this.rotateOnAxis(tA,l)},translateOnAxis:function(l,d){return Qw.copy(l).applyQuaternion(this.quaternion),this.position.add(Qw.multiplyScalar(d)),this},translateX:function(l){return this.translateOnAxis(Jw,l)},translateY:function(l){return this.translateOnAxis(eA,l)},translateZ:function(l){return this.translateOnAxis(tA,l)},localToWorld:function(l){return l.applyMatrix4(this.matrixWorld)},worldToLocal:function(l){return l.applyMatrix4(bs.copy(this.matrixWorld).invert())},lookAt:function(l,d,c){l.isVector3?Bp.copy(l):Bp.set(l,d,c);var h=this.parent;this.updateWorldMatrix(!0,!1),of.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?bs.lookAt(of,Bp,this.up):bs.lookAt(Bp,of,this.up),this.quaternion.setFromRotationMatrix(bs),h&&(bs.extractRotation(h.matrixWorld),cu.setFromRotationMatrix(bs),this.quaternion.premultiply(cu.invert()))},add:function(l){if(arguments.length>1){for(var d=0;d<arguments.length;d++)this.add(arguments[d]);return this}return l===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",l),this):(l&&l.isObject3D?(l.parent!==null&&l.parent.remove(l),l.parent=this,this.children.push(l),l.dispatchEvent(bL)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",l),this)},remove:function(l){if(arguments.length>1){for(var d=0;d<arguments.length;d++)this.remove(arguments[d]);return this}var c=this.children.indexOf(l);return c!==-1&&(l.parent=null,this.children.splice(c,1),l.dispatchEvent(nA)),this},clear:function(){for(var l=0;l<this.children.length;l++){var d=this.children[l];d.parent=null,d.dispatchEvent(nA)}return this.children.length=0,this},attach:function(l){return this.updateWorldMatrix(!0,!1),bs.copy(this.matrixWorld).invert(),l.parent!==null&&(l.parent.updateWorldMatrix(!0,!1),bs.multiply(l.parent.matrixWorld)),l.applyMatrix4(bs),l.updateWorldMatrix(!1,!1),this.add(l),this},getObjectById:function(l){return this.getObjectByProperty("id",l)},getObjectByName:function(l){return this.getObjectByProperty("name",l)},getObjectByProperty:function(l,d){if(this[l]===d)return this;for(var c=0,h=this.children.length;c<h;c++){var x=this.children[c],_=x.getObjectByProperty(l,d);if(_!==void 0)return _}},getWorldPosition:function(l){return l===void 0&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),l=new Ge),this.updateWorldMatrix(!0,!1),l.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(l){return l===void 0&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),l=new Zi),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(of,l,gL),l},getWorldScale:function(l){return l===void 0&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),l=new Ge),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(of,yL,l),l},getWorldDirection:function(l){l===void 0&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),l=new Ge),this.updateWorldMatrix(!0,!1);var d=this.matrixWorld.elements;return l.set(d[8],d[9],d[10]).normalize()},raycast:function(){},traverse:function(l){l(this);for(var d=this.children,c=0,h=d.length;c<h;c++)d[c].traverse(l)},traverseVisible:function(l){if(this.visible!==!1){l(this);for(var d=this.children,c=0,h=d.length;c<h;c++)d[c].traverseVisible(l)}},traverseAncestors:function(l){var d=this.parent;d!==null&&(l(d),d.traverseAncestors(l))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(l){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||l)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,l=!0);for(var d=this.children,c=0,h=d.length;c<h;c++)d[c].updateMatrixWorld(l)},updateWorldMatrix:function(l,d){var c=this.parent;if(l===!0&&c!==null&&c.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),d===!0)for(var h=this.children,x=0,_=h.length;x<_;x++)h[x].updateWorldMatrix(!1,!0)},toJSON:function(l){var d=l===void 0||typeof l=="string",c={};d&&(l={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},c.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var h={};h.uuid=this.uuid,h.type=this.type,this.name!==""&&(h.name=this.name),this.castShadow===!0&&(h.castShadow=!0),this.receiveShadow===!0&&(h.receiveShadow=!0),this.visible===!1&&(h.visible=!1),this.frustumCulled===!1&&(h.frustumCulled=!1),this.renderOrder!==0&&(h.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(h.userData=this.userData),h.layers=this.layers.mask,h.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(h.matrixAutoUpdate=!1),this.isInstancedMesh&&(h.type="InstancedMesh",h.count=this.count,h.instanceMatrix=this.instanceMatrix.toJSON());function x(nt,ot){return nt[ot.uuid]===void 0&&(nt[ot.uuid]=ot.toJSON(l)),ot.uuid}if(this.isMesh||this.isLine||this.isPoints){h.geometry=x(l.geometries,this.geometry);var _=this.geometry.parameters;if(_!==void 0&&_.shapes!==void 0){var R=_.shapes;if(Array.isArray(R))for(var O=0,B=R.length;O<B;O++){var V=R[O];x(l.shapes,V)}else x(l.shapes,R)}}if(this.isSkinnedMesh&&(h.bindMode=this.bindMode,h.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(x(l.skeletons,this.skeleton),h.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){for(var G=[],z=0,ne=this.material.length;z<ne;z++)G.push(x(l.materials,this.material[z]));h.material=G}else h.material=x(l.materials,this.material);if(this.children.length>0){h.children=[];for(var Q=0;Q<this.children.length;Q++)h.children.push(this.children[Q].toJSON(l).object)}if(this.animations.length>0){h.animations=[];for(var le=0;le<this.animations.length;le++){var me=this.animations[le];h.animations.push(x(l.animations,me))}}if(d){var ue=rt(l.geometries),re=rt(l.materials),Oe=rt(l.textures),He=rt(l.images),Re=rt(l.shapes),we=rt(l.skeletons),Ue=rt(l.animations);ue.length>0&&(c.geometries=ue),re.length>0&&(c.materials=re),Oe.length>0&&(c.textures=Oe),He.length>0&&(c.images=He),Re.length>0&&(c.shapes=Re),we.length>0&&(c.skeletons=we),Ue.length>0&&(c.animations=Ue)}return c.object=h,c;function rt(nt){var ot=[];for(var ut in nt){var st=nt[ut];delete st.metadata,ot.push(st)}return ot}},clone:function(l){return new this.constructor().copy(this,l)},copy:function(l,d){if(d===void 0&&(d=!0),this.name=l.name,this.up.copy(l.up),this.position.copy(l.position),this.rotation.order=l.rotation.order,this.quaternion.copy(l.quaternion),this.scale.copy(l.scale),this.matrix.copy(l.matrix),this.matrixWorld.copy(l.matrixWorld),this.matrixAutoUpdate=l.matrixAutoUpdate,this.matrixWorldNeedsUpdate=l.matrixWorldNeedsUpdate,this.layers.mask=l.layers.mask,this.visible=l.visible,this.castShadow=l.castShadow,this.receiveShadow=l.receiveShadow,this.frustumCulled=l.frustumCulled,this.renderOrder=l.renderOrder,this.userData=JSON.parse(JSON.stringify(l.userData)),d===!0)for(var c=0;c<l.children.length;c++){var h=l.children[c];this.add(h.clone())}return this}});var I0=new Ge,xL=new Ge,wL=new Ua,zo=function(){function p(d,c){Object.defineProperty(this,"isPlane",{value:!0}),this.normal=d!==void 0?d:new Ge(1,0,0),this.constant=c!==void 0?c:0}var l=p.prototype;return l.set=function(c,h){return this.normal.copy(c),this.constant=h,this},l.setComponents=function(c,h,x,_){return this.normal.set(c,h,x),this.constant=_,this},l.setFromNormalAndCoplanarPoint=function(c,h){return this.normal.copy(c),this.constant=-h.dot(this.normal),this},l.setFromCoplanarPoints=function(c,h,x){var _=I0.subVectors(x,h).cross(xL.subVectors(c,h)).normalize();return this.setFromNormalAndCoplanarPoint(_,c),this},l.clone=function(){return new this.constructor().copy(this)},l.copy=function(c){return this.normal.copy(c.normal),this.constant=c.constant,this},l.normalize=function(){var c=1/this.normal.length();return this.normal.multiplyScalar(c),this.constant*=c,this},l.negate=function(){return this.constant*=-1,this.normal.negate(),this},l.distanceToPoint=function(c){return this.normal.dot(c)+this.constant},l.distanceToSphere=function(c){return this.distanceToPoint(c.center)-c.radius},l.projectPoint=function(c,h){return h===void 0&&(console.warn("THREE.Plane: .projectPoint() target is now required"),h=new Ge),h.copy(this.normal).multiplyScalar(-this.distanceToPoint(c)).add(c)},l.intersectLine=function(c,h){h===void 0&&(console.warn("THREE.Plane: .intersectLine() target is now required"),h=new Ge);var x=c.delta(I0),_=this.normal.dot(x);if(_===0)return this.distanceToPoint(c.start)===0?h.copy(c.start):void 0;var R=-(c.start.dot(this.normal)+this.constant)/_;if(!(R<0||R>1))return h.copy(x).multiplyScalar(R).add(c.start)},l.intersectsLine=function(c){var h=this.distanceToPoint(c.start),x=this.distanceToPoint(c.end);return h<0&&x>0||x<0&&h>0},l.intersectsBox=function(c){return c.intersectsPlane(this)},l.intersectsSphere=function(c){return c.intersectsPlane(this)},l.coplanarPoint=function(c){return c===void 0&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),c=new Ge),c.copy(this.normal).multiplyScalar(-this.constant)},l.applyMatrix4=function(c,h){var x=h||wL.getNormalMatrix(c),_=this.coplanarPoint(I0).applyMatrix4(c),R=this.normal.applyMatrix3(x).normalize();return this.constant=-_.dot(R),this},l.translate=function(c){return this.constant-=c.dot(this.normal),this},l.equals=function(c){return c.normal.equals(this.normal)&&c.constant===this.constant},p}(),bo=new Ge,xs=new Ge,k0=new Ge,ws=new Ge,uu=new Ge,hu=new Ge,rA=new Ge,F0=new Ge,B0=new Ge,N0=new Ge,Go=function(){function p(d,c,h){this.a=d!==void 0?d:new Ge,this.b=c!==void 0?c:new Ge,this.c=h!==void 0?h:new Ge}p.getNormal=function(c,h,x,_){_===void 0&&(console.warn("THREE.Triangle: .getNormal() target is now required"),_=new Ge),_.subVectors(x,h),bo.subVectors(c,h),_.cross(bo);var R=_.lengthSq();return R>0?_.multiplyScalar(1/Math.sqrt(R)):_.set(0,0,0)},p.getBarycoord=function(c,h,x,_,R){bo.subVectors(_,h),xs.subVectors(x,h),k0.subVectors(c,h);var O=bo.dot(bo),B=bo.dot(xs),V=bo.dot(k0),G=xs.dot(xs),z=xs.dot(k0),ne=O*G-B*B;if(R===void 0&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),R=new Ge),ne===0)return R.set(-2,-1,-1);var Q=1/ne,le=(G*V-B*z)*Q,me=(O*z-B*V)*Q;return R.set(1-le-me,me,le)},p.containsPoint=function(c,h,x,_){return this.getBarycoord(c,h,x,_,ws),ws.x>=0&&ws.y>=0&&ws.x+ws.y<=1},p.getUV=function(c,h,x,_,R,O,B,V){return this.getBarycoord(c,h,x,_,ws),V.set(0,0),V.addScaledVector(R,ws.x),V.addScaledVector(O,ws.y),V.addScaledVector(B,ws.z),V},p.isFrontFacing=function(c,h,x,_){return bo.subVectors(x,h),xs.subVectors(c,h),bo.cross(xs).dot(_)<0};var l=p.prototype;return l.set=function(c,h,x){return this.a.copy(c),this.b.copy(h),this.c.copy(x),this},l.setFromPointsAndIndices=function(c,h,x,_){return this.a.copy(c[h]),this.b.copy(c[x]),this.c.copy(c[_]),this},l.clone=function(){return new this.constructor().copy(this)},l.copy=function(c){return this.a.copy(c.a),this.b.copy(c.b),this.c.copy(c.c),this},l.getArea=function(){return bo.subVectors(this.c,this.b),xs.subVectors(this.a,this.b),bo.cross(xs).length()*.5},l.getMidpoint=function(c){return c===void 0&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),c=new Ge),c.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},l.getNormal=function(c){return p.getNormal(this.a,this.b,this.c,c)},l.getPlane=function(c){return c===void 0&&(console.warn("THREE.Triangle: .getPlane() target is now required"),c=new zo),c.setFromCoplanarPoints(this.a,this.b,this.c)},l.getBarycoord=function(c,h){return p.getBarycoord(c,this.a,this.b,this.c,h)},l.getUV=function(c,h,x,_,R){return p.getUV(c,this.a,this.b,this.c,h,x,_,R)},l.containsPoint=function(c){return p.containsPoint(c,this.a,this.b,this.c)},l.isFrontFacing=function(c){return p.isFrontFacing(this.a,this.b,this.c,c)},l.intersectsBox=function(c){return c.intersectsTriangle(this)},l.closestPointToPoint=function(c,h){h===void 0&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),h=new Ge);var x=this.a,_=this.b,R=this.c,O,B;uu.subVectors(_,x),hu.subVectors(R,x),F0.subVectors(c,x);var V=uu.dot(F0),G=hu.dot(F0);if(V<=0&&G<=0)return h.copy(x);B0.subVectors(c,_);var z=uu.dot(B0),ne=hu.dot(B0);if(z>=0&&ne<=z)return h.copy(_);var Q=V*ne-z*G;if(Q<=0&&V>=0&&z<=0)return O=V/(V-z),h.copy(x).addScaledVector(uu,O);N0.subVectors(c,R);var le=uu.dot(N0),me=hu.dot(N0);if(me>=0&&le<=me)return h.copy(R);var ue=le*G-V*me;if(ue<=0&&G>=0&&me<=0)return B=G/(G-me),h.copy(x).addScaledVector(hu,B);var re=z*me-le*ne;if(re<=0&&ne-z>=0&&le-me>=0)return rA.subVectors(R,_),B=(ne-z)/(ne-z+(le-me)),h.copy(_).addScaledVector(rA,B);var Oe=1/(re+ue+Q);return O=ue*Oe,B=Q*Oe,h.copy(x).addScaledVector(uu,O).addScaledVector(hu,B)},l.equals=function(c){return c.a.equals(this.a)&&c.b.equals(this.b)&&c.c.equals(this.c)},p}(),iA={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},xo={h:0,s:0,l:0},Np={h:0,s:0,l:0};function U0(p,l,d){return d<0&&(d+=1),d>1&&(d-=1),d<1/6?p+(l-p)*6*d:d<1/2?l:d<2/3?p+(l-p)*6*(2/3-d):p}function H0(p){return p<.04045?p*.0773993808:Math.pow(p*.9478672986+.0521327014,2.4)}function z0(p){return p<.0031308?p*12.92:1.055*Math.pow(p,.41666)-.055}var vn=function(){function p(d,c,h){return Object.defineProperty(this,"isColor",{value:!0}),c===void 0&&h===void 0?this.set(d):this.setRGB(d,c,h)}var l=p.prototype;return l.set=function(c){return c&&c.isColor?this.copy(c):typeof c=="number"?this.setHex(c):typeof c=="string"&&this.setStyle(c),this},l.setScalar=function(c){return this.r=c,this.g=c,this.b=c,this},l.setHex=function(c){return c=Math.floor(c),this.r=(c>>16&255)/255,this.g=(c>>8&255)/255,this.b=(c&255)/255,this},l.setRGB=function(c,h,x){return this.r=c,this.g=h,this.b=x,this},l.setHSL=function(c,h,x){if(c=er.euclideanModulo(c,1),h=er.clamp(h,0,1),x=er.clamp(x,0,1),h===0)this.r=this.g=this.b=x;else{var _=x<=.5?x*(1+h):x+h-x*h,R=2*x-_;this.r=U0(R,_,c+1/3),this.g=U0(R,_,c),this.b=U0(R,_,c-1/3)}return this},l.setStyle=function(c){function h(Q){Q!==void 0&&parseFloat(Q)<1&&console.warn("THREE.Color: Alpha component of "+c+" will be ignored.")}var x;if(x=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(c)){var _,R=x[1],O=x[2];switch(R){case"rgb":case"rgba":if(_=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(O))return this.r=Math.min(255,parseInt(_[1],10))/255,this.g=Math.min(255,parseInt(_[2],10))/255,this.b=Math.min(255,parseInt(_[3],10))/255,h(_[4]),this;if(_=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(O))return this.r=Math.min(100,parseInt(_[1],10))/100,this.g=Math.min(100,parseInt(_[2],10))/100,this.b=Math.min(100,parseInt(_[3],10))/100,h(_[4]),this;break;case"hsl":case"hsla":if(_=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(O)){var B=parseFloat(_[1])/360,V=parseInt(_[2],10)/100,G=parseInt(_[3],10)/100;return h(_[4]),this.setHSL(B,V,G)}break}}else if(x=/^\#([A-Fa-f\d]+)$/.exec(c)){var z=x[1],ne=z.length;if(ne===3)return this.r=parseInt(z.charAt(0)+z.charAt(0),16)/255,this.g=parseInt(z.charAt(1)+z.charAt(1),16)/255,this.b=parseInt(z.charAt(2)+z.charAt(2),16)/255,this;if(ne===6)return this.r=parseInt(z.charAt(0)+z.charAt(1),16)/255,this.g=parseInt(z.charAt(2)+z.charAt(3),16)/255,this.b=parseInt(z.charAt(4)+z.charAt(5),16)/255,this}return c&&c.length>0?this.setColorName(c):this},l.setColorName=function(c){var h=iA[c];return h!==void 0?this.setHex(h):console.warn("THREE.Color: Unknown color "+c),this},l.clone=function(){return new this.constructor(this.r,this.g,this.b)},l.copy=function(c){return this.r=c.r,this.g=c.g,this.b=c.b,this},l.copyGammaToLinear=function(c,h){return h===void 0&&(h=2),this.r=Math.pow(c.r,h),this.g=Math.pow(c.g,h),this.b=Math.pow(c.b,h),this},l.copyLinearToGamma=function(c,h){h===void 0&&(h=2);var x=h>0?1/h:1;return this.r=Math.pow(c.r,x),this.g=Math.pow(c.g,x),this.b=Math.pow(c.b,x),this},l.convertGammaToLinear=function(c){return this.copyGammaToLinear(this,c),this},l.convertLinearToGamma=function(c){return this.copyLinearToGamma(this,c),this},l.copySRGBToLinear=function(c){return this.r=H0(c.r),this.g=H0(c.g),this.b=H0(c.b),this},l.copyLinearToSRGB=function(c){return this.r=z0(c.r),this.g=z0(c.g),this.b=z0(c.b),this},l.convertSRGBToLinear=function(){return this.copySRGBToLinear(this),this},l.convertLinearToSRGB=function(){return this.copyLinearToSRGB(this),this},l.getHex=function(){return this.r*255<<16^this.g*255<<8^this.b*255<<0},l.getHexString=function(){return("000000"+this.getHex().toString(16)).slice(-6)},l.getHSL=function(c){c===void 0&&(console.warn("THREE.Color: .getHSL() target is now required"),c={h:0,s:0,l:0});var h=this.r,x=this.g,_=this.b,R=Math.max(h,x,_),O=Math.min(h,x,_),B,V,G=(O+R)/2;if(O===R)B=0,V=0;else{var z=R-O;switch(V=G<=.5?z/(R+O):z/(2-R-O),R){case h:B=(x-_)/z+(x<_?6:0);break;case x:B=(_-h)/z+2;break;case _:B=(h-x)/z+4;break}B/=6}return c.h=B,c.s=V,c.l=G,c},l.getStyle=function(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"},l.offsetHSL=function(c,h,x){return this.getHSL(xo),xo.h+=c,xo.s+=h,xo.l+=x,this.setHSL(xo.h,xo.s,xo.l),this},l.add=function(c){return this.r+=c.r,this.g+=c.g,this.b+=c.b,this},l.addColors=function(c,h){return this.r=c.r+h.r,this.g=c.g+h.g,this.b=c.b+h.b,this},l.addScalar=function(c){return this.r+=c,this.g+=c,this.b+=c,this},l.sub=function(c){return this.r=Math.max(0,this.r-c.r),this.g=Math.max(0,this.g-c.g),this.b=Math.max(0,this.b-c.b),this},l.multiply=function(c){return this.r*=c.r,this.g*=c.g,this.b*=c.b,this},l.multiplyScalar=function(c){return this.r*=c,this.g*=c,this.b*=c,this},l.lerp=function(c,h){return this.r+=(c.r-this.r)*h,this.g+=(c.g-this.g)*h,this.b+=(c.b-this.b)*h,this},l.lerpColors=function(c,h,x){return this.r=c.r+(h.r-c.r)*x,this.g=c.g+(h.g-c.g)*x,this.b=c.b+(h.b-c.b)*x,this},l.lerpHSL=function(c,h){this.getHSL(xo),c.getHSL(Np);var x=er.lerp(xo.h,Np.h,h),_=er.lerp(xo.s,Np.s,h),R=er.lerp(xo.l,Np.l,h);return this.setHSL(x,_,R),this},l.equals=function(c){return c.r===this.r&&c.g===this.g&&c.b===this.b},l.fromArray=function(c,h){return h===void 0&&(h=0),this.r=c[h],this.g=c[h+1],this.b=c[h+2],this},l.toArray=function(c,h){return c===void 0&&(c=[]),h===void 0&&(h=0),c[h]=this.r,c[h+1]=this.g,c[h+2]=this.b,c},l.fromBufferAttribute=function(c,h){return this.r=c.getX(h),this.g=c.getY(h),this.b=c.getZ(h),c.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this},l.toJSON=function(){return this.getHex()},p}();vn.NAMES=iA,vn.prototype.r=1,vn.prototype.g=1,vn.prototype.b=1;var G0=function(){function p(d,c,h,x,_,R){R===void 0&&(R=0),this.a=d,this.b=c,this.c=h,this.normal=x&&x.isVector3?x:new Ge,this.vertexNormals=Array.isArray(x)?x:[],this.color=_&&_.isColor?_:new vn,this.vertexColors=Array.isArray(_)?_:[],this.materialIndex=R}var l=p.prototype;return l.clone=function(){return new this.constructor().copy(this)},l.copy=function(c){this.a=c.a,this.b=c.b,this.c=c.c,this.normal.copy(c.normal),this.color.copy(c.color),this.materialIndex=c.materialIndex;for(var h=0,x=c.vertexNormals.length;h<x;h++)this.vertexNormals[h]=c.vertexNormals[h].clone();for(var _=0,R=c.vertexColors.length;_<R;_++)this.vertexColors[_]=c.vertexColors[_].clone();return this},p}(),AL=0;function Kn(){Object.defineProperty(this,"id",{value:AL++}),this.uuid=er.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=X,this.side=T,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Ne,this.blendDst=Ie,this.blendEquation=D,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=fe,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=jw,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Cp,this.stencilZFail=Cp,this.stencilZPass=Cp,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}Kn.prototype=Object.assign(Object.create(Ho.prototype),{constructor:Kn,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(l){if(l!==void 0)for(var d in l){var c=l[d];if(c===void 0){console.warn("THREE.Material: '"+d+"' parameter is undefined.");continue}if(d==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=c===P;continue}var h=this[d];if(h===void 0){console.warn("THREE."+this.type+": '"+d+"' is not a property of this material.");continue}h&&h.isColor?h.set(c):h&&h.isVector3&&c&&c.isVector3?h.copy(c):this[d]=c}},toJSON:function(l){var d=l===void 0||typeof l=="string";d&&(l={textures:{},images:{}});var c={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};c.uuid=this.uuid,c.type=this.type,this.name!==""&&(c.name=this.name),this.color&&this.color.isColor&&(c.color=this.color.getHex()),this.roughness!==void 0&&(c.roughness=this.roughness),this.metalness!==void 0&&(c.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(c.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(c.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(c.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(c.specular=this.specular.getHex()),this.shininess!==void 0&&(c.shininess=this.shininess),this.clearcoat!==void 0&&(c.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(c.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(c.clearcoatMap=this.clearcoatMap.toJSON(l).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(c.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(l).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(c.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(l).uuid,c.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(c.map=this.map.toJSON(l).uuid),this.matcap&&this.matcap.isTexture&&(c.matcap=this.matcap.toJSON(l).uuid),this.alphaMap&&this.alphaMap.isTexture&&(c.alphaMap=this.alphaMap.toJSON(l).uuid),this.lightMap&&this.lightMap.isTexture&&(c.lightMap=this.lightMap.toJSON(l).uuid),this.aoMap&&this.aoMap.isTexture&&(c.aoMap=this.aoMap.toJSON(l).uuid,c.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(c.bumpMap=this.bumpMap.toJSON(l).uuid,c.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(c.normalMap=this.normalMap.toJSON(l).uuid,c.normalMapType=this.normalMapType,c.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(c.displacementMap=this.displacementMap.toJSON(l).uuid,c.displacementScale=this.displacementScale,c.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(c.roughnessMap=this.roughnessMap.toJSON(l).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(c.metalnessMap=this.metalnessMap.toJSON(l).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(c.emissiveMap=this.emissiveMap.toJSON(l).uuid),this.specularMap&&this.specularMap.isTexture&&(c.specularMap=this.specularMap.toJSON(l).uuid),this.envMap&&this.envMap.isTexture&&(c.envMap=this.envMap.toJSON(l).uuid,c.reflectivity=this.reflectivity,c.refractionRatio=this.refractionRatio,this.combine!==void 0&&(c.combine=this.combine),this.envMapIntensity!==void 0&&(c.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(c.gradientMap=this.gradientMap.toJSON(l).uuid),this.size!==void 0&&(c.size=this.size),this.sizeAttenuation!==void 0&&(c.sizeAttenuation=this.sizeAttenuation),this.blending!==X&&(c.blending=this.blending),this.flatShading===!0&&(c.flatShading=this.flatShading),this.side!==T&&(c.side=this.side),this.vertexColors&&(c.vertexColors=!0),this.opacity<1&&(c.opacity=this.opacity),this.transparent===!0&&(c.transparent=this.transparent),c.depthFunc=this.depthFunc,c.depthTest=this.depthTest,c.depthWrite=this.depthWrite,c.stencilWrite=this.stencilWrite,c.stencilWriteMask=this.stencilWriteMask,c.stencilFunc=this.stencilFunc,c.stencilRef=this.stencilRef,c.stencilFuncMask=this.stencilFuncMask,c.stencilFail=this.stencilFail,c.stencilZFail=this.stencilZFail,c.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(c.rotation=this.rotation),this.polygonOffset===!0&&(c.polygonOffset=!0),this.polygonOffsetFactor!==0&&(c.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(c.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(c.linewidth=this.linewidth),this.dashSize!==void 0&&(c.dashSize=this.dashSize),this.gapSize!==void 0&&(c.gapSize=this.gapSize),this.scale!==void 0&&(c.scale=this.scale),this.dithering===!0&&(c.dithering=!0),this.alphaTest>0&&(c.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(c.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(c.wireframe=this.wireframe),this.wireframeLinewidth>1&&(c.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(c.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(c.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(c.morphTargets=!0),this.morphNormals===!0&&(c.morphNormals=!0),this.skinning===!0&&(c.skinning=!0),this.visible===!1&&(c.visible=!1),this.toneMapped===!1&&(c.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(c.userData=this.userData);function h(R){var O=[];for(var B in R){var V=R[B];delete V.metadata,O.push(V)}return O}if(d){var x=h(l.textures),_=h(l.images);x.length>0&&(c.textures=x),_.length>0&&(c.images=_)}return c},clone:function(){return new this.constructor().copy(this)},copy:function(l){this.name=l.name,this.fog=l.fog,this.blending=l.blending,this.side=l.side,this.flatShading=l.flatShading,this.vertexColors=l.vertexColors,this.opacity=l.opacity,this.transparent=l.transparent,this.blendSrc=l.blendSrc,this.blendDst=l.blendDst,this.blendEquation=l.blendEquation,this.blendSrcAlpha=l.blendSrcAlpha,this.blendDstAlpha=l.blendDstAlpha,this.blendEquationAlpha=l.blendEquationAlpha,this.depthFunc=l.depthFunc,this.depthTest=l.depthTest,this.depthWrite=l.depthWrite,this.stencilWriteMask=l.stencilWriteMask,this.stencilFunc=l.stencilFunc,this.stencilRef=l.stencilRef,this.stencilFuncMask=l.stencilFuncMask,this.stencilFail=l.stencilFail,this.stencilZFail=l.stencilZFail,this.stencilZPass=l.stencilZPass,this.stencilWrite=l.stencilWrite;var d=l.clippingPlanes,c=null;if(d!==null){var h=d.length;c=new Array(h);for(var x=0;x!==h;++x)c[x]=d[x].clone()}return this.clippingPlanes=c,this.clipIntersection=l.clipIntersection,this.clipShadows=l.clipShadows,this.shadowSide=l.shadowSide,this.colorWrite=l.colorWrite,this.precision=l.precision,this.polygonOffset=l.polygonOffset,this.polygonOffsetFactor=l.polygonOffsetFactor,this.polygonOffsetUnits=l.polygonOffsetUnits,this.dithering=l.dithering,this.alphaTest=l.alphaTest,this.premultipliedAlpha=l.premultipliedAlpha,this.visible=l.visible,this.toneMapped=l.toneMapped,this.userData=JSON.parse(JSON.stringify(l.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Kn.prototype,"needsUpdate",{set:function(l){l===!0&&this.version++}});function za(p){Kn.call(this),this.type="MeshBasicMaterial",this.color=new vn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ee,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(p)}za.prototype=Object.create(Kn.prototype),za.prototype.constructor=za,za.prototype.isMeshBasicMaterial=!0,za.prototype.copy=function(p){return Kn.prototype.copy.call(this,p),this.color.copy(p.color),this.map=p.map,this.lightMap=p.lightMap,this.lightMapIntensity=p.lightMapIntensity,this.aoMap=p.aoMap,this.aoMapIntensity=p.aoMapIntensity,this.specularMap=p.specularMap,this.alphaMap=p.alphaMap,this.envMap=p.envMap,this.combine=p.combine,this.reflectivity=p.reflectivity,this.refractionRatio=p.refractionRatio,this.wireframe=p.wireframe,this.wireframeLinewidth=p.wireframeLinewidth,this.wireframeLinecap=p.wireframeLinecap,this.wireframeLinejoin=p.wireframeLinejoin,this.skinning=p.skinning,this.morphTargets=p.morphTargets,this};var hi=new Ge,Up=new Zt;function Zn(p,l,d){if(Array.isArray(p))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=p,this.itemSize=l,this.count=p!==void 0?p.length/l:0,this.normalized=d===!0,this.usage=tf,this.updateRange={offset:0,count:-1},this.version=0}Object.defineProperty(Zn.prototype,"needsUpdate",{set:function(l){l===!0&&this.version++}}),Object.assign(Zn.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(l){return this.usage=l,this},copy:function(l){return this.name=l.name,this.array=new l.array.constructor(l.array),this.itemSize=l.itemSize,this.count=l.count,this.normalized=l.normalized,this.usage=l.usage,this},copyAt:function(l,d,c){l*=this.itemSize,c*=d.itemSize;for(var h=0,x=this.itemSize;h<x;h++)this.array[l+h]=d.array[c+h];return this},copyArray:function(l){return this.array.set(l),this},copyColorsArray:function(l){for(var d=this.array,c=0,h=0,x=l.length;h<x;h++){var _=l[h];_===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",h),_=new vn),d[c++]=_.r,d[c++]=_.g,d[c++]=_.b}return this},copyVector2sArray:function(l){for(var d=this.array,c=0,h=0,x=l.length;h<x;h++){var _=l[h];_===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",h),_=new Zt),d[c++]=_.x,d[c++]=_.y}return this},copyVector3sArray:function(l){for(var d=this.array,c=0,h=0,x=l.length;h<x;h++){var _=l[h];_===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",h),_=new Ge),d[c++]=_.x,d[c++]=_.y,d[c++]=_.z}return this},copyVector4sArray:function(l){for(var d=this.array,c=0,h=0,x=l.length;h<x;h++){var _=l[h];_===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",h),_=new Yr),d[c++]=_.x,d[c++]=_.y,d[c++]=_.z,d[c++]=_.w}return this},applyMatrix3:function(l){if(this.itemSize===2)for(var d=0,c=this.count;d<c;d++)Up.fromBufferAttribute(this,d),Up.applyMatrix3(l),this.setXY(d,Up.x,Up.y);else if(this.itemSize===3)for(var h=0,x=this.count;h<x;h++)hi.fromBufferAttribute(this,h),hi.applyMatrix3(l),this.setXYZ(h,hi.x,hi.y,hi.z);return this},applyMatrix4:function(l){for(var d=0,c=this.count;d<c;d++)hi.x=this.getX(d),hi.y=this.getY(d),hi.z=this.getZ(d),hi.applyMatrix4(l),this.setXYZ(d,hi.x,hi.y,hi.z);return this},applyNormalMatrix:function(l){for(var d=0,c=this.count;d<c;d++)hi.x=this.getX(d),hi.y=this.getY(d),hi.z=this.getZ(d),hi.applyNormalMatrix(l),this.setXYZ(d,hi.x,hi.y,hi.z);return this},transformDirection:function(l){for(var d=0,c=this.count;d<c;d++)hi.x=this.getX(d),hi.y=this.getY(d),hi.z=this.getZ(d),hi.transformDirection(l),this.setXYZ(d,hi.x,hi.y,hi.z);return this},set:function(l,d){return d===void 0&&(d=0),this.array.set(l,d),this},getX:function(l){return this.array[l*this.itemSize]},setX:function(l,d){return this.array[l*this.itemSize]=d,this},getY:function(l){return this.array[l*this.itemSize+1]},setY:function(l,d){return this.array[l*this.itemSize+1]=d,this},getZ:function(l){return this.array[l*this.itemSize+2]},setZ:function(l,d){return this.array[l*this.itemSize+2]=d,this},getW:function(l){return this.array[l*this.itemSize+3]},setW:function(l,d){return this.array[l*this.itemSize+3]=d,this},setXY:function(l,d,c){return l*=this.itemSize,this.array[l+0]=d,this.array[l+1]=c,this},setXYZ:function(l,d,c,h){return l*=this.itemSize,this.array[l+0]=d,this.array[l+1]=c,this.array[l+2]=h,this},setXYZW:function(l,d,c,h,x){return l*=this.itemSize,this.array[l+0]=d,this.array[l+1]=c,this.array[l+2]=h,this.array[l+3]=x,this},onUpload:function(l){return this.onUploadCallback=l,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}});function sf(p,l,d){Zn.call(this,new Int8Array(p),l,d)}sf.prototype=Object.create(Zn.prototype),sf.prototype.constructor=sf;function lf(p,l,d){Zn.call(this,new Uint8Array(p),l,d)}lf.prototype=Object.create(Zn.prototype),lf.prototype.constructor=lf;function cf(p,l,d){Zn.call(this,new Uint8ClampedArray(p),l,d)}cf.prototype=Object.create(Zn.prototype),cf.prototype.constructor=cf;function uf(p,l,d){Zn.call(this,new Int16Array(p),l,d)}uf.prototype=Object.create(Zn.prototype),uf.prototype.constructor=uf;function cc(p,l,d){Zn.call(this,new Uint16Array(p),l,d)}cc.prototype=Object.create(Zn.prototype),cc.prototype.constructor=cc;function hf(p,l,d){Zn.call(this,new Int32Array(p),l,d)}hf.prototype=Object.create(Zn.prototype),hf.prototype.constructor=hf;function uc(p,l,d){Zn.call(this,new Uint32Array(p),l,d)}uc.prototype=Object.create(Zn.prototype),uc.prototype.constructor=uc;function ff(p,l,d){Zn.call(this,new Uint16Array(p),l,d)}ff.prototype=Object.create(Zn.prototype),ff.prototype.constructor=ff,ff.prototype.isFloat16BufferAttribute=!0;function xn(p,l,d){Zn.call(this,new Float32Array(p),l,d)}xn.prototype=Object.create(Zn.prototype),xn.prototype.constructor=xn;function df(p,l,d){Zn.call(this,new Float64Array(p),l,d)}df.prototype=Object.create(Zn.prototype),df.prototype.constructor=df;function aA(p){if(p.length===0)return-1/0;for(var l=p[0],d=1,c=p.length;d<c;++d)p[d]>l&&(l=p[d]);return l}var EL={Int8Array,Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray!="undefined"?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function pf(p,l){return new EL[p](l)}var _L=0,Vo=new br,V0=new Dn,fu=new Ge,Ga=new vs,mf=new vs,Vi=new Ge;function Vn(){Object.defineProperty(this,"id",{value:_L++}),this.uuid=er.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}Vn.prototype=Object.assign(Object.create(Ho.prototype),{constructor:Vn,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(l){return Array.isArray(l)?this.index=new(aA(l)>65535?uc:cc)(l,1):this.index=l,this},getAttribute:function(l){return this.attributes[l]},setAttribute:function(l,d){return this.attributes[l]=d,this},deleteAttribute:function(l){return delete this.attributes[l],this},hasAttribute:function(l){return this.attributes[l]!==void 0},addGroup:function(l,d,c){c===void 0&&(c=0),this.groups.push({start:l,count:d,materialIndex:c})},clearGroups:function(){this.groups=[]},setDrawRange:function(l,d){this.drawRange.start=l,this.drawRange.count=d},applyMatrix4:function(l){var d=this.attributes.position;d!==void 0&&(d.applyMatrix4(l),d.needsUpdate=!0);var c=this.attributes.normal;if(c!==void 0){var h=new Ua().getNormalMatrix(l);c.applyNormalMatrix(h),c.needsUpdate=!0}var x=this.attributes.tangent;return x!==void 0&&(x.transformDirection(l),x.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this},rotateX:function(l){return Vo.makeRotationX(l),this.applyMatrix4(Vo),this},rotateY:function(l){return Vo.makeRotationY(l),this.applyMatrix4(Vo),this},rotateZ:function(l){return Vo.makeRotationZ(l),this.applyMatrix4(Vo),this},translate:function(l,d,c){return Vo.makeTranslation(l,d,c),this.applyMatrix4(Vo),this},scale:function(l,d,c){return Vo.makeScale(l,d,c),this.applyMatrix4(Vo),this},lookAt:function(l){return V0.lookAt(l),V0.updateMatrix(),this.applyMatrix4(V0.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(fu).negate(),this.translate(fu.x,fu.y,fu.z),this},setFromPoints:function(l){for(var d=[],c=0,h=l.length;c<h;c++){var x=l[c];d.push(x.x,x.y,x.z||0)}return this.setAttribute("position",new xn(d,3)),this},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new vs);var l=this.attributes.position,d=this.morphAttributes.position;if(l&&l.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Ge(-1/0,-1/0,-1/0),new Ge(1/0,1/0,1/0));return}if(l!==void 0){if(this.boundingBox.setFromBufferAttribute(l),d)for(var c=0,h=d.length;c<h;c++){var x=d[c];Ga.setFromBufferAttribute(x),this.morphTargetsRelative?(Vi.addVectors(this.boundingBox.min,Ga.min),this.boundingBox.expandByPoint(Vi),Vi.addVectors(this.boundingBox.max,Ga.max),this.boundingBox.expandByPoint(Vi)):(this.boundingBox.expandByPoint(Ga.min),this.boundingBox.expandByPoint(Ga.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new nl);var l=this.attributes.position,d=this.morphAttributes.position;if(l&&l.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Ge,1/0);return}if(l){var c=this.boundingSphere.center;if(Ga.setFromBufferAttribute(l),d)for(var h=0,x=d.length;h<x;h++){var _=d[h];mf.setFromBufferAttribute(_),this.morphTargetsRelative?(Vi.addVectors(Ga.min,mf.min),Ga.expandByPoint(Vi),Vi.addVectors(Ga.max,mf.max),Ga.expandByPoint(Vi)):(Ga.expandByPoint(mf.min),Ga.expandByPoint(mf.max))}Ga.getCenter(c);for(var R=0,O=0,B=l.count;O<B;O++)Vi.fromBufferAttribute(l,O),R=Math.max(R,c.distanceToSquared(Vi));if(d)for(var V=0,G=d.length;V<G;V++)for(var z=d[V],ne=this.morphTargetsRelative,Q=0,le=z.count;Q<le;Q++)Vi.fromBufferAttribute(z,Q),ne&&(fu.fromBufferAttribute(l,Q),Vi.add(fu)),R=Math.max(R,c.distanceToSquared(Vi));this.boundingSphere.radius=Math.sqrt(R),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeTangents:function(){var l=this.index,d=this.attributes;if(l===null||d.position===void 0||d.normal===void 0||d.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}var c=l.array,h=d.position.array,x=d.normal.array,_=d.uv.array,R=h.length/3;d.tangent===void 0&&this.setAttribute("tangent",new Zn(new Float32Array(4*R),4));for(var O=d.tangent.array,B=[],V=[],G=0;G<R;G++)B[G]=new Ge,V[G]=new Ge;var z=new Ge,ne=new Ge,Q=new Ge,le=new Zt,me=new Zt,ue=new Zt,re=new Ge,Oe=new Ge;function He(Lt,Wn,gn){z.fromArray(h,Lt*3),ne.fromArray(h,Wn*3),Q.fromArray(h,gn*3),le.fromArray(_,Lt*2),me.fromArray(_,Wn*2),ue.fromArray(_,gn*2),ne.sub(z),Q.sub(z),me.sub(le),ue.sub(le);var qn=1/(me.x*ue.y-ue.x*me.y);!isFinite(qn)||(re.copy(ne).multiplyScalar(ue.y).addScaledVector(Q,-me.y).multiplyScalar(qn),Oe.copy(Q).multiplyScalar(me.x).addScaledVector(ne,-ue.x).multiplyScalar(qn),B[Lt].add(re),B[Wn].add(re),B[gn].add(re),V[Lt].add(Oe),V[Wn].add(Oe),V[gn].add(Oe))}var Re=this.groups;Re.length===0&&(Re=[{start:0,count:c.length}]);for(var we=0,Ue=Re.length;we<Ue;++we)for(var rt=Re[we],nt=rt.start,ot=rt.count,ut=nt,st=nt+ot;ut<st;ut+=3)He(c[ut+0],c[ut+1],c[ut+2]);var et=new Ge,dt=new Ge,at=new Ge,it=new Ge;function Ke(Lt){at.fromArray(x,Lt*3),it.copy(at);var Wn=B[Lt];et.copy(Wn),et.sub(at.multiplyScalar(at.dot(Wn))).normalize(),dt.crossVectors(it,Wn);var gn=dt.dot(V[Lt]),qn=gn<0?-1:1;O[Lt*4]=et.x,O[Lt*4+1]=et.y,O[Lt*4+2]=et.z,O[Lt*4+3]=qn}for(var vt=0,gt=Re.length;vt<gt;++vt)for(var St=Re[vt],Tt=St.start,qt=St.count,en=Tt,_n=Tt+qt;en<_n;en+=3)Ke(c[en+0]),Ke(c[en+1]),Ke(c[en+2])},computeVertexNormals:function(){var l=this.index,d=this.getAttribute("position");if(d!==void 0){var c=this.getAttribute("normal");if(c===void 0)c=new Zn(new Float32Array(d.count*3),3),this.setAttribute("normal",c);else for(var h=0,x=c.count;h<x;h++)c.setXYZ(h,0,0,0);var _=new Ge,R=new Ge,O=new Ge,B=new Ge,V=new Ge,G=new Ge,z=new Ge,ne=new Ge;if(l)for(var Q=0,le=l.count;Q<le;Q+=3){var me=l.getX(Q+0),ue=l.getX(Q+1),re=l.getX(Q+2);_.fromBufferAttribute(d,me),R.fromBufferAttribute(d,ue),O.fromBufferAttribute(d,re),z.subVectors(O,R),ne.subVectors(_,R),z.cross(ne),B.fromBufferAttribute(c,me),V.fromBufferAttribute(c,ue),G.fromBufferAttribute(c,re),B.add(z),V.add(z),G.add(z),c.setXYZ(me,B.x,B.y,B.z),c.setXYZ(ue,V.x,V.y,V.z),c.setXYZ(re,G.x,G.y,G.z)}else for(var Oe=0,He=d.count;Oe<He;Oe+=3)_.fromBufferAttribute(d,Oe+0),R.fromBufferAttribute(d,Oe+1),O.fromBufferAttribute(d,Oe+2),z.subVectors(O,R),ne.subVectors(_,R),z.cross(ne),c.setXYZ(Oe+0,z.x,z.y,z.z),c.setXYZ(Oe+1,z.x,z.y,z.z),c.setXYZ(Oe+2,z.x,z.y,z.z);this.normalizeNormals(),c.needsUpdate=!0}},merge:function(l,d){if(!(l&&l.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",l);return}d===void 0&&(d=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var c=this.attributes;for(var h in c)if(l.attributes[h]!==void 0)for(var x=c[h],_=x.array,R=l.attributes[h],O=R.array,B=R.itemSize*d,V=Math.min(O.length,_.length-B),G=0,z=B;G<V;G++,z++)_[z]=O[G];return this},normalizeNormals:function(){for(var l=this.attributes.normal,d=0,c=l.count;d<c;d++)Vi.fromBufferAttribute(l,d),Vi.normalize(),l.setXYZ(d,Vi.x,Vi.y,Vi.z)},toNonIndexed:function(){function l(He,Re){for(var we=He.array,Ue=He.itemSize,rt=He.normalized,nt=new we.constructor(Re.length*Ue),ot=0,ut=0,st=0,et=Re.length;st<et;st++){ot=Re[st]*Ue;for(var dt=0;dt<Ue;dt++)nt[ut++]=we[ot++]}return new Zn(nt,Ue,rt)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;var d=new Vn,c=this.index.array,h=this.attributes;for(var x in h){var _=h[x],R=l(_,c);d.setAttribute(x,R)}var O=this.morphAttributes;for(var B in O){for(var V=[],G=O[B],z=0,ne=G.length;z<ne;z++){var Q=G[z],le=l(Q,c);V.push(le)}d.morphAttributes[B]=V}d.morphTargetsRelative=this.morphTargetsRelative;for(var me=this.groups,ue=0,re=me.length;ue<re;ue++){var Oe=me[ue];d.addGroup(Oe.start,Oe.count,Oe.materialIndex)}return d},toJSON:function(){var l={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(l.uuid=this.uuid,l.type=this.type,this.name!==""&&(l.name=this.name),Object.keys(this.userData).length>0&&(l.userData=this.userData),this.parameters!==void 0){var d=this.parameters;for(var c in d)d[c]!==void 0&&(l[c]=d[c]);return l}l.data={attributes:{}};var h=this.index;h!==null&&(l.data.index={type:h.array.constructor.name,array:Array.prototype.slice.call(h.array)});var x=this.attributes;for(var _ in x){var R=x[_],O=R.toJSON(l.data);R.name!==""&&(O.name=R.name),l.data.attributes[_]=O}var B={},V=!1;for(var G in this.morphAttributes){for(var z=this.morphAttributes[G],ne=[],Q=0,le=z.length;Q<le;Q++){var me=z[Q],ue=me.toJSON(l.data);me.name!==""&&(ue.name=me.name),ne.push(ue)}ne.length>0&&(B[G]=ne,V=!0)}V&&(l.data.morphAttributes=B,l.data.morphTargetsRelative=this.morphTargetsRelative);var re=this.groups;re.length>0&&(l.data.groups=JSON.parse(JSON.stringify(re)));var Oe=this.boundingSphere;return Oe!==null&&(l.data.boundingSphere={center:Oe.center.toArray(),radius:Oe.radius}),l},clone:function(){return new Vn().copy(this)},copy:function(l){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;var d={};this.name=l.name;var c=l.index;c!==null&&this.setIndex(c.clone(d));var h=l.attributes;for(var x in h){var _=h[x];this.setAttribute(x,_.clone(d))}var R=l.morphAttributes;for(var O in R){for(var B=[],V=R[O],G=0,z=V.length;G<z;G++)B.push(V[G].clone(d));this.morphAttributes[O]=B}this.morphTargetsRelative=l.morphTargetsRelative;for(var ne=l.groups,Q=0,le=ne.length;Q<le;Q++){var me=ne[Q];this.addGroup(me.start,me.count,me.materialIndex)}var ue=l.boundingBox;ue!==null&&(this.boundingBox=ue.clone());var re=l.boundingSphere;return re!==null&&(this.boundingSphere=re.clone()),this.drawRange.start=l.drawRange.start,this.drawRange.count=l.drawRange.count,this.userData=l.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var oA=new br,du=new su,W0=new nl,al=new Ge,ol=new Ge,sl=new Ge,j0=new Ge,X0=new Ge,q0=new Ge,Hp=new Ge,zp=new Ge,Gp=new Ge,Vp=new Zt,Wp=new Zt,jp=new Zt,Y0=new Ge,Xp=new Ge;function fi(p,l){p===void 0&&(p=new Vn),l===void 0&&(l=new za),Dn.call(this),this.type="Mesh",this.geometry=p,this.material=l,this.updateMorphTargets()}fi.prototype=Object.assign(Object.create(Dn.prototype),{constructor:fi,isMesh:!0,copy:function(l){return Dn.prototype.copy.call(this,l),l.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=l.morphTargetInfluences.slice()),l.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},l.morphTargetDictionary)),this.material=l.material,this.geometry=l.geometry,this},updateMorphTargets:function(){var l=this.geometry;if(l.isBufferGeometry){var d=l.morphAttributes,c=Object.keys(d);if(c.length>0){var h=d[c[0]];if(h!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var x=0,_=h.length;x<_;x++){var R=h[x].name||String(x);this.morphTargetInfluences.push(0),this.morphTargetDictionary[R]=x}}}}else{var O=l.morphTargets;O!==void 0&&O.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(l,d){var c=this.geometry,h=this.material,x=this.matrixWorld;if(h!==void 0&&(c.boundingSphere===null&&c.computeBoundingSphere(),W0.copy(c.boundingSphere),W0.applyMatrix4(x),l.ray.intersectsSphere(W0)!==!1&&(oA.copy(x).invert(),du.copy(l.ray).applyMatrix4(oA),!(c.boundingBox!==null&&du.intersectsBox(c.boundingBox)===!1)))){var _;if(c.isBufferGeometry){var R=c.index,O=c.attributes.position,B=c.morphAttributes.position,V=c.morphTargetsRelative,G=c.attributes.uv,z=c.attributes.uv2,ne=c.groups,Q=c.drawRange;if(R!==null)if(Array.isArray(h))for(var le=0,me=ne.length;le<me;le++)for(var ue=ne[le],re=h[ue.materialIndex],Oe=Math.max(ue.start,Q.start),He=Math.min(ue.start+ue.count,Q.start+Q.count),Re=Oe,we=He;Re<we;Re+=3){var Ue=R.getX(Re),rt=R.getX(Re+1),nt=R.getX(Re+2);_=qp(this,re,l,du,O,B,V,G,z,Ue,rt,nt),_&&(_.faceIndex=Math.floor(Re/3),_.face.materialIndex=ue.materialIndex,d.push(_))}else for(var ot=Math.max(0,Q.start),ut=Math.min(R.count,Q.start+Q.count),st=ot,et=ut;st<et;st+=3){var dt=R.getX(st),at=R.getX(st+1),it=R.getX(st+2);_=qp(this,h,l,du,O,B,V,G,z,dt,at,it),_&&(_.faceIndex=Math.floor(st/3),d.push(_))}else if(O!==void 0)if(Array.isArray(h))for(var Ke=0,vt=ne.length;Ke<vt;Ke++)for(var gt=ne[Ke],St=h[gt.materialIndex],Tt=Math.max(gt.start,Q.start),qt=Math.min(gt.start+gt.count,Q.start+Q.count),en=Tt,_n=qt;en<_n;en+=3){var Lt=en,Wn=en+1,gn=en+2;_=qp(this,St,l,du,O,B,V,G,z,Lt,Wn,gn),_&&(_.faceIndex=Math.floor(en/3),_.face.materialIndex=gt.materialIndex,d.push(_))}else for(var qn=Math.max(0,Q.start),ar=Math.min(O.count,Q.start+Q.count),gr=qn,sr=ar;gr<sr;gr+=3){var ai=gr,Or=gr+1,$r=gr+2;_=qp(this,h,l,du,O,B,V,G,z,ai,Or,$r),_&&(_.faceIndex=Math.floor(gr/3),d.push(_))}}else c.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}});function ML(p,l,d,c,h,x,_,R){var O;if(l.side===C?O=c.intersectTriangle(_,x,h,!0,R):O=c.intersectTriangle(h,x,_,l.side!==L,R),O===null)return null;Xp.copy(R),Xp.applyMatrix4(p.matrixWorld);var B=d.ray.origin.distanceTo(Xp);return B<d.near||B>d.far?null:{distance:B,point:Xp.clone(),object:p}}function qp(p,l,d,c,h,x,_,R,O,B,V,G){al.fromBufferAttribute(h,B),ol.fromBufferAttribute(h,V),sl.fromBufferAttribute(h,G);var z=p.morphTargetInfluences;if(l.morphTargets&&x&&z){Hp.set(0,0,0),zp.set(0,0,0),Gp.set(0,0,0);for(var ne=0,Q=x.length;ne<Q;ne++){var le=z[ne],me=x[ne];le!==0&&(j0.fromBufferAttribute(me,B),X0.fromBufferAttribute(me,V),q0.fromBufferAttribute(me,G),_?(Hp.addScaledVector(j0,le),zp.addScaledVector(X0,le),Gp.addScaledVector(q0,le)):(Hp.addScaledVector(j0.sub(al),le),zp.addScaledVector(X0.sub(ol),le),Gp.addScaledVector(q0.sub(sl),le)))}al.add(Hp),ol.add(zp),sl.add(Gp)}p.isSkinnedMesh&&(p.boneTransform(B,al),p.boneTransform(V,ol),p.boneTransform(G,sl));var ue=ML(p,l,d,c,al,ol,sl,Y0);if(ue){R&&(Vp.fromBufferAttribute(R,B),Wp.fromBufferAttribute(R,V),jp.fromBufferAttribute(R,G),ue.uv=Go.getUV(Y0,al,ol,sl,Vp,Wp,jp,new Zt)),O&&(Vp.fromBufferAttribute(O,B),Wp.fromBufferAttribute(O,V),jp.fromBufferAttribute(O,G),ue.uv2=Go.getUV(Y0,al,ol,sl,Vp,Wp,jp,new Zt));var re=new G0(B,V,G);Go.getNormal(al,ol,sl,re.normal),ue.face=re}return ue}var hc=function(p){pr(l,p);function l(d,c,h,x,_,R){var O;d===void 0&&(d=1),c===void 0&&(c=1),h===void 0&&(h=1),x===void 0&&(x=1),_===void 0&&(_=1),R===void 0&&(R=1),O=p.call(this)||this,O.type="BoxGeometry",O.parameters={width:d,height:c,depth:h,widthSegments:x,heightSegments:_,depthSegments:R};var B=go(O);x=Math.floor(x),_=Math.floor(_),R=Math.floor(R);var V=[],G=[],z=[],ne=[],Q=0,le=0;me("z","y","x",-1,-1,h,c,d,R,_,0),me("z","y","x",1,-1,h,c,-d,R,_,1),me("x","z","y",1,1,d,h,c,x,R,2),me("x","z","y",1,-1,d,h,-c,x,R,3),me("x","y","z",1,-1,d,c,h,x,_,4),me("x","y","z",-1,-1,d,c,-h,x,_,5),O.setIndex(V),O.setAttribute("position",new xn(G,3)),O.setAttribute("normal",new xn(z,3)),O.setAttribute("uv",new xn(ne,2));function me(ue,re,Oe,He,Re,we,Ue,rt,nt,ot,ut){for(var st=we/nt,et=Ue/ot,dt=we/2,at=Ue/2,it=rt/2,Ke=nt+1,vt=ot+1,gt=0,St=0,Tt=new Ge,qt=0;qt<vt;qt++)for(var en=qt*et-at,_n=0;_n<Ke;_n++){var Lt=_n*st-dt;Tt[ue]=Lt*He,Tt[re]=en*Re,Tt[Oe]=it,G.push(Tt.x,Tt.y,Tt.z),Tt[ue]=0,Tt[re]=0,Tt[Oe]=rt>0?1:-1,z.push(Tt.x,Tt.y,Tt.z),ne.push(_n/nt),ne.push(1-qt/ot),gt+=1}for(var Wn=0;Wn<ot;Wn++)for(var gn=0;gn<nt;gn++){var qn=Q+gn+Ke*Wn,ar=Q+gn+Ke*(Wn+1),gr=Q+(gn+1)+Ke*(Wn+1),sr=Q+(gn+1)+Ke*Wn;V.push(qn,ar,sr),V.push(ar,gr,sr),St+=6}B.addGroup(le,St,ut),le+=St,Q+=gt}return O}return l}(Vn);function pu(p){var l={};for(var d in p){l[d]={};for(var c in p[d]){var h=p[d][c];h&&(h.isColor||h.isMatrix3||h.isMatrix4||h.isVector2||h.isVector3||h.isVector4||h.isTexture)?l[d][c]=h.clone():Array.isArray(h)?l[d][c]=h.slice():l[d][c]=h}}return l}function ia(p){for(var l={},d=0;d<p.length;d++){var c=pu(p[d]);for(var h in c)l[h]=c[h]}return l}var sA={clone:pu,merge:ia},SL=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,TL=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;function wa(p){Kn.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=SL,this.fragmentShader=TL,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,p!==void 0&&(p.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(p))}wa.prototype=Object.create(Kn.prototype),wa.prototype.constructor=wa,wa.prototype.isShaderMaterial=!0,wa.prototype.copy=function(p){return Kn.prototype.copy.call(this,p),this.fragmentShader=p.fragmentShader,this.vertexShader=p.vertexShader,this.uniforms=pu(p.uniforms),this.defines=Object.assign({},p.defines),this.wireframe=p.wireframe,this.wireframeLinewidth=p.wireframeLinewidth,this.lights=p.lights,this.clipping=p.clipping,this.skinning=p.skinning,this.morphTargets=p.morphTargets,this.morphNormals=p.morphNormals,this.extensions=Object.assign({},p.extensions),this.glslVersion=p.glslVersion,this},wa.prototype.toJSON=function(p){var l=Kn.prototype.toJSON.call(this,p);l.glslVersion=this.glslVersion,l.uniforms={};for(var d in this.uniforms){var c=this.uniforms[d],h=c.value;h&&h.isTexture?l.uniforms[d]={type:"t",value:h.toJSON(p).uuid}:h&&h.isColor?l.uniforms[d]={type:"c",value:h.getHex()}:h&&h.isVector2?l.uniforms[d]={type:"v2",value:h.toArray()}:h&&h.isVector3?l.uniforms[d]={type:"v3",value:h.toArray()}:h&&h.isVector4?l.uniforms[d]={type:"v4",value:h.toArray()}:h&&h.isMatrix3?l.uniforms[d]={type:"m3",value:h.toArray()}:h&&h.isMatrix4?l.uniforms[d]={type:"m4",value:h.toArray()}:l.uniforms[d]={value:h}}Object.keys(this.defines).length>0&&(l.defines=this.defines),l.vertexShader=this.vertexShader,l.fragmentShader=this.fragmentShader;var x={};for(var _ in this.extensions)this.extensions[_]===!0&&(x[_]=!0);return Object.keys(x).length>0&&(l.extensions=x),l};function Wo(){Dn.call(this),this.type="Camera",this.matrixWorldInverse=new br,this.projectionMatrix=new br,this.projectionMatrixInverse=new br}Wo.prototype=Object.assign(Object.create(Dn.prototype),{constructor:Wo,isCamera:!0,copy:function(l,d){return Dn.prototype.copy.call(this,l,d),this.matrixWorldInverse.copy(l.matrixWorldInverse),this.projectionMatrix.copy(l.projectionMatrix),this.projectionMatrixInverse.copy(l.projectionMatrixInverse),this},getWorldDirection:function(l){l===void 0&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),l=new Ge),this.updateWorldMatrix(!0,!1);var d=this.matrixWorld.elements;return l.set(-d[8],-d[9],-d[10]).normalize()},updateMatrixWorld:function(l){Dn.prototype.updateMatrixWorld.call(this,l),this.matrixWorldInverse.copy(this.matrixWorld).invert()},updateWorldMatrix:function(l,d){Dn.prototype.updateWorldMatrix.call(this,l,d),this.matrixWorldInverse.copy(this.matrixWorld).invert()},clone:function(){return new this.constructor().copy(this)}});function Mi(p,l,d,c){p===void 0&&(p=50),l===void 0&&(l=1),d===void 0&&(d=.1),c===void 0&&(c=2e3),Wo.call(this),this.type="PerspectiveCamera",this.fov=p,this.zoom=1,this.near=d,this.far=c,this.focus=10,this.aspect=l,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}Mi.prototype=Object.assign(Object.create(Wo.prototype),{constructor:Mi,isPerspectiveCamera:!0,copy:function(l,d){return Wo.prototype.copy.call(this,l,d),this.fov=l.fov,this.zoom=l.zoom,this.near=l.near,this.far=l.far,this.focus=l.focus,this.aspect=l.aspect,this.view=l.view===null?null:Object.assign({},l.view),this.filmGauge=l.filmGauge,this.filmOffset=l.filmOffset,this},setFocalLength:function(l){var d=.5*this.getFilmHeight()/l;this.fov=er.RAD2DEG*2*Math.atan(d),this.updateProjectionMatrix()},getFocalLength:function(){var l=Math.tan(er.DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/l},getEffectiveFOV:function(){return er.RAD2DEG*2*Math.atan(Math.tan(er.DEG2RAD*.5*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(l,d,c,h,x,_){this.aspect=l/d,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=l,this.view.fullHeight=d,this.view.offsetX=c,this.view.offsetY=h,this.view.width=x,this.view.height=_,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var l=this.near,d=l*Math.tan(er.DEG2RAD*.5*this.fov)/this.zoom,c=2*d,h=this.aspect*c,x=-.5*h,_=this.view;if(this.view!==null&&this.view.enabled){var R=_.fullWidth,O=_.fullHeight;x+=_.offsetX*h/R,d-=_.offsetY*c/O,h*=_.width/R,c*=_.height/O}var B=this.filmOffset;B!==0&&(x+=l*B/this.getFilmWidth()),this.projectionMatrix.makePerspective(x,x+h,d,d-c,l,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(l){var d=Dn.prototype.toJSON.call(this,l);return d.object.fov=this.fov,d.object.zoom=this.zoom,d.object.near=this.near,d.object.far=this.far,d.object.focus=this.focus,d.object.aspect=this.aspect,this.view!==null&&(d.object.view=Object.assign({},this.view)),d.object.filmGauge=this.filmGauge,d.object.filmOffset=this.filmOffset,d}});var mu=90,vu=1;function fc(p,l,d){if(Dn.call(this),this.type="CubeCamera",d.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=d;var c=new Mi(mu,vu,p,l);c.layers=this.layers,c.up.set(0,-1,0),c.lookAt(new Ge(1,0,0)),this.add(c);var h=new Mi(mu,vu,p,l);h.layers=this.layers,h.up.set(0,-1,0),h.lookAt(new Ge(-1,0,0)),this.add(h);var x=new Mi(mu,vu,p,l);x.layers=this.layers,x.up.set(0,0,1),x.lookAt(new Ge(0,1,0)),this.add(x);var _=new Mi(mu,vu,p,l);_.layers=this.layers,_.up.set(0,0,-1),_.lookAt(new Ge(0,-1,0)),this.add(_);var R=new Mi(mu,vu,p,l);R.layers=this.layers,R.up.set(0,-1,0),R.lookAt(new Ge(0,0,1)),this.add(R);var O=new Mi(mu,vu,p,l);O.layers=this.layers,O.up.set(0,-1,0),O.lookAt(new Ge(0,0,-1)),this.add(O),this.update=function(B,V){this.parent===null&&this.updateMatrixWorld();var G=B.xr.enabled,z=B.getRenderTarget();B.xr.enabled=!1;var ne=d.texture.generateMipmaps;d.texture.generateMipmaps=!1,B.setRenderTarget(d,0),B.render(V,c),B.setRenderTarget(d,1),B.render(V,h),B.setRenderTarget(d,2),B.render(V,x),B.setRenderTarget(d,3),B.render(V,_),B.setRenderTarget(d,4),B.render(V,R),d.texture.generateMipmaps=ne,B.setRenderTarget(d,5),B.render(V,O),B.setRenderTarget(z),B.xr.enabled=G}}fc.prototype=Object.create(Dn.prototype),fc.prototype.constructor=fc;function jo(p,l,d,c,h,x,_,R,O,B){p=p!==void 0?p:[],l=l!==void 0?l:xe,_=_!==void 0?_:Sn,ii.call(this,p,l,d,c,h,x,_,R,O,B),this.flipY=!1,this._needsFlipEnvMap=!0}jo.prototype=Object.create(ii.prototype),jo.prototype.constructor=jo,jo.prototype.isCubeTexture=!0,Object.defineProperty(jo.prototype,"images",{get:function(){return this.image},set:function(l){this.image=l}});var $0=function(p){pr(l,p);function l(c,h,x){var _;return Number.isInteger(h)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),h=x),_=p.call(this,c,c,h)||this,Object.defineProperty(go(_),"isWebGLCubeRenderTarget",{value:!0}),h=h||{},_.texture=new jo(void 0,h.mapping,h.wrapS,h.wrapT,h.magFilter,h.minFilter,h.format,h.type,h.anisotropy,h.encoding),_.texture._needsFlipEnvMap=!1,_}var d=l.prototype;return d.fromEquirectangularTexture=function(h,x){this.texture.type=x.type,this.texture.format=pn,this.texture.encoding=x.encoding,this.texture.generateMipmaps=x.generateMipmaps,this.texture.minFilter=x.minFilter,this.texture.magFilter=x.magFilter;var _={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},R=new hc(5,5,5),O=new wa({name:"CubemapFromEquirect",uniforms:pu(_.uniforms),vertexShader:_.vertexShader,fragmentShader:_.fragmentShader,side:C,blending:F});O.uniforms.tEquirect.value=x;var B=new fi(R,O),V=x.minFilter;x.minFilter===In&&(x.minFilter=Ft);var G=new fc(1,10,this);return G.update(h,B),x.minFilter=V,B.geometry.dispose(),B.material.dispose(),this},d.clear=function(h,x,_,R){for(var O=h.getRenderTarget(),B=0;B<6;B++)h.setRenderTarget(this,B),h.clear(x,_,R);h.setRenderTarget(O)},l}(Js);function As(p,l,d,c,h,x,_,R,O,B,V,G){ii.call(this,null,x,_,R,O,B,c,h,V,G),this.image={data:p||null,width:l||1,height:d||1},this.magFilter=O!==void 0?O:Jt,this.minFilter=B!==void 0?B:Jt,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}As.prototype=Object.create(ii.prototype),As.prototype.constructor=As,As.prototype.isDataTexture=!0;var gu=new nl,Yp=new Ge,vf=function(){function p(d,c,h,x,_,R){this.planes=[d!==void 0?d:new zo,c!==void 0?c:new zo,h!==void 0?h:new zo,x!==void 0?x:new zo,_!==void 0?_:new zo,R!==void 0?R:new zo]}var l=p.prototype;return l.set=function(c,h,x,_,R,O){var B=this.planes;return B[0].copy(c),B[1].copy(h),B[2].copy(x),B[3].copy(_),B[4].copy(R),B[5].copy(O),this},l.clone=function(){return new this.constructor().copy(this)},l.copy=function(c){for(var h=this.planes,x=0;x<6;x++)h[x].copy(c.planes[x]);return this},l.setFromProjectionMatrix=function(c){var h=this.planes,x=c.elements,_=x[0],R=x[1],O=x[2],B=x[3],V=x[4],G=x[5],z=x[6],ne=x[7],Q=x[8],le=x[9],me=x[10],ue=x[11],re=x[12],Oe=x[13],He=x[14],Re=x[15];return h[0].setComponents(B-_,ne-V,ue-Q,Re-re).normalize(),h[1].setComponents(B+_,ne+V,ue+Q,Re+re).normalize(),h[2].setComponents(B+R,ne+G,ue+le,Re+Oe).normalize(),h[3].setComponents(B-R,ne-G,ue-le,Re-Oe).normalize(),h[4].setComponents(B-O,ne-z,ue-me,Re-He).normalize(),h[5].setComponents(B+O,ne+z,ue+me,Re+He).normalize(),this},l.intersectsObject=function(c){var h=c.geometry;return h.boundingSphere===null&&h.computeBoundingSphere(),gu.copy(h.boundingSphere).applyMatrix4(c.matrixWorld),this.intersectsSphere(gu)},l.intersectsSprite=function(c){return gu.center.set(0,0,0),gu.radius=.7071067811865476,gu.applyMatrix4(c.matrixWorld),this.intersectsSphere(gu)},l.intersectsSphere=function(c){for(var h=this.planes,x=c.center,_=-c.radius,R=0;R<6;R++){var O=h[R].distanceToPoint(x);if(O<_)return!1}return!0},l.intersectsBox=function(c){for(var h=this.planes,x=0;x<6;x++){var _=h[x];if(Yp.x=_.normal.x>0?c.max.x:c.min.x,Yp.y=_.normal.y>0?c.max.y:c.min.y,Yp.z=_.normal.z>0?c.max.z:c.min.z,_.distanceToPoint(Yp)<0)return!1}return!0},l.containsPoint=function(c){for(var h=this.planes,x=0;x<6;x++)if(h[x].distanceToPoint(c)<0)return!1;return!0},p}();function K0(){var p=null,l=!1,d=null,c=null;function h(x,_){d(x,_),c=p.requestAnimationFrame(h)}return{start:function(){l!==!0&&d!==null&&(c=p.requestAnimationFrame(h),l=!0)},stop:function(){p.cancelAnimationFrame(c),l=!1},setAnimationLoop:function(_){d=_},setContext:function(_){p=_}}}function CL(p,l){var d=l.isWebGL2,c=new WeakMap;function h(B,V){var G=B.array,z=B.usage,ne=p.createBuffer();p.bindBuffer(V,ne),p.bufferData(V,G,z),B.onUploadCallback();var Q=5126;return G instanceof Float32Array?Q=5126:G instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):G instanceof Uint16Array?B.isFloat16BufferAttribute?d?Q=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):Q=5123:G instanceof Int16Array?Q=5122:G instanceof Uint32Array?Q=5125:G instanceof Int32Array?Q=5124:G instanceof Int8Array?Q=5120:G instanceof Uint8Array&&(Q=5121),{buffer:ne,type:Q,bytesPerElement:G.BYTES_PER_ELEMENT,version:B.version}}function x(B,V,G){var z=V.array,ne=V.updateRange;p.bindBuffer(G,B),ne.count===-1?p.bufferSubData(G,0,z):(d?p.bufferSubData(G,ne.offset*z.BYTES_PER_ELEMENT,z,ne.offset,ne.count):p.bufferSubData(G,ne.offset*z.BYTES_PER_ELEMENT,z.subarray(ne.offset,ne.offset+ne.count)),ne.count=-1)}function _(B){return B.isInterleavedBufferAttribute&&(B=B.data),c.get(B)}function R(B){B.isInterleavedBufferAttribute&&(B=B.data);var V=c.get(B);V&&(p.deleteBuffer(V.buffer),c.delete(B))}function O(B,V){if(B.isGLBufferAttribute){var G=c.get(B);(!G||G.version<B.version)&&c.set(B,{buffer:B.buffer,type:B.type,bytesPerElement:B.elementSize,version:B.version});return}B.isInterleavedBufferAttribute&&(B=B.data);var z=c.get(B);z===void 0?c.set(B,h(B,V)):z.version<B.version&&(x(z.buffer,B,V),z.version=B.version)}return{get:_,remove:R,update:O}}var gf=function(p){pr(l,p);function l(d,c,h,x){var _;d===void 0&&(d=1),c===void 0&&(c=1),h===void 0&&(h=1),x===void 0&&(x=1),_=p.call(this)||this,_.type="PlaneGeometry",_.parameters={width:d,height:c,widthSegments:h,heightSegments:x};for(var R=d/2,O=c/2,B=Math.floor(h),V=Math.floor(x),G=B+1,z=V+1,ne=d/B,Q=c/V,le=[],me=[],ue=[],re=[],Oe=0;Oe<z;Oe++)for(var He=Oe*Q-O,Re=0;Re<G;Re++){var we=Re*ne-R;me.push(we,-He,0),ue.push(0,0,1),re.push(Re/B),re.push(1-Oe/V)}for(var Ue=0;Ue<V;Ue++)for(var rt=0;rt<B;rt++){var nt=rt+G*Ue,ot=rt+G*(Ue+1),ut=rt+1+G*(Ue+1),st=rt+1+G*Ue;le.push(nt,ot,st),le.push(ot,ut,st)}return _.setIndex(le),_.setAttribute("position",new xn(me,3)),_.setAttribute("normal",new xn(ue,3)),_.setAttribute("uv",new xn(re,2)),_}return l}(Vn),RL=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,LL=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,PL=`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`,DL=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`,OL=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,IL="vec3 transformed = vec3( position );",kL=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,FL=`vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {
	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,BL=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 );
		fDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,NL=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,UL=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,HL=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,zL=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,GL=`#ifdef USE_COLOR
	diffuseColor.rgb *= vColor;
#endif`,VL=`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,WL=`#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,jL=`#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor.xyz *= color.xyz;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,XL=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,qL=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );
		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );
		vec2 f = fract( uv );
		uv += 0.5 - f;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		if ( mipInt < cubeUV_maxMipLevel ) {
			uv.y += 2.0 * cubeUV_maxTileSize;
		}
		uv.y += filterInt * 2.0 * cubeUV_minTileSize;
		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );
		uv *= texelSize;
		vec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x += texelSize;
		vec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.y += texelSize;
		vec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x -= texelSize;
		vec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		vec3 tm = mix( tl, tr, f.x );
		vec3 bm = mix( bl, br, f.x );
		return mix( tm, bm, f.y );
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,YL=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,$L=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,KL=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,ZL=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,QL=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,JL="gl_FragColor = linearToOutputTexel( gl_FragColor );",eP=`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value ) {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,tP=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifndef ENVMAP_TYPE_CUBE_UV
		envColor = envMapTexelToLinear( envColor );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,nP=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,rP=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,iP=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,aP=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,oP=`#ifdef USE_FOG
	fogDepth = - mvPosition.z;
#endif`,sP=`#ifdef USE_FOG
	varying float fogDepth;
#endif`,lP=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,cP=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,uP=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,hP=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel= texture2D( lightMap, vUv2 );
	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
#endif`,fP=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,dP=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
	#pragma unroll_loop_end
#endif`,pP=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`,mP=`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( -viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
			vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`,vP=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,gP=`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,yP=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,bP=`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,xP=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`,wP=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float specularRoughness;
	vec3 specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(		0, 1,		0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,AP=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,EP=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`,_P=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,MP=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,SP=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,TP=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,CP=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,RP=`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,LP=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,PP=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,DP=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,OP=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,IP=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,kP=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,FP=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
		uniform float morphTargetInfluences[ 8 ];
	#else
		uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,BP=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
		transformed += morphTarget4 * morphTargetInfluences[ 4 ];
		transformed += morphTarget5 * morphTargetInfluences[ 5 ];
		transformed += morphTarget6 * morphTargetInfluences[ 6 ];
		transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,NP=`#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
			bitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,UP=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, mapN );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );
#endif`,HP=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		float scale = sign( st1.t * st0.s - st0.t * st1.s );
		vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );
		vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );
		vec3 N = normalize( surf_norm );
		mat3 tsn = mat3( S, T, N );
		mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		return normalize( tsn * mapN );
	}
#endif`,zP=`#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,GP=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );
	#endif
#endif`,VP=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,WP=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,jP=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,XP=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,qP=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,YP=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,$P=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,KP=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,ZP=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
							texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
							f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
							texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
							f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,QP=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,JP=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,eD=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,tD=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,nD=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,rD=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,iD=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,aD=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,oD=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,sD=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,lD=`#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(	1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,	1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,	1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,cD=`#ifdef USE_TRANSMISSIONMAP
	totalTransmission *= texture2D( transmissionMap, vUv ).r;
#endif`,uD=`#ifdef USE_TRANSMISSIONMAP
	uniform sampler2D transmissionMap;
#endif`,hD=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,fD=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,dD=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,pD=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,mD=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,vD=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,gD=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,yD=`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,bD=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,xD=`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,wD=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,AD=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,ED=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,_D=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,MD=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,SD=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,TD=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,CD=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,RD=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,LD=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
	
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,PD=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,DD=`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,OD=`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,ID=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,kD=`#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,FD=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,BD=`#define TOON
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,ND=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,UD=`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,HD=`#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
	#define TRANSMISSION
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef TRANSMISSION
	uniform float transmission;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <transmissionmap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#ifdef TRANSMISSION
		float totalTransmission = transmission;
	#endif
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <transmissionmap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#ifdef TRANSMISSION
		diffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );
	#endif
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,zD=`#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,GD=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,VD=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,WD=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,jD=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,XD=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,qD=`#include <common>
#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,YD=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,$D=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Cr={alphamap_fragment:RL,alphamap_pars_fragment:LL,alphatest_fragment:PL,aomap_fragment:DL,aomap_pars_fragment:OL,begin_vertex:IL,beginnormal_vertex:kL,bsdfs:FL,bumpmap_pars_fragment:BL,clipping_planes_fragment:NL,clipping_planes_pars_fragment:UL,clipping_planes_pars_vertex:HL,clipping_planes_vertex:zL,color_fragment:GL,color_pars_fragment:VL,color_pars_vertex:WL,color_vertex:jL,common:XL,cube_uv_reflection_fragment:qL,defaultnormal_vertex:YL,displacementmap_pars_vertex:$L,displacementmap_vertex:KL,emissivemap_fragment:ZL,emissivemap_pars_fragment:QL,encodings_fragment:JL,encodings_pars_fragment:eP,envmap_fragment:tP,envmap_common_pars_fragment:nP,envmap_pars_fragment:rP,envmap_pars_vertex:iP,envmap_physical_pars_fragment:mP,envmap_vertex:aP,fog_vertex:oP,fog_pars_vertex:sP,fog_fragment:lP,fog_pars_fragment:cP,gradientmap_pars_fragment:uP,lightmap_fragment:hP,lightmap_pars_fragment:fP,lights_lambert_vertex:dP,lights_pars_begin:pP,lights_toon_fragment:vP,lights_toon_pars_fragment:gP,lights_phong_fragment:yP,lights_phong_pars_fragment:bP,lights_physical_fragment:xP,lights_physical_pars_fragment:wP,lights_fragment_begin:AP,lights_fragment_maps:EP,lights_fragment_end:_P,logdepthbuf_fragment:MP,logdepthbuf_pars_fragment:SP,logdepthbuf_pars_vertex:TP,logdepthbuf_vertex:CP,map_fragment:RP,map_pars_fragment:LP,map_particle_fragment:PP,map_particle_pars_fragment:DP,metalnessmap_fragment:OP,metalnessmap_pars_fragment:IP,morphnormal_vertex:kP,morphtarget_pars_vertex:FP,morphtarget_vertex:BP,normal_fragment_begin:NP,normal_fragment_maps:UP,normalmap_pars_fragment:HP,clearcoat_normal_fragment_begin:zP,clearcoat_normal_fragment_maps:GP,clearcoat_pars_fragment:VP,packing:WP,premultiplied_alpha_fragment:jP,project_vertex:XP,dithering_fragment:qP,dithering_pars_fragment:YP,roughnessmap_fragment:$P,roughnessmap_pars_fragment:KP,shadowmap_pars_fragment:ZP,shadowmap_pars_vertex:QP,shadowmap_vertex:JP,shadowmask_pars_fragment:eD,skinbase_vertex:tD,skinning_pars_vertex:nD,skinning_vertex:rD,skinnormal_vertex:iD,specularmap_fragment:aD,specularmap_pars_fragment:oD,tonemapping_fragment:sD,tonemapping_pars_fragment:lD,transmissionmap_fragment:cD,transmissionmap_pars_fragment:uD,uv_pars_fragment:hD,uv_pars_vertex:fD,uv_vertex:dD,uv2_pars_fragment:pD,uv2_pars_vertex:mD,uv2_vertex:vD,worldpos_vertex:gD,background_frag:yD,background_vert:bD,cube_frag:xD,cube_vert:wD,depth_frag:AD,depth_vert:ED,distanceRGBA_frag:_D,distanceRGBA_vert:MD,equirect_frag:SD,equirect_vert:TD,linedashed_frag:CD,linedashed_vert:RD,meshbasic_frag:LD,meshbasic_vert:PD,meshlambert_frag:DD,meshlambert_vert:OD,meshmatcap_frag:ID,meshmatcap_vert:kD,meshtoon_frag:FD,meshtoon_vert:BD,meshphong_frag:ND,meshphong_vert:UD,meshphysical_frag:HD,meshphysical_vert:zD,normal_frag:GD,normal_vert:VD,points_frag:WD,points_vert:jD,shadow_frag:XD,shadow_vert:qD,sprite_frag:YD,sprite_vert:$D},ln={common:{diffuse:{value:new vn(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Ua},uv2Transform:{value:new Ua},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Zt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new vn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new vn(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Ua}},sprite:{diffuse:{value:new vn(15658734)},opacity:{value:1},center:{value:new Zt(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Ua}}},wo={basic:{uniforms:ia([ln.common,ln.specularmap,ln.envmap,ln.aomap,ln.lightmap,ln.fog]),vertexShader:Cr.meshbasic_vert,fragmentShader:Cr.meshbasic_frag},lambert:{uniforms:ia([ln.common,ln.specularmap,ln.envmap,ln.aomap,ln.lightmap,ln.emissivemap,ln.fog,ln.lights,{emissive:{value:new vn(0)}}]),vertexShader:Cr.meshlambert_vert,fragmentShader:Cr.meshlambert_frag},phong:{uniforms:ia([ln.common,ln.specularmap,ln.envmap,ln.aomap,ln.lightmap,ln.emissivemap,ln.bumpmap,ln.normalmap,ln.displacementmap,ln.fog,ln.lights,{emissive:{value:new vn(0)},specular:{value:new vn(1118481)},shininess:{value:30}}]),vertexShader:Cr.meshphong_vert,fragmentShader:Cr.meshphong_frag},standard:{uniforms:ia([ln.common,ln.envmap,ln.aomap,ln.lightmap,ln.emissivemap,ln.bumpmap,ln.normalmap,ln.displacementmap,ln.roughnessmap,ln.metalnessmap,ln.fog,ln.lights,{emissive:{value:new vn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Cr.meshphysical_vert,fragmentShader:Cr.meshphysical_frag},toon:{uniforms:ia([ln.common,ln.aomap,ln.lightmap,ln.emissivemap,ln.bumpmap,ln.normalmap,ln.displacementmap,ln.gradientmap,ln.fog,ln.lights,{emissive:{value:new vn(0)}}]),vertexShader:Cr.meshtoon_vert,fragmentShader:Cr.meshtoon_frag},matcap:{uniforms:ia([ln.common,ln.bumpmap,ln.normalmap,ln.displacementmap,ln.fog,{matcap:{value:null}}]),vertexShader:Cr.meshmatcap_vert,fragmentShader:Cr.meshmatcap_frag},points:{uniforms:ia([ln.points,ln.fog]),vertexShader:Cr.points_vert,fragmentShader:Cr.points_frag},dashed:{uniforms:ia([ln.common,ln.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Cr.linedashed_vert,fragmentShader:Cr.linedashed_frag},depth:{uniforms:ia([ln.common,ln.displacementmap]),vertexShader:Cr.depth_vert,fragmentShader:Cr.depth_frag},normal:{uniforms:ia([ln.common,ln.bumpmap,ln.normalmap,ln.displacementmap,{opacity:{value:1}}]),vertexShader:Cr.normal_vert,fragmentShader:Cr.normal_frag},sprite:{uniforms:ia([ln.sprite,ln.fog]),vertexShader:Cr.sprite_vert,fragmentShader:Cr.sprite_frag},background:{uniforms:{uvTransform:{value:new Ua},t2D:{value:null}},vertexShader:Cr.background_vert,fragmentShader:Cr.background_frag},cube:{uniforms:ia([ln.envmap,{opacity:{value:1}}]),vertexShader:Cr.cube_vert,fragmentShader:Cr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Cr.equirect_vert,fragmentShader:Cr.equirect_frag},distanceRGBA:{uniforms:ia([ln.common,ln.displacementmap,{referencePosition:{value:new Ge},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Cr.distanceRGBA_vert,fragmentShader:Cr.distanceRGBA_frag},shadow:{uniforms:ia([ln.lights,ln.fog,{color:{value:new vn(0)},opacity:{value:1}}]),vertexShader:Cr.shadow_vert,fragmentShader:Cr.shadow_frag}};wo.physical={uniforms:ia([wo.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Zt(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new vn(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:Cr.meshphysical_vert,fragmentShader:Cr.meshphysical_frag};function KD(p,l,d,c,h){var x=new vn(0),_=0,R,O,B=null,V=0,G=null;function z(Q,le,me,ue){var re=le.isScene===!0?le.background:null;re&&re.isTexture&&(re=l.get(re));var Oe=p.xr,He=Oe.getSession&&Oe.getSession();He&&He.environmentBlendMode==="additive"&&(re=null),re===null?ne(x,_):re&&re.isColor&&(ne(re,1),ue=!0),(p.autoClear||ue)&&p.clear(p.autoClearColor,p.autoClearDepth,p.autoClearStencil),re&&(re.isCubeTexture||re.isWebGLCubeRenderTarget||re.mapping===qe)?(O===void 0&&(O=new fi(new hc(1,1,1),new wa({name:"BackgroundCubeMaterial",uniforms:pu(wo.cube.uniforms),vertexShader:wo.cube.vertexShader,fragmentShader:wo.cube.fragmentShader,side:C,depthTest:!1,depthWrite:!1,fog:!1})),O.geometry.deleteAttribute("normal"),O.geometry.deleteAttribute("uv"),O.onBeforeRender=function(Re,we,Ue){this.matrixWorld.copyPosition(Ue.matrixWorld)},Object.defineProperty(O.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),c.update(O)),re.isWebGLCubeRenderTarget&&(re=re.texture),O.material.uniforms.envMap.value=re,O.material.uniforms.flipEnvMap.value=re.isCubeTexture&&re._needsFlipEnvMap?-1:1,(B!==re||V!==re.version||G!==p.toneMapping)&&(O.material.needsUpdate=!0,B=re,V=re.version,G=p.toneMapping),Q.unshift(O,O.geometry,O.material,0,0,null)):re&&re.isTexture&&(R===void 0&&(R=new fi(new gf(2,2),new wa({name:"BackgroundMaterial",uniforms:pu(wo.background.uniforms),vertexShader:wo.background.vertexShader,fragmentShader:wo.background.fragmentShader,side:T,depthTest:!1,depthWrite:!1,fog:!1})),R.geometry.deleteAttribute("normal"),Object.defineProperty(R.material,"map",{get:function(){return this.uniforms.t2D.value}}),c.update(R)),R.material.uniforms.t2D.value=re,re.matrixAutoUpdate===!0&&re.updateMatrix(),R.material.uniforms.uvTransform.value.copy(re.matrix),(B!==re||V!==re.version||G!==p.toneMapping)&&(R.material.needsUpdate=!0,B=re,V=re.version,G=p.toneMapping),Q.unshift(R,R.geometry,R.material,0,0,null))}function ne(Q,le){d.buffers.color.setClear(Q.r,Q.g,Q.b,le,h)}return{getClearColor:function(){return x},setClearColor:function(le,me){me===void 0&&(me=1),x.set(le),_=me,ne(x,_)},getClearAlpha:function(){return _},setClearAlpha:function(le){_=le,ne(x,_)},render:z}}function ZD(p,l,d,c){var h=p.getParameter(34921),x=c.isWebGL2?null:l.get("OES_vertex_array_object"),_=c.isWebGL2||x!==null,R={},O=le(null),B=O;function V(et,dt,at,it,Ke){var vt=!1;if(_){var gt=Q(it,at,dt);B!==gt&&(B=gt,z(B.object)),vt=me(it,Ke),vt&&ue(it,Ke)}else{var St=dt.wireframe===!0;(B.geometry!==it.id||B.program!==at.id||B.wireframe!==St)&&(B.geometry=it.id,B.program=at.id,B.wireframe=St,vt=!0)}et.isInstancedMesh===!0&&(vt=!0),Ke!==null&&d.update(Ke,34963),vt&&(Ue(et,dt,at,it),Ke!==null&&p.bindBuffer(34963,d.get(Ke).buffer))}function G(){return c.isWebGL2?p.createVertexArray():x.createVertexArrayOES()}function z(et){return c.isWebGL2?p.bindVertexArray(et):x.bindVertexArrayOES(et)}function ne(et){return c.isWebGL2?p.deleteVertexArray(et):x.deleteVertexArrayOES(et)}function Q(et,dt,at){var it=at.wireframe===!0,Ke=R[et.id];Ke===void 0&&(Ke={},R[et.id]=Ke);var vt=Ke[dt.id];vt===void 0&&(vt={},Ke[dt.id]=vt);var gt=vt[it];return gt===void 0&&(gt=le(G()),vt[it]=gt),gt}function le(et){for(var dt=[],at=[],it=[],Ke=0;Ke<h;Ke++)dt[Ke]=0,at[Ke]=0,it[Ke]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:dt,enabledAttributes:at,attributeDivisors:it,object:et,attributes:{},index:null}}function me(et,dt){var at=B.attributes,it=et.attributes,Ke=0;for(var vt in it){var gt=at[vt],St=it[vt];if(gt===void 0||gt.attribute!==St||gt.data!==St.data)return!0;Ke++}return B.attributesNum!==Ke||B.index!==dt}function ue(et,dt){var at={},it=et.attributes,Ke=0;for(var vt in it){var gt=it[vt],St={};St.attribute=gt,gt.data&&(St.data=gt.data),at[vt]=St,Ke++}B.attributes=at,B.attributesNum=Ke,B.index=dt}function re(){for(var et=B.newAttributes,dt=0,at=et.length;dt<at;dt++)et[dt]=0}function Oe(et){He(et,0)}function He(et,dt){var at=B.newAttributes,it=B.enabledAttributes,Ke=B.attributeDivisors;if(at[et]=1,it[et]===0&&(p.enableVertexAttribArray(et),it[et]=1),Ke[et]!==dt){var vt=c.isWebGL2?p:l.get("ANGLE_instanced_arrays");vt[c.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](et,dt),Ke[et]=dt}}function Re(){for(var et=B.newAttributes,dt=B.enabledAttributes,at=0,it=dt.length;at<it;at++)dt[at]!==et[at]&&(p.disableVertexAttribArray(at),dt[at]=0)}function we(et,dt,at,it,Ke,vt){c.isWebGL2===!0&&(at===5124||at===5125)?p.vertexAttribIPointer(et,dt,at,Ke,vt):p.vertexAttribPointer(et,dt,at,it,Ke,vt)}function Ue(et,dt,at,it){if(!(c.isWebGL2===!1&&(et.isInstancedMesh||it.isInstancedBufferGeometry)&&l.get("ANGLE_instanced_arrays")===null)){re();var Ke=it.attributes,vt=at.getAttributes(),gt=dt.defaultAttributeValues;for(var St in vt){var Tt=vt[St];if(Tt>=0){var qt=Ke[St];if(qt!==void 0){var en=qt.normalized,_n=qt.itemSize,Lt=d.get(qt);if(Lt===void 0)continue;var Wn=Lt.buffer,gn=Lt.type,qn=Lt.bytesPerElement;if(qt.isInterleavedBufferAttribute){var ar=qt.data,gr=ar.stride,sr=qt.offset;ar&&ar.isInstancedInterleavedBuffer?(He(Tt,ar.meshPerAttribute),it._maxInstanceCount===void 0&&(it._maxInstanceCount=ar.meshPerAttribute*ar.count)):Oe(Tt),p.bindBuffer(34962,Wn),we(Tt,_n,gn,en,gr*qn,sr*qn)}else qt.isInstancedBufferAttribute?(He(Tt,qt.meshPerAttribute),it._maxInstanceCount===void 0&&(it._maxInstanceCount=qt.meshPerAttribute*qt.count)):Oe(Tt),p.bindBuffer(34962,Wn),we(Tt,_n,gn,en,0,0)}else if(St==="instanceMatrix"){var ai=d.get(et.instanceMatrix);if(ai===void 0)continue;var Or=ai.buffer,$r=ai.type;He(Tt+0,1),He(Tt+1,1),He(Tt+2,1),He(Tt+3,1),p.bindBuffer(34962,Or),p.vertexAttribPointer(Tt+0,4,$r,!1,64,0),p.vertexAttribPointer(Tt+1,4,$r,!1,64,16),p.vertexAttribPointer(Tt+2,4,$r,!1,64,32),p.vertexAttribPointer(Tt+3,4,$r,!1,64,48)}else if(St==="instanceColor"){var Di=d.get(et.instanceColor);if(Di===void 0)continue;var sa=Di.buffer,Wi=Di.type;He(Tt,1),p.bindBuffer(34962,sa),p.vertexAttribPointer(Tt,3,Wi,!1,12,0)}else if(gt!==void 0){var Ti=gt[St];if(Ti!==void 0)switch(Ti.length){case 2:p.vertexAttrib2fv(Tt,Ti);break;case 3:p.vertexAttrib3fv(Tt,Ti);break;case 4:p.vertexAttrib4fv(Tt,Ti);break;default:p.vertexAttrib1fv(Tt,Ti)}}}}Re()}}function rt(){ut();for(var et in R){var dt=R[et];for(var at in dt){var it=dt[at];for(var Ke in it)ne(it[Ke].object),delete it[Ke];delete dt[at]}delete R[et]}}function nt(et){if(R[et.id]!==void 0){var dt=R[et.id];for(var at in dt){var it=dt[at];for(var Ke in it)ne(it[Ke].object),delete it[Ke];delete dt[at]}delete R[et.id]}}function ot(et){for(var dt in R){var at=R[dt];if(at[et.id]!==void 0){var it=at[et.id];for(var Ke in it)ne(it[Ke].object),delete it[Ke];delete at[et.id]}}}function ut(){st(),B!==O&&(B=O,z(B.object))}function st(){O.geometry=null,O.program=null,O.wireframe=!1}return{setup:V,reset:ut,resetDefaultState:st,dispose:rt,releaseStatesOfGeometry:nt,releaseStatesOfProgram:ot,initAttributes:re,enableAttribute:Oe,disableUnusedAttributes:Re}}function QD(p,l,d,c){var h=c.isWebGL2,x;function _(B){x=B}function R(B,V){p.drawArrays(x,B,V),d.update(V,x,1)}function O(B,V,G){if(G!==0){var z,ne;if(h)z=p,ne="drawArraysInstanced";else if(z=l.get("ANGLE_instanced_arrays"),ne="drawArraysInstancedANGLE",z===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}z[ne](x,B,V,G),d.update(V,x,G)}}this.setMode=_,this.render=R,this.renderInstances=O}function JD(p,l,d){var c;function h(){if(c!==void 0)return c;var we=l.get("EXT_texture_filter_anisotropic");return we!==null?c=p.getParameter(we.MAX_TEXTURE_MAX_ANISOTROPY_EXT):c=0,c}function x(we){if(we==="highp"){if(p.getShaderPrecisionFormat(35633,36338).precision>0&&p.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";we="mediump"}return we==="mediump"&&p.getShaderPrecisionFormat(35633,36337).precision>0&&p.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var _=typeof WebGL2RenderingContext!="undefined"&&p instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext!="undefined"&&p instanceof WebGL2ComputeRenderingContext,R=d.precision!==void 0?d.precision:"highp",O=x(R);O!==R&&(console.warn("THREE.WebGLRenderer:",R,"not supported, using",O,"instead."),R=O);var B=d.logarithmicDepthBuffer===!0,V=p.getParameter(34930),G=p.getParameter(35660),z=p.getParameter(3379),ne=p.getParameter(34076),Q=p.getParameter(34921),le=p.getParameter(36347),me=p.getParameter(36348),ue=p.getParameter(36349),re=G>0,Oe=_||!!l.get("OES_texture_float"),He=re&&Oe,Re=_?p.getParameter(36183):0;return{isWebGL2:_,getMaxAnisotropy:h,getMaxPrecision:x,precision:R,logarithmicDepthBuffer:B,maxTextures:V,maxVertexTextures:G,maxTextureSize:z,maxCubemapSize:ne,maxAttributes:Q,maxVertexUniforms:le,maxVaryings:me,maxFragmentUniforms:ue,vertexTextures:re,floatFragmentTextures:Oe,floatVertexTextures:He,maxSamples:Re}}function eO(p){var l=this,d=null,c=0,h=!1,x=!1,_=new zo,R=new Ua,O={value:null,needsUpdate:!1};this.uniform=O,this.numPlanes=0,this.numIntersection=0,this.init=function(G,z,ne){var Q=G.length!==0||z||c!==0||h;return h=z,d=V(G,ne,0),c=G.length,Q},this.beginShadows=function(){x=!0,V(null)},this.endShadows=function(){x=!1,B()},this.setState=function(G,z,ne){var Q=G.clippingPlanes,le=G.clipIntersection,me=G.clipShadows,ue=p.get(G);if(!h||Q===null||Q.length===0||x&&!me)x?V(null):B();else{var re=x?0:c,Oe=re*4,He=ue.clippingState||null;O.value=He,He=V(Q,z,Oe,ne);for(var Re=0;Re!==Oe;++Re)He[Re]=d[Re];ue.clippingState=He,this.numIntersection=le?this.numPlanes:0,this.numPlanes+=re}};function B(){O.value!==d&&(O.value=d,O.needsUpdate=c>0),l.numPlanes=c,l.numIntersection=0}function V(G,z,ne,Q){var le=G!==null?G.length:0,me=null;if(le!==0){if(me=O.value,Q!==!0||me===null){var ue=ne+le*4,re=z.matrixWorldInverse;R.getNormalMatrix(re),(me===null||me.length<ue)&&(me=new Float32Array(ue));for(var Oe=0,He=ne;Oe!==le;++Oe,He+=4)_.copy(G[Oe]).applyMatrix4(re,R),_.normal.toArray(me,He),me[He+3]=_.constant}O.value=me,O.needsUpdate=!0}return l.numPlanes=le,l.numIntersection=0,me}}function tO(p){var l=new WeakMap;function d(_,R){return R===Xe?_.mapping=xe:R===Mt&&(_.mapping=Je),_}function c(_){if(_&&_.isTexture){var R=_.mapping;if(R===Xe||R===Mt)if(l.has(_)){var O=l.get(_).texture;return d(O,_.mapping)}else{var B=_.image;if(B&&B.height>0){var V=p.getRenderList(),G=p.getRenderTarget(),z=new $0(B.height/2);return z.fromEquirectangularTexture(p,_),l.set(_,z),p.setRenderTarget(G),p.setRenderList(V),_.addEventListener("dispose",h),d(z.texture,_.mapping)}else return null}}return _}function h(_){var R=_.target;R.removeEventListener("dispose",h);var O=l.get(R);O!==void 0&&(l.delete(R),O.dispose())}function x(){l=new WeakMap}return{get:c,dispose:x}}function nO(p){var l={};function d(c){if(l[c]!==void 0)return l[c];var h;switch(c){case"WEBGL_depth_texture":h=p.getExtension("WEBGL_depth_texture")||p.getExtension("MOZ_WEBGL_depth_texture")||p.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":h=p.getExtension("EXT_texture_filter_anisotropic")||p.getExtension("MOZ_EXT_texture_filter_anisotropic")||p.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":h=p.getExtension("WEBGL_compressed_texture_s3tc")||p.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||p.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":h=p.getExtension("WEBGL_compressed_texture_pvrtc")||p.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:h=p.getExtension(c)}return l[c]=h,h}return{has:function(h){return d(h)!==null},init:function(h){h.isWebGL2?d("EXT_color_buffer_float"):(d("WEBGL_depth_texture"),d("OES_texture_float"),d("OES_texture_half_float"),d("OES_texture_half_float_linear"),d("OES_standard_derivatives"),d("OES_element_index_uint"),d("OES_vertex_array_object"),d("ANGLE_instanced_arrays")),d("OES_texture_float_linear"),d("EXT_color_buffer_half_float")},get:function(h){var x=d(h);return x===null&&console.warn("THREE.WebGLRenderer: "+h+" extension not supported."),x}}}function rO(p,l,d,c){var h={},x=new WeakMap;function _(G){var z=G.target;z.index!==null&&l.remove(z.index);for(var ne in z.attributes)l.remove(z.attributes[ne]);z.removeEventListener("dispose",_),delete h[z.id];var Q=x.get(z);Q&&(l.remove(Q),x.delete(z)),c.releaseStatesOfGeometry(z),z.isInstancedBufferGeometry===!0&&delete z._maxInstanceCount,d.memory.geometries--}function R(G,z){return h[z.id]===!0||(z.addEventListener("dispose",_),h[z.id]=!0,d.memory.geometries++),z}function O(G){var z=G.attributes;for(var ne in z)l.update(z[ne],34962);var Q=G.morphAttributes;for(var le in Q)for(var me=Q[le],ue=0,re=me.length;ue<re;ue++)l.update(me[ue],34962)}function B(G){var z=[],ne=G.index,Q=G.attributes.position,le=0;if(ne!==null){var me=ne.array;le=ne.version;for(var ue=0,re=me.length;ue<re;ue+=3){var Oe=me[ue+0],He=me[ue+1],Re=me[ue+2];z.push(Oe,He,He,Re,Re,Oe)}}else{var we=Q.array;le=Q.version;for(var Ue=0,rt=we.length/3-1;Ue<rt;Ue+=3){var nt=Ue+0,ot=Ue+1,ut=Ue+2;z.push(nt,ot,ot,ut,ut,nt)}}var st=new(aA(z)>65535?uc:cc)(z,1);st.version=le;var et=x.get(G);et&&l.remove(et),x.set(G,st)}function V(G){var z=x.get(G);if(z){var ne=G.index;ne!==null&&z.version<ne.version&&B(G)}else B(G);return x.get(G)}return{get:R,update:O,getWireframeAttribute:V}}function iO(p,l,d,c){var h=c.isWebGL2,x;function _(z){x=z}var R,O;function B(z){R=z.type,O=z.bytesPerElement}function V(z,ne){p.drawElements(x,ne,R,z*O),d.update(ne,x,1)}function G(z,ne,Q){if(Q!==0){var le,me;if(h)le=p,me="drawElementsInstanced";else if(le=l.get("ANGLE_instanced_arrays"),me="drawElementsInstancedANGLE",le===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}le[me](x,ne,R,z*O,Q),d.update(ne,x,Q)}}this.setMode=_,this.setIndex=B,this.render=V,this.renderInstances=G}function aO(p){var l={geometries:0,textures:0},d={frame:0,calls:0,triangles:0,points:0,lines:0};function c(x,_,R){switch(d.calls++,_){case 4:d.triangles+=R*(x/3);break;case 1:d.lines+=R*(x/2);break;case 3:d.lines+=R*(x-1);break;case 2:d.lines+=R*x;break;case 0:d.points+=R*x;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",_);break}}function h(){d.frame++,d.calls=0,d.triangles=0,d.points=0,d.lines=0}return{memory:l,render:d,programs:null,autoReset:!0,reset:h,update:c}}function oO(p,l){return p[0]-l[0]}function sO(p,l){return Math.abs(l[1])-Math.abs(p[1])}function lO(p){for(var l={},d=new Float32Array(8),c=[],h=0;h<8;h++)c[h]=[h,0];function x(_,R,O,B){var V=_.morphTargetInfluences,G=V===void 0?0:V.length,z=l[R.id];if(z===void 0){z=[];for(var ne=0;ne<G;ne++)z[ne]=[ne,0];l[R.id]=z}for(var Q=0;Q<G;Q++){var le=z[Q];le[0]=Q,le[1]=V[Q]}z.sort(sO);for(var me=0;me<8;me++)me<G&&z[me][1]?(c[me][0]=z[me][0],c[me][1]=z[me][1]):(c[me][0]=Number.MAX_SAFE_INTEGER,c[me][1]=0);c.sort(oO);for(var ue=O.morphTargets&&R.morphAttributes.position,re=O.morphNormals&&R.morphAttributes.normal,Oe=0,He=0;He<8;He++){var Re=c[He],we=Re[0],Ue=Re[1];we!==Number.MAX_SAFE_INTEGER&&Ue?(ue&&R.getAttribute("morphTarget"+He)!==ue[we]&&R.setAttribute("morphTarget"+He,ue[we]),re&&R.getAttribute("morphNormal"+He)!==re[we]&&R.setAttribute("morphNormal"+He,re[we]),d[He]=Ue,Oe+=Ue):(ue&&R.hasAttribute("morphTarget"+He)===!0&&R.deleteAttribute("morphTarget"+He),re&&R.hasAttribute("morphNormal"+He)===!0&&R.deleteAttribute("morphNormal"+He),d[He]=0)}var rt=R.morphTargetsRelative?1:1-Oe;B.getUniforms().setValue(p,"morphTargetBaseInfluence",rt),B.getUniforms().setValue(p,"morphTargetInfluences",d)}return{update:x}}function cO(p,l,d,c){var h=new WeakMap;function x(O){var B=c.render.frame,V=O.geometry,G=l.get(O,V);return h.get(G)!==B&&(l.update(G),h.set(G,B)),O.isInstancedMesh&&(O.hasEventListener("dispose",R)===!1&&O.addEventListener("dispose",R),d.update(O.instanceMatrix,34962),O.instanceColor!==null&&d.update(O.instanceColor,34962)),G}function _(){h=new WeakMap}function R(O){var B=O.target;B.removeEventListener("dispose",R),d.remove(B.instanceMatrix),B.instanceColor!==null&&d.remove(B.instanceColor)}return{update:x,dispose:_}}function yu(p,l,d,c){p===void 0&&(p=null),l===void 0&&(l=1),d===void 0&&(d=1),c===void 0&&(c=1),ii.call(this,null),this.image={data:p,width:l,height:d,depth:c},this.magFilter=Jt,this.minFilter=Jt,this.wrapR=Yt,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}yu.prototype=Object.create(ii.prototype),yu.prototype.constructor=yu,yu.prototype.isDataTexture2DArray=!0;function bu(p,l,d,c){p===void 0&&(p=null),l===void 0&&(l=1),d===void 0&&(d=1),c===void 0&&(c=1),ii.call(this,null),this.image={data:p,width:l,height:d,depth:c},this.magFilter=Jt,this.minFilter=Jt,this.wrapR=Yt,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}bu.prototype=Object.create(ii.prototype),bu.prototype.constructor=bu,bu.prototype.isDataTexture3D=!0;var lA=new ii,uO=new yu,hO=new bu,cA=new jo,uA=[],hA=[],fA=new Float32Array(16),dA=new Float32Array(9),pA=new Float32Array(4);function xu(p,l,d){var c=p[0];if(c<=0||c>0)return p;var h=l*d,x=uA[h];if(x===void 0&&(x=new Float32Array(h),uA[h]=x),l!==0){c.toArray(x,0);for(var _=1,R=0;_!==l;++_)R+=d,p[_].toArray(x,R)}return x}function io(p,l){if(p.length!==l.length)return!1;for(var d=0,c=p.length;d<c;d++)if(p[d]!==l[d])return!1;return!0}function Va(p,l){for(var d=0,c=l.length;d<c;d++)p[d]=l[d]}function mA(p,l){var d=hA[l];d===void 0&&(d=new Int32Array(l),hA[l]=d);for(var c=0;c!==l;++c)d[c]=p.allocateTextureUnit();return d}function fO(p,l){var d=this.cache;d[0]!==l&&(p.uniform1f(this.addr,l),d[0]=l)}function dO(p,l){var d=this.cache;if(l.x!==void 0)(d[0]!==l.x||d[1]!==l.y)&&(p.uniform2f(this.addr,l.x,l.y),d[0]=l.x,d[1]=l.y);else{if(io(d,l))return;p.uniform2fv(this.addr,l),Va(d,l)}}function pO(p,l){var d=this.cache;if(l.x!==void 0)(d[0]!==l.x||d[1]!==l.y||d[2]!==l.z)&&(p.uniform3f(this.addr,l.x,l.y,l.z),d[0]=l.x,d[1]=l.y,d[2]=l.z);else if(l.r!==void 0)(d[0]!==l.r||d[1]!==l.g||d[2]!==l.b)&&(p.uniform3f(this.addr,l.r,l.g,l.b),d[0]=l.r,d[1]=l.g,d[2]=l.b);else{if(io(d,l))return;p.uniform3fv(this.addr,l),Va(d,l)}}function mO(p,l){var d=this.cache;if(l.x!==void 0)(d[0]!==l.x||d[1]!==l.y||d[2]!==l.z||d[3]!==l.w)&&(p.uniform4f(this.addr,l.x,l.y,l.z,l.w),d[0]=l.x,d[1]=l.y,d[2]=l.z,d[3]=l.w);else{if(io(d,l))return;p.uniform4fv(this.addr,l),Va(d,l)}}function vO(p,l){var d=this.cache,c=l.elements;if(c===void 0){if(io(d,l))return;p.uniformMatrix2fv(this.addr,!1,l),Va(d,l)}else{if(io(d,c))return;pA.set(c),p.uniformMatrix2fv(this.addr,!1,pA),Va(d,c)}}function gO(p,l){var d=this.cache,c=l.elements;if(c===void 0){if(io(d,l))return;p.uniformMatrix3fv(this.addr,!1,l),Va(d,l)}else{if(io(d,c))return;dA.set(c),p.uniformMatrix3fv(this.addr,!1,dA),Va(d,c)}}function yO(p,l){var d=this.cache,c=l.elements;if(c===void 0){if(io(d,l))return;p.uniformMatrix4fv(this.addr,!1,l),Va(d,l)}else{if(io(d,c))return;fA.set(c),p.uniformMatrix4fv(this.addr,!1,fA),Va(d,c)}}function bO(p,l,d){var c=this.cache,h=d.allocateTextureUnit();c[0]!==h&&(p.uniform1i(this.addr,h),c[0]=h),d.safeSetTexture2D(l||lA,h)}function xO(p,l,d){var c=this.cache,h=d.allocateTextureUnit();c[0]!==h&&(p.uniform1i(this.addr,h),c[0]=h),d.setTexture2DArray(l||uO,h)}function wO(p,l,d){var c=this.cache,h=d.allocateTextureUnit();c[0]!==h&&(p.uniform1i(this.addr,h),c[0]=h),d.setTexture3D(l||hO,h)}function AO(p,l,d){var c=this.cache,h=d.allocateTextureUnit();c[0]!==h&&(p.uniform1i(this.addr,h),c[0]=h),d.safeSetTextureCube(l||cA,h)}function EO(p,l){var d=this.cache;d[0]!==l&&(p.uniform1i(this.addr,l),d[0]=l)}function _O(p,l){var d=this.cache;io(d,l)||(p.uniform2iv(this.addr,l),Va(d,l))}function MO(p,l){var d=this.cache;io(d,l)||(p.uniform3iv(this.addr,l),Va(d,l))}function SO(p,l){var d=this.cache;io(d,l)||(p.uniform4iv(this.addr,l),Va(d,l))}function TO(p,l){var d=this.cache;d[0]!==l&&(p.uniform1ui(this.addr,l),d[0]=l)}function CO(p){switch(p){case 5126:return fO;case 35664:return dO;case 35665:return pO;case 35666:return mO;case 35674:return vO;case 35675:return gO;case 35676:return yO;case 5124:case 35670:return EO;case 35667:case 35671:return _O;case 35668:case 35672:return MO;case 35669:case 35673:return SO;case 5125:return TO;case 35678:case 36198:case 36298:case 36306:case 35682:return bO;case 35679:case 36299:case 36307:return wO;case 35680:case 36300:case 36308:case 36293:return AO;case 36289:case 36303:case 36311:case 36292:return xO}}function RO(p,l){p.uniform1fv(this.addr,l)}function LO(p,l){p.uniform1iv(this.addr,l)}function PO(p,l){p.uniform2iv(this.addr,l)}function DO(p,l){p.uniform3iv(this.addr,l)}function OO(p,l){p.uniform4iv(this.addr,l)}function IO(p,l){var d=xu(l,this.size,2);p.uniform2fv(this.addr,d)}function kO(p,l){var d=xu(l,this.size,3);p.uniform3fv(this.addr,d)}function FO(p,l){var d=xu(l,this.size,4);p.uniform4fv(this.addr,d)}function BO(p,l){var d=xu(l,this.size,4);p.uniformMatrix2fv(this.addr,!1,d)}function NO(p,l){var d=xu(l,this.size,9);p.uniformMatrix3fv(this.addr,!1,d)}function UO(p,l){var d=xu(l,this.size,16);p.uniformMatrix4fv(this.addr,!1,d)}function HO(p,l,d){var c=l.length,h=mA(d,c);p.uniform1iv(this.addr,h);for(var x=0;x!==c;++x)d.safeSetTexture2D(l[x]||lA,h[x])}function zO(p,l,d){var c=l.length,h=mA(d,c);p.uniform1iv(this.addr,h);for(var x=0;x!==c;++x)d.safeSetTextureCube(l[x]||cA,h[x])}function GO(p){switch(p){case 5126:return RO;case 35664:return IO;case 35665:return kO;case 35666:return FO;case 35674:return BO;case 35675:return NO;case 35676:return UO;case 5124:case 35670:return LO;case 35667:case 35671:return PO;case 35668:case 35672:return DO;case 35669:case 35673:return OO;case 35678:case 36198:case 36298:case 36306:case 35682:return HO;case 35680:case 36300:case 36308:case 36293:return zO}}function VO(p,l,d){this.id=p,this.addr=d,this.cache=[],this.setValue=CO(l.type)}function vA(p,l,d){this.id=p,this.addr=d,this.cache=[],this.size=l.size,this.setValue=GO(l.type)}vA.prototype.updateCache=function(p){var l=this.cache;p instanceof Float32Array&&l.length!==p.length&&(this.cache=new Float32Array(p.length)),Va(l,p)};function gA(p){this.id=p,this.seq=[],this.map={}}gA.prototype.setValue=function(p,l,d){for(var c=this.seq,h=0,x=c.length;h!==x;++h){var _=c[h];_.setValue(p,l[_.id],d)}};var Z0=/(\w+)(\])?(\[|\.)?/g;function yA(p,l){p.seq.push(l),p.map[l.id]=l}function WO(p,l,d){var c=p.name,h=c.length;for(Z0.lastIndex=0;;){var x=Z0.exec(c),_=Z0.lastIndex,R=x[1],O=x[2]==="]",B=x[3];if(O&&(R=R|0),B===void 0||B==="["&&_+2===h){yA(d,B===void 0?new VO(R,p,l):new vA(R,p,l));break}else{var V=d.map,G=V[R];G===void 0&&(G=new gA(R),yA(d,G)),d=G}}}function ll(p,l){this.seq=[],this.map={};for(var d=p.getProgramParameter(l,35718),c=0;c<d;++c){var h=p.getActiveUniform(l,c),x=p.getUniformLocation(l,h.name);WO(h,x,this)}}ll.prototype.setValue=function(p,l,d,c){var h=this.map[l];h!==void 0&&h.setValue(p,d,c)},ll.prototype.setOptional=function(p,l,d){var c=l[d];c!==void 0&&this.setValue(p,d,c)},ll.upload=function(p,l,d,c){for(var h=0,x=l.length;h!==x;++h){var _=l[h],R=d[_.id];R.needsUpdate!==!1&&_.setValue(p,R.value,c)}},ll.seqWithValue=function(p,l){for(var d=[],c=0,h=p.length;c!==h;++c){var x=p[c];x.id in l&&d.push(x)}return d};function bA(p,l,d){var c=p.createShader(l);return p.shaderSource(c,d),p.compileShader(c),c}var jO=0;function XO(p){for(var l=p.split(`
`),d=0;d<l.length;d++)l[d]=d+1+": "+l[d];return l.join(`
`)}function xA(p){switch(p){case xa:return["Linear","( value )"];case ef:return["sRGB","( value )"];case Tp:return["RGBE","( value )"];case A0:return["RGBM","( value, 7.0 )"];case E0:return["RGBM","( value, 16.0 )"];case _0:return["RGBD","( value, 256.0 )"];case Sp:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case zw:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",p),["Linear","( value )"]}}function wA(p,l,d){var c=p.getShaderParameter(l,35713),h=p.getShaderInfoLog(l).trim();if(c&&h==="")return"";var x=p.getShaderSource(l);return"THREE.WebGLShader: gl.getShaderInfoLog() "+d+`
`+h+XO(x)}function yf(p,l){var d=xA(l);return"vec4 "+p+"( vec4 value ) { return "+d[0]+"ToLinear"+d[1]+"; }"}function qO(p,l){var d=xA(l);return"vec4 "+p+"( vec4 value ) { return LinearTo"+d[0]+d[1]+"; }"}function YO(p,l){var d;switch(l){case Be:d="Linear";break;case We:d="Reinhard";break;case ve:d="OptimizedCineon";break;case K:d="ACESFilmic";break;case J:d="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",l),d="Linear"}return"vec3 "+p+"( vec3 color ) { return "+d+"ToneMapping( color ); }"}function $O(p){var l=[p.extensionDerivatives||p.envMapCubeUV||p.bumpMap||p.tangentSpaceNormalMap||p.clearcoatNormalMap||p.flatShading||p.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(p.extensionFragDepth||p.logarithmicDepthBuffer)&&p.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",p.extensionDrawBuffers&&p.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(p.extensionShaderTextureLOD||p.envMap)&&p.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""];return l.filter(bf).join(`
`)}function KO(p){var l=[];for(var d in p){var c=p[d];c!==!1&&l.push("#define "+d+" "+c)}return l.join(`
`)}function ZO(p,l){for(var d={},c=p.getProgramParameter(l,35721),h=0;h<c;h++){var x=p.getActiveAttrib(l,h),_=x.name;d[_]=p.getAttribLocation(l,_)}return d}function bf(p){return p!==""}function AA(p,l){return p.replace(/NUM_DIR_LIGHTS/g,l.numDirLights).replace(/NUM_SPOT_LIGHTS/g,l.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,l.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,l.numPointLights).replace(/NUM_HEMI_LIGHTS/g,l.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,l.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,l.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,l.numPointLightShadows)}function EA(p,l){return p.replace(/NUM_CLIPPING_PLANES/g,l.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,l.numClippingPlanes-l.numClipIntersection)}var QO=/^[ \t]*#include +<([\w\d./]+)>/gm;function Q0(p){return p.replace(QO,JO)}function JO(p,l){var d=Cr[l];if(d===void 0)throw new Error("Can not resolve #include <"+l+">");return Q0(d)}var eI=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,tI=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function _A(p){return p.replace(tI,MA).replace(eI,nI)}function nI(p,l,d,c){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),MA(p,l,d,c)}function MA(p,l,d,c){for(var h="",x=parseInt(l);x<parseInt(d);x++)h+=c.replace(/\[\s*i\s*\]/g,"[ "+x+" ]").replace(/UNROLLED_LOOP_INDEX/g,x);return h}function SA(p){var l="precision "+p.precision+` float;
precision `+p.precision+" int;";return p.precision==="highp"?l+=`
#define HIGH_PRECISION`:p.precision==="mediump"?l+=`
#define MEDIUM_PRECISION`:p.precision==="lowp"&&(l+=`
#define LOW_PRECISION`),l}function rI(p){var l="SHADOWMAP_TYPE_BASIC";return p.shadowMapType===M?l="SHADOWMAP_TYPE_PCF":p.shadowMapType===S?l="SHADOWMAP_TYPE_PCF_SOFT":p.shadowMapType===E&&(l="SHADOWMAP_TYPE_VSM"),l}function iI(p){var l="ENVMAP_TYPE_CUBE";if(p.envMap)switch(p.envMapMode){case xe:case Je:l="ENVMAP_TYPE_CUBE";break;case qe:case It:l="ENVMAP_TYPE_CUBE_UV";break}return l}function aI(p){var l="ENVMAP_MODE_REFLECTION";if(p.envMap)switch(p.envMapMode){case Je:case It:l="ENVMAP_MODE_REFRACTION";break}return l}function oI(p){var l="ENVMAP_BLENDING_NONE";if(p.envMap)switch(p.combine){case ee:l="ENVMAP_BLENDING_MULTIPLY";break;case te:l="ENVMAP_BLENDING_MIX";break;case Se:l="ENVMAP_BLENDING_ADD";break}return l}function sI(p,l,d,c){var h=p.getContext(),x=d.defines,_=d.vertexShader,R=d.fragmentShader,O=rI(d),B=iI(d),V=aI(d),G=oI(d),z=p.gammaFactor>0?p.gammaFactor:1,ne=d.isWebGL2?"":$O(d),Q=KO(x),le=h.createProgram(),me,ue,re=d.glslVersion?"#version "+d.glslVersion+`
`:"";d.isRawShaderMaterial?(me=[Q].filter(bf).join(`
`),me.length>0&&(me+=`
`),ue=[ne,Q].filter(bf).join(`
`),ue.length>0&&(ue+=`
`)):(me=[SA(d),"#define SHADER_NAME "+d.shaderName,Q,d.instancing?"#define USE_INSTANCING":"",d.instancingColor?"#define USE_INSTANCING_COLOR":"",d.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+z,"#define MAX_BONES "+d.maxBones,d.useFog&&d.fog?"#define USE_FOG":"",d.useFog&&d.fogExp2?"#define FOG_EXP2":"",d.map?"#define USE_MAP":"",d.envMap?"#define USE_ENVMAP":"",d.envMap?"#define "+V:"",d.lightMap?"#define USE_LIGHTMAP":"",d.aoMap?"#define USE_AOMAP":"",d.emissiveMap?"#define USE_EMISSIVEMAP":"",d.bumpMap?"#define USE_BUMPMAP":"",d.normalMap?"#define USE_NORMALMAP":"",d.normalMap&&d.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",d.normalMap&&d.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",d.clearcoatMap?"#define USE_CLEARCOATMAP":"",d.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",d.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",d.displacementMap&&d.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",d.specularMap?"#define USE_SPECULARMAP":"",d.roughnessMap?"#define USE_ROUGHNESSMAP":"",d.metalnessMap?"#define USE_METALNESSMAP":"",d.alphaMap?"#define USE_ALPHAMAP":"",d.transmissionMap?"#define USE_TRANSMISSIONMAP":"",d.vertexTangents?"#define USE_TANGENT":"",d.vertexColors?"#define USE_COLOR":"",d.vertexUvs?"#define USE_UV":"",d.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",d.flatShading?"#define FLAT_SHADED":"",d.skinning?"#define USE_SKINNING":"",d.useVertexTexture?"#define BONE_TEXTURE":"",d.morphTargets?"#define USE_MORPHTARGETS":"",d.morphNormals&&d.flatShading===!1?"#define USE_MORPHNORMALS":"",d.doubleSided?"#define DOUBLE_SIDED":"",d.flipSided?"#define FLIP_SIDED":"",d.shadowMapEnabled?"#define USE_SHADOWMAP":"",d.shadowMapEnabled?"#define "+O:"",d.sizeAttenuation?"#define USE_SIZEATTENUATION":"",d.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",d.logarithmicDepthBuffer&&d.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(bf).join(`
`),ue=[ne,SA(d),"#define SHADER_NAME "+d.shaderName,Q,d.alphaTest?"#define ALPHATEST "+d.alphaTest+(d.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+z,d.useFog&&d.fog?"#define USE_FOG":"",d.useFog&&d.fogExp2?"#define FOG_EXP2":"",d.map?"#define USE_MAP":"",d.matcap?"#define USE_MATCAP":"",d.envMap?"#define USE_ENVMAP":"",d.envMap?"#define "+B:"",d.envMap?"#define "+V:"",d.envMap?"#define "+G:"",d.lightMap?"#define USE_LIGHTMAP":"",d.aoMap?"#define USE_AOMAP":"",d.emissiveMap?"#define USE_EMISSIVEMAP":"",d.bumpMap?"#define USE_BUMPMAP":"",d.normalMap?"#define USE_NORMALMAP":"",d.normalMap&&d.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",d.normalMap&&d.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",d.clearcoatMap?"#define USE_CLEARCOATMAP":"",d.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",d.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",d.specularMap?"#define USE_SPECULARMAP":"",d.roughnessMap?"#define USE_ROUGHNESSMAP":"",d.metalnessMap?"#define USE_METALNESSMAP":"",d.alphaMap?"#define USE_ALPHAMAP":"",d.sheen?"#define USE_SHEEN":"",d.transmissionMap?"#define USE_TRANSMISSIONMAP":"",d.vertexTangents?"#define USE_TANGENT":"",d.vertexColors||d.instancingColor?"#define USE_COLOR":"",d.vertexUvs?"#define USE_UV":"",d.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",d.gradientMap?"#define USE_GRADIENTMAP":"",d.flatShading?"#define FLAT_SHADED":"",d.doubleSided?"#define DOUBLE_SIDED":"",d.flipSided?"#define FLIP_SIDED":"",d.shadowMapEnabled?"#define USE_SHADOWMAP":"",d.shadowMapEnabled?"#define "+O:"",d.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",d.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",d.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",d.logarithmicDepthBuffer&&d.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(d.extensionShaderTextureLOD||d.envMap)&&d.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",d.toneMapping!==ke?"#define TONE_MAPPING":"",d.toneMapping!==ke?Cr.tonemapping_pars_fragment:"",d.toneMapping!==ke?YO("toneMapping",d.toneMapping):"",d.dithering?"#define DITHERING":"",Cr.encodings_pars_fragment,d.map?yf("mapTexelToLinear",d.mapEncoding):"",d.matcap?yf("matcapTexelToLinear",d.matcapEncoding):"",d.envMap?yf("envMapTexelToLinear",d.envMapEncoding):"",d.emissiveMap?yf("emissiveMapTexelToLinear",d.emissiveMapEncoding):"",d.lightMap?yf("lightMapTexelToLinear",d.lightMapEncoding):"",qO("linearToOutputTexel",d.outputEncoding),d.depthPacking?"#define DEPTH_PACKING "+d.depthPacking:"",`
`].filter(bf).join(`
`)),_=Q0(_),_=AA(_,d),_=EA(_,d),R=Q0(R),R=AA(R,d),R=EA(R,d),_=_A(_),R=_A(R),d.isWebGL2&&d.isRawShaderMaterial!==!0&&(re=`#version 300 es
`,me=["#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+me,ue=["#define varying in",d.glslVersion===M0?"":"out highp vec4 pc_fragColor;",d.glslVersion===M0?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+ue);var Oe=re+me+_,He=re+ue+R,Re=bA(h,35633,Oe),we=bA(h,35632,He);if(h.attachShader(le,Re),h.attachShader(le,we),d.index0AttributeName!==void 0?h.bindAttribLocation(le,0,d.index0AttributeName):d.morphTargets===!0&&h.bindAttribLocation(le,0,"position"),h.linkProgram(le),p.debug.checkShaderErrors){var Ue=h.getProgramInfoLog(le).trim(),rt=h.getShaderInfoLog(Re).trim(),nt=h.getShaderInfoLog(we).trim(),ot=!0,ut=!0;if(h.getProgramParameter(le,35714)===!1){ot=!1;var st=wA(h,Re,"vertex"),et=wA(h,we,"fragment");console.error("THREE.WebGLProgram: shader error: ",h.getError(),"35715",h.getProgramParameter(le,35715),"gl.getProgramInfoLog",Ue,st,et)}else Ue!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",Ue):(rt===""||nt==="")&&(ut=!1);ut&&(this.diagnostics={runnable:ot,programLog:Ue,vertexShader:{log:rt,prefix:me},fragmentShader:{log:nt,prefix:ue}})}h.deleteShader(Re),h.deleteShader(we);var dt;this.getUniforms=function(){return dt===void 0&&(dt=new ll(h,le)),dt};var at;return this.getAttributes=function(){return at===void 0&&(at=ZO(h,le)),at},this.destroy=function(){c.releaseStatesOfProgram(this),h.deleteProgram(le),this.program=void 0},this.name=d.shaderName,this.id=jO++,this.cacheKey=l,this.usedTimes=1,this.program=le,this.vertexShader=Re,this.fragmentShader=we,this}function lI(p,l,d,c,h,x){var _=[],R=c.isWebGL2,O=c.logarithmicDepthBuffer,B=c.floatVertexTextures,V=c.maxVertexUniforms,G=c.vertexTextures,z=c.precision,ne={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},Q=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function le(we){var Ue=we.skeleton,rt=Ue.bones;if(B)return 1024;var nt=V,ot=Math.floor((nt-20)/4),ut=Math.min(ot,rt.length);return ut<rt.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+rt.length+" bones. This GPU supports "+ut+"."),0):ut}function me(we){var Ue;return we&&we.isTexture?Ue=we.encoding:we&&we.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),Ue=we.texture.encoding):Ue=xa,Ue}function ue(we,Ue,rt,nt,ot){var ut=nt.fog,st=we.isMeshStandardMaterial?nt.environment:null,et=l.get(we.envMap||st),dt=ne[we.type],at=ot.isSkinnedMesh?le(ot):0;we.precision!==null&&(z=c.getMaxPrecision(we.precision),z!==we.precision&&console.warn("THREE.WebGLProgram.getParameters:",we.precision,"not supported, using",z,"instead."));var it,Ke;if(dt){var vt=wo[dt];it=vt.vertexShader,Ke=vt.fragmentShader}else it=we.vertexShader,Ke=we.fragmentShader;var gt=p.getRenderTarget(),St={isWebGL2:R,shaderID:dt,shaderName:we.type,vertexShader:it,fragmentShader:Ke,defines:we.defines,isRawShaderMaterial:we.isRawShaderMaterial===!0,glslVersion:we.glslVersion,precision:z,instancing:ot.isInstancedMesh===!0,instancingColor:ot.isInstancedMesh===!0&&ot.instanceColor!==null,supportsVertexTextures:G,outputEncoding:gt!==null?me(gt.texture):p.outputEncoding,map:!!we.map,mapEncoding:me(we.map),matcap:!!we.matcap,matcapEncoding:me(we.matcap),envMap:!!et,envMapMode:et&&et.mapping,envMapEncoding:me(et),envMapCubeUV:!!et&&(et.mapping===qe||et.mapping===It),lightMap:!!we.lightMap,lightMapEncoding:me(we.lightMap),aoMap:!!we.aoMap,emissiveMap:!!we.emissiveMap,emissiveMapEncoding:me(we.emissiveMap),bumpMap:!!we.bumpMap,normalMap:!!we.normalMap,objectSpaceNormalMap:we.normalMapType===Ww,tangentSpaceNormalMap:we.normalMapType===ic,clearcoatMap:!!we.clearcoatMap,clearcoatRoughnessMap:!!we.clearcoatRoughnessMap,clearcoatNormalMap:!!we.clearcoatNormalMap,displacementMap:!!we.displacementMap,roughnessMap:!!we.roughnessMap,metalnessMap:!!we.metalnessMap,specularMap:!!we.specularMap,alphaMap:!!we.alphaMap,gradientMap:!!we.gradientMap,sheen:!!we.sheen,transmissionMap:!!we.transmissionMap,combine:we.combine,vertexTangents:we.normalMap&&we.vertexTangents,vertexColors:we.vertexColors,vertexUvs:!!we.map||!!we.bumpMap||!!we.normalMap||!!we.specularMap||!!we.alphaMap||!!we.emissiveMap||!!we.roughnessMap||!!we.metalnessMap||!!we.clearcoatMap||!!we.clearcoatRoughnessMap||!!we.clearcoatNormalMap||!!we.displacementMap||!!we.transmissionMap,uvsVertexOnly:!(!!we.map||!!we.bumpMap||!!we.normalMap||!!we.specularMap||!!we.alphaMap||!!we.emissiveMap||!!we.roughnessMap||!!we.metalnessMap||!!we.clearcoatNormalMap||!!we.transmissionMap)&&!!we.displacementMap,fog:!!ut,useFog:we.fog,fogExp2:ut&&ut.isFogExp2,flatShading:we.flatShading,sizeAttenuation:we.sizeAttenuation,logarithmicDepthBuffer:O,skinning:we.skinning&&at>0,maxBones:at,useVertexTexture:B,morphTargets:we.morphTargets,morphNormals:we.morphNormals,maxMorphTargets:p.maxMorphTargets,maxMorphNormals:p.maxMorphNormals,numDirLights:Ue.directional.length,numPointLights:Ue.point.length,numSpotLights:Ue.spot.length,numRectAreaLights:Ue.rectArea.length,numHemiLights:Ue.hemi.length,numDirLightShadows:Ue.directionalShadowMap.length,numPointLightShadows:Ue.pointShadowMap.length,numSpotLightShadows:Ue.spotShadowMap.length,numClippingPlanes:x.numPlanes,numClipIntersection:x.numIntersection,dithering:we.dithering,shadowMapEnabled:p.shadowMap.enabled&&rt.length>0,shadowMapType:p.shadowMap.type,toneMapping:we.toneMapped?p.toneMapping:ke,physicallyCorrectLights:p.physicallyCorrectLights,premultipliedAlpha:we.premultipliedAlpha,alphaTest:we.alphaTest,doubleSided:we.side===L,flipSided:we.side===C,depthPacking:we.depthPacking!==void 0?we.depthPacking:!1,index0AttributeName:we.index0AttributeName,extensionDerivatives:we.extensions&&we.extensions.derivatives,extensionFragDepth:we.extensions&&we.extensions.fragDepth,extensionDrawBuffers:we.extensions&&we.extensions.drawBuffers,extensionShaderTextureLOD:we.extensions&&we.extensions.shaderTextureLOD,rendererExtensionFragDepth:R||d.has("EXT_frag_depth"),rendererExtensionDrawBuffers:R||d.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:R||d.has("EXT_shader_texture_lod"),customProgramCacheKey:we.customProgramCacheKey()};return St}function re(we){var Ue=[];if(we.shaderID?Ue.push(we.shaderID):(Ue.push(we.fragmentShader),Ue.push(we.vertexShader)),we.defines!==void 0)for(var rt in we.defines)Ue.push(rt),Ue.push(we.defines[rt]);if(we.isRawShaderMaterial===!1){for(var nt=0;nt<Q.length;nt++)Ue.push(we[Q[nt]]);Ue.push(p.outputEncoding),Ue.push(p.gammaFactor)}return Ue.push(we.customProgramCacheKey),Ue.join()}function Oe(we){var Ue=ne[we.type],rt;if(Ue){var nt=wo[Ue];rt=sA.clone(nt.uniforms)}else rt=we.uniforms;return rt}function He(we,Ue){for(var rt,nt=0,ot=_.length;nt<ot;nt++){var ut=_[nt];if(ut.cacheKey===Ue){rt=ut,++rt.usedTimes;break}}return rt===void 0&&(rt=new sI(p,Ue,we,h),_.push(rt)),rt}function Re(we){if(--we.usedTimes==0){var Ue=_.indexOf(we);_[Ue]=_[_.length-1],_.pop(),we.destroy()}}return{getParameters:ue,getProgramCacheKey:re,getUniforms:Oe,acquireProgram:He,releaseProgram:Re,programs:_}}function cI(){var p=new WeakMap;function l(x){var _=p.get(x);return _===void 0&&(_={},p.set(x,_)),_}function d(x){p.delete(x)}function c(x,_,R){p.get(x)[_]=R}function h(){p=new WeakMap}return{get:l,remove:d,update:c,dispose:h}}function uI(p,l){return p.groupOrder!==l.groupOrder?p.groupOrder-l.groupOrder:p.renderOrder!==l.renderOrder?p.renderOrder-l.renderOrder:p.program!==l.program?p.program.id-l.program.id:p.material.id!==l.material.id?p.material.id-l.material.id:p.z!==l.z?p.z-l.z:p.id-l.id}function hI(p,l){return p.groupOrder!==l.groupOrder?p.groupOrder-l.groupOrder:p.renderOrder!==l.renderOrder?p.renderOrder-l.renderOrder:p.z!==l.z?l.z-p.z:p.id-l.id}function TA(p){var l=[],d=0,c=[],h=[],x={id:-1};function _(){d=0,c.length=0,h.length=0}function R(z,ne,Q,le,me,ue){var re=l[d],Oe=p.get(Q);return re===void 0?(re={id:z.id,object:z,geometry:ne,material:Q,program:Oe.program||x,groupOrder:le,renderOrder:z.renderOrder,z:me,group:ue},l[d]=re):(re.id=z.id,re.object=z,re.geometry=ne,re.material=Q,re.program=Oe.program||x,re.groupOrder=le,re.renderOrder=z.renderOrder,re.z=me,re.group=ue),d++,re}function O(z,ne,Q,le,me,ue){var re=R(z,ne,Q,le,me,ue);(Q.transparent===!0?h:c).push(re)}function B(z,ne,Q,le,me,ue){var re=R(z,ne,Q,le,me,ue);(Q.transparent===!0?h:c).unshift(re)}function V(z,ne){c.length>1&&c.sort(z||uI),h.length>1&&h.sort(ne||hI)}function G(){for(var z=d,ne=l.length;z<ne;z++){var Q=l[z];if(Q.id===null)break;Q.id=null,Q.object=null,Q.geometry=null,Q.material=null,Q.program=null,Q.group=null}}return{opaque:c,transparent:h,init:_,push:O,unshift:B,finish:G,sort:V}}function fI(p){var l=new WeakMap;function d(h,x){var _=l.get(h),R;return _===void 0?(R=new TA(p),l.set(h,new WeakMap),l.get(h).set(x,R)):(R=_.get(x),R===void 0&&(R=new TA(p),_.set(x,R))),R}function c(){l=new WeakMap}return{get:d,dispose:c}}function dI(){var p={};return{get:function(d){if(p[d.id]!==void 0)return p[d.id];var c;switch(d.type){case"DirectionalLight":c={direction:new Ge,color:new vn};break;case"SpotLight":c={position:new Ge,direction:new Ge,color:new vn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":c={position:new Ge,color:new vn,distance:0,decay:0};break;case"HemisphereLight":c={direction:new Ge,skyColor:new vn,groundColor:new vn};break;case"RectAreaLight":c={color:new vn,position:new Ge,halfWidth:new Ge,halfHeight:new Ge};break}return p[d.id]=c,c}}}function pI(){var p={};return{get:function(d){if(p[d.id]!==void 0)return p[d.id];var c;switch(d.type){case"DirectionalLight":c={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Zt};break;case"SpotLight":c={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Zt};break;case"PointLight":c={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Zt,shadowCameraNear:1,shadowCameraFar:1e3};break}return p[d.id]=c,c}}}var mI=0;function vI(p,l){return(l.castShadow?1:0)-(p.castShadow?1:0)}function gI(p,l){for(var d=new dI,c=pI(),h={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},x=0;x<9;x++)h.probe.push(new Ge);var _=new Ge,R=new br,O=new br;function B(G){for(var z=0,ne=0,Q=0,le=0;le<9;le++)h.probe[le].set(0,0,0);var me=0,ue=0,re=0,Oe=0,He=0,Re=0,we=0,Ue=0;G.sort(vI);for(var rt=0,nt=G.length;rt<nt;rt++){var ot=G[rt],ut=ot.color,st=ot.intensity,et=ot.distance,dt=ot.shadow&&ot.shadow.map?ot.shadow.map.texture:null;if(ot.isAmbientLight)z+=ut.r*st,ne+=ut.g*st,Q+=ut.b*st;else if(ot.isLightProbe)for(var at=0;at<9;at++)h.probe[at].addScaledVector(ot.sh.coefficients[at],st);else if(ot.isDirectionalLight){var it=d.get(ot);if(it.color.copy(ot.color).multiplyScalar(ot.intensity),ot.castShadow){var Ke=ot.shadow,vt=c.get(ot);vt.shadowBias=Ke.bias,vt.shadowNormalBias=Ke.normalBias,vt.shadowRadius=Ke.radius,vt.shadowMapSize=Ke.mapSize,h.directionalShadow[me]=vt,h.directionalShadowMap[me]=dt,h.directionalShadowMatrix[me]=ot.shadow.matrix,Re++}h.directional[me]=it,me++}else if(ot.isSpotLight){var gt=d.get(ot);if(gt.position.setFromMatrixPosition(ot.matrixWorld),gt.color.copy(ut).multiplyScalar(st),gt.distance=et,gt.coneCos=Math.cos(ot.angle),gt.penumbraCos=Math.cos(ot.angle*(1-ot.penumbra)),gt.decay=ot.decay,ot.castShadow){var St=ot.shadow,Tt=c.get(ot);Tt.shadowBias=St.bias,Tt.shadowNormalBias=St.normalBias,Tt.shadowRadius=St.radius,Tt.shadowMapSize=St.mapSize,h.spotShadow[re]=Tt,h.spotShadowMap[re]=dt,h.spotShadowMatrix[re]=ot.shadow.matrix,Ue++}h.spot[re]=gt,re++}else if(ot.isRectAreaLight){var qt=d.get(ot);qt.color.copy(ut).multiplyScalar(st),qt.halfWidth.set(ot.width*.5,0,0),qt.halfHeight.set(0,ot.height*.5,0),h.rectArea[Oe]=qt,Oe++}else if(ot.isPointLight){var en=d.get(ot);if(en.color.copy(ot.color).multiplyScalar(ot.intensity),en.distance=ot.distance,en.decay=ot.decay,ot.castShadow){var _n=ot.shadow,Lt=c.get(ot);Lt.shadowBias=_n.bias,Lt.shadowNormalBias=_n.normalBias,Lt.shadowRadius=_n.radius,Lt.shadowMapSize=_n.mapSize,Lt.shadowCameraNear=_n.camera.near,Lt.shadowCameraFar=_n.camera.far,h.pointShadow[ue]=Lt,h.pointShadowMap[ue]=dt,h.pointShadowMatrix[ue]=ot.shadow.matrix,we++}h.point[ue]=en,ue++}else if(ot.isHemisphereLight){var Wn=d.get(ot);Wn.skyColor.copy(ot.color).multiplyScalar(st),Wn.groundColor.copy(ot.groundColor).multiplyScalar(st),h.hemi[He]=Wn,He++}}Oe>0&&(l.isWebGL2||p.has("OES_texture_float_linear")===!0?(h.rectAreaLTC1=ln.LTC_FLOAT_1,h.rectAreaLTC2=ln.LTC_FLOAT_2):p.has("OES_texture_half_float_linear")===!0?(h.rectAreaLTC1=ln.LTC_HALF_1,h.rectAreaLTC2=ln.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),h.ambient[0]=z,h.ambient[1]=ne,h.ambient[2]=Q;var gn=h.hash;(gn.directionalLength!==me||gn.pointLength!==ue||gn.spotLength!==re||gn.rectAreaLength!==Oe||gn.hemiLength!==He||gn.numDirectionalShadows!==Re||gn.numPointShadows!==we||gn.numSpotShadows!==Ue)&&(h.directional.length=me,h.spot.length=re,h.rectArea.length=Oe,h.point.length=ue,h.hemi.length=He,h.directionalShadow.length=Re,h.directionalShadowMap.length=Re,h.pointShadow.length=we,h.pointShadowMap.length=we,h.spotShadow.length=Ue,h.spotShadowMap.length=Ue,h.directionalShadowMatrix.length=Re,h.pointShadowMatrix.length=we,h.spotShadowMatrix.length=Ue,gn.directionalLength=me,gn.pointLength=ue,gn.spotLength=re,gn.rectAreaLength=Oe,gn.hemiLength=He,gn.numDirectionalShadows=Re,gn.numPointShadows=we,gn.numSpotShadows=Ue,h.version=mI++)}function V(G,z){for(var ne=0,Q=0,le=0,me=0,ue=0,re=z.matrixWorldInverse,Oe=0,He=G.length;Oe<He;Oe++){var Re=G[Oe];if(Re.isDirectionalLight){var we=h.directional[ne];we.direction.setFromMatrixPosition(Re.matrixWorld),_.setFromMatrixPosition(Re.target.matrixWorld),we.direction.sub(_),we.direction.transformDirection(re),ne++}else if(Re.isSpotLight){var Ue=h.spot[le];Ue.position.setFromMatrixPosition(Re.matrixWorld),Ue.position.applyMatrix4(re),Ue.direction.setFromMatrixPosition(Re.matrixWorld),_.setFromMatrixPosition(Re.target.matrixWorld),Ue.direction.sub(_),Ue.direction.transformDirection(re),le++}else if(Re.isRectAreaLight){var rt=h.rectArea[me];rt.position.setFromMatrixPosition(Re.matrixWorld),rt.position.applyMatrix4(re),O.identity(),R.copy(Re.matrixWorld),R.premultiply(re),O.extractRotation(R),rt.halfWidth.set(Re.width*.5,0,0),rt.halfHeight.set(0,Re.height*.5,0),rt.halfWidth.applyMatrix4(O),rt.halfHeight.applyMatrix4(O),me++}else if(Re.isPointLight){var nt=h.point[Q];nt.position.setFromMatrixPosition(Re.matrixWorld),nt.position.applyMatrix4(re),Q++}else if(Re.isHemisphereLight){var ot=h.hemi[ue];ot.direction.setFromMatrixPosition(Re.matrixWorld),ot.direction.transformDirection(re),ot.direction.normalize(),ue++}}}return{setup:B,setupView:V,state:h}}function CA(p,l){var d=new gI(p,l),c=[],h=[];function x(){c.length=0,h.length=0}function _(G){c.push(G)}function R(G){h.push(G)}function O(){d.setup(c)}function B(G){d.setupView(c,G)}var V={lightsArray:c,shadowsArray:h,lights:d};return{init:x,state:V,setupLights:O,setupLightsView:B,pushLight:_,pushShadow:R}}function yI(p,l){var d=new WeakMap;function c(x,_){_===void 0&&(_=0);var R;return d.has(x)===!1?(R=new CA(p,l),d.set(x,[]),d.get(x).push(R)):_>=d.get(x).length?(R=new CA(p,l),d.get(x).push(R)):R=d.get(x)[_],R}function h(){d=new WeakMap}return{get:c,dispose:h}}function cl(p){Kn.call(this),this.type="MeshDepthMaterial",this.depthPacking=Gw,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(p)}cl.prototype=Object.create(Kn.prototype),cl.prototype.constructor=cl,cl.prototype.isMeshDepthMaterial=!0,cl.prototype.copy=function(p){return Kn.prototype.copy.call(this,p),this.depthPacking=p.depthPacking,this.skinning=p.skinning,this.morphTargets=p.morphTargets,this.map=p.map,this.alphaMap=p.alphaMap,this.displacementMap=p.displacementMap,this.displacementScale=p.displacementScale,this.displacementBias=p.displacementBias,this.wireframe=p.wireframe,this.wireframeLinewidth=p.wireframeLinewidth,this};function ul(p){Kn.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Ge,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(p)}ul.prototype=Object.create(Kn.prototype),ul.prototype.constructor=ul,ul.prototype.isMeshDistanceMaterial=!0,ul.prototype.copy=function(p){return Kn.prototype.copy.call(this,p),this.referencePosition.copy(p.referencePosition),this.nearDistance=p.nearDistance,this.farDistance=p.farDistance,this.skinning=p.skinning,this.morphTargets=p.morphTargets,this.map=p.map,this.alphaMap=p.alphaMap,this.displacementMap=p.displacementMap,this.displacementScale=p.displacementScale,this.displacementBias=p.displacementBias,this};var bI=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	float mean = 0.0;
	float squared_mean = 0.0;
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );
	for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean * HALF_SAMPLE_RATE;
	squared_mean = squared_mean * HALF_SAMPLE_RATE;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`,xI=`void main() {
	gl_Position = vec4( position, 1.0 );
}`;function RA(p,l,d){var c=new vf,h=new Zt,x=new Zt,_=new Yr,R=[],O=[],B={},V={0:C,1:T,2:L},G=new wa({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new Zt},radius:{value:4}},vertexShader:xI,fragmentShader:bI}),z=G.clone();z.defines.HORIZONTAL_PASS=1;var ne=new Vn;ne.setAttribute("position",new Zn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var Q=new fi(ne,G),le=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=M,this.render=function(Re,we,Ue){if(le.enabled!==!1&&!(le.autoUpdate===!1&&le.needsUpdate===!1)&&Re.length!==0){var rt=p.getRenderTarget(),nt=p.getActiveCubeFace(),ot=p.getActiveMipmapLevel(),ut=p.state;ut.setBlending(F),ut.buffers.color.setClear(1,1,1,1),ut.buffers.depth.setTest(!0),ut.setScissorTest(!1);for(var st=0,et=Re.length;st<et;st++){var dt=Re[st],at=dt.shadow;if(at===void 0){console.warn("THREE.WebGLShadowMap:",dt,"has no shadow.");continue}if(!(at.autoUpdate===!1&&at.needsUpdate===!1)){h.copy(at.mapSize);var it=at.getFrameExtents();if(h.multiply(it),x.copy(at.mapSize),(h.x>d||h.y>d)&&(h.x>d&&(x.x=Math.floor(d/it.x),h.x=x.x*it.x,at.mapSize.x=x.x),h.y>d&&(x.y=Math.floor(d/it.y),h.y=x.y*it.y,at.mapSize.y=x.y)),at.map===null&&!at.isPointLightShadow&&this.type===E){var Ke={minFilter:Ft,magFilter:Ft,format:pn};at.map=new Js(h.x,h.y,Ke),at.map.texture.name=dt.name+".shadowMap",at.mapPass=new Js(h.x,h.y,Ke),at.camera.updateProjectionMatrix()}if(at.map===null){var vt={minFilter:Jt,magFilter:Jt,format:pn};at.map=new Js(h.x,h.y,vt),at.map.texture.name=dt.name+".shadowMap",at.camera.updateProjectionMatrix()}p.setRenderTarget(at.map),p.clear();for(var gt=at.getViewportCount(),St=0;St<gt;St++){var Tt=at.getViewport(St);_.set(x.x*Tt.x,x.y*Tt.y,x.x*Tt.z,x.y*Tt.w),ut.viewport(_),at.updateMatrices(dt,St),c=at.getFrustum(),He(we,Ue,at.camera,dt,this.type)}!at.isPointLightShadow&&this.type===E&&me(at,Ue),at.needsUpdate=!1}}le.needsUpdate=!1,p.setRenderTarget(rt,nt,ot)}};function me(Re,we){var Ue=l.update(Q);G.uniforms.shadow_pass.value=Re.map.texture,G.uniforms.resolution.value=Re.mapSize,G.uniforms.radius.value=Re.radius,p.setRenderTarget(Re.mapPass),p.clear(),p.renderBufferDirect(we,null,Ue,G,Q,null),z.uniforms.shadow_pass.value=Re.mapPass.texture,z.uniforms.resolution.value=Re.mapSize,z.uniforms.radius.value=Re.radius,p.setRenderTarget(Re.map),p.clear(),p.renderBufferDirect(we,null,Ue,z,Q,null)}function ue(Re,we,Ue){var rt=Re<<0|we<<1|Ue<<2,nt=R[rt];return nt===void 0&&(nt=new cl({depthPacking:Vw,morphTargets:Re,skinning:we}),R[rt]=nt),nt}function re(Re,we,Ue){var rt=Re<<0|we<<1|Ue<<2,nt=O[rt];return nt===void 0&&(nt=new ul({morphTargets:Re,skinning:we}),O[rt]=nt),nt}function Oe(Re,we,Ue,rt,nt,ot,ut){var st=null,et=ue,dt=Re.customDepthMaterial;if(rt.isPointLight===!0&&(et=re,dt=Re.customDistanceMaterial),dt===void 0){var at=!1;Ue.morphTargets===!0&&(at=we.morphAttributes&&we.morphAttributes.position&&we.morphAttributes.position.length>0);var it=!1;Re.isSkinnedMesh===!0&&(Ue.skinning===!0?it=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",Re));var Ke=Re.isInstancedMesh===!0;st=et(at,it,Ke)}else st=dt;if(p.localClippingEnabled&&Ue.clipShadows===!0&&Ue.clippingPlanes.length!==0){var vt=st.uuid,gt=Ue.uuid,St=B[vt];St===void 0&&(St={},B[vt]=St);var Tt=St[gt];Tt===void 0&&(Tt=st.clone(),St[gt]=Tt),st=Tt}return st.visible=Ue.visible,st.wireframe=Ue.wireframe,ut===E?st.side=Ue.shadowSide!==null?Ue.shadowSide:Ue.side:st.side=Ue.shadowSide!==null?Ue.shadowSide:V[Ue.side],st.clipShadows=Ue.clipShadows,st.clippingPlanes=Ue.clippingPlanes,st.clipIntersection=Ue.clipIntersection,st.wireframeLinewidth=Ue.wireframeLinewidth,st.linewidth=Ue.linewidth,rt.isPointLight===!0&&st.isMeshDistanceMaterial===!0&&(st.referencePosition.setFromMatrixPosition(rt.matrixWorld),st.nearDistance=nt,st.farDistance=ot),st}function He(Re,we,Ue,rt,nt){if(Re.visible!==!1){var ot=Re.layers.test(we.layers);if(ot&&(Re.isMesh||Re.isLine||Re.isPoints)&&(Re.castShadow||Re.receiveShadow&&nt===E)&&(!Re.frustumCulled||c.intersectsObject(Re))){Re.modelViewMatrix.multiplyMatrices(Ue.matrixWorldInverse,Re.matrixWorld);var ut=l.update(Re),st=Re.material;if(Array.isArray(st))for(var et=ut.groups,dt=0,at=et.length;dt<at;dt++){var it=et[dt],Ke=st[it.materialIndex];if(Ke&&Ke.visible){var vt=Oe(Re,ut,Ke,rt,Ue.near,Ue.far,nt);p.renderBufferDirect(Ue,null,ut,vt,Re,it)}}else if(st.visible){var gt=Oe(Re,ut,st,rt,Ue.near,Ue.far,nt);p.renderBufferDirect(Ue,null,ut,gt,Re,null)}}for(var St=Re.children,Tt=0,qt=St.length;Tt<qt;Tt++)He(St[Tt],we,Ue,rt,nt)}}}function wI(p,l,d){var c,h,x=d.isWebGL2;function _(){var xt=!1,Mn=new Yr,wn=null,Yn=new Yr(0,0,0,0);return{setMask:function(tn){wn!==tn&&!xt&&(p.colorMask(tn,tn,tn,tn),wn=tn)},setLocked:function(tn){xt=tn},setClear:function(tn,lr,yr,Ai,oi){oi===!0&&(tn*=Ai,lr*=Ai,yr*=Ai),Mn.set(tn,lr,yr,Ai),Yn.equals(Mn)===!1&&(p.clearColor(tn,lr,yr,Ai),Yn.copy(Mn))},reset:function(){xt=!1,wn=null,Yn.set(-1,0,0,0)}}}function R(){var xt=!1,Mn=null,wn=null,Yn=null;return{setTest:function(tn){tn?qt(2929):en(2929)},setMask:function(tn){Mn!==tn&&!xt&&(p.depthMask(tn),Mn=tn)},setFunc:function(tn){if(wn!==tn){if(tn)switch(tn){case mt:p.depthFunc(512);break;case ht:p.depthFunc(519);break;case ye:p.depthFunc(513);break;case fe:p.depthFunc(515);break;case H:p.depthFunc(514);break;case j:p.depthFunc(518);break;case q:p.depthFunc(516);break;case pe:p.depthFunc(517);break;default:p.depthFunc(515)}else p.depthFunc(515);wn=tn}},setLocked:function(tn){xt=tn},setClear:function(tn){Yn!==tn&&(p.clearDepth(tn),Yn=tn)},reset:function(){xt=!1,Mn=null,wn=null,Yn=null}}}function O(){var xt=!1,Mn=null,wn=null,Yn=null,yn=null,tn=null,lr=null,yr=null,Ai=null;return{setTest:function(Br){xt||(Br?qt(2960):en(2960))},setMask:function(Br){Mn!==Br&&!xt&&(p.stencilMask(Br),Mn=Br)},setFunc:function(Br,Wr,Oi){(wn!==Br||Yn!==Wr||yn!==Oi)&&(p.stencilFunc(Br,Wr,Oi),wn=Br,Yn=Wr,yn=Oi)},setOp:function(Br,Wr,Oi){(tn!==Br||lr!==Wr||yr!==Oi)&&(p.stencilOp(Br,Wr,Oi),tn=Br,lr=Wr,yr=Oi)},setLocked:function(Br){xt=Br},setClear:function(Br){Ai!==Br&&(p.clearStencil(Br),Ai=Br)},reset:function(){xt=!1,Mn=null,wn=null,Yn=null,yn=null,tn=null,lr=null,yr=null,Ai=null}}}var B=new _,V=new R,G=new O,z={},ne=null,Q=null,le=null,me=null,ue=null,re=null,Oe=null,He=null,Re=null,we=!1,Ue=null,rt=null,nt=null,ot=null,ut=null,st=p.getParameter(35661),et=!1,dt=0,at=p.getParameter(7938);at.indexOf("WebGL")!==-1?(dt=parseFloat(/^WebGL (\d)/.exec(at)[1]),et=dt>=1):at.indexOf("OpenGL ES")!==-1&&(dt=parseFloat(/^OpenGL ES (\d)/.exec(at)[1]),et=dt>=2);var it=null,Ke={},vt=new Yr,gt=new Yr;function St(xt,Mn,wn){var Yn=new Uint8Array(4),yn=p.createTexture();p.bindTexture(xt,yn),p.texParameteri(xt,10241,9728),p.texParameteri(xt,10240,9728);for(var tn=0;tn<wn;tn++)p.texImage2D(Mn+tn,0,6408,1,1,0,6408,5121,Yn);return yn}var Tt={};Tt[3553]=St(3553,3553,1),Tt[34067]=St(34067,34069,6),B.setClear(0,0,0,1),V.setClear(1),G.setClear(0),qt(2929),V.setFunc(fe),gr(!1),sr(y),qt(2884),qn(F);function qt(xt){z[xt]!==!0&&(p.enable(xt),z[xt]=!0)}function en(xt){z[xt]!==!1&&(p.disable(xt),z[xt]=!1)}function _n(xt){return ne!==xt?(p.useProgram(xt),ne=xt,!0):!1}var Lt=(c={},c[D]=32774,c[I]=32778,c[k]=32779,c);if(x)Lt[U]=32775,Lt[W]=32776;else{var Wn=l.get("EXT_blend_minmax");Wn!==null&&(Lt[U]=Wn.MIN_EXT,Lt[W]=Wn.MAX_EXT)}var gn=(h={},h[ce]=0,h[oe]=1,h[ge]=768,h[Ne]=770,h[Qe]=776,h[Fe]=774,h[Ve]=772,h[_e]=769,h[Ie]=771,h[Me]=775,h[Le]=773,h);function qn(xt,Mn,wn,Yn,yn,tn,lr,yr){if(xt===F){Q&&(en(3042),Q=!1);return}if(Q||(qt(3042),Q=!0),xt!==de){if(xt!==le||yr!==we){if((me!==D||Oe!==D)&&(p.blendEquation(32774),me=D,Oe=D),yr)switch(xt){case X:p.blendFuncSeparate(1,771,1,771);break;case Y:p.blendFunc(1,1);break;case ae:p.blendFuncSeparate(0,0,769,771);break;case $:p.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",xt);break}else switch(xt){case X:p.blendFuncSeparate(770,771,1,771);break;case Y:p.blendFunc(770,1);break;case ae:p.blendFunc(0,769);break;case $:p.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",xt);break}ue=null,re=null,He=null,Re=null,le=xt,we=yr}return}yn=yn||Mn,tn=tn||wn,lr=lr||Yn,(Mn!==me||yn!==Oe)&&(p.blendEquationSeparate(Lt[Mn],Lt[yn]),me=Mn,Oe=yn),(wn!==ue||Yn!==re||tn!==He||lr!==Re)&&(p.blendFuncSeparate(gn[wn],gn[Yn],gn[tn],gn[lr]),ue=wn,re=Yn,He=tn,Re=lr),le=xt,we=null}function ar(xt,Mn){xt.side===L?en(2884):qt(2884);var wn=xt.side===C;Mn&&(wn=!wn),gr(wn),xt.blending===X&&xt.transparent===!1?qn(F):qn(xt.blending,xt.blendEquation,xt.blendSrc,xt.blendDst,xt.blendEquationAlpha,xt.blendSrcAlpha,xt.blendDstAlpha,xt.premultipliedAlpha),V.setFunc(xt.depthFunc),V.setTest(xt.depthTest),V.setMask(xt.depthWrite),B.setMask(xt.colorWrite);var Yn=xt.stencilWrite;G.setTest(Yn),Yn&&(G.setMask(xt.stencilWriteMask),G.setFunc(xt.stencilFunc,xt.stencilRef,xt.stencilFuncMask),G.setOp(xt.stencilFail,xt.stencilZFail,xt.stencilZPass)),Or(xt.polygonOffset,xt.polygonOffsetFactor,xt.polygonOffsetUnits)}function gr(xt){Ue!==xt&&(xt?p.frontFace(2304):p.frontFace(2305),Ue=xt)}function sr(xt){xt!==g?(qt(2884),xt!==rt&&(xt===y?p.cullFace(1029):xt===b?p.cullFace(1028):p.cullFace(1032))):en(2884),rt=xt}function ai(xt){xt!==nt&&(et&&p.lineWidth(xt),nt=xt)}function Or(xt,Mn,wn){xt?(qt(32823),(ot!==Mn||ut!==wn)&&(p.polygonOffset(Mn,wn),ot=Mn,ut=wn)):en(32823)}function $r(xt){xt?qt(3089):en(3089)}function Di(xt){xt===void 0&&(xt=33984+st-1),it!==xt&&(p.activeTexture(xt),it=xt)}function sa(xt,Mn){it===null&&Di();var wn=Ke[it];wn===void 0&&(wn={type:void 0,texture:void 0},Ke[it]=wn),(wn.type!==xt||wn.texture!==Mn)&&(p.bindTexture(xt,Mn||Tt[xt]),wn.type=xt,wn.texture=Mn)}function Wi(){var xt=Ke[it];xt!==void 0&&xt.type!==void 0&&(p.bindTexture(xt.type,null),xt.type=void 0,xt.texture=void 0)}function Ti(){try{p.compressedTexImage2D.apply(p,arguments)}catch(xt){console.error("THREE.WebGLState:",xt)}}function lt(){try{p.texImage2D.apply(p,arguments)}catch(xt){console.error("THREE.WebGLState:",xt)}}function tt(){try{p.texImage3D.apply(p,arguments)}catch(xt){console.error("THREE.WebGLState:",xt)}}function dn(xt){vt.equals(xt)===!1&&(p.scissor(xt.x,xt.y,xt.z,xt.w),vt.copy(xt))}function an(xt){gt.equals(xt)===!1&&(p.viewport(xt.x,xt.y,xt.z,xt.w),gt.copy(xt))}function rr(){z={},it=null,Ke={},ne=null,Q=null,le=null,me=null,ue=null,re=null,Oe=null,He=null,Re=null,we=!1,Ue=null,rt=null,nt=null,ot=null,ut=null,B.reset(),V.reset(),G.reset()}return{buffers:{color:B,depth:V,stencil:G},enable:qt,disable:en,useProgram:_n,setBlending:qn,setMaterial:ar,setFlipSided:gr,setCullFace:sr,setLineWidth:ai,setPolygonOffset:Or,setScissorTest:$r,activeTexture:Di,bindTexture:sa,unbindTexture:Wi,compressedTexImage2D:Ti,texImage2D:lt,texImage3D:tt,scissor:dn,viewport:an,reset:rr}}function AI(p,l,d,c,h,x,_){var R,O,B=h.isWebGL2,V=h.maxTextures,G=h.maxCubemapSize,z=h.maxTextureSize,ne=h.maxSamples,Q=new WeakMap,le,me=!1;try{me=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function ue(lt,tt){return me?new OffscreenCanvas(lt,tt):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function re(lt,tt,dn,an){var rr=1;if((lt.width>an||lt.height>an)&&(rr=an/Math.max(lt.width,lt.height)),rr<1||tt===!0)if(typeof HTMLImageElement!="undefined"&&lt instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&lt instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&lt instanceof ImageBitmap){var xt=tt?er.floorPowerOfTwo:Math.floor,Mn=xt(rr*lt.width),wn=xt(rr*lt.height);le===void 0&&(le=ue(Mn,wn));var Yn=dn?ue(Mn,wn):le;Yn.width=Mn,Yn.height=wn;var yn=Yn.getContext("2d");return yn.drawImage(lt,0,0,Mn,wn),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+lt.width+"x"+lt.height+") to ("+Mn+"x"+wn+")."),Yn}else return"data"in lt&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+lt.width+"x"+lt.height+")."),lt;return lt}function Oe(lt){return er.isPowerOfTwo(lt.width)&&er.isPowerOfTwo(lt.height)}function He(lt){return B?!1:lt.wrapS!==Yt||lt.wrapT!==Yt||lt.minFilter!==Jt&&lt.minFilter!==Ft}function Re(lt,tt){return lt.generateMipmaps&&tt&&lt.minFilter!==Jt&&lt.minFilter!==Ft}function we(lt,tt,dn,an){p.generateMipmap(lt);var rr=c.get(tt);rr.__maxMipLevel=Math.log(Math.max(dn,an))*Math.LOG2E}function Ue(lt,tt,dn){if(B===!1)return tt;if(lt!==null){if(p[lt]!==void 0)return p[lt];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+lt+"'")}var an=tt;return tt===6403&&(dn===5126&&(an=33326),dn===5131&&(an=33325),dn===5121&&(an=33321)),tt===6407&&(dn===5126&&(an=34837),dn===5131&&(an=34843),dn===5121&&(an=32849)),tt===6408&&(dn===5126&&(an=34836),dn===5131&&(an=34842),dn===5121&&(an=32856)),(an===33325||an===33326||an===34842||an===34836)&&l.get("EXT_color_buffer_float"),an}function rt(lt){return lt===Jt||lt===Fn||lt===fr?9728:9729}function nt(lt){var tt=lt.target;tt.removeEventListener("dispose",nt),ut(tt),tt.isVideoTexture&&Q.delete(tt),_.memory.textures--}function ot(lt){var tt=lt.target;tt.removeEventListener("dispose",ot),st(tt),_.memory.textures--}function ut(lt){var tt=c.get(lt);tt.__webglInit!==void 0&&(p.deleteTexture(tt.__webglTexture),c.remove(lt))}function st(lt){var tt=c.get(lt),dn=c.get(lt.texture);if(!!lt){if(dn.__webglTexture!==void 0&&p.deleteTexture(dn.__webglTexture),lt.depthTexture&&lt.depthTexture.dispose(),lt.isWebGLCubeRenderTarget)for(var an=0;an<6;an++)p.deleteFramebuffer(tt.__webglFramebuffer[an]),tt.__webglDepthbuffer&&p.deleteRenderbuffer(tt.__webglDepthbuffer[an]);else p.deleteFramebuffer(tt.__webglFramebuffer),tt.__webglDepthbuffer&&p.deleteRenderbuffer(tt.__webglDepthbuffer),tt.__webglMultisampledFramebuffer&&p.deleteFramebuffer(tt.__webglMultisampledFramebuffer),tt.__webglColorRenderbuffer&&p.deleteRenderbuffer(tt.__webglColorRenderbuffer),tt.__webglDepthRenderbuffer&&p.deleteRenderbuffer(tt.__webglDepthRenderbuffer);c.remove(lt.texture),c.remove(lt)}}var et=0;function dt(){et=0}function at(){var lt=et;return lt>=V&&console.warn("THREE.WebGLTextures: Trying to use "+lt+" texture units while this GPU supports only "+V),et+=1,lt}function it(lt,tt){var dn=c.get(lt);if(lt.isVideoTexture&&$r(lt),lt.version>0&&dn.__version!==lt.version){var an=lt.image;if(an===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(an.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{_n(dn,lt,tt);return}}d.activeTexture(33984+tt),d.bindTexture(3553,dn.__webglTexture)}function Ke(lt,tt){var dn=c.get(lt);if(lt.version>0&&dn.__version!==lt.version){_n(dn,lt,tt);return}d.activeTexture(33984+tt),d.bindTexture(35866,dn.__webglTexture)}function vt(lt,tt){var dn=c.get(lt);if(lt.version>0&&dn.__version!==lt.version){_n(dn,lt,tt);return}d.activeTexture(33984+tt),d.bindTexture(32879,dn.__webglTexture)}function gt(lt,tt){var dn=c.get(lt);if(lt.version>0&&dn.__version!==lt.version){Lt(dn,lt,tt);return}d.activeTexture(33984+tt),d.bindTexture(34067,dn.__webglTexture)}var St=(R={},R[rn]=10497,R[Yt]=33071,R[Tn]=33648,R),Tt=(O={},O[Jt]=9728,O[Fn]=9984,O[fr]=9986,O[Ft]=9729,O[$t]=9985,O[In]=9987,O);function qt(lt,tt,dn){dn?(p.texParameteri(lt,10242,St[tt.wrapS]),p.texParameteri(lt,10243,St[tt.wrapT]),(lt===32879||lt===35866)&&p.texParameteri(lt,32882,St[tt.wrapR]),p.texParameteri(lt,10240,Tt[tt.magFilter]),p.texParameteri(lt,10241,Tt[tt.minFilter])):(p.texParameteri(lt,10242,33071),p.texParameteri(lt,10243,33071),(lt===32879||lt===35866)&&p.texParameteri(lt,32882,33071),(tt.wrapS!==Yt||tt.wrapT!==Yt)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),p.texParameteri(lt,10240,rt(tt.magFilter)),p.texParameteri(lt,10241,rt(tt.minFilter)),tt.minFilter!==Jt&&tt.minFilter!==Ft&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));var an=l.get("EXT_texture_filter_anisotropic");if(an){if(tt.type===vr&&l.get("OES_texture_float_linear")===null||tt.type===je&&(B||l.get("OES_texture_half_float_linear"))===null)return;(tt.anisotropy>1||c.get(tt).__currentAnisotropy)&&(p.texParameterf(lt,an.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(tt.anisotropy,h.getMaxAnisotropy())),c.get(tt).__currentAnisotropy=tt.anisotropy)}}function en(lt,tt){lt.__webglInit===void 0&&(lt.__webglInit=!0,tt.addEventListener("dispose",nt),lt.__webglTexture=p.createTexture(),_.memory.textures++)}function _n(lt,tt,dn){var an=3553;tt.isDataTexture2DArray&&(an=35866),tt.isDataTexture3D&&(an=32879),en(lt,tt),d.activeTexture(33984+dn),d.bindTexture(an,lt.__webglTexture),p.pixelStorei(37440,tt.flipY),p.pixelStorei(37441,tt.premultiplyAlpha),p.pixelStorei(3317,tt.unpackAlignment);var rr=He(tt)&&Oe(tt.image)===!1,xt=re(tt.image,rr,!1,z),Mn=Oe(xt)||B,wn=x.convert(tt.format),Yn=x.convert(tt.type),yn=Ue(tt.internalFormat,wn,Yn);qt(an,tt,Mn);var tn,lr=tt.mipmaps;if(tt.isDepthTexture)yn=6402,B?tt.type===vr?yn=36012:tt.type===Lr?yn=33190:tt.type===Gt?yn=35056:yn=33189:tt.type===vr&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),tt.format===bt&&yn===6402&&tt.type!==cr&&tt.type!==Lr&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),tt.type=cr,Yn=x.convert(tt.type)),tt.format===yt&&yn===6402&&(yn=34041,tt.type!==Gt&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),tt.type=Gt,Yn=x.convert(tt.type))),d.texImage2D(3553,0,yn,xt.width,xt.height,0,wn,Yn,null);else if(tt.isDataTexture)if(lr.length>0&&Mn){for(var yr=0,Ai=lr.length;yr<Ai;yr++)tn=lr[yr],d.texImage2D(3553,yr,yn,tn.width,tn.height,0,wn,Yn,tn.data);tt.generateMipmaps=!1,lt.__maxMipLevel=lr.length-1}else d.texImage2D(3553,0,yn,xt.width,xt.height,0,wn,Yn,xt.data),lt.__maxMipLevel=0;else if(tt.isCompressedTexture){for(var oi=0,Br=lr.length;oi<Br;oi++)tn=lr[oi],tt.format!==pn&&tt.format!==Sn?wn!==null?d.compressedTexImage2D(3553,oi,yn,tn.width,tn.height,0,tn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):d.texImage2D(3553,oi,yn,tn.width,tn.height,0,wn,Yn,tn.data);lt.__maxMipLevel=lr.length-1}else if(tt.isDataTexture2DArray)d.texImage3D(35866,0,yn,xt.width,xt.height,xt.depth,0,wn,Yn,xt.data),lt.__maxMipLevel=0;else if(tt.isDataTexture3D)d.texImage3D(32879,0,yn,xt.width,xt.height,xt.depth,0,wn,Yn,xt.data),lt.__maxMipLevel=0;else if(lr.length>0&&Mn){for(var Wr=0,Oi=lr.length;Wr<Oi;Wr++)tn=lr[Wr],d.texImage2D(3553,Wr,yn,wn,Yn,tn);tt.generateMipmaps=!1,lt.__maxMipLevel=lr.length-1}else d.texImage2D(3553,0,yn,wn,Yn,xt),lt.__maxMipLevel=0;Re(tt,Mn)&&we(an,tt,xt.width,xt.height),lt.__version=tt.version,tt.onUpdate&&tt.onUpdate(tt)}function Lt(lt,tt,dn){if(tt.image.length===6){en(lt,tt),d.activeTexture(33984+dn),d.bindTexture(34067,lt.__webglTexture),p.pixelStorei(37440,tt.flipY),p.pixelStorei(37441,tt.premultiplyAlpha),p.pixelStorei(3317,tt.unpackAlignment);for(var an=tt&&(tt.isCompressedTexture||tt.image[0].isCompressedTexture),rr=tt.image[0]&&tt.image[0].isDataTexture,xt=[],Mn=0;Mn<6;Mn++)!an&&!rr?xt[Mn]=re(tt.image[Mn],!1,!0,G):xt[Mn]=rr?tt.image[Mn].image:tt.image[Mn];var wn=xt[0],Yn=Oe(wn)||B,yn=x.convert(tt.format),tn=x.convert(tt.type),lr=Ue(tt.internalFormat,yn,tn);qt(34067,tt,Yn);var yr;if(an){for(var Ai=0;Ai<6;Ai++){yr=xt[Ai].mipmaps;for(var oi=0;oi<yr.length;oi++){var Br=yr[oi];tt.format!==pn&&tt.format!==Sn?yn!==null?d.compressedTexImage2D(34069+Ai,oi,lr,Br.width,Br.height,0,Br.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):d.texImage2D(34069+Ai,oi,lr,Br.width,Br.height,0,yn,tn,Br.data)}}lt.__maxMipLevel=yr.length-1}else{yr=tt.mipmaps;for(var Wr=0;Wr<6;Wr++)if(rr){d.texImage2D(34069+Wr,0,lr,xt[Wr].width,xt[Wr].height,0,yn,tn,xt[Wr].data);for(var Oi=0;Oi<yr.length;Oi++){var Nu=yr[Oi],wl=Nu.image[Wr].image;d.texImage2D(34069+Wr,Oi+1,lr,wl.width,wl.height,0,yn,tn,wl.data)}}else{d.texImage2D(34069+Wr,0,lr,yn,tn,xt[Wr]);for(var Ro=0;Ro<yr.length;Ro++){var Cs=yr[Ro];d.texImage2D(34069+Wr,Ro+1,lr,yn,tn,Cs.image[Wr])}}lt.__maxMipLevel=yr.length}Re(tt,Yn)&&we(34067,tt,wn.width,wn.height),lt.__version=tt.version,tt.onUpdate&&tt.onUpdate(tt)}}function Wn(lt,tt,dn,an){var rr=x.convert(tt.texture.format),xt=x.convert(tt.texture.type),Mn=Ue(tt.texture.internalFormat,rr,xt);d.texImage2D(an,0,Mn,tt.width,tt.height,0,rr,xt,null),p.bindFramebuffer(36160,lt),p.framebufferTexture2D(36160,dn,an,c.get(tt.texture).__webglTexture,0),p.bindFramebuffer(36160,null)}function gn(lt,tt,dn){if(p.bindRenderbuffer(36161,lt),tt.depthBuffer&&!tt.stencilBuffer){var an=33189;if(dn){var rr=tt.depthTexture;rr&&rr.isDepthTexture&&(rr.type===vr?an=36012:rr.type===Lr&&(an=33190));var xt=Or(tt);p.renderbufferStorageMultisample(36161,xt,an,tt.width,tt.height)}else p.renderbufferStorage(36161,an,tt.width,tt.height);p.framebufferRenderbuffer(36160,36096,36161,lt)}else if(tt.depthBuffer&&tt.stencilBuffer){if(dn){var Mn=Or(tt);p.renderbufferStorageMultisample(36161,Mn,35056,tt.width,tt.height)}else p.renderbufferStorage(36161,34041,tt.width,tt.height);p.framebufferRenderbuffer(36160,33306,36161,lt)}else{var wn=x.convert(tt.texture.format),Yn=x.convert(tt.texture.type),yn=Ue(tt.texture.internalFormat,wn,Yn);if(dn){var tn=Or(tt);p.renderbufferStorageMultisample(36161,tn,yn,tt.width,tt.height)}else p.renderbufferStorage(36161,yn,tt.width,tt.height)}p.bindRenderbuffer(36161,null)}function qn(lt,tt){var dn=tt&&tt.isWebGLCubeRenderTarget;if(dn)throw new Error("Depth Texture with cube render targets is not supported");if(p.bindFramebuffer(36160,lt),!(tt.depthTexture&&tt.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!c.get(tt.depthTexture).__webglTexture||tt.depthTexture.image.width!==tt.width||tt.depthTexture.image.height!==tt.height)&&(tt.depthTexture.image.width=tt.width,tt.depthTexture.image.height=tt.height,tt.depthTexture.needsUpdate=!0),it(tt.depthTexture,0);var an=c.get(tt.depthTexture).__webglTexture;if(tt.depthTexture.format===bt)p.framebufferTexture2D(36160,36096,3553,an,0);else if(tt.depthTexture.format===yt)p.framebufferTexture2D(36160,33306,3553,an,0);else throw new Error("Unknown depthTexture format")}function ar(lt){var tt=c.get(lt),dn=lt.isWebGLCubeRenderTarget===!0;if(lt.depthTexture){if(dn)throw new Error("target.depthTexture not supported in Cube render targets");qn(tt.__webglFramebuffer,lt)}else if(dn){tt.__webglDepthbuffer=[];for(var an=0;an<6;an++)p.bindFramebuffer(36160,tt.__webglFramebuffer[an]),tt.__webglDepthbuffer[an]=p.createRenderbuffer(),gn(tt.__webglDepthbuffer[an],lt,!1)}else p.bindFramebuffer(36160,tt.__webglFramebuffer),tt.__webglDepthbuffer=p.createRenderbuffer(),gn(tt.__webglDepthbuffer,lt,!1);p.bindFramebuffer(36160,null)}function gr(lt){var tt=c.get(lt),dn=c.get(lt.texture);lt.addEventListener("dispose",ot),dn.__webglTexture=p.createTexture(),_.memory.textures++;var an=lt.isWebGLCubeRenderTarget===!0,rr=lt.isWebGLMultisampleRenderTarget===!0,xt=Oe(lt)||B;if(B&&lt.texture.format===Sn&&(lt.texture.type===vr||lt.texture.type===je)&&(lt.texture.format=pn,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),an){tt.__webglFramebuffer=[];for(var Mn=0;Mn<6;Mn++)tt.__webglFramebuffer[Mn]=p.createFramebuffer()}else if(tt.__webglFramebuffer=p.createFramebuffer(),rr)if(B){tt.__webglMultisampledFramebuffer=p.createFramebuffer(),tt.__webglColorRenderbuffer=p.createRenderbuffer(),p.bindRenderbuffer(36161,tt.__webglColorRenderbuffer);var wn=x.convert(lt.texture.format),Yn=x.convert(lt.texture.type),yn=Ue(lt.texture.internalFormat,wn,Yn),tn=Or(lt);p.renderbufferStorageMultisample(36161,tn,yn,lt.width,lt.height),p.bindFramebuffer(36160,tt.__webglMultisampledFramebuffer),p.framebufferRenderbuffer(36160,36064,36161,tt.__webglColorRenderbuffer),p.bindRenderbuffer(36161,null),lt.depthBuffer&&(tt.__webglDepthRenderbuffer=p.createRenderbuffer(),gn(tt.__webglDepthRenderbuffer,lt,!0)),p.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(an){d.bindTexture(34067,dn.__webglTexture),qt(34067,lt.texture,xt);for(var lr=0;lr<6;lr++)Wn(tt.__webglFramebuffer[lr],lt,36064,34069+lr);Re(lt.texture,xt)&&we(34067,lt.texture,lt.width,lt.height),d.bindTexture(34067,null)}else d.bindTexture(3553,dn.__webglTexture),qt(3553,lt.texture,xt),Wn(tt.__webglFramebuffer,lt,36064,3553),Re(lt.texture,xt)&&we(3553,lt.texture,lt.width,lt.height),d.bindTexture(3553,null);lt.depthBuffer&&ar(lt)}function sr(lt){var tt=lt.texture,dn=Oe(lt)||B;if(Re(tt,dn)){var an=lt.isWebGLCubeRenderTarget?34067:3553,rr=c.get(tt).__webglTexture;d.bindTexture(an,rr),we(an,tt,lt.width,lt.height),d.bindTexture(an,null)}}function ai(lt){if(lt.isWebGLMultisampleRenderTarget)if(B){var tt=c.get(lt);p.bindFramebuffer(36008,tt.__webglMultisampledFramebuffer),p.bindFramebuffer(36009,tt.__webglFramebuffer);var dn=lt.width,an=lt.height,rr=16384;lt.depthBuffer&&(rr|=256),lt.stencilBuffer&&(rr|=1024),p.blitFramebuffer(0,0,dn,an,0,0,dn,an,rr,9728),p.bindFramebuffer(36160,tt.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}function Or(lt){return B&&lt.isWebGLMultisampleRenderTarget?Math.min(ne,lt.samples):0}function $r(lt){var tt=_.render.frame;Q.get(lt)!==tt&&(Q.set(lt,tt),lt.update())}var Di=!1,sa=!1;function Wi(lt,tt){lt&&lt.isWebGLRenderTarget&&(Di===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),Di=!0),lt=lt.texture),it(lt,tt)}function Ti(lt,tt){lt&&lt.isWebGLCubeRenderTarget&&(sa===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),sa=!0),lt=lt.texture),gt(lt,tt)}this.allocateTextureUnit=at,this.resetTextureUnits=dt,this.setTexture2D=it,this.setTexture2DArray=Ke,this.setTexture3D=vt,this.setTextureCube=gt,this.setupRenderTarget=gr,this.updateRenderTargetMipmap=sr,this.updateMultisampleRenderTarget=ai,this.safeSetTexture2D=Wi,this.safeSetTextureCube=Ti}function LA(p,l,d){var c=d.isWebGL2;function h(x){var _;if(x===bn)return 5121;if(x===_t)return 32819;if(x===Ot)return 32820;if(x===At)return 33635;if(x===Jn)return 5120;if(x===Er)return 5122;if(x===cr)return 5123;if(x===gi)return 5124;if(x===Lr)return 5125;if(x===vr)return 5126;if(x===je)return c?5131:(_=l.get("OES_texture_half_float"),_!==null?_.HALF_FLOAT_OES:null);if(x===En)return 6406;if(x===Sn)return 6407;if(x===pn)return 6408;if(x===De)return 6409;if(x===Ye)return 6410;if(x===bt)return 6402;if(x===yt)return 34041;if(x===zt)return 6403;if(x===kt)return 36244;if(x===sn)return 33319;if(x===jt)return 33320;if(x===Nt)return 36248;if(x===mn)return 36249;if(x===An||x===Cn||x===Gn||x===tr)if(_=l.get("WEBGL_compressed_texture_s3tc"),_!==null){if(x===An)return _.COMPRESSED_RGB_S3TC_DXT1_EXT;if(x===Cn)return _.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(x===Gn)return _.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(x===tr)return _.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(x===Rn||x===_r||x===Nr||x===Fi)if(_=l.get("WEBGL_compressed_texture_pvrtc"),_!==null){if(x===Rn)return _.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(x===_r)return _.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(x===Nr)return _.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(x===Fi)return _.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(x===Xn)return _=l.get("WEBGL_compressed_texture_etc1"),_!==null?_.COMPRESSED_RGB_ETC1_WEBGL:null;if((x===dr||x===ur)&&(_=l.get("WEBGL_compressed_texture_etc"),_!==null)){if(x===dr)return _.COMPRESSED_RGB8_ETC2;if(x===ur)return _.COMPRESSED_RGBA8_ETC2_EAC}if(x===$i||x===qr||x===Qr||x===Z||x===ie||x===be||x===Ae||x===ze||x===ft||x===Ct||x===Xt||x===Et||x===wt||x===se||x===Te||x===Pe||x===Ce||x===pt||x===Rt||x===Bt||x===Kt||x===hn||x===Qt||x===on||x===$n||x===kn||x===Un||x===fn)return _=l.get("WEBGL_compressed_texture_astc"),_!==null?x:null;if(x===he)return _=l.get("EXT_texture_compression_bptc"),_!==null?x:null;if(x===Gt)return c?34042:(_=l.get("WEBGL_depth_texture"),_!==null?_.UNSIGNED_INT_24_8_WEBGL:null)}return{convert:h}}function Es(){Dn.call(this),this.type="Group"}Es.prototype=Object.assign(Object.create(Dn.prototype),{constructor:Es,isGroup:!0});function xf(p){p===void 0&&(p=[]),Mi.call(this),this.cameras=p}xf.prototype=Object.assign(Object.create(Mi.prototype),{constructor:xf,isArrayCamera:!0});var PA=new Ge,DA=new Ge;function EI(p,l,d){PA.setFromMatrixPosition(l.matrixWorld),DA.setFromMatrixPosition(d.matrixWorld);var c=PA.distanceTo(DA),h=l.projectionMatrix.elements,x=d.projectionMatrix.elements,_=h[14]/(h[10]-1),R=h[14]/(h[10]+1),O=(h[9]+1)/h[5],B=(h[9]-1)/h[5],V=(h[8]-1)/h[0],G=(x[8]+1)/x[0],z=_*V,ne=_*G,Q=c/(-V+G),le=Q*-V;l.matrixWorld.decompose(p.position,p.quaternion,p.scale),p.translateX(le),p.translateZ(Q),p.matrixWorld.compose(p.position,p.quaternion,p.scale),p.matrixWorldInverse.getInverse(p.matrixWorld);var me=_+Q,ue=R+Q,re=z-le,Oe=ne+(c-le),He=O*R/ue*me,Re=B*R/ue*me;p.projectionMatrix.makePerspective(re,Oe,He,Re,me,ue)}function OA(p){var l,d,c=this,h=null,x=null,_=null,R=[],O=new br,B=new br,V=1,G="local-floor";typeof window!="undefined"&&"VRFrameData"in window&&(x=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",He,!1));var z=new br,ne=new Zi,Q=new Ge,le=new Mi;le.viewport=new Yr,le.layers.enable(1);var me=new Mi;me.viewport=new Yr,me.layers.enable(2);var ue=new xf([le,me]);ue.layers.enable(1),ue.layers.enable(2);var re=new Zt,Oe;function He(){var ut=c.isPresenting=h!==null&&h.isPresenting===!0;if(ut){var st=h.getEyeParameters("left");l=2*st.renderWidth*V,d=st.renderHeight*V,Oe=p.getPixelRatio(),p.getSize(re),p.setDrawingBufferSize(l,d,1),le.viewport.set(0,0,l/2,d),me.viewport.set(l/2,0,l/2,d),ot.start(),c.dispatchEvent({type:"sessionstart"})}else c.enabled&&p.setDrawingBufferSize(re.width,re.height,Oe),ot.stop(),c.dispatchEvent({type:"sessionend"})}var Re=[],we=[];function Ue(ut){for(var st=navigator.getGamepads&&navigator.getGamepads(),et=0,dt=st.length;et<dt;et++){var at=st[et];if(at&&(at.id==="Daydream Controller"||at.id==="Gear VR Controller"||at.id==="Oculus Go Controller"||at.id==="OpenVR Gamepad"||at.id.startsWith("Oculus Touch")||at.id.startsWith("HTC Vive Focus")||at.id.startsWith("Spatial Controller"))){var it=at.hand;if(ut===0&&(it===""||it==="right")||ut===1&&it==="left")return at}}}function rt(){for(var ut=0;ut<R.length;ut++){var st=R[ut],et=Ue(ut);if(et!==void 0&&et.pose!==void 0){if(et.pose===null)return;var dt=et.pose;dt.hasPosition===!1&&st.position.set(.2,-.6,-.05),dt.position!==null&&st.position.fromArray(dt.position),dt.orientation!==null&&st.quaternion.fromArray(dt.orientation),st.matrix.compose(st.position,st.quaternion,st.scale),st.matrix.premultiply(O),st.matrix.decompose(st.position,st.quaternion,st.scale),st.matrixWorldNeedsUpdate=!0,st.visible=!0;var at=et.id==="Daydream Controller"?0:1;Re[ut]===void 0&&(Re[ut]=!1),Re[ut]!==et.buttons[at].pressed&&(Re[ut]=et.buttons[at].pressed,Re[ut]===!0?st.dispatchEvent({type:"selectstart"}):(st.dispatchEvent({type:"selectend"}),st.dispatchEvent({type:"select"}))),at=2,we[ut]===void 0&&(we[ut]=!1),et.buttons[at]!==void 0&&we[ut]!==et.buttons[at].pressed&&(we[ut]=et.buttons[at].pressed,we[ut]===!0?st.dispatchEvent({type:"squeezestart"}):(st.dispatchEvent({type:"squeezeend"}),st.dispatchEvent({type:"squeeze"})))}else st.visible=!1}}function nt(ut,st){st!==null&&st.length===4&&ut.set(st[0]*l,st[1]*d,st[2]*l,st[3]*d)}this.enabled=!1,this.getController=function(ut){var st=R[ut];return st===void 0&&(st=new Es,st.matrixAutoUpdate=!1,st.visible=!1,R[ut]=st),st},this.getDevice=function(){return h},this.setDevice=function(ut){ut!==void 0&&(h=ut),ot.setContext(ut)},this.setFramebufferScaleFactor=function(ut){V=ut},this.setReferenceSpaceType=function(ut){G=ut},this.setPoseTarget=function(ut){ut!==void 0&&(_=ut)},this.getCamera=function(ut){var st=G==="local-floor"?1.6:0;if(h.depthNear=ut.near,h.depthFar=ut.far,h.getFrameData(x),G==="local-floor"){var et=h.stageParameters;et?O.fromArray(et.sittingToStandingTransform):O.makeTranslation(0,st,0)}var dt=x.pose,at=_!==null?_:ut;at.matrix.copy(O),at.matrix.decompose(at.position,at.quaternion,at.scale),dt.orientation!==null&&(ne.fromArray(dt.orientation),at.quaternion.multiply(ne)),dt.position!==null&&(ne.setFromRotationMatrix(O),Q.fromArray(dt.position),Q.applyQuaternion(ne),at.position.add(Q)),at.updateMatrixWorld();for(var it=at.children,Ke=0,vt=it.length;Ke<vt;Ke++)it[Ke].updateMatrixWorld(!0);le.near=ut.near,me.near=ut.near,le.far=ut.far,me.far=ut.far,le.matrixWorldInverse.fromArray(x.leftViewMatrix),me.matrixWorldInverse.fromArray(x.rightViewMatrix),B.getInverse(O),G==="local-floor"&&(le.matrixWorldInverse.multiply(B),me.matrixWorldInverse.multiply(B));var gt=at.parent;gt!==null&&(z.getInverse(gt.matrixWorld),le.matrixWorldInverse.multiply(z),me.matrixWorldInverse.multiply(z)),le.matrixWorld.getInverse(le.matrixWorldInverse),me.matrixWorld.getInverse(me.matrixWorldInverse),le.projectionMatrix.fromArray(x.leftProjectionMatrix),me.projectionMatrix.fromArray(x.rightProjectionMatrix),EI(ue,le,me);var St=h.getLayers();if(St.length){var Tt=St[0];nt(le.viewport,Tt.leftBounds),nt(me.viewport,Tt.rightBounds)}return rt(),ue},this.getStandingMatrix=function(){return O},this.isPresenting=!1;var ot=new K0;this.setAnimationLoop=function(ut){ot.setAnimationLoop(ut),this.isPresenting&&ot.start()},this.submitFrame=function(){this.isPresenting&&h.submitFrame()},this.dispose=function(){typeof window!="undefined"&&window.removeEventListener("vrdisplaypresentchange",He)},this.setFrameOfReferenceType=function(){console.warn("THREE.WebVRManager: setFrameOfReferenceType() has been deprecated.")}}Object.assign(OA.prototype,Ho.prototype);function wf(){this._targetRay=null,this._grip=null,this._hand=null}Object.assign(wf.prototype,{constructor:wf,getHandSpace:function(){return this._hand===null&&(this._hand=new Es,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand},getTargetRaySpace:function(){return this._targetRay===null&&(this._targetRay=new Es,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return this._grip===null&&(this._grip=new Es,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(l){return this._targetRay!==null&&this._targetRay.dispatchEvent(l),this._grip!==null&&this._grip.dispatchEvent(l),this._hand!==null&&this._hand.dispatchEvent(l),this},disconnect:function(l){return this.dispatchEvent({type:"disconnected",data:l}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this},update:function(l,d,c){var h=null,x=null,_=null,R=this._targetRay,O=this._grip,B=this._hand;if(l&&d.session.visibilityState!=="visible-blurred")if(B&&l.hand){_=!0;for(var V=uL(l.hand.values()),G;!(G=V()).done;){var z=G.value,ne=d.getJointPose(z,c);if(B.joints[z.jointName]===void 0){var Q=new Es;Q.matrixAutoUpdate=!1,Q.visible=!1,B.joints[z.jointName]=Q,B.add(Q)}var le=B.joints[z.jointName];ne!==null&&(le.matrix.fromArray(ne.transform.matrix),le.matrix.decompose(le.position,le.rotation,le.scale),le.jointRadius=ne.radius),le.visible=ne!==null}var me=B.joints["index-finger-tip"],ue=B.joints["thumb-tip"],re=me.position.distanceTo(ue.position),Oe=.02,He=.005;B.inputState.pinching&&re>Oe+He?(B.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:l.handedness,target:this})):!B.inputState.pinching&&re<=Oe-He&&(B.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:l.handedness,target:this}))}else R!==null&&(h=d.getPose(l.targetRaySpace,c),h!==null&&(R.matrix.fromArray(h.transform.matrix),R.matrix.decompose(R.position,R.rotation,R.scale))),O!==null&&l.gripSpace&&(x=d.getPose(l.gripSpace,c),x!==null&&(O.matrix.fromArray(x.transform.matrix),O.matrix.decompose(O.position,O.rotation,O.scale)));return R!==null&&(R.visible=h!==null),O!==null&&(O.visible=x!==null),B!==null&&(B.visible=_!==null),this}});function IA(p,l){var d=this,c=null,h=1,x=null,_="local-floor",R=null,O=null,B=[],V=new Map,G=[],z,ne=new Mi;ne.layers.enable(1),ne.viewport=new Yr;var Q=new Mi;Q.layers.enable(2),Q.viewport=new Yr;var le=[ne,Q],me=new xf;me.layers.enable(1),me.layers.enable(2);var ue=null,re=null;this.layersEnabled=!1,this.enabled=!1,this.isPresenting=!1,this.getCameraPose=function(){return R},this.getController=function(et){var dt=B[et];return dt===void 0&&(dt=new wf,B[et]=dt),dt.getTargetRaySpace()},this.getControllerGrip=function(et){var dt=B[et];return dt===void 0&&(dt=new wf,B[et]=dt),dt.getGripSpace()},this.getHand=function(et){var dt=B[et];return dt===void 0&&(dt=new wf,B[et]=dt),dt.getHandSpace()};function Oe(et){var dt=V.get(et.inputSource);dt&&dt.dispatchEvent({type:et.type,data:et.inputSource})}function He(){V.forEach(function(et,dt){et.disconnect(dt)}),V.clear(),ue=null,re=null,p.setFramebuffer(null),p.setRenderTarget(p.getRenderTarget()),st.stop(),d.isPresenting=!1,d.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(et){h=et,d.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(et){_=et,d.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return x},this.getSession=function(){return c},this.setSession=function(){var et=lL(regeneratorRuntime.mark(function dt(at){var it,Ke;return regeneratorRuntime.wrap(function(gt){for(;;)switch(gt.prev=gt.next){case 0:if(c=at,c===null){gt.next=24;break}if(c.addEventListener("select",Oe),c.addEventListener("selectstart",Oe),c.addEventListener("selectend",Oe),c.addEventListener("squeeze",Oe),c.addEventListener("squeezestart",Oe),c.addEventListener("squeezeend",Oe),c.addEventListener("end",He),c.addEventListener("inputsourceschange",Re),it=l.getContextAttributes(),it.xrCompatible===!0){gt.next=14;break}return gt.next=14,l.makeXRCompatible();case 14:return Ke={antialias:it.antialias,alpha:it.alpha,depth:it.depth,stencil:it.stencil,framebufferScaleFactor:h},z=new XRWebGLLayer(c,l,Ke),window.XRWebGLBinding&&this.layersEnabled?this.addLayer(z):c.updateRenderState({baseLayer:z}),gt.next=19,c.requestReferenceSpace(_);case 19:x=gt.sent,st.setContext(c),st.start(),d.isPresenting=!0,d.dispatchEvent({type:"sessionstart"});case 24:case"end":return gt.stop()}},dt,this)}));return function(dt){return et.apply(this,arguments)}}(),this.addLayer=function(et){!window.XRWebGLBinding||!this.layersEnabled||!c||(G.push(et),c.updateRenderState({layers:G}))},this.removeLayer=function(et){!window.XRWebGLBinding||!this.layersEnabled||!c||(G.splice(G.indexOf(et),1),c.updateRenderState({layers:G}))};function Re(et){for(var dt=c.inputSources,at=0;at<B.length;at++)V.set(dt[at],B[at]);for(var it=0;it<et.removed.length;it++){var Ke=et.removed[it],vt=V.get(Ke);vt&&(vt.dispatchEvent({type:"disconnected",data:Ke}),V.delete(Ke))}for(var gt=0;gt<et.added.length;gt++){var St=et.added[gt],Tt=V.get(St);Tt&&Tt.dispatchEvent({type:"connected",data:St})}}var we=new Ge,Ue=new Ge;function rt(et,dt,at){we.setFromMatrixPosition(dt.matrixWorld),Ue.setFromMatrixPosition(at.matrixWorld);var it=we.distanceTo(Ue),Ke=dt.projectionMatrix.elements,vt=at.projectionMatrix.elements,gt=Ke[14]/(Ke[10]-1),St=Ke[14]/(Ke[10]+1),Tt=(Ke[9]+1)/Ke[5],qt=(Ke[9]-1)/Ke[5],en=(Ke[8]-1)/Ke[0],_n=(vt[8]+1)/vt[0],Lt=gt*en,Wn=gt*_n,gn=it/(-en+_n),qn=gn*-en;dt.matrixWorld.decompose(et.position,et.quaternion,et.scale),et.translateX(qn),et.translateZ(gn),et.matrixWorld.compose(et.position,et.quaternion,et.scale),et.matrixWorldInverse.copy(et.matrixWorld).invert();var ar=gt+gn,gr=St+gn,sr=Lt-qn,ai=Wn+(it-qn),Or=Tt*St/gr*ar,$r=qt*St/gr*ar;et.projectionMatrix.makePerspective(sr,ai,Or,$r,ar,gr)}function nt(et,dt){dt===null?et.matrixWorld.copy(et.matrix):et.matrixWorld.multiplyMatrices(dt.matrixWorld,et.matrix),et.matrixWorldInverse.copy(et.matrixWorld).invert()}this.setPoseTarget=function(et){et!==void 0&&(O=et)},this.getCamera=function(et){me.near=Q.near=ne.near=et.near,me.far=Q.far=ne.far=et.far,(ue!==me.near||re!==me.far)&&(c.updateRenderState({depthNear:me.near,depthFar:me.far}),ue=me.near,re=me.far);var dt=et.parent,at=me.cameras,it=O||et;nt(me,dt);for(var Ke=0;Ke<at.length;Ke++)nt(at[Ke],dt);it.matrixWorld.copy(me.matrixWorld);for(var vt=it.children,gt=0,St=vt.length;gt<St;gt++)vt[gt].updateMatrixWorld(!0);return at.length===2?rt(me,ne,Q):me.projectionMatrix.copy(ne.projectionMatrix),me};var ot=null;function ut(et,dt){if(R=dt.getViewerPose(x),R!==null){var at=R.views;p.setFramebuffer(z.framebuffer);var it=!1;at.length!==me.cameras.length&&(me.cameras.length=0,it=!0);for(var Ke=0;Ke<at.length;Ke++){var vt=at[Ke],gt=z.getViewport(vt),St=le[Ke];St.matrix.fromArray(vt.transform.matrix),St.projectionMatrix.fromArray(vt.projectionMatrix),St.viewport.set(gt.x,gt.y,gt.width,gt.height),Ke===0&&me.matrix.copy(St.matrix),it===!0&&me.cameras.push(St)}}for(var Tt=c.inputSources,qt=0;qt<B.length;qt++){var en=B[qt],_n=Tt[qt];en.update(_n,dt,x)}ot&&ot(et,dt)}var st=new K0;st.setAnimationLoop(ut),this.setAnimationLoop=function(et){ot=et},this.dispose=function(){}}Object.assign(IA.prototype,Ho.prototype);function _I(p){function l(ue,re){ue.fogColor.value.copy(re.color),re.isFog?(ue.fogNear.value=re.near,ue.fogFar.value=re.far):re.isFogExp2&&(ue.fogDensity.value=re.density)}function d(ue,re,Oe,He){re.isMeshBasicMaterial?c(ue,re):re.isMeshLambertMaterial?(c(ue,re),O(ue,re)):re.isMeshToonMaterial?(c(ue,re),V(ue,re)):re.isMeshPhongMaterial?(c(ue,re),B(ue,re)):re.isMeshStandardMaterial?(c(ue,re),re.isMeshPhysicalMaterial?z(ue,re):G(ue,re)):re.isMeshMatcapMaterial?(c(ue,re),ne(ue,re)):re.isMeshDepthMaterial?(c(ue,re),Q(ue,re)):re.isMeshDistanceMaterial?(c(ue,re),le(ue,re)):re.isMeshNormalMaterial?(c(ue,re),me(ue,re)):re.isLineBasicMaterial?(h(ue,re),re.isLineDashedMaterial&&x(ue,re)):re.isPointsMaterial?_(ue,re,Oe,He):re.isSpriteMaterial?R(ue,re):re.isShadowMaterial?(ue.color.value.copy(re.color),ue.opacity.value=re.opacity):re.isShaderMaterial&&(re.uniformsNeedUpdate=!1)}function c(ue,re){ue.opacity.value=re.opacity,re.color&&ue.diffuse.value.copy(re.color),re.emissive&&ue.emissive.value.copy(re.emissive).multiplyScalar(re.emissiveIntensity),re.map&&(ue.map.value=re.map),re.alphaMap&&(ue.alphaMap.value=re.alphaMap),re.specularMap&&(ue.specularMap.value=re.specularMap);var Oe=p.get(re).envMap;if(Oe){ue.envMap.value=Oe,ue.flipEnvMap.value=Oe.isCubeTexture&&Oe._needsFlipEnvMap?-1:1,ue.reflectivity.value=re.reflectivity,ue.refractionRatio.value=re.refractionRatio;var He=p.get(Oe).__maxMipLevel;He!==void 0&&(ue.maxMipLevel.value=He)}re.lightMap&&(ue.lightMap.value=re.lightMap,ue.lightMapIntensity.value=re.lightMapIntensity),re.aoMap&&(ue.aoMap.value=re.aoMap,ue.aoMapIntensity.value=re.aoMapIntensity);var Re;re.map?Re=re.map:re.specularMap?Re=re.specularMap:re.displacementMap?Re=re.displacementMap:re.normalMap?Re=re.normalMap:re.bumpMap?Re=re.bumpMap:re.roughnessMap?Re=re.roughnessMap:re.metalnessMap?Re=re.metalnessMap:re.alphaMap?Re=re.alphaMap:re.emissiveMap?Re=re.emissiveMap:re.clearcoatMap?Re=re.clearcoatMap:re.clearcoatNormalMap?Re=re.clearcoatNormalMap:re.clearcoatRoughnessMap&&(Re=re.clearcoatRoughnessMap),Re!==void 0&&(Re.isWebGLRenderTarget&&(Re=Re.texture),Re.matrixAutoUpdate===!0&&Re.updateMatrix(),ue.uvTransform.value.copy(Re.matrix));var we;re.aoMap?we=re.aoMap:re.lightMap&&(we=re.lightMap),we!==void 0&&(we.isWebGLRenderTarget&&(we=we.texture),we.matrixAutoUpdate===!0&&we.updateMatrix(),ue.uv2Transform.value.copy(we.matrix))}function h(ue,re){ue.diffuse.value.copy(re.color),ue.opacity.value=re.opacity}function x(ue,re){ue.dashSize.value=re.dashSize,ue.totalSize.value=re.dashSize+re.gapSize,ue.scale.value=re.scale}function _(ue,re,Oe,He){ue.diffuse.value.copy(re.color),ue.opacity.value=re.opacity,ue.size.value=re.size*Oe,ue.scale.value=He*.5,re.map&&(ue.map.value=re.map),re.alphaMap&&(ue.alphaMap.value=re.alphaMap);var Re;re.map?Re=re.map:re.alphaMap&&(Re=re.alphaMap),Re!==void 0&&(Re.matrixAutoUpdate===!0&&Re.updateMatrix(),ue.uvTransform.value.copy(Re.matrix))}function R(ue,re){ue.diffuse.value.copy(re.color),ue.opacity.value=re.opacity,ue.rotation.value=re.rotation,re.map&&(ue.map.value=re.map),re.alphaMap&&(ue.alphaMap.value=re.alphaMap);var Oe;re.map?Oe=re.map:re.alphaMap&&(Oe=re.alphaMap),Oe!==void 0&&(Oe.matrixAutoUpdate===!0&&Oe.updateMatrix(),ue.uvTransform.value.copy(Oe.matrix))}function O(ue,re){re.emissiveMap&&(ue.emissiveMap.value=re.emissiveMap)}function B(ue,re){ue.specular.value.copy(re.specular),ue.shininess.value=Math.max(re.shininess,1e-4),re.emissiveMap&&(ue.emissiveMap.value=re.emissiveMap),re.bumpMap&&(ue.bumpMap.value=re.bumpMap,ue.bumpScale.value=re.bumpScale,re.side===C&&(ue.bumpScale.value*=-1)),re.normalMap&&(ue.normalMap.value=re.normalMap,ue.normalScale.value.copy(re.normalScale),re.side===C&&ue.normalScale.value.negate()),re.displacementMap&&(ue.displacementMap.value=re.displacementMap,ue.displacementScale.value=re.displacementScale,ue.displacementBias.value=re.displacementBias)}function V(ue,re){re.gradientMap&&(ue.gradientMap.value=re.gradientMap),re.emissiveMap&&(ue.emissiveMap.value=re.emissiveMap),re.bumpMap&&(ue.bumpMap.value=re.bumpMap,ue.bumpScale.value=re.bumpScale,re.side===C&&(ue.bumpScale.value*=-1)),re.normalMap&&(ue.normalMap.value=re.normalMap,ue.normalScale.value.copy(re.normalScale),re.side===C&&ue.normalScale.value.negate()),re.displacementMap&&(ue.displacementMap.value=re.displacementMap,ue.displacementScale.value=re.displacementScale,ue.displacementBias.value=re.displacementBias)}function G(ue,re){ue.roughness.value=re.roughness,ue.metalness.value=re.metalness,re.roughnessMap&&(ue.roughnessMap.value=re.roughnessMap),re.metalnessMap&&(ue.metalnessMap.value=re.metalnessMap),re.emissiveMap&&(ue.emissiveMap.value=re.emissiveMap),re.bumpMap&&(ue.bumpMap.value=re.bumpMap,ue.bumpScale.value=re.bumpScale,re.side===C&&(ue.bumpScale.value*=-1)),re.normalMap&&(ue.normalMap.value=re.normalMap,ue.normalScale.value.copy(re.normalScale),re.side===C&&ue.normalScale.value.negate()),re.displacementMap&&(ue.displacementMap.value=re.displacementMap,ue.displacementScale.value=re.displacementScale,ue.displacementBias.value=re.displacementBias);var Oe=p.get(re).envMap;Oe&&(ue.envMapIntensity.value=re.envMapIntensity)}function z(ue,re){G(ue,re),ue.reflectivity.value=re.reflectivity,ue.clearcoat.value=re.clearcoat,ue.clearcoatRoughness.value=re.clearcoatRoughness,re.sheen&&ue.sheen.value.copy(re.sheen),re.clearcoatMap&&(ue.clearcoatMap.value=re.clearcoatMap),re.clearcoatRoughnessMap&&(ue.clearcoatRoughnessMap.value=re.clearcoatRoughnessMap),re.clearcoatNormalMap&&(ue.clearcoatNormalScale.value.copy(re.clearcoatNormalScale),ue.clearcoatNormalMap.value=re.clearcoatNormalMap,re.side===C&&ue.clearcoatNormalScale.value.negate()),ue.transmission.value=re.transmission,re.transmissionMap&&(ue.transmissionMap.value=re.transmissionMap)}function ne(ue,re){re.matcap&&(ue.matcap.value=re.matcap),re.bumpMap&&(ue.bumpMap.value=re.bumpMap,ue.bumpScale.value=re.bumpScale,re.side===C&&(ue.bumpScale.value*=-1)),re.normalMap&&(ue.normalMap.value=re.normalMap,ue.normalScale.value.copy(re.normalScale),re.side===C&&ue.normalScale.value.negate()),re.displacementMap&&(ue.displacementMap.value=re.displacementMap,ue.displacementScale.value=re.displacementScale,ue.displacementBias.value=re.displacementBias)}function Q(ue,re){re.displacementMap&&(ue.displacementMap.value=re.displacementMap,ue.displacementScale.value=re.displacementScale,ue.displacementBias.value=re.displacementBias)}function le(ue,re){re.displacementMap&&(ue.displacementMap.value=re.displacementMap,ue.displacementScale.value=re.displacementScale,ue.displacementBias.value=re.displacementBias),ue.referencePosition.value.copy(re.referencePosition),ue.nearDistance.value=re.nearDistance,ue.farDistance.value=re.farDistance}function me(ue,re){re.bumpMap&&(ue.bumpMap.value=re.bumpMap,ue.bumpScale.value=re.bumpScale,re.side===C&&(ue.bumpScale.value*=-1)),re.normalMap&&(ue.normalMap.value=re.normalMap,ue.normalScale.value.copy(re.normalScale),re.side===C&&ue.normalScale.value.negate()),re.displacementMap&&(ue.displacementMap.value=re.displacementMap,ue.displacementScale.value=re.displacementScale,ue.displacementBias.value=re.displacementBias)}return{refreshFogUniforms:l,refreshMaterialUniforms:d}}function MI(){var p=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return p.style.display="block",p}function Af(p){p=p||{};var l=p.canvas!==void 0?p.canvas:MI(),d=p.context!==void 0?p.context:null,c=p.alpha!==void 0?p.alpha:!1,h=p.depth!==void 0?p.depth:!0,x=p.stencil!==void 0?p.stencil:!0,_=p.antialias!==void 0?p.antialias:!1,R=p.premultipliedAlpha!==void 0?p.premultipliedAlpha:!0,O=p.preserveDrawingBuffer!==void 0?p.preserveDrawingBuffer:!1,B=p.powerPreference!==void 0?p.powerPreference:"default",V=p.failIfMajorPerformanceCaveat!==void 0?p.failIfMajorPerformanceCaveat:!1,G=null,z=null,ne=[];this.domElement=l,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=xa,this.physicallyCorrectLights=!1,this.toneMapping=ke,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var Q=this,le=!1,me=null,ue=0,re=0,Oe=null,He=null,Re=-1,we=null,Ue=new Yr,rt=new Yr,nt=null,ot=l.width,ut=l.height,st=1,et=null,dt=null,at=new Yr(0,0,ot,ut),it=new Yr(0,0,ot,ut),Ke=!1,vt=new vf,gt=!1,St=!1,Tt=new br,qt=new Ge,en={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function _n(){return Oe===null?st:1}var Lt=d;function Wn($e,Ut){for(var Pt=0;Pt<$e.length;Pt++){var Vt=$e[Pt],cn=l.getContext(Vt,Ut);if(cn!==null)return cn}return null}try{var gn={alpha:c,depth:h,stencil:x,antialias:_,premultipliedAlpha:R,preserveDrawingBuffer:O,powerPreference:B,failIfMajorPerformanceCaveat:V};if(l.addEventListener("webglcontextlost",oi,!1),l.addEventListener("webglcontextrestored",Br,!1),Lt===null){var qn=["webgl2","webgl","experimental-webgl"];if(Q.isWebGL1Renderer===!0&&qn.shift(),Lt=Wn(qn,gn),Lt===null)throw Wn(qn)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}Lt.getShaderPrecisionFormat===void 0&&(Lt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch($e){throw console.error("THREE.WebGLRenderer: "+$e.message),$e}var ar,gr,sr,ai,Or,$r,Di,sa,Wi,Ti,lt,tt,dn,an,rr,xt,Mn,wn,Yn,yn,tn;function lr(){ar=new nO(Lt),gr=new JD(Lt,ar,p),ar.init(gr),yn=new LA(Lt,ar,gr),sr=new wI(Lt,ar,gr),sr.scissor(rt.copy(it).multiplyScalar(st).floor()),sr.viewport(Ue.copy(at).multiplyScalar(st).floor()),ai=new aO(Lt),Or=new cI,$r=new AI(Lt,ar,sr,Or,gr,yn,ai),Di=new tO(Q),sa=new CL(Lt,gr),tn=new ZD(Lt,ar,sa,gr),Wi=new rO(Lt,sa,ai,tn),Ti=new cO(Lt,Wi,sa,ai),Mn=new lO(Lt),rr=new eO(Or),lt=new lI(Q,Di,ar,gr,tn,rr),tt=new _I(Or),dn=new fI(Or),an=new yI(ar,gr),xt=new KD(Q,Di,sr,Ti,R),wn=new QD(Lt,ar,ai,gr),Yn=new iO(Lt,ar,ai,gr),ai.programs=lt.programs,Q.capabilities=gr,Q.extensions=ar,Q.properties=Or,Q.renderLists=dn,Q.state=sr,Q.info=ai}lr();var yr=typeof navigator!="undefined"&&"xr"in navigator?new IA(Q,Lt):new OA(Q);this.xr=yr;var Ai=new RA(Q,Ti,gr.maxTextureSize);this.shadowMap=Ai,this.getContext=function(){return Lt},this.getContextAttributes=function(){return Lt.getContextAttributes()},this.forceContextLoss=function(){var $e=ar.get("WEBGL_lose_context");$e&&$e.loseContext()},this.forceContextRestore=function(){var $e=ar.get("WEBGL_lose_context");$e&&$e.restoreContext()},this.getPixelRatio=function(){return st},this.setPixelRatio=function($e){$e!==void 0&&(st=$e,this.setSize(ot,ut,!1))},this.getSize=function($e){return $e===void 0&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),$e=new Zt),$e.set(ot,ut)},this.setSize=function($e,Ut,Pt){if(yr.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}ot=$e,ut=Ut,l.width=Math.floor($e*st),l.height=Math.floor(Ut*st),Pt!==!1&&(l.style.width=$e+"px",l.style.height=Ut+"px"),this.setViewport(0,0,$e,Ut)},this.getDrawingBufferSize=function($e){return $e===void 0&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),$e=new Zt),$e.set(ot*st,ut*st).floor()},this.setDrawingBufferSize=function($e,Ut,Pt){ot=$e,ut=Ut,st=Pt,l.width=Math.floor($e*Pt),l.height=Math.floor(Ut*Pt),this.setViewport(0,0,$e,Ut)},this.getCurrentViewport=function($e){return $e===void 0&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),$e=new Yr),$e.copy(Ue)},this.getViewport=function($e){return $e.copy(at)},this.setViewport=function($e,Ut,Pt,Vt){$e.isVector4?at.set($e.x,$e.y,$e.z,$e.w):at.set($e,Ut,Pt,Vt),sr.viewport(Ue.copy(at).multiplyScalar(st).floor())},this.getScissor=function($e){return $e.copy(it)},this.setScissor=function($e,Ut,Pt,Vt){$e.isVector4?it.set($e.x,$e.y,$e.z,$e.w):it.set($e,Ut,Pt,Vt),sr.scissor(rt.copy(it).multiplyScalar(st).floor())},this.getScissorTest=function(){return Ke},this.setScissorTest=function($e){sr.setScissorTest(Ke=$e)},this.setOpaqueSort=function($e){et=$e},this.setTransparentSort=function($e){dt=$e},this.getClearColor=function($e){return $e===void 0&&(console.warn("WebGLRenderer: .getClearColor() now requires a Color as an argument"),$e=new vn),$e.copy(xt.getClearColor())},this.setClearColor=function(){xt.setClearColor.apply(xt,arguments)},this.getClearAlpha=function(){return xt.getClearAlpha()},this.setClearAlpha=function(){xt.setClearAlpha.apply(xt,arguments)},this.clear=function($e,Ut,Pt){var Vt=0;($e===void 0||$e)&&(Vt|=16384),(Ut===void 0||Ut)&&(Vt|=256),(Pt===void 0||Pt)&&(Vt|=1024),Lt.clear(Vt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){l.removeEventListener("webglcontextlost",oi,!1),l.removeEventListener("webglcontextrestored",Br,!1),dn.dispose(),an.dispose(),Or.dispose(),Di.dispose(),Ti.dispose(),tn.dispose(),yr.dispose(),Zo.stop()};function oi($e){$e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),le=!0}function Br(){console.log("THREE.WebGLRenderer: Context Restored."),le=!1,lr()}function Wr($e){var Ut=$e.target;Ut.removeEventListener("dispose",Wr),Oi(Ut)}function Oi($e){Nu($e),Or.remove($e)}function Nu($e){var Ut=Or.get($e).program;Ut!==void 0&&lt.releaseProgram(Ut)}function wl($e,Ut){$e.render(function(Pt){Q.renderBufferImmediate(Pt,Ut)})}this.renderBufferImmediate=function($e,Ut){tn.initAttributes();var Pt=Or.get($e);$e.hasPositions&&!Pt.position&&(Pt.position=Lt.createBuffer()),$e.hasNormals&&!Pt.normal&&(Pt.normal=Lt.createBuffer()),$e.hasUvs&&!Pt.uv&&(Pt.uv=Lt.createBuffer()),$e.hasColors&&!Pt.color&&(Pt.color=Lt.createBuffer());var Vt=Ut.getAttributes();$e.hasPositions&&(Lt.bindBuffer(34962,Pt.position),Lt.bufferData(34962,$e.positionArray,35048),tn.enableAttribute(Vt.position),Lt.vertexAttribPointer(Vt.position,3,5126,!1,0,0)),$e.hasNormals&&(Lt.bindBuffer(34962,Pt.normal),Lt.bufferData(34962,$e.normalArray,35048),tn.enableAttribute(Vt.normal),Lt.vertexAttribPointer(Vt.normal,3,5126,!1,0,0)),$e.hasUvs&&(Lt.bindBuffer(34962,Pt.uv),Lt.bufferData(34962,$e.uvArray,35048),tn.enableAttribute(Vt.uv),Lt.vertexAttribPointer(Vt.uv,2,5126,!1,0,0)),$e.hasColors&&(Lt.bindBuffer(34962,Pt.color),Lt.bufferData(34962,$e.colorArray,35048),tn.enableAttribute(Vt.color),Lt.vertexAttribPointer(Vt.color,3,5126,!1,0,0)),tn.disableUnusedAttributes(),Lt.drawArrays(4,0,$e.count),$e.count=0},this.renderBufferDirect=function($e,Ut,Pt,Vt,cn,Ir){Ut===null&&(Ut=en);var Mr=cn.isMesh&&cn.matrixWorld.determinant()<0,jr=qf($e,Ut,Vt,cn);sr.setMaterial(Vt,Mr);var or=Pt.index,Ii=Pt.attributes.position;if(or===null){if(Ii===void 0||Ii.count===0)return}else if(or.count===0)return;var bi=1;Vt.wireframe===!0&&(or=Wi.getWireframeAttribute(Pt),bi=2),(Vt.morphTargets||Vt.morphNormals)&&Mn.update(cn,Pt,Vt,jr),tn.setup(cn,Vt,jr,Pt,or);var xr,Sr=wn;or!==null&&(xr=sa.get(or),Sr=Yn,Sr.setIndex(xr));var ji=or!==null?or.count:Ii.count,la=Pt.drawRange.start*bi,Ur=Pt.drawRange.count*bi,Bi=Ir!==null?Ir.start*bi:0,Fr=Ir!==null?Ir.count*bi:1/0,hr=Math.max(la,Bi),Hr=Math.min(ji,la+Ur,Bi+Fr)-1,Rr=Math.max(0,Hr-hr+1);if(Rr!==0){if(cn.isMesh)Vt.wireframe===!0?(sr.setLineWidth(Vt.wireframeLinewidth*_n()),Sr.setMode(1)):Sr.setMode(4);else if(cn.isLine){var kr=Vt.linewidth;kr===void 0&&(kr=1),sr.setLineWidth(kr*_n()),cn.isLineSegments?Sr.setMode(1):cn.isLineLoop?Sr.setMode(2):Sr.setMode(3)}else cn.isPoints?Sr.setMode(0):cn.isSprite&&Sr.setMode(4);if(cn.isInstancedMesh)Sr.renderInstances(hr,Rr,cn.count);else if(Pt.isInstancedBufferGeometry){var vi=Math.min(Pt.instanceCount,Pt._maxInstanceCount);Sr.renderInstances(hr,Rr,vi)}else Sr.render(hr,Rr)}},this.compile=function($e,Ut){z=an.get($e),z.init(),$e.traverseVisible(function(Vt){Vt.isLight&&Vt.layers.test(Ut.layers)&&(z.pushLight(Vt),Vt.castShadow&&z.pushShadow(Vt))}),z.setupLights();var Pt=new WeakMap;$e.traverse(function(Vt){var cn=Vt.material;if(cn)if(Array.isArray(cn))for(var Ir=0;Ir<cn.length;Ir++){var Mr=cn[Ir];Pt.has(Mr)===!1&&(Ya(Mr,$e,Vt),Pt.set(Mr))}else Pt.has(cn)===!1&&(Ya(cn,$e,Vt),Pt.set(cn))})};var Ro=null;function Cs($e){yr.isPresenting||Ro&&Ro($e)}var Zo=new K0;Zo.setAnimationLoop(Cs),typeof window!="undefined"&&Zo.setContext(window),this.setAnimationLoop=function($e){Ro=$e,yr.setAnimationLoop($e),$e===null?Zo.stop():Zo.start()},this.render=function($e,Ut){var Pt,Vt;if(arguments[2]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),Pt=arguments[2]),arguments[3]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),Vt=arguments[3]),Ut!==void 0&&Ut.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(le!==!0){tn.resetDefaultState(),Re=-1,we=null,$e.autoUpdate===!0&&$e.updateMatrixWorld(),Ut.parent===null&&Ut.updateMatrixWorld(),yr.enabled===!0&&yr.isPresenting===!0&&(Ut=yr.getCamera(Ut)),$e.isScene===!0&&$e.onBeforeRender(Q,$e,Ut,Pt||Oe),z=an.get($e,ne.length),z.init(),ne.push(z),Tt.multiplyMatrices(Ut.projectionMatrix,Ut.matrixWorldInverse),vt.setFromProjectionMatrix(Tt),St=this.localClippingEnabled,gt=rr.init(this.clippingPlanes,St,Ut),G=dn.get($e,Ut),G.init(),Rs($e,Ut,0,Q.sortObjects),G.finish(),Q.sortObjects===!0&&G.sort(et,dt),gt===!0&&rr.beginShadows();var cn=z.state.shadowsArray;Ai.render(cn,$e,Ut),z.setupLights(),z.setupLightsView(Ut),gt===!0&&rr.endShadows(),this.info.autoReset===!0&&this.info.reset(),Pt!==void 0&&this.setRenderTarget(Pt),xt.render(G,$e,Ut,Vt);var Ir=G.opaque,Mr=G.transparent;Ir.length>0&&Al(Ir,$e,Ut),Mr.length>0&&Al(Mr,$e,Ut),$e.isScene===!0&&$e.onAfterRender(Q,$e,Ut),Oe!==null&&($r.updateRenderTargetMipmap(Oe),$r.updateMultisampleRenderTarget(Oe)),sr.buffers.depth.setTest(!0),sr.buffers.depth.setMask(!0),sr.buffers.color.setMask(!0),sr.setPolygonOffset(!1),yr.enabled&&yr.submitFrame&&yr.submitFrame(),ne.pop(),ne.length>0?z=ne[ne.length-1]:z=null,G=null}};function Rs($e,Ut,Pt,Vt){if($e.visible!==!1){var cn=$e.layers.test(Ut.layers);if(cn){if($e.isGroup)Pt=$e.renderOrder;else if($e.isLOD)$e.autoUpdate===!0&&$e.update(Ut);else if($e.isLight)z.pushLight($e),$e.castShadow&&z.pushShadow($e);else if($e.isSprite){if(!$e.frustumCulled||vt.intersectsSprite($e)){Vt&&qt.setFromMatrixPosition($e.matrixWorld).applyMatrix4(Tt);var Ir=Ti.update($e),Mr=$e.material;Mr.visible&&G.push($e,Ir,Mr,Pt,qt.z,null)}}else if($e.isImmediateRenderObject)Vt&&qt.setFromMatrixPosition($e.matrixWorld).applyMatrix4(Tt),G.push($e,null,$e.material,Pt,qt.z,null);else if(($e.isMesh||$e.isLine||$e.isPoints)&&($e.isSkinnedMesh&&$e.skeleton.frame!==ai.render.frame&&($e.skeleton.update(),$e.skeleton.frame=ai.render.frame),!$e.frustumCulled||vt.intersectsObject($e))){Vt&&qt.setFromMatrixPosition($e.matrixWorld).applyMatrix4(Tt);var jr=Ti.update($e),or=$e.material;if(Array.isArray(or))for(var Ii=jr.groups,bi=0,xr=Ii.length;bi<xr;bi++){var Sr=Ii[bi],ji=or[Sr.materialIndex];ji&&ji.visible&&G.push($e,jr,ji,Pt,qt.z,Sr)}else or.visible&&G.push($e,jr,or,Pt,qt.z,null)}}for(var la=$e.children,Ur=0,Bi=la.length;Ur<Bi;Ur++)Rs(la[Ur],Ut,Pt,Vt)}}function Al($e,Ut,Pt){for(var Vt=Ut.isScene===!0?Ut.overrideMaterial:null,cn=0,Ir=$e.length;cn<Ir;cn++){var Mr=$e[cn],jr=Mr.object,or=Mr.geometry,Ii=Vt===null?Mr.material:Vt,bi=Mr.group;if(Pt.isArrayCamera)for(var xr=Pt.cameras,Sr=0,ji=xr.length;Sr<ji;Sr++){var la=xr[Sr];jr.layers.test(la.layers)&&(sr.viewport(Ue.copy(la.viewport)),z.setupLightsView(la),Rc(jr,Ut,la,or,Ii,bi))}else Rc(jr,Ut,Pt,or,Ii,bi)}}function Rc($e,Ut,Pt,Vt,cn,Ir){if($e.onBeforeRender(Q,Ut,Pt,Vt,cn,Ir),$e.modelViewMatrix.multiplyMatrices(Pt.matrixWorldInverse,$e.matrixWorld),$e.normalMatrix.getNormalMatrix($e.modelViewMatrix),$e.isImmediateRenderObject){var Mr=qf(Pt,Ut,cn,$e);sr.setMaterial(cn),tn.reset(),wl($e,Mr)}else Q.renderBufferDirect(Pt,Ut,Vt,cn,$e,Ir);$e.onAfterRender(Q,Ut,Pt,Vt,cn,Ir)}function Ya($e,Ut,Pt){Ut.isScene!==!0&&(Ut=en);var Vt=Or.get($e),cn=z.state.lights,Ir=z.state.shadowsArray,Mr=cn.state.version,jr=lt.getParameters($e,cn.state,Ir,Ut,Pt),or=lt.getProgramCacheKey(jr),Ii=Vt.program,bi=!0;if(Vt.environment=$e.isMeshStandardMaterial?Ut.environment:null,Vt.fog=Ut.fog,Vt.envMap=Di.get($e.envMap||Vt.environment),Ii===void 0)$e.addEventListener("dispose",Wr);else if(Ii.cacheKey!==or)Nu($e);else if(Vt.lightsStateVersion!==Mr)bi=!1;else{if(jr.shaderID!==void 0)return;bi=!1}bi&&(jr.uniforms=lt.getUniforms($e),$e.onBeforeCompile(jr,Q),Ii=lt.acquireProgram(jr,or),Vt.program=Ii,Vt.uniforms=jr.uniforms,Vt.outputEncoding=jr.outputEncoding);var xr=Vt.uniforms;(!$e.isShaderMaterial&&!$e.isRawShaderMaterial||$e.clipping===!0)&&(Vt.numClippingPlanes=rr.numPlanes,Vt.numIntersection=rr.numIntersection,xr.clippingPlanes=rr.uniform),Vt.needsLights=Km($e),Vt.lightsStateVersion=Mr,Vt.needsLights&&(xr.ambientLightColor.value=cn.state.ambient,xr.lightProbe.value=cn.state.probe,xr.directionalLights.value=cn.state.directional,xr.directionalLightShadows.value=cn.state.directionalShadow,xr.spotLights.value=cn.state.spot,xr.spotLightShadows.value=cn.state.spotShadow,xr.rectAreaLights.value=cn.state.rectArea,xr.ltc_1.value=cn.state.rectAreaLTC1,xr.ltc_2.value=cn.state.rectAreaLTC2,xr.pointLights.value=cn.state.point,xr.pointLightShadows.value=cn.state.pointShadow,xr.hemisphereLights.value=cn.state.hemi,xr.directionalShadowMap.value=cn.state.directionalShadowMap,xr.directionalShadowMatrix.value=cn.state.directionalShadowMatrix,xr.spotShadowMap.value=cn.state.spotShadowMap,xr.spotShadowMatrix.value=cn.state.spotShadowMatrix,xr.pointShadowMap.value=cn.state.pointShadowMap,xr.pointShadowMatrix.value=cn.state.pointShadowMatrix);var Sr=Vt.program.getUniforms(),ji=ll.seqWithValue(Sr.seq,xr);Vt.uniformsList=ji}function qf($e,Ut,Pt,Vt){Ut.isScene!==!0&&(Ut=en),$r.resetTextureUnits();var cn=Ut.fog,Ir=Pt.isMeshStandardMaterial?Ut.environment:null,Mr=Oe===null?Q.outputEncoding:Oe.texture.encoding,jr=Di.get(Pt.envMap||Ir),or=Or.get(Pt),Ii=z.state.lights;if(gt===!0&&(St===!0||$e!==we)){var bi=$e===we&&Pt.id===Re;rr.setState(Pt,$e,bi)}Pt.version===or.__version?(Pt.fog&&or.fog!==cn||or.environment!==Ir||or.needsLights&&or.lightsStateVersion!==Ii.state.version||or.numClippingPlanes!==void 0&&(or.numClippingPlanes!==rr.numPlanes||or.numIntersection!==rr.numIntersection)||or.outputEncoding!==Mr||or.envMap!==jr)&&Ya(Pt,Ut,Vt):(Ya(Pt,Ut,Vt),or.__version=Pt.version);var xr=!1,Sr=!1,ji=!1,la=or.program,Ur=la.getUniforms(),Bi=or.uniforms;if(sr.useProgram(la.program)&&(xr=!0,Sr=!0,ji=!0),Pt.id!==Re&&(Re=Pt.id,Sr=!0),xr||we!==$e){if(Ur.setValue(Lt,"projectionMatrix",$e.projectionMatrix),gr.logarithmicDepthBuffer&&Ur.setValue(Lt,"logDepthBufFC",2/(Math.log($e.far+1)/Math.LN2)),we!==$e&&(we=$e,Sr=!0,ji=!0),Pt.isShaderMaterial||Pt.isMeshPhongMaterial||Pt.isMeshToonMaterial||Pt.isMeshStandardMaterial||Pt.envMap){var Fr=Ur.map.cameraPosition;Fr!==void 0&&Fr.setValue(Lt,qt.setFromMatrixPosition($e.matrixWorld))}(Pt.isMeshPhongMaterial||Pt.isMeshToonMaterial||Pt.isMeshLambertMaterial||Pt.isMeshBasicMaterial||Pt.isMeshStandardMaterial||Pt.isShaderMaterial)&&Ur.setValue(Lt,"isOrthographic",$e.isOrthographicCamera===!0),(Pt.isMeshPhongMaterial||Pt.isMeshToonMaterial||Pt.isMeshLambertMaterial||Pt.isMeshBasicMaterial||Pt.isMeshStandardMaterial||Pt.isShaderMaterial||Pt.isShadowMaterial||Pt.skinning)&&Ur.setValue(Lt,"viewMatrix",$e.matrixWorldInverse)}if(Pt.skinning){Ur.setOptional(Lt,Vt,"bindMatrix"),Ur.setOptional(Lt,Vt,"bindMatrixInverse");var hr=Vt.skeleton;if(hr){var Hr=hr.bones;if(gr.floatVertexTextures){if(hr.boneTexture===null){var Rr=Math.sqrt(Hr.length*4);Rr=er.ceilPowerOfTwo(Rr),Rr=Math.max(Rr,4);var kr=new Float32Array(Rr*Rr*4);kr.set(hr.boneMatrices);var vi=new As(kr,Rr,Rr,pn,vr);hr.boneMatrices=kr,hr.boneTexture=vi,hr.boneTextureSize=Rr}Ur.setValue(Lt,"boneTexture",hr.boneTexture,$r),Ur.setValue(Lt,"boneTextureSize",hr.boneTextureSize)}else Ur.setOptional(Lt,hr,"boneMatrices")}}return(Sr||or.receiveShadow!==Vt.receiveShadow)&&(or.receiveShadow=Vt.receiveShadow,Ur.setValue(Lt,"receiveShadow",Vt.receiveShadow)),Sr&&(Ur.setValue(Lt,"toneMappingExposure",Q.toneMappingExposure),or.needsLights&&Yf(Bi,ji),cn&&Pt.fog&&tt.refreshFogUniforms(Bi,cn),tt.refreshMaterialUniforms(Bi,Pt,st,ut),ll.upload(Lt,or.uniformsList,Bi,$r)),Pt.isShaderMaterial&&Pt.uniformsNeedUpdate===!0&&(ll.upload(Lt,or.uniformsList,Bi,$r),Pt.uniformsNeedUpdate=!1),Pt.isSpriteMaterial&&Ur.setValue(Lt,"center",Vt.center),Ur.setValue(Lt,"modelViewMatrix",Vt.modelViewMatrix),Ur.setValue(Lt,"normalMatrix",Vt.normalMatrix),Ur.setValue(Lt,"modelMatrix",Vt.matrixWorld),la}function Yf($e,Ut){$e.ambientLightColor.needsUpdate=Ut,$e.lightProbe.needsUpdate=Ut,$e.directionalLights.needsUpdate=Ut,$e.directionalLightShadows.needsUpdate=Ut,$e.pointLights.needsUpdate=Ut,$e.pointLightShadows.needsUpdate=Ut,$e.spotLights.needsUpdate=Ut,$e.spotLightShadows.needsUpdate=Ut,$e.rectAreaLights.needsUpdate=Ut,$e.hemisphereLights.needsUpdate=Ut}function Km($e){return $e.isMeshLambertMaterial||$e.isMeshToonMaterial||$e.isMeshPhongMaterial||$e.isMeshStandardMaterial||$e.isShadowMaterial||$e.isShaderMaterial&&$e.lights===!0}this.setTexture2D=function(){var $e=!1;return function(Pt,Vt){Pt&&Pt.isWebGLRenderTarget&&($e||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),$e=!0),Pt=Pt.texture),$r.setTexture2D(Pt,Vt)}}(),this.setFramebuffer=function($e){me!==$e&&Oe===null&&Lt.bindFramebuffer(36160,$e),me=$e},this.getActiveCubeFace=function(){return ue},this.getActiveMipmapLevel=function(){return re},this.getRenderList=function(){return G},this.setRenderList=function($e){G=$e},this.getRenderTarget=function(){return Oe},this.setRenderTarget=function($e,Ut,Pt){Ut===void 0&&(Ut=0),Pt===void 0&&(Pt=0),Oe=$e,ue=Ut,re=Pt,$e&&Or.get($e).__webglFramebuffer===void 0&&$r.setupRenderTarget($e);var Vt=me,cn=!1;if($e){var Ir=Or.get($e).__webglFramebuffer;$e.isWebGLCubeRenderTarget?(Vt=Ir[Ut],cn=!0):$e.isWebGLMultisampleRenderTarget?Vt=Or.get($e).__webglMultisampledFramebuffer:Vt=Ir,Ue.copy($e.viewport),rt.copy($e.scissor),nt=$e.scissorTest}else Ue.copy(at).multiplyScalar(st).floor(),rt.copy(it).multiplyScalar(st).floor(),nt=Ke;if(He!==Vt&&(Lt.bindFramebuffer(36160,Vt),He=Vt),sr.viewport(Ue),sr.scissor(rt),sr.setScissorTest(nt),cn){var Mr=Or.get($e.texture);Lt.framebufferTexture2D(36160,36064,34069+Ut,Mr.__webglTexture,Pt)}},this.readRenderTargetPixels=function($e,Ut,Pt,Vt,cn,Ir,Mr){if(!($e&&$e.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}var jr=Or.get($e).__webglFramebuffer;if($e.isWebGLCubeRenderTarget&&Mr!==void 0&&(jr=jr[Mr]),jr){var or=!1;jr!==He&&(Lt.bindFramebuffer(36160,jr),or=!0);try{var Ii=$e.texture,bi=Ii.format,xr=Ii.type;if(bi!==pn&&yn.convert(bi)!==Lt.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}var Sr=xr===je&&(ar.has("EXT_color_buffer_half_float")||gr.isWebGL2&&ar.has("EXT_color_buffer_float"));if(xr!==bn&&yn.convert(xr)!==Lt.getParameter(35738)&&!(xr===vr&&(gr.isWebGL2||ar.has("OES_texture_float")||ar.has("WEBGL_color_buffer_float")))&&!Sr){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Lt.checkFramebufferStatus(36160)===36053?Ut>=0&&Ut<=$e.width-Vt&&Pt>=0&&Pt<=$e.height-cn&&Lt.readPixels(Ut,Pt,Vt,cn,yn.convert(bi),yn.convert(xr),Ir):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{or&&Lt.bindFramebuffer(36160,He)}}},this.copyFramebufferToTexture=function($e,Ut,Pt){Pt===void 0&&(Pt=0);var Vt=Math.pow(2,-Pt),cn=Math.floor(Ut.image.width*Vt),Ir=Math.floor(Ut.image.height*Vt),Mr=yn.convert(Ut.format);$r.setTexture2D(Ut,0),Lt.copyTexImage2D(3553,Pt,Mr,$e.x,$e.y,cn,Ir,0),sr.unbindTexture()},this.copyTextureToTexture=function($e,Ut,Pt,Vt){Vt===void 0&&(Vt=0);var cn=Ut.image.width,Ir=Ut.image.height,Mr=yn.convert(Pt.format),jr=yn.convert(Pt.type);$r.setTexture2D(Pt,0),Lt.pixelStorei(37440,Pt.flipY),Lt.pixelStorei(37441,Pt.premultiplyAlpha),Lt.pixelStorei(3317,Pt.unpackAlignment),Ut.isDataTexture?Lt.texSubImage2D(3553,Vt,$e.x,$e.y,cn,Ir,Mr,jr,Ut.image.data):Ut.isCompressedTexture?Lt.compressedTexSubImage2D(3553,Vt,$e.x,$e.y,Ut.mipmaps[0].width,Ut.mipmaps[0].height,Mr,Ut.mipmaps[0].data):Lt.texSubImage2D(3553,Vt,$e.x,$e.y,Mr,jr,Ut.image),Vt===0&&Pt.generateMipmaps&&Lt.generateMipmap(3553),sr.unbindTexture()},this.initTexture=function($e){$r.setTexture2D($e,0),sr.unbindTexture()},this.resetState=function(){sr.reset(),tn.reset()},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function J0(p){Af.call(this,p)}J0.prototype=Object.assign(Object.create(Af.prototype),{constructor:J0,isWebGL1Renderer:!0});var kA=function(){function p(d,c){Object.defineProperty(this,"isFogExp2",{value:!0}),this.name="",this.color=new vn(d),this.density=c!==void 0?c:25e-5}var l=p.prototype;return l.clone=function(){return new p(this.color,this.density)},l.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},p}(),FA=function(){function p(d,c,h){Object.defineProperty(this,"isFog",{value:!0}),this.name="",this.color=new vn(d),this.near=c!==void 0?c:1,this.far=h!==void 0?h:1e3}var l=p.prototype;return l.clone=function(){return new p(this.color,this.near,this.far)},l.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},p}(),ey=function(p){pr(l,p);function l(){var c;return c=p.call(this)||this,Object.defineProperty(go(c),"isScene",{value:!0}),c.type="Scene",c.background=null,c.environment=null,c.fog=null,c.overrideMaterial=null,c.autoUpdate=!0,typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:go(c)})),c}var d=l.prototype;return d.copy=function(h,x){return p.prototype.copy.call(this,h,x),h.background!==null&&(this.background=h.background.clone()),h.environment!==null&&(this.environment=h.environment.clone()),h.fog!==null&&(this.fog=h.fog.clone()),h.overrideMaterial!==null&&(this.overrideMaterial=h.overrideMaterial.clone()),this.autoUpdate=h.autoUpdate,this.matrixAutoUpdate=h.matrixAutoUpdate,this},d.toJSON=function(h){var x=p.prototype.toJSON.call(this,h);return this.background!==null&&(x.object.background=this.background.toJSON(h)),this.environment!==null&&(x.object.environment=this.environment.toJSON(h)),this.fog!==null&&(x.object.fog=this.fog.toJSON()),x},l}(Dn);function Wa(p,l){this.array=p,this.stride=l,this.count=p!==void 0?p.length/l:0,this.usage=tf,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=er.generateUUID()}Object.defineProperty(Wa.prototype,"needsUpdate",{set:function(l){l===!0&&this.version++}}),Object.assign(Wa.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(l){return this.usage=l,this},copy:function(l){return this.array=new l.array.constructor(l.array),this.count=l.count,this.stride=l.stride,this.usage=l.usage,this},copyAt:function(l,d,c){l*=this.stride,c*=d.stride;for(var h=0,x=this.stride;h<x;h++)this.array[l+h]=d.array[c+h];return this},set:function(l,d){return d===void 0&&(d=0),this.array.set(l,d),this},clone:function(l){l.arrayBuffers===void 0&&(l.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=er.generateUUID()),l.arrayBuffers[this.array.buffer._uuid]===void 0&&(l.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);var d=new this.array.constructor(l.arrayBuffers[this.array.buffer._uuid]),c=new Wa(d,this.stride);return c.setUsage(this.usage),c},onUpload:function(l){return this.onUploadCallback=l,this},toJSON:function(l){return l.arrayBuffers===void 0&&(l.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=er.generateUUID()),l.arrayBuffers[this.array.buffer._uuid]===void 0&&(l.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});var dc=new Ge;function hl(p,l,d,c){this.name="",this.data=p,this.itemSize=l,this.offset=d,this.normalized=c===!0}Object.defineProperties(hl.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(l){this.data.needsUpdate=l}}}),Object.assign(hl.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(l){for(var d=0,c=this.data.count;d<c;d++)dc.x=this.getX(d),dc.y=this.getY(d),dc.z=this.getZ(d),dc.applyMatrix4(l),this.setXYZ(d,dc.x,dc.y,dc.z);return this},setX:function(l,d){return this.data.array[l*this.data.stride+this.offset]=d,this},setY:function(l,d){return this.data.array[l*this.data.stride+this.offset+1]=d,this},setZ:function(l,d){return this.data.array[l*this.data.stride+this.offset+2]=d,this},setW:function(l,d){return this.data.array[l*this.data.stride+this.offset+3]=d,this},getX:function(l){return this.data.array[l*this.data.stride+this.offset]},getY:function(l){return this.data.array[l*this.data.stride+this.offset+1]},getZ:function(l){return this.data.array[l*this.data.stride+this.offset+2]},getW:function(l){return this.data.array[l*this.data.stride+this.offset+3]},setXY:function(l,d,c){return l=l*this.data.stride+this.offset,this.data.array[l+0]=d,this.data.array[l+1]=c,this},setXYZ:function(l,d,c,h){return l=l*this.data.stride+this.offset,this.data.array[l+0]=d,this.data.array[l+1]=c,this.data.array[l+2]=h,this},setXYZW:function(l,d,c,h,x){return l=l*this.data.stride+this.offset,this.data.array[l+0]=d,this.data.array[l+1]=c,this.data.array[l+2]=h,this.data.array[l+3]=x,this},clone:function(l){if(l===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");for(var d=[],c=0;c<this.count;c++)for(var h=c*this.data.stride+this.offset,x=0;x<this.itemSize;x++)d.push(this.data.array[h+x]);return new Zn(new this.array.constructor(d),this.itemSize,this.normalized)}else return l.interleavedBuffers===void 0&&(l.interleavedBuffers={}),l.interleavedBuffers[this.data.uuid]===void 0&&(l.interleavedBuffers[this.data.uuid]=this.data.clone(l)),new hl(l.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(l){if(l===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");for(var d=[],c=0;c<this.count;c++)for(var h=c*this.data.stride+this.offset,x=0;x<this.itemSize;x++)d.push(this.data.array[h+x]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:d,normalized:this.normalized}}else return l.interleavedBuffers===void 0&&(l.interleavedBuffers={}),l.interleavedBuffers[this.data.uuid]===void 0&&(l.interleavedBuffers[this.data.uuid]=this.data.toJSON(l)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}});function fl(p){Kn.call(this),this.type="SpriteMaterial",this.color=new vn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(p)}fl.prototype=Object.create(Kn.prototype),fl.prototype.constructor=fl,fl.prototype.isSpriteMaterial=!0,fl.prototype.copy=function(p){return Kn.prototype.copy.call(this,p),this.color.copy(p.color),this.map=p.map,this.alphaMap=p.alphaMap,this.rotation=p.rotation,this.sizeAttenuation=p.sizeAttenuation,this};var wu,Ef=new Ge,Au=new Ge,Eu=new Ge,_u=new Zt,_f=new Zt,BA=new br,$p=new Ge,Mf=new Ge,Kp=new Ge,NA=new Zt,ty=new Zt,UA=new Zt;function Sf(p){if(Dn.call(this),this.type="Sprite",wu===void 0){wu=new Vn;var l=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),d=new Wa(l,5);wu.setIndex([0,1,2,0,2,3]),wu.setAttribute("position",new hl(d,3,0,!1)),wu.setAttribute("uv",new hl(d,2,3,!1))}this.geometry=wu,this.material=p!==void 0?p:new fl,this.center=new Zt(.5,.5)}Sf.prototype=Object.assign(Object.create(Dn.prototype),{constructor:Sf,isSprite:!0,raycast:function(l,d){l.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Au.setFromMatrixScale(this.matrixWorld),BA.copy(l.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(l.camera.matrixWorldInverse,this.matrixWorld),Eu.setFromMatrixPosition(this.modelViewMatrix),l.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Au.multiplyScalar(-Eu.z);var c=this.material.rotation,h,x;c!==0&&(x=Math.cos(c),h=Math.sin(c));var _=this.center;Zp($p.set(-.5,-.5,0),Eu,_,Au,h,x),Zp(Mf.set(.5,-.5,0),Eu,_,Au,h,x),Zp(Kp.set(.5,.5,0),Eu,_,Au,h,x),NA.set(0,0),ty.set(1,0),UA.set(1,1);var R=l.ray.intersectTriangle($p,Mf,Kp,!1,Ef);if(!(R===null&&(Zp(Mf.set(-.5,.5,0),Eu,_,Au,h,x),ty.set(0,1),R=l.ray.intersectTriangle($p,Kp,Mf,!1,Ef),R===null))){var O=l.ray.origin.distanceTo(Ef);O<l.near||O>l.far||d.push({distance:O,point:Ef.clone(),uv:Go.getUV(Ef,$p,Mf,Kp,NA,ty,UA,new Zt),face:null,object:this})}},copy:function(l){return Dn.prototype.copy.call(this,l),l.center!==void 0&&this.center.copy(l.center),this.material=l.material,this}});function Zp(p,l,d,c,h,x){_u.subVectors(p,d).addScalar(.5).multiply(c),h!==void 0?(_f.x=x*_u.x-h*_u.y,_f.y=h*_u.x+x*_u.y):_f.copy(_u),p.copy(l),p.x+=_f.x,p.y+=_f.y,p.applyMatrix4(BA)}var Qp=new Ge,HA=new Ge;function Tf(){Dn.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}Tf.prototype=Object.assign(Object.create(Dn.prototype),{constructor:Tf,isLOD:!0,copy:function(l){Dn.prototype.copy.call(this,l,!1);for(var d=l.levels,c=0,h=d.length;c<h;c++){var x=d[c];this.addLevel(x.object.clone(),x.distance)}return this.autoUpdate=l.autoUpdate,this},addLevel:function(l,d){d===void 0&&(d=0),d=Math.abs(d);var c=this.levels,h;for(h=0;h<c.length&&!(d<c[h].distance);h++);return c.splice(h,0,{distance:d,object:l}),this.add(l),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(l){var d=this.levels;if(d.length>0){var c,h;for(c=1,h=d.length;c<h&&!(l<d[c].distance);c++);return d[c-1].object}return null},raycast:function(l,d){var c=this.levels;if(c.length>0){Qp.setFromMatrixPosition(this.matrixWorld);var h=l.ray.origin.distanceTo(Qp);this.getObjectForDistance(h).raycast(l,d)}},update:function(l){var d=this.levels;if(d.length>1){Qp.setFromMatrixPosition(l.matrixWorld),HA.setFromMatrixPosition(this.matrixWorld);var c=Qp.distanceTo(HA)/l.zoom;d[0].object.visible=!0;var h,x;for(h=1,x=d.length;h<x&&c>=d[h].distance;h++)d[h-1].object.visible=!1,d[h].object.visible=!0;for(this._currentLevel=h-1;h<x;h++)d[h].object.visible=!1}},toJSON:function(l){var d=Dn.prototype.toJSON.call(this,l);this.autoUpdate===!1&&(d.object.autoUpdate=!1),d.object.levels=[];for(var c=this.levels,h=0,x=c.length;h<x;h++){var _=c[h];d.object.levels.push({object:_.object.uuid,distance:_.distance})}return d}});var zA=new Ge,GA=new Yr,VA=new Yr,SI=new Ge,WA=new br;function Cf(p,l){p&&p.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),fi.call(this,p,l),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new br,this.bindMatrixInverse=new br}Cf.prototype=Object.assign(Object.create(fi.prototype),{constructor:Cf,isSkinnedMesh:!0,copy:function(l){return fi.prototype.copy.call(this,l),this.bindMode=l.bindMode,this.bindMatrix.copy(l.bindMatrix),this.bindMatrixInverse.copy(l.bindMatrixInverse),this.skeleton=l.skeleton,this},bind:function(l,d){this.skeleton=l,d===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),d=this.matrixWorld),this.bindMatrix.copy(d),this.bindMatrixInverse.copy(d).invert()},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var l=new Yr,d=this.geometry.attributes.skinWeight,c=0,h=d.count;c<h;c++){l.x=d.getX(c),l.y=d.getY(c),l.z=d.getZ(c),l.w=d.getW(c);var x=1/l.manhattanLength();x!==1/0?l.multiplyScalar(x):l.set(1,0,0,0),d.setXYZW(c,l.x,l.y,l.z,l.w)}},updateMatrixWorld:function(l){fi.prototype.updateMatrixWorld.call(this,l),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(l,d){var c=this.skeleton,h=this.geometry;GA.fromBufferAttribute(h.attributes.skinIndex,l),VA.fromBufferAttribute(h.attributes.skinWeight,l),zA.fromBufferAttribute(h.attributes.position,l).applyMatrix4(this.bindMatrix),d.set(0,0,0);for(var x=0;x<4;x++){var _=VA.getComponent(x);if(_!==0){var R=GA.getComponent(x);WA.multiplyMatrices(c.bones[R].matrixWorld,c.boneInverses[R]),d.addScaledVector(SI.copy(zA).applyMatrix4(WA),_)}}return d.applyMatrix4(this.bindMatrixInverse)}});function Rf(){Dn.call(this),this.type="Bone"}Rf.prototype=Object.assign(Object.create(Dn.prototype),{constructor:Rf,isBone:!0});var jA=new br,TI=new br;function Lf(p,l){p===void 0&&(p=[]),l===void 0&&(l=[]),this.uuid=er.generateUUID(),this.bones=p.slice(0),this.boneInverses=l,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}Object.assign(Lf.prototype,{init:function(){var l=this.bones,d=this.boneInverses;if(this.boneMatrices=new Float32Array(l.length*16),d.length===0)this.calculateInverses();else if(l.length!==d.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(var c=0,h=this.bones.length;c<h;c++)this.boneInverses.push(new br)}},calculateInverses:function(){this.boneInverses.length=0;for(var l=0,d=this.bones.length;l<d;l++){var c=new br;this.bones[l]&&c.copy(this.bones[l].matrixWorld).invert(),this.boneInverses.push(c)}},pose:function(){for(var l=0,d=this.bones.length;l<d;l++){var c=this.bones[l];c&&c.matrixWorld.copy(this.boneInverses[l]).invert()}for(var h=0,x=this.bones.length;h<x;h++){var _=this.bones[h];_&&(_.parent&&_.parent.isBone?(_.matrix.copy(_.parent.matrixWorld).invert(),_.matrix.multiply(_.matrixWorld)):_.matrix.copy(_.matrixWorld),_.matrix.decompose(_.position,_.quaternion,_.scale))}},update:function(){for(var l=this.bones,d=this.boneInverses,c=this.boneMatrices,h=this.boneTexture,x=0,_=l.length;x<_;x++){var R=l[x]?l[x].matrixWorld:TI;jA.multiplyMatrices(R,d[x]),jA.toArray(c,x*16)}h!==null&&(h.needsUpdate=!0)},clone:function(){return new Lf(this.bones,this.boneInverses)},getBoneByName:function(l){for(var d=0,c=this.bones.length;d<c;d++){var h=this.bones[d];if(h.name===l)return h}},dispose:function(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)},fromJSON:function(l,d){this.uuid=l.uuid;for(var c=0,h=l.bones.length;c<h;c++){var x=l.bones[c],_=d[x];_===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",x),_=new Rf),this.bones.push(_),this.boneInverses.push(new br().fromArray(l.boneInverses[c]))}return this.init(),this},toJSON:function(){var l={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};l.uuid=this.uuid;for(var d=this.bones,c=this.boneInverses,h=0,x=d.length;h<x;h++){var _=d[h];l.bones.push(_.uuid);var R=c[h];l.boneInverses.push(R.toArray())}return l}});var XA=new br,qA=new br,Jp=[],Pf=new fi;function em(p,l,d){fi.call(this,p,l),this.instanceMatrix=new Zn(new Float32Array(d*16),16),this.instanceColor=null,this.count=d,this.frustumCulled=!1}em.prototype=Object.assign(Object.create(fi.prototype),{constructor:em,isInstancedMesh:!0,copy:function(l){return fi.prototype.copy.call(this,l),this.instanceMatrix.copy(l.instanceMatrix),l.instanceColor!==null&&(this.instanceColor=l.instanceColor.clone()),this.count=l.count,this},getColorAt:function(l,d){d.fromArray(this.instanceColor.array,l*3)},getMatrixAt:function(l,d){d.fromArray(this.instanceMatrix.array,l*16)},raycast:function(l,d){var c=this.matrixWorld,h=this.count;if(Pf.geometry=this.geometry,Pf.material=this.material,Pf.material!==void 0)for(var x=0;x<h;x++){this.getMatrixAt(x,XA),qA.multiplyMatrices(c,XA),Pf.matrixWorld=qA,Pf.raycast(l,Jp);for(var _=0,R=Jp.length;_<R;_++){var O=Jp[_];O.instanceId=x,O.object=this,d.push(O)}Jp.length=0}},setColorAt:function(l,d){this.instanceColor===null&&(this.instanceColor=new Zn(new Float32Array(this.count*3),3)),d.toArray(this.instanceColor.array,l*3)},setMatrixAt:function(l,d){d.toArray(this.instanceMatrix.array,l*16)},updateMorphTargets:function(){},dispose:function(){this.dispatchEvent({type:"dispose"})}});function yi(p){Kn.call(this),this.type="LineBasicMaterial",this.color=new vn(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(p)}yi.prototype=Object.create(Kn.prototype),yi.prototype.constructor=yi,yi.prototype.isLineBasicMaterial=!0,yi.prototype.copy=function(p){return Kn.prototype.copy.call(this,p),this.color.copy(p.color),this.linewidth=p.linewidth,this.linecap=p.linecap,this.linejoin=p.linejoin,this.morphTargets=p.morphTargets,this};var YA=new Ge,$A=new Ge,KA=new br,ny=new su,tm=new nl;function ao(p,l){p===void 0&&(p=new Vn),l===void 0&&(l=new yi),Dn.call(this),this.type="Line",this.geometry=p,this.material=l,this.updateMorphTargets()}ao.prototype=Object.assign(Object.create(Dn.prototype),{constructor:ao,isLine:!0,copy:function(l){return Dn.prototype.copy.call(this,l),this.material=l.material,this.geometry=l.geometry,this},computeLineDistances:function(){var l=this.geometry;if(l.isBufferGeometry)if(l.index===null){for(var d=l.attributes.position,c=[0],h=1,x=d.count;h<x;h++)YA.fromBufferAttribute(d,h-1),$A.fromBufferAttribute(d,h),c[h]=c[h-1],c[h]+=YA.distanceTo($A);l.setAttribute("lineDistance",new xn(c,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else l.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this},raycast:function(l,d){var c=this.geometry,h=this.matrixWorld,x=l.params.Line.threshold;if(c.boundingSphere===null&&c.computeBoundingSphere(),tm.copy(c.boundingSphere),tm.applyMatrix4(h),tm.radius+=x,l.ray.intersectsSphere(tm)!==!1){KA.copy(h).invert(),ny.copy(l.ray).applyMatrix4(KA);var _=x/((this.scale.x+this.scale.y+this.scale.z)/3),R=_*_,O=new Ge,B=new Ge,V=new Ge,G=new Ge,z=this.isLineSegments?2:1;if(c.isBufferGeometry){var ne=c.index,Q=c.attributes,le=Q.position;if(ne!==null)for(var me=ne.array,ue=0,re=me.length-1;ue<re;ue+=z){var Oe=me[ue],He=me[ue+1];O.fromBufferAttribute(le,Oe),B.fromBufferAttribute(le,He);var Re=ny.distanceSqToSegment(O,B,G,V);if(!(Re>R)){G.applyMatrix4(this.matrixWorld);var we=l.ray.origin.distanceTo(G);we<l.near||we>l.far||d.push({distance:we,point:V.clone().applyMatrix4(this.matrixWorld),index:ue,face:null,faceIndex:null,object:this})}}else for(var Ue=0,rt=le.count-1;Ue<rt;Ue+=z){O.fromBufferAttribute(le,Ue),B.fromBufferAttribute(le,Ue+1);var nt=ny.distanceSqToSegment(O,B,G,V);if(!(nt>R)){G.applyMatrix4(this.matrixWorld);var ot=l.ray.origin.distanceTo(G);ot<l.near||ot>l.far||d.push({distance:ot,point:V.clone().applyMatrix4(this.matrixWorld),index:Ue,face:null,faceIndex:null,object:this})}}}else c.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},updateMorphTargets:function(){var l=this.geometry;if(l.isBufferGeometry){var d=l.morphAttributes,c=Object.keys(d);if(c.length>0){var h=d[c[0]];if(h!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var x=0,_=h.length;x<_;x++){var R=h[x].name||String(x);this.morphTargetInfluences.push(0),this.morphTargetDictionary[R]=x}}}}else{var O=l.morphTargets;O!==void 0&&O.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});var ZA=new Ge,QA=new Ge;function Aa(p,l){ao.call(this,p,l),this.type="LineSegments"}Aa.prototype=Object.assign(Object.create(ao.prototype),{constructor:Aa,isLineSegments:!0,computeLineDistances:function(){var l=this.geometry;if(l.isBufferGeometry)if(l.index===null){for(var d=l.attributes.position,c=[],h=0,x=d.count;h<x;h+=2)ZA.fromBufferAttribute(d,h),QA.fromBufferAttribute(d,h+1),c[h]=h===0?0:c[h-1],c[h+1]=c[h]+ZA.distanceTo(QA);l.setAttribute("lineDistance",new xn(c,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else l.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}});function nm(p,l){ao.call(this,p,l),this.type="LineLoop"}nm.prototype=Object.assign(Object.create(ao.prototype),{constructor:nm,isLineLoop:!0});function Ao(p){Kn.call(this),this.type="PointsMaterial",this.color=new vn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(p)}Ao.prototype=Object.create(Kn.prototype),Ao.prototype.constructor=Ao,Ao.prototype.isPointsMaterial=!0,Ao.prototype.copy=function(p){return Kn.prototype.copy.call(this,p),this.color.copy(p.color),this.map=p.map,this.alphaMap=p.alphaMap,this.size=p.size,this.sizeAttenuation=p.sizeAttenuation,this.morphTargets=p.morphTargets,this};var JA=new br,ry=new su,rm=new nl,im=new Ge;function Mu(p,l){p===void 0&&(p=new Vn),l===void 0&&(l=new Ao),Dn.call(this),this.type="Points",this.geometry=p,this.material=l,this.updateMorphTargets()}Mu.prototype=Object.assign(Object.create(Dn.prototype),{constructor:Mu,isPoints:!0,copy:function(l){return Dn.prototype.copy.call(this,l),this.material=l.material,this.geometry=l.geometry,this},raycast:function(l,d){var c=this.geometry,h=this.matrixWorld,x=l.params.Points.threshold;if(c.boundingSphere===null&&c.computeBoundingSphere(),rm.copy(c.boundingSphere),rm.applyMatrix4(h),rm.radius+=x,l.ray.intersectsSphere(rm)!==!1){JA.copy(h).invert(),ry.copy(l.ray).applyMatrix4(JA);var _=x/((this.scale.x+this.scale.y+this.scale.z)/3),R=_*_;if(c.isBufferGeometry){var O=c.index,B=c.attributes,V=B.position;if(O!==null)for(var G=O.array,z=0,ne=G.length;z<ne;z++){var Q=G[z];im.fromBufferAttribute(V,Q),eE(im,Q,R,h,l,d,this)}else for(var le=0,me=V.count;le<me;le++)im.fromBufferAttribute(V,le),eE(im,le,R,h,l,d,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},updateMorphTargets:function(){var l=this.geometry;if(l.isBufferGeometry){var d=l.morphAttributes,c=Object.keys(d);if(c.length>0){var h=d[c[0]];if(h!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var x=0,_=h.length;x<_;x++){var R=h[x].name||String(x);this.morphTargetInfluences.push(0),this.morphTargetDictionary[R]=x}}}}else{var O=l.morphTargets;O!==void 0&&O.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});function eE(p,l,d,c,h,x,_){var R=ry.distanceSqToPoint(p);if(R<d){var O=new Ge;ry.closestPointToPoint(p,O),O.applyMatrix4(c);var B=h.ray.origin.distanceTo(O);if(B<h.near||B>h.far)return;x.push({distance:B,distanceToRay:Math.sqrt(R),point:O,index:l,face:null,object:_})}}function iy(p,l,d,c,h,x,_,R,O){ii.call(this,p,l,d,c,h,x,_,R,O),this.format=_!==void 0?_:Sn,this.minFilter=x!==void 0?x:Ft,this.magFilter=h!==void 0?h:Ft,this.generateMipmaps=!1;var B=this;function V(){B.needsUpdate=!0,p.requestVideoFrameCallback(V)}"requestVideoFrameCallback"in p&&p.requestVideoFrameCallback(V)}iy.prototype=Object.assign(Object.create(ii.prototype),{constructor:iy,clone:function(){return new this.constructor(this.image).copy(this)},isVideoTexture:!0,update:function(){var l=this.image,d="requestVideoFrameCallback"in l;d===!1&&l.readyState>=l.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}});function Su(p,l,d,c,h,x,_,R,O,B,V,G){ii.call(this,null,x,_,R,O,B,c,h,V,G),this.image={width:l,height:d},this.mipmaps=p,this.flipY=!1,this.generateMipmaps=!1}Su.prototype=Object.create(ii.prototype),Su.prototype.constructor=Su,Su.prototype.isCompressedTexture=!0;function Df(p,l,d,c,h,x,_,R,O){ii.call(this,p,l,d,c,h,x,_,R,O),this.needsUpdate=!0}Df.prototype=Object.create(ii.prototype),Df.prototype.constructor=Df,Df.prototype.isCanvasTexture=!0;function Of(p,l,d,c,h,x,_,R,O,B){if(B=B!==void 0?B:bt,B!==bt&&B!==yt)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");d===void 0&&B===bt&&(d=cr),d===void 0&&B===yt&&(d=Gt),ii.call(this,null,c,h,x,_,R,B,d,O),this.image={width:p,height:l},this.magFilter=_!==void 0?_:Jt,this.minFilter=R!==void 0?R:Jt,this.flipY=!1,this.generateMipmaps=!1}Of.prototype=Object.create(ii.prototype),Of.prototype.constructor=Of,Of.prototype.isDepthTexture=!0;var am=function(p){pr(l,p);function l(d,c,h,x){var _;d===void 0&&(d=1),c===void 0&&(c=8),h===void 0&&(h=0),x===void 0&&(x=Math.PI*2),_=p.call(this)||this,_.type="CircleGeometry",_.parameters={radius:d,segments:c,thetaStart:h,thetaLength:x},c=Math.max(3,c);var R=[],O=[],B=[],V=[],G=new Ge,z=new Zt;O.push(0,0,0),B.push(0,0,1),V.push(.5,.5);for(var ne=0,Q=3;ne<=c;ne++,Q+=3){var le=h+ne/c*x;G.x=d*Math.cos(le),G.y=d*Math.sin(le),O.push(G.x,G.y,G.z),B.push(0,0,1),z.x=(O[Q]/d+1)/2,z.y=(O[Q+1]/d+1)/2,V.push(z.x,z.y)}for(var me=1;me<=c;me++)R.push(me,me+1,0);return _.setIndex(R),_.setAttribute("position",new xn(O,3)),_.setAttribute("normal",new xn(B,3)),_.setAttribute("uv",new xn(V,2)),_}return l}(Vn),Tu=function(p){pr(l,p);function l(d,c,h,x,_,R,O,B){var V;d===void 0&&(d=1),c===void 0&&(c=1),h===void 0&&(h=1),x===void 0&&(x=8),_===void 0&&(_=1),R===void 0&&(R=!1),O===void 0&&(O=0),B===void 0&&(B=Math.PI*2),V=p.call(this)||this,V.type="CylinderGeometry",V.parameters={radiusTop:d,radiusBottom:c,height:h,radialSegments:x,heightSegments:_,openEnded:R,thetaStart:O,thetaLength:B};var G=go(V);x=Math.floor(x),_=Math.floor(_);var z=[],ne=[],Q=[],le=[],me=0,ue=[],re=h/2,Oe=0;He(),R===!1&&(d>0&&Re(!0),c>0&&Re(!1)),V.setIndex(z),V.setAttribute("position",new xn(ne,3)),V.setAttribute("normal",new xn(Q,3)),V.setAttribute("uv",new xn(le,2));function He(){for(var we=new Ge,Ue=new Ge,rt=0,nt=(c-d)/h,ot=0;ot<=_;ot++){for(var ut=[],st=ot/_,et=st*(c-d)+d,dt=0;dt<=x;dt++){var at=dt/x,it=at*B+O,Ke=Math.sin(it),vt=Math.cos(it);Ue.x=et*Ke,Ue.y=-st*h+re,Ue.z=et*vt,ne.push(Ue.x,Ue.y,Ue.z),we.set(Ke,nt,vt).normalize(),Q.push(we.x,we.y,we.z),le.push(at,1-st),ut.push(me++)}ue.push(ut)}for(var gt=0;gt<x;gt++)for(var St=0;St<_;St++){var Tt=ue[St][gt],qt=ue[St+1][gt],en=ue[St+1][gt+1],_n=ue[St][gt+1];z.push(Tt,qt,_n),z.push(qt,en,_n),rt+=6}G.addGroup(Oe,rt,0),Oe+=rt}function Re(we){for(var Ue=me,rt=new Zt,nt=new Ge,ot=0,ut=we===!0?d:c,st=we===!0?1:-1,et=1;et<=x;et++)ne.push(0,re*st,0),Q.push(0,st,0),le.push(.5,.5),me++;for(var dt=me,at=0;at<=x;at++){var it=at/x,Ke=it*B+O,vt=Math.cos(Ke),gt=Math.sin(Ke);nt.x=ut*gt,nt.y=re*st,nt.z=ut*vt,ne.push(nt.x,nt.y,nt.z),Q.push(0,st,0),rt.x=vt*.5+.5,rt.y=gt*.5*st+.5,le.push(rt.x,rt.y),me++}for(var St=0;St<x;St++){var Tt=Ue+St,qt=dt+St;we===!0?z.push(qt,qt+1,Tt):z.push(qt+1,qt,Tt),ot+=3}G.addGroup(Oe,ot,we===!0?1:2),Oe+=ot}return V}return l}(Vn),om=function(p){pr(l,p);function l(d,c,h,x,_,R,O){var B;return d===void 0&&(d=1),c===void 0&&(c=1),h===void 0&&(h=8),x===void 0&&(x=1),_===void 0&&(_=!1),R===void 0&&(R=0),O===void 0&&(O=Math.PI*2),B=p.call(this,0,d,c,h,x,_,R,O)||this,B.type="ConeGeometry",B.parameters={radius:d,height:c,radialSegments:h,heightSegments:x,openEnded:_,thetaStart:R,thetaLength:O},B}return l}(Tu),dl=function(p){pr(l,p);function l(d,c,h,x){var _;h===void 0&&(h=1),x===void 0&&(x=0),_=p.call(this)||this,_.type="PolyhedronGeometry",_.parameters={vertices:d,indices:c,radius:h,detail:x};var R=[],O=[];B(x),G(h),z(),_.setAttribute("position",new xn(R,3)),_.setAttribute("normal",new xn(R.slice(),3)),_.setAttribute("uv",new xn(O,2)),x===0?_.computeVertexNormals():_.normalizeNormals();function B(He){for(var Re=new Ge,we=new Ge,Ue=new Ge,rt=0;rt<c.length;rt+=3)le(c[rt+0],Re),le(c[rt+1],we),le(c[rt+2],Ue),V(Re,we,Ue,He)}function V(He,Re,we,Ue){for(var rt=Ue+1,nt=[],ot=0;ot<=rt;ot++){nt[ot]=[];for(var ut=He.clone().lerp(we,ot/rt),st=Re.clone().lerp(we,ot/rt),et=rt-ot,dt=0;dt<=et;dt++)dt===0&&ot===rt?nt[ot][dt]=ut:nt[ot][dt]=ut.clone().lerp(st,dt/et)}for(var at=0;at<rt;at++)for(var it=0;it<2*(rt-at)-1;it++){var Ke=Math.floor(it/2);it%2==0?(Q(nt[at][Ke+1]),Q(nt[at+1][Ke]),Q(nt[at][Ke])):(Q(nt[at][Ke+1]),Q(nt[at+1][Ke+1]),Q(nt[at+1][Ke]))}}function G(He){for(var Re=new Ge,we=0;we<R.length;we+=3)Re.x=R[we+0],Re.y=R[we+1],Re.z=R[we+2],Re.normalize().multiplyScalar(He),R[we+0]=Re.x,R[we+1]=Re.y,R[we+2]=Re.z}function z(){for(var He=new Ge,Re=0;Re<R.length;Re+=3){He.x=R[Re+0],He.y=R[Re+1],He.z=R[Re+2];var we=re(He)/2/Math.PI+.5,Ue=Oe(He)/Math.PI+.5;O.push(we,1-Ue)}me(),ne()}function ne(){for(var He=0;He<O.length;He+=6){var Re=O[He+0],we=O[He+2],Ue=O[He+4],rt=Math.max(Re,we,Ue),nt=Math.min(Re,we,Ue);rt>.9&&nt<.1&&(Re<.2&&(O[He+0]+=1),we<.2&&(O[He+2]+=1),Ue<.2&&(O[He+4]+=1))}}function Q(He){R.push(He.x,He.y,He.z)}function le(He,Re){var we=He*3;Re.x=d[we+0],Re.y=d[we+1],Re.z=d[we+2]}function me(){for(var He=new Ge,Re=new Ge,we=new Ge,Ue=new Ge,rt=new Zt,nt=new Zt,ot=new Zt,ut=0,st=0;ut<R.length;ut+=9,st+=6){He.set(R[ut+0],R[ut+1],R[ut+2]),Re.set(R[ut+3],R[ut+4],R[ut+5]),we.set(R[ut+6],R[ut+7],R[ut+8]),rt.set(O[st+0],O[st+1]),nt.set(O[st+2],O[st+3]),ot.set(O[st+4],O[st+5]),Ue.copy(He).add(Re).add(we).divideScalar(3);var et=re(Ue);ue(rt,st+0,He,et),ue(nt,st+2,Re,et),ue(ot,st+4,we,et)}}function ue(He,Re,we,Ue){Ue<0&&He.x===1&&(O[Re]=He.x-1),we.x===0&&we.z===0&&(O[Re]=Ue/2/Math.PI+.5)}function re(He){return Math.atan2(He.z,-He.x)}function Oe(He){return Math.atan2(-He.y,Math.sqrt(He.x*He.x+He.z*He.z))}return _}return l}(Vn),sm=function(p){pr(l,p);function l(d,c){var h;d===void 0&&(d=1),c===void 0&&(c=0);var x=(1+Math.sqrt(5))/2,_=1/x,R=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-_,-x,0,-_,x,0,_,-x,0,_,x,-_,-x,0,-_,x,0,_,-x,0,_,x,0,-x,0,-_,x,0,-_,-x,0,_,x,0,_],O=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];return h=p.call(this,R,O,d,c)||this,h.type="DodecahedronGeometry",h.parameters={radius:d,detail:c},h}return l}(dl),lm=new Ge,cm=new Ge,ay=new Ge,Cu=new Go,oy=function(p){pr(l,p);function l(d,c){var h;if(h=p.call(this)||this,h.type="EdgesGeometry",h.parameters={thresholdAngle:c},c=c!==void 0?c:1,d.isGeometry===!0)return console.error("THREE.EdgesGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),go(h);for(var x=4,_=Math.pow(10,x),R=Math.cos(er.DEG2RAD*c),O=d.getIndex(),B=d.getAttribute("position"),V=O?O.count:B.count,G=[0,0,0],z=["a","b","c"],ne=new Array(3),Q={},le=[],me=0;me<V;me+=3){O?(G[0]=O.getX(me),G[1]=O.getX(me+1),G[2]=O.getX(me+2)):(G[0]=me,G[1]=me+1,G[2]=me+2);var ue=Cu.a,re=Cu.b,Oe=Cu.c;if(ue.fromBufferAttribute(B,G[0]),re.fromBufferAttribute(B,G[1]),Oe.fromBufferAttribute(B,G[2]),Cu.getNormal(ay),ne[0]=Math.round(ue.x*_)+","+Math.round(ue.y*_)+","+Math.round(ue.z*_),ne[1]=Math.round(re.x*_)+","+Math.round(re.y*_)+","+Math.round(re.z*_),ne[2]=Math.round(Oe.x*_)+","+Math.round(Oe.y*_)+","+Math.round(Oe.z*_),!(ne[0]===ne[1]||ne[1]===ne[2]||ne[2]===ne[0]))for(var He=0;He<3;He++){var Re=(He+1)%3,we=ne[He],Ue=ne[Re],rt=Cu[z[He]],nt=Cu[z[Re]],ot=we+"_"+Ue,ut=Ue+"_"+we;ut in Q&&Q[ut]?(ay.dot(Q[ut].normal)<=R&&(le.push(rt.x,rt.y,rt.z),le.push(nt.x,nt.y,nt.z)),Q[ut]=null):ot in Q||(Q[ot]={index0:G[He],index1:G[Re],normal:ay.clone()})}}for(var st in Q)if(Q[st]){var et=Q[st],dt=et.index0,at=et.index1;lm.fromBufferAttribute(B,dt),cm.fromBufferAttribute(B,at),le.push(lm.x,lm.y,lm.z),le.push(cm.x,cm.y,cm.z)}return h.setAttribute("position",new xn(le,3)),h}return l}(Vn),CI={triangulate:function(l,d,c){c=c||2;var h=d&&d.length,x=h?d[0]*c:l.length,_=tE(l,0,x,c,!0),R=[];if(!_||_.next===_.prev)return R;var O,B,V,G,z,ne,Q;if(h&&(_=OI(l,d,_,c)),l.length>80*c){O=V=l[0],B=G=l[1];for(var le=c;le<x;le+=c)z=l[le],ne=l[le+1],z<O&&(O=z),ne<B&&(B=ne),z>V&&(V=z),ne>G&&(G=ne);Q=Math.max(V-O,G-B),Q=Q!==0?1/Q:0}return If(_,R,c,O,B,Q),R}};function tE(p,l,d,c,h){var x,_;if(h===WI(p,l,d,c)>0)for(x=l;x<d;x+=c)_=iE(x,p[x],p[x+1],_);else for(x=d-c;x>=l;x-=c)_=iE(x,p[x],p[x+1],_);return _&&um(_,_.next)&&(Ff(_),_=_.next),_}function pl(p,l){if(!p)return p;l||(l=p);var d=p,c;do if(c=!1,!d.steiner&&(um(d,d.next)||wi(d.prev,d,d.next)===0)){if(Ff(d),d=l=d.prev,d===d.next)break;c=!0}else d=d.next;while(c||d!==l);return l}function If(p,l,d,c,h,x,_){if(!!p){!_&&x&&NI(p,c,h,x);for(var R=p,O,B;p.prev!==p.next;){if(O=p.prev,B=p.next,x?LI(p,c,h,x):RI(p)){l.push(O.i/d),l.push(p.i/d),l.push(B.i/d),Ff(p),p=B.next,R=B.next;continue}if(p=B,p===R){_?_===1?(p=PI(pl(p),l,d),If(p,l,d,c,h,x,2)):_===2&&DI(p,l,d,c,h,x):If(pl(p),l,d,c,h,x,1);break}}}}function RI(p){var l=p.prev,d=p,c=p.next;if(wi(l,d,c)>=0)return!1;for(var h=p.next.next;h!==p.prev;){if(Ru(l.x,l.y,d.x,d.y,c.x,c.y,h.x,h.y)&&wi(h.prev,h,h.next)>=0)return!1;h=h.next}return!0}function LI(p,l,d,c){var h=p.prev,x=p,_=p.next;if(wi(h,x,_)>=0)return!1;for(var R=h.x<x.x?h.x<_.x?h.x:_.x:x.x<_.x?x.x:_.x,O=h.y<x.y?h.y<_.y?h.y:_.y:x.y<_.y?x.y:_.y,B=h.x>x.x?h.x>_.x?h.x:_.x:x.x>_.x?x.x:_.x,V=h.y>x.y?h.y>_.y?h.y:_.y:x.y>_.y?x.y:_.y,G=sy(R,O,l,d,c),z=sy(B,V,l,d,c),ne=p.prevZ,Q=p.nextZ;ne&&ne.z>=G&&Q&&Q.z<=z;){if(ne!==p.prev&&ne!==p.next&&Ru(h.x,h.y,x.x,x.y,_.x,_.y,ne.x,ne.y)&&wi(ne.prev,ne,ne.next)>=0||(ne=ne.prevZ,Q!==p.prev&&Q!==p.next&&Ru(h.x,h.y,x.x,x.y,_.x,_.y,Q.x,Q.y)&&wi(Q.prev,Q,Q.next)>=0))return!1;Q=Q.nextZ}for(;ne&&ne.z>=G;){if(ne!==p.prev&&ne!==p.next&&Ru(h.x,h.y,x.x,x.y,_.x,_.y,ne.x,ne.y)&&wi(ne.prev,ne,ne.next)>=0)return!1;ne=ne.prevZ}for(;Q&&Q.z<=z;){if(Q!==p.prev&&Q!==p.next&&Ru(h.x,h.y,x.x,x.y,_.x,_.y,Q.x,Q.y)&&wi(Q.prev,Q,Q.next)>=0)return!1;Q=Q.nextZ}return!0}function PI(p,l,d){var c=p;do{var h=c.prev,x=c.next.next;!um(h,x)&&nE(h,c,c.next,x)&&kf(h,x)&&kf(x,h)&&(l.push(h.i/d),l.push(c.i/d),l.push(x.i/d),Ff(c),Ff(c.next),c=p=x),c=c.next}while(c!==p);return pl(c)}function DI(p,l,d,c,h,x){var _=p;do{for(var R=_.next.next;R!==_.prev;){if(_.i!==R.i&&zI(_,R)){var O=rE(_,R);_=pl(_,_.next),O=pl(O,O.next),If(_,l,d,c,h,x),If(O,l,d,c,h,x);return}R=R.next}_=_.next}while(_!==p)}function OI(p,l,d,c){var h=[],x,_,R,O,B;for(x=0,_=l.length;x<_;x++)R=l[x]*c,O=x<_-1?l[x+1]*c:p.length,B=tE(p,R,O,c,!1),B===B.next&&(B.steiner=!0),h.push(HI(B));for(h.sort(II),x=0;x<h.length;x++)kI(h[x],d),d=pl(d,d.next);return d}function II(p,l){return p.x-l.x}function kI(p,l){if(l=FI(p,l),l){var d=rE(l,p);pl(l,l.next),pl(d,d.next)}}function FI(p,l){var d=l,c=p.x,h=p.y,x=-1/0,_;do{if(h<=d.y&&h>=d.next.y&&d.next.y!==d.y){var R=d.x+(h-d.y)*(d.next.x-d.x)/(d.next.y-d.y);if(R<=c&&R>x){if(x=R,R===c){if(h===d.y)return d;if(h===d.next.y)return d.next}_=d.x<d.next.x?d:d.next}}d=d.next}while(d!==l);if(!_)return null;if(c===x)return _;var O=_,B=_.x,V=_.y,G=1/0,z;d=_;do c>=d.x&&d.x>=B&&c!==d.x&&Ru(h<V?c:x,h,B,V,h<V?x:c,h,d.x,d.y)&&(z=Math.abs(h-d.y)/(c-d.x),kf(d,p)&&(z<G||z===G&&(d.x>_.x||d.x===_.x&&BI(_,d)))&&(_=d,G=z)),d=d.next;while(d!==O);return _}function BI(p,l){return wi(p.prev,p,l.prev)<0&&wi(l.next,p,p.next)<0}function NI(p,l,d,c){var h=p;do h.z===null&&(h.z=sy(h.x,h.y,l,d,c)),h.prevZ=h.prev,h.nextZ=h.next,h=h.next;while(h!==p);h.prevZ.nextZ=null,h.prevZ=null,UI(h)}function UI(p){var l,d,c,h,x,_,R,O,B=1;do{for(d=p,p=null,x=null,_=0;d;){for(_++,c=d,R=0,l=0;l<B&&(R++,c=c.nextZ,!!c);l++);for(O=B;R>0||O>0&&c;)R!==0&&(O===0||!c||d.z<=c.z)?(h=d,d=d.nextZ,R--):(h=c,c=c.nextZ,O--),x?x.nextZ=h:p=h,h.prevZ=x,x=h;d=c}x.nextZ=null,B*=2}while(_>1);return p}function sy(p,l,d,c,h){return p=32767*(p-d)*h,l=32767*(l-c)*h,p=(p|p<<8)&16711935,p=(p|p<<4)&252645135,p=(p|p<<2)&858993459,p=(p|p<<1)&1431655765,l=(l|l<<8)&16711935,l=(l|l<<4)&252645135,l=(l|l<<2)&858993459,l=(l|l<<1)&1431655765,p|l<<1}function HI(p){var l=p,d=p;do(l.x<d.x||l.x===d.x&&l.y<d.y)&&(d=l),l=l.next;while(l!==p);return d}function Ru(p,l,d,c,h,x,_,R){return(h-_)*(l-R)-(p-_)*(x-R)>=0&&(p-_)*(c-R)-(d-_)*(l-R)>=0&&(d-_)*(x-R)-(h-_)*(c-R)>=0}function zI(p,l){return p.next.i!==l.i&&p.prev.i!==l.i&&!GI(p,l)&&(kf(p,l)&&kf(l,p)&&VI(p,l)&&(wi(p.prev,p,l.prev)||wi(p,l.prev,l))||um(p,l)&&wi(p.prev,p,p.next)>0&&wi(l.prev,l,l.next)>0)}function wi(p,l,d){return(l.y-p.y)*(d.x-l.x)-(l.x-p.x)*(d.y-l.y)}function um(p,l){return p.x===l.x&&p.y===l.y}function nE(p,l,d,c){var h=fm(wi(p,l,d)),x=fm(wi(p,l,c)),_=fm(wi(d,c,p)),R=fm(wi(d,c,l));return!!(h!==x&&_!==R||h===0&&hm(p,d,l)||x===0&&hm(p,c,l)||_===0&&hm(d,p,c)||R===0&&hm(d,l,c))}function hm(p,l,d){return l.x<=Math.max(p.x,d.x)&&l.x>=Math.min(p.x,d.x)&&l.y<=Math.max(p.y,d.y)&&l.y>=Math.min(p.y,d.y)}function fm(p){return p>0?1:p<0?-1:0}function GI(p,l){var d=p;do{if(d.i!==p.i&&d.next.i!==p.i&&d.i!==l.i&&d.next.i!==l.i&&nE(d,d.next,p,l))return!0;d=d.next}while(d!==p);return!1}function kf(p,l){return wi(p.prev,p,p.next)<0?wi(p,l,p.next)>=0&&wi(p,p.prev,l)>=0:wi(p,l,p.prev)<0||wi(p,p.next,l)<0}function VI(p,l){var d=p,c=!1,h=(p.x+l.x)/2,x=(p.y+l.y)/2;do d.y>x!=d.next.y>x&&d.next.y!==d.y&&h<(d.next.x-d.x)*(x-d.y)/(d.next.y-d.y)+d.x&&(c=!c),d=d.next;while(d!==p);return c}function rE(p,l){var d=new ly(p.i,p.x,p.y),c=new ly(l.i,l.x,l.y),h=p.next,x=l.prev;return p.next=l,l.prev=p,d.next=h,h.prev=d,c.next=d,d.prev=c,x.next=c,c.prev=x,c}function iE(p,l,d,c){var h=new ly(p,l,d);return c?(h.next=c.next,h.prev=c,c.next.prev=h,c.next=h):(h.prev=h,h.next=h),h}function Ff(p){p.next.prev=p.prev,p.prev.next=p.next,p.prevZ&&(p.prevZ.nextZ=p.nextZ),p.nextZ&&(p.nextZ.prevZ=p.prevZ)}function ly(p,l,d){this.i=p,this.x=l,this.y=d,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function WI(p,l,d,c){for(var h=0,x=l,_=d-c;x<d;x+=c)h+=(p[_]-p[x])*(p[x+1]+p[_+1]),_=x;return h}var _s={area:function(l){for(var d=l.length,c=0,h=d-1,x=0;x<d;h=x++)c+=l[h].x*l[x].y-l[x].x*l[h].y;return c*.5},isClockWise:function(l){return _s.area(l)<0},triangulateShape:function(l,d){var c=[],h=[],x=[];aE(l),oE(c,l);var _=l.length;d.forEach(aE);for(var R=0;R<d.length;R++)h.push(_),_+=d[R].length,oE(c,d[R]);for(var O=CI.triangulate(c,h),B=0;B<O.length;B+=3)x.push(O.slice(B,B+3));return x}};function aE(p){var l=p.length;l>2&&p[l-1].equals(p[0])&&p.pop()}function oE(p,l){for(var d=0;d<l.length;d++)p.push(l[d].x),p.push(l[d].y)}var pc=function(p){pr(l,p);function l(c,h){var x;x=p.call(this)||this,x.type="ExtrudeGeometry",x.parameters={shapes:c,options:h},c=Array.isArray(c)?c:[c];for(var _=go(x),R=[],O=[],B=0,V=c.length;B<V;B++){var G=c[B];z(G)}x.setAttribute("position",new xn(R,3)),x.setAttribute("uv",new xn(O,2)),x.computeVertexNormals();function z(ne){var Q=[],le=h.curveSegments!==void 0?h.curveSegments:12,me=h.steps!==void 0?h.steps:1,ue=h.depth!==void 0?h.depth:100,re=h.bevelEnabled!==void 0?h.bevelEnabled:!0,Oe=h.bevelThickness!==void 0?h.bevelThickness:6,He=h.bevelSize!==void 0?h.bevelSize:Oe-2,Re=h.bevelOffset!==void 0?h.bevelOffset:0,we=h.bevelSegments!==void 0?h.bevelSegments:3,Ue=h.extrudePath,rt=h.UVGenerator!==void 0?h.UVGenerator:jI;h.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),ue=h.amount);var nt,ot=!1,ut,st,et,dt;Ue&&(nt=Ue.getSpacedPoints(me),ot=!0,re=!1,ut=Ue.computeFrenetFrames(me,!1),st=new Ge,et=new Ge,dt=new Ge),re||(we=0,Oe=0,He=0,Re=0);var at=ne.extractPoints(le),it=at.shape,Ke=at.holes,vt=!_s.isClockWise(it);if(vt){it=it.reverse();for(var gt=0,St=Ke.length;gt<St;gt++){var Tt=Ke[gt];_s.isClockWise(Tt)&&(Ke[gt]=Tt.reverse())}}for(var qt=_s.triangulateShape(it,Ke),en=it,_n=0,Lt=Ke.length;_n<Lt;_n++){var Wn=Ke[_n];it=it.concat(Wn)}function gn(Fr,hr,Hr){return hr||console.error("THREE.ExtrudeGeometry: vec does not exist"),hr.clone().multiplyScalar(Hr).add(Fr)}var qn=it.length,ar=qt.length;function gr(Fr,hr,Hr){var Rr,kr,vi,ca=Fr.x-hr.x,ua=Fr.y-hr.y,_a=Hr.x-Fr.x,$a=Hr.y-Fr.y,Ls=ca*ca+ua*ua,jy=ca*$a-ua*_a;if(Math.abs(jy)>Number.EPSILON){var Zm=Math.sqrt(Ls),QE=Math.sqrt(_a*_a+$a*$a),JE=hr.x-ua/Zm,e_=hr.y+ca/Zm,EF=Hr.x-$a/QE,_F=Hr.y+_a/QE,t_=((EF-JE)*$a-(_F-e_)*_a)/(ca*$a-ua*_a);Rr=JE+ca*t_-Fr.x,kr=e_+ua*t_-Fr.y;var n_=Rr*Rr+kr*kr;if(n_<=2)return new Zt(Rr,kr);vi=Math.sqrt(n_/2)}else{var Qm=!1;ca>Number.EPSILON?_a>Number.EPSILON&&(Qm=!0):ca<-Number.EPSILON?_a<-Number.EPSILON&&(Qm=!0):Math.sign(ua)===Math.sign($a)&&(Qm=!0),Qm?(Rr=-ua,kr=ca,vi=Math.sqrt(Ls)):(Rr=ca,kr=ua,vi=Math.sqrt(Ls/2))}return new Zt(Rr/vi,kr/vi)}for(var sr=[],ai=0,Or=en.length,$r=Or-1,Di=ai+1;ai<Or;ai++,$r++,Di++)$r===Or&&($r=0),Di===Or&&(Di=0),sr[ai]=gr(en[ai],en[$r],en[Di]);for(var sa=[],Wi,Ti=sr.concat(),lt=0,tt=Ke.length;lt<tt;lt++){var dn=Ke[lt];Wi=[];for(var an=0,rr=dn.length,xt=rr-1,Mn=an+1;an<rr;an++,xt++,Mn++)xt===rr&&(xt=0),Mn===rr&&(Mn=0),Wi[an]=gr(dn[an],dn[xt],dn[Mn]);sa.push(Wi),Ti=Ti.concat(Wi)}for(var wn=0;wn<we;wn++){for(var Yn=wn/we,yn=Oe*Math.cos(Yn*Math.PI/2),tn=He*Math.sin(Yn*Math.PI/2)+Re,lr=0,yr=en.length;lr<yr;lr++){var Ai=gn(en[lr],sr[lr],tn);Sr(Ai.x,Ai.y,-yn)}for(var oi=0,Br=Ke.length;oi<Br;oi++){var Wr=Ke[oi];Wi=sa[oi];for(var Oi=0,Nu=Wr.length;Oi<Nu;Oi++){var wl=gn(Wr[Oi],Wi[Oi],tn);Sr(wl.x,wl.y,-yn)}}}for(var Ro=He+Re,Cs=0;Cs<qn;Cs++){var Zo=re?gn(it[Cs],Ti[Cs],Ro):it[Cs];ot?(et.copy(ut.normals[0]).multiplyScalar(Zo.x),st.copy(ut.binormals[0]).multiplyScalar(Zo.y),dt.copy(nt[0]).add(et).add(st),Sr(dt.x,dt.y,dt.z)):Sr(Zo.x,Zo.y,0)}for(var Rs=1;Rs<=me;Rs++)for(var Al=0;Al<qn;Al++){var Rc=re?gn(it[Al],Ti[Al],Ro):it[Al];ot?(et.copy(ut.normals[Rs]).multiplyScalar(Rc.x),st.copy(ut.binormals[Rs]).multiplyScalar(Rc.y),dt.copy(nt[Rs]).add(et).add(st),Sr(dt.x,dt.y,dt.z)):Sr(Rc.x,Rc.y,ue/me*Rs)}for(var Ya=we-1;Ya>=0;Ya--){for(var qf=Ya/we,Yf=Oe*Math.cos(qf*Math.PI/2),Km=He*Math.sin(qf*Math.PI/2)+Re,$e=0,Ut=en.length;$e<Ut;$e++){var Pt=gn(en[$e],sr[$e],Km);Sr(Pt.x,Pt.y,ue+Yf)}for(var Vt=0,cn=Ke.length;Vt<cn;Vt++){var Ir=Ke[Vt];Wi=sa[Vt];for(var Mr=0,jr=Ir.length;Mr<jr;Mr++){var or=gn(Ir[Mr],Wi[Mr],Km);ot?Sr(or.x,or.y+nt[me-1].y,nt[me-1].x+Yf):Sr(or.x,or.y,ue+Yf)}}}Ii(),bi();function Ii(){var Fr=R.length/3;if(re){for(var hr=0,Hr=qn*hr,Rr=0;Rr<ar;Rr++){var kr=qt[Rr];ji(kr[2]+Hr,kr[1]+Hr,kr[0]+Hr)}hr=me+we*2,Hr=qn*hr;for(var vi=0;vi<ar;vi++){var ca=qt[vi];ji(ca[0]+Hr,ca[1]+Hr,ca[2]+Hr)}}else{for(var ua=0;ua<ar;ua++){var _a=qt[ua];ji(_a[2],_a[1],_a[0])}for(var $a=0;$a<ar;$a++){var Ls=qt[$a];ji(Ls[0]+qn*me,Ls[1]+qn*me,Ls[2]+qn*me)}}_.addGroup(Fr,R.length/3-Fr,0)}function bi(){var Fr=R.length/3,hr=0;xr(en,hr),hr+=en.length;for(var Hr=0,Rr=Ke.length;Hr<Rr;Hr++){var kr=Ke[Hr];xr(kr,hr),hr+=kr.length}_.addGroup(Fr,R.length/3-Fr,1)}function xr(Fr,hr){for(var Hr=Fr.length;--Hr>=0;){var Rr=Hr,kr=Hr-1;kr<0&&(kr=Fr.length-1);for(var vi=0,ca=me+we*2;vi<ca;vi++){var ua=qn*vi,_a=qn*(vi+1),$a=hr+Rr+ua,Ls=hr+kr+ua,jy=hr+kr+_a,Zm=hr+Rr+_a;la($a,Ls,jy,Zm)}}}function Sr(Fr,hr,Hr){Q.push(Fr),Q.push(hr),Q.push(Hr)}function ji(Fr,hr,Hr){Ur(Fr),Ur(hr),Ur(Hr);var Rr=R.length/3,kr=rt.generateTopUV(_,R,Rr-3,Rr-2,Rr-1);Bi(kr[0]),Bi(kr[1]),Bi(kr[2])}function la(Fr,hr,Hr,Rr){Ur(Fr),Ur(hr),Ur(Rr),Ur(hr),Ur(Hr),Ur(Rr);var kr=R.length/3,vi=rt.generateSideWallUV(_,R,kr-6,kr-3,kr-2,kr-1);Bi(vi[0]),Bi(vi[1]),Bi(vi[3]),Bi(vi[1]),Bi(vi[2]),Bi(vi[3])}function Ur(Fr){R.push(Q[Fr*3+0]),R.push(Q[Fr*3+1]),R.push(Q[Fr*3+2])}function Bi(Fr){O.push(Fr.x),O.push(Fr.y)}}return x}var d=l.prototype;return d.toJSON=function(){var h=Vn.prototype.toJSON.call(this),x=this.parameters.shapes,_=this.parameters.options;return XI(x,_,h)},l}(Vn),jI={generateTopUV:function(l,d,c,h,x){var _=d[c*3],R=d[c*3+1],O=d[h*3],B=d[h*3+1],V=d[x*3],G=d[x*3+1];return[new Zt(_,R),new Zt(O,B),new Zt(V,G)]},generateSideWallUV:function(l,d,c,h,x,_){var R=d[c*3],O=d[c*3+1],B=d[c*3+2],V=d[h*3],G=d[h*3+1],z=d[h*3+2],ne=d[x*3],Q=d[x*3+1],le=d[x*3+2],me=d[_*3],ue=d[_*3+1],re=d[_*3+2];return Math.abs(O-G)<.01?[new Zt(R,1-B),new Zt(V,1-z),new Zt(ne,1-le),new Zt(me,1-re)]:[new Zt(O,1-B),new Zt(G,1-z),new Zt(Q,1-le),new Zt(ue,1-re)]}};function XI(p,l,d){if(d.shapes=[],Array.isArray(p))for(var c=0,h=p.length;c<h;c++){var x=p[c];d.shapes.push(x.uuid)}else d.shapes.push(p.uuid);return l.extrudePath!==void 0&&(d.options.extrudePath=l.extrudePath.toJSON()),d}var dm=function(p){pr(l,p);function l(d,c){var h;d===void 0&&(d=1),c===void 0&&(c=0);var x=(1+Math.sqrt(5))/2,_=[-1,x,0,1,x,0,-1,-x,0,1,-x,0,0,-1,x,0,1,x,0,-1,-x,0,1,-x,x,0,-1,x,0,1,-x,0,-1,-x,0,1],R=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];return h=p.call(this,_,R,d,c)||this,h.type="IcosahedronGeometry",h.parameters={radius:d,detail:c},h}return l}(dl),pm=function(p){pr(l,p);function l(d,c,h,x){var _;c===void 0&&(c=12),h===void 0&&(h=0),x===void 0&&(x=Math.PI*2),_=p.call(this)||this,_.type="LatheGeometry",_.parameters={points:d,segments:c,phiStart:h,phiLength:x},c=Math.floor(c),x=er.clamp(x,0,Math.PI*2);for(var R=[],O=[],B=[],V=1/c,G=new Ge,z=new Zt,ne=0;ne<=c;ne++)for(var Q=h+ne*V*x,le=Math.sin(Q),me=Math.cos(Q),ue=0;ue<=d.length-1;ue++)G.x=d[ue].x*le,G.y=d[ue].y,G.z=d[ue].x*me,O.push(G.x,G.y,G.z),z.x=ne/c,z.y=ue/(d.length-1),B.push(z.x,z.y);for(var re=0;re<c;re++)for(var Oe=0;Oe<d.length-1;Oe++){var He=Oe+re*d.length,Re=He,we=He+d.length,Ue=He+d.length+1,rt=He+1;R.push(Re,we,rt),R.push(we,Ue,rt)}if(_.setIndex(R),_.setAttribute("position",new xn(O,3)),_.setAttribute("uv",new xn(B,2)),_.computeVertexNormals(),x===Math.PI*2)for(var nt=_.attributes.normal.array,ot=new Ge,ut=new Ge,st=new Ge,et=c*d.length*3,dt=0,at=0;dt<d.length;dt++,at+=3)ot.x=nt[at+0],ot.y=nt[at+1],ot.z=nt[at+2],ut.x=nt[et+at+0],ut.y=nt[et+at+1],ut.z=nt[et+at+2],st.addVectors(ot,ut).normalize(),nt[at+0]=nt[et+at+0]=st.x,nt[at+1]=nt[et+at+1]=st.y,nt[at+2]=nt[et+at+2]=st.z;return _}return l}(Vn),Bf=function(p){pr(l,p);function l(d,c){var h;d===void 0&&(d=1),c===void 0&&(c=0);var x=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],_=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];return h=p.call(this,x,_,d,c)||this,h.type="OctahedronGeometry",h.parameters={radius:d,detail:c},h}return l}(dl);function mc(p,l,d){Vn.call(this),this.type="ParametricGeometry",this.parameters={func:p,slices:l,stacks:d};var c=[],h=[],x=[],_=[],R=1e-5,O=new Ge,B=new Ge,V=new Ge,G=new Ge,z=new Ge;p.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");for(var ne=l+1,Q=0;Q<=d;Q++)for(var le=Q/d,me=0;me<=l;me++){var ue=me/l;p(ue,le,B),h.push(B.x,B.y,B.z),ue-R>=0?(p(ue-R,le,V),G.subVectors(B,V)):(p(ue+R,le,V),G.subVectors(V,B)),le-R>=0?(p(ue,le-R,V),z.subVectors(B,V)):(p(ue,le+R,V),z.subVectors(V,B)),O.crossVectors(G,z).normalize(),x.push(O.x,O.y,O.z),_.push(ue,le)}for(var re=0;re<d;re++)for(var Oe=0;Oe<l;Oe++){var He=re*ne+Oe,Re=re*ne+Oe+1,we=(re+1)*ne+Oe+1,Ue=(re+1)*ne+Oe;c.push(He,Re,Ue),c.push(Re,we,Ue)}this.setIndex(c),this.setAttribute("position",new xn(h,3)),this.setAttribute("normal",new xn(x,3)),this.setAttribute("uv",new xn(_,2))}mc.prototype=Object.create(Vn.prototype),mc.prototype.constructor=mc;var mm=function(p){pr(l,p);function l(d,c,h,x,_,R){var O;d===void 0&&(d=.5),c===void 0&&(c=1),h===void 0&&(h=8),x===void 0&&(x=1),_===void 0&&(_=0),R===void 0&&(R=Math.PI*2),O=p.call(this)||this,O.type="RingGeometry",O.parameters={innerRadius:d,outerRadius:c,thetaSegments:h,phiSegments:x,thetaStart:_,thetaLength:R},h=Math.max(3,h),x=Math.max(1,x);for(var B=[],V=[],G=[],z=[],ne=d,Q=(c-d)/x,le=new Ge,me=new Zt,ue=0;ue<=x;ue++){for(var re=0;re<=h;re++){var Oe=_+re/h*R;le.x=ne*Math.cos(Oe),le.y=ne*Math.sin(Oe),V.push(le.x,le.y,le.z),G.push(0,0,1),me.x=(le.x/c+1)/2,me.y=(le.y/c+1)/2,z.push(me.x,me.y)}ne+=Q}for(var He=0;He<x;He++)for(var Re=He*(h+1),we=0;we<h;we++){var Ue=we+Re,rt=Ue,nt=Ue+h+1,ot=Ue+h+2,ut=Ue+1;B.push(rt,nt,ut),B.push(nt,ot,ut)}return O.setIndex(B),O.setAttribute("position",new xn(V,3)),O.setAttribute("normal",new xn(G,3)),O.setAttribute("uv",new xn(z,2)),O}return l}(Vn),Nf=function(p){pr(l,p);function l(c,h){var x;h===void 0&&(h=12),x=p.call(this)||this,x.type="ShapeGeometry",x.parameters={shapes:c,curveSegments:h};var _=[],R=[],O=[],B=[],V=0,G=0;if(Array.isArray(c)===!1)ne(c);else for(var z=0;z<c.length;z++)ne(c[z]),x.addGroup(V,G,z),V+=G,G=0;x.setIndex(_),x.setAttribute("position",new xn(R,3)),x.setAttribute("normal",new xn(O,3)),x.setAttribute("uv",new xn(B,2));function ne(Q){var le=R.length/3,me=Q.extractPoints(h),ue=me.shape,re=me.holes;_s.isClockWise(ue)===!1&&(ue=ue.reverse());for(var Oe=0,He=re.length;Oe<He;Oe++){var Re=re[Oe];_s.isClockWise(Re)===!0&&(re[Oe]=Re.reverse())}for(var we=_s.triangulateShape(ue,re),Ue=0,rt=re.length;Ue<rt;Ue++){var nt=re[Ue];ue=ue.concat(nt)}for(var ot=0,ut=ue.length;ot<ut;ot++){var st=ue[ot];R.push(st.x,st.y,0),O.push(0,0,1),B.push(st.x,st.y)}for(var et=0,dt=we.length;et<dt;et++){var at=we[et],it=at[0]+le,Ke=at[1]+le,vt=at[2]+le;_.push(it,Ke,vt),G+=3}}return x}var d=l.prototype;return d.toJSON=function(){var h=Vn.prototype.toJSON.call(this),x=this.parameters.shapes;return qI(x,h)},l}(Vn);function qI(p,l){if(l.shapes=[],Array.isArray(p))for(var d=0,c=p.length;d<c;d++){var h=p[d];l.shapes.push(h.uuid)}else l.shapes.push(p.uuid);return l}var Uf=function(p){pr(l,p);function l(d,c,h,x,_,R,O){var B;d===void 0&&(d=1),c===void 0&&(c=8),h===void 0&&(h=6),x===void 0&&(x=0),_===void 0&&(_=Math.PI*2),R===void 0&&(R=0),O===void 0&&(O=Math.PI),B=p.call(this)||this,B.type="SphereGeometry",B.parameters={radius:d,widthSegments:c,heightSegments:h,phiStart:x,phiLength:_,thetaStart:R,thetaLength:O},c=Math.max(3,Math.floor(c)),h=Math.max(2,Math.floor(h));for(var V=Math.min(R+O,Math.PI),G=0,z=[],ne=new Ge,Q=new Ge,le=[],me=[],ue=[],re=[],Oe=0;Oe<=h;Oe++){var He=[],Re=Oe/h,we=0;Oe==0&&R==0?we=.5/c:Oe==h&&V==Math.PI&&(we=-.5/c);for(var Ue=0;Ue<=c;Ue++){var rt=Ue/c;ne.x=-d*Math.cos(x+rt*_)*Math.sin(R+Re*O),ne.y=d*Math.cos(R+Re*O),ne.z=d*Math.sin(x+rt*_)*Math.sin(R+Re*O),me.push(ne.x,ne.y,ne.z),Q.copy(ne).normalize(),ue.push(Q.x,Q.y,Q.z),re.push(rt+we,1-Re),He.push(G++)}z.push(He)}for(var nt=0;nt<h;nt++)for(var ot=0;ot<c;ot++){var ut=z[nt][ot+1],st=z[nt][ot],et=z[nt+1][ot],dt=z[nt+1][ot+1];(nt!==0||R>0)&&le.push(ut,st,dt),(nt!==h-1||V<Math.PI)&&le.push(st,et,dt)}return B.setIndex(le),B.setAttribute("position",new xn(me,3)),B.setAttribute("normal",new xn(ue,3)),B.setAttribute("uv",new xn(re,2)),B}return l}(Vn),vm=function(p){pr(l,p);function l(d,c){var h;d===void 0&&(d=1),c===void 0&&(c=0);var x=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],_=[2,1,0,0,3,2,1,3,0,2,3,1];return h=p.call(this,x,_,d,c)||this,h.type="TetrahedronGeometry",h.parameters={radius:d,detail:c},h}return l}(dl),gm=function(p){pr(l,p);function l(d,c){var h;c===void 0&&(c={});var x=c.font;if(!(x&&x.isFont))return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new Vn||go(h);var _=x.generateShapes(d,c.size);return c.depth=c.height!==void 0?c.height:50,c.bevelThickness===void 0&&(c.bevelThickness=10),c.bevelSize===void 0&&(c.bevelSize=8),c.bevelEnabled===void 0&&(c.bevelEnabled=!1),h=p.call(this,_,c)||this,h.type="TextGeometry",h}return l}(pc),ym=function(p){pr(l,p);function l(d,c,h,x,_){var R;d===void 0&&(d=1),c===void 0&&(c=.4),h===void 0&&(h=8),x===void 0&&(x=6),_===void 0&&(_=Math.PI*2),R=p.call(this)||this,R.type="TorusGeometry",R.parameters={radius:d,tube:c,radialSegments:h,tubularSegments:x,arc:_},h=Math.floor(h),x=Math.floor(x);for(var O=[],B=[],V=[],G=[],z=new Ge,ne=new Ge,Q=new Ge,le=0;le<=h;le++)for(var me=0;me<=x;me++){var ue=me/x*_,re=le/h*Math.PI*2;ne.x=(d+c*Math.cos(re))*Math.cos(ue),ne.y=(d+c*Math.cos(re))*Math.sin(ue),ne.z=c*Math.sin(re),B.push(ne.x,ne.y,ne.z),z.x=d*Math.cos(ue),z.y=d*Math.sin(ue),Q.subVectors(ne,z).normalize(),V.push(Q.x,Q.y,Q.z),G.push(me/x),G.push(le/h)}for(var Oe=1;Oe<=h;Oe++)for(var He=1;He<=x;He++){var Re=(x+1)*Oe+He-1,we=(x+1)*(Oe-1)+He-1,Ue=(x+1)*(Oe-1)+He,rt=(x+1)*Oe+He;O.push(Re,we,rt),O.push(we,Ue,rt)}return R.setIndex(O),R.setAttribute("position",new xn(B,3)),R.setAttribute("normal",new xn(V,3)),R.setAttribute("uv",new xn(G,2)),R}return l}(Vn),bm=function(p){pr(l,p);function l(d,c,h,x,_,R){var O;d===void 0&&(d=1),c===void 0&&(c=.4),h===void 0&&(h=64),x===void 0&&(x=8),_===void 0&&(_=2),R===void 0&&(R=3),O=p.call(this)||this,O.type="TorusKnotGeometry",O.parameters={radius:d,tube:c,tubularSegments:h,radialSegments:x,p:_,q:R},h=Math.floor(h),x=Math.floor(x);for(var B=[],V=[],G=[],z=[],ne=new Ge,Q=new Ge,le=new Ge,me=new Ge,ue=new Ge,re=new Ge,Oe=new Ge,He=0;He<=h;++He){var Re=He/h*_*Math.PI*2;it(Re,_,R,d,le),it(Re+.01,_,R,d,me),re.subVectors(me,le),Oe.addVectors(me,le),ue.crossVectors(re,Oe),Oe.crossVectors(ue,re),ue.normalize(),Oe.normalize();for(var we=0;we<=x;++we){var Ue=we/x*Math.PI*2,rt=-c*Math.cos(Ue),nt=c*Math.sin(Ue);ne.x=le.x+(rt*Oe.x+nt*ue.x),ne.y=le.y+(rt*Oe.y+nt*ue.y),ne.z=le.z+(rt*Oe.z+nt*ue.z),V.push(ne.x,ne.y,ne.z),Q.subVectors(ne,le).normalize(),G.push(Q.x,Q.y,Q.z),z.push(He/h),z.push(we/x)}}for(var ot=1;ot<=h;ot++)for(var ut=1;ut<=x;ut++){var st=(x+1)*(ot-1)+(ut-1),et=(x+1)*ot+(ut-1),dt=(x+1)*ot+ut,at=(x+1)*(ot-1)+ut;B.push(st,et,at),B.push(et,dt,at)}O.setIndex(B),O.setAttribute("position",new xn(V,3)),O.setAttribute("normal",new xn(G,3)),O.setAttribute("uv",new xn(z,2));function it(Ke,vt,gt,St,Tt){var qt=Math.cos(Ke),en=Math.sin(Ke),_n=gt/vt*Ke,Lt=Math.cos(_n);Tt.x=St*(2+Lt)*.5*qt,Tt.y=St*(2+Lt)*en*.5,Tt.z=St*Math.sin(_n)*.5}return O}return l}(Vn),xm=function(p){pr(l,p);function l(c,h,x,_,R){var O;h===void 0&&(h=64),x===void 0&&(x=1),_===void 0&&(_=8),R===void 0&&(R=!1),O=p.call(this)||this,O.type="TubeGeometry",O.parameters={path:c,tubularSegments:h,radius:x,radialSegments:_,closed:R};var B=c.computeFrenetFrames(h,R);O.tangents=B.tangents,O.normals=B.normals,O.binormals=B.binormals;var V=new Ge,G=new Ge,z=new Zt,ne=new Ge,Q=[],le=[],me=[],ue=[];re(),O.setIndex(ue),O.setAttribute("position",new xn(Q,3)),O.setAttribute("normal",new xn(le,3)),O.setAttribute("uv",new xn(me,2));function re(){for(var we=0;we<h;we++)Oe(we);Oe(R===!1?h:0),Re(),He()}function Oe(we){ne=c.getPointAt(we/h,ne);for(var Ue=B.normals[we],rt=B.binormals[we],nt=0;nt<=_;nt++){var ot=nt/_*Math.PI*2,ut=Math.sin(ot),st=-Math.cos(ot);G.x=st*Ue.x+ut*rt.x,G.y=st*Ue.y+ut*rt.y,G.z=st*Ue.z+ut*rt.z,G.normalize(),le.push(G.x,G.y,G.z),V.x=ne.x+x*G.x,V.y=ne.y+x*G.y,V.z=ne.z+x*G.z,Q.push(V.x,V.y,V.z)}}function He(){for(var we=1;we<=h;we++)for(var Ue=1;Ue<=_;Ue++){var rt=(_+1)*(we-1)+(Ue-1),nt=(_+1)*we+(Ue-1),ot=(_+1)*we+Ue,ut=(_+1)*(we-1)+Ue;ue.push(rt,nt,ut),ue.push(nt,ot,ut)}}function Re(){for(var we=0;we<=h;we++)for(var Ue=0;Ue<=_;Ue++)z.x=we/h,z.y=Ue/_,me.push(z.x,z.y)}return O}var d=l.prototype;return d.toJSON=function(){var h=Vn.prototype.toJSON.call(this);return h.path=this.parameters.path.toJSON(),h},l}(Vn),cy=function(p){pr(l,p);function l(d){var c;if(c=p.call(this)||this,c.type="WireframeGeometry",d.isGeometry===!0)return console.error("THREE.WireframeGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),go(c);var h=[],x=[0,0],_={},R=new Ge;if(d.index!==null){var O=d.attributes.position,B=d.index,V=d.groups;V.length===0&&(V=[{start:0,count:B.count,materialIndex:0}]);for(var G=0,z=V.length;G<z;++G)for(var ne=V[G],Q=ne.start,le=ne.count,me=Q,ue=Q+le;me<ue;me+=3)for(var re=0;re<3;re++){var Oe=B.getX(me+re),He=B.getX(me+(re+1)%3);x[0]=Math.min(Oe,He),x[1]=Math.max(Oe,He);var Re=x[0]+","+x[1];_[Re]===void 0&&(_[Re]={index1:x[0],index2:x[1]})}for(var we in _){var Ue=_[we];R.fromBufferAttribute(O,Ue.index1),h.push(R.x,R.y,R.z),R.fromBufferAttribute(O,Ue.index2),h.push(R.x,R.y,R.z)}}else for(var rt=d.attributes.position,nt=0,ot=rt.count/3;nt<ot;nt++)for(var ut=0;ut<3;ut++){var st=3*nt+ut;R.fromBufferAttribute(rt,st),h.push(R.x,R.y,R.z);var et=3*nt+(ut+1)%3;R.fromBufferAttribute(rt,et),h.push(R.x,R.y,R.z)}return c.setAttribute("position",new xn(h,3)),c}return l}(Vn),Ea=Object.freeze({__proto__:null,BoxGeometry:hc,BoxBufferGeometry:hc,CircleGeometry:am,CircleBufferGeometry:am,ConeGeometry:om,ConeBufferGeometry:om,CylinderGeometry:Tu,CylinderBufferGeometry:Tu,DodecahedronGeometry:sm,DodecahedronBufferGeometry:sm,EdgesGeometry:oy,ExtrudeGeometry:pc,ExtrudeBufferGeometry:pc,IcosahedronGeometry:dm,IcosahedronBufferGeometry:dm,LatheGeometry:pm,LatheBufferGeometry:pm,OctahedronGeometry:Bf,OctahedronBufferGeometry:Bf,ParametricGeometry:mc,ParametricBufferGeometry:mc,PlaneGeometry:gf,PlaneBufferGeometry:gf,PolyhedronGeometry:dl,PolyhedronBufferGeometry:dl,RingGeometry:mm,RingBufferGeometry:mm,ShapeGeometry:Nf,ShapeBufferGeometry:Nf,SphereGeometry:Uf,SphereBufferGeometry:Uf,TetrahedronGeometry:vm,TetrahedronBufferGeometry:vm,TextGeometry:gm,TextBufferGeometry:gm,TorusGeometry:ym,TorusBufferGeometry:ym,TorusKnotGeometry:bm,TorusKnotBufferGeometry:bm,TubeGeometry:xm,TubeBufferGeometry:xm,WireframeGeometry:cy});function vc(p){Kn.call(this),this.type="ShadowMaterial",this.color=new vn(0),this.transparent=!0,this.setValues(p)}vc.prototype=Object.create(Kn.prototype),vc.prototype.constructor=vc,vc.prototype.isShadowMaterial=!0,vc.prototype.copy=function(p){return Kn.prototype.copy.call(this,p),this.color.copy(p.color),this};function Ms(p){wa.call(this,p),this.type="RawShaderMaterial"}Ms.prototype=Object.create(wa.prototype),Ms.prototype.constructor=Ms,Ms.prototype.isRawShaderMaterial=!0;function Xo(p){Kn.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new vn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new vn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ic,this.normalScale=new Zt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(p)}Xo.prototype=Object.create(Kn.prototype),Xo.prototype.constructor=Xo,Xo.prototype.isMeshStandardMaterial=!0,Xo.prototype.copy=function(p){return Kn.prototype.copy.call(this,p),this.defines={STANDARD:""},this.color.copy(p.color),this.roughness=p.roughness,this.metalness=p.metalness,this.map=p.map,this.lightMap=p.lightMap,this.lightMapIntensity=p.lightMapIntensity,this.aoMap=p.aoMap,this.aoMapIntensity=p.aoMapIntensity,this.emissive.copy(p.emissive),this.emissiveMap=p.emissiveMap,this.emissiveIntensity=p.emissiveIntensity,this.bumpMap=p.bumpMap,this.bumpScale=p.bumpScale,this.normalMap=p.normalMap,this.normalMapType=p.normalMapType,this.normalScale.copy(p.normalScale),this.displacementMap=p.displacementMap,this.displacementScale=p.displacementScale,this.displacementBias=p.displacementBias,this.roughnessMap=p.roughnessMap,this.metalnessMap=p.metalnessMap,this.alphaMap=p.alphaMap,this.envMap=p.envMap,this.envMapIntensity=p.envMapIntensity,this.refractionRatio=p.refractionRatio,this.wireframe=p.wireframe,this.wireframeLinewidth=p.wireframeLinewidth,this.wireframeLinecap=p.wireframeLinecap,this.wireframeLinejoin=p.wireframeLinejoin,this.skinning=p.skinning,this.morphTargets=p.morphTargets,this.morphNormals=p.morphNormals,this.vertexTangents=p.vertexTangents,this};function ml(p){Xo.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Zt(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(d){this.reflectivity=er.clamp(2.5*(d-1)/(d+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(p)}ml.prototype=Object.create(Xo.prototype),ml.prototype.constructor=ml,ml.prototype.isMeshPhysicalMaterial=!0,ml.prototype.copy=function(p){return Xo.prototype.copy.call(this,p),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=p.clearcoat,this.clearcoatMap=p.clearcoatMap,this.clearcoatRoughness=p.clearcoatRoughness,this.clearcoatRoughnessMap=p.clearcoatRoughnessMap,this.clearcoatNormalMap=p.clearcoatNormalMap,this.clearcoatNormalScale.copy(p.clearcoatNormalScale),this.reflectivity=p.reflectivity,p.sheen?this.sheen=(this.sheen||new vn).copy(p.sheen):this.sheen=null,this.transmission=p.transmission,this.transmissionMap=p.transmissionMap,this};function vl(p){Kn.call(this),this.type="MeshPhongMaterial",this.color=new vn(16777215),this.specular=new vn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new vn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ic,this.normalScale=new Zt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ee,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(p)}vl.prototype=Object.create(Kn.prototype),vl.prototype.constructor=vl,vl.prototype.isMeshPhongMaterial=!0,vl.prototype.copy=function(p){return Kn.prototype.copy.call(this,p),this.color.copy(p.color),this.specular.copy(p.specular),this.shininess=p.shininess,this.map=p.map,this.lightMap=p.lightMap,this.lightMapIntensity=p.lightMapIntensity,this.aoMap=p.aoMap,this.aoMapIntensity=p.aoMapIntensity,this.emissive.copy(p.emissive),this.emissiveMap=p.emissiveMap,this.emissiveIntensity=p.emissiveIntensity,this.bumpMap=p.bumpMap,this.bumpScale=p.bumpScale,this.normalMap=p.normalMap,this.normalMapType=p.normalMapType,this.normalScale.copy(p.normalScale),this.displacementMap=p.displacementMap,this.displacementScale=p.displacementScale,this.displacementBias=p.displacementBias,this.specularMap=p.specularMap,this.alphaMap=p.alphaMap,this.envMap=p.envMap,this.combine=p.combine,this.reflectivity=p.reflectivity,this.refractionRatio=p.refractionRatio,this.wireframe=p.wireframe,this.wireframeLinewidth=p.wireframeLinewidth,this.wireframeLinecap=p.wireframeLinecap,this.wireframeLinejoin=p.wireframeLinejoin,this.skinning=p.skinning,this.morphTargets=p.morphTargets,this.morphNormals=p.morphNormals,this};function gc(p){Kn.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new vn(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new vn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ic,this.normalScale=new Zt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(p)}gc.prototype=Object.create(Kn.prototype),gc.prototype.constructor=gc,gc.prototype.isMeshToonMaterial=!0,gc.prototype.copy=function(p){return Kn.prototype.copy.call(this,p),this.color.copy(p.color),this.map=p.map,this.gradientMap=p.gradientMap,this.lightMap=p.lightMap,this.lightMapIntensity=p.lightMapIntensity,this.aoMap=p.aoMap,this.aoMapIntensity=p.aoMapIntensity,this.emissive.copy(p.emissive),this.emissiveMap=p.emissiveMap,this.emissiveIntensity=p.emissiveIntensity,this.bumpMap=p.bumpMap,this.bumpScale=p.bumpScale,this.normalMap=p.normalMap,this.normalMapType=p.normalMapType,this.normalScale.copy(p.normalScale),this.displacementMap=p.displacementMap,this.displacementScale=p.displacementScale,this.displacementBias=p.displacementBias,this.alphaMap=p.alphaMap,this.wireframe=p.wireframe,this.wireframeLinewidth=p.wireframeLinewidth,this.wireframeLinecap=p.wireframeLinecap,this.wireframeLinejoin=p.wireframeLinejoin,this.skinning=p.skinning,this.morphTargets=p.morphTargets,this.morphNormals=p.morphNormals,this};function yc(p){Kn.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ic,this.normalScale=new Zt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(p)}yc.prototype=Object.create(Kn.prototype),yc.prototype.constructor=yc,yc.prototype.isMeshNormalMaterial=!0,yc.prototype.copy=function(p){return Kn.prototype.copy.call(this,p),this.bumpMap=p.bumpMap,this.bumpScale=p.bumpScale,this.normalMap=p.normalMap,this.normalMapType=p.normalMapType,this.normalScale.copy(p.normalScale),this.displacementMap=p.displacementMap,this.displacementScale=p.displacementScale,this.displacementBias=p.displacementBias,this.wireframe=p.wireframe,this.wireframeLinewidth=p.wireframeLinewidth,this.skinning=p.skinning,this.morphTargets=p.morphTargets,this.morphNormals=p.morphNormals,this};function bc(p){Kn.call(this),this.type="MeshLambertMaterial",this.color=new vn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new vn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ee,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(p)}bc.prototype=Object.create(Kn.prototype),bc.prototype.constructor=bc,bc.prototype.isMeshLambertMaterial=!0,bc.prototype.copy=function(p){return Kn.prototype.copy.call(this,p),this.color.copy(p.color),this.map=p.map,this.lightMap=p.lightMap,this.lightMapIntensity=p.lightMapIntensity,this.aoMap=p.aoMap,this.aoMapIntensity=p.aoMapIntensity,this.emissive.copy(p.emissive),this.emissiveMap=p.emissiveMap,this.emissiveIntensity=p.emissiveIntensity,this.specularMap=p.specularMap,this.alphaMap=p.alphaMap,this.envMap=p.envMap,this.combine=p.combine,this.reflectivity=p.reflectivity,this.refractionRatio=p.refractionRatio,this.wireframe=p.wireframe,this.wireframeLinewidth=p.wireframeLinewidth,this.wireframeLinecap=p.wireframeLinecap,this.wireframeLinejoin=p.wireframeLinejoin,this.skinning=p.skinning,this.morphTargets=p.morphTargets,this.morphNormals=p.morphNormals,this};function xc(p){Kn.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new vn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ic,this.normalScale=new Zt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(p)}xc.prototype=Object.create(Kn.prototype),xc.prototype.constructor=xc,xc.prototype.isMeshMatcapMaterial=!0,xc.prototype.copy=function(p){return Kn.prototype.copy.call(this,p),this.defines={MATCAP:""},this.color.copy(p.color),this.matcap=p.matcap,this.map=p.map,this.bumpMap=p.bumpMap,this.bumpScale=p.bumpScale,this.normalMap=p.normalMap,this.normalMapType=p.normalMapType,this.normalScale.copy(p.normalScale),this.displacementMap=p.displacementMap,this.displacementScale=p.displacementScale,this.displacementBias=p.displacementBias,this.alphaMap=p.alphaMap,this.skinning=p.skinning,this.morphTargets=p.morphTargets,this.morphNormals=p.morphNormals,this};function wc(p){yi.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(p)}wc.prototype=Object.create(yi.prototype),wc.prototype.constructor=wc,wc.prototype.isLineDashedMaterial=!0,wc.prototype.copy=function(p){return yi.prototype.copy.call(this,p),this.scale=p.scale,this.dashSize=p.dashSize,this.gapSize=p.gapSize,this};var YI=Object.freeze({__proto__:null,ShadowMaterial:vc,SpriteMaterial:fl,RawShaderMaterial:Ms,ShaderMaterial:wa,PointsMaterial:Ao,MeshPhysicalMaterial:ml,MeshStandardMaterial:Xo,MeshPhongMaterial:vl,MeshToonMaterial:gc,MeshNormalMaterial:yc,MeshLambertMaterial:bc,MeshDepthMaterial:cl,MeshDistanceMaterial:ul,MeshBasicMaterial:za,MeshMatcapMaterial:xc,LineDashedMaterial:wc,LineBasicMaterial:yi,Material:Kn}),mi={arraySlice:function(l,d,c){return mi.isTypedArray(l)?new l.constructor(l.subarray(d,c!==void 0?c:l.length)):l.slice(d,c)},convertArray:function(l,d,c){return!l||!c&&l.constructor===d?l:typeof d.BYTES_PER_ELEMENT=="number"?new d(l):Array.prototype.slice.call(l)},isTypedArray:function(l){return ArrayBuffer.isView(l)&&!(l instanceof DataView)},getKeyframeOrder:function(l){function d(_,R){return l[_]-l[R]}for(var c=l.length,h=new Array(c),x=0;x!==c;++x)h[x]=x;return h.sort(d),h},sortedArray:function(l,d,c){for(var h=l.length,x=new l.constructor(h),_=0,R=0;R!==h;++_)for(var O=c[_]*d,B=0;B!==d;++B)x[R++]=l[O+B];return x},flattenJSON:function(l,d,c,h){for(var x=1,_=l[0];_!==void 0&&_[h]===void 0;)_=l[x++];if(_!==void 0){var R=_[h];if(R!==void 0)if(Array.isArray(R))do R=_[h],R!==void 0&&(d.push(_.time),c.push.apply(c,R)),_=l[x++];while(_!==void 0);else if(R.toArray!==void 0)do R=_[h],R!==void 0&&(d.push(_.time),R.toArray(c,c.length)),_=l[x++];while(_!==void 0);else do R=_[h],R!==void 0&&(d.push(_.time),c.push(R)),_=l[x++];while(_!==void 0)}},subclip:function(l,d,c,h,x){x===void 0&&(x=30);var _=l.clone();_.name=d;for(var R=[],O=0;O<_.tracks.length;++O){for(var B=_.tracks[O],V=B.getValueSize(),G=[],z=[],ne=0;ne<B.times.length;++ne){var Q=B.times[ne]*x;if(!(Q<c||Q>=h)){G.push(B.times[ne]);for(var le=0;le<V;++le)z.push(B.values[ne*V+le])}}G.length!==0&&(B.times=mi.convertArray(G,B.times.constructor),B.values=mi.convertArray(z,B.values.constructor),R.push(B))}_.tracks=R;for(var me=1/0,ue=0;ue<_.tracks.length;++ue)me>_.tracks[ue].times[0]&&(me=_.tracks[ue].times[0]);for(var re=0;re<_.tracks.length;++re)_.tracks[re].shift(-1*me);return _.resetDuration(),_},makeClipAdditive:function(l,d,c,h){d===void 0&&(d=0),c===void 0&&(c=l),h===void 0&&(h=30),h<=0&&(h=30);for(var x=c.tracks.length,_=d/h,R=function(G){var z=c.tracks[G],ne=z.ValueTypeName;if(ne==="bool"||ne==="string")return"continue";var Q=l.tracks.find(function(vt){return vt.name===z.name&&vt.ValueTypeName===ne});if(Q===void 0)return"continue";var le=0,me=z.getValueSize();z.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(le=me/3);var ue=0,re=Q.getValueSize();Q.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(ue=re/3);var Oe=z.times.length-1,He=void 0;if(_<=z.times[0]){var Re=le,we=me-le;He=mi.arraySlice(z.values,Re,we)}else if(_>=z.times[Oe]){var Ue=Oe*me+le,rt=Ue+me-le;He=mi.arraySlice(z.values,Ue,rt)}else{var nt=z.createInterpolant(),ot=le,ut=me-le;nt.evaluate(_),He=mi.arraySlice(nt.resultBuffer,ot,ut)}if(ne==="quaternion"){var st=new Zi().fromArray(He).normalize().conjugate();st.toArray(He)}for(var et=Q.times.length,dt=0;dt<et;++dt){var at=dt*re+ue;if(ne==="quaternion")Zi.multiplyQuaternionsFlat(Q.values,at,He,0,Q.values,at);else for(var it=re-ue*2,Ke=0;Ke<it;++Ke)Q.values[at+Ke]-=He[Ke]}},O=0;O<x;++O)var B=R(O);return l.blendMode=vo,l}};function ja(p,l,d,c){this.parameterPositions=p,this._cachedIndex=0,this.resultBuffer=c!==void 0?c:new l.constructor(d),this.sampleValues=l,this.valueSize=d}Object.assign(ja.prototype,{evaluate:function(l){var d=this.parameterPositions,c=this._cachedIndex,h=d[c],x=d[c-1];e:{t:{var _;n:{r:if(!(l<h)){for(var R=c+2;;){if(h===void 0){if(l<x)break r;return c=d.length,this._cachedIndex=c,this.afterEnd_(c-1,l,x)}if(c===R)break;if(x=h,h=d[++c],l<h)break t}_=d.length;break n}if(!(l>=x)){var O=d[1];l<O&&(c=2,x=O);for(var B=c-2;;){if(x===void 0)return this._cachedIndex=0,this.beforeStart_(0,l,h);if(c===B)break;if(h=x,x=d[--c-1],l>=x)break t}_=c,c=0;break n}break e}for(;c<_;){var V=c+_>>>1;l<d[V]?_=V:c=V+1}if(h=d[c],x=d[c-1],x===void 0)return this._cachedIndex=0,this.beforeStart_(0,l,h);if(h===void 0)return c=d.length,this._cachedIndex=c,this.afterEnd_(c-1,x,l)}this._cachedIndex=c,this.intervalChanged_(c,x,h)}return this.interpolate_(c,x,l,h)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(l){for(var d=this.resultBuffer,c=this.sampleValues,h=this.valueSize,x=l*h,_=0;_!==h;++_)d[_]=c[x+_];return d},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(ja.prototype,{beforeStart_:ja.prototype.copySampleValue_,afterEnd_:ja.prototype.copySampleValue_});function wm(p,l,d,c){ja.call(this,p,l,d,c),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}wm.prototype=Object.assign(Object.create(ja.prototype),{constructor:wm,DefaultSettings_:{endingStart:ri,endingEnd:ri},intervalChanged_:function(l,d,c){var h=this.parameterPositions,x=l-2,_=l+1,R=h[x],O=h[_];if(R===void 0)switch(this.getSettings_().endingStart){case Nn:x=l,R=2*d-c;break;case ya:x=h.length-2,R=d+h[x]-h[x+1];break;default:x=l,R=c}if(O===void 0)switch(this.getSettings_().endingEnd){case Nn:_=l,O=2*c-d;break;case ya:_=1,O=c+h[1]-h[0];break;default:_=l-1,O=d}var B=(c-d)*.5,V=this.valueSize;this._weightPrev=B/(d-R),this._weightNext=B/(O-c),this._offsetPrev=x*V,this._offsetNext=_*V},interpolate_:function(l,d,c,h){for(var x=this.resultBuffer,_=this.sampleValues,R=this.valueSize,O=l*R,B=O-R,V=this._offsetPrev,G=this._offsetNext,z=this._weightPrev,ne=this._weightNext,Q=(c-d)/(h-d),le=Q*Q,me=le*Q,ue=-z*me+2*z*le-z*Q,re=(1+z)*me+(-1.5-2*z)*le+(-.5+z)*Q+1,Oe=(-1-ne)*me+(1.5+ne)*le+.5*Q,He=ne*me-ne*le,Re=0;Re!==R;++Re)x[Re]=ue*_[V+Re]+re*_[B+Re]+Oe*_[O+Re]+He*_[G+Re];return x}});function Hf(p,l,d,c){ja.call(this,p,l,d,c)}Hf.prototype=Object.assign(Object.create(ja.prototype),{constructor:Hf,interpolate_:function(l,d,c,h){for(var x=this.resultBuffer,_=this.sampleValues,R=this.valueSize,O=l*R,B=O-R,V=(c-d)/(h-d),G=1-V,z=0;z!==R;++z)x[z]=_[B+z]*G+_[O+z]*V;return x}});function Am(p,l,d,c){ja.call(this,p,l,d,c)}Am.prototype=Object.assign(Object.create(ja.prototype),{constructor:Am,interpolate_:function(l){return this.copySampleValue_(l-1)}});function Qi(p,l,d,c){if(p===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(l===void 0||l.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+p);this.name=p,this.times=mi.convertArray(l,this.TimeBufferType),this.values=mi.convertArray(d,this.ValueBufferType),this.setInterpolation(c||this.DefaultInterpolation)}Object.assign(Qi,{toJSON:function(l){var d=l.constructor,c;if(d.toJSON!==void 0)c=d.toJSON(l);else{c={name:l.name,times:mi.convertArray(l.times,Array),values:mi.convertArray(l.values,Array)};var h=l.getInterpolation();h!==l.DefaultInterpolation&&(c.interpolation=h)}return c.type=l.ValueTypeName,c}}),Object.assign(Qi.prototype,{constructor:Qi,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:Vr,InterpolantFactoryMethodDiscrete:function(l){return new Am(this.times,this.values,this.getValueSize(),l)},InterpolantFactoryMethodLinear:function(l){return new Hf(this.times,this.values,this.getValueSize(),l)},InterpolantFactoryMethodSmooth:function(l){return new wm(this.times,this.values,this.getValueSize(),l)},setInterpolation:function(l){var d;switch(l){case Dr:d=this.InterpolantFactoryMethodDiscrete;break;case Vr:d=this.InterpolantFactoryMethodLinear;break;case ir:d=this.InterpolantFactoryMethodSmooth;break}if(d===void 0){var c="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(l!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(c);return console.warn("THREE.KeyframeTrack:",c),this}return this.createInterpolant=d,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Dr;case this.InterpolantFactoryMethodLinear:return Vr;case this.InterpolantFactoryMethodSmooth:return ir}},getValueSize:function(){return this.values.length/this.times.length},shift:function(l){if(l!==0)for(var d=this.times,c=0,h=d.length;c!==h;++c)d[c]+=l;return this},scale:function(l){if(l!==1)for(var d=this.times,c=0,h=d.length;c!==h;++c)d[c]*=l;return this},trim:function(l,d){for(var c=this.times,h=c.length,x=0,_=h-1;x!==h&&c[x]<l;)++x;for(;_!==-1&&c[_]>d;)--_;if(++_,x!==0||_!==h){x>=_&&(_=Math.max(_,1),x=_-1);var R=this.getValueSize();this.times=mi.arraySlice(c,x,_),this.values=mi.arraySlice(this.values,x*R,_*R)}return this},validate:function(){var l=!0,d=this.getValueSize();d-Math.floor(d)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),l=!1);var c=this.times,h=this.values,x=c.length;x===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),l=!1);for(var _=null,R=0;R!==x;R++){var O=c[R];if(typeof O=="number"&&isNaN(O)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,R,O),l=!1;break}if(_!==null&&_>O){console.error("THREE.KeyframeTrack: Out of order keys.",this,R,O,_),l=!1;break}_=O}if(h!==void 0&&mi.isTypedArray(h))for(var B=0,V=h.length;B!==V;++B){var G=h[B];if(isNaN(G)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,B,G),l=!1;break}}return l},optimize:function(){for(var l=mi.arraySlice(this.times),d=mi.arraySlice(this.values),c=this.getValueSize(),h=this.getInterpolation()===ir,x=l.length-1,_=1,R=1;R<x;++R){var O=!1,B=l[R],V=l[R+1];if(B!==V&&(R!==1||B!==l[0]))if(h)O=!0;else for(var G=R*c,z=G-c,ne=G+c,Q=0;Q!==c;++Q){var le=d[G+Q];if(le!==d[z+Q]||le!==d[ne+Q]){O=!0;break}}if(O){if(R!==_){l[_]=l[R];for(var me=R*c,ue=_*c,re=0;re!==c;++re)d[ue+re]=d[me+re]}++_}}if(x>0){l[_]=l[x];for(var Oe=x*c,He=_*c,Re=0;Re!==c;++Re)d[He+Re]=d[Oe+Re];++_}return _!==l.length?(this.times=mi.arraySlice(l,0,_),this.values=mi.arraySlice(d,0,_*c)):(this.times=l,this.values=d),this},clone:function(){var l=mi.arraySlice(this.times,0),d=mi.arraySlice(this.values,0),c=this.constructor,h=new c(this.name,l,d);return h.createInterpolant=this.createInterpolant,h}});function Em(p,l,d){Qi.call(this,p,l,d)}Em.prototype=Object.assign(Object.create(Qi.prototype),{constructor:Em,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:Dr,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function _m(p,l,d,c){Qi.call(this,p,l,d,c)}_m.prototype=Object.assign(Object.create(Qi.prototype),{constructor:_m,ValueTypeName:"color"});function Lu(p,l,d,c){Qi.call(this,p,l,d,c)}Lu.prototype=Object.assign(Object.create(Qi.prototype),{constructor:Lu,ValueTypeName:"number"});function Mm(p,l,d,c){ja.call(this,p,l,d,c)}Mm.prototype=Object.assign(Object.create(ja.prototype),{constructor:Mm,interpolate_:function(l,d,c,h){for(var x=this.resultBuffer,_=this.sampleValues,R=this.valueSize,O=(c-d)/(h-d),B=l*R,V=B+R;B!==V;B+=4)Zi.slerpFlat(x,0,_,B-R,_,B,O);return x}});function zf(p,l,d,c){Qi.call(this,p,l,d,c)}zf.prototype=Object.assign(Object.create(Qi.prototype),{constructor:zf,ValueTypeName:"quaternion",DefaultInterpolation:Vr,InterpolantFactoryMethodLinear:function(l){return new Mm(this.times,this.values,this.getValueSize(),l)},InterpolantFactoryMethodSmooth:void 0});function Sm(p,l,d,c){Qi.call(this,p,l,d,c)}Sm.prototype=Object.assign(Object.create(Qi.prototype),{constructor:Sm,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:Dr,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function Pu(p,l,d,c){Qi.call(this,p,l,d,c)}Pu.prototype=Object.assign(Object.create(Qi.prototype),{constructor:Pu,ValueTypeName:"vector"});function Xa(p,l,d,c){l===void 0&&(l=-1),c===void 0&&(c=ba),this.name=p,this.tracks=d,this.duration=l,this.blendMode=c,this.uuid=er.generateUUID(),this.duration<0&&this.resetDuration()}function $I(p){switch(p.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Lu;case"vector":case"vector2":case"vector3":case"vector4":return Pu;case"color":return _m;case"quaternion":return zf;case"bool":case"boolean":return Em;case"string":return Sm}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+p)}function KI(p){if(p.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var l=$I(p.type);if(p.times===void 0){var d=[],c=[];mi.flattenJSON(p.keys,d,c,"value"),p.times=d,p.values=c}return l.parse!==void 0?l.parse(p):new l(p.name,p.times,p.values,p.interpolation)}Object.assign(Xa,{parse:function(l){for(var d=[],c=l.tracks,h=1/(l.fps||1),x=0,_=c.length;x!==_;++x)d.push(KI(c[x]).scale(h));var R=new Xa(l.name,l.duration,d,l.blendMode);return R.uuid=l.uuid,R},toJSON:function(l){for(var d=[],c=l.tracks,h={name:l.name,duration:l.duration,tracks:d,uuid:l.uuid,blendMode:l.blendMode},x=0,_=c.length;x!==_;++x)d.push(Qi.toJSON(c[x]));return h},CreateFromMorphTargetSequence:function(l,d,c,h){for(var x=d.length,_=[],R=0;R<x;R++){var O=[],B=[];O.push((R+x-1)%x,R,(R+1)%x),B.push(0,1,0);var V=mi.getKeyframeOrder(O);O=mi.sortedArray(O,1,V),B=mi.sortedArray(B,1,V),!h&&O[0]===0&&(O.push(x),B.push(B[0])),_.push(new Lu(".morphTargetInfluences["+d[R].name+"]",O,B).scale(1/c))}return new Xa(l,-1,_)},findByName:function(l,d){var c=l;if(!Array.isArray(l)){var h=l;c=h.geometry&&h.geometry.animations||h.animations}for(var x=0;x<c.length;x++)if(c[x].name===d)return c[x];return null},CreateClipsFromMorphTargetSequences:function(l,d,c){for(var h={},x=/^([\w-]*?)([\d]+)$/,_=0,R=l.length;_<R;_++){var O=l[_],B=O.name.match(x);if(B&&B.length>1){var V=B[1],G=h[V];G||(h[V]=G=[]),G.push(O)}}var z=[];for(var ne in h)z.push(Xa.CreateFromMorphTargetSequence(ne,h[ne],d,c));return z},parseAnimation:function(l,d){if(!l)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var c=function(Ue,rt,nt,ot,ut){if(nt.length!==0){var st=[],et=[];mi.flattenJSON(nt,st,et,ot),st.length!==0&&ut.push(new Ue(rt,st,et))}},h=[],x=l.name||"default",_=l.fps||30,R=l.blendMode,O=l.length||-1,B=l.hierarchy||[],V=0;V<B.length;V++){var G=B[V].keys;if(!(!G||G.length===0))if(G[0].morphTargets){var z={},ne=void 0;for(ne=0;ne<G.length;ne++)if(G[ne].morphTargets)for(var Q=0;Q<G[ne].morphTargets.length;Q++)z[G[ne].morphTargets[Q]]=-1;for(var le in z){for(var me=[],ue=[],re=0;re!==G[ne].morphTargets.length;++re){var Oe=G[ne];me.push(Oe.time),ue.push(Oe.morphTarget===le?1:0)}h.push(new Lu(".morphTargetInfluence["+le+"]",me,ue))}O=z.length*(_||1)}else{var He=".bones["+d[V].name+"]";c(Pu,He+".position",G,"pos",h),c(zf,He+".quaternion",G,"rot",h),c(Pu,He+".scale",G,"scl",h)}}if(h.length===0)return null;var Re=new Xa(x,O,h,R);return Re}}),Object.assign(Xa.prototype,{resetDuration:function(){for(var l=this.tracks,d=0,c=0,h=l.length;c!==h;++c){var x=this.tracks[c];d=Math.max(d,x.times[x.times.length-1])}return this.duration=d,this},trim:function(){for(var l=0;l<this.tracks.length;l++)this.tracks[l].trim(0,this.duration);return this},validate:function(){for(var l=!0,d=0;d<this.tracks.length;d++)l=l&&this.tracks[d].validate();return l},optimize:function(){for(var l=0;l<this.tracks.length;l++)this.tracks[l].optimize();return this},clone:function(){for(var l=[],d=0;d<this.tracks.length;d++)l.push(this.tracks[d].clone());return new Xa(this.name,this.duration,l,this.blendMode)},toJSON:function(){return Xa.toJSON(this)}});var Ac={enabled:!1,files:{},add:function(l,d){this.enabled!==!1&&(this.files[l]=d)},get:function(l){if(this.enabled!==!1)return this.files[l]},remove:function(l){delete this.files[l]},clear:function(){this.files={}}};function uy(p,l,d){var c=this,h=!1,x=0,_=0,R=void 0,O=[];this.onStart=void 0,this.onLoad=p,this.onProgress=l,this.onError=d,this.itemStart=function(B){_++,h===!1&&c.onStart!==void 0&&c.onStart(B,x,_),h=!0},this.itemEnd=function(B){x++,c.onProgress!==void 0&&c.onProgress(B,x,_),x===_&&(h=!1,c.onLoad!==void 0&&c.onLoad())},this.itemError=function(B){c.onError!==void 0&&c.onError(B)},this.resolveURL=function(B){return R?R(B):B},this.setURLModifier=function(B){return R=B,this},this.addHandler=function(B,V){return O.push(B,V),this},this.removeHandler=function(B){var V=O.indexOf(B);return V!==-1&&O.splice(V,2),this},this.getHandler=function(B){for(var V=0,G=O.length;V<G;V+=2){var z=O[V],ne=O[V+1];if(z.global&&(z.lastIndex=0),z.test(B))return ne}return null}}var sE=new uy;function Jr(p){this.manager=p!==void 0?p:sE,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(Jr.prototype,{load:function(){},loadAsync:function(l,d){var c=this;return new Promise(function(h,x){c.load(l,h,d,x)})},parse:function(){},setCrossOrigin:function(l){return this.crossOrigin=l,this},setWithCredentials:function(l){return this.withCredentials=l,this},setPath:function(l){return this.path=l,this},setResourcePath:function(l){return this.resourcePath=l,this},setRequestHeader:function(l){return this.requestHeader=l,this}});var Eo={};function oo(p){Jr.call(this,p)}oo.prototype=Object.assign(Object.create(Jr.prototype),{constructor:oo,load:function(l,d,c,h){l===void 0&&(l=""),this.path!==void 0&&(l=this.path+l),l=this.manager.resolveURL(l);var x=this,_=Ac.get(l);if(_!==void 0)return x.manager.itemStart(l),setTimeout(function(){d&&d(_),x.manager.itemEnd(l)},0),_;if(Eo[l]!==void 0){Eo[l].push({onLoad:d,onProgress:c,onError:h});return}var R=/^data:(.*?)(;base64)?,(.*)$/,O=l.match(R),B;if(O){var V=O[1],G=!!O[2],z=O[3];z=decodeURIComponent(z),G&&(z=atob(z));try{var ne,Q=(this.responseType||"").toLowerCase();switch(Q){case"arraybuffer":case"blob":for(var le=new Uint8Array(z.length),me=0;me<z.length;me++)le[me]=z.charCodeAt(me);Q==="blob"?ne=new Blob([le.buffer],{type:V}):ne=le.buffer;break;case"document":var ue=new DOMParser;ne=ue.parseFromString(z,V);break;case"json":ne=JSON.parse(z);break;default:ne=z;break}setTimeout(function(){d&&d(ne),x.manager.itemEnd(l)},0)}catch(Oe){setTimeout(function(){h&&h(Oe),x.manager.itemError(l),x.manager.itemEnd(l)},0)}}else{Eo[l]=[],Eo[l].push({onLoad:d,onProgress:c,onError:h}),B=new XMLHttpRequest,B.open("GET",l,!0),B.addEventListener("load",function(Oe){var He=this.response,Re=Eo[l];if(delete Eo[l],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Ac.add(l,He);for(var we=0,Ue=Re.length;we<Ue;we++){var rt=Re[we];rt.onLoad&&rt.onLoad(He)}x.manager.itemEnd(l)}else{for(var nt=0,ot=Re.length;nt<ot;nt++){var ut=Re[nt];ut.onError&&ut.onError(Oe)}x.manager.itemError(l),x.manager.itemEnd(l)}},!1),B.addEventListener("progress",function(Oe){for(var He=Eo[l],Re=0,we=He.length;Re<we;Re++){var Ue=He[Re];Ue.onProgress&&Ue.onProgress(Oe)}},!1),B.addEventListener("error",function(Oe){var He=Eo[l];delete Eo[l];for(var Re=0,we=He.length;Re<we;Re++){var Ue=He[Re];Ue.onError&&Ue.onError(Oe)}x.manager.itemError(l),x.manager.itemEnd(l)},!1),B.addEventListener("abort",function(Oe){var He=Eo[l];delete Eo[l];for(var Re=0,we=He.length;Re<we;Re++){var Ue=He[Re];Ue.onError&&Ue.onError(Oe)}x.manager.itemError(l),x.manager.itemEnd(l)},!1),this.responseType!==void 0&&(B.responseType=this.responseType),this.withCredentials!==void 0&&(B.withCredentials=this.withCredentials),B.overrideMimeType&&B.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(var re in this.requestHeader)B.setRequestHeader(re,this.requestHeader[re]);B.send(null)}return x.manager.itemStart(l),B},setResponseType:function(l){return this.responseType=l,this},setMimeType:function(l){return this.mimeType=l,this}});function hy(p){Jr.call(this,p)}hy.prototype=Object.assign(Object.create(Jr.prototype),{constructor:hy,load:function(l,d,c,h){var x=this,_=new oo(x.manager);_.setPath(x.path),_.setRequestHeader(x.requestHeader),_.setWithCredentials(x.withCredentials),_.load(l,function(R){try{d(x.parse(JSON.parse(R)))}catch(O){h?h(O):console.error(O),x.manager.itemError(l)}},c,h)},parse:function(l){for(var d=[],c=0;c<l.length;c++){var h=Xa.parse(l[c]);d.push(h)}return d}});function fy(p){Jr.call(this,p)}fy.prototype=Object.assign(Object.create(Jr.prototype),{constructor:fy,load:function(l,d,c,h){var x=this,_=[],R=new Su,O=new oo(this.manager);O.setPath(this.path),O.setResponseType("arraybuffer"),O.setRequestHeader(this.requestHeader),O.setWithCredentials(x.withCredentials);var B=0;function V(ne){O.load(l[ne],function(Q){var le=x.parse(Q,!0);_[ne]={width:le.width,height:le.height,format:le.format,mipmaps:le.mipmaps},B+=1,B===6&&(le.mipmapCount===1&&(R.minFilter=Ft),R.image=_,R.format=le.format,R.needsUpdate=!0,d&&d(R))},c,h)}if(Array.isArray(l))for(var G=0,z=l.length;G<z;++G)V(G);else O.load(l,function(ne){var Q=x.parse(ne,!0);if(Q.isCubemap){for(var le=Q.mipmaps.length/Q.mipmapCount,me=0;me<le;me++){_[me]={mipmaps:[]};for(var ue=0;ue<Q.mipmapCount;ue++)_[me].mipmaps.push(Q.mipmaps[me*Q.mipmapCount+ue]),_[me].format=Q.format,_[me].width=Q.width,_[me].height=Q.height}R.image=_}else R.image.width=Q.width,R.image.height=Q.height,R.mipmaps=Q.mipmaps;Q.mipmapCount===1&&(R.minFilter=Ft),R.format=Q.format,R.needsUpdate=!0,d&&d(R)},c,h);return R}});function Du(p){Jr.call(this,p)}Du.prototype=Object.assign(Object.create(Jr.prototype),{constructor:Du,load:function(l,d,c,h){this.path!==void 0&&(l=this.path+l),l=this.manager.resolveURL(l);var x=this,_=Ac.get(l);if(_!==void 0)return x.manager.itemStart(l),setTimeout(function(){d&&d(_),x.manager.itemEnd(l)},0),_;var R=document.createElementNS("http://www.w3.org/1999/xhtml","img");function O(){R.removeEventListener("load",O,!1),R.removeEventListener("error",B,!1),Ac.add(l,this),d&&d(this),x.manager.itemEnd(l)}function B(V){R.removeEventListener("load",O,!1),R.removeEventListener("error",B,!1),h&&h(V),x.manager.itemError(l),x.manager.itemEnd(l)}return R.addEventListener("load",O,!1),R.addEventListener("error",B,!1),l.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(R.crossOrigin=this.crossOrigin),x.manager.itemStart(l),R.src=l,R}});function Tm(p){Jr.call(this,p)}Tm.prototype=Object.assign(Object.create(Jr.prototype),{constructor:Tm,load:function(l,d,c,h){var x=new jo,_=new Du(this.manager);_.setCrossOrigin(this.crossOrigin),_.setPath(this.path);var R=0;function O(V){_.load(l[V],function(G){x.images[V]=G,R++,R===6&&(x.needsUpdate=!0,d&&d(x))},void 0,h)}for(var B=0;B<l.length;++B)O(B);return x}});function Cm(p){Jr.call(this,p)}Cm.prototype=Object.assign(Object.create(Jr.prototype),{constructor:Cm,load:function(l,d,c,h){var x=this,_=new As,R=new oo(this.manager);return R.setResponseType("arraybuffer"),R.setRequestHeader(this.requestHeader),R.setPath(this.path),R.setWithCredentials(x.withCredentials),R.load(l,function(O){var B=x.parse(O);!B||(B.image!==void 0?_.image=B.image:B.data!==void 0&&(_.image.width=B.width,_.image.height=B.height,_.image.data=B.data),_.wrapS=B.wrapS!==void 0?B.wrapS:Yt,_.wrapT=B.wrapT!==void 0?B.wrapT:Yt,_.magFilter=B.magFilter!==void 0?B.magFilter:Ft,_.minFilter=B.minFilter!==void 0?B.minFilter:Ft,_.anisotropy=B.anisotropy!==void 0?B.anisotropy:1,B.encoding!==void 0&&(_.encoding=B.encoding),B.flipY!==void 0&&(_.flipY=B.flipY),B.format!==void 0&&(_.format=B.format),B.type!==void 0&&(_.type=B.type),B.mipmaps!==void 0&&(_.mipmaps=B.mipmaps,_.minFilter=In),B.mipmapCount===1&&(_.minFilter=Ft),_.needsUpdate=!0,d&&d(_,B))},c,h),_}});function Rm(p){Jr.call(this,p)}Rm.prototype=Object.assign(Object.create(Jr.prototype),{constructor:Rm,load:function(l,d,c,h){var x=new ii,_=new Du(this.manager);return _.setCrossOrigin(this.crossOrigin),_.setPath(this.path),_.load(l,function(R){x.image=R;var O=l.search(/\.jpe?g($|\?)/i)>0||l.search(/^data\:image\/jpeg/)===0;x.format=O?Sn:pn,x.needsUpdate=!0,d!==void 0&&d(x)},c,h),x}});function Bn(){this.type="Curve",this.arcLengthDivisions=200}Object.assign(Bn.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(l,d){var c=this.getUtoTmapping(l);return this.getPoint(c,d)},getPoints:function(l){l===void 0&&(l=5);for(var d=[],c=0;c<=l;c++)d.push(this.getPoint(c/l));return d},getSpacedPoints:function(l){l===void 0&&(l=5);for(var d=[],c=0;c<=l;c++)d.push(this.getPointAt(c/l));return d},getLength:function(){var l=this.getLengths();return l[l.length-1]},getLengths:function(l){if(l===void 0&&(l=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===l+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var d=[],c,h=this.getPoint(0),x=0;d.push(0);for(var _=1;_<=l;_++)c=this.getPoint(_/l),x+=c.distanceTo(h),d.push(x),h=c;return this.cacheArcLengths=d,d},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(l,d){var c=this.getLengths(),h=0,x=c.length,_;d?_=d:_=l*c[x-1];for(var R=0,O=x-1,B;R<=O;)if(h=Math.floor(R+(O-R)/2),B=c[h]-_,B<0)R=h+1;else if(B>0)O=h-1;else{O=h;break}if(h=O,c[h]===_)return h/(x-1);var V=c[h],G=c[h+1],z=G-V,ne=(_-V)/z,Q=(h+ne)/(x-1);return Q},getTangent:function(l,d){var c=1e-4,h=l-c,x=l+c;h<0&&(h=0),x>1&&(x=1);var _=this.getPoint(h),R=this.getPoint(x),O=d||(_.isVector2?new Zt:new Ge);return O.copy(R).sub(_).normalize(),O},getTangentAt:function(l,d){var c=this.getUtoTmapping(l);return this.getTangent(c,d)},computeFrenetFrames:function(l,d){for(var c=new Ge,h=[],x=[],_=[],R=new Ge,O=new br,B=0;B<=l;B++){var V=B/l;h[B]=this.getTangentAt(V,new Ge),h[B].normalize()}x[0]=new Ge,_[0]=new Ge;var G=Number.MAX_VALUE,z=Math.abs(h[0].x),ne=Math.abs(h[0].y),Q=Math.abs(h[0].z);z<=G&&(G=z,c.set(1,0,0)),ne<=G&&(G=ne,c.set(0,1,0)),Q<=G&&c.set(0,0,1),R.crossVectors(h[0],c).normalize(),x[0].crossVectors(h[0],R),_[0].crossVectors(h[0],x[0]);for(var le=1;le<=l;le++){if(x[le]=x[le-1].clone(),_[le]=_[le-1].clone(),R.crossVectors(h[le-1],h[le]),R.length()>Number.EPSILON){R.normalize();var me=Math.acos(er.clamp(h[le-1].dot(h[le]),-1,1));x[le].applyMatrix4(O.makeRotationAxis(R,me))}_[le].crossVectors(h[le],x[le])}if(d===!0){var ue=Math.acos(er.clamp(x[0].dot(x[l]),-1,1));ue/=l,h[0].dot(R.crossVectors(x[0],x[l]))>0&&(ue=-ue);for(var re=1;re<=l;re++)x[re].applyMatrix4(O.makeRotationAxis(h[re],ue*re)),_[re].crossVectors(h[re],x[re])}return{tangents:h,normals:x,binormals:_}},clone:function(){return new this.constructor().copy(this)},copy:function(l){return this.arcLengthDivisions=l.arcLengthDivisions,this},toJSON:function(){var l={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return l.arcLengthDivisions=this.arcLengthDivisions,l.type=this.type,l},fromJSON:function(l){return this.arcLengthDivisions=l.arcLengthDivisions,this}});function qa(p,l,d,c,h,x,_,R){Bn.call(this),this.type="EllipseCurve",this.aX=p||0,this.aY=l||0,this.xRadius=d||1,this.yRadius=c||1,this.aStartAngle=h||0,this.aEndAngle=x||2*Math.PI,this.aClockwise=_||!1,this.aRotation=R||0}qa.prototype=Object.create(Bn.prototype),qa.prototype.constructor=qa,qa.prototype.isEllipseCurve=!0,qa.prototype.getPoint=function(p,l){for(var d=l||new Zt,c=Math.PI*2,h=this.aEndAngle-this.aStartAngle,x=Math.abs(h)<Number.EPSILON;h<0;)h+=c;for(;h>c;)h-=c;h<Number.EPSILON&&(x?h=0:h=c),this.aClockwise===!0&&!x&&(h===c?h=-c:h=h-c);var _=this.aStartAngle+p*h,R=this.aX+this.xRadius*Math.cos(_),O=this.aY+this.yRadius*Math.sin(_);if(this.aRotation!==0){var B=Math.cos(this.aRotation),V=Math.sin(this.aRotation),G=R-this.aX,z=O-this.aY;R=G*B-z*V+this.aX,O=G*V+z*B+this.aY}return d.set(R,O)},qa.prototype.copy=function(p){return Bn.prototype.copy.call(this,p),this.aX=p.aX,this.aY=p.aY,this.xRadius=p.xRadius,this.yRadius=p.yRadius,this.aStartAngle=p.aStartAngle,this.aEndAngle=p.aEndAngle,this.aClockwise=p.aClockwise,this.aRotation=p.aRotation,this},qa.prototype.toJSON=function(){var p=Bn.prototype.toJSON.call(this);return p.aX=this.aX,p.aY=this.aY,p.xRadius=this.xRadius,p.yRadius=this.yRadius,p.aStartAngle=this.aStartAngle,p.aEndAngle=this.aEndAngle,p.aClockwise=this.aClockwise,p.aRotation=this.aRotation,p},qa.prototype.fromJSON=function(p){return Bn.prototype.fromJSON.call(this,p),this.aX=p.aX,this.aY=p.aY,this.xRadius=p.xRadius,this.yRadius=p.yRadius,this.aStartAngle=p.aStartAngle,this.aEndAngle=p.aEndAngle,this.aClockwise=p.aClockwise,this.aRotation=p.aRotation,this};function Ou(p,l,d,c,h,x){qa.call(this,p,l,d,d,c,h,x),this.type="ArcCurve"}Ou.prototype=Object.create(qa.prototype),Ou.prototype.constructor=Ou,Ou.prototype.isArcCurve=!0;function dy(){var p=0,l=0,d=0,c=0;function h(x,_,R,O){p=x,l=R,d=-3*x+3*_-2*R-O,c=2*x-2*_+R+O}return{initCatmullRom:function(_,R,O,B,V){h(R,O,V*(O-_),V*(B-R))},initNonuniformCatmullRom:function(_,R,O,B,V,G,z){var ne=(R-_)/V-(O-_)/(V+G)+(O-R)/G,Q=(O-R)/G-(B-R)/(G+z)+(B-O)/z;ne*=G,Q*=G,h(R,O,ne,Q)},calc:function(_){var R=_*_,O=R*_;return p+l*_+d*R+c*O}}}var Lm=new Ge,py=new dy,my=new dy,vy=new dy;function aa(p,l,d,c){p===void 0&&(p=[]),l===void 0&&(l=!1),d===void 0&&(d="centripetal"),c===void 0&&(c=.5),Bn.call(this),this.type="CatmullRomCurve3",this.points=p,this.closed=l,this.curveType=d,this.tension=c}aa.prototype=Object.create(Bn.prototype),aa.prototype.constructor=aa,aa.prototype.isCatmullRomCurve3=!0,aa.prototype.getPoint=function(p,l){l===void 0&&(l=new Ge);var d=l,c=this.points,h=c.length,x=(h-(this.closed?0:1))*p,_=Math.floor(x),R=x-_;this.closed?_+=_>0?0:(Math.floor(Math.abs(_)/h)+1)*h:R===0&&_===h-1&&(_=h-2,R=1);var O,B;this.closed||_>0?O=c[(_-1)%h]:(Lm.subVectors(c[0],c[1]).add(c[0]),O=Lm);var V=c[_%h],G=c[(_+1)%h];if(this.closed||_+2<h?B=c[(_+2)%h]:(Lm.subVectors(c[h-1],c[h-2]).add(c[h-1]),B=Lm),this.curveType==="centripetal"||this.curveType==="chordal"){var z=this.curveType==="chordal"?.5:.25,ne=Math.pow(O.distanceToSquared(V),z),Q=Math.pow(V.distanceToSquared(G),z),le=Math.pow(G.distanceToSquared(B),z);Q<1e-4&&(Q=1),ne<1e-4&&(ne=Q),le<1e-4&&(le=Q),py.initNonuniformCatmullRom(O.x,V.x,G.x,B.x,ne,Q,le),my.initNonuniformCatmullRom(O.y,V.y,G.y,B.y,ne,Q,le),vy.initNonuniformCatmullRom(O.z,V.z,G.z,B.z,ne,Q,le)}else this.curveType==="catmullrom"&&(py.initCatmullRom(O.x,V.x,G.x,B.x,this.tension),my.initCatmullRom(O.y,V.y,G.y,B.y,this.tension),vy.initCatmullRom(O.z,V.z,G.z,B.z,this.tension));return d.set(py.calc(R),my.calc(R),vy.calc(R)),d},aa.prototype.copy=function(p){Bn.prototype.copy.call(this,p),this.points=[];for(var l=0,d=p.points.length;l<d;l++){var c=p.points[l];this.points.push(c.clone())}return this.closed=p.closed,this.curveType=p.curveType,this.tension=p.tension,this},aa.prototype.toJSON=function(){var p=Bn.prototype.toJSON.call(this);p.points=[];for(var l=0,d=this.points.length;l<d;l++){var c=this.points[l];p.points.push(c.toArray())}return p.closed=this.closed,p.curveType=this.curveType,p.tension=this.tension,p},aa.prototype.fromJSON=function(p){Bn.prototype.fromJSON.call(this,p),this.points=[];for(var l=0,d=p.points.length;l<d;l++){var c=p.points[l];this.points.push(new Ge().fromArray(c))}return this.closed=p.closed,this.curveType=p.curveType,this.tension=p.tension,this};function lE(p,l,d,c,h){var x=(c-l)*.5,_=(h-d)*.5,R=p*p,O=p*R;return(2*d-2*c+x+_)*O+(-3*d+3*c-2*x-_)*R+x*p+d}function ZI(p,l){var d=1-p;return d*d*l}function QI(p,l){return 2*(1-p)*p*l}function JI(p,l){return p*p*l}function Gf(p,l,d,c){return ZI(p,l)+QI(p,d)+JI(p,c)}function ek(p,l){var d=1-p;return d*d*d*l}function tk(p,l){var d=1-p;return 3*d*d*p*l}function nk(p,l){return 3*(1-p)*p*p*l}function rk(p,l){return p*p*p*l}function Vf(p,l,d,c,h){return ek(p,l)+tk(p,d)+nk(p,c)+rk(p,h)}function _o(p,l,d,c){p===void 0&&(p=new Zt),l===void 0&&(l=new Zt),d===void 0&&(d=new Zt),c===void 0&&(c=new Zt),Bn.call(this),this.type="CubicBezierCurve",this.v0=p,this.v1=l,this.v2=d,this.v3=c}_o.prototype=Object.create(Bn.prototype),_o.prototype.constructor=_o,_o.prototype.isCubicBezierCurve=!0,_o.prototype.getPoint=function(p,l){l===void 0&&(l=new Zt);var d=l,c=this.v0,h=this.v1,x=this.v2,_=this.v3;return d.set(Vf(p,c.x,h.x,x.x,_.x),Vf(p,c.y,h.y,x.y,_.y)),d},_o.prototype.copy=function(p){return Bn.prototype.copy.call(this,p),this.v0.copy(p.v0),this.v1.copy(p.v1),this.v2.copy(p.v2),this.v3.copy(p.v3),this},_o.prototype.toJSON=function(){var p=Bn.prototype.toJSON.call(this);return p.v0=this.v0.toArray(),p.v1=this.v1.toArray(),p.v2=this.v2.toArray(),p.v3=this.v3.toArray(),p},_o.prototype.fromJSON=function(p){return Bn.prototype.fromJSON.call(this,p),this.v0.fromArray(p.v0),this.v1.fromArray(p.v1),this.v2.fromArray(p.v2),this.v3.fromArray(p.v3),this};function qo(p,l,d,c){p===void 0&&(p=new Ge),l===void 0&&(l=new Ge),d===void 0&&(d=new Ge),c===void 0&&(c=new Ge),Bn.call(this),this.type="CubicBezierCurve3",this.v0=p,this.v1=l,this.v2=d,this.v3=c}qo.prototype=Object.create(Bn.prototype),qo.prototype.constructor=qo,qo.prototype.isCubicBezierCurve3=!0,qo.prototype.getPoint=function(p,l){l===void 0&&(l=new Ge);var d=l,c=this.v0,h=this.v1,x=this.v2,_=this.v3;return d.set(Vf(p,c.x,h.x,x.x,_.x),Vf(p,c.y,h.y,x.y,_.y),Vf(p,c.z,h.z,x.z,_.z)),d},qo.prototype.copy=function(p){return Bn.prototype.copy.call(this,p),this.v0.copy(p.v0),this.v1.copy(p.v1),this.v2.copy(p.v2),this.v3.copy(p.v3),this},qo.prototype.toJSON=function(){var p=Bn.prototype.toJSON.call(this);return p.v0=this.v0.toArray(),p.v1=this.v1.toArray(),p.v2=this.v2.toArray(),p.v3=this.v3.toArray(),p},qo.prototype.fromJSON=function(p){return Bn.prototype.fromJSON.call(this,p),this.v0.fromArray(p.v0),this.v1.fromArray(p.v1),this.v2.fromArray(p.v2),this.v3.fromArray(p.v3),this};function Ia(p,l){p===void 0&&(p=new Zt),l===void 0&&(l=new Zt),Bn.call(this),this.type="LineCurve",this.v1=p,this.v2=l}Ia.prototype=Object.create(Bn.prototype),Ia.prototype.constructor=Ia,Ia.prototype.isLineCurve=!0,Ia.prototype.getPoint=function(p,l){l===void 0&&(l=new Zt);var d=l;return p===1?d.copy(this.v2):(d.copy(this.v2).sub(this.v1),d.multiplyScalar(p).add(this.v1)),d},Ia.prototype.getPointAt=function(p,l){return this.getPoint(p,l)},Ia.prototype.getTangent=function(p,l){var d=l||new Zt;return d.copy(this.v2).sub(this.v1).normalize(),d},Ia.prototype.copy=function(p){return Bn.prototype.copy.call(this,p),this.v1.copy(p.v1),this.v2.copy(p.v2),this},Ia.prototype.toJSON=function(){var p=Bn.prototype.toJSON.call(this);return p.v1=this.v1.toArray(),p.v2=this.v2.toArray(),p},Ia.prototype.fromJSON=function(p){return Bn.prototype.fromJSON.call(this,p),this.v1.fromArray(p.v1),this.v2.fromArray(p.v2),this};function Mo(p,l){p===void 0&&(p=new Ge),l===void 0&&(l=new Ge),Bn.call(this),this.type="LineCurve3",this.v1=p,this.v2=l}Mo.prototype=Object.create(Bn.prototype),Mo.prototype.constructor=Mo,Mo.prototype.isLineCurve3=!0,Mo.prototype.getPoint=function(p,l){l===void 0&&(l=new Ge);var d=l;return p===1?d.copy(this.v2):(d.copy(this.v2).sub(this.v1),d.multiplyScalar(p).add(this.v1)),d},Mo.prototype.getPointAt=function(p,l){return this.getPoint(p,l)},Mo.prototype.copy=function(p){return Bn.prototype.copy.call(this,p),this.v1.copy(p.v1),this.v2.copy(p.v2),this},Mo.prototype.toJSON=function(){var p=Bn.prototype.toJSON.call(this);return p.v1=this.v1.toArray(),p.v2=this.v2.toArray(),p},Mo.prototype.fromJSON=function(p){return Bn.prototype.fromJSON.call(this,p),this.v1.fromArray(p.v1),this.v2.fromArray(p.v2),this};function So(p,l,d){p===void 0&&(p=new Zt),l===void 0&&(l=new Zt),d===void 0&&(d=new Zt),Bn.call(this),this.type="QuadraticBezierCurve",this.v0=p,this.v1=l,this.v2=d}So.prototype=Object.create(Bn.prototype),So.prototype.constructor=So,So.prototype.isQuadraticBezierCurve=!0,So.prototype.getPoint=function(p,l){l===void 0&&(l=new Zt);var d=l,c=this.v0,h=this.v1,x=this.v2;return d.set(Gf(p,c.x,h.x,x.x),Gf(p,c.y,h.y,x.y)),d},So.prototype.copy=function(p){return Bn.prototype.copy.call(this,p),this.v0.copy(p.v0),this.v1.copy(p.v1),this.v2.copy(p.v2),this},So.prototype.toJSON=function(){var p=Bn.prototype.toJSON.call(this);return p.v0=this.v0.toArray(),p.v1=this.v1.toArray(),p.v2=this.v2.toArray(),p},So.prototype.fromJSON=function(p){return Bn.prototype.fromJSON.call(this,p),this.v0.fromArray(p.v0),this.v1.fromArray(p.v1),this.v2.fromArray(p.v2),this};function Yo(p,l,d){p===void 0&&(p=new Ge),l===void 0&&(l=new Ge),d===void 0&&(d=new Ge),Bn.call(this),this.type="QuadraticBezierCurve3",this.v0=p,this.v1=l,this.v2=d}Yo.prototype=Object.create(Bn.prototype),Yo.prototype.constructor=Yo,Yo.prototype.isQuadraticBezierCurve3=!0,Yo.prototype.getPoint=function(p,l){l===void 0&&(l=new Ge);var d=l,c=this.v0,h=this.v1,x=this.v2;return d.set(Gf(p,c.x,h.x,x.x),Gf(p,c.y,h.y,x.y),Gf(p,c.z,h.z,x.z)),d},Yo.prototype.copy=function(p){return Bn.prototype.copy.call(this,p),this.v0.copy(p.v0),this.v1.copy(p.v1),this.v2.copy(p.v2),this},Yo.prototype.toJSON=function(){var p=Bn.prototype.toJSON.call(this);return p.v0=this.v0.toArray(),p.v1=this.v1.toArray(),p.v2=this.v2.toArray(),p},Yo.prototype.fromJSON=function(p){return Bn.prototype.fromJSON.call(this,p),this.v0.fromArray(p.v0),this.v1.fromArray(p.v1),this.v2.fromArray(p.v2),this};function To(p){p===void 0&&(p=[]),Bn.call(this),this.type="SplineCurve",this.points=p}To.prototype=Object.create(Bn.prototype),To.prototype.constructor=To,To.prototype.isSplineCurve=!0,To.prototype.getPoint=function(p,l){l===void 0&&(l=new Zt);var d=l,c=this.points,h=(c.length-1)*p,x=Math.floor(h),_=h-x,R=c[x===0?x:x-1],O=c[x],B=c[x>c.length-2?c.length-1:x+1],V=c[x>c.length-3?c.length-1:x+2];return d.set(lE(_,R.x,O.x,B.x,V.x),lE(_,R.y,O.y,B.y,V.y)),d},To.prototype.copy=function(p){Bn.prototype.copy.call(this,p),this.points=[];for(var l=0,d=p.points.length;l<d;l++){var c=p.points[l];this.points.push(c.clone())}return this},To.prototype.toJSON=function(){var p=Bn.prototype.toJSON.call(this);p.points=[];for(var l=0,d=this.points.length;l<d;l++){var c=this.points[l];p.points.push(c.toArray())}return p},To.prototype.fromJSON=function(p){Bn.prototype.fromJSON.call(this,p),this.points=[];for(var l=0,d=p.points.length;l<d;l++){var c=p.points[l];this.points.push(new Zt().fromArray(c))}return this};var gy=Object.freeze({__proto__:null,ArcCurve:Ou,CatmullRomCurve3:aa,CubicBezierCurve:_o,CubicBezierCurve3:qo,EllipseCurve:qa,LineCurve:Ia,LineCurve3:Mo,QuadraticBezierCurve:So,QuadraticBezierCurve3:Yo,SplineCurve:To});function gl(){Bn.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}gl.prototype=Object.assign(Object.create(Bn.prototype),{constructor:gl,add:function(l){this.curves.push(l)},closePath:function(){var l=this.curves[0].getPoint(0),d=this.curves[this.curves.length-1].getPoint(1);l.equals(d)||this.curves.push(new Ia(d,l))},getPoint:function(l){for(var d=l*this.getLength(),c=this.getCurveLengths(),h=0;h<c.length;){if(c[h]>=d){var x=c[h]-d,_=this.curves[h],R=_.getLength(),O=R===0?0:1-x/R;return _.getPointAt(O)}h++}return null},getLength:function(){var l=this.getCurveLengths();return l[l.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var l=[],d=0,c=0,h=this.curves.length;c<h;c++)d+=this.curves[c].getLength(),l.push(d);return this.cacheLengths=l,l},getSpacedPoints:function(l){l===void 0&&(l=40);for(var d=[],c=0;c<=l;c++)d.push(this.getPoint(c/l));return this.autoClose&&d.push(d[0]),d},getPoints:function(l){l===void 0&&(l=12);for(var d=[],c,h=0,x=this.curves;h<x.length;h++)for(var _=x[h],R=_&&_.isEllipseCurve?l*2:_&&(_.isLineCurve||_.isLineCurve3)?1:_&&_.isSplineCurve?l*_.points.length:l,O=_.getPoints(R),B=0;B<O.length;B++){var V=O[B];c&&c.equals(V)||(d.push(V),c=V)}return this.autoClose&&d.length>1&&!d[d.length-1].equals(d[0])&&d.push(d[0]),d},copy:function(l){Bn.prototype.copy.call(this,l),this.curves=[];for(var d=0,c=l.curves.length;d<c;d++){var h=l.curves[d];this.curves.push(h.clone())}return this.autoClose=l.autoClose,this},toJSON:function(){var l=Bn.prototype.toJSON.call(this);l.autoClose=this.autoClose,l.curves=[];for(var d=0,c=this.curves.length;d<c;d++){var h=this.curves[d];l.curves.push(h.toJSON())}return l},fromJSON:function(l){Bn.prototype.fromJSON.call(this,l),this.autoClose=l.autoClose,this.curves=[];for(var d=0,c=l.curves.length;d<c;d++){var h=l.curves[d];this.curves.push(new gy[h.type]().fromJSON(h))}return this}});function Co(p){gl.call(this),this.type="Path",this.currentPoint=new Zt,p&&this.setFromPoints(p)}Co.prototype=Object.assign(Object.create(gl.prototype),{constructor:Co,setFromPoints:function(l){this.moveTo(l[0].x,l[0].y);for(var d=1,c=l.length;d<c;d++)this.lineTo(l[d].x,l[d].y);return this},moveTo:function(l,d){return this.currentPoint.set(l,d),this},lineTo:function(l,d){var c=new Ia(this.currentPoint.clone(),new Zt(l,d));return this.curves.push(c),this.currentPoint.set(l,d),this},quadraticCurveTo:function(l,d,c,h){var x=new So(this.currentPoint.clone(),new Zt(l,d),new Zt(c,h));return this.curves.push(x),this.currentPoint.set(c,h),this},bezierCurveTo:function(l,d,c,h,x,_){var R=new _o(this.currentPoint.clone(),new Zt(l,d),new Zt(c,h),new Zt(x,_));return this.curves.push(R),this.currentPoint.set(x,_),this},splineThru:function(l){var d=[this.currentPoint.clone()].concat(l),c=new To(d);return this.curves.push(c),this.currentPoint.copy(l[l.length-1]),this},arc:function(l,d,c,h,x,_){var R=this.currentPoint.x,O=this.currentPoint.y;return this.absarc(l+R,d+O,c,h,x,_),this},absarc:function(l,d,c,h,x,_){return this.absellipse(l,d,c,c,h,x,_),this},ellipse:function(l,d,c,h,x,_,R,O){var B=this.currentPoint.x,V=this.currentPoint.y;return this.absellipse(l+B,d+V,c,h,x,_,R,O),this},absellipse:function(l,d,c,h,x,_,R,O){var B=new qa(l,d,c,h,x,_,R,O);if(this.curves.length>0){var V=B.getPoint(0);V.equals(this.currentPoint)||this.lineTo(V.x,V.y)}this.curves.push(B);var G=B.getPoint(1);return this.currentPoint.copy(G),this},copy:function(l){return gl.prototype.copy.call(this,l),this.currentPoint.copy(l.currentPoint),this},toJSON:function(){var l=gl.prototype.toJSON.call(this);return l.currentPoint=this.currentPoint.toArray(),l},fromJSON:function(l){return gl.prototype.fromJSON.call(this,l),this.currentPoint.fromArray(l.currentPoint),this}});function yl(p){Co.call(this,p),this.uuid=er.generateUUID(),this.type="Shape",this.holes=[]}yl.prototype=Object.assign(Object.create(Co.prototype),{constructor:yl,getPointsHoles:function(l){for(var d=[],c=0,h=this.holes.length;c<h;c++)d[c]=this.holes[c].getPoints(l);return d},extractPoints:function(l){return{shape:this.getPoints(l),holes:this.getPointsHoles(l)}},copy:function(l){Co.prototype.copy.call(this,l),this.holes=[];for(var d=0,c=l.holes.length;d<c;d++){var h=l.holes[d];this.holes.push(h.clone())}return this},toJSON:function(){var l=Co.prototype.toJSON.call(this);l.uuid=this.uuid,l.holes=[];for(var d=0,c=this.holes.length;d<c;d++){var h=this.holes[d];l.holes.push(h.toJSON())}return l},fromJSON:function(l){Co.prototype.fromJSON.call(this,l),this.uuid=l.uuid,this.holes=[];for(var d=0,c=l.holes.length;d<c;d++){var h=l.holes[d];this.holes.push(new Co().fromJSON(h))}return this}});function di(p,l){l===void 0&&(l=1),Dn.call(this),this.type="Light",this.color=new vn(p),this.intensity=l}di.prototype=Object.assign(Object.create(Dn.prototype),{constructor:di,isLight:!0,copy:function(l){return Dn.prototype.copy.call(this,l),this.color.copy(l.color),this.intensity=l.intensity,this},toJSON:function(l){var d=Dn.prototype.toJSON.call(this,l);return d.object.color=this.color.getHex(),d.object.intensity=this.intensity,this.groundColor!==void 0&&(d.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(d.object.distance=this.distance),this.angle!==void 0&&(d.object.angle=this.angle),this.decay!==void 0&&(d.object.decay=this.decay),this.penumbra!==void 0&&(d.object.penumbra=this.penumbra),this.shadow!==void 0&&(d.object.shadow=this.shadow.toJSON()),d}});function Pm(p,l,d){di.call(this,p,d),this.type="HemisphereLight",this.position.copy(Dn.DefaultUp),this.updateMatrix(),this.groundColor=new vn(l)}Pm.prototype=Object.assign(Object.create(di.prototype),{constructor:Pm,isHemisphereLight:!0,copy:function(l){return di.prototype.copy.call(this,l),this.groundColor.copy(l.groundColor),this}});function Ss(p){this.camera=p,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new Zt(512,512),this.map=null,this.mapPass=null,this.matrix=new br,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new vf,this._frameExtents=new Zt(1,1),this._viewportCount=1,this._viewports=[new Yr(0,0,1,1)]}Object.assign(Ss.prototype,{_projScreenMatrix:new br,_lightPositionWorld:new Ge,_lookTarget:new Ge,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(l){var d=this.camera,c=this.matrix,h=this._projScreenMatrix,x=this._lookTarget,_=this._lightPositionWorld;_.setFromMatrixPosition(l.matrixWorld),d.position.copy(_),x.setFromMatrixPosition(l.target.matrixWorld),d.lookAt(x),d.updateMatrixWorld(),h.multiplyMatrices(d.projectionMatrix,d.matrixWorldInverse),this._frustum.setFromProjectionMatrix(h),c.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),c.multiply(d.projectionMatrix),c.multiply(d.matrixWorldInverse)},getViewport:function(l){return this._viewports[l]},getFrameExtents:function(){return this._frameExtents},copy:function(l){return this.camera=l.camera.clone(),this.bias=l.bias,this.radius=l.radius,this.mapSize.copy(l.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var l={};return this.bias!==0&&(l.bias=this.bias),this.normalBias!==0&&(l.normalBias=this.normalBias),this.radius!==1&&(l.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(l.mapSize=this.mapSize.toArray()),l.camera=this.camera.toJSON(!1).object,delete l.camera.matrix,l}});function yy(){Ss.call(this,new Mi(50,1,.5,500)),this.focus=1}yy.prototype=Object.assign(Object.create(Ss.prototype),{constructor:yy,isSpotLightShadow:!0,updateMatrices:function(l){var d=this.camera,c=er.RAD2DEG*2*l.angle*this.focus,h=this.mapSize.width/this.mapSize.height,x=l.distance||d.far;(c!==d.fov||h!==d.aspect||x!==d.far)&&(d.fov=c,d.aspect=h,d.far=x,d.updateProjectionMatrix()),Ss.prototype.updateMatrices.call(this,l)}});function Dm(p,l,d,c,h,x){di.call(this,p,l),this.type="SpotLight",this.position.copy(Dn.DefaultUp),this.updateMatrix(),this.target=new Dn,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(R){this.intensity=R/Math.PI}}),this.distance=d!==void 0?d:0,this.angle=c!==void 0?c:Math.PI/3,this.penumbra=h!==void 0?h:0,this.decay=x!==void 0?x:1,this.shadow=new yy}Dm.prototype=Object.assign(Object.create(di.prototype),{constructor:Dm,isSpotLight:!0,copy:function(l){return di.prototype.copy.call(this,l),this.distance=l.distance,this.angle=l.angle,this.penumbra=l.penumbra,this.decay=l.decay,this.target=l.target.clone(),this.shadow=l.shadow.clone(),this}});function by(){Ss.call(this,new Mi(90,1,.5,500)),this._frameExtents=new Zt(4,2),this._viewportCount=6,this._viewports=[new Yr(2,1,1,1),new Yr(0,1,1,1),new Yr(3,1,1,1),new Yr(1,1,1,1),new Yr(3,0,1,1),new Yr(1,0,1,1)],this._cubeDirections=[new Ge(1,0,0),new Ge(-1,0,0),new Ge(0,0,1),new Ge(0,0,-1),new Ge(0,1,0),new Ge(0,-1,0)],this._cubeUps=[new Ge(0,1,0),new Ge(0,1,0),new Ge(0,1,0),new Ge(0,1,0),new Ge(0,0,1),new Ge(0,0,-1)]}by.prototype=Object.assign(Object.create(Ss.prototype),{constructor:by,isPointLightShadow:!0,updateMatrices:function(l,d){d===void 0&&(d=0);var c=this.camera,h=this.matrix,x=this._lightPositionWorld,_=this._lookTarget,R=this._projScreenMatrix;x.setFromMatrixPosition(l.matrixWorld),c.position.copy(x),_.copy(c.position),_.add(this._cubeDirections[d]),c.up.copy(this._cubeUps[d]),c.lookAt(_),c.updateMatrixWorld(),h.makeTranslation(-x.x,-x.y,-x.z),R.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse),this._frustum.setFromProjectionMatrix(R)}});function Om(p,l,d,c){di.call(this,p,l),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return this.intensity*4*Math.PI},set:function(x){this.intensity=x/(4*Math.PI)}}),this.distance=d!==void 0?d:0,this.decay=c!==void 0?c:1,this.shadow=new by}Om.prototype=Object.assign(Object.create(di.prototype),{constructor:Om,isPointLight:!0,copy:function(l){return di.prototype.copy.call(this,l),this.distance=l.distance,this.decay=l.decay,this.shadow=l.shadow.clone(),this}});function Iu(p,l,d,c,h,x){p===void 0&&(p=-1),l===void 0&&(l=1),d===void 0&&(d=1),c===void 0&&(c=-1),h===void 0&&(h=.1),x===void 0&&(x=2e3),Wo.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=p,this.right=l,this.top=d,this.bottom=c,this.near=h,this.far=x,this.updateProjectionMatrix()}Iu.prototype=Object.assign(Object.create(Wo.prototype),{constructor:Iu,isOrthographicCamera:!0,copy:function(l,d){return Wo.prototype.copy.call(this,l,d),this.left=l.left,this.right=l.right,this.top=l.top,this.bottom=l.bottom,this.near=l.near,this.far=l.far,this.zoom=l.zoom,this.view=l.view===null?null:Object.assign({},l.view),this},setViewOffset:function(l,d,c,h,x,_){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=l,this.view.fullHeight=d,this.view.offsetX=c,this.view.offsetY=h,this.view.width=x,this.view.height=_,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var l=(this.right-this.left)/(2*this.zoom),d=(this.top-this.bottom)/(2*this.zoom),c=(this.right+this.left)/2,h=(this.top+this.bottom)/2,x=c-l,_=c+l,R=h+d,O=h-d;if(this.view!==null&&this.view.enabled){var B=(this.right-this.left)/this.view.fullWidth/this.zoom,V=(this.top-this.bottom)/this.view.fullHeight/this.zoom;x+=B*this.view.offsetX,_=x+B*this.view.width,R-=V*this.view.offsetY,O=R-V*this.view.height}this.projectionMatrix.makeOrthographic(x,_,R,O,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(l){var d=Dn.prototype.toJSON.call(this,l);return d.object.zoom=this.zoom,d.object.left=this.left,d.object.right=this.right,d.object.top=this.top,d.object.bottom=this.bottom,d.object.near=this.near,d.object.far=this.far,this.view!==null&&(d.object.view=Object.assign({},this.view)),d}});function xy(){Ss.call(this,new Iu(-5,5,5,-5,.5,500))}xy.prototype=Object.assign(Object.create(Ss.prototype),{constructor:xy,isDirectionalLightShadow:!0,updateMatrices:function(l){Ss.prototype.updateMatrices.call(this,l)}});function Im(p,l){di.call(this,p,l),this.type="DirectionalLight",this.position.copy(Dn.DefaultUp),this.updateMatrix(),this.target=new Dn,this.shadow=new xy}Im.prototype=Object.assign(Object.create(di.prototype),{constructor:Im,isDirectionalLight:!0,copy:function(l){return di.prototype.copy.call(this,l),this.target=l.target.clone(),this.shadow=l.shadow.clone(),this}});function km(p,l){di.call(this,p,l),this.type="AmbientLight"}km.prototype=Object.assign(Object.create(di.prototype),{constructor:km,isAmbientLight:!0});function Fm(p,l,d,c){di.call(this,p,l),this.type="RectAreaLight",this.width=d!==void 0?d:10,this.height=c!==void 0?c:10}Fm.prototype=Object.assign(Object.create(di.prototype),{constructor:Fm,isRectAreaLight:!0,copy:function(l){return di.prototype.copy.call(this,l),this.width=l.width,this.height=l.height,this},toJSON:function(l){var d=di.prototype.toJSON.call(this,l);return d.object.width=this.width,d.object.height=this.height,d}});var cE=function(){function p(){Object.defineProperty(this,"isSphericalHarmonics3",{value:!0}),this.coefficients=[];for(var d=0;d<9;d++)this.coefficients.push(new Ge)}var l=p.prototype;return l.set=function(c){for(var h=0;h<9;h++)this.coefficients[h].copy(c[h]);return this},l.zero=function(){for(var c=0;c<9;c++)this.coefficients[c].set(0,0,0);return this},l.getAt=function(c,h){var x=c.x,_=c.y,R=c.z,O=this.coefficients;return h.copy(O[0]).multiplyScalar(.282095),h.addScaledVector(O[1],.488603*_),h.addScaledVector(O[2],.488603*R),h.addScaledVector(O[3],.488603*x),h.addScaledVector(O[4],1.092548*(x*_)),h.addScaledVector(O[5],1.092548*(_*R)),h.addScaledVector(O[6],.315392*(3*R*R-1)),h.addScaledVector(O[7],1.092548*(x*R)),h.addScaledVector(O[8],.546274*(x*x-_*_)),h},l.getIrradianceAt=function(c,h){var x=c.x,_=c.y,R=c.z,O=this.coefficients;return h.copy(O[0]).multiplyScalar(.886227),h.addScaledVector(O[1],2*.511664*_),h.addScaledVector(O[2],2*.511664*R),h.addScaledVector(O[3],2*.511664*x),h.addScaledVector(O[4],2*.429043*x*_),h.addScaledVector(O[5],2*.429043*_*R),h.addScaledVector(O[6],.743125*R*R-.247708),h.addScaledVector(O[7],2*.429043*x*R),h.addScaledVector(O[8],.429043*(x*x-_*_)),h},l.add=function(c){for(var h=0;h<9;h++)this.coefficients[h].add(c.coefficients[h]);return this},l.addScaledSH=function(c,h){for(var x=0;x<9;x++)this.coefficients[x].addScaledVector(c.coefficients[x],h);return this},l.scale=function(c){for(var h=0;h<9;h++)this.coefficients[h].multiplyScalar(c);return this},l.lerp=function(c,h){for(var x=0;x<9;x++)this.coefficients[x].lerp(c.coefficients[x],h);return this},l.equals=function(c){for(var h=0;h<9;h++)if(!this.coefficients[h].equals(c.coefficients[h]))return!1;return!0},l.copy=function(c){return this.set(c.coefficients)},l.clone=function(){return new this.constructor().copy(this)},l.fromArray=function(c,h){h===void 0&&(h=0);for(var x=this.coefficients,_=0;_<9;_++)x[_].fromArray(c,h+_*3);return this},l.toArray=function(c,h){c===void 0&&(c=[]),h===void 0&&(h=0);for(var x=this.coefficients,_=0;_<9;_++)x[_].toArray(c,h+_*3);return c},p.getBasisAt=function(c,h){var x=c.x,_=c.y,R=c.z;h[0]=.282095,h[1]=.488603*_,h[2]=.488603*R,h[3]=.488603*x,h[4]=1.092548*x*_,h[5]=1.092548*_*R,h[6]=.315392*(3*R*R-1),h[7]=1.092548*x*R,h[8]=.546274*(x*x-_*_)},p}();function so(p,l){di.call(this,void 0,l),this.type="LightProbe",this.sh=p!==void 0?p:new cE}so.prototype=Object.assign(Object.create(di.prototype),{constructor:so,isLightProbe:!0,copy:function(l){return di.prototype.copy.call(this,l),this.sh.copy(l.sh),this},fromJSON:function(l){return this.intensity=l.intensity,this.sh.fromArray(l.sh),this},toJSON:function(l){var d=di.prototype.toJSON.call(this,l);return d.object.sh=this.sh.toArray(),d}});function Bm(p){Jr.call(this,p),this.textures={}}Bm.prototype=Object.assign(Object.create(Jr.prototype),{constructor:Bm,load:function(l,d,c,h){var x=this,_=new oo(x.manager);_.setPath(x.path),_.setRequestHeader(x.requestHeader),_.setWithCredentials(x.withCredentials),_.load(l,function(R){try{d(x.parse(JSON.parse(R)))}catch(O){h?h(O):console.error(O),x.manager.itemError(l)}},c,h)},parse:function(l){var d=this.textures;function c(B){return d[B]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",B),d[B]}var h=new YI[l.type];if(l.uuid!==void 0&&(h.uuid=l.uuid),l.name!==void 0&&(h.name=l.name),l.color!==void 0&&h.color!==void 0&&h.color.setHex(l.color),l.roughness!==void 0&&(h.roughness=l.roughness),l.metalness!==void 0&&(h.metalness=l.metalness),l.sheen!==void 0&&(h.sheen=new vn().setHex(l.sheen)),l.emissive!==void 0&&h.emissive!==void 0&&h.emissive.setHex(l.emissive),l.specular!==void 0&&h.specular!==void 0&&h.specular.setHex(l.specular),l.shininess!==void 0&&(h.shininess=l.shininess),l.clearcoat!==void 0&&(h.clearcoat=l.clearcoat),l.clearcoatRoughness!==void 0&&(h.clearcoatRoughness=l.clearcoatRoughness),l.fog!==void 0&&(h.fog=l.fog),l.flatShading!==void 0&&(h.flatShading=l.flatShading),l.blending!==void 0&&(h.blending=l.blending),l.combine!==void 0&&(h.combine=l.combine),l.side!==void 0&&(h.side=l.side),l.opacity!==void 0&&(h.opacity=l.opacity),l.transparent!==void 0&&(h.transparent=l.transparent),l.alphaTest!==void 0&&(h.alphaTest=l.alphaTest),l.depthTest!==void 0&&(h.depthTest=l.depthTest),l.depthWrite!==void 0&&(h.depthWrite=l.depthWrite),l.colorWrite!==void 0&&(h.colorWrite=l.colorWrite),l.stencilWrite!==void 0&&(h.stencilWrite=l.stencilWrite),l.stencilWriteMask!==void 0&&(h.stencilWriteMask=l.stencilWriteMask),l.stencilFunc!==void 0&&(h.stencilFunc=l.stencilFunc),l.stencilRef!==void 0&&(h.stencilRef=l.stencilRef),l.stencilFuncMask!==void 0&&(h.stencilFuncMask=l.stencilFuncMask),l.stencilFail!==void 0&&(h.stencilFail=l.stencilFail),l.stencilZFail!==void 0&&(h.stencilZFail=l.stencilZFail),l.stencilZPass!==void 0&&(h.stencilZPass=l.stencilZPass),l.wireframe!==void 0&&(h.wireframe=l.wireframe),l.wireframeLinewidth!==void 0&&(h.wireframeLinewidth=l.wireframeLinewidth),l.wireframeLinecap!==void 0&&(h.wireframeLinecap=l.wireframeLinecap),l.wireframeLinejoin!==void 0&&(h.wireframeLinejoin=l.wireframeLinejoin),l.rotation!==void 0&&(h.rotation=l.rotation),l.linewidth!==1&&(h.linewidth=l.linewidth),l.dashSize!==void 0&&(h.dashSize=l.dashSize),l.gapSize!==void 0&&(h.gapSize=l.gapSize),l.scale!==void 0&&(h.scale=l.scale),l.polygonOffset!==void 0&&(h.polygonOffset=l.polygonOffset),l.polygonOffsetFactor!==void 0&&(h.polygonOffsetFactor=l.polygonOffsetFactor),l.polygonOffsetUnits!==void 0&&(h.polygonOffsetUnits=l.polygonOffsetUnits),l.skinning!==void 0&&(h.skinning=l.skinning),l.morphTargets!==void 0&&(h.morphTargets=l.morphTargets),l.morphNormals!==void 0&&(h.morphNormals=l.morphNormals),l.dithering!==void 0&&(h.dithering=l.dithering),l.vertexTangents!==void 0&&(h.vertexTangents=l.vertexTangents),l.visible!==void 0&&(h.visible=l.visible),l.toneMapped!==void 0&&(h.toneMapped=l.toneMapped),l.userData!==void 0&&(h.userData=l.userData),l.vertexColors!==void 0&&(typeof l.vertexColors=="number"?h.vertexColors=l.vertexColors>0:h.vertexColors=l.vertexColors),l.uniforms!==void 0)for(var x in l.uniforms){var _=l.uniforms[x];switch(h.uniforms[x]={},_.type){case"t":h.uniforms[x].value=c(_.value);break;case"c":h.uniforms[x].value=new vn().setHex(_.value);break;case"v2":h.uniforms[x].value=new Zt().fromArray(_.value);break;case"v3":h.uniforms[x].value=new Ge().fromArray(_.value);break;case"v4":h.uniforms[x].value=new Yr().fromArray(_.value);break;case"m3":h.uniforms[x].value=new Ua().fromArray(_.value);break;case"m4":h.uniforms[x].value=new br().fromArray(_.value);break;default:h.uniforms[x].value=_.value}}if(l.defines!==void 0&&(h.defines=l.defines),l.vertexShader!==void 0&&(h.vertexShader=l.vertexShader),l.fragmentShader!==void 0&&(h.fragmentShader=l.fragmentShader),l.extensions!==void 0)for(var R in l.extensions)h.extensions[R]=l.extensions[R];if(l.shading!==void 0&&(h.flatShading=l.shading===1),l.size!==void 0&&(h.size=l.size),l.sizeAttenuation!==void 0&&(h.sizeAttenuation=l.sizeAttenuation),l.map!==void 0&&(h.map=c(l.map)),l.matcap!==void 0&&(h.matcap=c(l.matcap)),l.alphaMap!==void 0&&(h.alphaMap=c(l.alphaMap)),l.bumpMap!==void 0&&(h.bumpMap=c(l.bumpMap)),l.bumpScale!==void 0&&(h.bumpScale=l.bumpScale),l.normalMap!==void 0&&(h.normalMap=c(l.normalMap)),l.normalMapType!==void 0&&(h.normalMapType=l.normalMapType),l.normalScale!==void 0){var O=l.normalScale;Array.isArray(O)===!1&&(O=[O,O]),h.normalScale=new Zt().fromArray(O)}return l.displacementMap!==void 0&&(h.displacementMap=c(l.displacementMap)),l.displacementScale!==void 0&&(h.displacementScale=l.displacementScale),l.displacementBias!==void 0&&(h.displacementBias=l.displacementBias),l.roughnessMap!==void 0&&(h.roughnessMap=c(l.roughnessMap)),l.metalnessMap!==void 0&&(h.metalnessMap=c(l.metalnessMap)),l.emissiveMap!==void 0&&(h.emissiveMap=c(l.emissiveMap)),l.emissiveIntensity!==void 0&&(h.emissiveIntensity=l.emissiveIntensity),l.specularMap!==void 0&&(h.specularMap=c(l.specularMap)),l.envMap!==void 0&&(h.envMap=c(l.envMap)),l.envMapIntensity!==void 0&&(h.envMapIntensity=l.envMapIntensity),l.reflectivity!==void 0&&(h.reflectivity=l.reflectivity),l.refractionRatio!==void 0&&(h.refractionRatio=l.refractionRatio),l.lightMap!==void 0&&(h.lightMap=c(l.lightMap)),l.lightMapIntensity!==void 0&&(h.lightMapIntensity=l.lightMapIntensity),l.aoMap!==void 0&&(h.aoMap=c(l.aoMap)),l.aoMapIntensity!==void 0&&(h.aoMapIntensity=l.aoMapIntensity),l.gradientMap!==void 0&&(h.gradientMap=c(l.gradientMap)),l.clearcoatMap!==void 0&&(h.clearcoatMap=c(l.clearcoatMap)),l.clearcoatRoughnessMap!==void 0&&(h.clearcoatRoughnessMap=c(l.clearcoatRoughnessMap)),l.clearcoatNormalMap!==void 0&&(h.clearcoatNormalMap=c(l.clearcoatNormalMap)),l.clearcoatNormalScale!==void 0&&(h.clearcoatNormalScale=new Zt().fromArray(l.clearcoatNormalScale)),l.transmission!==void 0&&(h.transmission=l.transmission),l.transmissionMap!==void 0&&(h.transmissionMap=c(l.transmissionMap)),h},setTextures:function(l){return this.textures=l,this}});var wy={decodeText:function(l){if(typeof TextDecoder!="undefined")return new TextDecoder().decode(l);for(var d="",c=0,h=l.length;c<h;c++)d+=String.fromCharCode(l[c]);try{return decodeURIComponent(escape(d))}catch{return d}},extractUrlBase:function(l){var d=l.lastIndexOf("/");return d===-1?"./":l.substr(0,d+1)}};function Wf(){Vn.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}Wf.prototype=Object.assign(Object.create(Vn.prototype),{constructor:Wf,isInstancedBufferGeometry:!0,copy:function(l){return Vn.prototype.copy.call(this,l),this.instanceCount=l.instanceCount,this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var l=Vn.prototype.toJSON.call(this);return l.instanceCount=this.instanceCount,l.isInstancedBufferGeometry=!0,l}});function Nm(p,l,d,c){typeof d=="number"&&(c=d,d=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),Zn.call(this,p,l,d),this.meshPerAttribute=c||1}Nm.prototype=Object.assign(Object.create(Zn.prototype),{constructor:Nm,isInstancedBufferAttribute:!0,copy:function(l){return Zn.prototype.copy.call(this,l),this.meshPerAttribute=l.meshPerAttribute,this},toJSON:function(){var l=Zn.prototype.toJSON.call(this);return l.meshPerAttribute=this.meshPerAttribute,l.isInstancedBufferAttribute=!0,l}});function Um(p){Jr.call(this,p)}Um.prototype=Object.assign(Object.create(Jr.prototype),{constructor:Um,load:function(l,d,c,h){var x=this,_=new oo(x.manager);_.setPath(x.path),_.setRequestHeader(x.requestHeader),_.setWithCredentials(x.withCredentials),_.load(l,function(R){try{d(x.parse(JSON.parse(R)))}catch(O){h?h(O):console.error(O),x.manager.itemError(l)}},c,h)},parse:function(l){var d={},c={};function h(Ke,vt){if(d[vt]!==void 0)return d[vt];var gt=Ke.interleavedBuffers,St=gt[vt],Tt=x(Ke,St.buffer),qt=pf(St.type,Tt),en=new Wa(qt,St.stride);return en.uuid=St.uuid,d[vt]=en,en}function x(Ke,vt){if(c[vt]!==void 0)return c[vt];var gt=Ke.arrayBuffers,St=gt[vt],Tt=new Uint32Array(St).buffer;return c[vt]=Tt,Tt}var _=l.isInstancedBufferGeometry?new Wf:new Vn,R=l.data.index;if(R!==void 0){var O=pf(R.type,R.array);_.setIndex(new Zn(O,1))}var B=l.data.attributes;for(var V in B){var G=B[V],z=void 0;if(G.isInterleavedBufferAttribute){var ne=h(l.data,G.data);z=new hl(ne,G.itemSize,G.offset,G.normalized)}else{var Q=pf(G.type,G.array),le=G.isInstancedBufferAttribute?Nm:Zn;z=new le(Q,G.itemSize,G.normalized)}G.name!==void 0&&(z.name=G.name),_.setAttribute(V,z)}var me=l.data.morphAttributes;if(me)for(var ue in me){for(var re=me[ue],Oe=[],He=0,Re=re.length;He<Re;He++){var we=re[He],Ue=void 0;if(we.isInterleavedBufferAttribute){var rt=h(l.data,we.data);Ue=new hl(rt,we.itemSize,we.offset,we.normalized)}else{var nt=pf(we.type,we.array);Ue=new Zn(nt,we.itemSize,we.normalized)}we.name!==void 0&&(Ue.name=we.name),Oe.push(Ue)}_.morphAttributes[ue]=Oe}var ot=l.data.morphTargetsRelative;ot&&(_.morphTargetsRelative=!0);var ut=l.data.groups||l.data.drawcalls||l.data.offsets;if(ut!==void 0)for(var st=0,et=ut.length;st!==et;++st){var dt=ut[st];_.addGroup(dt.start,dt.count,dt.materialIndex)}var at=l.data.boundingSphere;if(at!==void 0){var it=new Ge;at.center!==void 0&&it.fromArray(at.center),_.boundingSphere=new nl(it,at.radius)}return l.name&&(_.name=l.name),l.userData&&(_.userData=l.userData),_}});var ik=function(p){pr(l,p);function l(c){return p.call(this,c)||this}var d=l.prototype;return d.load=function(h,x,_,R){var O=this,B=this.path===""?wy.extractUrlBase(h):this.path;this.resourcePath=this.resourcePath||B;var V=new oo(this.manager);V.setPath(this.path),V.setRequestHeader(this.requestHeader),V.setWithCredentials(this.withCredentials),V.load(h,function(G){var z=null;try{z=JSON.parse(G)}catch(Q){R!==void 0&&R(Q),console.error("THREE:ObjectLoader: Can't parse "+h+".",Q.message);return}var ne=z.metadata;if(ne===void 0||ne.type===void 0||ne.type.toLowerCase()==="geometry"){console.error("THREE.ObjectLoader: Can't load "+h);return}O.parse(z,x)},_,R)},d.parse=function(h,x){var _=this.parseAnimations(h.animations),R=this.parseShapes(h.shapes),O=this.parseGeometries(h.geometries,R),B=this.parseImages(h.images,function(){x!==void 0&&x(z)}),V=this.parseTextures(h.textures,B),G=this.parseMaterials(h.materials,V),z=this.parseObject(h.object,O,G,_),ne=this.parseSkeletons(h.skeletons,z);if(this.bindSkeletons(z,ne),x!==void 0){var Q=!1;for(var le in B)if(B[le]instanceof HTMLImageElement){Q=!0;break}Q===!1&&x(z)}return z},d.parseShapes=function(h){var x={};if(h!==void 0)for(var _=0,R=h.length;_<R;_++){var O=new yl().fromJSON(h[_]);x[O.uuid]=O}return x},d.parseSkeletons=function(h,x){var _={},R={};if(x.traverse(function(G){G.isBone&&(R[G.uuid]=G)}),h!==void 0)for(var O=0,B=h.length;O<B;O++){var V=new Lf().fromJSON(h[O],R);_[V.uuid]=V}return _},d.parseGeometries=function(h,x){var _={},R;if(h!==void 0)for(var O=new Um,B=0,V=h.length;B<V;B++){var G=void 0,z=h[B];switch(z.type){case"PlaneGeometry":case"PlaneBufferGeometry":G=new Ea[z.type](z.width,z.height,z.widthSegments,z.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":G=new Ea[z.type](z.width,z.height,z.depth,z.widthSegments,z.heightSegments,z.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":G=new Ea[z.type](z.radius,z.segments,z.thetaStart,z.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":G=new Ea[z.type](z.radiusTop,z.radiusBottom,z.height,z.radialSegments,z.heightSegments,z.openEnded,z.thetaStart,z.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":G=new Ea[z.type](z.radius,z.height,z.radialSegments,z.heightSegments,z.openEnded,z.thetaStart,z.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":G=new Ea[z.type](z.radius,z.widthSegments,z.heightSegments,z.phiStart,z.phiLength,z.thetaStart,z.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":G=new Ea[z.type](z.radius,z.detail);break;case"RingGeometry":case"RingBufferGeometry":G=new Ea[z.type](z.innerRadius,z.outerRadius,z.thetaSegments,z.phiSegments,z.thetaStart,z.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":G=new Ea[z.type](z.radius,z.tube,z.radialSegments,z.tubularSegments,z.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":G=new Ea[z.type](z.radius,z.tube,z.tubularSegments,z.radialSegments,z.p,z.q);break;case"TubeGeometry":case"TubeBufferGeometry":G=new Ea[z.type](new gy[z.path.type]().fromJSON(z.path),z.tubularSegments,z.radius,z.radialSegments,z.closed);break;case"LatheGeometry":case"LatheBufferGeometry":G=new Ea[z.type](z.points,z.segments,z.phiStart,z.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":G=new Ea[z.type](z.vertices,z.indices,z.radius,z.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":R=[];for(var ne=0,Q=z.shapes.length;ne<Q;ne++){var le=x[z.shapes[ne]];R.push(le)}G=new Ea[z.type](R,z.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":R=[];for(var me=0,ue=z.shapes.length;me<ue;me++){var re=x[z.shapes[me]];R.push(re)}var Oe=z.options.extrudePath;Oe!==void 0&&(z.options.extrudePath=new gy[Oe.type]().fromJSON(Oe)),G=new Ea[z.type](R,z.options);break;case"BufferGeometry":case"InstancedBufferGeometry":G=O.parse(z);break;case"Geometry":if("THREE"in window&&"LegacyJSONLoader"in THREE){var He=new THREE.LegacyJSONLoader;G=He.parse(z,this.resourcePath).geometry}else console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+z.type+'"');continue}G.uuid=z.uuid,z.name!==void 0&&(G.name=z.name),G.isBufferGeometry===!0&&z.userData!==void 0&&(G.userData=z.userData),_[z.uuid]=G}return _},d.parseMaterials=function(h,x){var _={},R={};if(h!==void 0){var O=new Bm;O.setTextures(x);for(var B=0,V=h.length;B<V;B++){var G=h[B];if(G.type==="MultiMaterial"){for(var z=[],ne=0;ne<G.materials.length;ne++){var Q=G.materials[ne];_[Q.uuid]===void 0&&(_[Q.uuid]=O.parse(Q)),z.push(_[Q.uuid])}R[G.uuid]=z}else _[G.uuid]===void 0&&(_[G.uuid]=O.parse(G)),R[G.uuid]=_[G.uuid]}}return R},d.parseAnimations=function(h){var x={};if(h!==void 0)for(var _=0;_<h.length;_++){var R=h[_],O=Xa.parse(R);x[O.uuid]=O}return x},d.parseImages=function(h,x){var _=this,R={},O;function B(Re){return _.manager.itemStart(Re),O.load(Re,function(){_.manager.itemEnd(Re)},void 0,function(){_.manager.itemError(Re),_.manager.itemEnd(Re)})}function V(Re){if(typeof Re=="string"){var we=Re,Ue=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(we)?we:_.resourcePath+we;return B(Ue)}else return Re.data?{data:pf(Re.type,Re.data),width:Re.width,height:Re.height}:null}if(h!==void 0&&h.length>0){var G=new uy(x);O=new Du(G),O.setCrossOrigin(this.crossOrigin);for(var z=0,ne=h.length;z<ne;z++){var Q=h[z],le=Q.url;if(Array.isArray(le)){R[Q.uuid]=[];for(var me=0,ue=le.length;me<ue;me++){var re=le[me],Oe=V(re);Oe!==null&&(Oe instanceof HTMLImageElement?R[Q.uuid].push(Oe):R[Q.uuid].push(new As(Oe.data,Oe.width,Oe.height)))}}else{var He=V(Q.url);He!==null&&(R[Q.uuid]=He)}}}return R},d.parseTextures=function(h,x){function _(ne,Q){return typeof ne=="number"?ne:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",ne),Q[ne])}var R={};if(h!==void 0)for(var O=0,B=h.length;O<B;O++){var V=h[O];V.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',V.uuid),x[V.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",V.image);var G=void 0,z=x[V.image];Array.isArray(z)?(G=new jo(z),z.length===6&&(G.needsUpdate=!0)):(z&&z.data?G=new As(z.data,z.width,z.height):G=new ii(z),z&&(G.needsUpdate=!0)),G.uuid=V.uuid,V.name!==void 0&&(G.name=V.name),V.mapping!==void 0&&(G.mapping=_(V.mapping,ak)),V.offset!==void 0&&G.offset.fromArray(V.offset),V.repeat!==void 0&&G.repeat.fromArray(V.repeat),V.center!==void 0&&G.center.fromArray(V.center),V.rotation!==void 0&&(G.rotation=V.rotation),V.wrap!==void 0&&(G.wrapS=_(V.wrap[0],uE),G.wrapT=_(V.wrap[1],uE)),V.format!==void 0&&(G.format=V.format),V.type!==void 0&&(G.type=V.type),V.encoding!==void 0&&(G.encoding=V.encoding),V.minFilter!==void 0&&(G.minFilter=_(V.minFilter,hE)),V.magFilter!==void 0&&(G.magFilter=_(V.magFilter,hE)),V.anisotropy!==void 0&&(G.anisotropy=V.anisotropy),V.flipY!==void 0&&(G.flipY=V.flipY),V.premultiplyAlpha!==void 0&&(G.premultiplyAlpha=V.premultiplyAlpha),V.unpackAlignment!==void 0&&(G.unpackAlignment=V.unpackAlignment),R[V.uuid]=G}return R},d.parseObject=function(h,x,_,R){var O;function B(rt){return x[rt]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",rt),x[rt]}function V(rt){if(rt!==void 0){if(Array.isArray(rt)){for(var nt=[],ot=0,ut=rt.length;ot<ut;ot++){var st=rt[ot];_[st]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",st),nt.push(_[st])}return nt}return _[rt]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",rt),_[rt]}}var G,z;switch(h.type){case"Scene":O=new ey,h.background!==void 0&&Number.isInteger(h.background)&&(O.background=new vn(h.background)),h.fog!==void 0&&(h.fog.type==="Fog"?O.fog=new FA(h.fog.color,h.fog.near,h.fog.far):h.fog.type==="FogExp2"&&(O.fog=new kA(h.fog.color,h.fog.density)));break;case"PerspectiveCamera":O=new Mi(h.fov,h.aspect,h.near,h.far),h.focus!==void 0&&(O.focus=h.focus),h.zoom!==void 0&&(O.zoom=h.zoom),h.filmGauge!==void 0&&(O.filmGauge=h.filmGauge),h.filmOffset!==void 0&&(O.filmOffset=h.filmOffset),h.view!==void 0&&(O.view=Object.assign({},h.view));break;case"OrthographicCamera":O=new Iu(h.left,h.right,h.top,h.bottom,h.near,h.far),h.zoom!==void 0&&(O.zoom=h.zoom),h.view!==void 0&&(O.view=Object.assign({},h.view));break;case"AmbientLight":O=new km(h.color,h.intensity);break;case"DirectionalLight":O=new Im(h.color,h.intensity);break;case"PointLight":O=new Om(h.color,h.intensity,h.distance,h.decay);break;case"RectAreaLight":O=new Fm(h.color,h.intensity,h.width,h.height);break;case"SpotLight":O=new Dm(h.color,h.intensity,h.distance,h.angle,h.penumbra,h.decay);break;case"HemisphereLight":O=new Pm(h.color,h.groundColor,h.intensity);break;case"LightProbe":O=new so().fromJSON(h);break;case"SkinnedMesh":G=B(h.geometry),z=V(h.material),O=new Cf(G,z),h.bindMode!==void 0&&(O.bindMode=h.bindMode),h.bindMatrix!==void 0&&O.bindMatrix.fromArray(h.bindMatrix),h.skeleton!==void 0&&(O.skeleton=h.skeleton);break;case"Mesh":G=B(h.geometry),z=V(h.material),O=new fi(G,z);break;case"InstancedMesh":G=B(h.geometry),z=V(h.material);var ne=h.count,Q=h.instanceMatrix;O=new em(G,z,ne),O.instanceMatrix=new Zn(new Float32Array(Q.array),16);break;case"LOD":O=new Tf;break;case"Line":O=new ao(B(h.geometry),V(h.material));break;case"LineLoop":O=new nm(B(h.geometry),V(h.material));break;case"LineSegments":O=new Aa(B(h.geometry),V(h.material));break;case"PointCloud":case"Points":O=new Mu(B(h.geometry),V(h.material));break;case"Sprite":O=new Sf(V(h.material));break;case"Group":O=new Es;break;case"Bone":O=new Rf;break;default:O=new Dn}if(O.uuid=h.uuid,h.name!==void 0&&(O.name=h.name),h.matrix!==void 0?(O.matrix.fromArray(h.matrix),h.matrixAutoUpdate!==void 0&&(O.matrixAutoUpdate=h.matrixAutoUpdate),O.matrixAutoUpdate&&O.matrix.decompose(O.position,O.quaternion,O.scale)):(h.position!==void 0&&O.position.fromArray(h.position),h.rotation!==void 0&&O.rotation.fromArray(h.rotation),h.quaternion!==void 0&&O.quaternion.fromArray(h.quaternion),h.scale!==void 0&&O.scale.fromArray(h.scale)),h.castShadow!==void 0&&(O.castShadow=h.castShadow),h.receiveShadow!==void 0&&(O.receiveShadow=h.receiveShadow),h.shadow&&(h.shadow.bias!==void 0&&(O.shadow.bias=h.shadow.bias),h.shadow.normalBias!==void 0&&(O.shadow.normalBias=h.shadow.normalBias),h.shadow.radius!==void 0&&(O.shadow.radius=h.shadow.radius),h.shadow.mapSize!==void 0&&O.shadow.mapSize.fromArray(h.shadow.mapSize),h.shadow.camera!==void 0&&(O.shadow.camera=this.parseObject(h.shadow.camera))),h.visible!==void 0&&(O.visible=h.visible),h.frustumCulled!==void 0&&(O.frustumCulled=h.frustumCulled),h.renderOrder!==void 0&&(O.renderOrder=h.renderOrder),h.userData!==void 0&&(O.userData=h.userData),h.layers!==void 0&&(O.layers.mask=h.layers),h.children!==void 0)for(var le=h.children,me=0;me<le.length;me++)O.add(this.parseObject(le[me],x,_,R));if(h.animations!==void 0)for(var ue=h.animations,re=0;re<ue.length;re++){var Oe=ue[re];O.animations.push(R[Oe])}if(h.type==="LOD"){h.autoUpdate!==void 0&&(O.autoUpdate=h.autoUpdate);for(var He=h.levels,Re=0;Re<He.length;Re++){var we=He[Re],Ue=O.getObjectByProperty("uuid",we.object);Ue!==void 0&&O.addLevel(Ue,we.distance)}}return O},d.bindSkeletons=function(h,x){Object.keys(x).length!==0&&h.traverse(function(_){if(_.isSkinnedMesh===!0&&_.skeleton!==void 0){var R=x[_.skeleton];R===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",_.skeleton):_.bind(R,_.bindMatrix)}})},d.setTexturePath=function(h){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(h)},l}(Jr),ak={UVMapping:Ee,CubeReflectionMapping:xe,CubeRefractionMapping:Je,EquirectangularReflectionMapping:Xe,EquirectangularRefractionMapping:Mt,CubeUVReflectionMapping:qe,CubeUVRefractionMapping:It},uE={RepeatWrapping:rn,ClampToEdgeWrapping:Yt,MirroredRepeatWrapping:Tn},hE={NearestFilter:Jt,NearestMipmapNearestFilter:Fn,NearestMipmapLinearFilter:fr,LinearFilter:Ft,LinearMipmapNearestFilter:$t,LinearMipmapLinearFilter:In};function Ay(p){typeof createImageBitmap=="undefined"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch=="undefined"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Jr.call(this,p),this.options={premultiplyAlpha:"none"}}Ay.prototype=Object.assign(Object.create(Jr.prototype),{constructor:Ay,isImageBitmapLoader:!0,setOptions:function(l){return this.options=l,this},load:function(l,d,c,h){l===void 0&&(l=""),this.path!==void 0&&(l=this.path+l),l=this.manager.resolveURL(l);var x=this,_=Ac.get(l);if(_!==void 0)return x.manager.itemStart(l),setTimeout(function(){d&&d(_),x.manager.itemEnd(l)},0),_;var R={};R.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",fetch(l,R).then(function(O){return O.blob()}).then(function(O){return createImageBitmap(O,x.options)}).then(function(O){Ac.add(l,O),d&&d(O),x.manager.itemEnd(l)}).catch(function(O){h&&h(O),x.manager.itemError(l),x.manager.itemEnd(l)}),x.manager.itemStart(l)}});function Ey(){this.type="ShapePath",this.color=new vn,this.subPaths=[],this.currentPath=null}Object.assign(Ey.prototype,{moveTo:function(l,d){return this.currentPath=new Co,this.subPaths.push(this.currentPath),this.currentPath.moveTo(l,d),this},lineTo:function(l,d){return this.currentPath.lineTo(l,d),this},quadraticCurveTo:function(l,d,c,h){return this.currentPath.quadraticCurveTo(l,d,c,h),this},bezierCurveTo:function(l,d,c,h,x,_){return this.currentPath.bezierCurveTo(l,d,c,h,x,_),this},splineThru:function(l){return this.currentPath.splineThru(l),this},toShapes:function(l,d){function c(gt){for(var St=[],Tt=0,qt=gt.length;Tt<qt;Tt++){var en=gt[Tt],_n=new yl;_n.curves=en.curves,St.push(_n)}return St}function h(gt,St){for(var Tt=St.length,qt=!1,en=Tt-1,_n=0;_n<Tt;en=_n++){var Lt=St[en],Wn=St[_n],gn=Wn.x-Lt.x,qn=Wn.y-Lt.y;if(Math.abs(qn)>Number.EPSILON){if(qn<0&&(Lt=St[_n],gn=-gn,Wn=St[en],qn=-qn),gt.y<Lt.y||gt.y>Wn.y)continue;if(gt.y===Lt.y){if(gt.x===Lt.x)return!0}else{var ar=qn*(gt.x-Lt.x)-gn*(gt.y-Lt.y);if(ar===0)return!0;if(ar<0)continue;qt=!qt}}else{if(gt.y!==Lt.y)continue;if(Wn.x<=gt.x&&gt.x<=Lt.x||Lt.x<=gt.x&&gt.x<=Wn.x)return!0}}return qt}var x=_s.isClockWise,_=this.subPaths;if(_.length===0)return[];if(d===!0)return c(_);var R,O,B,V=[];if(_.length===1)return O=_[0],B=new yl,B.curves=O.curves,V.push(B),V;var G=!x(_[0].getPoints());G=l?!G:G;var z=[],ne=[],Q=[],le=0,me;ne[le]=void 0,Q[le]=[];for(var ue=0,re=_.length;ue<re;ue++)O=_[ue],me=O.getPoints(),R=x(me),R=l?!R:R,R?(!G&&ne[le]&&le++,ne[le]={s:new yl,p:me},ne[le].s.curves=O.curves,G&&le++,Q[le]=[]):Q[le].push({h:O,p:me[0]});if(!ne[0])return c(_);if(ne.length>1){for(var Oe=!1,He=[],Re=0,we=ne.length;Re<we;Re++)z[Re]=[];for(var Ue=0,rt=ne.length;Ue<rt;Ue++)for(var nt=Q[Ue],ot=0;ot<nt.length;ot++){for(var ut=nt[ot],st=!0,et=0;et<ne.length;et++)h(ut.p,ne[et].p)&&(Ue!==et&&He.push({froms:Ue,tos:et,hole:ot}),st?(st=!1,z[et].push(ut)):Oe=!0);st&&z[Ue].push(ut)}He.length>0&&(Oe||(Q=z))}for(var dt,at=0,it=ne.length;at<it;at++){B=ne[at].s,V.push(B),dt=Q[at];for(var Ke=0,vt=dt.length;Ke<vt;Ke++)B.holes.push(dt[Ke].h)}return V}});var fE=function(){function p(d){Object.defineProperty(this,"isFont",{value:!0}),this.type="Font",this.data=d}var l=p.prototype;return l.generateShapes=function(c,h){h===void 0&&(h=100);for(var x=[],_=ok(c,h,this.data),R=0,O=_.length;R<O;R++)Array.prototype.push.apply(x,_[R].toShapes());return x},p}();function ok(p,l,d){for(var c=Array.from?Array.from(p):String(p).split(""),h=l/d.resolution,x=(d.boundingBox.yMax-d.boundingBox.yMin+d.underlineThickness)*h,_=[],R=0,O=0,B=0;B<c.length;B++){var V=c[B];if(V===`
`)R=0,O-=x;else{var G=sk(V,h,R,O,d);R+=G.offsetX,_.push(G.path)}}return _}function sk(p,l,d,c,h){var x=h.glyphs[p]||h.glyphs["?"];if(!x){console.error('THREE.Font: character "'+p+'" does not exists in font family '+h.familyName+".");return}var _=new Ey,R,O,B,V,G,z,ne,Q;if(x.o)for(var le=x._cachedOutline||(x._cachedOutline=x.o.split(" ")),me=0,ue=le.length;me<ue;){var re=le[me++];switch(re){case"m":R=le[me++]*l+d,O=le[me++]*l+c,_.moveTo(R,O);break;case"l":R=le[me++]*l+d,O=le[me++]*l+c,_.lineTo(R,O);break;case"q":B=le[me++]*l+d,V=le[me++]*l+c,G=le[me++]*l+d,z=le[me++]*l+c,_.quadraticCurveTo(G,z,B,V);break;case"b":B=le[me++]*l+d,V=le[me++]*l+c,G=le[me++]*l+d,z=le[me++]*l+c,ne=le[me++]*l+d,Q=le[me++]*l+c,_.bezierCurveTo(G,z,ne,Q,B,V);break}}return{offsetX:x.ha*l,path:_}}function _y(p){Jr.call(this,p)}_y.prototype=Object.assign(Object.create(Jr.prototype),{constructor:_y,load:function(l,d,c,h){var x=this,_=new oo(this.manager);_.setPath(this.path),_.setRequestHeader(this.requestHeader),_.setWithCredentials(x.withCredentials),_.load(l,function(R){var O;try{O=JSON.parse(R)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),O=JSON.parse(R.substring(65,R.length-2))}var B=x.parse(O);d&&d(B)},c,h)},parse:function(l){return new fE(l)}});var Hm,My={getContext:function(){return Hm===void 0&&(Hm=new(window.AudioContext||window.webkitAudioContext)),Hm},setContext:function(l){Hm=l}};function zm(p){Jr.call(this,p)}zm.prototype=Object.assign(Object.create(Jr.prototype),{constructor:zm,load:function(l,d,c,h){var x=this,_=new oo(x.manager);_.setResponseType("arraybuffer"),_.setPath(x.path),_.setRequestHeader(x.requestHeader),_.setWithCredentials(x.withCredentials),_.load(l,function(R){try{var O=R.slice(0),B=My.getContext();B.decodeAudioData(O,function(V){d(V)})}catch(V){h?h(V):console.error(V),x.manager.itemError(l)}},c,h)}});function Sy(p,l,d){so.call(this,void 0,d);var c=new vn().set(p),h=new vn().set(l),x=new Ge(c.r,c.g,c.b),_=new Ge(h.r,h.g,h.b),R=Math.sqrt(Math.PI),O=R*Math.sqrt(.75);this.sh.coefficients[0].copy(x).add(_).multiplyScalar(R),this.sh.coefficients[1].copy(x).sub(_).multiplyScalar(O)}Sy.prototype=Object.assign(Object.create(so.prototype),{constructor:Sy,isHemisphereLightProbe:!0,copy:function(l){return so.prototype.copy.call(this,l),this},toJSON:function(l){var d=so.prototype.toJSON.call(this,l);return d}});function Ty(p,l){so.call(this,void 0,l);var d=new vn().set(p);this.sh.coefficients[0].set(d.r,d.g,d.b).multiplyScalar(2*Math.sqrt(Math.PI))}Ty.prototype=Object.assign(Object.create(so.prototype),{constructor:Ty,isAmbientLightProbe:!0,copy:function(l){return so.prototype.copy.call(this,l),this},toJSON:function(l){var d=so.prototype.toJSON.call(this,l);return d}});var dE=new br,pE=new br;function mE(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Mi,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Mi,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}Object.assign(mE.prototype,{update:function(l){var d=this._cache,c=d.focus!==l.focus||d.fov!==l.fov||d.aspect!==l.aspect*this.aspect||d.near!==l.near||d.far!==l.far||d.zoom!==l.zoom||d.eyeSep!==this.eyeSep;if(c){d.focus=l.focus,d.fov=l.fov,d.aspect=l.aspect*this.aspect,d.near=l.near,d.far=l.far,d.zoom=l.zoom,d.eyeSep=this.eyeSep;var h=l.projectionMatrix.clone(),x=d.eyeSep/2,_=x*d.near/d.focus,R=d.near*Math.tan(er.DEG2RAD*d.fov*.5)/d.zoom,O,B;pE.elements[12]=-x,dE.elements[12]=x,O=-R*d.aspect+_,B=R*d.aspect+_,h.elements[0]=2*d.near/(B-O),h.elements[8]=(B+O)/(B-O),this.cameraL.projectionMatrix.copy(h),O=-R*d.aspect-_,B=R*d.aspect-_,h.elements[0]=2*d.near/(B-O),h.elements[8]=(B+O)/(B-O),this.cameraR.projectionMatrix.copy(h)}this.cameraL.matrixWorld.copy(l.matrixWorld).multiply(pE),this.cameraR.matrixWorld.copy(l.matrixWorld).multiply(dE)}});var vE=function(){function p(d){this.autoStart=d!==void 0?d:!0,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}var l=p.prototype;return l.start=function(){this.startTime=gE(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},l.stop=function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},l.getElapsedTime=function(){return this.getDelta(),this.elapsedTime},l.getDelta=function(){var c=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var h=gE();c=(h-this.oldTime)/1e3,this.oldTime=h,this.elapsedTime+=c}return c},p}();function gE(){return(typeof performance=="undefined"?Date:performance).now()}var Ec=new Ge,yE=new Zi,lk=new Ge,_c=new Ge,ck=function(p){pr(l,p);function l(){var c;return c=p.call(this)||this,c.type="AudioListener",c.context=My.getContext(),c.gain=c.context.createGain(),c.gain.connect(c.context.destination),c.filter=null,c.timeDelta=0,c._clock=new vE,c}var d=l.prototype;return d.getInput=function(){return this.gain},d.removeFilter=function(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},d.getFilter=function(){return this.filter},d.setFilter=function(h){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=h,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},d.getMasterVolume=function(){return this.gain.gain.value},d.setMasterVolume=function(h){return this.gain.gain.setTargetAtTime(h,this.context.currentTime,.01),this},d.updateMatrixWorld=function(h){p.prototype.updateMatrixWorld.call(this,h);var x=this.context.listener,_=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Ec,yE,lk),_c.set(0,0,-1).applyQuaternion(yE),x.positionX){var R=this.context.currentTime+this.timeDelta;x.positionX.linearRampToValueAtTime(Ec.x,R),x.positionY.linearRampToValueAtTime(Ec.y,R),x.positionZ.linearRampToValueAtTime(Ec.z,R),x.forwardX.linearRampToValueAtTime(_c.x,R),x.forwardY.linearRampToValueAtTime(_c.y,R),x.forwardZ.linearRampToValueAtTime(_c.z,R),x.upX.linearRampToValueAtTime(_.x,R),x.upY.linearRampToValueAtTime(_.y,R),x.upZ.linearRampToValueAtTime(_.z,R)}else x.setPosition(Ec.x,Ec.y,Ec.z),x.setOrientation(_c.x,_c.y,_c.z,_.x,_.y,_.z)},l}(Dn),Cy=function(p){pr(l,p);function l(c){var h;return h=p.call(this)||this,h.type="Audio",h.listener=c,h.context=c.context,h.gain=h.context.createGain(),h.gain.connect(c.getInput()),h.autoplay=!1,h.buffer=null,h.detune=0,h.loop=!1,h.loopStart=0,h.loopEnd=0,h.offset=0,h.duration=void 0,h.playbackRate=1,h.isPlaying=!1,h.hasPlaybackControl=!0,h.source=null,h.sourceType="empty",h._startedAt=0,h._progress=0,h._connected=!1,h.filters=[],h}var d=l.prototype;return d.getOutput=function(){return this.gain},d.setNodeSource=function(h){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=h,this.connect(),this},d.setMediaElementSource=function(h){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(h),this.connect(),this},d.setMediaStreamSource=function(h){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(h),this.connect(),this},d.setBuffer=function(h){return this.buffer=h,this.sourceType="buffer",this.autoplay&&this.play(),this},d.play=function(h){if(h===void 0&&(h=0),this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+h;var x=this.context.createBufferSource();return x.buffer=this.buffer,x.loop=this.loop,x.loopStart=this.loopStart,x.loopEnd=this.loopEnd,x.onended=this.onEnded.bind(this),x.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=x,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()},d.pause=function(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this},d.stop=function(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this},d.connect=function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var h=1,x=this.filters.length;h<x;h++)this.filters[h-1].connect(this.filters[h]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this},d.disconnect=function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var h=1,x=this.filters.length;h<x;h++)this.filters[h-1].disconnect(this.filters[h]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this},d.getFilters=function(){return this.filters},d.setFilters=function(h){return h||(h=[]),this._connected===!0?(this.disconnect(),this.filters=h.slice(),this.connect()):this.filters=h.slice(),this},d.setDetune=function(h){if(this.detune=h,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},d.getDetune=function(){return this.detune},d.getFilter=function(){return this.getFilters()[0]},d.setFilter=function(h){return this.setFilters(h?[h]:[])},d.setPlaybackRate=function(h){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=h,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this},d.getPlaybackRate=function(){return this.playbackRate},d.onEnded=function(){this.isPlaying=!1},d.getLoop=function(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},d.setLoop=function(h){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=h,this.isPlaying===!0&&(this.source.loop=this.loop),this},d.setLoopStart=function(h){return this.loopStart=h,this},d.setLoopEnd=function(h){return this.loopEnd=h,this},d.getVolume=function(){return this.gain.gain.value},d.setVolume=function(h){return this.gain.gain.setTargetAtTime(h,this.context.currentTime,.01),this},l}(Dn),Mc=new Ge,bE=new Zi,uk=new Ge,Sc=new Ge,hk=function(p){pr(l,p);function l(c){var h;return h=p.call(this,c)||this,h.panner=h.context.createPanner(),h.panner.panningModel="HRTF",h.panner.connect(h.gain),h}var d=l.prototype;return d.getOutput=function(){return this.panner},d.getRefDistance=function(){return this.panner.refDistance},d.setRefDistance=function(h){return this.panner.refDistance=h,this},d.getRolloffFactor=function(){return this.panner.rolloffFactor},d.setRolloffFactor=function(h){return this.panner.rolloffFactor=h,this},d.getDistanceModel=function(){return this.panner.distanceModel},d.setDistanceModel=function(h){return this.panner.distanceModel=h,this},d.getMaxDistance=function(){return this.panner.maxDistance},d.setMaxDistance=function(h){return this.panner.maxDistance=h,this},d.setDirectionalCone=function(h,x,_){return this.panner.coneInnerAngle=h,this.panner.coneOuterAngle=x,this.panner.coneOuterGain=_,this},d.updateMatrixWorld=function(h){if(p.prototype.updateMatrixWorld.call(this,h),!(this.hasPlaybackControl===!0&&this.isPlaying===!1)){this.matrixWorld.decompose(Mc,bE,uk),Sc.set(0,0,1).applyQuaternion(bE);var x=this.panner;if(x.positionX){var _=this.context.currentTime+this.listener.timeDelta;x.positionX.linearRampToValueAtTime(Mc.x,_),x.positionY.linearRampToValueAtTime(Mc.y,_),x.positionZ.linearRampToValueAtTime(Mc.z,_),x.orientationX.linearRampToValueAtTime(Sc.x,_),x.orientationY.linearRampToValueAtTime(Sc.y,_),x.orientationZ.linearRampToValueAtTime(Sc.z,_)}else x.setPosition(Mc.x,Mc.y,Mc.z),x.setOrientation(Sc.x,Sc.y,Sc.z)}},l}(Cy),xE=function(){function p(d,c){c===void 0&&(c=2048),this.analyser=d.context.createAnalyser(),this.analyser.fftSize=c,this.data=new Uint8Array(this.analyser.frequencyBinCount),d.getOutput().connect(this.analyser)}var l=p.prototype;return l.getFrequencyData=function(){return this.analyser.getByteFrequencyData(this.data),this.data},l.getAverageFrequency=function(){for(var c=0,h=this.getFrequencyData(),x=0;x<h.length;x++)c+=h[x];return c/h.length},p}();function Ry(p,l,d){this.binding=p,this.valueSize=d;var c,h,x;switch(l){case"quaternion":c=this._slerp,h=this._slerpAdditive,x=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(d*6),this._workIndex=5;break;case"string":case"bool":c=this._select,h=this._select,x=this._setAdditiveIdentityOther,this.buffer=new Array(d*5);break;default:c=this._lerp,h=this._lerpAdditive,x=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(d*5)}this._mixBufferRegion=c,this._mixBufferRegionAdditive=h,this._setIdentity=x,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}Object.assign(Ry.prototype,{accumulate:function(l,d){var c=this.buffer,h=this.valueSize,x=l*h+h,_=this.cumulativeWeight;if(_===0){for(var R=0;R!==h;++R)c[x+R]=c[R];_=d}else{_+=d;var O=d/_;this._mixBufferRegion(c,x,0,O,h)}this.cumulativeWeight=_},accumulateAdditive:function(l){var d=this.buffer,c=this.valueSize,h=c*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(d,h,0,l,c),this.cumulativeWeightAdditive+=l},apply:function(l){var d=this.valueSize,c=this.buffer,h=l*d+d,x=this.cumulativeWeight,_=this.cumulativeWeightAdditive,R=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,x<1){var O=d*this._origIndex;this._mixBufferRegion(c,h,O,1-x,d)}_>0&&this._mixBufferRegionAdditive(c,h,this._addIndex*d,1,d);for(var B=d,V=d+d;B!==V;++B)if(c[B]!==c[B+d]){R.setValue(c,h);break}},saveOriginalState:function(){var l=this.binding,d=this.buffer,c=this.valueSize,h=c*this._origIndex;l.getValue(d,h);for(var x=c,_=h;x!==_;++x)d[x]=d[h+x%c];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){var l=this.valueSize*3;this.binding.setValue(this.buffer,l)},_setAdditiveIdentityNumeric:function(){for(var l=this._addIndex*this.valueSize,d=l+this.valueSize,c=l;c<d;c++)this.buffer[c]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1},_setAdditiveIdentityOther:function(){for(var l=this._origIndex*this.valueSize,d=this._addIndex*this.valueSize,c=0;c<this.valueSize;c++)this.buffer[d+c]=this.buffer[l+c]},_select:function(l,d,c,h,x){if(h>=.5)for(var _=0;_!==x;++_)l[d+_]=l[c+_]},_slerp:function(l,d,c,h){Zi.slerpFlat(l,d,l,d,l,c,h)},_slerpAdditive:function(l,d,c,h,x){var _=this._workIndex*x;Zi.multiplyQuaternionsFlat(l,_,l,d,l,c),Zi.slerpFlat(l,d,l,d,l,_,h)},_lerp:function(l,d,c,h,x){for(var _=1-h,R=0;R!==x;++R){var O=d+R;l[O]=l[O]*_+l[c+R]*h}},_lerpAdditive:function(l,d,c,h,x){for(var _=0;_!==x;++_){var R=d+_;l[R]=l[R]+l[c+_]*h}}});var Ly="\\[\\]\\.:\\/",fk=new RegExp("["+Ly+"]","g"),Py="[^"+Ly+"]",dk="[^"+Ly.replace("\\.","")+"]",pk=/((?:WC+[\/:])*)/.source.replace("WC",Py),mk=/(WCOD+)?/.source.replace("WCOD",dk),vk=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Py),gk=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Py),yk=new RegExp("^"+pk+mk+vk+gk+"$"),bk=["material","materials","bones"];function wE(p,l,d){var c=d||oa.parseTrackName(l);this._targetGroup=p,this._bindings=p.subscribe_(l,c)}Object.assign(wE.prototype,{getValue:function(l,d){this.bind();var c=this._targetGroup.nCachedObjects_,h=this._bindings[c];h!==void 0&&h.getValue(l,d)},setValue:function(l,d){for(var c=this._bindings,h=this._targetGroup.nCachedObjects_,x=c.length;h!==x;++h)c[h].setValue(l,d)},bind:function(){for(var l=this._bindings,d=this._targetGroup.nCachedObjects_,c=l.length;d!==c;++d)l[d].bind()},unbind:function(){for(var l=this._bindings,d=this._targetGroup.nCachedObjects_,c=l.length;d!==c;++d)l[d].unbind()}});function oa(p,l,d){this.path=l,this.parsedPath=d||oa.parseTrackName(l),this.node=oa.findNode(p,this.parsedPath.nodeName)||p,this.rootNode=p}Object.assign(oa,{Composite:wE,create:function(l,d,c){return l&&l.isAnimationObjectGroup?new oa.Composite(l,d,c):new oa(l,d,c)},sanitizeNodeName:function(l){return l.replace(/\s/g,"_").replace(fk,"")},parseTrackName:function(l){var d=yk.exec(l);if(!d)throw new Error("PropertyBinding: Cannot parse trackName: "+l);var c={nodeName:d[2],objectName:d[3],objectIndex:d[4],propertyName:d[5],propertyIndex:d[6]},h=c.nodeName&&c.nodeName.lastIndexOf(".");if(h!==void 0&&h!==-1){var x=c.nodeName.substring(h+1);bk.indexOf(x)!==-1&&(c.nodeName=c.nodeName.substring(0,h),c.objectName=x)}if(c.propertyName===null||c.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+l);return c},findNode:function(l,d){if(!d||d===""||d==="."||d===-1||d===l.name||d===l.uuid)return l;if(l.skeleton){var c=l.skeleton.getBoneByName(d);if(c!==void 0)return c}if(l.children){var h=function _(R){for(var O=0;O<R.length;O++){var B=R[O];if(B.name===d||B.uuid===d)return B;var V=_(B.children);if(V)return V}return null},x=h(l.children);if(x)return x}return null}}),Object.assign(oa.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(l,d){l[d]=this.node[this.propertyName]},function(l,d){for(var c=this.resolvedProperty,h=0,x=c.length;h!==x;++h)l[d++]=c[h]},function(l,d){l[d]=this.resolvedProperty[this.propertyIndex]},function(l,d){this.resolvedProperty.toArray(l,d)}],SetterByBindingTypeAndVersioning:[[function(l,d){this.targetObject[this.propertyName]=l[d]},function(l,d){this.targetObject[this.propertyName]=l[d],this.targetObject.needsUpdate=!0},function(l,d){this.targetObject[this.propertyName]=l[d],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(l,d){for(var c=this.resolvedProperty,h=0,x=c.length;h!==x;++h)c[h]=l[d++]},function(l,d){for(var c=this.resolvedProperty,h=0,x=c.length;h!==x;++h)c[h]=l[d++];this.targetObject.needsUpdate=!0},function(l,d){for(var c=this.resolvedProperty,h=0,x=c.length;h!==x;++h)c[h]=l[d++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(l,d){this.resolvedProperty[this.propertyIndex]=l[d]},function(l,d){this.resolvedProperty[this.propertyIndex]=l[d],this.targetObject.needsUpdate=!0},function(l,d){this.resolvedProperty[this.propertyIndex]=l[d],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(l,d){this.resolvedProperty.fromArray(l,d)},function(l,d){this.resolvedProperty.fromArray(l,d),this.targetObject.needsUpdate=!0},function(l,d){this.resolvedProperty.fromArray(l,d),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(l,d){this.bind(),this.getValue(l,d)},setValue:function(l,d){this.bind(),this.setValue(l,d)},bind:function(){var l=this.node,d=this.parsedPath,c=d.objectName,h=d.propertyName,x=d.propertyIndex;if(l||(l=oa.findNode(this.rootNode,d.nodeName)||this.rootNode,this.node=l),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!l){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(c){var _=d.objectIndex;switch(c){case"materials":if(!l.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!l.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}l=l.material.materials;break;case"bones":if(!l.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}l=l.skeleton.bones;for(var R=0;R<l.length;R++)if(l[R].name===_){_=R;break}break;default:if(l[c]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}l=l[c]}if(_!==void 0){if(l[_]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,l);return}l=l[_]}}var O=l[h];if(O===void 0){var B=d.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+B+"."+h+" but it wasn't found.",l);return}var V=this.Versioning.None;this.targetObject=l,l.needsUpdate!==void 0?V=this.Versioning.NeedsUpdate:l.matrixWorldNeedsUpdate!==void 0&&(V=this.Versioning.MatrixWorldNeedsUpdate);var G=this.BindingType.Direct;if(x!==void 0){if(h==="morphTargetInfluences"){if(!l.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(l.geometry.isBufferGeometry){if(!l.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}l.morphTargetDictionary[x]!==void 0&&(x=l.morphTargetDictionary[x])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}G=this.BindingType.ArrayElement,this.resolvedProperty=O,this.propertyIndex=x}else O.fromArray!==void 0&&O.toArray!==void 0?(G=this.BindingType.HasFromToArray,this.resolvedProperty=O):Array.isArray(O)?(G=this.BindingType.EntireArray,this.resolvedProperty=O):this.propertyName=h;this.getValue=this.GetterByBindingType[G],this.setValue=this.SetterByBindingTypeAndVersioning[G][V]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(oa.prototype,{_getValue_unbound:oa.prototype.getValue,_setValue_unbound:oa.prototype.setValue});function AE(){this.uuid=er.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var p={};this._indicesByUUID=p;for(var l=0,d=arguments.length;l!==d;++l)p[arguments[l].uuid]=l;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var c=this;this.stats={objects:{get total(){return c._objects.length},get inUse(){return this.total-c.nCachedObjects_}},get bindingsPerObject(){return c._bindings.length}}}Object.assign(AE.prototype,{isAnimationObjectGroup:!0,add:function(){for(var l=this._objects,d=this._indicesByUUID,c=this._paths,h=this._parsedPaths,x=this._bindings,_=x.length,R=void 0,O=l.length,B=this.nCachedObjects_,V=0,G=arguments.length;V!==G;++V){var z=arguments[V],ne=z.uuid,Q=d[ne];if(Q===void 0){Q=O++,d[ne]=Q,l.push(z);for(var le=0,me=_;le!==me;++le)x[le].push(new oa(z,c[le],h[le]))}else if(Q<B){R=l[Q];var ue=--B,re=l[ue];d[re.uuid]=Q,l[Q]=re,d[ne]=ue,l[ue]=z;for(var Oe=0,He=_;Oe!==He;++Oe){var Re=x[Oe],we=Re[ue],Ue=Re[Q];Re[Q]=we,Ue===void 0&&(Ue=new oa(z,c[Oe],h[Oe])),Re[ue]=Ue}}else l[Q]!==R&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=B},remove:function(){for(var l=this._objects,d=this._indicesByUUID,c=this._bindings,h=c.length,x=this.nCachedObjects_,_=0,R=arguments.length;_!==R;++_){var O=arguments[_],B=O.uuid,V=d[B];if(V!==void 0&&V>=x){var G=x++,z=l[G];d[z.uuid]=V,l[V]=z,d[B]=G,l[G]=O;for(var ne=0,Q=h;ne!==Q;++ne){var le=c[ne],me=le[G],ue=le[V];le[V]=me,le[G]=ue}}}this.nCachedObjects_=x},uncache:function(){for(var l=this._objects,d=this._indicesByUUID,c=this._bindings,h=c.length,x=this.nCachedObjects_,_=l.length,R=0,O=arguments.length;R!==O;++R){var B=arguments[R],V=B.uuid,G=d[V];if(G!==void 0)if(delete d[V],G<x){var z=--x,ne=l[z],Q=--_,le=l[Q];d[ne.uuid]=G,l[G]=ne,d[le.uuid]=z,l[z]=le,l.pop();for(var me=0,ue=h;me!==ue;++me){var re=c[me],Oe=re[z],He=re[Q];re[G]=Oe,re[z]=He,re.pop()}}else{var Re=--_,we=l[Re];Re>0&&(d[we.uuid]=G),l[G]=we,l.pop();for(var Ue=0,rt=h;Ue!==rt;++Ue){var nt=c[Ue];nt[G]=nt[Re],nt.pop()}}}this.nCachedObjects_=x},subscribe_:function(l,d){var c=this._bindingsIndicesByPath,h=c[l],x=this._bindings;if(h!==void 0)return x[h];var _=this._paths,R=this._parsedPaths,O=this._objects,B=O.length,V=this.nCachedObjects_,G=new Array(B);h=x.length,c[l]=h,_.push(l),R.push(d),x.push(G);for(var z=V,ne=O.length;z!==ne;++z){var Q=O[z];G[z]=new oa(Q,l,d)}return G},unsubscribe_:function(l){var d=this._bindingsIndicesByPath,c=d[l];if(c!==void 0){var h=this._paths,x=this._parsedPaths,_=this._bindings,R=_.length-1,O=_[R],B=l[R];d[B]=c,_[c]=O,_.pop(),x[c]=x[R],x.pop(),h[c]=h[R],h.pop()}}});var xk=function(){function p(d,c,h,x){h===void 0&&(h=null),x===void 0&&(x=c.blendMode),this._mixer=d,this._clip=c,this._localRoot=h,this.blendMode=x;for(var _=c.tracks,R=_.length,O=new Array(R),B={endingStart:ri,endingEnd:ri},V=0;V!==R;++V){var G=_[V].createInterpolant(null);O[V]=G,G.settings=B}this._interpolantSettings=B,this._interpolants=O,this._propertyBindings=new Array(R),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=nr,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}var l=p.prototype;return l.play=function(){return this._mixer._activateAction(this),this},l.stop=function(){return this._mixer._deactivateAction(this),this.reset()},l.reset=function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},l.isRunning=function(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)},l.isScheduled=function(){return this._mixer._isActiveAction(this)},l.startAt=function(c){return this._startTime=c,this},l.setLoop=function(c,h){return this.loop=c,this.repetitions=h,this},l.setEffectiveWeight=function(c){return this.weight=c,this._effectiveWeight=this.enabled?c:0,this.stopFading()},l.getEffectiveWeight=function(){return this._effectiveWeight},l.fadeIn=function(c){return this._scheduleFading(c,0,1)},l.fadeOut=function(c){return this._scheduleFading(c,1,0)},l.crossFadeFrom=function(c,h,x){if(c.fadeOut(h),this.fadeIn(h),x){var _=this._clip.duration,R=c._clip.duration,O=R/_,B=_/R;c.warp(1,O,h),this.warp(B,1,h)}return this},l.crossFadeTo=function(c,h,x){return c.crossFadeFrom(this,h,x)},l.stopFading=function(){var c=this._weightInterpolant;return c!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(c)),this},l.setEffectiveTimeScale=function(c){return this.timeScale=c,this._effectiveTimeScale=this.paused?0:c,this.stopWarping()},l.getEffectiveTimeScale=function(){return this._effectiveTimeScale},l.setDuration=function(c){return this.timeScale=this._clip.duration/c,this.stopWarping()},l.syncWith=function(c){return this.time=c.time,this.timeScale=c.timeScale,this.stopWarping()},l.halt=function(c){return this.warp(this._effectiveTimeScale,0,c)},l.warp=function(c,h,x){var _=this._mixer,R=_.time,O=this.timeScale,B=this._timeScaleInterpolant;B===null&&(B=_._lendControlInterpolant(),this._timeScaleInterpolant=B);var V=B.parameterPositions,G=B.sampleValues;return V[0]=R,V[1]=R+x,G[0]=c/O,G[1]=h/O,this},l.stopWarping=function(){var c=this._timeScaleInterpolant;return c!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(c)),this},l.getMixer=function(){return this._mixer},l.getClip=function(){return this._clip},l.getRoot=function(){return this._localRoot||this._mixer._root},l._update=function(c,h,x,_){if(!this.enabled){this._updateWeight(c);return}var R=this._startTime;if(R!==null){var O=(c-R)*x;if(O<0||x===0)return;this._startTime=null,h=x*O}h*=this._updateTimeScale(c);var B=this._updateTime(h),V=this._updateWeight(c);if(V>0){var G=this._interpolants,z=this._propertyBindings;switch(this.blendMode){case vo:for(var ne=0,Q=G.length;ne!==Q;++ne)G[ne].evaluate(B),z[ne].accumulateAdditive(V);break;case ba:default:for(var le=0,me=G.length;le!==me;++le)G[le].evaluate(B),z[le].accumulate(_,V)}}},l._updateWeight=function(c){var h=0;if(this.enabled){h=this.weight;var x=this._weightInterpolant;if(x!==null){var _=x.evaluate(c)[0];h*=_,c>x.parameterPositions[1]&&(this.stopFading(),_===0&&(this.enabled=!1))}}return this._effectiveWeight=h,h},l._updateTimeScale=function(c){var h=0;if(!this.paused){h=this.timeScale;var x=this._timeScaleInterpolant;if(x!==null){var _=x.evaluate(c)[0];h*=_,c>x.parameterPositions[1]&&(this.stopWarping(),h===0?this.paused=!0:this.timeScale=h)}}return this._effectiveTimeScale=h,h},l._updateTime=function(c){var h=this._clip.duration,x=this.loop,_=this.time+c,R=this._loopCount,O=x===Tr;if(c===0)return R===-1?_:O&&(R&1)==1?h-_:_;if(x===Hn){R===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(_>=h)_=h;else if(_<0)_=0;else{this.time=_;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=_,this._mixer.dispatchEvent({type:"finished",action:this,direction:c<0?-1:1})}}else{if(R===-1&&(c>=0?(R=0,this._setEndings(!0,this.repetitions===0,O)):this._setEndings(this.repetitions===0,!0,O)),_>=h||_<0){var B=Math.floor(_/h);_-=h*B,R+=Math.abs(B);var V=this.repetitions-R;if(V<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,_=c>0?h:0,this.time=_,this._mixer.dispatchEvent({type:"finished",action:this,direction:c>0?1:-1});else{if(V===1){var G=c<0;this._setEndings(G,!G,O)}else this._setEndings(!1,!1,O);this._loopCount=R,this.time=_,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:B})}}else this.time=_;if(O&&(R&1)==1)return h-_}return _},l._setEndings=function(c,h,x){var _=this._interpolantSettings;x?(_.endingStart=Nn,_.endingEnd=Nn):(c?_.endingStart=this.zeroSlopeAtStart?Nn:ri:_.endingStart=ya,h?_.endingEnd=this.zeroSlopeAtEnd?Nn:ri:_.endingEnd=ya)},l._scheduleFading=function(c,h,x){var _=this._mixer,R=_.time,O=this._weightInterpolant;O===null&&(O=_._lendControlInterpolant(),this._weightInterpolant=O);var B=O.parameterPositions,V=O.sampleValues;return B[0]=R,V[0]=h,B[1]=R+c,V[1]=x,this},p}();function Dy(p){this._root=p,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}Dy.prototype=Object.assign(Object.create(Ho.prototype),{constructor:Dy,_bindAction:function(l,d){var c=l._localRoot||this._root,h=l._clip.tracks,x=h.length,_=l._propertyBindings,R=l._interpolants,O=c.uuid,B=this._bindingsByRootAndName,V=B[O];V===void 0&&(V={},B[O]=V);for(var G=0;G!==x;++G){var z=h[G],ne=z.name,Q=V[ne];if(Q!==void 0)_[G]=Q;else{if(Q=_[G],Q!==void 0){Q._cacheIndex===null&&(++Q.referenceCount,this._addInactiveBinding(Q,O,ne));continue}var le=d&&d._propertyBindings[G].binding.parsedPath;Q=new Ry(oa.create(c,ne,le),z.ValueTypeName,z.getValueSize()),++Q.referenceCount,this._addInactiveBinding(Q,O,ne),_[G]=Q}R[G].resultBuffer=Q.buffer}},_activateAction:function(l){if(!this._isActiveAction(l)){if(l._cacheIndex===null){var d=(l._localRoot||this._root).uuid,c=l._clip.uuid,h=this._actionsByClip[c];this._bindAction(l,h&&h.knownActions[0]),this._addInactiveAction(l,c,d)}for(var x=l._propertyBindings,_=0,R=x.length;_!==R;++_){var O=x[_];O.useCount++==0&&(this._lendBinding(O),O.saveOriginalState())}this._lendAction(l)}},_deactivateAction:function(l){if(this._isActiveAction(l)){for(var d=l._propertyBindings,c=0,h=d.length;c!==h;++c){var x=d[c];--x.useCount==0&&(x.restoreOriginalState(),this._takeBackBinding(x))}this._takeBackAction(l)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var l=this;this.stats={actions:{get total(){return l._actions.length},get inUse(){return l._nActiveActions}},bindings:{get total(){return l._bindings.length},get inUse(){return l._nActiveBindings}},controlInterpolants:{get total(){return l._controlInterpolants.length},get inUse(){return l._nActiveControlInterpolants}}}},_isActiveAction:function(l){var d=l._cacheIndex;return d!==null&&d<this._nActiveActions},_addInactiveAction:function(l,d,c){var h=this._actions,x=this._actionsByClip,_=x[d];if(_===void 0)_={knownActions:[l],actionByRoot:{}},l._byClipCacheIndex=0,x[d]=_;else{var R=_.knownActions;l._byClipCacheIndex=R.length,R.push(l)}l._cacheIndex=h.length,h.push(l),_.actionByRoot[c]=l},_removeInactiveAction:function(l){var d=this._actions,c=d[d.length-1],h=l._cacheIndex;c._cacheIndex=h,d[h]=c,d.pop(),l._cacheIndex=null;var x=l._clip.uuid,_=this._actionsByClip,R=_[x],O=R.knownActions,B=O[O.length-1],V=l._byClipCacheIndex;B._byClipCacheIndex=V,O[V]=B,O.pop(),l._byClipCacheIndex=null;var G=R.actionByRoot,z=(l._localRoot||this._root).uuid;delete G[z],O.length===0&&delete _[x],this._removeInactiveBindingsForAction(l)},_removeInactiveBindingsForAction:function(l){for(var d=l._propertyBindings,c=0,h=d.length;c!==h;++c){var x=d[c];--x.referenceCount==0&&this._removeInactiveBinding(x)}},_lendAction:function(l){var d=this._actions,c=l._cacheIndex,h=this._nActiveActions++,x=d[h];l._cacheIndex=h,d[h]=l,x._cacheIndex=c,d[c]=x},_takeBackAction:function(l){var d=this._actions,c=l._cacheIndex,h=--this._nActiveActions,x=d[h];l._cacheIndex=h,d[h]=l,x._cacheIndex=c,d[c]=x},_addInactiveBinding:function(l,d,c){var h=this._bindingsByRootAndName,x=this._bindings,_=h[d];_===void 0&&(_={},h[d]=_),_[c]=l,l._cacheIndex=x.length,x.push(l)},_removeInactiveBinding:function(l){var d=this._bindings,c=l.binding,h=c.rootNode.uuid,x=c.path,_=this._bindingsByRootAndName,R=_[h],O=d[d.length-1],B=l._cacheIndex;O._cacheIndex=B,d[B]=O,d.pop(),delete R[x],Object.keys(R).length===0&&delete _[h]},_lendBinding:function(l){var d=this._bindings,c=l._cacheIndex,h=this._nActiveBindings++,x=d[h];l._cacheIndex=h,d[h]=l,x._cacheIndex=c,d[c]=x},_takeBackBinding:function(l){var d=this._bindings,c=l._cacheIndex,h=--this._nActiveBindings,x=d[h];l._cacheIndex=h,d[h]=l,x._cacheIndex=c,d[c]=x},_lendControlInterpolant:function(){var l=this._controlInterpolants,d=this._nActiveControlInterpolants++,c=l[d];return c===void 0&&(c=new Hf(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),c.__cacheIndex=d,l[d]=c),c},_takeBackControlInterpolant:function(l){var d=this._controlInterpolants,c=l.__cacheIndex,h=--this._nActiveControlInterpolants,x=d[h];l.__cacheIndex=h,d[h]=l,x.__cacheIndex=c,d[c]=x},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(l,d,c){var h=d||this._root,x=h.uuid,_=typeof l=="string"?Xa.findByName(h,l):l,R=_!==null?_.uuid:l,O=this._actionsByClip[R],B=null;if(c===void 0&&(_!==null?c=_.blendMode:c=ba),O!==void 0){var V=O.actionByRoot[x];if(V!==void 0&&V.blendMode===c)return V;B=O.knownActions[0],_===null&&(_=B._clip)}if(_===null)return null;var G=new xk(this,_,d,c);return this._bindAction(G,B),this._addInactiveAction(G,R,x),G},existingAction:function(l,d){var c=d||this._root,h=c.uuid,x=typeof l=="string"?Xa.findByName(c,l):l,_=x?x.uuid:l,R=this._actionsByClip[_];return R!==void 0&&R.actionByRoot[h]||null},stopAllAction:function(){for(var l=this._actions,d=this._nActiveActions,c=d-1;c>=0;--c)l[c].stop();return this},update:function(l){l*=this.timeScale;for(var d=this._actions,c=this._nActiveActions,h=this.time+=l,x=Math.sign(l),_=this._accuIndex^=1,R=0;R!==c;++R){var O=d[R];O._update(h,l,x,_)}for(var B=this._bindings,V=this._nActiveBindings,G=0;G!==V;++G)B[G].apply(_);return this},setTime:function(l){this.time=0;for(var d=0;d<this._actions.length;d++)this._actions[d].time=0;return this.update(l)},getRoot:function(){return this._root},uncacheClip:function(l){var d=this._actions,c=l.uuid,h=this._actionsByClip,x=h[c];if(x!==void 0){for(var _=x.knownActions,R=0,O=_.length;R!==O;++R){var B=_[R];this._deactivateAction(B);var V=B._cacheIndex,G=d[d.length-1];B._cacheIndex=null,B._byClipCacheIndex=null,G._cacheIndex=V,d[V]=G,d.pop(),this._removeInactiveBindingsForAction(B)}delete h[c]}},uncacheRoot:function(l){var d=l.uuid,c=this._actionsByClip;for(var h in c){var x=c[h].actionByRoot,_=x[d];_!==void 0&&(this._deactivateAction(_),this._removeInactiveAction(_))}var R=this._bindingsByRootAndName,O=R[d];if(O!==void 0)for(var B in O){var V=O[B];V.restoreOriginalState(),this._removeInactiveBinding(V)}},uncacheAction:function(l,d){var c=this.existingAction(l,d);c!==null&&(this._deactivateAction(c),this._removeInactiveAction(c))}});var EE=function(){function p(d){typeof d=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),d=arguments[1]),this.value=d}var l=p.prototype;return l.clone=function(){return new p(this.value.clone===void 0?this.value:this.value.clone())},p}();function Oy(p,l,d){Wa.call(this,p,l),this.meshPerAttribute=d||1}Oy.prototype=Object.assign(Object.create(Wa.prototype),{constructor:Oy,isInstancedInterleavedBuffer:!0,copy:function(l){return Wa.prototype.copy.call(this,l),this.meshPerAttribute=l.meshPerAttribute,this},clone:function(l){var d=Wa.prototype.clone.call(this,l);return d.meshPerAttribute=this.meshPerAttribute,d},toJSON:function(l){var d=Wa.prototype.toJSON.call(this,l);return d.isInstancedInterleavedBuffer=!0,d.meshPerAttribute=this.meshPerAttribute,d}});function Iy(p,l,d,c,h){this.buffer=p,this.type=l,this.itemSize=d,this.elementSize=c,this.count=h,this.version=0}Object.defineProperty(Iy.prototype,"needsUpdate",{set:function(l){l===!0&&this.version++}}),Object.assign(Iy.prototype,{isGLBufferAttribute:!0,setBuffer:function(l){return this.buffer=l,this},setType:function(l,d){return this.type=l,this.elementSize=d,this},setItemSize:function(l){return this.itemSize=l,this},setCount:function(l){return this.count=l,this}});function ky(p,l,d,c){this.ray=new su(p,l),this.near=d||0,this.far=c||1/0,this.camera=null,this.layers=new O0,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function _E(p,l){return p.distance-l.distance}function Fy(p,l,d,c){if(p.layers.test(l.layers)&&p.raycast(l,d),c===!0)for(var h=p.children,x=0,_=h.length;x<_;x++)Fy(h[x],l,d,!0)}Object.assign(ky.prototype,{set:function(l,d){this.ray.set(l,d)},setFromCamera:function(l,d){d&&d.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(d.matrixWorld),this.ray.direction.set(l.x,l.y,.5).unproject(d).sub(this.ray.origin).normalize(),this.camera=d):d&&d.isOrthographicCamera?(this.ray.origin.set(l.x,l.y,(d.near+d.far)/(d.near-d.far)).unproject(d),this.ray.direction.set(0,0,-1).transformDirection(d.matrixWorld),this.camera=d):console.error("THREE.Raycaster: Unsupported camera type: "+d.type)},intersectObject:function(l,d,c){var h=c||[];return Fy(l,this,h,d),h.sort(_E),h},intersectObjects:function(l,d,c){var h=c||[];if(Array.isArray(l)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),h;for(var x=0,_=l.length;x<_;x++)Fy(l[x],this,h,d);return h.sort(_E),h}});var wk=function(){function p(d,c,h){return d===void 0&&(d=1),c===void 0&&(c=0),h===void 0&&(h=0),this.radius=d,this.phi=c,this.theta=h,this}var l=p.prototype;return l.set=function(c,h,x){return this.radius=c,this.phi=h,this.theta=x,this},l.clone=function(){return new this.constructor().copy(this)},l.copy=function(c){return this.radius=c.radius,this.phi=c.phi,this.theta=c.theta,this},l.makeSafe=function(){var c=1e-6;return this.phi=Math.max(c,Math.min(Math.PI-c,this.phi)),this},l.setFromVector3=function(c){return this.setFromCartesianCoords(c.x,c.y,c.z)},l.setFromCartesianCoords=function(c,h,x){return this.radius=Math.sqrt(c*c+h*h+x*x),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(c,x),this.phi=Math.acos(er.clamp(h/this.radius,-1,1))),this},p}(),Ak=function(){function p(d,c,h){return this.radius=d!==void 0?d:1,this.theta=c!==void 0?c:0,this.y=h!==void 0?h:0,this}var l=p.prototype;return l.set=function(c,h,x){return this.radius=c,this.theta=h,this.y=x,this},l.clone=function(){return new this.constructor().copy(this)},l.copy=function(c){return this.radius=c.radius,this.theta=c.theta,this.y=c.y,this},l.setFromVector3=function(c){return this.setFromCartesianCoords(c.x,c.y,c.z)},l.setFromCartesianCoords=function(c,h,x){return this.radius=Math.sqrt(c*c+x*x),this.theta=Math.atan2(c,x),this.y=h,this},p}(),ME=new Zt,SE=function(){function p(d,c){Object.defineProperty(this,"isBox2",{value:!0}),this.min=d!==void 0?d:new Zt(1/0,1/0),this.max=c!==void 0?c:new Zt(-1/0,-1/0)}var l=p.prototype;return l.set=function(c,h){return this.min.copy(c),this.max.copy(h),this},l.setFromPoints=function(c){this.makeEmpty();for(var h=0,x=c.length;h<x;h++)this.expandByPoint(c[h]);return this},l.setFromCenterAndSize=function(c,h){var x=ME.copy(h).multiplyScalar(.5);return this.min.copy(c).sub(x),this.max.copy(c).add(x),this},l.clone=function(){return new this.constructor().copy(this)},l.copy=function(c){return this.min.copy(c.min),this.max.copy(c.max),this},l.makeEmpty=function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},l.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y},l.getCenter=function(c){return c===void 0&&(console.warn("THREE.Box2: .getCenter() target is now required"),c=new Zt),this.isEmpty()?c.set(0,0):c.addVectors(this.min,this.max).multiplyScalar(.5)},l.getSize=function(c){return c===void 0&&(console.warn("THREE.Box2: .getSize() target is now required"),c=new Zt),this.isEmpty()?c.set(0,0):c.subVectors(this.max,this.min)},l.expandByPoint=function(c){return this.min.min(c),this.max.max(c),this},l.expandByVector=function(c){return this.min.sub(c),this.max.add(c),this},l.expandByScalar=function(c){return this.min.addScalar(-c),this.max.addScalar(c),this},l.containsPoint=function(c){return!(c.x<this.min.x||c.x>this.max.x||c.y<this.min.y||c.y>this.max.y)},l.containsBox=function(c){return this.min.x<=c.min.x&&c.max.x<=this.max.x&&this.min.y<=c.min.y&&c.max.y<=this.max.y},l.getParameter=function(c,h){return h===void 0&&(console.warn("THREE.Box2: .getParameter() target is now required"),h=new Zt),h.set((c.x-this.min.x)/(this.max.x-this.min.x),(c.y-this.min.y)/(this.max.y-this.min.y))},l.intersectsBox=function(c){return!(c.max.x<this.min.x||c.min.x>this.max.x||c.max.y<this.min.y||c.min.y>this.max.y)},l.clampPoint=function(c,h){return h===void 0&&(console.warn("THREE.Box2: .clampPoint() target is now required"),h=new Zt),h.copy(c).clamp(this.min,this.max)},l.distanceToPoint=function(c){var h=ME.copy(c).clamp(this.min,this.max);return h.sub(c).length()},l.intersect=function(c){return this.min.max(c.min),this.max.min(c.max),this},l.union=function(c){return this.min.min(c.min),this.max.max(c.max),this},l.translate=function(c){return this.min.add(c),this.max.add(c),this},l.equals=function(c){return c.min.equals(this.min)&&c.max.equals(this.max)},p}(),TE=new Ge,Gm=new Ge,CE=function(){function p(d,c){this.start=d!==void 0?d:new Ge,this.end=c!==void 0?c:new Ge}var l=p.prototype;return l.set=function(c,h){return this.start.copy(c),this.end.copy(h),this},l.clone=function(){return new this.constructor().copy(this)},l.copy=function(c){return this.start.copy(c.start),this.end.copy(c.end),this},l.getCenter=function(c){return c===void 0&&(console.warn("THREE.Line3: .getCenter() target is now required"),c=new Ge),c.addVectors(this.start,this.end).multiplyScalar(.5)},l.delta=function(c){return c===void 0&&(console.warn("THREE.Line3: .delta() target is now required"),c=new Ge),c.subVectors(this.end,this.start)},l.distanceSq=function(){return this.start.distanceToSquared(this.end)},l.distance=function(){return this.start.distanceTo(this.end)},l.at=function(c,h){return h===void 0&&(console.warn("THREE.Line3: .at() target is now required"),h=new Ge),this.delta(h).multiplyScalar(c).add(this.start)},l.closestPointToPointParameter=function(c,h){TE.subVectors(c,this.start),Gm.subVectors(this.end,this.start);var x=Gm.dot(Gm),_=Gm.dot(TE),R=_/x;return h&&(R=er.clamp(R,0,1)),R},l.closestPointToPoint=function(c,h,x){var _=this.closestPointToPointParameter(c,h);return x===void 0&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),x=new Ge),this.delta(x).multiplyScalar(_).add(this.start)},l.applyMatrix4=function(c){return this.start.applyMatrix4(c),this.end.applyMatrix4(c),this},l.equals=function(c){return c.start.equals(this.start)&&c.end.equals(this.end)},p}();function jf(p){Dn.call(this),this.material=p,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}jf.prototype=Object.create(Dn.prototype),jf.prototype.constructor=jf,jf.prototype.isImmediateRenderObject=!0;var RE=new Ge,Ek=function(p){pr(l,p);function l(c,h){var x;x=p.call(this)||this,x.light=c,x.light.updateMatrixWorld(),x.matrix=c.matrixWorld,x.matrixAutoUpdate=!1,x.color=h;for(var _=new Vn,R=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],O=0,B=1,V=32;O<V;O++,B++){var G=O/V*Math.PI*2,z=B/V*Math.PI*2;R.push(Math.cos(G),Math.sin(G),1,Math.cos(z),Math.sin(z),1)}_.setAttribute("position",new xn(R,3));var ne=new yi({fog:!1,toneMapped:!1});return x.cone=new Aa(_,ne),x.add(x.cone),x.update(),x}var d=l.prototype;return d.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},d.update=function(){this.light.updateMatrixWorld();var h=this.light.distance?this.light.distance:1e3,x=h*Math.tan(this.light.angle);this.cone.scale.set(x,x,h),RE.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(RE),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)},l}(Dn),bl=new Ge,Vm=new br,By=new br,LE=function(p){pr(l,p);function l(c){for(var h,x=PE(c),_=new Vn,R=[],O=[],B=new vn(0,0,1),V=new vn(0,1,0),G=0;G<x.length;G++){var z=x[G];z.parent&&z.parent.isBone&&(R.push(0,0,0),R.push(0,0,0),O.push(B.r,B.g,B.b),O.push(V.r,V.g,V.b))}_.setAttribute("position",new xn(R,3)),_.setAttribute("color",new xn(O,3));var ne=new yi({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});return h=p.call(this,_,ne)||this,h.type="SkeletonHelper",h.isSkeletonHelper=!0,h.root=c,h.bones=x,h.matrix=c.matrixWorld,h.matrixAutoUpdate=!1,h}var d=l.prototype;return d.updateMatrixWorld=function(h){var x=this.bones,_=this.geometry,R=_.getAttribute("position");By.copy(this.root.matrixWorld).invert();for(var O=0,B=0;O<x.length;O++){var V=x[O];V.parent&&V.parent.isBone&&(Vm.multiplyMatrices(By,V.matrixWorld),bl.setFromMatrixPosition(Vm),R.setXYZ(B,bl.x,bl.y,bl.z),Vm.multiplyMatrices(By,V.parent.matrixWorld),bl.setFromMatrixPosition(Vm),R.setXYZ(B+1,bl.x,bl.y,bl.z),B+=2)}_.getAttribute("position").needsUpdate=!0,p.prototype.updateMatrixWorld.call(this,h)},l}(Aa);function PE(p){var l=[];p&&p.isBone&&l.push(p);for(var d=0;d<p.children.length;d++)l.push.apply(l,PE(p.children[d]));return l}var _k=function(p){pr(l,p);function l(c,h,x){var _,R=new Uf(h,4,2),O=new za({wireframe:!0,fog:!1,toneMapped:!1});return _=p.call(this,R,O)||this,_.light=c,_.light.updateMatrixWorld(),_.color=x,_.type="PointLightHelper",_.matrix=_.light.matrixWorld,_.matrixAutoUpdate=!1,_.update(),_}var d=l.prototype;return d.dispose=function(){this.geometry.dispose(),this.material.dispose()},d.update=function(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)},l}(fi),Mk=new Ge,DE=new vn,OE=new vn,Sk=function(p){pr(l,p);function l(c,h,x){var _;_=p.call(this)||this,_.light=c,_.light.updateMatrixWorld(),_.matrix=c.matrixWorld,_.matrixAutoUpdate=!1,_.color=x;var R=new Bf(h);R.rotateY(Math.PI*.5),_.material=new za({wireframe:!0,fog:!1,toneMapped:!1}),_.color===void 0&&(_.material.vertexColors=!0);var O=R.getAttribute("position"),B=new Float32Array(O.count*3);return R.setAttribute("color",new Zn(B,3)),_.add(new fi(R,_.material)),_.update(),_}var d=l.prototype;return d.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},d.update=function(){var h=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{var x=h.geometry.getAttribute("color");DE.copy(this.light.color),OE.copy(this.light.groundColor);for(var _=0,R=x.count;_<R;_++){var O=_<R/2?DE:OE;x.setXYZ(_,O.r,O.g,O.b)}x.needsUpdate=!0}h.lookAt(Mk.setFromMatrixPosition(this.light.matrixWorld).negate())},l}(Dn),IE=function(p){pr(l,p);function l(d,c,h,x){var _;d===void 0&&(d=10),c===void 0&&(c=10),h===void 0&&(h=4473924),x===void 0&&(x=8947848),h=new vn(h),x=new vn(x);for(var R=c/2,O=d/c,B=d/2,V=[],G=[],z=0,ne=0,Q=-B;z<=c;z++,Q+=O){V.push(-B,0,Q,B,0,Q),V.push(Q,0,-B,Q,0,B);var le=z===R?h:x;le.toArray(G,ne),ne+=3,le.toArray(G,ne),ne+=3,le.toArray(G,ne),ne+=3,le.toArray(G,ne),ne+=3}var me=new Vn;me.setAttribute("position",new xn(V,3)),me.setAttribute("color",new xn(G,3));var ue=new yi({vertexColors:!0,toneMapped:!1});return _=p.call(this,me,ue)||this,_.type="GridHelper",_}return l}(Aa),Tk=function(p){pr(l,p);function l(d,c,h,x,_,R){var O;d===void 0&&(d=10),c===void 0&&(c=16),h===void 0&&(h=8),x===void 0&&(x=64),_===void 0&&(_=4473924),R===void 0&&(R=8947848),_=new vn(_),R=new vn(R);for(var B=[],V=[],G=0;G<=c;G++){var z=G/c*(Math.PI*2),ne=Math.sin(z)*d,Q=Math.cos(z)*d;B.push(0,0,0),B.push(ne,0,Q);var le=G&1?_:R;V.push(le.r,le.g,le.b),V.push(le.r,le.g,le.b)}for(var me=0;me<=h;me++)for(var ue=me&1?_:R,re=d-d/h*me,Oe=0;Oe<x;Oe++){var He=Oe/x*(Math.PI*2),Re=Math.sin(He)*re,we=Math.cos(He)*re;B.push(Re,0,we),V.push(ue.r,ue.g,ue.b),He=(Oe+1)/x*(Math.PI*2),Re=Math.sin(He)*re,we=Math.cos(He)*re,B.push(Re,0,we),V.push(ue.r,ue.g,ue.b)}var Ue=new Vn;Ue.setAttribute("position",new xn(B,3)),Ue.setAttribute("color",new xn(V,3));var rt=new yi({vertexColors:!0,toneMapped:!1});return O=p.call(this,Ue,rt)||this,O.type="PolarGridHelper",O}return l}(Aa),kE=new Ge,Wm=new Ge,FE=new Ge,Ck=function(p){pr(l,p);function l(c,h,x){var _;_=p.call(this)||this,_.light=c,_.light.updateMatrixWorld(),_.matrix=c.matrixWorld,_.matrixAutoUpdate=!1,_.color=x,h===void 0&&(h=1);var R=new Vn;R.setAttribute("position",new xn([-h,h,0,h,h,0,h,-h,0,-h,-h,0,-h,h,0],3));var O=new yi({fog:!1,toneMapped:!1});return _.lightPlane=new ao(R,O),_.add(_.lightPlane),R=new Vn,R.setAttribute("position",new xn([0,0,0,0,0,1],3)),_.targetLine=new ao(R,O),_.add(_.targetLine),_.update(),_}var d=l.prototype;return d.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},d.update=function(){kE.setFromMatrixPosition(this.light.matrixWorld),Wm.setFromMatrixPosition(this.light.target.matrixWorld),FE.subVectors(Wm,kE),this.lightPlane.lookAt(Wm),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Wm),this.targetLine.scale.z=FE.length()},l}(Dn),jm=new Ge,Si=new Wo,Rk=function(p){pr(l,p);function l(c){var h,x=new Vn,_=new yi({color:16777215,vertexColors:!0,toneMapped:!1}),R=[],O=[],B={},V=new vn(16755200),G=new vn(16711680),z=new vn(43775),ne=new vn(16777215),Q=new vn(3355443);le("n1","n2",V),le("n2","n4",V),le("n4","n3",V),le("n3","n1",V),le("f1","f2",V),le("f2","f4",V),le("f4","f3",V),le("f3","f1",V),le("n1","f1",V),le("n2","f2",V),le("n3","f3",V),le("n4","f4",V),le("p","n1",G),le("p","n2",G),le("p","n3",G),le("p","n4",G),le("u1","u2",z),le("u2","u3",z),le("u3","u1",z),le("c","t",ne),le("p","c",Q),le("cn1","cn2",Q),le("cn3","cn4",Q),le("cf1","cf2",Q),le("cf3","cf4",Q);function le(ue,re,Oe){me(ue,Oe),me(re,Oe)}function me(ue,re){R.push(0,0,0),O.push(re.r,re.g,re.b),B[ue]===void 0&&(B[ue]=[]),B[ue].push(R.length/3-1)}return x.setAttribute("position",new xn(R,3)),x.setAttribute("color",new xn(O,3)),h=p.call(this,x,_)||this,h.type="CameraHelper",h.camera=c,h.camera.updateProjectionMatrix&&h.camera.updateProjectionMatrix(),h.matrix=c.matrixWorld,h.matrixAutoUpdate=!1,h.pointMap=B,h.update(),h}var d=l.prototype;return d.update=function(){var h=this.geometry,x=this.pointMap,_=1,R=1;Si.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Pi("c",x,h,Si,0,0,-1),Pi("t",x,h,Si,0,0,1),Pi("n1",x,h,Si,-_,-R,-1),Pi("n2",x,h,Si,_,-R,-1),Pi("n3",x,h,Si,-_,R,-1),Pi("n4",x,h,Si,_,R,-1),Pi("f1",x,h,Si,-_,-R,1),Pi("f2",x,h,Si,_,-R,1),Pi("f3",x,h,Si,-_,R,1),Pi("f4",x,h,Si,_,R,1),Pi("u1",x,h,Si,_*.7,R*1.1,-1),Pi("u2",x,h,Si,-_*.7,R*1.1,-1),Pi("u3",x,h,Si,0,R*2,-1),Pi("cf1",x,h,Si,-_,0,1),Pi("cf2",x,h,Si,_,0,1),Pi("cf3",x,h,Si,0,-R,1),Pi("cf4",x,h,Si,0,R,1),Pi("cn1",x,h,Si,-_,0,-1),Pi("cn2",x,h,Si,_,0,-1),Pi("cn3",x,h,Si,0,-R,-1),Pi("cn4",x,h,Si,0,R,-1),h.getAttribute("position").needsUpdate=!0},l}(Aa);function Pi(p,l,d,c,h,x,_){jm.set(h,x,_).unproject(c);var R=l[p];if(R!==void 0)for(var O=d.getAttribute("position"),B=0,V=R.length;B<V;B++)O.setXYZ(R[B],jm.x,jm.y,jm.z)}var Xm=new vs,BE=function(p){pr(l,p);function l(c,h){var x;h===void 0&&(h=16776960);var _=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),R=new Float32Array(8*3),O=new Vn;return O.setIndex(new Zn(_,1)),O.setAttribute("position",new Zn(R,3)),x=p.call(this,O,new yi({color:h,toneMapped:!1}))||this,x.object=c,x.type="BoxHelper",x.matrixAutoUpdate=!1,x.update(),x}var d=l.prototype;return d.update=function(h){if(h!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&Xm.setFromObject(this.object),!Xm.isEmpty()){var x=Xm.min,_=Xm.max,R=this.geometry.attributes.position,O=R.array;O[0]=_.x,O[1]=_.y,O[2]=_.z,O[3]=x.x,O[4]=_.y,O[5]=_.z,O[6]=x.x,O[7]=x.y,O[8]=_.z,O[9]=_.x,O[10]=x.y,O[11]=_.z,O[12]=_.x,O[13]=_.y,O[14]=x.z,O[15]=x.x,O[16]=_.y,O[17]=x.z,O[18]=x.x,O[19]=x.y,O[20]=x.z,O[21]=_.x,O[22]=x.y,O[23]=x.z,R.needsUpdate=!0,this.geometry.computeBoundingSphere()}},d.setFromObject=function(h){return this.object=h,this.update(),this},d.copy=function(h){return Aa.prototype.copy.call(this,h),this.object=h.object,this},l}(Aa),Lk=function(p){pr(l,p);function l(c,h){var x;h===void 0&&(h=16776960);var _=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),R=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],O=new Vn;return O.setIndex(new Zn(_,1)),O.setAttribute("position",new xn(R,3)),x=p.call(this,O,new yi({color:h,toneMapped:!1}))||this,x.box=c,x.type="Box3Helper",x.geometry.computeBoundingSphere(),x}var d=l.prototype;return d.updateMatrixWorld=function(h){var x=this.box;x.isEmpty()||(x.getCenter(this.position),x.getSize(this.scale),this.scale.multiplyScalar(.5),p.prototype.updateMatrixWorld.call(this,h))},l}(Aa),Pk=function(p){pr(l,p);function l(c,h,x){var _;h===void 0&&(h=1),x===void 0&&(x=16776960);var R=x,O=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],B=new Vn;B.setAttribute("position",new xn(O,3)),B.computeBoundingSphere(),_=p.call(this,B,new yi({color:R,toneMapped:!1}))||this,_.type="PlaneHelper",_.plane=c,_.size=h;var V=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],G=new Vn;return G.setAttribute("position",new xn(V,3)),G.computeBoundingSphere(),_.add(new fi(G,new za({color:R,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1}))),_}var d=l.prototype;return d.updateMatrixWorld=function(h){var x=-this.plane.constant;Math.abs(x)<1e-8&&(x=1e-8),this.scale.set(.5*this.size,.5*this.size,x),this.children[0].material.side=x<0?C:T,this.lookAt(this.plane.normal),p.prototype.updateMatrixWorld.call(this,h)},l}(ao),NE=new Ge,qm,Ny,Dk=function(p){pr(l,p);function l(c,h,x,_,R,O){var B;return B=p.call(this)||this,B.type="ArrowHelper",c===void 0&&(c=new Ge(0,0,1)),h===void 0&&(h=new Ge(0,0,0)),x===void 0&&(x=1),_===void 0&&(_=16776960),R===void 0&&(R=.2*x),O===void 0&&(O=.2*R),qm===void 0&&(qm=new Vn,qm.setAttribute("position",new xn([0,0,0,0,1,0],3)),Ny=new Tu(0,.5,1,5,1),Ny.translate(0,-.5,0)),B.position.copy(h),B.line=new ao(qm,new yi({color:_,toneMapped:!1})),B.line.matrixAutoUpdate=!1,B.add(B.line),B.cone=new fi(Ny,new za({color:_,toneMapped:!1})),B.cone.matrixAutoUpdate=!1,B.add(B.cone),B.setDirection(c),B.setLength(x,R,O),B}var d=l.prototype;return d.setDirection=function(h){if(h.y>.99999)this.quaternion.set(0,0,0,1);else if(h.y<-.99999)this.quaternion.set(1,0,0,0);else{NE.set(h.z,0,-h.x).normalize();var x=Math.acos(h.y);this.quaternion.setFromAxisAngle(NE,x)}},d.setLength=function(h,x,_){x===void 0&&(x=.2*h),_===void 0&&(_=.2*x),this.line.scale.set(1,Math.max(1e-4,h-x),1),this.line.updateMatrix(),this.cone.scale.set(_,x,_),this.cone.position.y=h,this.cone.updateMatrix()},d.setColor=function(h){this.line.material.color.set(h),this.cone.material.color.set(h)},d.copy=function(h){return p.prototype.copy.call(this,h,!1),this.line.copy(h.line),this.cone.copy(h.cone),this},l}(Dn),UE=function(p){pr(l,p);function l(d){var c;d===void 0&&(d=1);var h=[0,0,0,d,0,0,0,0,0,0,d,0,0,0,0,0,0,d],x=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],_=new Vn;_.setAttribute("position",new xn(h,3)),_.setAttribute("color",new xn(x,3));var R=new yi({vertexColors:!0,toneMapped:!1});return c=p.call(this,_,R)||this,c.type="AxesHelper",c}return l}(Aa),HE=new Float32Array(1),Ok=new Int32Array(HE.buffer),Ik={toHalfFloat:function(l){HE[0]=l;var d=Ok[0],c=d>>16&32768,h=d>>12&2047,x=d>>23&255;return x<103?c:x>142?(c|=31744,c|=(x==255?0:1)&&d&8388607,c):x<113?(h|=2048,c|=(h>>114-x)+(h>>113-x&1),c):(c|=x-112<<10|h>>1,c+=h&1,c)}},Ts,ku=4,xl=8,$o=Math.pow(2,xl),zE=[.125,.215,.35,.446,.526,.582],GE=xl-ku+1+zE.length,Fu=20,Ko=(Ts={},Ts[xa]=0,Ts[ef]=1,Ts[Tp]=2,Ts[A0]=3,Ts[E0]=4,Ts[_0]=5,Ts[Sp]=6,Ts),Tc=new za({side:C,depthWrite:!1,depthTest:!1}),kk=new fi(new hc,Tc),Uy=new Iu,Hy=Nk(),Xf=Hy._lodPlanes,VE=Hy._sizeLods,Ym=Hy._sigmas,WE=new vn,zy=null,Cc=(1+Math.sqrt(5))/2,Bu=1/Cc,jE=[new Ge(1,1,1),new Ge(-1,1,1),new Ge(1,1,-1),new Ge(-1,1,-1),new Ge(0,Cc,Bu),new Ge(0,Cc,-Bu),new Ge(Bu,0,Cc),new Ge(-Bu,0,Cc),new Ge(Cc,Bu,0),new Ge(-Cc,Bu,0)];function XE(p){var l=Math.max(p.r,p.g,p.b),d=Math.min(Math.max(Math.ceil(Math.log2(l)),-128),127);p.multiplyScalar(Math.pow(2,-d));var c=(d+128)/255;return c}var Fk=function(){function p(d){this._renderer=d,this._pingPongRenderTarget=null,this._blurMaterial=Uk(Fu),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}var l=p.prototype;return l.fromScene=function(c,h,x,_){h===void 0&&(h=0),x===void 0&&(x=.1),_===void 0&&(_=100),zy=this._renderer.getRenderTarget();var R=this._allocateTargets();return this._sceneToCubeUV(c,x,_,R),h>0&&this._blur(R,0,0,h),this._applyPMREM(R),this._cleanup(R),R},l.fromEquirectangular=function(c){return this._fromTexture(c)},l.fromCubemap=function(c){return this._fromTexture(c)},l.compileCubemapShader=function(){this._cubemapShader===null&&(this._cubemapShader=$E(),this._compileMaterial(this._cubemapShader))},l.compileEquirectangularShader=function(){this._equirectShader===null&&(this._equirectShader=YE(),this._compileMaterial(this._equirectShader))},l.dispose=function(){this._blurMaterial.dispose(),this._cubemapShader!==null&&this._cubemapShader.dispose(),this._equirectShader!==null&&this._equirectShader.dispose();for(var c=0;c<Xf.length;c++)Xf[c].dispose()},l._cleanup=function(c){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(zy),c.scissorTest=!1,$m(c,0,0,c.width,c.height)},l._fromTexture=function(c){zy=this._renderer.getRenderTarget();var h=this._allocateTargets(c);return this._textureToCubeUV(c,h),this._applyPMREM(h),this._cleanup(h),h},l._allocateTargets=function(c){var h={magFilter:Jt,minFilter:Jt,generateMipmaps:!1,type:bn,format:ct,encoding:Bk(c)?c.encoding:Tp,depthBuffer:!1},x=qE(h);return x.depthBuffer=!c,this._pingPongRenderTarget=qE(h),x},l._compileMaterial=function(c){var h=new fi(Xf[0],c);this._renderer.compile(h,Uy)},l._sceneToCubeUV=function(c,h,x,_){var R=90,O=1,B=new Mi(R,O,h,x),V=[1,-1,1,1,1,1],G=[1,1,1,-1,-1,-1],z=this._renderer,ne=z.autoClear,Q=z.outputEncoding,le=z.toneMapping;z.getClearColor(WE),z.toneMapping=ke,z.outputEncoding=xa,z.autoClear=!1;var me=!1,ue=c.background;if(ue){if(ue.isColor){Tc.color.copy(ue).convertSRGBToLinear(),c.background=null;var re=XE(Tc.color);Tc.opacity=re,me=!0}}else{Tc.color.copy(WE).convertSRGBToLinear();var Oe=XE(Tc.color);Tc.opacity=Oe,me=!0}for(var He=0;He<6;He++){var Re=He%3;Re==0?(B.up.set(0,V[He],0),B.lookAt(G[He],0,0)):Re==1?(B.up.set(0,0,V[He]),B.lookAt(0,G[He],0)):(B.up.set(0,V[He],0),B.lookAt(0,0,G[He])),$m(_,Re*$o,He>2?$o:0,$o,$o),z.setRenderTarget(_),me&&z.render(kk,B),z.render(c,B)}z.toneMapping=le,z.outputEncoding=Q,z.autoClear=ne},l._textureToCubeUV=function(c,h){var x=this._renderer;c.isCubeTexture?this._cubemapShader==null&&(this._cubemapShader=$E()):this._equirectShader==null&&(this._equirectShader=YE());var _=c.isCubeTexture?this._cubemapShader:this._equirectShader,R=new fi(Xf[0],_),O=_.uniforms;O.envMap.value=c,c.isCubeTexture||O.texelSize.value.set(1/c.image.width,1/c.image.height),O.inputEncoding.value=Ko[c.encoding],O.outputEncoding.value=Ko[h.texture.encoding],$m(h,0,0,3*$o,2*$o),x.setRenderTarget(h),x.render(R,Uy)},l._applyPMREM=function(c){var h=this._renderer,x=h.autoClear;h.autoClear=!1;for(var _=1;_<GE;_++){var R=Math.sqrt(Ym[_]*Ym[_]-Ym[_-1]*Ym[_-1]),O=jE[(_-1)%jE.length];this._blur(c,_-1,_,R,O)}h.autoClear=x},l._blur=function(c,h,x,_,R){var O=this._pingPongRenderTarget;this._halfBlur(c,O,h,x,_,"latitudinal",R),this._halfBlur(O,c,x,x,_,"longitudinal",R)},l._halfBlur=function(c,h,x,_,R,O,B){var V=this._renderer,G=this._blurMaterial;O!=="latitudinal"&&O!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");var z=3,ne=new fi(Xf[_],G),Q=G.uniforms,le=VE[x]-1,me=isFinite(R)?Math.PI/(2*le):2*Math.PI/(2*Fu-1),ue=R/me,re=isFinite(R)?1+Math.floor(z*ue):Fu;re>Fu&&console.warn("sigmaRadians, "+R+", is too large and will clip, as it requested "+re+" samples when the maximum is set to "+Fu);for(var Oe=[],He=0,Re=0;Re<Fu;++Re){var we=Re/ue,Ue=Math.exp(-we*we/2);Oe.push(Ue),Re==0?He+=Ue:Re<re&&(He+=2*Ue)}for(var rt=0;rt<Oe.length;rt++)Oe[rt]=Oe[rt]/He;Q.envMap.value=c.texture,Q.samples.value=re,Q.weights.value=Oe,Q.latitudinal.value=O==="latitudinal",B&&(Q.poleAxis.value=B),Q.dTheta.value=me,Q.mipInt.value=xl-x,Q.inputEncoding.value=Ko[c.texture.encoding],Q.outputEncoding.value=Ko[c.texture.encoding];var nt=VE[_],ot=3*Math.max(0,$o-2*nt),ut=(_===0?0:2*$o)+2*nt*(_>xl-ku?_-xl+ku:0);$m(h,ot,ut,3*nt,2*nt),V.setRenderTarget(h),V.render(ne,Uy)},p}();function Bk(p){return p===void 0||p.type!==bn?!1:p.encoding===xa||p.encoding===ef||p.encoding===Sp}function Nk(){for(var p=[],l=[],d=[],c=xl,h=0;h<GE;h++){var x=Math.pow(2,c);l.push(x);var _=1/x;h>xl-ku?_=zE[h-xl+ku-1]:h==0&&(_=0),d.push(_);for(var R=1/(x-1),O=-R/2,B=1+R/2,V=[O,O,B,O,B,B,O,O,B,B,O,B],G=6,z=6,ne=3,Q=2,le=1,me=new Float32Array(ne*z*G),ue=new Float32Array(Q*z*G),re=new Float32Array(le*z*G),Oe=0;Oe<G;Oe++){var He=Oe%3*2/3-1,Re=Oe>2?0:-1,we=[He,Re,0,He+2/3,Re,0,He+2/3,Re+1,0,He,Re,0,He+2/3,Re+1,0,He,Re+1,0];me.set(we,ne*z*Oe),ue.set(V,Q*z*Oe);var Ue=[Oe,Oe,Oe,Oe,Oe,Oe];re.set(Ue,le*z*Oe)}var rt=new Vn;rt.setAttribute("position",new Zn(me,ne)),rt.setAttribute("uv",new Zn(ue,Q)),rt.setAttribute("faceIndex",new Zn(re,le)),p.push(rt),c>ku&&c--}return{_lodPlanes:p,_sizeLods:l,_sigmas:d}}function qE(p){var l=new Js(3*$o,3*$o,p);return l.texture.mapping=qe,l.texture.name="PMREM.cubeUv",l.scissorTest=!0,l}function $m(p,l,d,c,h){p.viewport.set(l,d,c,h),p.scissor.set(l,d,c,h)}function Uk(p){var l=new Float32Array(p),d=new Ge(0,1,0),c=new Ms({name:"SphericalGaussianBlur",defines:{n:p},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:l},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:d},inputEncoding:{value:Ko[xa]},outputEncoding:{value:Ko[xa]}},vertexShader:Gy(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			`+Vy()+`

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:F,depthTest:!1,depthWrite:!1});return c}function YE(){var p=new Zt(1,1),l=new Ms({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:p},inputEncoding:{value:Ko[xa]},outputEncoding:{value:Ko[xa]}},vertexShader:Gy(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform vec2 texelSize;

			`+Vy()+`

			#include <common>

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				vec2 f = fract( uv / texelSize - 0.5 );
				uv -= f * texelSize;
				vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x += texelSize.x;
				vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.y += texelSize.y;
				vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x -= texelSize.x;
				vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;

				vec3 tm = mix( tl, tr, f.x );
				vec3 bm = mix( bl, br, f.x );
				gl_FragColor.rgb = mix( tm, bm, f.y );

				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:F,depthTest:!1,depthWrite:!1});return l}function $E(){var p=new Ms({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:Ko[xa]},outputEncoding:{value:Ko[xa]}},vertexShader:Gy(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			`+Vy()+`

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;
				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:F,depthTest:!1,depthWrite:!1});return p}function Gy(){return`

		precision mediump float;
		precision mediump int;

		attribute vec3 position;
		attribute vec2 uv;
		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function Vy(){return`

		uniform int inputEncoding;
		uniform int outputEncoding;

		#include <encodings_pars_fragment>

		vec4 inputTexelToLinear( vec4 value ) {

			if ( inputEncoding == 0 ) {

				return value;

			} else if ( inputEncoding == 1 ) {

				return sRGBToLinear( value );

			} else if ( inputEncoding == 2 ) {

				return RGBEToLinear( value );

			} else if ( inputEncoding == 3 ) {

				return RGBMToLinear( value, 7.0 );

			} else if ( inputEncoding == 4 ) {

				return RGBMToLinear( value, 16.0 );

			} else if ( inputEncoding == 5 ) {

				return RGBDToLinear( value, 256.0 );

			} else {

				return GammaToLinear( value, 2.2 );

			}

		}

		vec4 linearToOutputTexel( vec4 value ) {

			if ( outputEncoding == 0 ) {

				return value;

			} else if ( outputEncoding == 1 ) {

				return LinearTosRGB( value );

			} else if ( outputEncoding == 2 ) {

				return LinearToRGBE( value );

			} else if ( outputEncoding == 3 ) {

				return LinearToRGBM( value, 7.0 );

			} else if ( outputEncoding == 4 ) {

				return LinearToRGBM( value, 16.0 );

			} else if ( outputEncoding == 5 ) {

				return LinearToRGBD( value, 256.0 );

			} else {

				return LinearToGamma( value, 2.2 );

			}

		}

		vec4 envMapTexelToLinear( vec4 color ) {

			return inputTexelToLinear( color );

		}
	`}function Hk(p,l,d,c,h,x,_){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new G0(p,l,d,h,x,_)}var zk=0,Gk=1,Vk=0,Wk=1,jk=2;function Xk(p){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),p}function qk(p){return p===void 0&&(p=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),p.isMultiMaterial=!0,p.materials=p,p.clone=function(){return p.slice()},p}function Yk(p,l){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Mu(p,l)}function $k(p){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Sf(p)}function Kk(p,l){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Mu(p,l)}function Zk(p){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Ao(p)}function Qk(p){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Ao(p)}function Jk(p){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Ao(p)}function eF(p,l,d){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Ge(p,l,d)}function tF(p,l){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new Zn(p,l).setUsage(ac)}function nF(p,l){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new sf(p,l)}function rF(p,l){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new lf(p,l)}function iF(p,l){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new cf(p,l)}function aF(p,l){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new uf(p,l)}function oF(p,l){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new cc(p,l)}function sF(p,l){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new hf(p,l)}function lF(p,l){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new uc(p,l)}function cF(p,l){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new xn(p,l)}function uF(p,l){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new df(p,l)}Bn.create=function(p,l){return console.log("THREE.Curve.create() has been deprecated"),p.prototype=Object.create(Bn.prototype),p.prototype.constructor=p,p.prototype.getPoint=l,p},Object.assign(Co.prototype,{fromPoints:function(l){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(l)}});function KE(p){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),aa.call(this,p),this.type="catmullrom",this.closed=!0}KE.prototype=Object.create(aa.prototype);function ZE(p){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),aa.call(this,p),this.type="catmullrom"}ZE.prototype=Object.create(aa.prototype);function Wy(p){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),aa.call(this,p),this.type="catmullrom"}Wy.prototype=Object.create(aa.prototype),Object.assign(Wy.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}});function hF(p){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new UE(p)}function fF(p,l){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new BE(p,l)}function dF(p,l){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Aa(new oy(p.geometry),new yi({color:l!==void 0?l:16777215}))}IE.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},LE.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")};function pF(p,l){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Aa(new cy(p.geometry),new yi({color:l!==void 0?l:16777215}))}Object.assign(Jr.prototype,{extractUrlBase:function(l){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),wy.extractUrlBase(l)}}),Jr.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}};function mF(p){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new oo(p)}function vF(p){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Cm(p)}Object.assign(SE.prototype,{center:function(l){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(l)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(l){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(l)},size:function(l){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(l)}}),Object.assign(vs.prototype,{center:function(l){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(l)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(l){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(l)},isIntersectionSphere:function(l){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(l)},size:function(l){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(l)}}),Object.assign(nl.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),vf.prototype.setFromMatrix=function(p){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(p)},CE.prototype.center=function(p){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(p)},Object.assign(er,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(l){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),er.floorPowerOfTwo(l)},nextPowerOfTwo:function(l){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),er.ceilPowerOfTwo(l)}}),Object.assign(Ua.prototype,{flattenToArrayOffset:function(l,d){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(l,d)},multiplyVector3:function(l){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),l.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(l){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),l.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},getInverse:function(l){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(l).invert()}}),Object.assign(br.prototype,{extractPosition:function(l){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(l)},flattenToArrayOffset:function(l,d){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(l,d)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new Ge().setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(l){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(l)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(l){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),l.applyMatrix4(this)},multiplyVector4:function(l){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),l.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(l){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),l.transformDirection(this)},crossVector:function(l){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),l.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(l){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),l.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(l,d,c,h,x,_){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(l,d,h,c,x,_)},getInverse:function(l){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(l).invert()}}),zo.prototype.isIntersectionLine=function(p){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(p)},Object.assign(Zi.prototype,{multiplyVector3:function(l){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),l.applyQuaternion(this)},inverse:function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()}}),Object.assign(su.prototype,{isIntersectionBox:function(l){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(l)},isIntersectionPlane:function(l){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(l)},isIntersectionSphere:function(l){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(l)}}),Object.assign(Go.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(l,d){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(l,d)},midpoint:function(l){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(l)},normal:function(l){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(l)},plane:function(l){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(l)}}),Object.assign(Go,{barycoordFromPoint:function(l,d,c,h,x){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Go.getBarycoord(l,d,c,h,x)},normal:function(l,d,c,h){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Go.getNormal(l,d,c,h)}}),Object.assign(yl.prototype,{extractAllPoints:function(l){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(l)},extrude:function(l){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new pc(this,l)},makeGeometry:function(l){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Nf(this,l)}}),Object.assign(Zt.prototype,{fromAttribute:function(l,d,c){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(l,d,c)},distanceToManhattan:function(l){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(l)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Ge.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(l){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(l)},getScaleFromMatrix:function(l){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(l)},getColumnFromMatrix:function(l,d){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(d,l)},applyProjection:function(l){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(l)},fromAttribute:function(l,d,c){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(l,d,c)},distanceToManhattan:function(l){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(l)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Yr.prototype,{fromAttribute:function(l,d,c){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(l,d,c)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Dn.prototype,{getChildByName:function(l){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(l)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(l,d){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(d,l)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(l){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(l)}}),Object.defineProperties(Dn.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(l){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=l}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(fi.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(fi.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),Qs},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(Tf.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Lf.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Cf.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(Bn.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(l){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=l}}),Mi.prototype.setLens=function(p,l){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),l!==void 0&&(this.filmGauge=l),this.setFocalLength(p)},Object.defineProperties(di.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(l){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=l}},shadowCameraLeft:{set:function(l){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=l}},shadowCameraRight:{set:function(l){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=l}},shadowCameraTop:{set:function(l){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=l}},shadowCameraBottom:{set:function(l){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=l}},shadowCameraNear:{set:function(l){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=l}},shadowCameraFar:{set:function(l){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=l}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(l){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=l}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(l){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=l}},shadowMapHeight:{set:function(l){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=l}}}),Object.defineProperties(Zn.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===ac},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(ac)}}}),Object.assign(Zn.prototype,{setDynamic:function(l){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(l===!0?ac:tf),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Vn.prototype,{addIndex:function(l){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(l)},addAttribute:function(l,d){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),!(d&&d.isBufferAttribute)&&!(d&&d.isInterleavedBufferAttribute)?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(l,new Zn(arguments[1],arguments[2]))):l==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(d),this):this.setAttribute(l,d)},addDrawCall:function(l,d,c){c!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(l,d)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(l){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(l)},applyMatrix:function(l){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(l)}}),Object.defineProperties(Vn.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Wf.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(l){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=l}}}),Object.defineProperties(ky.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(l){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=l}}}),Object.defineProperties(Wa.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===ac},set:function(l){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(l)}}}),Object.assign(Wa.prototype,{setDynamic:function(l){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(l===!0?ac:tf),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(pc.prototype,{getArrays:function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")}}),Object.assign(ey.prototype,{dispose:function(){console.error("THREE.Scene: .dispose() has been removed.")}}),Object.defineProperties(EE.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(Kn.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new vn}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(l){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=l===P}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(l){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=l}}}),Object.defineProperties(vl.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(ml.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(l){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=l}}}),Object.defineProperties(wa.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(l){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=l}}}),Object.assign(Af.prototype,{clearTarget:function(l,d,c,h){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(l),this.clear(d,c,h)},animate:function(l){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(l)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(l){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(l)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(Af.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(l){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=l}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(l){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=l}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(l){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=l===!0?ef:xa}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(RA.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}});function gF(p,l,d){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new $0(p,d)}Object.defineProperties(Js.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(l){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=l}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(l){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=l}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(l){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=l}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(l){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=l}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(l){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=l}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(l){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=l}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(l){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=l}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(l){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=l}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(l){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=l}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(l){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=l}}}),Object.defineProperties(Cy.prototype,{load:{value:function(l){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var d=this,c=new zm;return c.load(l,function(h){d.setBuffer(h)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),xE.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},fc.prototype.updateCubeMap=function(p,l){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(p,l)},fc.prototype.clear=function(p,l,d,c){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(p,l,d,c)};var yF={merge:function(l,d,c){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var h;d.isMesh&&(d.matrixAutoUpdate&&d.updateMatrix(),h=d.matrix,d=d.geometry),l.merge(d,h,c)},center:function(l){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),l.center()}};oc.crossOrigin=void 0,oc.loadTexture=function(p,l,d,c){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var h=new Rm;h.setCrossOrigin(this.crossOrigin);var x=h.load(p,d,void 0,c);return l&&(x.mapping=l),x},oc.loadTextureCube=function(p,l,d,c){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var h=new Tm;h.setCrossOrigin(this.crossOrigin);var x=h.load(p,d,void 0,c);return l&&(x.mapping=l),x},oc.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},oc.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};function bF(){console.error("THREE.CanvasRenderer has been removed")}function xF(){console.error("THREE.JSONLoader has been removed.")}var wF={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function AF(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:f}})),typeof window!="undefined"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=f),o.ACESFilmicToneMapping=K,o.AddEquation=D,o.AddOperation=Se,o.AdditiveAnimationBlendMode=vo,o.AdditiveBlending=Y,o.AlphaFormat=En,o.AlwaysDepth=ht,o.AlwaysStencilFunc=jw,o.AmbientLight=km,o.AmbientLightProbe=Ty,o.AnimationClip=Xa,o.AnimationLoader=hy,o.AnimationMixer=Dy,o.AnimationObjectGroup=AE,o.AnimationUtils=mi,o.ArcCurve=Ou,o.ArrayCamera=xf,o.ArrowHelper=Dk,o.Audio=Cy,o.AudioAnalyser=xE,o.AudioContext=My,o.AudioListener=ck,o.AudioLoader=zm,o.AxesHelper=UE,o.AxisHelper=hF,o.BackSide=C,o.BasicDepthPacking=Gw,o.BasicShadowMap=A,o.BinaryTextureLoader=vF,o.Bone=Rf,o.BooleanKeyframeTrack=Em,o.BoundingBoxHelper=fF,o.Box2=SE,o.Box3=vs,o.Box3Helper=Lk,o.BoxBufferGeometry=hc,o.BoxGeometry=hc,o.BoxHelper=BE,o.BufferAttribute=Zn,o.BufferGeometry=Vn,o.BufferGeometryLoader=Um,o.ByteType=Jn,o.Cache=Ac,o.Camera=Wo,o.CameraHelper=Rk,o.CanvasRenderer=bF,o.CanvasTexture=Df,o.CatmullRomCurve3=aa,o.CineonToneMapping=ve,o.CircleBufferGeometry=am,o.CircleGeometry=am,o.ClampToEdgeWrapping=Yt,o.Clock=vE,o.ClosedSplineCurve3=KE,o.Color=vn,o.ColorKeyframeTrack=_m,o.CompressedTexture=Su,o.CompressedTextureLoader=fy,o.ConeBufferGeometry=om,o.ConeGeometry=om,o.CubeCamera=fc,o.CubeReflectionMapping=xe,o.CubeRefractionMapping=Je,o.CubeTexture=jo,o.CubeTextureLoader=Tm,o.CubeUVReflectionMapping=qe,o.CubeUVRefractionMapping=It,o.CubicBezierCurve=_o,o.CubicBezierCurve3=qo,o.CubicInterpolant=wm,o.CullFaceBack=y,o.CullFaceFront=b,o.CullFaceFrontBack=w,o.CullFaceNone=g,o.Curve=Bn,o.CurvePath=gl,o.CustomBlending=de,o.CustomToneMapping=J,o.CylinderBufferGeometry=Tu,o.CylinderGeometry=Tu,o.Cylindrical=Ak,o.DataTexture=As,o.DataTexture2DArray=yu,o.DataTexture3D=bu,o.DataTextureLoader=Cm,o.DataUtils=Ik,o.DecrementStencilOp=VR,o.DecrementWrapStencilOp=jR,o.DefaultLoadingManager=sE,o.DepthFormat=bt,o.DepthStencilFormat=yt,o.DepthTexture=Of,o.DirectionalLight=Im,o.DirectionalLightHelper=Ck,o.DiscreteInterpolant=Am,o.DodecahedronBufferGeometry=sm,o.DodecahedronGeometry=sm,o.DoubleSide=L,o.DstAlphaFactor=Ve,o.DstColorFactor=Fe,o.DynamicBufferAttribute=tF,o.DynamicCopyUsage=aL,o.DynamicDrawUsage=ac,o.DynamicReadUsage=nL,o.EdgesGeometry=oy,o.EdgesHelper=dF,o.EllipseCurve=qa,o.EqualDepth=H,o.EqualStencilFunc=$R,o.EquirectangularReflectionMapping=Xe,o.EquirectangularRefractionMapping=Mt,o.Euler=Fp,o.EventDispatcher=Ho,o.ExtrudeBufferGeometry=pc,o.ExtrudeGeometry=pc,o.Face3=G0,o.Face4=Hk,o.FaceColors=Wk,o.FileLoader=oo,o.FlatShading=P,o.Float16BufferAttribute=ff,o.Float32Attribute=cF,o.Float32BufferAttribute=xn,o.Float64Attribute=uF,o.Float64BufferAttribute=df,o.FloatType=vr,o.Fog=FA,o.FogExp2=kA,o.Font=fE,o.FontLoader=_y,o.FrontSide=T,o.Frustum=vf,o.GLBufferAttribute=Iy,o.GLSL1=sL,o.GLSL3=M0,o.GammaEncoding=Sp,o.GeometryUtils=yF,o.GreaterDepth=q,o.GreaterEqualDepth=j,o.GreaterEqualStencilFunc=JR,o.GreaterStencilFunc=ZR,o.GridHelper=IE,o.Group=Es,o.HalfFloatType=je,o.HemisphereLight=Pm,o.HemisphereLightHelper=Sk,o.HemisphereLightProbe=Sy,o.IcosahedronBufferGeometry=dm,o.IcosahedronGeometry=dm,o.ImageBitmapLoader=Ay,o.ImageLoader=Du,o.ImageUtils=oc,o.ImmediateRenderObject=jf,o.IncrementStencilOp=GR,o.IncrementWrapStencilOp=WR,o.InstancedBufferAttribute=Nm,o.InstancedBufferGeometry=Wf,o.InstancedInterleavedBuffer=Oy,o.InstancedMesh=em,o.Int16Attribute=aF,o.Int16BufferAttribute=uf,o.Int32Attribute=sF,o.Int32BufferAttribute=hf,o.Int8Attribute=nF,o.Int8BufferAttribute=sf,o.IntType=gi,o.InterleavedBuffer=Wa,o.InterleavedBufferAttribute=hl,o.Interpolant=ja,o.InterpolateDiscrete=Dr,o.InterpolateLinear=Vr,o.InterpolateSmooth=ir,o.InvertStencilOp=XR,o.JSONLoader=xF,o.KeepStencilOp=Cp,o.KeyframeTrack=Qi,o.LOD=Tf,o.LatheBufferGeometry=pm,o.LatheGeometry=pm,o.Layers=O0,o.LensFlare=AF,o.LessDepth=ye,o.LessEqualDepth=fe,o.LessEqualStencilFunc=KR,o.LessStencilFunc=YR,o.Light=di,o.LightProbe=so,o.Line=ao,o.Line3=CE,o.LineBasicMaterial=yi,o.LineCurve=Ia,o.LineCurve3=Mo,o.LineDashedMaterial=wc,o.LineLoop=nm,o.LinePieces=Gk,o.LineSegments=Aa,o.LineStrip=zk,o.LinearEncoding=xa,o.LinearFilter=Ft,o.LinearInterpolant=Hf,o.LinearMipMapLinearFilter=zn,o.LinearMipMapNearestFilter=Pn,o.LinearMipmapLinearFilter=In,o.LinearMipmapNearestFilter=$t,o.LinearToneMapping=Be,o.Loader=Jr,o.LoaderUtils=wy,o.LoadingManager=uy,o.LogLuvEncoding=zw,o.LoopOnce=Hn,o.LoopPingPong=Tr,o.LoopRepeat=nr,o.LuminanceAlphaFormat=Ye,o.LuminanceFormat=De,o.MOUSE=v,o.Material=Kn,o.MaterialLoader=Bm,o.Math=er,o.MathUtils=er,o.Matrix3=Ua,o.Matrix4=br,o.MaxEquation=W,o.Mesh=fi,o.MeshBasicMaterial=za,o.MeshDepthMaterial=cl,o.MeshDistanceMaterial=ul,o.MeshFaceMaterial=Xk,o.MeshLambertMaterial=bc,o.MeshMatcapMaterial=xc,o.MeshNormalMaterial=yc,o.MeshPhongMaterial=vl,o.MeshPhysicalMaterial=ml,o.MeshStandardMaterial=Xo,o.MeshToonMaterial=gc,o.MinEquation=U,o.MirroredRepeatWrapping=Tn,o.MixOperation=te,o.MultiMaterial=qk,o.MultiplyBlending=$,o.MultiplyOperation=ee,o.NearestFilter=Jt,o.NearestMipMapLinearFilter=Dt,o.NearestMipMapNearestFilter=mr,o.NearestMipmapLinearFilter=fr,o.NearestMipmapNearestFilter=Fn,o.NeverDepth=mt,o.NeverStencilFunc=qR,o.NoBlending=F,o.NoColors=Vk,o.NoToneMapping=ke,o.NormalAnimationBlendMode=ba,o.NormalBlending=X,o.NotEqualDepth=pe,o.NotEqualStencilFunc=QR,o.NumberKeyframeTrack=Lu,o.Object3D=Dn,o.ObjectLoader=ik,o.ObjectSpaceNormalMap=Ww,o.OctahedronBufferGeometry=Bf,o.OctahedronGeometry=Bf,o.OneFactor=oe,o.OneMinusDstAlphaFactor=Le,o.OneMinusDstColorFactor=Me,o.OneMinusSrcAlphaFactor=Ie,o.OneMinusSrcColorFactor=_e,o.OrthographicCamera=Iu,o.PCFShadowMap=M,o.PCFSoftShadowMap=S,o.PMREMGenerator=Fk,o.ParametricBufferGeometry=mc,o.ParametricGeometry=mc,o.Particle=$k,o.ParticleBasicMaterial=Qk,o.ParticleSystem=Kk,o.ParticleSystemMaterial=Jk,o.Path=Co,o.PerspectiveCamera=Mi,o.Plane=zo,o.PlaneBufferGeometry=gf,o.PlaneGeometry=gf,o.PlaneHelper=Pk,o.PointCloud=Yk,o.PointCloudMaterial=Zk,o.PointLight=Om,o.PointLightHelper=_k,o.Points=Mu,o.PointsMaterial=Ao,o.PolarGridHelper=Tk,o.PolyhedronBufferGeometry=dl,o.PolyhedronGeometry=dl,o.PositionalAudio=hk,o.PropertyBinding=oa,o.PropertyMixer=Ry,o.QuadraticBezierCurve=So,o.QuadraticBezierCurve3=Yo,o.Quaternion=Zi,o.QuaternionKeyframeTrack=zf,o.QuaternionLinearInterpolant=Mm,o.REVISION=f,o.RGBADepthPacking=Vw,o.RGBAFormat=pn,o.RGBAIntegerFormat=mn,o.RGBA_ASTC_10x10_Format=Et,o.RGBA_ASTC_10x5_Format=ft,o.RGBA_ASTC_10x6_Format=Ct,o.RGBA_ASTC_10x8_Format=Xt,o.RGBA_ASTC_12x10_Format=wt,o.RGBA_ASTC_12x12_Format=se,o.RGBA_ASTC_4x4_Format=$i,o.RGBA_ASTC_5x4_Format=qr,o.RGBA_ASTC_5x5_Format=Qr,o.RGBA_ASTC_6x5_Format=Z,o.RGBA_ASTC_6x6_Format=ie,o.RGBA_ASTC_8x5_Format=be,o.RGBA_ASTC_8x6_Format=Ae,o.RGBA_ASTC_8x8_Format=ze,o.RGBA_BPTC_Format=he,o.RGBA_ETC2_EAC_Format=ur,o.RGBA_PVRTC_2BPPV1_Format=Fi,o.RGBA_PVRTC_4BPPV1_Format=Nr,o.RGBA_S3TC_DXT1_Format=Cn,o.RGBA_S3TC_DXT3_Format=Gn,o.RGBA_S3TC_DXT5_Format=tr,o.RGBDEncoding=_0,o.RGBEEncoding=Tp,o.RGBEFormat=ct,o.RGBFormat=Sn,o.RGBIntegerFormat=Nt,o.RGBM16Encoding=E0,o.RGBM7Encoding=A0,o.RGB_ETC1_Format=Xn,o.RGB_ETC2_Format=dr,o.RGB_PVRTC_2BPPV1_Format=_r,o.RGB_PVRTC_4BPPV1_Format=Rn,o.RGB_S3TC_DXT1_Format=An,o.RGFormat=sn,o.RGIntegerFormat=jt,o.RawShaderMaterial=Ms,o.Ray=su,o.Raycaster=ky,o.RectAreaLight=Fm,o.RedFormat=zt,o.RedIntegerFormat=kt,o.ReinhardToneMapping=We,o.RepeatWrapping=rn,o.ReplaceStencilOp=zR,o.ReverseSubtractEquation=k,o.RingBufferGeometry=mm,o.RingGeometry=mm,o.SRGB8_ALPHA8_ASTC_10x10_Format=kn,o.SRGB8_ALPHA8_ASTC_10x5_Format=Qt,o.SRGB8_ALPHA8_ASTC_10x6_Format=on,o.SRGB8_ALPHA8_ASTC_10x8_Format=$n,o.SRGB8_ALPHA8_ASTC_12x10_Format=Un,o.SRGB8_ALPHA8_ASTC_12x12_Format=fn,o.SRGB8_ALPHA8_ASTC_4x4_Format=Te,o.SRGB8_ALPHA8_ASTC_5x4_Format=Pe,o.SRGB8_ALPHA8_ASTC_5x5_Format=Ce,o.SRGB8_ALPHA8_ASTC_6x5_Format=pt,o.SRGB8_ALPHA8_ASTC_6x6_Format=Rt,o.SRGB8_ALPHA8_ASTC_8x5_Format=Bt,o.SRGB8_ALPHA8_ASTC_8x6_Format=Kt,o.SRGB8_ALPHA8_ASTC_8x8_Format=hn,o.Scene=ey,o.SceneUtils=wF,o.ShaderChunk=Cr,o.ShaderLib=wo,o.ShaderMaterial=wa,o.ShadowMaterial=vc,o.Shape=yl,o.ShapeBufferGeometry=Nf,o.ShapeGeometry=Nf,o.ShapePath=Ey,o.ShapeUtils=_s,o.ShortType=Er,o.Skeleton=Lf,o.SkeletonHelper=LE,o.SkinnedMesh=Cf,o.SmoothShading=N,o.Sphere=nl,o.SphereBufferGeometry=Uf,o.SphereGeometry=Uf,o.Spherical=wk,o.SphericalHarmonics3=cE,o.Spline=Wy,o.SplineCurve=To,o.SplineCurve3=ZE,o.SpotLight=Dm,o.SpotLightHelper=Ek,o.Sprite=Sf,o.SpriteMaterial=fl,o.SrcAlphaFactor=Ne,o.SrcAlphaSaturateFactor=Qe,o.SrcColorFactor=ge,o.StaticCopyUsage=iL,o.StaticDrawUsage=tf,o.StaticReadUsage=tL,o.StereoCamera=mE,o.StreamCopyUsage=oL,o.StreamDrawUsage=eL,o.StreamReadUsage=rL,o.StringKeyframeTrack=Sm,o.SubtractEquation=I,o.SubtractiveBlending=ae,o.TOUCH=m,o.TangentSpaceNormalMap=ic,o.TetrahedronBufferGeometry=vm,o.TetrahedronGeometry=vm,o.TextBufferGeometry=gm,o.TextGeometry=gm,o.Texture=ii,o.TextureLoader=Rm,o.TorusBufferGeometry=ym,o.TorusGeometry=ym,o.TorusKnotBufferGeometry=bm,o.TorusKnotGeometry=bm,o.Triangle=Go,o.TriangleFanDrawMode=Li,o.TriangleStripDrawMode=rc,o.TrianglesDrawMode=Qs,o.TubeBufferGeometry=xm,o.TubeGeometry=xm,o.UVMapping=Ee,o.Uint16Attribute=oF,o.Uint16BufferAttribute=cc,o.Uint32Attribute=lF,o.Uint32BufferAttribute=uc,o.Uint8Attribute=rF,o.Uint8BufferAttribute=lf,o.Uint8ClampedAttribute=iF,o.Uint8ClampedBufferAttribute=cf,o.Uniform=EE,o.UniformsLib=ln,o.UniformsUtils=sA,o.UnsignedByteType=bn,o.UnsignedInt248Type=Gt,o.UnsignedIntType=Lr,o.UnsignedShort4444Type=_t,o.UnsignedShort5551Type=Ot,o.UnsignedShort565Type=At,o.UnsignedShortType=cr,o.VSMShadowMap=E,o.Vector2=Zt,o.Vector3=Ge,o.Vector4=Yr,o.VectorKeyframeTrack=Pu,o.Vertex=eF,o.VertexColors=jk,o.VideoTexture=iy,o.WebGL1Renderer=J0,o.WebGLCubeRenderTarget=$0,o.WebGLMultisampleRenderTarget=fL,o.WebGLRenderTarget=Js,o.WebGLRenderTargetCube=gF,o.WebGLRenderer=Af,o.WebGLUtils=LA,o.WireframeGeometry=cy,o.WireframeHelper=pF,o.WrapAroundEnding=ya,o.XHRLoader=mF,o.ZeroCurvatureEnding=ri,o.ZeroFactor=ce,o.ZeroSlopeEnding=Nn,o.ZeroStencilOp=HR,o.sRGBEncoding=ef,Object.defineProperty(o,"__esModule",{value:!0})})},{}],58:[function(r,a,s){THREE.DRACOLoader=function(o){THREE.Loader.call(this,o),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}},THREE.DRACOLoader.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:THREE.DRACOLoader,setDecoderPath:function(o){return this.decoderPath=o,this},setDecoderConfig:function(o){return this.decoderConfig=o,this},setWorkerLimit:function(o){return this.workerLimit=o,this},setVerbosity:function(){console.warn("THREE.DRACOLoader: The .setVerbosity() method has been removed.")},setDrawMode:function(){console.warn("THREE.DRACOLoader: The .setDrawMode() method has been removed.")},setSkipDequantization:function(){console.warn("THREE.DRACOLoader: The .setSkipDequantization() method has been removed.")},load:function(o,u,f,v){var m=new THREE.FileLoader(this.manager);m.setPath(this.path),m.setResponseType("arraybuffer"),m.setRequestHeader(this.requestHeader),m.setWithCredentials(this.withCredentials),m.load(o,g=>{var y={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(g,y).then(u).catch(v)},f,v)},decodeDracoFile:function(o,u,f,v){var m={attributeIDs:f||this.defaultAttributeIDs,attributeTypes:v||this.defaultAttributeTypes,useUniqueIDs:!!f};this.decodeGeometry(o,m).then(u)},decodeGeometry:function(o,u){for(var f in u.attributeTypes){var v=u.attributeTypes[f];v.BYTES_PER_ELEMENT!==void 0&&(u.attributeTypes[f]=v.name)}var m=JSON.stringify(u);if(THREE.DRACOLoader.taskCache.has(o)){var g=THREE.DRACOLoader.taskCache.get(o);if(g.key===m)return g.promise;if(o.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}var y,b=this.workerNextTaskID++,w=o.byteLength,A=this._getWorker(b,w).then(M=>(y=M,new Promise((S,E)=>{y._callbacks[b]={resolve:S,reject:E},y.postMessage({type:"decode",id:b,taskConfig:u,buffer:o},[o])}))).then(M=>this._createGeometry(M.geometry));return A.catch(()=>!0).then(()=>{y&&b&&this._releaseTask(y,b)}),THREE.DRACOLoader.taskCache.set(o,{key:m,promise:A}),A},_createGeometry:function(o){var u=new THREE.BufferGeometry;o.index&&u.setIndex(new THREE.BufferAttribute(o.index.array,1));for(var f=0;f<o.attributes.length;f++){var v=o.attributes[f],m=v.name,g=v.array,y=v.itemSize;u.setAttribute(m,new THREE.BufferAttribute(g,y))}return u},_loadLibrary:function(o,u){var f=new THREE.FileLoader(this.manager);return f.setPath(this.decoderPath),f.setResponseType(u),f.setWithCredentials(this.withCredentials),new Promise((v,m)=>{f.load(o,v,void 0,m)})},preload:function(){return this._initDecoder(),this},_initDecoder:function(){if(this.decoderPending)return this.decoderPending;var o=typeof WebAssembly!="object"||this.decoderConfig.type==="js",u=[];return o?u.push(this._loadLibrary("draco_decoder.js","text")):(u.push(this._loadLibrary("draco_wasm_wrapper.js","text")),u.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(u).then(f=>{var v=f[0];o||(this.decoderConfig.wasmBinary=f[1]);var m=THREE.DRACOLoader.DRACOWorker.toString(),g=["/* draco decoder */",v,"","/* worker */",m.substring(m.indexOf("{")+1,m.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([g]))}),this.decoderPending},_getWorker:function(o,u){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){var f=new Worker(this.workerSourceURL);f._callbacks={},f._taskCosts={},f._taskLoad=0,f.postMessage({type:"init",decoderConfig:this.decoderConfig}),f.onmessage=function(m){var g=m.data;switch(g.type){case"decode":f._callbacks[g.id].resolve(g);break;case"error":f._callbacks[g.id].reject(g);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+g.type+'"')}},this.workerPool.push(f)}else this.workerPool.sort(function(v,m){return v._taskLoad>m._taskLoad?-1:1});var f=this.workerPool[this.workerPool.length-1];return f._taskCosts[o]=u,f._taskLoad+=u,f})},_releaseTask:function(o,u){o._taskLoad-=o._taskCosts[u],delete o._callbacks[u],delete o._taskCosts[u]},debug:function(){console.log("Task load: ",this.workerPool.map(o=>o._taskLoad))},dispose:function(){for(var o=0;o<this.workerPool.length;++o)this.workerPool[o].terminate();return this.workerPool.length=0,this}}),THREE.DRACOLoader.DRACOWorker=function(){var o,u;onmessage=function(y){var b=y.data;switch(b.type){case"init":o=b.decoderConfig,u=new Promise(function(M){o.onModuleLoaded=function(S){M({draco:S})},DracoDecoderModule(o)});break;case"decode":var w=b.buffer,A=b.taskConfig;u.then(M=>{var S=M.draco,E=new S.Decoder,T=new S.DecoderBuffer;T.Init(new Int8Array(w),w.byteLength);try{var C=f(S,E,T,A),L=C.attributes.map(P=>P.array.buffer);C.index&&L.push(C.index.array.buffer),self.postMessage({type:"decode",id:b.id,geometry:C},L)}catch(P){console.error(P),self.postMessage({type:"error",id:b.id,error:P.message})}finally{S.destroy(T),S.destroy(E)}});break}};function f(y,b,w,A){var M=A.attributeIDs,S=A.attributeTypes,E,T,C=b.GetEncodedGeometryType(w);if(C===y.TRIANGULAR_MESH)E=new y.Mesh,T=b.DecodeBufferToMesh(w,E);else if(C===y.POINT_CLOUD)E=new y.PointCloud,T=b.DecodeBufferToPointCloud(w,E);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!T.ok()||E.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+T.error_msg());var L={index:null,attributes:[]};for(var P in M){var N=self[S[P]],F,X;if(A.useUniqueIDs)X=M[P],F=b.GetAttributeByUniqueId(E,X);else{if(X=b.GetAttributeId(E,y[M[P]]),X===-1)continue;F=b.GetAttribute(E,X)}L.attributes.push(m(y,b,E,P,N,F))}return C===y.TRIANGULAR_MESH&&(L.index=v(y,b,E)),y.destroy(E),L}function v(y,b,w){var A=w.num_faces(),M=A*3,S=M*4,E=y._malloc(S);b.GetTrianglesUInt32Array(w,S,E);var T=new Uint32Array(y.HEAPF32.buffer,E,M).slice();return y._free(E),{array:T,itemSize:1}}function m(y,b,w,A,M,S){var E=S.num_components(),T=w.num_points(),C=T*E,L=C*M.BYTES_PER_ELEMENT,P=g(y,M),N=y._malloc(L);b.GetAttributeDataArrayForAllPoints(w,S,P,L,N);var F=new M(y.HEAPF32.buffer,N,C).slice();return y._free(N),{name:A,array:F,itemSize:E}}function g(y,b){switch(b){case Float32Array:return y.DT_FLOAT32;case Int8Array:return y.DT_INT8;case Int16Array:return y.DT_INT16;case Int32Array:return y.DT_INT32;case Uint8Array:return y.DT_UINT8;case Uint16Array:return y.DT_UINT16;case Uint32Array:return y.DT_UINT32}}},THREE.DRACOLoader.taskCache=new WeakMap,THREE.DRACOLoader.setDecoderPath=function(){console.warn("THREE.DRACOLoader: The .setDecoderPath() method has been removed. Use instance methods.")},THREE.DRACOLoader.setDecoderConfig=function(){console.warn("THREE.DRACOLoader: The .setDecoderConfig() method has been removed. Use instance methods.")},THREE.DRACOLoader.releaseDecoderModule=function(){console.warn("THREE.DRACOLoader: The .releaseDecoderModule() method has been removed. Use instance methods.")},THREE.DRACOLoader.getDecoderModule=function(){console.warn("THREE.DRACOLoader: The .getDecoderModule() method has been removed. Use instance methods.")}},{}],59:[function(r,a,s){THREE.GLTFLoader=function(){function o(ye){THREE.Loader.call(this,ye),this.dracoLoader=null,this.ddsLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(fe){return new y(fe)}),this.register(function(fe){return new w(fe)}),this.register(function(fe){return new A(fe)}),this.register(function(fe){return new b(fe)}),this.register(function(fe){return new m(fe)}),this.register(function(fe){return new M(fe)})}o.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:o,load:function(ye,fe,H,j){var q=this,pe;this.resourcePath!==""?pe=this.resourcePath:this.path!==""?pe=this.path:pe=THREE.LoaderUtils.extractUrlBase(ye),this.manager.itemStart(ye);var ee=function(Se){j?j(Se):console.error(Se),q.manager.itemError(ye),q.manager.itemEnd(ye)},te=new THREE.FileLoader(this.manager);te.setPath(this.path),te.setResponseType("arraybuffer"),te.setRequestHeader(this.requestHeader),te.setWithCredentials(this.withCredentials),te.load(ye,function(Se){try{q.parse(Se,pe,function(ke){fe(ke),q.manager.itemEnd(ye)},ee)}catch(ke){ee(ke)}},H,ee)},setDRACOLoader:function(ye){return this.dracoLoader=ye,this},setDDSLoader:function(ye){return this.ddsLoader=ye,this},setKTX2Loader:function(ye){return this.ktx2Loader=ye,this},setMeshoptDecoder:function(ye){return this.meshoptDecoder=ye,this},register:function(ye){return this.pluginCallbacks.indexOf(ye)===-1&&this.pluginCallbacks.push(ye),this},unregister:function(ye){return this.pluginCallbacks.indexOf(ye)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(ye),1),this},parse:function(ye,fe,H,j){var q,pe={},ee={};if(typeof ye=="string")q=ye;else{var te=THREE.LoaderUtils.decodeText(new Uint8Array(ye,0,4));if(te===S){try{pe[f.KHR_BINARY_GLTF]=new C(ye)}catch(J){j&&j(J);return}q=pe[f.KHR_BINARY_GLTF].content}else q=THREE.LoaderUtils.decodeText(new Uint8Array(ye))}var Se=JSON.parse(q);if(Se.asset===void 0||Se.asset.version[0]<2){j&&j(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}var ke=new Me(Se,{path:fe||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});ke.fileLoader.setRequestHeader(this.requestHeader);for(var Be=0;Be<this.pluginCallbacks.length;Be++){var We=this.pluginCallbacks[Be](ke);ee[We.name]=We,pe[We.name]=!0}if(Se.extensionsUsed)for(var Be=0;Be<Se.extensionsUsed.length;++Be){var ve=Se.extensionsUsed[Be],K=Se.extensionsRequired||[];switch(ve){case f.KHR_MATERIALS_UNLIT:pe[ve]=new g;break;case f.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:pe[ve]=new F;break;case f.KHR_DRACO_MESH_COMPRESSION:pe[ve]=new L(Se,this.dracoLoader);break;case f.MSFT_TEXTURE_DDS:pe[ve]=new v(this.ddsLoader);break;case f.KHR_TEXTURE_TRANSFORM:pe[ve]=new P;break;case f.KHR_MESH_QUANTIZATION:pe[ve]=new X;break;default:K.indexOf(ve)>=0&&ee[ve]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+ve+'".')}}ke.setExtensions(pe),ke.setPlugins(ee),ke.parse(H,j)}});function u(){var ye={};return{get:function(fe){return ye[fe]},add:function(fe,H){ye[fe]=H},remove:function(fe){delete ye[fe]},removeAll:function(){ye={}}}}var f={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function v(ye){if(!ye)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing THREE.DDSLoader");this.name=f.MSFT_TEXTURE_DDS,this.ddsLoader=ye}function m(ye){this.parser=ye,this.name=f.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}m.prototype._markDefs=function(){for(var ye=this.parser,fe=this.parser.json.nodes||[],H=0,j=fe.length;H<j;H++){var q=fe[H];q.extensions&&q.extensions[this.name]&&q.extensions[this.name].light!==void 0&&ye._addNodeRef(this.cache,q.extensions[this.name].light)}},m.prototype._loadLight=function(ye){var fe=this.parser,H="light:"+ye,j=fe.cache.get(H);if(j)return j;var q=fe.json,pe=q.extensions&&q.extensions[this.name]||{},ee=pe.lights||[],te=ee[ye],Se,ke=new THREE.Color(16777215);te.color!==void 0&&ke.fromArray(te.color);var Be=te.range!==void 0?te.range:0;switch(te.type){case"directional":Se=new THREE.DirectionalLight(ke),Se.target.position.set(0,0,-1),Se.add(Se.target);break;case"point":Se=new THREE.PointLight(ke),Se.distance=Be;break;case"spot":Se=new THREE.SpotLight(ke),Se.distance=Be,te.spot=te.spot||{},te.spot.innerConeAngle=te.spot.innerConeAngle!==void 0?te.spot.innerConeAngle:0,te.spot.outerConeAngle=te.spot.outerConeAngle!==void 0?te.spot.outerConeAngle:Math.PI/4,Se.angle=te.spot.outerConeAngle,Se.penumbra=1-te.spot.innerConeAngle/te.spot.outerConeAngle,Se.target.position.set(0,0,-1),Se.add(Se.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+te.type)}return Se.position.set(0,0,0),Se.decay=2,te.intensity!==void 0&&(Se.intensity=te.intensity),Se.name=fe.createUniqueName(te.name||"light_"+ye),j=Promise.resolve(Se),fe.cache.add(H,j),j},m.prototype.createNodeAttachment=function(ye){var fe=this,H=this.parser,j=H.json,q=j.nodes[ye],pe=q.extensions&&q.extensions[this.name]||{},ee=pe.light;return ee===void 0?null:this._loadLight(ee).then(function(te){return H._getNodeRef(fe.cache,ee,te)})};function g(){this.name=f.KHR_MATERIALS_UNLIT}g.prototype.getMaterialType=function(){return THREE.MeshBasicMaterial},g.prototype.extendParams=function(ye,fe,H){var j=[];ye.color=new THREE.Color(1,1,1),ye.opacity=1;var q=fe.pbrMetallicRoughness;if(q){if(Array.isArray(q.baseColorFactor)){var pe=q.baseColorFactor;ye.color.fromArray(pe),ye.opacity=pe[3]}q.baseColorTexture!==void 0&&j.push(H.assignTexture(ye,"map",q.baseColorTexture))}return Promise.all(j)};function y(ye){this.parser=ye,this.name=f.KHR_MATERIALS_CLEARCOAT}y.prototype.getMaterialType=function(ye){var fe=this.parser,H=fe.json.materials[ye];return!H.extensions||!H.extensions[this.name]?null:THREE.MeshPhysicalMaterial},y.prototype.extendMaterialParams=function(ye,fe){var H=this.parser,j=H.json.materials[ye];if(!j.extensions||!j.extensions[this.name])return Promise.resolve();var q=[],pe=j.extensions[this.name];if(pe.clearcoatFactor!==void 0&&(fe.clearcoat=pe.clearcoatFactor),pe.clearcoatTexture!==void 0&&q.push(H.assignTexture(fe,"clearcoatMap",pe.clearcoatTexture)),pe.clearcoatRoughnessFactor!==void 0&&(fe.clearcoatRoughness=pe.clearcoatRoughnessFactor),pe.clearcoatRoughnessTexture!==void 0&&q.push(H.assignTexture(fe,"clearcoatRoughnessMap",pe.clearcoatRoughnessTexture)),pe.clearcoatNormalTexture!==void 0&&(q.push(H.assignTexture(fe,"clearcoatNormalMap",pe.clearcoatNormalTexture)),pe.clearcoatNormalTexture.scale!==void 0)){var ee=pe.clearcoatNormalTexture.scale;fe.clearcoatNormalScale=new THREE.Vector2(ee,-ee)}return Promise.all(q)};function b(ye){this.parser=ye,this.name=f.KHR_MATERIALS_TRANSMISSION}b.prototype.getMaterialType=function(ye){var fe=this.parser,H=fe.json.materials[ye];return!H.extensions||!H.extensions[this.name]?null:THREE.MeshPhysicalMaterial},b.prototype.extendMaterialParams=function(ye,fe){var H=this.parser,j=H.json.materials[ye];if(!j.extensions||!j.extensions[this.name])return Promise.resolve();var q=[],pe=j.extensions[this.name];return pe.transmissionFactor!==void 0&&(fe.transmission=pe.transmissionFactor),pe.transmissionTexture!==void 0&&q.push(H.assignTexture(fe,"transmissionMap",pe.transmissionTexture)),Promise.all(q)};function w(ye){this.parser=ye,this.name=f.KHR_TEXTURE_BASISU}w.prototype.loadTexture=function(ye){var fe=this.parser,H=fe.json,j=H.textures[ye];if(!j.extensions||!j.extensions[this.name])return null;var q=j.extensions[this.name],pe=H.images[q.source],ee=fe.options.ktx2Loader;if(!ee){if(H.extensionsRequired&&H.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return fe.loadTextureImage(ye,pe,ee)};function A(ye){this.parser=ye,this.name=f.EXT_TEXTURE_WEBP,this.isSupported=null}A.prototype.loadTexture=function(ye){var fe=this.name,H=this.parser,j=H.json,q=j.textures[ye];if(!q.extensions||!q.extensions[fe])return null;var pe=q.extensions[fe],ee=j.images[pe.source],te=ee.uri?H.options.manager.getHandler(ee.uri):H.textureLoader;return this.detectSupport().then(function(Se){if(Se)return H.loadTextureImage(ye,ee,te);if(j.extensionsRequired&&j.extensionsRequired.indexOf(fe)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return H.loadTexture(ye)})},A.prototype.detectSupport=function(){return this.isSupported||(this.isSupported=new Promise(function(ye){var fe=new Image;fe.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",fe.onload=fe.onerror=function(){ye(fe.height===1)}})),this.isSupported};function M(ye){this.name=f.EXT_MESHOPT_COMPRESSION,this.parser=ye}M.prototype.loadBufferView=function(ye){var fe=this.parser.json,H=fe.bufferViews[ye];if(H.extensions&&H.extensions[this.name]){var j=H.extensions[this.name],q=this.parser.getDependency("buffer",j.buffer),pe=this.parser.options.meshoptDecoder;if(!pe||!pe.supported){if(fe.extensionsRequired&&fe.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([q,pe.ready]).then(function(ee){var te=j.byteOffset||0,Se=j.byteLength||0,ke=j.count,Be=j.byteStride,We=new ArrayBuffer(ke*Be),ve=new Uint8Array(ee[0],te,Se);return pe.decodeGltfBuffer(new Uint8Array(We),ke,Be,ve,j.mode,j.filter),We})}else return null};var S="glTF",E=12,T={JSON:1313821514,BIN:5130562};function C(ye){this.name=f.KHR_BINARY_GLTF,this.content=null,this.body=null;var fe=new DataView(ye,0,E);if(this.header={magic:THREE.LoaderUtils.decodeText(new Uint8Array(ye.slice(0,4))),version:fe.getUint32(4,!0),length:fe.getUint32(8,!0)},this.header.magic!==S)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var H=this.header.length-E,j=new DataView(ye,E),q=0;q<H;){var pe=j.getUint32(q,!0);q+=4;var ee=j.getUint32(q,!0);if(q+=4,ee===T.JSON){var te=new Uint8Array(ye,E+q,pe);this.content=THREE.LoaderUtils.decodeText(te)}else if(ee===T.BIN){var Se=E+q;this.body=ye.slice(Se,Se+pe)}q+=pe}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}function L(ye,fe){if(!fe)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=f.KHR_DRACO_MESH_COMPRESSION,this.json=ye,this.dracoLoader=fe,this.dracoLoader.preload()}L.prototype.decodePrimitive=function(ye,fe){var H=this.json,j=this.dracoLoader,q=ye.extensions[this.name].bufferView,pe=ye.extensions[this.name].attributes,ee={},te={},Se={};for(var ke in pe){var Be=k[ke]||ke.toLowerCase();ee[Be]=pe[ke]}for(ke in ye.attributes){var Be=k[ke]||ke.toLowerCase();if(pe[ke]!==void 0){var We=H.accessors[ye.attributes[ke]],ve=$[We.componentType];Se[Be]=ve,te[Be]=We.normalized===!0}}return fe.getDependency("bufferView",q).then(function(K){return new Promise(function(J){j.decodeDracoFile(K,function(Ee){for(var xe in Ee.attributes){var Je=Ee.attributes[xe],Xe=te[xe];Xe!==void 0&&(Je.normalized=Xe)}J(Ee)},ee,Se)})})};function P(){this.name=f.KHR_TEXTURE_TRANSFORM}P.prototype.extendTexture=function(ye,fe){return ye=ye.clone(),fe.offset!==void 0&&ye.offset.fromArray(fe.offset),fe.rotation!==void 0&&(ye.rotation=fe.rotation),fe.scale!==void 0&&ye.repeat.fromArray(fe.scale),fe.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),ye.needsUpdate=!0,ye};function N(ye){THREE.MeshStandardMaterial.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var fe=["#ifdef USE_SPECULARMAP","	uniform sampler2D specularMap;","#endif"].join(`
`),H=["#ifdef USE_GLOSSINESSMAP","	uniform sampler2D glossinessMap;","#endif"].join(`
`),j=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","	vec4 texelSpecular = texture2D( specularMap, vUv );","	texelSpecular = sRGBToLinear( texelSpecular );","	// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","	specularFactor *= texelSpecular.rgb;","#endif"].join(`
`),q=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","	vec4 texelGlossiness = texture2D( glossinessMap, vUv );","	// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","	glossinessFactor *= texelGlossiness.a;","#endif"].join(`
`),pe=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor;"].join(`
`),ee={specular:{value:new THREE.Color().setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=ee,this.onBeforeCompile=function(te){for(var Se in ee)te.uniforms[Se]=ee[Se];te.fragmentShader=te.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",fe).replace("#include <metalnessmap_pars_fragment>",H).replace("#include <roughnessmap_fragment>",j).replace("#include <metalnessmap_fragment>",q).replace("#include <lights_physical_fragment>",pe)},Object.defineProperties(this,{specular:{get:function(){return ee.specular.value},set:function(te){ee.specular.value=te}},specularMap:{get:function(){return ee.specularMap.value},set:function(te){ee.specularMap.value=te,te?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return ee.glossiness.value},set:function(te){ee.glossiness.value=te}},glossinessMap:{get:function(){return ee.glossinessMap.value},set:function(te){ee.glossinessMap.value=te,te?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(ye)}N.prototype=Object.create(THREE.MeshStandardMaterial.prototype),N.prototype.constructor=N,N.prototype.copy=function(ye){return THREE.MeshStandardMaterial.prototype.copy.call(this,ye),this.specularMap=ye.specularMap,this.specular.copy(ye.specular),this.glossinessMap=ye.glossinessMap,this.glossiness=ye.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this};function F(){return{name:f.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return N},extendParams:function(ye,fe,H){var j=fe.extensions[this.name];ye.color=new THREE.Color(1,1,1),ye.opacity=1;var q=[];if(Array.isArray(j.diffuseFactor)){var pe=j.diffuseFactor;ye.color.fromArray(pe),ye.opacity=pe[3]}if(j.diffuseTexture!==void 0&&q.push(H.assignTexture(ye,"map",j.diffuseTexture)),ye.emissive=new THREE.Color(0,0,0),ye.glossiness=j.glossinessFactor!==void 0?j.glossinessFactor:1,ye.specular=new THREE.Color(1,1,1),Array.isArray(j.specularFactor)&&ye.specular.fromArray(j.specularFactor),j.specularGlossinessTexture!==void 0){var ee=j.specularGlossinessTexture;q.push(H.assignTexture(ye,"glossinessMap",ee)),q.push(H.assignTexture(ye,"specularMap",ee))}return Promise.all(q)},createMaterial:function(ye){var fe=new N(ye);return fe.fog=!0,fe.color=ye.color,fe.map=ye.map===void 0?null:ye.map,fe.lightMap=null,fe.lightMapIntensity=1,fe.aoMap=ye.aoMap===void 0?null:ye.aoMap,fe.aoMapIntensity=1,fe.emissive=ye.emissive,fe.emissiveIntensity=1,fe.emissiveMap=ye.emissiveMap===void 0?null:ye.emissiveMap,fe.bumpMap=ye.bumpMap===void 0?null:ye.bumpMap,fe.bumpScale=1,fe.normalMap=ye.normalMap===void 0?null:ye.normalMap,fe.normalMapType=THREE.TangentSpaceNormalMap,ye.normalScale&&(fe.normalScale=ye.normalScale),fe.displacementMap=null,fe.displacementScale=1,fe.displacementBias=0,fe.specularMap=ye.specularMap===void 0?null:ye.specularMap,fe.specular=ye.specular,fe.glossinessMap=ye.glossinessMap===void 0?null:ye.glossinessMap,fe.glossiness=ye.glossiness,fe.alphaMap=null,fe.envMap=ye.envMap===void 0?null:ye.envMap,fe.envMapIntensity=1,fe.refractionRatio=.98,fe}}}function X(){this.name=f.KHR_MESH_QUANTIZATION}function Y(ye,fe,H,j){THREE.Interpolant.call(this,ye,fe,H,j)}Y.prototype=Object.create(THREE.Interpolant.prototype),Y.prototype.constructor=Y,Y.prototype.copySampleValue_=function(ye){for(var fe=this.resultBuffer,H=this.sampleValues,j=this.valueSize,q=ye*j*3+j,pe=0;pe!==j;pe++)fe[pe]=H[q+pe];return fe},Y.prototype.beforeStart_=Y.prototype.copySampleValue_,Y.prototype.afterEnd_=Y.prototype.copySampleValue_,Y.prototype.interpolate_=function(ye,fe,H,j){for(var q=this.resultBuffer,pe=this.sampleValues,ee=this.valueSize,te=ee*2,Se=ee*3,ke=j-fe,Be=(H-fe)/ke,We=Be*Be,ve=We*Be,K=ye*Se,J=K-Se,Ee=-2*ve+3*We,xe=ve-We,Je=1-Ee,Xe=xe-We+Be,Mt=0;Mt!==ee;Mt++){var qe=pe[J+Mt+ee],It=pe[J+Mt+te]*ke,rn=pe[K+Mt+ee],Yt=pe[K+Mt]*ke;q[Mt]=Je*qe+Xe*It+Ee*rn+xe*Yt}return q};var ae={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},$={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},de={9728:THREE.NearestFilter,9729:THREE.LinearFilter,9984:THREE.NearestMipmapNearestFilter,9985:THREE.LinearMipmapNearestFilter,9986:THREE.NearestMipmapLinearFilter,9987:THREE.LinearMipmapLinearFilter},D={33071:THREE.ClampToEdgeWrapping,33648:THREE.MirroredRepeatWrapping,10497:THREE.RepeatWrapping},I={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},k={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},U={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},W={CUBICSPLINE:void 0,LINEAR:THREE.InterpolateLinear,STEP:THREE.InterpolateDiscrete},ce={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function oe(ye,fe){return typeof ye!="string"||ye===""?"":(/^https?:\/\//i.test(fe)&&/^\//.test(ye)&&(fe=fe.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(ye)||/^data:.*,.*$/i.test(ye)||/^blob:.*$/i.test(ye)?ye:fe+ye)}function ge(ye){return ye.DefaultMaterial===void 0&&(ye.DefaultMaterial=new THREE.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:THREE.FrontSide})),ye.DefaultMaterial}function _e(ye,fe,H){for(var j in H.extensions)ye[j]===void 0&&(fe.userData.gltfExtensions=fe.userData.gltfExtensions||{},fe.userData.gltfExtensions[j]=H.extensions[j])}function Ne(ye,fe){fe.extras!==void 0&&(typeof fe.extras=="object"?Object.assign(ye.userData,fe.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+fe.extras))}function Ie(ye,fe,H){for(var j=!1,q=!1,pe=0,ee=fe.length;pe<ee;pe++){var te=fe[pe];if(te.POSITION!==void 0&&(j=!0),te.NORMAL!==void 0&&(q=!0),j&&q)break}if(!j&&!q)return Promise.resolve(ye);for(var Se=[],ke=[],pe=0,ee=fe.length;pe<ee;pe++){var te=fe[pe];if(j){var Be=te.POSITION!==void 0?H.getDependency("accessor",te.POSITION):ye.attributes.position;Se.push(Be)}if(q){var Be=te.NORMAL!==void 0?H.getDependency("accessor",te.NORMAL):ye.attributes.normal;ke.push(Be)}}return Promise.all([Promise.all(Se),Promise.all(ke)]).then(function(We){var ve=We[0],K=We[1];return j&&(ye.morphAttributes.position=ve),q&&(ye.morphAttributes.normal=K),ye.morphTargetsRelative=!0,ye})}function Ve(ye,fe){if(ye.updateMorphTargets(),fe.weights!==void 0)for(var H=0,j=fe.weights.length;H<j;H++)ye.morphTargetInfluences[H]=fe.weights[H];if(fe.extras&&Array.isArray(fe.extras.targetNames)){var q=fe.extras.targetNames;if(ye.morphTargetInfluences.length===q.length){ye.morphTargetDictionary={};for(var H=0,j=q.length;H<j;H++)ye.morphTargetDictionary[q[H]]=H}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Le(ye){var fe=ye.extensions&&ye.extensions[f.KHR_DRACO_MESH_COMPRESSION],H;return fe?H="draco:"+fe.bufferView+":"+fe.indices+":"+Fe(fe.attributes):H=ye.indices+":"+Fe(ye.attributes)+":"+ye.mode,H}function Fe(ye){for(var fe="",H=Object.keys(ye).sort(),j=0,q=H.length;j<q;j++)fe+=H[j]+":"+ye[H[j]]+";";return fe}function Me(ye,fe){this.json=ye||{},this.extensions={},this.plugins={},this.options=fe||{},this.cache=new u,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.nodeNamesUsed={},typeof createImageBitmap!="undefined"&&/Firefox/.test(navigator.userAgent)===!1?this.textureLoader=new THREE.ImageBitmapLoader(this.options.manager):this.textureLoader=new THREE.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new THREE.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}Me.prototype.setExtensions=function(ye){this.extensions=ye},Me.prototype.setPlugins=function(ye){this.plugins=ye},Me.prototype.parse=function(ye,fe){var H=this,j=this.json,q=this.extensions;this.cache.removeAll(),this._invokeAll(function(pe){return pe._markDefs&&pe._markDefs()}),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then(function(pe){var ee={scene:pe[0][j.scene||0],scenes:pe[0],animations:pe[1],cameras:pe[2],asset:j.asset,parser:H,userData:{}};_e(q,ee,j),Ne(ee,j),ye(ee)}).catch(fe)},Me.prototype._markDefs=function(){for(var ye=this.json.nodes||[],fe=this.json.skins||[],H=this.json.meshes||[],j=0,q=fe.length;j<q;j++)for(var pe=fe[j].joints,ee=0,te=pe.length;ee<te;ee++)ye[pe[ee]].isBone=!0;for(var Se=0,ke=ye.length;Se<ke;Se++){var Be=ye[Se];Be.mesh!==void 0&&(this._addNodeRef(this.meshCache,Be.mesh),Be.skin!==void 0&&(H[Be.mesh].isSkinnedMesh=!0)),Be.camera!==void 0&&this._addNodeRef(this.cameraCache,Be.camera)}},Me.prototype._addNodeRef=function(ye,fe){fe!==void 0&&(ye.refs[fe]===void 0&&(ye.refs[fe]=ye.uses[fe]=0),ye.refs[fe]++)},Me.prototype._getNodeRef=function(ye,fe,H){if(ye.refs[fe]<=1)return H;var j=H.clone();return j.name+="_instance_"+ye.uses[fe]++,j},Me.prototype._invokeOne=function(ye){var fe=Object.values(this.plugins);fe.push(this);for(var H=0;H<fe.length;H++){var j=ye(fe[H]);if(j)return j}},Me.prototype._invokeAll=function(ye){var fe=Object.values(this.plugins);fe.unshift(this);for(var H=[],j=0;j<fe.length;j++){var q=ye(fe[j]);q&&H.push(q)}return H},Me.prototype.getDependency=function(ye,fe){var H=ye+":"+fe,j=this.cache.get(H);if(!j){switch(ye){case"scene":j=this.loadScene(fe);break;case"node":j=this.loadNode(fe);break;case"mesh":j=this._invokeOne(function(q){return q.loadMesh&&q.loadMesh(fe)});break;case"accessor":j=this.loadAccessor(fe);break;case"bufferView":j=this._invokeOne(function(q){return q.loadBufferView&&q.loadBufferView(fe)});break;case"buffer":j=this.loadBuffer(fe);break;case"material":j=this._invokeOne(function(q){return q.loadMaterial&&q.loadMaterial(fe)});break;case"texture":j=this._invokeOne(function(q){return q.loadTexture&&q.loadTexture(fe)});break;case"skin":j=this.loadSkin(fe);break;case"animation":j=this.loadAnimation(fe);break;case"camera":j=this.loadCamera(fe);break;default:throw new Error("Unknown type: "+ye)}this.cache.add(H,j)}return j},Me.prototype.getDependencies=function(ye){var fe=this.cache.get(ye);if(!fe){var H=this,j=this.json[ye+(ye==="mesh"?"es":"s")]||[];fe=Promise.all(j.map(function(q,pe){return H.getDependency(ye,pe)})),this.cache.add(ye,fe)}return fe},Me.prototype.loadBuffer=function(ye){var fe=this.json.buffers[ye],H=this.fileLoader;if(fe.type&&fe.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+fe.type+" buffer type is not supported.");if(fe.uri===void 0&&ye===0)return Promise.resolve(this.extensions[f.KHR_BINARY_GLTF].body);var j=this.options;return new Promise(function(q,pe){H.load(oe(fe.uri,j.path),q,void 0,function(){pe(new Error('THREE.GLTFLoader: Failed to load buffer "'+fe.uri+'".'))})})},Me.prototype.loadBufferView=function(ye){var fe=this.json.bufferViews[ye];return this.getDependency("buffer",fe.buffer).then(function(H){var j=fe.byteLength||0,q=fe.byteOffset||0;return H.slice(q,q+j)})},Me.prototype.loadAccessor=function(ye){var fe=this,H=this.json,j=this.json.accessors[ye];if(j.bufferView===void 0&&j.sparse===void 0)return Promise.resolve(null);var q=[];return j.bufferView!==void 0?q.push(this.getDependency("bufferView",j.bufferView)):q.push(null),j.sparse!==void 0&&(q.push(this.getDependency("bufferView",j.sparse.indices.bufferView)),q.push(this.getDependency("bufferView",j.sparse.values.bufferView))),Promise.all(q).then(function(pe){var ee=pe[0],te=I[j.type],Se=$[j.componentType],ke=Se.BYTES_PER_ELEMENT,Be=ke*te,We=j.byteOffset||0,ve=j.bufferView!==void 0?H.bufferViews[j.bufferView].byteStride:void 0,K=j.normalized===!0,J,Ee;if(ve&&ve!==Be){var xe=Math.floor(We/ve),Je="InterleavedBuffer:"+j.bufferView+":"+j.componentType+":"+xe+":"+j.count,Xe=fe.cache.get(Je);Xe||(J=new Se(ee,xe*ve,j.count*ve/ke),Xe=new THREE.InterleavedBuffer(J,ve/ke),fe.cache.add(Je,Xe)),Ee=new THREE.InterleavedBufferAttribute(Xe,te,We%ve/ke,K)}else ee===null?J=new Se(j.count*te):J=new Se(ee,We,j.count*te),Ee=new THREE.BufferAttribute(J,te,K);if(j.sparse!==void 0){var Mt=I.SCALAR,qe=$[j.sparse.indices.componentType],It=j.sparse.indices.byteOffset||0,rn=j.sparse.values.byteOffset||0,Yt=new qe(pe[1],It,j.sparse.count*Mt),Tn=new Se(pe[2],rn,j.sparse.count*te);ee!==null&&(Ee=new THREE.BufferAttribute(Ee.array.slice(),Ee.itemSize,Ee.normalized));for(var Jt=0,Fn=Yt.length;Jt<Fn;Jt++){var mr=Yt[Jt];if(Ee.setX(mr,Tn[Jt*te]),te>=2&&Ee.setY(mr,Tn[Jt*te+1]),te>=3&&Ee.setZ(mr,Tn[Jt*te+2]),te>=4&&Ee.setW(mr,Tn[Jt*te+3]),te>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return Ee})},Me.prototype.loadTexture=function(ye){var fe=this,H=this.json,j=this.options,q=H.textures[ye],pe=q.extensions||{},ee;pe[f.MSFT_TEXTURE_DDS]?ee=H.images[pe[f.MSFT_TEXTURE_DDS].source]:ee=H.images[q.source];var te;return ee.uri&&(te=j.manager.getHandler(ee.uri)),te||(te=pe[f.MSFT_TEXTURE_DDS]?fe.extensions[f.MSFT_TEXTURE_DDS].ddsLoader:this.textureLoader),this.loadTextureImage(ye,ee,te)},Me.prototype.loadTextureImage=function(ye,fe,H){var j=this,q=this.json,pe=this.options,ee=q.textures[ye],te=self.URL||self.webkitURL,Se=fe.uri,ke=!1,Be=!0;return fe.mimeType==="image/jpeg"&&(Be=!1),fe.bufferView!==void 0&&(Se=j.getDependency("bufferView",fe.bufferView).then(function(We){if(fe.mimeType==="image/png"){var ve=new DataView(We,25,1).getUint8(0,!1);Be=ve===6||ve===4||ve===3}ke=!0;var K=new Blob([We],{type:fe.mimeType});return Se=te.createObjectURL(K),Se})),Promise.resolve(Se).then(function(We){return new Promise(function(ve,K){var J=ve;H.isImageBitmapLoader===!0&&(J=function(Ee){ve(new THREE.CanvasTexture(Ee))}),H.load(oe(We,pe.path),J,void 0,K)})}).then(function(We){ke===!0&&te.revokeObjectURL(Se),We.flipY=!1,ee.name&&(We.name=ee.name),Be||(We.format=THREE.RGBFormat);var ve=q.samplers||{},K=ve[ee.sampler]||{};return We.magFilter=de[K.magFilter]||THREE.LinearFilter,We.minFilter=de[K.minFilter]||THREE.LinearMipmapLinearFilter,We.wrapS=D[K.wrapS]||THREE.RepeatWrapping,We.wrapT=D[K.wrapT]||THREE.RepeatWrapping,j.associations.set(We,{type:"textures",index:ye}),We})},Me.prototype.assignTexture=function(ye,fe,H){var j=this;return this.getDependency("texture",H.index).then(function(q){if(H.texCoord!==void 0&&H.texCoord!=0&&!(fe==="aoMap"&&H.texCoord==1)&&console.warn("THREE.GLTFLoader: Custom UV set "+H.texCoord+" for texture "+fe+" not yet supported."),j.extensions[f.KHR_TEXTURE_TRANSFORM]){var pe=H.extensions!==void 0?H.extensions[f.KHR_TEXTURE_TRANSFORM]:void 0;if(pe){var ee=j.associations.get(q);q=j.extensions[f.KHR_TEXTURE_TRANSFORM].extendTexture(q,pe),j.associations.set(q,ee)}}ye[fe]=q})},Me.prototype.assignFinalMaterial=function(ye){var fe=ye.geometry,H=ye.material,j=fe.attributes.tangent!==void 0,q=fe.attributes.color!==void 0,pe=fe.attributes.normal===void 0,ee=ye.isSkinnedMesh===!0,te=Object.keys(fe.morphAttributes).length>0,Se=te&&fe.morphAttributes.normal!==void 0;if(ye.isPoints){var ke="PointsMaterial:"+H.uuid,Be=this.cache.get(ke);Be||(Be=new THREE.PointsMaterial,THREE.Material.prototype.copy.call(Be,H),Be.color.copy(H.color),Be.map=H.map,Be.sizeAttenuation=!1,this.cache.add(ke,Be)),H=Be}else if(ye.isLine){var ke="LineBasicMaterial:"+H.uuid,We=this.cache.get(ke);We||(We=new THREE.LineBasicMaterial,THREE.Material.prototype.copy.call(We,H),We.color.copy(H.color),this.cache.add(ke,We)),H=We}if(j||q||pe||ee||te){var ke="ClonedMaterial:"+H.uuid+":";H.isGLTFSpecularGlossinessMaterial&&(ke+="specular-glossiness:"),ee&&(ke+="skinning:"),j&&(ke+="vertex-tangents:"),q&&(ke+="vertex-colors:"),pe&&(ke+="flat-shading:"),te&&(ke+="morph-targets:"),Se&&(ke+="morph-normals:");var ve=this.cache.get(ke);ve||(ve=H.clone(),ee&&(ve.skinning=!0),q&&(ve.vertexColors=!0),pe&&(ve.flatShading=!0),te&&(ve.morphTargets=!0),Se&&(ve.morphNormals=!0),j&&(ve.vertexTangents=!0,H.normalScale&&(H.normalScale.y*=-1),H.clearcoatNormalScale&&(H.clearcoatNormalScale.y*=-1)),this.cache.add(ke,ve),this.associations.set(ve,this.associations.get(H))),H=ve}H.aoMap&&fe.attributes.uv2===void 0&&fe.attributes.uv!==void 0&&fe.setAttribute("uv2",fe.attributes.uv),ye.material=H},Me.prototype.getMaterialType=function(){return THREE.MeshStandardMaterial},Me.prototype.loadMaterial=function(ye){var fe=this,H=this.json,j=this.extensions,q=H.materials[ye],pe,ee={},te=q.extensions||{},Se=[];if(te[f.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var ke=j[f.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];pe=ke.getMaterialType(),Se.push(ke.extendParams(ee,q,fe))}else if(te[f.KHR_MATERIALS_UNLIT]){var Be=j[f.KHR_MATERIALS_UNLIT];pe=Be.getMaterialType(),Se.push(Be.extendParams(ee,q,fe))}else{var We=q.pbrMetallicRoughness||{};if(ee.color=new THREE.Color(1,1,1),ee.opacity=1,Array.isArray(We.baseColorFactor)){var ve=We.baseColorFactor;ee.color.fromArray(ve),ee.opacity=ve[3]}We.baseColorTexture!==void 0&&Se.push(fe.assignTexture(ee,"map",We.baseColorTexture)),ee.metalness=We.metallicFactor!==void 0?We.metallicFactor:1,ee.roughness=We.roughnessFactor!==void 0?We.roughnessFactor:1,We.metallicRoughnessTexture!==void 0&&(Se.push(fe.assignTexture(ee,"metalnessMap",We.metallicRoughnessTexture)),Se.push(fe.assignTexture(ee,"roughnessMap",We.metallicRoughnessTexture))),pe=this._invokeOne(function(J){return J.getMaterialType&&J.getMaterialType(ye)}),Se.push(Promise.all(this._invokeAll(function(J){return J.extendMaterialParams&&J.extendMaterialParams(ye,ee)})))}q.doubleSided===!0&&(ee.side=THREE.DoubleSide);var K=q.alphaMode||ce.OPAQUE;return K===ce.BLEND?(ee.transparent=!0,ee.depthWrite=!1):(ee.transparent=!1,K===ce.MASK&&(ee.alphaTest=q.alphaCutoff!==void 0?q.alphaCutoff:.5)),q.normalTexture!==void 0&&pe!==THREE.MeshBasicMaterial&&(Se.push(fe.assignTexture(ee,"normalMap",q.normalTexture)),ee.normalScale=new THREE.Vector2(1,-1),q.normalTexture.scale!==void 0&&ee.normalScale.set(q.normalTexture.scale,-q.normalTexture.scale)),q.occlusionTexture!==void 0&&pe!==THREE.MeshBasicMaterial&&(Se.push(fe.assignTexture(ee,"aoMap",q.occlusionTexture)),q.occlusionTexture.strength!==void 0&&(ee.aoMapIntensity=q.occlusionTexture.strength)),q.emissiveFactor!==void 0&&pe!==THREE.MeshBasicMaterial&&(ee.emissive=new THREE.Color().fromArray(q.emissiveFactor)),q.emissiveTexture!==void 0&&pe!==THREE.MeshBasicMaterial&&Se.push(fe.assignTexture(ee,"emissiveMap",q.emissiveTexture)),Promise.all(Se).then(function(){var J;return pe===N?J=j[f.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(ee):J=new pe(ee),q.name&&(J.name=q.name),J.map&&(J.map.encoding=THREE.sRGBEncoding),J.emissiveMap&&(J.emissiveMap.encoding=THREE.sRGBEncoding),Ne(J,q),fe.associations.set(J,{type:"materials",index:ye}),q.extensions&&_e(j,J,q),J})},Me.prototype.createUniqueName=function(ye){for(var fe=THREE.PropertyBinding.sanitizeNodeName(ye||""),H=fe,j=1;this.nodeNamesUsed[H];++j)H=fe+"_"+j;return this.nodeNamesUsed[H]=!0,H};function Qe(ye,fe,H){var j=fe.attributes,q=new THREE.Box3;if(j.POSITION!==void 0){var pe=H.json.accessors[j.POSITION],ee=pe.min,te=pe.max;if(ee!==void 0&&te!==void 0)q.set(new THREE.Vector3(ee[0],ee[1],ee[2]),new THREE.Vector3(te[0],te[1],te[2]));else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;var Se=fe.targets;if(Se!==void 0){for(var ke=new THREE.Vector3,Be=new THREE.Vector3,We=0,ve=Se.length;We<ve;We++){var K=Se[We];if(K.POSITION!==void 0){var pe=H.json.accessors[K.POSITION],ee=pe.min,te=pe.max;ee!==void 0&&te!==void 0?(Be.setX(Math.max(Math.abs(ee[0]),Math.abs(te[0]))),Be.setY(Math.max(Math.abs(ee[1]),Math.abs(te[1]))),Be.setZ(Math.max(Math.abs(ee[2]),Math.abs(te[2]))),ke.max(Be)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}q.expandByVector(ke)}ye.boundingBox=q;var J=new THREE.Sphere;q.getCenter(J.center),J.radius=q.min.distanceTo(q.max)/2,ye.boundingSphere=J}function mt(ye,fe,H){var j=fe.attributes,q=[];function pe(ke,Be){return H.getDependency("accessor",ke).then(function(We){ye.setAttribute(Be,We)})}for(var ee in j){var te=k[ee]||ee.toLowerCase();te in ye.attributes||q.push(pe(j[ee],te))}if(fe.indices!==void 0&&!ye.index){var Se=H.getDependency("accessor",fe.indices).then(function(ke){ye.setIndex(ke)});q.push(Se)}return Ne(ye,fe),Qe(ye,fe,H),Promise.all(q).then(function(){return fe.targets!==void 0?Ie(ye,fe.targets,H):ye})}function ht(ye,fe){var H=ye.getIndex();if(H===null){var j=[],q=ye.getAttribute("position");if(q!==void 0){for(var pe=0;pe<q.count;pe++)j.push(pe);ye.setIndex(j),H=ye.getIndex()}else return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),ye}var ee=H.count-2,te=[];if(fe===THREE.TriangleFanDrawMode)for(var pe=1;pe<=ee;pe++)te.push(H.getX(0)),te.push(H.getX(pe)),te.push(H.getX(pe+1));else for(var pe=0;pe<ee;pe++)pe%2==0?(te.push(H.getX(pe)),te.push(H.getX(pe+1)),te.push(H.getX(pe+2))):(te.push(H.getX(pe+2)),te.push(H.getX(pe+1)),te.push(H.getX(pe)));te.length/3!==ee&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var Se=ye.clone();return Se.setIndex(te),Se}return Me.prototype.loadGeometries=function(ye){var fe=this,H=this.extensions,j=this.primitiveCache;function q(ve){return H[f.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(ve,fe).then(function(K){return mt(K,ve,fe)})}for(var pe=[],ee=0,te=ye.length;ee<te;ee++){var Se=ye[ee],ke=Le(Se),Be=j[ke];if(Be)pe.push(Be.promise);else{var We;Se.extensions&&Se.extensions[f.KHR_DRACO_MESH_COMPRESSION]?We=q(Se):We=mt(new THREE.BufferGeometry,Se,fe),j[ke]={primitive:Se,promise:We},pe.push(We)}}return Promise.all(pe)},Me.prototype.loadMesh=function(ye){for(var fe=this,H=this.json,j=this.extensions,q=H.meshes[ye],pe=q.primitives,ee=[],te=0,Se=pe.length;te<Se;te++){var ke=pe[te].material===void 0?ge(this.cache):this.getDependency("material",pe[te].material);ee.push(ke)}return ee.push(fe.loadGeometries(pe)),Promise.all(ee).then(function(Be){for(var We=Be.slice(0,Be.length-1),ve=Be[Be.length-1],K=[],J=0,Ee=ve.length;J<Ee;J++){var xe=ve[J],Je=pe[J],Xe,Mt=We[J];if(Je.mode===ae.TRIANGLES||Je.mode===ae.TRIANGLE_STRIP||Je.mode===ae.TRIANGLE_FAN||Je.mode===void 0)Xe=q.isSkinnedMesh===!0?new THREE.SkinnedMesh(xe,Mt):new THREE.Mesh(xe,Mt),Mt.isMeshStandardMaterial===!0&&Mt.side===THREE.DoubleSide&&xe.getIndex()!==null&&xe.hasAttribute("position")===!0&&xe.hasAttribute("normal")===!0&&xe.hasAttribute("uv")===!0&&xe.hasAttribute("tangent")===!1&&(xe.computeTangents(),Mt.vertexTangents=!0),Xe.isSkinnedMesh===!0&&!Xe.geometry.attributes.skinWeight.normalized&&Xe.normalizeSkinWeights(),Je.mode===ae.TRIANGLE_STRIP?Xe.geometry=ht(Xe.geometry,THREE.TriangleStripDrawMode):Je.mode===ae.TRIANGLE_FAN&&(Xe.geometry=ht(Xe.geometry,THREE.TriangleFanDrawMode));else if(Je.mode===ae.LINES)Xe=new THREE.LineSegments(xe,Mt);else if(Je.mode===ae.LINE_STRIP)Xe=new THREE.Line(xe,Mt);else if(Je.mode===ae.LINE_LOOP)Xe=new THREE.LineLoop(xe,Mt);else if(Je.mode===ae.POINTS)Xe=new THREE.Points(xe,Mt);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+Je.mode);Object.keys(Xe.geometry.morphAttributes).length>0&&Ve(Xe,q),Xe.name=fe.createUniqueName(q.name||"mesh_"+ye),Ne(Xe,q),Je.extensions&&_e(j,Xe,Je),fe.assignFinalMaterial(Xe),K.push(Xe)}if(K.length===1)return K[0];for(var qe=new THREE.Group,J=0,Ee=K.length;J<Ee;J++)qe.add(K[J]);return qe})},Me.prototype.loadCamera=function(ye){var fe,H=this.json.cameras[ye],j=H[H.type];if(!j){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return H.type==="perspective"?fe=new THREE.PerspectiveCamera(THREE.MathUtils.radToDeg(j.yfov),j.aspectRatio||1,j.znear||1,j.zfar||2e6):H.type==="orthographic"&&(fe=new THREE.OrthographicCamera(-j.xmag,j.xmag,j.ymag,-j.ymag,j.znear,j.zfar)),H.name&&(fe.name=this.createUniqueName(H.name)),Ne(fe,H),Promise.resolve(fe)},Me.prototype.loadSkin=function(ye){var fe=this.json.skins[ye],H={joints:fe.joints};return fe.inverseBindMatrices===void 0?Promise.resolve(H):this.getDependency("accessor",fe.inverseBindMatrices).then(function(j){return H.inverseBindMatrices=j,H})},Me.prototype.loadAnimation=function(ye){for(var fe=this.json,H=fe.animations[ye],j=[],q=[],pe=[],ee=[],te=[],Se=0,ke=H.channels.length;Se<ke;Se++){var Be=H.channels[Se],We=H.samplers[Be.sampler],ve=Be.target,K=ve.node!==void 0?ve.node:ve.id,J=H.parameters!==void 0?H.parameters[We.input]:We.input,Ee=H.parameters!==void 0?H.parameters[We.output]:We.output;j.push(this.getDependency("node",K)),q.push(this.getDependency("accessor",J)),pe.push(this.getDependency("accessor",Ee)),ee.push(We),te.push(ve)}return Promise.all([Promise.all(j),Promise.all(q),Promise.all(pe),Promise.all(ee),Promise.all(te)]).then(function(xe){for(var Je=xe[0],Xe=xe[1],Mt=xe[2],qe=xe[3],It=xe[4],rn=[],Yt=0,Tn=Je.length;Yt<Tn;Yt++){var Jt=Je[Yt],Fn=Xe[Yt],mr=Mt[Yt],fr=qe[Yt],Dt=It[Yt];if(Jt!==void 0){Jt.updateMatrix(),Jt.matrixAutoUpdate=!0;var Ft;switch(U[Dt.path]){case U.weights:Ft=THREE.NumberKeyframeTrack;break;case U.rotation:Ft=THREE.QuaternionKeyframeTrack;break;case U.position:case U.scale:default:Ft=THREE.VectorKeyframeTrack;break}var $t=Jt.name?Jt.name:Jt.uuid,Pn=fr.interpolation!==void 0?W[fr.interpolation]:THREE.InterpolateLinear,In=[];U[Dt.path]===U.weights?Jt.traverse(function(vr){vr.isMesh===!0&&vr.morphTargetInfluences&&In.push(vr.name?vr.name:vr.uuid)}):In.push($t);var zn=mr.array;if(mr.normalized){var bn;if(zn.constructor===Int8Array)bn=1/127;else if(zn.constructor===Uint8Array)bn=1/255;else if(zn.constructor==Int16Array)bn=1/32767;else if(zn.constructor===Uint16Array)bn=1/65535;else throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");for(var Jn=new Float32Array(zn.length),Er=0,cr=zn.length;Er<cr;Er++)Jn[Er]=zn[Er]*bn;zn=Jn}for(var Er=0,cr=In.length;Er<cr;Er++){var gi=new Ft(In[Er]+"."+U[Dt.path],Fn.array,zn,Pn);fr.interpolation==="CUBICSPLINE"&&(gi.createInterpolant=function(Ot){return new Y(this.times,this.values,this.getValueSize()/3,Ot)},gi.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),rn.push(gi)}}}var Lr=H.name?H.name:"animation_"+ye;return new THREE.AnimationClip(Lr,void 0,rn)})},Me.prototype.loadNode=function(ye){var fe=this.json,H=this.extensions,j=this,q=fe.nodes[ye],pe=q.name?j.createUniqueName(q.name):"";return function(){var ee=[];return q.mesh!==void 0&&ee.push(j.getDependency("mesh",q.mesh).then(function(te){var Se=j._getNodeRef(j.meshCache,q.mesh,te);return q.weights!==void 0&&Se.traverse(function(ke){if(!!ke.isMesh)for(var Be=0,We=q.weights.length;Be<We;Be++)ke.morphTargetInfluences[Be]=q.weights[Be]}),Se})),q.camera!==void 0&&ee.push(j.getDependency("camera",q.camera).then(function(te){return j._getNodeRef(j.cameraCache,q.camera,te)})),j._invokeAll(function(te){return te.createNodeAttachment&&te.createNodeAttachment(ye)}).forEach(function(te){ee.push(te)}),Promise.all(ee)}().then(function(ee){var te;if(q.isBone===!0?te=new THREE.Bone:ee.length>1?te=new THREE.Group:ee.length===1?te=ee[0]:te=new THREE.Object3D,te!==ee[0])for(var Se=0,ke=ee.length;Se<ke;Se++)te.add(ee[Se]);if(q.name&&(te.userData.name=q.name,te.name=pe),Ne(te,q),q.extensions&&_e(H,te,q),q.matrix!==void 0){var Be=new THREE.Matrix4;Be.fromArray(q.matrix),te.applyMatrix4(Be)}else q.translation!==void 0&&te.position.fromArray(q.translation),q.rotation!==void 0&&te.quaternion.fromArray(q.rotation),q.scale!==void 0&&te.scale.fromArray(q.scale);return j.associations.set(te,{type:"nodes",index:ye}),te})},Me.prototype.loadScene=function(){function ye(fe,H,j,q){var pe=j.nodes[fe];return q.getDependency("node",fe).then(function(ee){if(pe.skin===void 0)return ee;var te;return q.getDependency("skin",pe.skin).then(function(Se){te=Se;for(var ke=[],Be=0,We=te.joints.length;Be<We;Be++)ke.push(q.getDependency("node",te.joints[Be]));return Promise.all(ke)}).then(function(Se){return ee.traverse(function(ke){if(!!ke.isMesh){for(var Be=[],We=[],ve=0,K=Se.length;ve<K;ve++){var J=Se[ve];if(J){Be.push(J);var Ee=new THREE.Matrix4;te.inverseBindMatrices!==void 0&&Ee.fromArray(te.inverseBindMatrices.array,ve*16),We.push(Ee)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',te.joints[ve])}ke.bind(new THREE.Skeleton(Be,We),ke.matrixWorld)}}),ee})}).then(function(ee){H.add(ee);var te=[];if(pe.children)for(var Se=pe.children,ke=0,Be=Se.length;ke<Be;ke++){var We=Se[ke];te.push(ye(We,ee,j,q))}return Promise.all(te)})}return function(H){var j=this.json,q=this.extensions,pe=this.json.scenes[H],ee=this,te=new THREE.Group;pe.name&&(te.name=ee.createUniqueName(pe.name)),Ne(te,pe),pe.extensions&&_e(q,te,pe);for(var Se=pe.nodes||[],ke=[],Be=0,We=Se.length;Be<We;Be++)ke.push(ye(Se[Be],te,j,ee));return Promise.all(ke).then(function(){return te})}}(),o}()},{}],60:[function(r,a,s){THREE.MTLLoader=function(o){THREE.Loader.call(this,o)},THREE.MTLLoader.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:THREE.MTLLoader,load:function(o,u,f,v){var m=this,g=this.path===""?THREE.LoaderUtils.extractUrlBase(o):this.path,y=new THREE.FileLoader(this.manager);y.setPath(this.path),y.setRequestHeader(this.requestHeader),y.setWithCredentials(this.withCredentials),y.load(o,function(b){try{u(m.parse(b,g))}catch(w){v?v(w):console.error(w),m.manager.itemError(o)}},f,v)},setMaterialOptions:function(o){return this.materialOptions=o,this},parse:function(o,u){for(var f=o.split(`
`),v={},m=/\s+/,g={},y=0;y<f.length;y++){var b=f[y];if(b=b.trim(),!(b.length===0||b.charAt(0)==="#")){var w=b.indexOf(" "),A=w>=0?b.substring(0,w):b;A=A.toLowerCase();var M=w>=0?b.substring(w+1):"";if(M=M.trim(),A==="newmtl")v={name:M},g[M]=v;else if(A==="ka"||A==="kd"||A==="ks"||A==="ke"){var S=M.split(m,3);v[A]=[parseFloat(S[0]),parseFloat(S[1]),parseFloat(S[2])]}else v[A]=M}}var E=new THREE.MTLLoader.MaterialCreator(this.resourcePath||u,this.materialOptions);return E.setCrossOrigin(this.crossOrigin),E.setManager(this.manager),E.setMaterials(g),E}}),THREE.MTLLoader.MaterialCreator=function(o,u){this.baseUrl=o||"",this.options=u,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:THREE.FrontSide,this.wrap=this.options&&this.options.wrap?this.options.wrap:THREE.RepeatWrapping},THREE.MTLLoader.MaterialCreator.prototype={constructor:THREE.MTLLoader.MaterialCreator,crossOrigin:"anonymous",setCrossOrigin:function(o){return this.crossOrigin=o,this},setManager:function(o){this.manager=o},setMaterials:function(o){this.materialsInfo=this.convert(o),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(o){if(!this.options)return o;var u={};for(var f in o){var v=o[f],m={};u[f]=m;for(var g in v){var y=!0,b=v[g],w=g.toLowerCase();switch(w){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(b=[b[0]/255,b[1]/255,b[2]/255]),this.options&&this.options.ignoreZeroRGBs&&b[0]===0&&b[1]===0&&b[2]===0&&(y=!1);break}y&&(m[w]=b)}}return u},preload:function(){for(var o in this.materialsInfo)this.create(o)},getIndex:function(o){return this.nameLookup[o]},getAsArray:function(){var o=0;for(var u in this.materialsInfo)this.materialsArray[o]=this.create(u),this.nameLookup[u]=o,o++;return this.materialsArray},create:function(o){return this.materials[o]===void 0&&this.createMaterial_(o),this.materials[o]},createMaterial_:function(o){var u=this,f=this.materialsInfo[o],v={name:o,side:this.side};function m(A,M){return typeof M!="string"||M===""?"":/^https?:\/\//i.test(M)?M:A+M}function g(A,M){if(!v[A]){var S=u.getTextureParams(M,v),E=u.loadTexture(m(u.baseUrl,S.url));E.repeat.copy(S.scale),E.offset.copy(S.offset),E.wrapS=u.wrap,E.wrapT=u.wrap,v[A]=E}}for(var y in f){var b=f[y],w;if(b!=="")switch(y.toLowerCase()){case"kd":v.color=new THREE.Color().fromArray(b);break;case"ks":v.specular=new THREE.Color().fromArray(b);break;case"ke":v.emissive=new THREE.Color().fromArray(b);break;case"map_kd":g("map",b);break;case"map_ks":g("specularMap",b);break;case"map_ke":g("emissiveMap",b);break;case"norm":g("normalMap",b);break;case"map_bump":case"bump":g("bumpMap",b);break;case"map_d":g("alphaMap",b),v.transparent=!0;break;case"ns":v.shininess=parseFloat(b);break;case"d":w=parseFloat(b),w<1&&(v.opacity=w,v.transparent=!0);break;case"tr":w=parseFloat(b),this.options&&this.options.invertTrProperty&&(w=1-w),w>0&&(v.opacity=1-w,v.transparent=!0);break}}return this.materials[o]=new THREE.MeshPhongMaterial(v),this.materials[o]},getTextureParams:function(o,u){var f={scale:new THREE.Vector2(1,1),offset:new THREE.Vector2(0,0)},v=o.split(/\s+/),m;return m=v.indexOf("-bm"),m>=0&&(u.bumpScale=parseFloat(v[m+1]),v.splice(m,2)),m=v.indexOf("-s"),m>=0&&(f.scale.set(parseFloat(v[m+1]),parseFloat(v[m+2])),v.splice(m,4)),m=v.indexOf("-o"),m>=0&&(f.offset.set(parseFloat(v[m+1]),parseFloat(v[m+2])),v.splice(m,4)),f.url=v.join(" ").trim(),f},loadTexture:function(o,u,f,v,m){var g,y=this.manager!==void 0?this.manager:THREE.DefaultLoadingManager,b=y.getHandler(o);return b===null&&(b=new THREE.TextureLoader(y)),b.setCrossOrigin&&b.setCrossOrigin(this.crossOrigin),g=b.load(o,f,v,m),u!==void 0&&(g.mapping=u),g}}},{}],61:[function(r,a,s){THREE.OBJLoader=function(){var o=/^[og]\s*(.+)?/,u=/^mtllib /,f=/^usemtl /,v=/^usemap /,m=new THREE.Vector3,g=new THREE.Vector3,y=new THREE.Vector3,b=new THREE.Vector3,w=new THREE.Vector3;function A(){var S={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(E,T){if(this.object&&this.object.fromDeclaration===!1){this.object.name=E,this.object.fromDeclaration=T!==!1;return}var C=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:E||"",fromDeclaration:T!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(P,N){var F=this._finalize(!1);F&&(F.inherited||F.groupCount<=0)&&this.materials.splice(F.index,1);var X={index:this.materials.length,name:P||"",mtllib:Array.isArray(N)&&N.length>0?N[N.length-1]:"",smooth:F!==void 0?F.smooth:this.smooth,groupStart:F!==void 0?F.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(Y){var ae={index:typeof Y=="number"?Y:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return ae.clone=this.clone.bind(ae),ae}};return this.materials.push(X),X},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(P){var N=this.currentMaterial();if(N&&N.groupEnd===-1&&(N.groupEnd=this.geometry.vertices.length/3,N.groupCount=N.groupEnd-N.groupStart,N.inherited=!1),P&&this.materials.length>1)for(var F=this.materials.length-1;F>=0;F--)this.materials[F].groupCount<=0&&this.materials.splice(F,1);return P&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),N}},C&&C.name&&typeof C.clone=="function"){var L=C.clone(0);L.inherited=!0,this.object.materials.push(L)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(E,T){var C=parseInt(E,10);return(C>=0?C-1:C+T/3)*3},parseNormalIndex:function(E,T){var C=parseInt(E,10);return(C>=0?C-1:C+T/3)*3},parseUVIndex:function(E,T){var C=parseInt(E,10);return(C>=0?C-1:C+T/2)*2},addVertex:function(E,T,C){var L=this.vertices,P=this.object.geometry.vertices;P.push(L[E+0],L[E+1],L[E+2]),P.push(L[T+0],L[T+1],L[T+2]),P.push(L[C+0],L[C+1],L[C+2])},addVertexPoint:function(E){var T=this.vertices,C=this.object.geometry.vertices;C.push(T[E+0],T[E+1],T[E+2])},addVertexLine:function(E){var T=this.vertices,C=this.object.geometry.vertices;C.push(T[E+0],T[E+1],T[E+2])},addNormal:function(E,T,C){var L=this.normals,P=this.object.geometry.normals;P.push(L[E+0],L[E+1],L[E+2]),P.push(L[T+0],L[T+1],L[T+2]),P.push(L[C+0],L[C+1],L[C+2])},addFaceNormal:function(E,T,C){var L=this.vertices,P=this.object.geometry.normals;m.fromArray(L,E),g.fromArray(L,T),y.fromArray(L,C),w.subVectors(y,g),b.subVectors(m,g),w.cross(b),w.normalize(),P.push(w.x,w.y,w.z),P.push(w.x,w.y,w.z),P.push(w.x,w.y,w.z)},addColor:function(E,T,C){var L=this.colors,P=this.object.geometry.colors;L[E]!==void 0&&P.push(L[E+0],L[E+1],L[E+2]),L[T]!==void 0&&P.push(L[T+0],L[T+1],L[T+2]),L[C]!==void 0&&P.push(L[C+0],L[C+1],L[C+2])},addUV:function(E,T,C){var L=this.uvs,P=this.object.geometry.uvs;P.push(L[E+0],L[E+1]),P.push(L[T+0],L[T+1]),P.push(L[C+0],L[C+1])},addDefaultUV:function(){var E=this.object.geometry.uvs;E.push(0,0),E.push(0,0),E.push(0,0)},addUVLine:function(E){var T=this.uvs,C=this.object.geometry.uvs;C.push(T[E+0],T[E+1])},addFace:function(E,T,C,L,P,N,F,X,Y){var ae=this.vertices.length,$=this.parseVertexIndex(E,ae),de=this.parseVertexIndex(T,ae),D=this.parseVertexIndex(C,ae);if(this.addVertex($,de,D),this.addColor($,de,D),F!==void 0&&F!==""){var I=this.normals.length;$=this.parseNormalIndex(F,I),de=this.parseNormalIndex(X,I),D=this.parseNormalIndex(Y,I),this.addNormal($,de,D)}else this.addFaceNormal($,de,D);if(L!==void 0&&L!==""){var k=this.uvs.length;$=this.parseUVIndex(L,k),de=this.parseUVIndex(P,k),D=this.parseUVIndex(N,k),this.addUV($,de,D),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(E){this.object.geometry.type="Points";for(var T=this.vertices.length,C=0,L=E.length;C<L;C++){var P=this.parseVertexIndex(E[C],T);this.addVertexPoint(P),this.addColor(P)}},addLineGeometry:function(E,T){this.object.geometry.type="Line";for(var C=this.vertices.length,L=this.uvs.length,P=0,N=E.length;P<N;P++)this.addVertexLine(this.parseVertexIndex(E[P],C));for(var F=0,N=T.length;F<N;F++)this.addUVLine(this.parseUVIndex(T[F],L))}};return S.startObject("",!1),S}function M(S){THREE.Loader.call(this,S),this.materials=null}return M.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:M,load:function(S,E,T,C){var L=this,P=new THREE.FileLoader(this.manager);P.setPath(this.path),P.setRequestHeader(this.requestHeader),P.setWithCredentials(this.withCredentials),P.load(S,function(N){try{E(L.parse(N))}catch(F){C?C(F):console.error(F),L.manager.itemError(S)}},T,C)},setMaterials:function(S){return this.materials=S,this},parse:function(S){var E=new A;S.indexOf(`\r
`)!==-1&&(S=S.replace(/\r\n/g,`
`)),S.indexOf(`\\
`)!==-1&&(S=S.replace(/\\\n/g,""));for(var T=S.split(`
`),C="",L="",P=0,N=[],F=typeof"".trimLeft=="function",X=0,Y=T.length;X<Y;X++)if(C=T[X],C=F?C.trimLeft():C.trim(),P=C.length,P!==0&&(L=C.charAt(0),L!=="#"))if(L==="v"){var ae=C.split(/\s+/);switch(ae[0]){case"v":E.vertices.push(parseFloat(ae[1]),parseFloat(ae[2]),parseFloat(ae[3])),ae.length>=7?E.colors.push(parseFloat(ae[4]),parseFloat(ae[5]),parseFloat(ae[6])):E.colors.push(void 0,void 0,void 0);break;case"vn":E.normals.push(parseFloat(ae[1]),parseFloat(ae[2]),parseFloat(ae[3]));break;case"vt":E.uvs.push(parseFloat(ae[1]),parseFloat(ae[2]));break}}else if(L==="f"){for(var $=C.substr(1).trim(),de=$.split(/\s+/),D=[],I=0,k=de.length;I<k;I++){var U=de[I];if(U.length>0){var W=U.split("/");D.push(W)}}for(var ce=D[0],I=1,k=D.length-1;I<k;I++){var oe=D[I],ge=D[I+1];E.addFace(ce[0],oe[0],ge[0],ce[1],oe[1],ge[1],ce[2],oe[2],ge[2])}}else if(L==="l"){var _e=C.substring(1).trim().split(" "),Ne=[],Ie=[];if(C.indexOf("/")===-1)Ne=_e;else for(var Ve=0,Le=_e.length;Ve<Le;Ve++){var Fe=_e[Ve].split("/");Fe[0]!==""&&Ne.push(Fe[0]),Fe[1]!==""&&Ie.push(Fe[1])}E.addLineGeometry(Ne,Ie)}else if(L==="p"){var $=C.substr(1).trim(),Me=$.split(" ");E.addPointGeometry(Me)}else if((N=o.exec(C))!==null){var Qe=(" "+N[0].substr(1).trim()).substr(1);E.startObject(Qe)}else if(f.test(C))E.object.startMaterial(C.substring(7).trim(),E.materialLibraries);else if(u.test(C))E.materialLibraries.push(C.substring(7).trim());else if(v.test(C))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(L==="s"){if(N=C.split(" "),N.length>1){var mt=N[1].trim().toLowerCase();E.object.smooth=mt!=="0"&&mt!=="off"}else E.object.smooth=!0;var ht=E.object.currentMaterial();ht&&(ht.smooth=E.object.smooth)}else{if(C==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+C+'"')}E.finalize();var ye=new THREE.Group;ye.materialLibraries=[].concat(E.materialLibraries);var fe=!(E.objects.length===1&&E.objects[0].geometry.vertices.length===0);if(fe===!0)for(var X=0,Y=E.objects.length;X<Y;X++){var H=E.objects[X],j=H.geometry,q=H.materials,pe=j.type==="Line",ee=j.type==="Points",te=!1;if(j.vertices.length!==0){var Se=new THREE.BufferGeometry;Se.setAttribute("position",new THREE.Float32BufferAttribute(j.vertices,3)),j.normals.length>0&&Se.setAttribute("normal",new THREE.Float32BufferAttribute(j.normals,3)),j.colors.length>0&&(te=!0,Se.setAttribute("color",new THREE.Float32BufferAttribute(j.colors,3))),j.hasUVIndices===!0&&Se.setAttribute("uv",new THREE.Float32BufferAttribute(j.uvs,2));for(var ke=[],Be=0,We=q.length;Be<We;Be++){var ve=q[Be],K=ve.name+"_"+ve.smooth+"_"+te,ht=E.materials[K];if(this.materials!==null){if(ht=this.materials.create(ve.name),pe&&ht&&!(ht instanceof THREE.LineBasicMaterial)){var J=new THREE.LineBasicMaterial;THREE.Material.prototype.copy.call(J,ht),J.color.copy(ht.color),ht=J}else if(ee&&ht&&!(ht instanceof THREE.PointsMaterial)){var Ee=new THREE.PointsMaterial({size:10,sizeAttenuation:!1});THREE.Material.prototype.copy.call(Ee,ht),Ee.color.copy(ht.color),Ee.map=ht.map,ht=Ee}}ht===void 0&&(pe?ht=new THREE.LineBasicMaterial:ee?ht=new THREE.PointsMaterial({size:1,sizeAttenuation:!1}):ht=new THREE.MeshPhongMaterial,ht.name=ve.name,ht.flatShading=!ve.smooth,ht.vertexColors=te,E.materials[K]=ht),ke.push(ht)}var xe;if(ke.length>1){for(var Be=0,We=q.length;Be<We;Be++){var ve=q[Be];Se.addGroup(ve.groupStart,ve.groupCount,Be)}pe?xe=new THREE.LineSegments(Se,ke):ee?xe=new THREE.Points(Se,ke):xe=new THREE.Mesh(Se,ke)}else pe?xe=new THREE.LineSegments(Se,ke[0]):ee?xe=new THREE.Points(Se,ke[0]):xe=new THREE.Mesh(Se,ke[0]);xe.name=H.name,ye.add(xe)}}else if(E.vertices.length>0){var ht=new THREE.PointsMaterial({size:1,sizeAttenuation:!1}),Se=new THREE.BufferGeometry;Se.setAttribute("position",new THREE.Float32BufferAttribute(E.vertices,3)),E.colors.length>0&&E.colors[0]!==void 0&&(Se.setAttribute("color",new THREE.Float32BufferAttribute(E.colors,3)),ht.vertexColors=!0);var Je=new THREE.Points(Se,ht);ye.add(Je)}return ye}}),M}()},{}],62:[function(r,a,s){THREE.BufferGeometryUtils={computeTangents:function(o){o.computeTangents(),console.warn("THREE.BufferGeometryUtils: .computeTangents() has been removed. Use BufferGeometry.computeTangents() instead.")},mergeBufferGeometries:function(o,u){for(var f=o[0].index!==null,v=new Set(Object.keys(o[0].attributes)),m=new Set(Object.keys(o[0].morphAttributes)),g={},y={},b=o[0].morphTargetsRelative,w=new THREE.BufferGeometry,A=0,M=0;M<o.length;++M){var S=o[M],E=0;if(f!==(S.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+M+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(var T in S.attributes){if(!v.has(T))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+M+'. All geometries must have compatible attributes; make sure "'+T+'" attribute exists among all geometries, or in none of them.'),null;g[T]===void 0&&(g[T]=[]),g[T].push(S.attributes[T]),E++}if(E!==v.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+M+". Make sure all geometries have the same number of attributes."),null;if(b!==S.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+M+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(var T in S.morphAttributes){if(!m.has(T))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+M+".  .morphAttributes must be consistent throughout all geometries."),null;y[T]===void 0&&(y[T]=[]),y[T].push(S.morphAttributes[T])}if(w.userData.mergedUserData=w.userData.mergedUserData||[],w.userData.mergedUserData.push(S.userData),u){var C;if(f)C=S.index.count;else if(S.attributes.position!==void 0)C=S.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+M+". The geometry must have either an index or a position attribute"),null;w.addGroup(A,C,M),A+=C}}if(f){for(var L=0,P=[],M=0;M<o.length;++M){for(var N=o[M].index,F=0;F<N.count;++F)P.push(N.getX(F)+L);L+=o[M].attributes.position.count}w.setIndex(P)}for(var T in g){var X=this.mergeBufferAttributes(g[T]);if(!X)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+T+" attribute."),null;w.setAttribute(T,X)}for(var T in y){var Y=y[T][0].length;if(Y===0)break;w.morphAttributes=w.morphAttributes||{},w.morphAttributes[T]=[];for(var M=0;M<Y;++M){for(var ae=[],F=0;F<y[T].length;++F)ae.push(y[T][F][M]);var $=this.mergeBufferAttributes(ae);if(!$)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+T+" morphAttribute."),null;w.morphAttributes[T].push($)}}return w},mergeBufferAttributes:function(o){for(var u,f,v,m=0,g=0;g<o.length;++g){var y=o[g];if(y.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(u===void 0&&(u=y.array.constructor),u!==y.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(f===void 0&&(f=y.itemSize),f!==y.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(v===void 0&&(v=y.normalized),v!==y.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;m+=y.array.length}for(var b=new u(m),w=0,g=0;g<o.length;++g)b.set(o[g].array,w),w+=o[g].array.length;return new THREE.BufferAttribute(b,f,v)},interleaveAttributes:function(o){for(var u,f=0,v=0,m=0,g=o.length;m<g;++m){var y=o[m];if(u===void 0&&(u=y.array.constructor),u!==y.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;f+=y.array.length,v+=y.itemSize}for(var b=new THREE.InterleavedBuffer(new u(f),v),w=0,A=[],M=["getX","getY","getZ","getW"],S=["setX","setY","setZ","setW"],E=0,g=o.length;E<g;E++){var y=o[E],T=y.itemSize,C=y.count,L=new THREE.InterleavedBufferAttribute(b,T,w,y.normalized);A.push(L),w+=T;for(var P=0;P<C;P++)for(var N=0;N<T;N++)L[S[N]](P,y[M[N]](P))}return A},estimateBytesUsed:function(o){var u=0;for(var f in o.attributes){var v=o.getAttribute(f);u+=v.count*v.itemSize*v.array.BYTES_PER_ELEMENT}var m=o.getIndex();return u+=m?m.count*m.itemSize*m.array.BYTES_PER_ELEMENT:0,u},mergeVertices:function(o,u=1e-4){u=Math.max(u,Number.EPSILON);for(var f={},v=o.getIndex(),m=o.getAttribute("position"),g=v?v.count:m.count,y=0,b=Object.keys(o.attributes),w={},A={},M=[],S=["getX","getY","getZ","getW"],E=0,T=b.length;E<T;E++){var C=b[E];w[C]=[];var L=o.morphAttributes[C];L&&(A[C]=new Array(L.length).fill().map(()=>[]))}for(var P=Math.log10(1/u),N=Math.pow(10,P),E=0;E<g;E++){for(var F=v?v.getX(E):E,X="",Y=0,T=b.length;Y<T;Y++)for(var C=b[Y],ae=o.getAttribute(C),$=ae.itemSize,de=0;de<$;de++)X+=`${~~(ae[S[de]](F)*N)},`;if(X in f)M.push(f[X]);else{for(var Y=0,T=b.length;Y<T;Y++)for(var C=b[Y],ae=o.getAttribute(C),L=o.morphAttributes[C],$=ae.itemSize,D=w[C],I=A[C],de=0;de<$;de++){var k=S[de];if(D.push(ae[k](F)),L)for(var U=0,W=L.length;U<W;U++)I[U].push(L[U][k](F))}f[X]=y,M.push(y),y++}}const ce=o.clone();for(var E=0,T=b.length;E<T;E++){var C=b[E],oe=o.getAttribute(C),ge=new oe.array.constructor(w[C]),ae=new THREE.BufferAttribute(ge,oe.itemSize,oe.normalized);if(ce.setAttribute(C,ae),C in A)for(var Y=0;Y<A[C].length;Y++){var _e=o.morphAttributes[C][Y],ge=new _e.array.constructor(A[C][Y]),Ne=new THREE.BufferAttribute(ge,_e.itemSize,_e.normalized);ce.morphAttributes[C][Y]=Ne}}return ce.setIndex(M),ce},toTrianglesDrawMode:function(o,u){if(u===THREE.TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),o;if(u===THREE.TriangleFanDrawMode||u===THREE.TriangleStripDrawMode){var f=o.getIndex();if(f===null){var v=[],m=o.getAttribute("position");if(m!==void 0){for(var g=0;g<m.count;g++)v.push(g);o.setIndex(v),f=o.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),o}var y=f.count-2,b=[];if(u===THREE.TriangleFanDrawMode)for(var g=1;g<=y;g++)b.push(f.getX(0)),b.push(f.getX(g)),b.push(f.getX(g+1));else for(var g=0;g<y;g++)g%2==0?(b.push(f.getX(g)),b.push(f.getX(g+1)),b.push(f.getX(g+2))):(b.push(f.getX(g+2)),b.push(f.getX(g+1)),b.push(f.getX(g)));b.length/3!==y&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var w=o.clone();return w.setIndex(b),w.clearGroups(),w}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",u),o},computeMorphedAttributes:function(o){if(o.geometry.isBufferGeometry!==!0)return console.error("THREE.BufferGeometryUtils: Geometry is not of type THREE.BufferGeometry."),null;var u=new THREE.Vector3,f=new THREE.Vector3,v=new THREE.Vector3,m=new THREE.Vector3,g=new THREE.Vector3,y=new THREE.Vector3,b=new THREE.Vector3,w=new THREE.Vector3,A=new THREE.Vector3;function M(Le,Fe,Me,Qe,mt,ht,ye,fe,H){u.fromBufferAttribute(Me,ht),f.fromBufferAttribute(Me,ye),v.fromBufferAttribute(Me,fe);var j=Le.morphTargetInfluences;if(Fe.morphTargets&&Qe&&j){b.set(0,0,0),w.set(0,0,0),A.set(0,0,0);for(var q=0,pe=Qe.length;q<pe;q++){var ee=j[q],Qe=Qe[q];ee!==0&&(m.fromBufferAttribute(Qe,ht),g.fromBufferAttribute(Qe,ye),y.fromBufferAttribute(Qe,fe),mt?(b.addScaledVector(m,ee),w.addScaledVector(g,ee),A.addScaledVector(y,ee)):(b.addScaledVector(m.sub(u),ee),w.addScaledVector(g.sub(f),ee),A.addScaledVector(y.sub(v),ee)))}u.add(b),f.add(w),v.add(A)}Le.isSkinnedMesh&&(Le.boneTransform(ht,u),Le.boneTransform(ye,f),Le.boneTransform(fe,v)),H[ht*3+0]=u.x,H[ht*3+1]=u.y,H[ht*3+2]=u.z,H[ye*3+0]=f.x,H[ye*3+1]=f.y,H[ye*3+2]=f.z,H[fe*3+0]=v.x,H[fe*3+1]=v.y,H[fe*3+2]=v.z}var S=o.geometry,E=o.material,T,C,L,P=S.index,N=S.attributes.position,F=S.morphAttributes.position,X=S.morphTargetsRelative,Y=S.attributes.normal,ae=S.morphAttributes.position,$=S.groups,de=S.drawRange,D,I,k,U,W,ce,oe,ge,_e=new Float32Array(N.count*N.itemSize),Ne=new Float32Array(Y.count*Y.itemSize);if(P!==null)if(Array.isArray(E))for(D=0,k=$.length;D<k;D++)for(W=$[D],ce=E[W.materialIndex],oe=Math.max(W.start,de.start),ge=Math.min(W.start+W.count,de.start+de.count),I=oe,U=ge;I<U;I+=3)T=P.getX(I),C=P.getX(I+1),L=P.getX(I+2),M(o,ce,N,F,X,T,C,L,_e),M(o,ce,Y,ae,X,T,C,L,Ne);else for(oe=Math.max(0,de.start),ge=Math.min(P.count,de.start+de.count),D=oe,k=ge;D<k;D+=3)T=P.getX(D),C=P.getX(D+1),L=P.getX(D+2),M(o,E,N,F,X,T,C,L,_e),M(o,E,Y,ae,X,T,C,L,Ne);else if(N!==void 0)if(Array.isArray(E))for(D=0,k=$.length;D<k;D++)for(W=$[D],ce=E[W.materialIndex],oe=Math.max(W.start,de.start),ge=Math.min(W.start+W.count,de.start+de.count),I=oe,U=ge;I<U;I+=3)T=I,C=I+1,L=I+2,M(o,ce,N,F,X,T,C,L,_e),M(o,ce,Y,ae,X,T,C,L,Ne);else for(oe=Math.max(0,de.start),ge=Math.min(N.count,de.start+de.count),D=oe,k=ge;D<k;D+=3)T=D,C=D+1,L=D+2,M(o,E,N,F,X,T,C,L,_e),M(o,E,Y,ae,X,T,C,L,Ne);var Ie=new THREE.Float32BufferAttribute(_e,3),Ve=new THREE.Float32BufferAttribute(Ne,3);return{positionAttribute:N,normalAttribute:Y,morphedPositionAttribute:Ie,morphedNormalAttribute:Ve}}}},{}],63:[function(r,a,s){var o=r("layout-bmfont-text"),u=r("inherits"),f=r("quad-indices"),v=r("three-buffer-vertex-data"),m=r("object-assign"),g=r("./lib/vertices"),y=r("./lib/utils"),b=THREE.BufferGeometry;a.exports=function(M){return new w(M)};function w(A){b.call(this),typeof A=="string"&&(A={text:A}),this._opt=m({},A),A&&this.update(A)}u(w,b),w.prototype.update=function(A){if(typeof A=="string"&&(A={text:A}),A=m({},this._opt,A),!A.font)throw new TypeError("must specify a { font } in options");this.layout=o(A);var M=A.flipY!==!1,S=A.font,E=S.common.scaleW,T=S.common.scaleH,C=this.layout.glyphs.filter(function(X){var Y=X.data;return Y.width*Y.height>0});this.visibleGlyphs=C;var L=g.positions(C),P=g.uvs(C,E,T,M),N=f({clockwise:!0,type:"uint16",count:C.length});if(v.index(this,N,1,"uint16"),v.attr(this,"position",L,2),v.attr(this,"uv",P,2),!A.multipage&&"page"in this.attributes)this.removeAttribute("page");else if(A.multipage){var F=g.pages(C);v.attr(this,"page",F,1)}},w.prototype.computeBoundingSphere=function(){this.boundingSphere===null&&(this.boundingSphere=new THREE.Sphere);var A=this.attributes.position.array,M=this.attributes.position.itemSize;if(!A||!M||A.length<2){this.boundingSphere.radius=0,this.boundingSphere.center.set(0,0,0);return}y.computeSphere(A,this.boundingSphere),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')},w.prototype.computeBoundingBox=function(){this.boundingBox===null&&(this.boundingBox=new THREE.Box3);var A=this.boundingBox,M=this.attributes.position.array,S=this.attributes.position.itemSize;if(!M||!S||M.length<2){A.makeEmpty();return}y.computeBox(M,A)}},{"./lib/utils":64,"./lib/vertices":65,inherits:30,"layout-bmfont-text":36,"object-assign":39,"quad-indices":51,"three-buffer-vertex-data":66}],64:[function(r,a,s){var o=2,u={min:[0,0],max:[0,0]};function f(v){var m=v.length/o;u.min[0]=v[0],u.min[1]=v[1],u.max[0]=v[0],u.max[1]=v[1];for(var g=0;g<m;g++){var y=v[g*o+0],b=v[g*o+1];u.min[0]=Math.min(y,u.min[0]),u.min[1]=Math.min(b,u.min[1]),u.max[0]=Math.max(y,u.max[0]),u.max[1]=Math.max(b,u.max[1])}}a.exports.computeBox=function(v,m){f(v),m.min.set(u.min[0],u.min[1],0),m.max.set(u.max[0],u.max[1],0)},a.exports.computeSphere=function(v,m){f(v);var g=u.min[0],y=u.min[1],b=u.max[0],w=u.max[1],A=b-g,M=w-y,S=Math.sqrt(A*A+M*M);m.center.set(g+A/2,y+M/2,0),m.radius=S/2}},{}],65:[function(r,a,s){a.exports.pages=function(u){var f=new Float32Array(u.length*4*1),v=0;return u.forEach(function(m){var g=m.data.page||0;f[v++]=g,f[v++]=g,f[v++]=g,f[v++]=g}),f},a.exports.uvs=function(u,f,v,m){var g=new Float32Array(u.length*4*2),y=0;return u.forEach(function(b){var w=b.data,A=w.x+w.width,M=w.y+w.height,S=w.x/f,E=w.y/v,T=A/f,C=M/v;m&&(E=(v-w.y)/v,C=(v-M)/v),g[y++]=S,g[y++]=E,g[y++]=S,g[y++]=C,g[y++]=T,g[y++]=C,g[y++]=T,g[y++]=E}),g},a.exports.positions=function(u){var f=new Float32Array(u.length*4*2),v=0;return u.forEach(function(m){var g=m.data,y=m.position[0]+g.xoffset,b=m.position[1]+g.yoffset,w=g.width,A=g.height;f[v++]=y,f[v++]=b,f[v++]=y,f[v++]=b+A,f[v++]=y+w,f[v++]=b+A,f[v++]=y+w,f[v++]=b}),f}},{}],66:[function(r,a,s){var o=r("flatten-vertex-data");a.exports.attr=f,a.exports.index=u;function u(m,g,y,b){typeof y!="number"&&(y=1),typeof b!="string"&&(b="uint16");var w=!m.index&&typeof m.setIndex!="function",A=w?m.getAttribute("index"):m.index,M=v(A,g,y,b);M&&(w?m.addAttribute("index",M):m.index=M)}function f(m,g,y,b,w){if(typeof b!="number"&&(b=3),typeof w!="string"&&(w="float32"),Array.isArray(y)&&Array.isArray(y[0])&&y[0].length!==b)throw new Error("Nested vertex array has unexpected size; expected "+b+" but found "+y[0].length);var A=m.getAttribute(g),M=v(A,y,b,w);m.setAttribute(g,M)}function v(m,g,y,b){return g=g||[],g=o(g,b),m=new THREE.BufferAttribute(g,y),m.itemSize=y,m.needsUpdate=!0,m}},{"flatten-vertex-data":23}],67:[function(r,a,s){(function(o,u){var f=r("process/browser.js").nextTick,v=Function.prototype.apply,m=Array.prototype.slice,g={},y=0;s.setTimeout=function(){return new b(v.call(setTimeout,window,arguments),clearTimeout)},s.setInterval=function(){return new b(v.call(setInterval,window,arguments),clearInterval)},s.clearTimeout=s.clearInterval=function(w){w.close()};function b(w,A){this._id=w,this._clearFn=A}b.prototype.unref=b.prototype.ref=function(){},b.prototype.close=function(){this._clearFn.call(window,this._id)},s.enroll=function(w,A){clearTimeout(w._idleTimeoutId),w._idleTimeout=A},s.unenroll=function(w){clearTimeout(w._idleTimeoutId),w._idleTimeout=-1},s._unrefActive=s.active=function(w){clearTimeout(w._idleTimeoutId);var A=w._idleTimeout;A>=0&&(w._idleTimeoutId=setTimeout(function(){w._onTimeout&&w._onTimeout()},A))},s.setImmediate=typeof o=="function"?o:function(w){var A=y++,M=arguments.length<2?!1:m.call(arguments,1);return g[A]=!0,f(function(){g[A]&&(M?w.apply(null,M):w.call(null),s.clearImmediate(A))}),A},s.clearImmediate=typeof u=="function"?u:function(w){delete g[w]}}).call(this,r("timers").setImmediate,r("timers").clearImmediate)},{"process/browser.js":49,timers:67}],68:[function(r,a,s){(function(o){/**
 * @license
 * webvr-polyfill
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * cardboard-vr-display
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * webvr-polyfill-dpdb 
 * Copyright (c) 2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * wglu-preserve-state
 * Copyright (c) 2016, Brandon Jones.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *//**
 * @license
 * nosleep.js
 * Copyright (c) 2017, Rich Tibbett
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */(function(u,f){typeof s=="object"&&typeof a!="undefined"?a.exports=f():u.WebVRPolyfill=f()})(this,function(){var u=typeof window!="undefined"?window:typeof o!="undefined"?o:typeof self!="undefined"?self:{};function f(L){return L&&L.__esModule&&Object.prototype.hasOwnProperty.call(L,"default")?L.default:L}function v(L,P){return P={exports:{}},L(P,P.exports),P.exports}var m=function(){return/Android/i.test(navigator.userAgent)||/iPhone|iPad|iPod/i.test(navigator.userAgent)},g=function(P,N){for(var F=0,X=P.length;F<X;F++)N[F]=P[F]},y=function(P,N){for(var F in N)N.hasOwnProperty(F)&&(P[F]=N[F]);return P},b=v(function(L,P){/**
 * @license
 * cardboard-vr-display
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * gl-preserve-state
 * Copyright (c) 2016, Brandon Jones.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *//**
 * @license
 * webvr-polyfill-dpdb
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * nosleep.js
 * Copyright (c) 2017, Rich Tibbett
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */(function(N,F){L.exports=F()})(u,function(){var N=function(Z,ie){if(!(Z instanceof ie))throw new TypeError("Cannot call a class as a function")},F=function(){function Z(ie,be){for(var Ae=0;Ae<be.length;Ae++){var ze=be[Ae];ze.enumerable=ze.enumerable||!1,ze.configurable=!0,"value"in ze&&(ze.writable=!0),Object.defineProperty(ie,ze.key,ze)}}return function(ie,be,Ae){return be&&Z(ie.prototype,be),Ae&&Z(ie,Ae),ie}}(),X=function(){function Z(ie,be){var Ae=[],ze=!0,ft=!1,Ct=void 0;try{for(var Xt=ie[Symbol.iterator](),Et;!(ze=(Et=Xt.next()).done)&&(Ae.push(Et.value),!(be&&Ae.length===be));ze=!0);}catch(wt){ft=!0,Ct=wt}finally{try{!ze&&Xt.return&&Xt.return()}finally{if(ft)throw Ct}}return Ae}return function(ie,be){if(Array.isArray(ie))return ie;if(Symbol.iterator in Object(ie))return Z(ie,be);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),Y=.001,ae=1,$=function(ie,be){return"data:"+ie+","+encodeURIComponent(be)},de=function(ie,be,Ae){return ie+(be-ie)*Ae},D=function(){var Z=/iPad|iPhone|iPod/.test(navigator.platform);return function(){return Z}}(),I=function(){var Z=navigator.userAgent.indexOf("Version")!==-1&&navigator.userAgent.indexOf("Android")!==-1&&navigator.userAgent.indexOf("Chrome")!==-1;return function(){return Z}}(),k=function(){var Z=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);return function(){return Z}}(),U=function(){var Z=navigator.userAgent.indexOf("Firefox")!==-1&&navigator.userAgent.indexOf("Android")!==-1;return function(){return Z}}(),W=function(){var Z=navigator.userAgent.match(/.*Chrome\/([0-9]+)/),ie=Z?parseInt(Z[1],10):null;return function(){return ie}}(),ce=function(){var Z=!1;return Z=D()&&k()&&navigator.userAgent.indexOf("13_4")!==-1,function(){return Z}}(),oe=function(){var Z=!1;if(W()===65){var ie=navigator.userAgent.match(/.*Chrome\/([0-9\.]*)/);if(ie){var be=ie[1].split("."),Ae=X(be,4);Ae[0],Ae[1];var ze=Ae[2],ft=Ae[3];Z=parseInt(ze,10)===3325&&parseInt(ft,10)<148}}return function(){return Z}}(),ge=function(){var Z=navigator.userAgent.indexOf("R7 Build")!==-1;return function(){return Z}}(),_e=function(){var ie=window.orientation==90||window.orientation==-90;return ge()?!ie:ie},Ne=function(ie){return!(isNaN(ie)||ie<=Y||ie>ae)},Ie=function(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio},Ve=function(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio},Le=function(ie){if(I())return!1;if(ie.requestFullscreen)ie.requestFullscreen();else if(ie.webkitRequestFullscreen)ie.webkitRequestFullscreen();else if(ie.mozRequestFullScreen)ie.mozRequestFullScreen();else if(ie.msRequestFullscreen)ie.msRequestFullscreen();else return!1;return!0},Fe=function(){if(document.exitFullscreen)document.exitFullscreen();else if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else if(document.msExitFullscreen)document.msExitFullscreen();else return!1;return!0},Me=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},Qe=function(ie,be,Ae,ze){var ft=ie.createShader(ie.VERTEX_SHADER);ie.shaderSource(ft,be),ie.compileShader(ft);var Ct=ie.createShader(ie.FRAGMENT_SHADER);ie.shaderSource(Ct,Ae),ie.compileShader(Ct);var Xt=ie.createProgram();ie.attachShader(Xt,ft),ie.attachShader(Xt,Ct);for(var Et in ze)ie.bindAttribLocation(Xt,ze[Et],Et);return ie.linkProgram(Xt),ie.deleteShader(ft),ie.deleteShader(Ct),Xt},mt=function(ie,be){for(var Ae={},ze=ie.getProgramParameter(be,ie.ACTIVE_UNIFORMS),ft="",Ct=0;Ct<ze;Ct++){var Xt=ie.getActiveUniform(be,Ct);ft=Xt.name.replace("[0]",""),Ae[ft]=ie.getUniformLocation(be,ft)}return Ae},ht=function(ie,be,Ae,ze,ft,Ct,Xt){var Et=1/(be-Ae),wt=1/(ze-ft),se=1/(Ct-Xt);return ie[0]=-2*Et,ie[1]=0,ie[2]=0,ie[3]=0,ie[4]=0,ie[5]=-2*wt,ie[6]=0,ie[7]=0,ie[8]=0,ie[9]=0,ie[10]=2*se,ie[11]=0,ie[12]=(be+Ae)*Et,ie[13]=(ft+ze)*wt,ie[14]=(Xt+Ct)*se,ie[15]=1,ie},ye=function(){var ie=!1;return function(be){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(be)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(be.substr(0,4)))&&(ie=!0)}(navigator.userAgent||navigator.vendor||window.opera),ie},fe=function(ie,be){for(var Ae in be)be.hasOwnProperty(Ae)&&(ie[Ae]=be[Ae]);return ie},H=function(ie){if(D()){var be=ie.style.width,Ae=ie.style.height;ie.style.width=parseInt(be)+1+"px",ie.style.height=parseInt(Ae)+"px",setTimeout(function(){ie.style.width=be,ie.style.height=Ae},100)}window.canvas=ie},j=function(){var Z=Math.PI/180,ie=Math.PI*.25;function be(wt,se,he,Te){var Pe=Math.tan(se?se.upDegrees*Z:ie),Ce=Math.tan(se?se.downDegrees*Z:ie),pt=Math.tan(se?se.leftDegrees*Z:ie),Rt=Math.tan(se?se.rightDegrees*Z:ie),Bt=2/(pt+Rt),Kt=2/(Pe+Ce);return wt[0]=Bt,wt[1]=0,wt[2]=0,wt[3]=0,wt[4]=0,wt[5]=Kt,wt[6]=0,wt[7]=0,wt[8]=-((pt-Rt)*Bt*.5),wt[9]=(Pe-Ce)*Kt*.5,wt[10]=Te/(he-Te),wt[11]=-1,wt[12]=0,wt[13]=0,wt[14]=Te*he/(he-Te),wt[15]=0,wt}function Ae(wt,se,he){var Te=se[0],Pe=se[1],Ce=se[2],pt=se[3],Rt=Te+Te,Bt=Pe+Pe,Kt=Ce+Ce,hn=Te*Rt,Qt=Te*Bt,on=Te*Kt,$n=Pe*Bt,kn=Pe*Kt,Un=Ce*Kt,fn=pt*Rt,Hn=pt*Bt,nr=pt*Kt;return wt[0]=1-($n+Un),wt[1]=Qt+nr,wt[2]=on-Hn,wt[3]=0,wt[4]=Qt-nr,wt[5]=1-(hn+Un),wt[6]=kn+fn,wt[7]=0,wt[8]=on+Hn,wt[9]=kn-fn,wt[10]=1-(hn+$n),wt[11]=0,wt[12]=he[0],wt[13]=he[1],wt[14]=he[2],wt[15]=1,wt}function ze(wt,se,he){var Te=he[0],Pe=he[1],Ce=he[2],pt,Rt,Bt,Kt,hn,Qt,on,$n,kn,Un,fn,Hn;return se===wt?(wt[12]=se[0]*Te+se[4]*Pe+se[8]*Ce+se[12],wt[13]=se[1]*Te+se[5]*Pe+se[9]*Ce+se[13],wt[14]=se[2]*Te+se[6]*Pe+se[10]*Ce+se[14],wt[15]=se[3]*Te+se[7]*Pe+se[11]*Ce+se[15]):(pt=se[0],Rt=se[1],Bt=se[2],Kt=se[3],hn=se[4],Qt=se[5],on=se[6],$n=se[7],kn=se[8],Un=se[9],fn=se[10],Hn=se[11],wt[0]=pt,wt[1]=Rt,wt[2]=Bt,wt[3]=Kt,wt[4]=hn,wt[5]=Qt,wt[6]=on,wt[7]=$n,wt[8]=kn,wt[9]=Un,wt[10]=fn,wt[11]=Hn,wt[12]=pt*Te+hn*Pe+kn*Ce+se[12],wt[13]=Rt*Te+Qt*Pe+Un*Ce+se[13],wt[14]=Bt*Te+on*Pe+fn*Ce+se[14],wt[15]=Kt*Te+$n*Pe+Hn*Ce+se[15]),wt}function ft(wt,se){var he=se[0],Te=se[1],Pe=se[2],Ce=se[3],pt=se[4],Rt=se[5],Bt=se[6],Kt=se[7],hn=se[8],Qt=se[9],on=se[10],$n=se[11],kn=se[12],Un=se[13],fn=se[14],Hn=se[15],nr=he*Rt-Te*pt,Tr=he*Bt-Pe*pt,Dr=he*Kt-Ce*pt,Vr=Te*Bt-Pe*Rt,ir=Te*Kt-Ce*Rt,ri=Pe*Kt-Ce*Bt,Nn=hn*Un-Qt*kn,ya=hn*fn-on*kn,ba=hn*Hn-$n*kn,vo=Qt*fn-on*Un,Qs=Qt*Hn-$n*Un,rc=on*Hn-$n*fn,Li=nr*rc-Tr*Qs+Dr*vo+Vr*ba-ir*ya+ri*Nn;return Li?(Li=1/Li,wt[0]=(Rt*rc-Bt*Qs+Kt*vo)*Li,wt[1]=(Pe*Qs-Te*rc-Ce*vo)*Li,wt[2]=(Un*ri-fn*ir+Hn*Vr)*Li,wt[3]=(on*ir-Qt*ri-$n*Vr)*Li,wt[4]=(Bt*ba-pt*rc-Kt*ya)*Li,wt[5]=(he*rc-Pe*ba+Ce*ya)*Li,wt[6]=(fn*Dr-kn*ri-Hn*Tr)*Li,wt[7]=(hn*ri-on*Dr+$n*Tr)*Li,wt[8]=(pt*Qs-Rt*ba+Kt*Nn)*Li,wt[9]=(Te*ba-he*Qs-Ce*Nn)*Li,wt[10]=(kn*ir-Un*Dr+Hn*nr)*Li,wt[11]=(Qt*Dr-hn*ir-$n*nr)*Li,wt[12]=(Rt*ya-pt*vo-Bt*Nn)*Li,wt[13]=(he*vo-Te*ya+Pe*Nn)*Li,wt[14]=(Un*Tr-kn*Vr-fn*nr)*Li,wt[15]=(hn*Vr-Qt*Tr+on*nr)*Li,wt):null}var Ct=new Float32Array([0,0,0,1]),Xt=new Float32Array([0,0,0]);function Et(wt,se,he,Te,Pe,Ce){be(wt,Te||null,Ce.depthNear,Ce.depthFar);var pt=he.orientation||Ct,Rt=he.position||Xt;Ae(se,pt,Rt),Pe&&ze(se,se,Pe),ft(se,se)}return function(wt,se,he){return!wt||!se?!1:(wt.pose=se,wt.timestamp=se.timestamp,Et(wt.leftProjectionMatrix,wt.leftViewMatrix,se,he._getFieldOfView("left"),he._getEyeOffset("left"),he),Et(wt.rightProjectionMatrix,wt.rightViewMatrix,se,he._getFieldOfView("right"),he._getEyeOffset("right"),he),!0)}}(),q=function(){var ie=window.self!==window.top,be=pe(document.referrer),Ae=pe(window.location.href);return ie&&be!==Ae},pe=function(ie){var be,Ae=ie.indexOf("://");Ae!==-1?be=Ae+3:be=0;var ze=ie.indexOf("/",be);return ze===-1&&(ze=ie.length),ie.substring(0,ze)},ee=function(ie){if(ie.w>1)return console.warn("getQuaternionAngle: w > 1"),0;var be=2*Math.acos(ie.w);return be},te=function(){var Z={};return function(ie,be){Z[ie]===void 0&&(console.warn("webvr-polyfill: "+be),Z[ie]=!0)}}(),Se=function(ie,be){var Ae=be?"Please use "+be+" instead.":"";te(ie,ie+" has been deprecated. This may not work on native WebVR displays. "+Ae)};function ke(Z,ie,be){if(!ie){be(Z);return}for(var Ae=[],ze=null,ft=0;ft<ie.length;++ft){var Ct=ie[ft];switch(Ct){case Z.TEXTURE_BINDING_2D:case Z.TEXTURE_BINDING_CUBE_MAP:var Xt=ie[++ft];if(Xt<Z.TEXTURE0||Xt>Z.TEXTURE31){console.error("TEXTURE_BINDING_2D or TEXTURE_BINDING_CUBE_MAP must be followed by a valid texture unit"),Ae.push(null,null);break}ze||(ze=Z.getParameter(Z.ACTIVE_TEXTURE)),Z.activeTexture(Xt),Ae.push(Z.getParameter(Ct),null);break;case Z.ACTIVE_TEXTURE:ze=Z.getParameter(Z.ACTIVE_TEXTURE),Ae.push(null);break;default:Ae.push(Z.getParameter(Ct));break}}be(Z);for(var ft=0;ft<ie.length;++ft){var Ct=ie[ft],Et=Ae[ft];switch(Ct){case Z.ACTIVE_TEXTURE:break;case Z.ARRAY_BUFFER_BINDING:Z.bindBuffer(Z.ARRAY_BUFFER,Et);break;case Z.COLOR_CLEAR_VALUE:Z.clearColor(Et[0],Et[1],Et[2],Et[3]);break;case Z.COLOR_WRITEMASK:Z.colorMask(Et[0],Et[1],Et[2],Et[3]);break;case Z.CURRENT_PROGRAM:Z.useProgram(Et);break;case Z.ELEMENT_ARRAY_BUFFER_BINDING:Z.bindBuffer(Z.ELEMENT_ARRAY_BUFFER,Et);break;case Z.FRAMEBUFFER_BINDING:Z.bindFramebuffer(Z.FRAMEBUFFER,Et);break;case Z.RENDERBUFFER_BINDING:Z.bindRenderbuffer(Z.RENDERBUFFER,Et);break;case Z.TEXTURE_BINDING_2D:var Xt=ie[++ft];if(Xt<Z.TEXTURE0||Xt>Z.TEXTURE31)break;Z.activeTexture(Xt),Z.bindTexture(Z.TEXTURE_2D,Et);break;case Z.TEXTURE_BINDING_CUBE_MAP:var Xt=ie[++ft];if(Xt<Z.TEXTURE0||Xt>Z.TEXTURE31)break;Z.activeTexture(Xt),Z.bindTexture(Z.TEXTURE_CUBE_MAP,Et);break;case Z.VIEWPORT:Z.viewport(Et[0],Et[1],Et[2],Et[3]);break;case Z.BLEND:case Z.CULL_FACE:case Z.DEPTH_TEST:case Z.SCISSOR_TEST:case Z.STENCIL_TEST:Et?Z.enable(Ct):Z.disable(Ct);break;default:console.log("No GL restore behavior for 0x"+Ct.toString(16));break}ze&&Z.activeTexture(ze)}}var Be=ke,We=["attribute vec2 position;","attribute vec3 texCoord;","varying vec2 vTexCoord;","uniform vec4 viewportOffsetScale[2];","void main() {","  vec4 viewport = viewportOffsetScale[int(texCoord.z)];","  vTexCoord = (texCoord.xy * viewport.zw) + viewport.xy;","  gl_Position = vec4( position, 1.0, 1.0 );","}"].join(`
`),ve=["precision mediump float;","uniform sampler2D diffuse;","varying vec2 vTexCoord;","void main() {","  gl_FragColor = texture2D(diffuse, vTexCoord);","}"].join(`
`);function K(Z,ie,be,Ae){this.gl=Z,this.cardboardUI=ie,this.bufferScale=be,this.dirtySubmitFrameBindings=Ae,this.ctxAttribs=Z.getContextAttributes(),this.instanceExt=Z.getExtension("ANGLE_instanced_arrays"),this.meshWidth=20,this.meshHeight=20,this.bufferWidth=Z.drawingBufferWidth,this.bufferHeight=Z.drawingBufferHeight,this.realBindFramebuffer=Z.bindFramebuffer,this.realEnable=Z.enable,this.realDisable=Z.disable,this.realColorMask=Z.colorMask,this.realClearColor=Z.clearColor,this.realViewport=Z.viewport,D()||(this.realCanvasWidth=Object.getOwnPropertyDescriptor(Z.canvas.__proto__,"width"),this.realCanvasHeight=Object.getOwnPropertyDescriptor(Z.canvas.__proto__,"height")),this.isPatched=!1,this.lastBoundFramebuffer=null,this.cullFace=!1,this.depthTest=!1,this.blend=!1,this.scissorTest=!1,this.stencilTest=!1,this.viewport=[0,0,0,0],this.colorMask=[!0,!0,!0,!0],this.clearColor=[0,0,0,0],this.attribs={position:0,texCoord:1},this.program=Qe(Z,We,ve,this.attribs),this.uniforms=mt(Z,this.program),this.viewportOffsetScale=new Float32Array(8),this.setTextureBounds(),this.vertexBuffer=Z.createBuffer(),this.indexBuffer=Z.createBuffer(),this.indexCount=0,this.renderTarget=Z.createTexture(),this.framebuffer=Z.createFramebuffer(),this.depthStencilBuffer=null,this.depthBuffer=null,this.stencilBuffer=null,this.ctxAttribs.depth&&this.ctxAttribs.stencil?this.depthStencilBuffer=Z.createRenderbuffer():this.ctxAttribs.depth?this.depthBuffer=Z.createRenderbuffer():this.ctxAttribs.stencil&&(this.stencilBuffer=Z.createRenderbuffer()),this.patch(),this.onResize()}K.prototype.destroy=function(){var Z=this.gl;this.unpatch(),Z.deleteProgram(this.program),Z.deleteBuffer(this.vertexBuffer),Z.deleteBuffer(this.indexBuffer),Z.deleteTexture(this.renderTarget),Z.deleteFramebuffer(this.framebuffer),this.depthStencilBuffer&&Z.deleteRenderbuffer(this.depthStencilBuffer),this.depthBuffer&&Z.deleteRenderbuffer(this.depthBuffer),this.stencilBuffer&&Z.deleteRenderbuffer(this.stencilBuffer),this.cardboardUI&&this.cardboardUI.destroy()},K.prototype.onResize=function(){var Z=this.gl,ie=this,be=[Z.RENDERBUFFER_BINDING,Z.TEXTURE_BINDING_2D,Z.TEXTURE0];Be(Z,be,function(Ae){ie.realBindFramebuffer.call(Ae,Ae.FRAMEBUFFER,null),ie.scissorTest&&ie.realDisable.call(Ae,Ae.SCISSOR_TEST),ie.realColorMask.call(Ae,!0,!0,!0,!0),ie.realViewport.call(Ae,0,0,Ae.drawingBufferWidth,Ae.drawingBufferHeight),ie.realClearColor.call(Ae,0,0,0,1),Ae.clear(Ae.COLOR_BUFFER_BIT),ie.realBindFramebuffer.call(Ae,Ae.FRAMEBUFFER,ie.framebuffer),Ae.bindTexture(Ae.TEXTURE_2D,ie.renderTarget),Ae.texImage2D(Ae.TEXTURE_2D,0,ie.ctxAttribs.alpha?Ae.RGBA:Ae.RGB,ie.bufferWidth,ie.bufferHeight,0,ie.ctxAttribs.alpha?Ae.RGBA:Ae.RGB,Ae.UNSIGNED_BYTE,null),Ae.texParameteri(Ae.TEXTURE_2D,Ae.TEXTURE_MAG_FILTER,Ae.LINEAR),Ae.texParameteri(Ae.TEXTURE_2D,Ae.TEXTURE_MIN_FILTER,Ae.LINEAR),Ae.texParameteri(Ae.TEXTURE_2D,Ae.TEXTURE_WRAP_S,Ae.CLAMP_TO_EDGE),Ae.texParameteri(Ae.TEXTURE_2D,Ae.TEXTURE_WRAP_T,Ae.CLAMP_TO_EDGE),Ae.framebufferTexture2D(Ae.FRAMEBUFFER,Ae.COLOR_ATTACHMENT0,Ae.TEXTURE_2D,ie.renderTarget,0),ie.ctxAttribs.depth&&ie.ctxAttribs.stencil?(Ae.bindRenderbuffer(Ae.RENDERBUFFER,ie.depthStencilBuffer),Ae.renderbufferStorage(Ae.RENDERBUFFER,Ae.DEPTH_STENCIL,ie.bufferWidth,ie.bufferHeight),Ae.framebufferRenderbuffer(Ae.FRAMEBUFFER,Ae.DEPTH_STENCIL_ATTACHMENT,Ae.RENDERBUFFER,ie.depthStencilBuffer)):ie.ctxAttribs.depth?(Ae.bindRenderbuffer(Ae.RENDERBUFFER,ie.depthBuffer),Ae.renderbufferStorage(Ae.RENDERBUFFER,Ae.DEPTH_COMPONENT16,ie.bufferWidth,ie.bufferHeight),Ae.framebufferRenderbuffer(Ae.FRAMEBUFFER,Ae.DEPTH_ATTACHMENT,Ae.RENDERBUFFER,ie.depthBuffer)):ie.ctxAttribs.stencil&&(Ae.bindRenderbuffer(Ae.RENDERBUFFER,ie.stencilBuffer),Ae.renderbufferStorage(Ae.RENDERBUFFER,Ae.STENCIL_INDEX8,ie.bufferWidth,ie.bufferHeight),Ae.framebufferRenderbuffer(Ae.FRAMEBUFFER,Ae.STENCIL_ATTACHMENT,Ae.RENDERBUFFER,ie.stencilBuffer)),!Ae.checkFramebufferStatus(Ae.FRAMEBUFFER)===Ae.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer incomplete!"),ie.realBindFramebuffer.call(Ae,Ae.FRAMEBUFFER,ie.lastBoundFramebuffer),ie.scissorTest&&ie.realEnable.call(Ae,Ae.SCISSOR_TEST),ie.realColorMask.apply(Ae,ie.colorMask),ie.realViewport.apply(Ae,ie.viewport),ie.realClearColor.apply(Ae,ie.clearColor)}),this.cardboardUI&&this.cardboardUI.onResize()},K.prototype.patch=function(){if(!this.isPatched){var Z=this,ie=this.gl.canvas,be=this.gl;D()||(ie.width=Ie()*this.bufferScale,ie.height=Ve()*this.bufferScale,Object.defineProperty(ie,"width",{configurable:!0,enumerable:!0,get:function(){return Z.bufferWidth},set:function(ze){Z.bufferWidth=ze,Z.realCanvasWidth.set.call(ie,ze),Z.onResize()}}),Object.defineProperty(ie,"height",{configurable:!0,enumerable:!0,get:function(){return Z.bufferHeight},set:function(ze){Z.bufferHeight=ze,Z.realCanvasHeight.set.call(ie,ze),Z.onResize()}})),this.lastBoundFramebuffer=be.getParameter(be.FRAMEBUFFER_BINDING),this.lastBoundFramebuffer==null&&(this.lastBoundFramebuffer=this.framebuffer,this.gl.bindFramebuffer(be.FRAMEBUFFER,this.framebuffer)),this.gl.bindFramebuffer=function(Ae,ze){Z.lastBoundFramebuffer=ze||Z.framebuffer,Z.realBindFramebuffer.call(be,Ae,Z.lastBoundFramebuffer)},this.cullFace=be.getParameter(be.CULL_FACE),this.depthTest=be.getParameter(be.DEPTH_TEST),this.blend=be.getParameter(be.BLEND),this.scissorTest=be.getParameter(be.SCISSOR_TEST),this.stencilTest=be.getParameter(be.STENCIL_TEST),be.enable=function(Ae){switch(Ae){case be.CULL_FACE:Z.cullFace=!0;break;case be.DEPTH_TEST:Z.depthTest=!0;break;case be.BLEND:Z.blend=!0;break;case be.SCISSOR_TEST:Z.scissorTest=!0;break;case be.STENCIL_TEST:Z.stencilTest=!0;break}Z.realEnable.call(be,Ae)},be.disable=function(Ae){switch(Ae){case be.CULL_FACE:Z.cullFace=!1;break;case be.DEPTH_TEST:Z.depthTest=!1;break;case be.BLEND:Z.blend=!1;break;case be.SCISSOR_TEST:Z.scissorTest=!1;break;case be.STENCIL_TEST:Z.stencilTest=!1;break}Z.realDisable.call(be,Ae)},this.colorMask=be.getParameter(be.COLOR_WRITEMASK),be.colorMask=function(Ae,ze,ft,Ct){Z.colorMask[0]=Ae,Z.colorMask[1]=ze,Z.colorMask[2]=ft,Z.colorMask[3]=Ct,Z.realColorMask.call(be,Ae,ze,ft,Ct)},this.clearColor=be.getParameter(be.COLOR_CLEAR_VALUE),be.clearColor=function(Ae,ze,ft,Ct){Z.clearColor[0]=Ae,Z.clearColor[1]=ze,Z.clearColor[2]=ft,Z.clearColor[3]=Ct,Z.realClearColor.call(be,Ae,ze,ft,Ct)},this.viewport=be.getParameter(be.VIEWPORT),be.viewport=function(Ae,ze,ft,Ct){Z.viewport[0]=Ae,Z.viewport[1]=ze,Z.viewport[2]=ft,Z.viewport[3]=Ct,Z.realViewport.call(be,Ae,ze,ft,Ct)},this.isPatched=!0,H(ie)}},K.prototype.unpatch=function(){if(!!this.isPatched){var Z=this.gl,ie=this.gl.canvas;D()||(Object.defineProperty(ie,"width",this.realCanvasWidth),Object.defineProperty(ie,"height",this.realCanvasHeight)),ie.width=this.bufferWidth,ie.height=this.bufferHeight,Z.bindFramebuffer=this.realBindFramebuffer,Z.enable=this.realEnable,Z.disable=this.realDisable,Z.colorMask=this.realColorMask,Z.clearColor=this.realClearColor,Z.viewport=this.realViewport,this.lastBoundFramebuffer==this.framebuffer&&Z.bindFramebuffer(Z.FRAMEBUFFER,null),this.isPatched=!1,setTimeout(function(){H(ie)},1)}},K.prototype.setTextureBounds=function(Z,ie){Z||(Z=[0,0,.5,1]),ie||(ie=[.5,0,.5,1]),this.viewportOffsetScale[0]=Z[0],this.viewportOffsetScale[1]=Z[1],this.viewportOffsetScale[2]=Z[2],this.viewportOffsetScale[3]=Z[3],this.viewportOffsetScale[4]=ie[0],this.viewportOffsetScale[5]=ie[1],this.viewportOffsetScale[6]=ie[2],this.viewportOffsetScale[7]=ie[3]},K.prototype.submitFrame=function(){var Z=this.gl,ie=this,be=[];if(this.dirtySubmitFrameBindings||be.push(Z.CURRENT_PROGRAM,Z.ARRAY_BUFFER_BINDING,Z.ELEMENT_ARRAY_BUFFER_BINDING,Z.TEXTURE_BINDING_2D,Z.TEXTURE0),Be(Z,be,function(ze){ie.realBindFramebuffer.call(ze,ze.FRAMEBUFFER,null);var ft=0,Ct=0;ie.instanceExt&&(ft=ze.getVertexAttrib(ie.attribs.position,ie.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE),Ct=ze.getVertexAttrib(ie.attribs.texCoord,ie.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE)),ie.cullFace&&ie.realDisable.call(ze,ze.CULL_FACE),ie.depthTest&&ie.realDisable.call(ze,ze.DEPTH_TEST),ie.blend&&ie.realDisable.call(ze,ze.BLEND),ie.scissorTest&&ie.realDisable.call(ze,ze.SCISSOR_TEST),ie.stencilTest&&ie.realDisable.call(ze,ze.STENCIL_TEST),ie.realColorMask.call(ze,!0,!0,!0,!0),ie.realViewport.call(ze,0,0,ze.drawingBufferWidth,ze.drawingBufferHeight),(ie.ctxAttribs.alpha||D())&&(ie.realClearColor.call(ze,0,0,0,1),ze.clear(ze.COLOR_BUFFER_BIT)),ze.useProgram(ie.program),ze.bindBuffer(ze.ELEMENT_ARRAY_BUFFER,ie.indexBuffer),ze.bindBuffer(ze.ARRAY_BUFFER,ie.vertexBuffer),ze.enableVertexAttribArray(ie.attribs.position),ze.enableVertexAttribArray(ie.attribs.texCoord),ze.vertexAttribPointer(ie.attribs.position,2,ze.FLOAT,!1,20,0),ze.vertexAttribPointer(ie.attribs.texCoord,3,ze.FLOAT,!1,20,8),ie.instanceExt&&(ft!=0&&ie.instanceExt.vertexAttribDivisorANGLE(ie.attribs.position,0),Ct!=0&&ie.instanceExt.vertexAttribDivisorANGLE(ie.attribs.texCoord,0)),ze.activeTexture(ze.TEXTURE0),ze.uniform1i(ie.uniforms.diffuse,0),ze.bindTexture(ze.TEXTURE_2D,ie.renderTarget),ze.uniform4fv(ie.uniforms.viewportOffsetScale,ie.viewportOffsetScale),ze.drawElements(ze.TRIANGLES,ie.indexCount,ze.UNSIGNED_SHORT,0),ie.cardboardUI&&ie.cardboardUI.renderNoState(),ie.realBindFramebuffer.call(ie.gl,ze.FRAMEBUFFER,ie.framebuffer),ie.ctxAttribs.preserveDrawingBuffer||(ie.realClearColor.call(ze,0,0,0,0),ze.clear(ze.COLOR_BUFFER_BIT)),ie.dirtySubmitFrameBindings||ie.realBindFramebuffer.call(ze,ze.FRAMEBUFFER,ie.lastBoundFramebuffer),ie.cullFace&&ie.realEnable.call(ze,ze.CULL_FACE),ie.depthTest&&ie.realEnable.call(ze,ze.DEPTH_TEST),ie.blend&&ie.realEnable.call(ze,ze.BLEND),ie.scissorTest&&ie.realEnable.call(ze,ze.SCISSOR_TEST),ie.stencilTest&&ie.realEnable.call(ze,ze.STENCIL_TEST),ie.realColorMask.apply(ze,ie.colorMask),ie.realViewport.apply(ze,ie.viewport),(ie.ctxAttribs.alpha||!ie.ctxAttribs.preserveDrawingBuffer)&&ie.realClearColor.apply(ze,ie.clearColor),ie.instanceExt&&(ft!=0&&ie.instanceExt.vertexAttribDivisorANGLE(ie.attribs.position,ft),Ct!=0&&ie.instanceExt.vertexAttribDivisorANGLE(ie.attribs.texCoord,Ct))}),D()){var Ae=Z.canvas;(Ae.width!=ie.bufferWidth||Ae.height!=ie.bufferHeight)&&(ie.bufferWidth=Ae.width,ie.bufferHeight=Ae.height,ie.onResize())}},K.prototype.updateDeviceInfo=function(Z){var ie=this.gl,be=this,Ae=[ie.ARRAY_BUFFER_BINDING,ie.ELEMENT_ARRAY_BUFFER_BINDING];Be(ie,Ae,function(ze){var ft=be.computeMeshVertices_(be.meshWidth,be.meshHeight,Z);if(ze.bindBuffer(ze.ARRAY_BUFFER,be.vertexBuffer),ze.bufferData(ze.ARRAY_BUFFER,ft,ze.STATIC_DRAW),!be.indexCount){var Ct=be.computeMeshIndices_(be.meshWidth,be.meshHeight);ze.bindBuffer(ze.ELEMENT_ARRAY_BUFFER,be.indexBuffer),ze.bufferData(ze.ELEMENT_ARRAY_BUFFER,Ct,ze.STATIC_DRAW),be.indexCount=Ct.length}})},K.prototype.computeMeshVertices_=function(Z,ie,be){for(var Ae=new Float32Array(2*Z*ie*5),ze=be.getLeftEyeVisibleTanAngles(),ft=be.getLeftEyeNoLensTanAngles(),Ct=be.getLeftEyeVisibleScreenRect(ft),Xt=0,Et=0;Et<2;Et++){for(var wt=0;wt<ie;wt++)for(var se=0;se<Z;se++,Xt++){var he=se/(Z-1),Te=wt/(ie-1),Pe=he,Ce=Te,pt=de(ze[0],ze[2],he),Rt=de(ze[3],ze[1],Te),Bt=Math.sqrt(pt*pt+Rt*Rt),Kt=be.distortion.distortInverse(Bt),hn=pt*Kt/Bt,Qt=Rt*Kt/Bt;he=(hn-ft[0])/(ft[2]-ft[0]),Te=(Qt-ft[3])/(ft[1]-ft[3]),he=(Ct.x+he*Ct.width-.5)*2,Te=(Ct.y+Te*Ct.height-.5)*2,Ae[Xt*5+0]=he,Ae[Xt*5+1]=Te,Ae[Xt*5+2]=Pe,Ae[Xt*5+3]=Ce,Ae[Xt*5+4]=Et}var on=ze[2]-ze[0];ze[0]=-(on+ze[0]),ze[2]=on-ze[2],on=ft[2]-ft[0],ft[0]=-(on+ft[0]),ft[2]=on-ft[2],Ct.x=1-(Ct.x+Ct.width)}return Ae},K.prototype.computeMeshIndices_=function(Z,ie){for(var be=new Uint16Array(2*(Z-1)*(ie-1)*6),Ae=Z/2,ze=ie/2,ft=0,Ct=0,Xt=0;Xt<2;Xt++)for(var Et=0;Et<ie;Et++)for(var wt=0;wt<Z;wt++,ft++)wt==0||Et==0||(wt<=Ae==Et<=ze?(be[Ct++]=ft,be[Ct++]=ft-Z-1,be[Ct++]=ft-Z,be[Ct++]=ft-Z-1,be[Ct++]=ft,be[Ct++]=ft-1):(be[Ct++]=ft-1,be[Ct++]=ft-Z,be[Ct++]=ft,be[Ct++]=ft-Z,be[Ct++]=ft-1,be[Ct++]=ft-Z-1));return be},K.prototype.getOwnPropertyDescriptor_=function(Z,ie){var be=Object.getOwnPropertyDescriptor(Z,ie);return(be.get===void 0||be.set===void 0)&&(be.configurable=!0,be.enumerable=!0,be.get=function(){return this.getAttribute(ie)},be.set=function(Ae){this.setAttribute(ie,Ae)}),be};var J=["attribute vec2 position;","uniform mat4 projectionMat;","void main() {","  gl_Position = projectionMat * vec4( position, -1.0, 1.0 );","}"].join(`
`),Ee=["precision mediump float;","uniform vec4 color;","void main() {","  gl_FragColor = color;","}"].join(`
`),xe=Math.PI/180,Je=60,Xe=12,Mt=20,qe=1,It=.75,rn=.3125,Yt=4,Tn=28,Jt=1.5;function Fn(Z){this.gl=Z,this.attribs={position:0},this.program=Qe(Z,J,Ee,this.attribs),this.uniforms=mt(Z,this.program),this.vertexBuffer=Z.createBuffer(),this.gearOffset=0,this.gearVertexCount=0,this.arrowOffset=0,this.arrowVertexCount=0,this.projMat=new Float32Array(16),this.listener=null,this.onResize()}Fn.prototype.destroy=function(){var Z=this.gl;this.listener&&Z.canvas.removeEventListener("click",this.listener,!1),Z.deleteProgram(this.program),Z.deleteBuffer(this.vertexBuffer)},Fn.prototype.listen=function(Z,ie){var be=this.gl.canvas;this.listener=function(Ae){var ze=be.clientWidth/2,ft=Tn*Jt;Ae.clientX>ze-ft&&Ae.clientX<ze+ft&&Ae.clientY>be.clientHeight-ft?Z(Ae):Ae.clientX<ft&&Ae.clientY<ft&&ie(Ae)},be.addEventListener("click",this.listener,!1)},Fn.prototype.onResize=function(){var Z=this.gl,ie=this,be=[Z.ARRAY_BUFFER_BINDING];Be(Z,be,function(Ae){var ze=[],ft=Ae.drawingBufferWidth/2,Ct=Math.max(screen.width,screen.height)*window.devicePixelRatio,Xt=Ae.drawingBufferWidth/Ct,Et=Xt*window.devicePixelRatio,wt=Yt*Et/2,se=Tn*Jt*Et,he=Tn*Et/2,Te=(Tn*Jt-Tn)*Et;ze.push(ft-wt,se),ze.push(ft-wt,Ae.drawingBufferHeight),ze.push(ft+wt,se),ze.push(ft+wt,Ae.drawingBufferHeight),ie.gearOffset=ze.length/2;function Pe(Kt,hn){var Qt=(90-Kt)*xe,on=Math.cos(Qt),$n=Math.sin(Qt);ze.push(rn*on*he+ft,rn*$n*he+he),ze.push(hn*on*he+ft,hn*$n*he+he)}for(var Ce=0;Ce<=6;Ce++){var pt=Ce*Je;Pe(pt,qe),Pe(pt+Xe,qe),Pe(pt+Mt,It),Pe(pt+(Je-Mt),It),Pe(pt+(Je-Xe),qe)}ie.gearVertexCount=ze.length/2-ie.gearOffset,ie.arrowOffset=ze.length/2;function Rt(Kt,hn){ze.push(Te+Kt,Ae.drawingBufferHeight-Te-hn)}var Bt=wt/Math.sin(45*xe);Rt(0,he),Rt(he,0),Rt(he+Bt,Bt),Rt(Bt,he+Bt),Rt(Bt,he-Bt),Rt(0,he),Rt(he,he*2),Rt(he+Bt,he*2-Bt),Rt(Bt,he-Bt),Rt(0,he),Rt(Bt,he-wt),Rt(Tn*Et,he-wt),Rt(Bt,he+wt),Rt(Tn*Et,he+wt),ie.arrowVertexCount=ze.length/2-ie.arrowOffset,Ae.bindBuffer(Ae.ARRAY_BUFFER,ie.vertexBuffer),Ae.bufferData(Ae.ARRAY_BUFFER,new Float32Array(ze),Ae.STATIC_DRAW)})},Fn.prototype.render=function(){var Z=this.gl,ie=this,be=[Z.CULL_FACE,Z.DEPTH_TEST,Z.BLEND,Z.SCISSOR_TEST,Z.STENCIL_TEST,Z.COLOR_WRITEMASK,Z.VIEWPORT,Z.CURRENT_PROGRAM,Z.ARRAY_BUFFER_BINDING];Be(Z,be,function(Ae){Ae.disable(Ae.CULL_FACE),Ae.disable(Ae.DEPTH_TEST),Ae.disable(Ae.BLEND),Ae.disable(Ae.SCISSOR_TEST),Ae.disable(Ae.STENCIL_TEST),Ae.colorMask(!0,!0,!0,!0),Ae.viewport(0,0,Ae.drawingBufferWidth,Ae.drawingBufferHeight),ie.renderNoState()})},Fn.prototype.renderNoState=function(){var Z=this.gl;Z.useProgram(this.program),Z.bindBuffer(Z.ARRAY_BUFFER,this.vertexBuffer),Z.enableVertexAttribArray(this.attribs.position),Z.vertexAttribPointer(this.attribs.position,2,Z.FLOAT,!1,8,0),Z.uniform4f(this.uniforms.color,1,1,1,1),ht(this.projMat,0,Z.drawingBufferWidth,0,Z.drawingBufferHeight,.1,1024),Z.uniformMatrix4fv(this.uniforms.projectionMat,!1,this.projMat),Z.drawArrays(Z.TRIANGLE_STRIP,0,4),Z.drawArrays(Z.TRIANGLE_STRIP,this.gearOffset,this.gearVertexCount),Z.drawArrays(Z.TRIANGLE_STRIP,this.arrowOffset,this.arrowVertexCount)};function mr(Z){this.coefficients=Z}mr.prototype.distortInverse=function(Z){for(var ie=0,be=1,Ae=Z-this.distort(ie);Math.abs(be-ie)>1e-4;){var ze=Z-this.distort(be),ft=be-ze*((be-ie)/(ze-Ae));ie=be,be=ft,Ae=ze}return be},mr.prototype.distort=function(Z){for(var ie=Z*Z,be=0,Ae=0;Ae<this.coefficients.length;Ae++)be=ie*(be+this.coefficients[Ae]);return(be+1)*Z};var fr=Math.PI/180,Dt=180/Math.PI,Ft=function(ie,be,Ae){this.x=ie||0,this.y=be||0,this.z=Ae||0};Ft.prototype={constructor:Ft,set:function(ie,be,Ae){return this.x=ie,this.y=be,this.z=Ae,this},copy:function(ie){return this.x=ie.x,this.y=ie.y,this.z=ie.z,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var ie=this.length();if(ie!==0){var be=1/ie;this.multiplyScalar(be)}else this.x=0,this.y=0,this.z=0;return this},multiplyScalar:function(ie){this.x*=ie,this.y*=ie,this.z*=ie},applyQuaternion:function(ie){var be=this.x,Ae=this.y,ze=this.z,ft=ie.x,Ct=ie.y,Xt=ie.z,Et=ie.w,wt=Et*be+Ct*ze-Xt*Ae,se=Et*Ae+Xt*be-ft*ze,he=Et*ze+ft*Ae-Ct*be,Te=-ft*be-Ct*Ae-Xt*ze;return this.x=wt*Et+Te*-ft+se*-Xt-he*-Ct,this.y=se*Et+Te*-Ct+he*-ft-wt*-Xt,this.z=he*Et+Te*-Xt+wt*-Ct-se*-ft,this},dot:function(ie){return this.x*ie.x+this.y*ie.y+this.z*ie.z},crossVectors:function(ie,be){var Ae=ie.x,ze=ie.y,ft=ie.z,Ct=be.x,Xt=be.y,Et=be.z;return this.x=ze*Et-ft*Xt,this.y=ft*Ct-Ae*Et,this.z=Ae*Xt-ze*Ct,this}};var $t=function(ie,be,Ae,ze){this.x=ie||0,this.y=be||0,this.z=Ae||0,this.w=ze!==void 0?ze:1};$t.prototype={constructor:$t,set:function(ie,be,Ae,ze){return this.x=ie,this.y=be,this.z=Ae,this.w=ze,this},copy:function(ie){return this.x=ie.x,this.y=ie.y,this.z=ie.z,this.w=ie.w,this},setFromEulerXYZ:function(ie,be,Ae){var ze=Math.cos(ie/2),ft=Math.cos(be/2),Ct=Math.cos(Ae/2),Xt=Math.sin(ie/2),Et=Math.sin(be/2),wt=Math.sin(Ae/2);return this.x=Xt*ft*Ct+ze*Et*wt,this.y=ze*Et*Ct-Xt*ft*wt,this.z=ze*ft*wt+Xt*Et*Ct,this.w=ze*ft*Ct-Xt*Et*wt,this},setFromEulerYXZ:function(ie,be,Ae){var ze=Math.cos(ie/2),ft=Math.cos(be/2),Ct=Math.cos(Ae/2),Xt=Math.sin(ie/2),Et=Math.sin(be/2),wt=Math.sin(Ae/2);return this.x=Xt*ft*Ct+ze*Et*wt,this.y=ze*Et*Ct-Xt*ft*wt,this.z=ze*ft*wt-Xt*Et*Ct,this.w=ze*ft*Ct+Xt*Et*wt,this},setFromAxisAngle:function(ie,be){var Ae=be/2,ze=Math.sin(Ae);return this.x=ie.x*ze,this.y=ie.y*ze,this.z=ie.z*ze,this.w=Math.cos(Ae),this},multiply:function(ie){return this.multiplyQuaternions(this,ie)},multiplyQuaternions:function(ie,be){var Ae=ie.x,ze=ie.y,ft=ie.z,Ct=ie.w,Xt=be.x,Et=be.y,wt=be.z,se=be.w;return this.x=Ae*se+Ct*Xt+ze*wt-ft*Et,this.y=ze*se+Ct*Et+ft*Xt-Ae*wt,this.z=ft*se+Ct*wt+Ae*Et-ze*Xt,this.w=Ct*se-Ae*Xt-ze*Et-ft*wt,this},inverse:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this.normalize(),this},normalize:function(){var ie=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return ie===0?(this.x=0,this.y=0,this.z=0,this.w=1):(ie=1/ie,this.x=this.x*ie,this.y=this.y*ie,this.z=this.z*ie,this.w=this.w*ie),this},slerp:function(ie,be){if(be===0)return this;if(be===1)return this.copy(ie);var Ae=this.x,ze=this.y,ft=this.z,Ct=this.w,Xt=Ct*ie.w+Ae*ie.x+ze*ie.y+ft*ie.z;if(Xt<0?(this.w=-ie.w,this.x=-ie.x,this.y=-ie.y,this.z=-ie.z,Xt=-Xt):this.copy(ie),Xt>=1)return this.w=Ct,this.x=Ae,this.y=ze,this.z=ft,this;var Et=Math.acos(Xt),wt=Math.sqrt(1-Xt*Xt);if(Math.abs(wt)<.001)return this.w=.5*(Ct+this.w),this.x=.5*(Ae+this.x),this.y=.5*(ze+this.y),this.z=.5*(ft+this.z),this;var se=Math.sin((1-be)*Et)/wt,he=Math.sin(be*Et)/wt;return this.w=Ct*se+this.w*he,this.x=Ae*se+this.x*he,this.y=ze*se+this.y*he,this.z=ft*se+this.z*he,this},setFromUnitVectors:function(){var Z,ie,be=1e-6;return function(Ae,ze){return Z===void 0&&(Z=new Ft),ie=Ae.dot(ze)+1,ie<be?(ie=0,Math.abs(Ae.x)>Math.abs(Ae.z)?Z.set(-Ae.y,Ae.x,0):Z.set(0,-Ae.z,Ae.y)):Z.crossVectors(Ae,ze),this.x=Z.x,this.y=Z.y,this.z=Z.z,this.w=ie,this.normalize(),this}}()};function Pn(Z){this.width=Z.width||Ie(),this.height=Z.height||Ve(),this.widthMeters=Z.widthMeters,this.heightMeters=Z.heightMeters,this.bevelMeters=Z.bevelMeters}var In=new Pn({widthMeters:.11,heightMeters:.062,bevelMeters:.004}),zn=new Pn({widthMeters:.1038,heightMeters:.0584,bevelMeters:.004}),bn={CardboardV1:new Er({id:"CardboardV1",label:"Cardboard I/O 2014",fov:40,interLensDistance:.06,baselineLensDistance:.035,screenLensDistance:.042,distortionCoefficients:[.441,.156],inverseCoefficients:[-.4410035,.42756155,-.4804439,.5460139,-.58821183,.5733938,-.48303202,.33299083,-.17573841,.0651772,-.01488963,.001559834]}),CardboardV2:new Er({id:"CardboardV2",label:"Cardboard I/O 2015",fov:60,interLensDistance:.064,baselineLensDistance:.035,screenLensDistance:.039,distortionCoefficients:[.34,.55],inverseCoefficients:[-.33836704,-.18162185,.862655,-1.2462051,1.0560602,-.58208317,.21609078,-.05444823,.009177956,-.0009904169,6183535e-11,-16981803e-13]})};function Jn(Z,ie){this.viewer=bn.CardboardV2,this.updateDeviceParams(Z),this.distortion=new mr(this.viewer.distortionCoefficients);for(var be=0;be<ie.length;be++){var Ae=ie[be];bn[Ae.id]=new Er(Ae)}}Jn.prototype.updateDeviceParams=function(Z){this.device=this.determineDevice_(Z)||this.device},Jn.prototype.getDevice=function(){return this.device},Jn.prototype.setViewer=function(Z){this.viewer=Z,this.distortion=new mr(this.viewer.distortionCoefficients)},Jn.prototype.determineDevice_=function(Z){if(!Z)return D()?(console.warn("Using fallback iOS device measurements."),zn):(console.warn("Using fallback Android device measurements."),In);var ie=.0254,be=ie/Z.xdpi,Ae=ie/Z.ydpi,ze=Ie(),ft=Ve();return new Pn({widthMeters:be*ze,heightMeters:Ae*ft,bevelMeters:Z.bevelMm*.001})},Jn.prototype.getDistortedFieldOfViewLeftEye=function(){var Z=this.viewer,ie=this.device,be=this.distortion,Ae=Z.screenLensDistance,ze=(ie.widthMeters-Z.interLensDistance)/2,ft=Z.interLensDistance/2,Ct=Z.baselineLensDistance-ie.bevelMeters,Xt=ie.heightMeters-Ct,Et=Dt*Math.atan(be.distort(ze/Ae)),wt=Dt*Math.atan(be.distort(ft/Ae)),se=Dt*Math.atan(be.distort(Ct/Ae)),he=Dt*Math.atan(be.distort(Xt/Ae));return{leftDegrees:Math.min(Et,Z.fov),rightDegrees:Math.min(wt,Z.fov),downDegrees:Math.min(se,Z.fov),upDegrees:Math.min(he,Z.fov)}},Jn.prototype.getLeftEyeVisibleTanAngles=function(){var Z=this.viewer,ie=this.device,be=this.distortion,Ae=Math.tan(-fr*Z.fov),ze=Math.tan(fr*Z.fov),ft=Math.tan(fr*Z.fov),Ct=Math.tan(-fr*Z.fov),Xt=ie.widthMeters/4,Et=ie.heightMeters/2,wt=Z.baselineLensDistance-ie.bevelMeters-Et,se=Z.interLensDistance/2-Xt,he=-wt,Te=Z.screenLensDistance,Pe=be.distort((se-Xt)/Te),Ce=be.distort((he+Et)/Te),pt=be.distort((se+Xt)/Te),Rt=be.distort((he-Et)/Te),Bt=new Float32Array(4);return Bt[0]=Math.max(Ae,Pe),Bt[1]=Math.min(ze,Ce),Bt[2]=Math.min(ft,pt),Bt[3]=Math.max(Ct,Rt),Bt},Jn.prototype.getLeftEyeNoLensTanAngles=function(){var Z=this.viewer,ie=this.device,be=this.distortion,Ae=new Float32Array(4),ze=be.distortInverse(Math.tan(-fr*Z.fov)),ft=be.distortInverse(Math.tan(fr*Z.fov)),Ct=be.distortInverse(Math.tan(fr*Z.fov)),Xt=be.distortInverse(Math.tan(-fr*Z.fov)),Et=ie.widthMeters/4,wt=ie.heightMeters/2,se=Z.baselineLensDistance-ie.bevelMeters-wt,he=Z.interLensDistance/2-Et,Te=-se,Pe=Z.screenLensDistance,Ce=(he-Et)/Pe,pt=(Te+wt)/Pe,Rt=(he+Et)/Pe,Bt=(Te-wt)/Pe;return Ae[0]=Math.max(ze,Ce),Ae[1]=Math.min(ft,pt),Ae[2]=Math.min(Ct,Rt),Ae[3]=Math.max(Xt,Bt),Ae},Jn.prototype.getLeftEyeVisibleScreenRect=function(Z){var ie=this.viewer,be=this.device,Ae=ie.screenLensDistance,ze=(be.widthMeters-ie.interLensDistance)/2,ft=ie.baselineLensDistance-be.bevelMeters,Ct=(Z[0]*Ae+ze)/be.widthMeters,Xt=(Z[1]*Ae+ft)/be.heightMeters,Et=(Z[2]*Ae+ze)/be.widthMeters,wt=(Z[3]*Ae+ft)/be.heightMeters;return{x:Ct,y:wt,width:Et-Ct,height:Xt-wt}},Jn.prototype.getFieldOfViewLeftEye=function(Z){return Z?this.getUndistortedFieldOfViewLeftEye():this.getDistortedFieldOfViewLeftEye()},Jn.prototype.getFieldOfViewRightEye=function(Z){var ie=this.getFieldOfViewLeftEye(Z);return{leftDegrees:ie.rightDegrees,rightDegrees:ie.leftDegrees,upDegrees:ie.upDegrees,downDegrees:ie.downDegrees}},Jn.prototype.getUndistortedFieldOfViewLeftEye=function(){var Z=this.getUndistortedParams_();return{leftDegrees:Dt*Math.atan(Z.outerDist),rightDegrees:Dt*Math.atan(Z.innerDist),downDegrees:Dt*Math.atan(Z.bottomDist),upDegrees:Dt*Math.atan(Z.topDist)}},Jn.prototype.getUndistortedViewportLeftEye=function(){var Z=this.getUndistortedParams_(),ie=this.viewer,be=this.device,Ae=ie.screenLensDistance,ze=be.widthMeters/Ae,ft=be.heightMeters/Ae,Ct=be.width/ze,Xt=be.height/ft,Et=Math.round((Z.eyePosX-Z.outerDist)*Ct),wt=Math.round((Z.eyePosY-Z.bottomDist)*Xt);return{x:Et,y:wt,width:Math.round((Z.eyePosX+Z.innerDist)*Ct)-Et,height:Math.round((Z.eyePosY+Z.topDist)*Xt)-wt}},Jn.prototype.getUndistortedParams_=function(){var Z=this.viewer,ie=this.device,be=this.distortion,Ae=Z.screenLensDistance,ze=Z.interLensDistance/2/Ae,ft=ie.widthMeters/Ae,Ct=ie.heightMeters/Ae,Xt=ft/2-ze,Et=(Z.baselineLensDistance-ie.bevelMeters)/Ae,wt=Z.fov,se=be.distortInverse(Math.tan(fr*wt)),he=Math.min(Xt,se),Te=Math.min(ze,se),Pe=Math.min(Et,se),Ce=Math.min(Ct-Et,se);return{outerDist:he,innerDist:Te,topDist:Ce,bottomDist:Pe,eyePosX:Xt,eyePosY:Et}};function Er(Z){this.id=Z.id,this.label=Z.label,this.fov=Z.fov,this.interLensDistance=Z.interLensDistance,this.baselineLensDistance=Z.baselineLensDistance,this.screenLensDistance=Z.screenLensDistance,this.distortionCoefficients=Z.distortionCoefficients,this.inverseCoefficients=Z.inverseCoefficients}Jn.Viewers=bn;var cr=1,gi="2019-11-09T17:36:14Z",Lr=[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X00PD/*"},{ua:"ASUS_X00PD"}],dpi:245,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X008D/*"},{ua:"ASUS_X008D"}],dpi:282,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2 XL/*"},{ua:"Pixel 2 XL"}],dpi:537.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3 XL/*"},{ua:"Pixel 3 XL"}],dpi:[558.5,553.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel XL/*"},{ua:"Pixel XL"}],dpi:[537.9,533],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3/*"},{ua:"Pixel 3"}],dpi:442.4,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2/*"},{ua:"Pixel 2"}],dpi:441,bw:3,ac:500},{type:"android",rules:[{mdmh:"Google/*/Pixel/*"},{ua:"Pixel"}],dpi:[432.6,436.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/BLN-L24/*"},{ua:"HONORBLN-L24"}],dpi:480,bw:4,ac:500},{type:"android",rules:[{mdmh:"Huawei/*/BKL-L09/*"},{ua:"BKL-L09"}],dpi:403,bw:3.47,ac:500},{type:"android",rules:[{mdmh:"LENOVO/*/Lenovo PB2-690Y/*"},{ua:"Lenovo PB2-690Y"}],dpi:[457.2,454.713],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/G5/*"},{ua:"Moto G (5) Plus"}],dpi:[403.4,403],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/G4/*"},{ua:"Moto G (4)"}],dpi:401,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1001/*"},{ua:"ONE E1001"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1003/*"},{ua:"ONE E1003"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2001/*"},{ua:"ONE A2001"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2003/*"},{ua:"ONE A2003"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3000/*"},{ua:"ONEPLUS A3000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3003/*"},{ua:"ONEPLUS A3003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3010/*"},{ua:"ONEPLUS A3010"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A5000/*"},{ua:"ONEPLUS A5000 "}],dpi:[403.411,399.737],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A5010/*"},{ua:"ONEPLUS A5010"}],dpi:[403,400],bw:2,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6000/*"},{ua:"ONEPLUS A6000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6003/*"},{ua:"ONEPLUS A6003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6010/*"},{ua:"ONEPLUS A6010"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6013/*"},{ua:"ONEPLUS A6013"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SGH-M919/*"},{ua:"SGH-M919"}],dpi:[440.8,437.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920P/*"},{ua:"SM-N920P"}],dpi:[386.3655,390.144],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920W8/*"},{ua:"SM-N920W8"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G930F/*"},{ua:"SM-G930F"}],dpi:576.6,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G935F/*"},{ua:"SM-G935F"}],dpi:533,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G950F/*"},{ua:"SM-G950F"}],dpi:[562.707,565.293],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955U/*"},{ua:"SM-G955U"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955F/*"},{ua:"SM-G955F"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G960F/*"},{ua:"SM-G960F"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9600/*"},{ua:"SM-G9600"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960T/*"},{ua:"SM-G960T"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960N/*"},{ua:"SM-G960N"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960U/*"},{ua:"SM-G960U"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9608/*"},{ua:"SM-G9608"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960FD/*"},{ua:"SM-G960FD"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960W/*"},{ua:"SM-G960W"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G965F/*"},{ua:"SM-G965F"}],dpi:529,bw:2,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Fly/*/IQ4412/*"},{ua:"IQ4412"}],dpi:307.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"BENEVE/*/VR518/*"},{ua:"VR518"}],dpi:480,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1e3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1e3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2436]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/EML-L29/*"},{ua:"EML-L29"}],dpi:428,bw:3.45,ac:500},{type:"android",rules:[{mdmh:"Nokia/*/Nokia 7.1/*"},{ua:"Nokia 7.1"}],dpi:[432,431.9],bw:3,ac:500},{type:"ios",rules:[{res:[1242,2688]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G570M/*"},{ua:"SM-G570M"}],dpi:320,bw:3.684,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G970F/*"},{ua:"SM-G970F"}],dpi:438,bw:2.281,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G973F/*"},{ua:"SM-G973F"}],dpi:550,bw:2.002,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G975F/*"},{ua:"SM-G975F"}],dpi:522,bw:2.054,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G977F/*"},{ua:"SM-G977F"}],dpi:505,bw:2.334,ac:500},{type:"ios",rules:[{res:[828,1792]}],dpi:326,bw:5,ac:500}],vr={format:cr,last_updated:gi,devices:Lr};function je(Z,ie){if(this.dpdb=vr,this.recalculateDeviceParams_(),Z){this.onDeviceParamsUpdated=ie;var be=new XMLHttpRequest,Ae=this;be.open("GET",Z,!0),be.addEventListener("load",function(){Ae.loading=!1,be.status>=200&&be.status<=299?(Ae.dpdb=JSON.parse(be.response),Ae.recalculateDeviceParams_()):console.error("Error loading online DPDB!")}),be.send()}}je.prototype.getDeviceParams=function(){return this.deviceParams},je.prototype.recalculateDeviceParams_=function(){var Z=this.calcDeviceParams_();Z?(this.deviceParams=Z,this.onDeviceParamsUpdated&&this.onDeviceParamsUpdated(this.deviceParams)):console.error("Failed to recalculate device parameters.")},je.prototype.calcDeviceParams_=function(){var Z=this.dpdb;if(!Z)return console.error("DPDB not available."),null;if(Z.format!=1)return console.error("DPDB has unexpected format version."),null;if(!Z.devices||!Z.devices.length)return console.error("DPDB does not have a devices section."),null;var ie=navigator.userAgent||navigator.vendor||window.opera,be=Ie(),Ae=Ve();if(!Z.devices)return console.error("DPDB has no devices section."),null;for(var ze=0;ze<Z.devices.length;ze++){var ft=Z.devices[ze];if(!ft.rules){console.warn("Device["+ze+"] has no rules section.");continue}if(ft.type!="ios"&&ft.type!="android"){console.warn("Device["+ze+"] has invalid type.");continue}if(D()==(ft.type=="ios")){for(var Ct=!1,Xt=0;Xt<ft.rules.length;Xt++){var Et=ft.rules[Xt];if(this.ruleMatches_(Et,ie,be,Ae)){Ct=!0;break}}if(!!Ct){var wt=ft.dpi[0]||ft.dpi,se=ft.dpi[1]||ft.dpi;return new _t({xdpi:wt,ydpi:se,bevelMm:ft.bw})}}}return console.warn("No DPDB device match."),null},je.prototype.ruleMatches_=function(Z,ie,be,Ae){if(!Z.ua&&!Z.res||(Z.ua&&Z.ua.substring(0,2)==="SM"&&(Z.ua=Z.ua.substring(0,7)),Z.ua&&ie.indexOf(Z.ua)<0))return!1;if(Z.res){if(!Z.res[0]||!Z.res[1])return!1;var ze=Z.res[0],ft=Z.res[1];if(Math.min(be,Ae)!=Math.min(ze,ft)||Math.max(be,Ae)!=Math.max(ze,ft))return!1}return!0};function _t(Z){this.xdpi=Z.xdpi,this.ydpi=Z.ydpi,this.bevelMm=Z.bevelMm}function Ot(Z,ie){this.set(Z,ie)}Ot.prototype.set=function(Z,ie){this.sample=Z,this.timestampS=ie},Ot.prototype.copy=function(Z){this.set(Z.sample,Z.timestampS)};function At(Z,ie){this.kFilter=Z,this.isDebug=ie,this.currentAccelMeasurement=new Ot,this.currentGyroMeasurement=new Ot,this.previousGyroMeasurement=new Ot,D()?this.filterQ=new $t(-1,0,0,1):this.filterQ=new $t(1,0,0,1),this.previousFilterQ=new $t,this.previousFilterQ.copy(this.filterQ),this.accelQ=new $t,this.isOrientationInitialized=!1,this.estimatedGravity=new Ft,this.measuredGravity=new Ft,this.gyroIntegralQ=new $t}At.prototype.addAccelMeasurement=function(Z,ie){this.currentAccelMeasurement.set(Z,ie)},At.prototype.addGyroMeasurement=function(Z,ie){this.currentGyroMeasurement.set(Z,ie);var be=ie-this.previousGyroMeasurement.timestampS;Ne(be)&&this.run_(),this.previousGyroMeasurement.copy(this.currentGyroMeasurement)},At.prototype.run_=function(){if(!this.isOrientationInitialized){this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample),this.previousFilterQ.copy(this.accelQ),this.isOrientationInitialized=!0;return}var Z=this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS,ie=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,Z);this.gyroIntegralQ.multiply(ie),this.filterQ.copy(this.previousFilterQ),this.filterQ.multiply(ie);var be=new $t;be.copy(this.filterQ),be.inverse(),this.estimatedGravity.set(0,0,-1),this.estimatedGravity.applyQuaternion(be),this.estimatedGravity.normalize(),this.measuredGravity.copy(this.currentAccelMeasurement.sample),this.measuredGravity.normalize();var Ae=new $t;Ae.setFromUnitVectors(this.estimatedGravity,this.measuredGravity),Ae.inverse(),this.isDebug&&console.log("Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)",Dt*ee(Ae),this.estimatedGravity.x.toFixed(1),this.estimatedGravity.y.toFixed(1),this.estimatedGravity.z.toFixed(1),this.measuredGravity.x.toFixed(1),this.measuredGravity.y.toFixed(1),this.measuredGravity.z.toFixed(1));var ze=new $t;ze.copy(this.filterQ),ze.multiply(Ae),this.filterQ.slerp(ze,1-this.kFilter),this.previousFilterQ.copy(this.filterQ)},At.prototype.getOrientation=function(){return this.filterQ},At.prototype.accelToQuaternion_=function(Z){var ie=new Ft;ie.copy(Z),ie.normalize();var be=new $t;return be.setFromUnitVectors(new Ft(0,0,-1),ie),be.inverse(),be},At.prototype.gyroToQuaternionDelta_=function(Z,ie){var be=new $t,Ae=new Ft;return Ae.copy(Z),Ae.normalize(),be.setFromAxisAngle(Ae,Z.length()*ie),be};function Gt(Z,ie){this.predictionTimeS=Z,this.isDebug=ie,this.previousQ=new $t,this.previousTimestampS=null,this.deltaQ=new $t,this.outQ=new $t}Gt.prototype.getPrediction=function(Z,ie,be){if(!this.previousTimestampS)return this.previousQ.copy(Z),this.previousTimestampS=be,Z;var Ae=new Ft;Ae.copy(ie),Ae.normalize();var ze=ie.length();if(ze<fr*20)return this.isDebug&&console.log("Moving slowly, at %s deg/s: no prediction",(Dt*ze).toFixed(1)),this.outQ.copy(Z),this.previousQ.copy(Z),this.outQ;var ft=ze*this.predictionTimeS;return this.deltaQ.setFromAxisAngle(Ae,ft),this.outQ.copy(this.previousQ),this.outQ.multiply(this.deltaQ),this.previousQ.copy(Z),this.previousTimestampS=be,this.outQ};function En(Z,ie,be,Ae){this.yawOnly=be,this.accelerometer=new Ft,this.gyroscope=new Ft,this.filter=new At(Z,Ae),this.posePredictor=new Gt(ie,Ae),this.isFirefoxAndroid=U(),this.isIOS=D();var ze=W();this.isDeviceMotionInRadians=!this.isIOS&&ze&&ze<66,this.isWithoutDeviceMotion=oe()||ce(),this.filterToWorldQ=new $t,D()?this.filterToWorldQ.setFromAxisAngle(new Ft(1,0,0),Math.PI/2):this.filterToWorldQ.setFromAxisAngle(new Ft(1,0,0),-Math.PI/2),this.inverseWorldToScreenQ=new $t,this.worldToScreenQ=new $t,this.originalPoseAdjustQ=new $t,this.originalPoseAdjustQ.setFromAxisAngle(new Ft(0,0,1),-window.orientation*Math.PI/180),this.setScreenTransform_(),_e()&&this.filterToWorldQ.multiply(this.inverseWorldToScreenQ),this.resetQ=new $t,this.orientationOut_=new Float32Array(4),this.start()}En.prototype.getPosition=function(){return null},En.prototype.getOrientation=function(){var Z=void 0;if(this.isWithoutDeviceMotion&&this._deviceOrientationQ){this.deviceOrientationFixQ=this.deviceOrientationFixQ||function(){var ze=new $t().setFromAxisAngle(new Ft(0,0,-1),0),ft=new $t;return window.orientation===-90?ft.setFromAxisAngle(new Ft(0,1,0),Math.PI/-2):ft.setFromAxisAngle(new Ft(0,1,0),Math.PI/2),ze.multiply(ft)}(),this.deviceOrientationFilterToWorldQ=this.deviceOrientationFilterToWorldQ||function(){var ze=new $t;return ze.setFromAxisAngle(new Ft(1,0,0),-Math.PI/2),ze}(),Z=this._deviceOrientationQ;var be=new $t;return be.copy(Z),be.multiply(this.deviceOrientationFilterToWorldQ),be.multiply(this.resetQ),be.multiply(this.worldToScreenQ),be.multiplyQuaternions(this.deviceOrientationFixQ,be),this.yawOnly&&(be.x=0,be.z=0,be.normalize()),this.orientationOut_[0]=be.x,this.orientationOut_[1]=be.y,this.orientationOut_[2]=be.z,this.orientationOut_[3]=be.w,this.orientationOut_}else{var ie=this.filter.getOrientation();Z=this.posePredictor.getPrediction(ie,this.gyroscope,this.previousTimestampS)}var be=new $t;return be.copy(this.filterToWorldQ),be.multiply(this.resetQ),be.multiply(Z),be.multiply(this.worldToScreenQ),this.yawOnly&&(be.x=0,be.z=0,be.normalize()),this.orientationOut_[0]=be.x,this.orientationOut_[1]=be.y,this.orientationOut_[2]=be.z,this.orientationOut_[3]=be.w,this.orientationOut_},En.prototype.resetPose=function(){this.resetQ.copy(this.filter.getOrientation()),this.resetQ.x=0,this.resetQ.y=0,this.resetQ.z*=-1,this.resetQ.normalize(),_e()&&this.resetQ.multiply(this.inverseWorldToScreenQ),this.resetQ.multiply(this.originalPoseAdjustQ)},En.prototype.onDeviceOrientation_=function(Z){this._deviceOrientationQ=this._deviceOrientationQ||new $t;var ie=Z.alpha,be=Z.beta,Ae=Z.gamma;ie=(ie||0)*Math.PI/180,be=(be||0)*Math.PI/180,Ae=(Ae||0)*Math.PI/180,this._deviceOrientationQ.setFromEulerYXZ(be,ie,-Ae)},En.prototype.onDeviceMotion_=function(Z){this.updateDeviceMotion_(Z)},En.prototype.updateDeviceMotion_=function(Z){var ie=Z.accelerationIncludingGravity,be=Z.rotationRate,Ae=Z.timeStamp/1e3,ze=Ae-this.previousTimestampS;if(ze<0){te("fusion-pose-sensor:invalid:non-monotonic","Invalid timestamps detected: non-monotonic timestamp from devicemotion"),this.previousTimestampS=Ae;return}else if(ze<=Y||ze>ae){te("fusion-pose-sensor:invalid:outside-threshold","Invalid timestamps detected: Timestamp from devicemotion outside expected range."),this.previousTimestampS=Ae;return}this.accelerometer.set(-ie.x,-ie.y,-ie.z),be&&(ge()?this.gyroscope.set(-be.beta,be.alpha,be.gamma):this.gyroscope.set(be.alpha,be.beta,be.gamma),this.isDeviceMotionInRadians||this.gyroscope.multiplyScalar(Math.PI/180),this.filter.addGyroMeasurement(this.gyroscope,Ae)),this.filter.addAccelMeasurement(this.accelerometer,Ae),this.previousTimestampS=Ae},En.prototype.onOrientationChange_=function(Z){this.setScreenTransform_()},En.prototype.onMessage_=function(Z){var ie=Z.data;if(!(!ie||!ie.type)){var be=ie.type.toLowerCase();be==="devicemotion"&&this.updateDeviceMotion_(ie.deviceMotionEvent)}},En.prototype.setScreenTransform_=function(){switch(this.worldToScreenQ.set(0,0,0,1),window.orientation){case 0:break;case 90:this.worldToScreenQ.setFromAxisAngle(new Ft(0,0,1),-Math.PI/2);break;case-90:this.worldToScreenQ.setFromAxisAngle(new Ft(0,0,1),Math.PI/2);break}this.inverseWorldToScreenQ.copy(this.worldToScreenQ),this.inverseWorldToScreenQ.inverse()},En.prototype.start=function(){this.onDeviceMotionCallback_=this.onDeviceMotion_.bind(this),this.onOrientationChangeCallback_=this.onOrientationChange_.bind(this),this.onMessageCallback_=this.onMessage_.bind(this),this.onDeviceOrientationCallback_=this.onDeviceOrientation_.bind(this),D()&&q()&&window.addEventListener("message",this.onMessageCallback_),window.addEventListener("orientationchange",this.onOrientationChangeCallback_),this.isWithoutDeviceMotion?window.addEventListener("deviceorientation",this.onDeviceOrientationCallback_):window.addEventListener("devicemotion",this.onDeviceMotionCallback_)},En.prototype.stop=function(){window.removeEventListener("devicemotion",this.onDeviceMotionCallback_),window.removeEventListener("deviceorientation",this.onDeviceOrientationCallback_),window.removeEventListener("orientationchange",this.onOrientationChangeCallback_),window.removeEventListener("message",this.onMessageCallback_)};var Sn=60,pn=new Ft(1,0,0),De=new Ft(0,0,1),Ye=new $t;Ye.setFromAxisAngle(pn,-Math.PI/2),Ye.multiply(new $t().setFromAxisAngle(De,Math.PI/2));var ct=function(){function Z(ie){N(this,Z),this.config=ie,this.sensor=null,this.fusionSensor=null,this._out=new Float32Array(4),this.api=null,this.errors=[],this._sensorQ=new $t,this._outQ=new $t,this._onSensorRead=this._onSensorRead.bind(this),this._onSensorError=this._onSensorError.bind(this),this.init()}return F(Z,[{key:"init",value:function(){var be=null;try{be=new RelativeOrientationSensor({frequency:Sn,referenceFrame:"screen"}),be.addEventListener("error",this._onSensorError)}catch(Ae){this.errors.push(Ae),Ae.name==="SecurityError"?(console.error("Cannot construct sensors due to the Feature Policy"),console.warn('Attempting to fall back using "devicemotion"; however this will fail in the future without correct permissions.'),this.useDeviceMotion()):Ae.name==="ReferenceError"?this.useDeviceMotion():console.error(Ae)}be&&(this.api="sensor",this.sensor=be,this.sensor.addEventListener("reading",this._onSensorRead),this.sensor.start())}},{key:"useDeviceMotion",value:function(){this.api="devicemotion",this.fusionSensor=new En(this.config.K_FILTER,this.config.PREDICTION_TIME_S,this.config.YAW_ONLY,this.config.DEBUG),this.sensor&&(this.sensor.removeEventListener("reading",this._onSensorRead),this.sensor.removeEventListener("error",this._onSensorError),this.sensor=null)}},{key:"getOrientation",value:function(){if(this.fusionSensor)return this.fusionSensor.getOrientation();if(!this.sensor||!this.sensor.quaternion)return this._out[0]=this._out[1]=this._out[2]=0,this._out[3]=1,this._out;var be=this.sensor.quaternion;this._sensorQ.set(be[0],be[1],be[2],be[3]);var Ae=this._outQ;return Ae.copy(Ye),Ae.multiply(this._sensorQ),this.config.YAW_ONLY&&(Ae.x=Ae.z=0,Ae.normalize()),this._out[0]=Ae.x,this._out[1]=Ae.y,this._out[2]=Ae.z,this._out[3]=Ae.w,this._out}},{key:"_onSensorError",value:function(be){this.errors.push(be.error),be.error.name==="NotAllowedError"?console.error("Permission to access sensor was denied"):be.error.name==="NotReadableError"?console.error("Sensor could not be read"):console.error(be.error),this.useDeviceMotion()}},{key:"_onSensorRead",value:function(){}}]),Z}(),bt="<svg width='198' height='240' viewBox='0 0 198 240' xmlns='http://www.w3.org/2000/svg'><g fill='none' fill-rule='evenodd'><path d='M149.625 109.527l6.737 3.891v.886c0 .177.013.36.038.549.01.081.02.162.027.242.14 1.415.974 2.998 2.105 3.999l5.72 5.062.081-.09s4.382-2.53 5.235-3.024l25.97 14.993v54.001c0 .771-.386 1.217-.948 1.217-.233 0-.495-.076-.772-.236l-23.967-13.838-.014.024-27.322 15.775-.85-1.323c-4.731-1.529-9.748-2.74-14.951-3.61a.27.27 0 0 0-.007.024l-5.067 16.961-7.891 4.556-.037-.063v27.59c0 .772-.386 1.217-.948 1.217-.232 0-.495-.076-.772-.236l-42.473-24.522c-.95-.549-1.72-1.877-1.72-2.967v-1.035l-.021.047a5.111 5.111 0 0 0-1.816-.399 5.682 5.682 0 0 0-.546.001 13.724 13.724 0 0 1-1.918-.041c-1.655-.153-3.2-.6-4.404-1.296l-46.576-26.89.005.012-10.278-18.75c-1.001-1.827-.241-4.216 1.698-5.336l56.011-32.345a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.659 3.227 1.853l.005-.003.227.413-.006.004a9.63 9.63 0 0 0 1.477 2.018l.277.27c1.914 1.85 4.468 2.801 7.113 2.801 1.949 0 3.948-.517 5.775-1.572.013 0 7.319-4.219 7.319-4.219a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.658 3.226 1.853l3.25 5.928.022-.018 6.785 3.917-.105-.182 46.881-26.965m0-1.635c-.282 0-.563.073-.815.218l-46.169 26.556-5.41-3.124-3.005-5.481c-.913-1.667-2.699-2.702-4.66-2.703-1.011 0-2.02.274-2.917.792a3825 3825 0 0 1-7.275 4.195l-.044.024a9.937 9.937 0 0 1-4.957 1.353c-2.292 0-4.414-.832-5.976-2.342l-.252-.245a7.992 7.992 0 0 1-1.139-1.534 1.379 1.379 0 0 0-.06-.122l-.227-.414a1.718 1.718 0 0 0-.095-.154c-.938-1.574-2.673-2.545-4.571-2.545-1.011 0-2.02.274-2.917.792L3.125 155.502c-2.699 1.559-3.738 4.94-2.314 7.538l10.278 18.75c.177.323.448.563.761.704l46.426 26.804c1.403.81 3.157 1.332 5.072 1.508a15.661 15.661 0 0 0 2.146.046 4.766 4.766 0 0 1 .396 0c.096.004.19.011.283.022.109 1.593 1.159 3.323 2.529 4.114l42.472 24.522c.524.302 1.058.455 1.59.455 1.497 0 2.583-1.2 2.583-2.852v-26.562l7.111-4.105a1.64 1.64 0 0 0 .749-.948l4.658-15.593c4.414.797 8.692 1.848 12.742 3.128l.533.829a1.634 1.634 0 0 0 2.193.531l26.532-15.317L193 192.433c.523.302 1.058.455 1.59.455 1.497 0 2.583-1.199 2.583-2.852v-54.001c0-.584-.312-1.124-.818-1.416l-25.97-14.993a1.633 1.633 0 0 0-1.636.001c-.606.351-2.993 1.73-4.325 2.498l-4.809-4.255c-.819-.725-1.461-1.933-1.561-2.936a7.776 7.776 0 0 0-.033-.294 2.487 2.487 0 0 1-.023-.336v-.886c0-.584-.312-1.123-.817-1.416l-6.739-3.891a1.633 1.633 0 0 0-.817-.219' fill='#455A64'/><path d='M96.027 132.636l46.576 26.891c1.204.695 1.979 1.587 2.242 2.541l-.01.007-81.374 46.982h-.001c-1.654-.152-3.199-.6-4.403-1.295l-46.576-26.891 83.546-48.235' fill='#FAFAFA'/><path d='M63.461 209.174c-.008 0-.015 0-.022-.002-1.693-.156-3.228-.609-4.441-1.309l-46.576-26.89a.118.118 0 0 1 0-.203l83.546-48.235a.117.117 0 0 1 .117 0l46.576 26.891c1.227.708 2.021 1.612 2.296 2.611a.116.116 0 0 1-.042.124l-.021.016-81.375 46.981a.11.11 0 0 1-.058.016zm-50.747-28.303l46.401 26.79c1.178.68 2.671 1.121 4.32 1.276l81.272-46.922c-.279-.907-1.025-1.73-2.163-2.387l-46.517-26.857-83.313 48.1z' fill='#607D8B'/><path d='M148.327 165.471a5.85 5.85 0 0 1-.546.001c-1.894-.083-3.302-1.038-3.145-2.132a2.693 2.693 0 0 0-.072-1.105l-81.103 46.822c.628.058 1.272.073 1.918.042.182-.009.364-.009.546-.001 1.894.083 3.302 1.038 3.145 2.132l79.257-45.759' fill='#FFF'/><path d='M69.07 211.347a.118.118 0 0 1-.115-.134c.045-.317-.057-.637-.297-.925-.505-.61-1.555-1.022-2.738-1.074a5.966 5.966 0 0 0-.535.001 14.03 14.03 0 0 1-1.935-.041.117.117 0 0 1-.103-.092.116.116 0 0 1 .055-.126l81.104-46.822a.117.117 0 0 1 .171.07c.104.381.129.768.074 1.153-.045.316.057.637.296.925.506.61 1.555 1.021 2.739 1.073.178.008.357.008.535-.001a.117.117 0 0 1 .064.218l-79.256 45.759a.114.114 0 0 1-.059.016zm-3.405-2.372c.089 0 .177.002.265.006 1.266.056 2.353.488 2.908 1.158.227.274.35.575.36.882l78.685-45.429c-.036 0-.072-.001-.107-.003-1.267-.056-2.354-.489-2.909-1.158-.282-.34-.402-.724-.347-1.107a2.604 2.604 0 0 0-.032-.91L63.846 208.97a13.91 13.91 0 0 0 1.528.012c.097-.005.194-.007.291-.007z' fill='#607D8B'/><path d='M2.208 162.134c-1.001-1.827-.241-4.217 1.698-5.337l56.011-32.344c1.939-1.12 4.324-.546 5.326 1.281l.232.41a9.344 9.344 0 0 0 1.47 2.021l.278.27c3.325 3.214 8.583 3.716 12.888 1.23l7.319-4.22c1.94-1.119 4.324-.546 5.325 1.282l3.25 5.928-83.519 48.229-10.278-18.75z' fill='#FAFAFA'/><path d='M12.486 181.001a.112.112 0 0 1-.031-.005.114.114 0 0 1-.071-.056L2.106 162.19c-1.031-1.88-.249-4.345 1.742-5.494l56.01-32.344a4.328 4.328 0 0 1 2.158-.588c1.415 0 2.65.702 3.311 1.882.01.008.018.017.024.028l.227.414a.122.122 0 0 1 .013.038 9.508 9.508 0 0 0 1.439 1.959l.275.266c1.846 1.786 4.344 2.769 7.031 2.769 1.977 0 3.954-.538 5.717-1.557a.148.148 0 0 1 .035-.013l7.284-4.206a4.321 4.321 0 0 1 2.157-.588c1.427 0 2.672.716 3.329 1.914l3.249 5.929a.116.116 0 0 1-.044.157l-83.518 48.229a.116.116 0 0 1-.059.016zm49.53-57.004c-.704 0-1.41.193-2.041.557l-56.01 32.345c-1.882 1.086-2.624 3.409-1.655 5.179l10.221 18.645 83.317-48.112-3.195-5.829c-.615-1.122-1.783-1.792-3.124-1.792a4.08 4.08 0 0 0-2.04.557l-7.317 4.225a.148.148 0 0 1-.035.013 11.7 11.7 0 0 1-5.801 1.569c-2.748 0-5.303-1.007-7.194-2.835l-.278-.27a9.716 9.716 0 0 1-1.497-2.046.096.096 0 0 1-.013-.037l-.191-.347a.11.11 0 0 1-.023-.029c-.615-1.123-1.783-1.793-3.124-1.793z' fill='#607D8B'/><path d='M42.434 155.808c-2.51-.001-4.697-1.258-5.852-3.365-1.811-3.304-.438-7.634 3.059-9.654l12.291-7.098a7.599 7.599 0 0 1 3.789-1.033c2.51 0 4.697 1.258 5.852 3.365 1.811 3.304.439 7.634-3.059 9.654l-12.291 7.098a7.606 7.606 0 0 1-3.789 1.033zm13.287-20.683a7.128 7.128 0 0 0-3.555.971l-12.291 7.098c-3.279 1.893-4.573 5.942-2.883 9.024 1.071 1.955 3.106 3.122 5.442 3.122a7.13 7.13 0 0 0 3.556-.97l12.291-7.098c3.279-1.893 4.572-5.942 2.883-9.024-1.072-1.955-3.106-3.123-5.443-3.123z' fill='#607D8B'/><path d='M149.588 109.407l6.737 3.89v.887c0 .176.013.36.037.549.011.081.02.161.028.242.14 1.415.973 2.998 2.105 3.999l7.396 6.545c.177.156.358.295.541.415 1.579 1.04 2.95.466 3.062-1.282.049-.784.057-1.595.023-2.429l-.003-.16v-1.151l25.987 15.003v54c0 1.09-.77 1.53-1.72.982l-42.473-24.523c-.95-.548-1.72-1.877-1.72-2.966v-34.033' fill='#FAFAFA'/><path d='M194.553 191.25c-.257 0-.54-.085-.831-.253l-42.472-24.521c-.981-.567-1.779-1.943-1.779-3.068v-34.033h.234v34.033c0 1.051.745 2.336 1.661 2.866l42.473 24.521c.424.245.816.288 1.103.122.285-.164.442-.52.442-1.002v-53.933l-25.753-14.868.003 1.106c.034.832.026 1.654-.024 2.439-.054.844-.396 1.464-.963 1.746-.619.309-1.45.173-2.28-.373a5.023 5.023 0 0 1-.553-.426l-7.397-6.544c-1.158-1.026-1.999-2.625-2.143-4.076a9.624 9.624 0 0 0-.027-.238 4.241 4.241 0 0 1-.038-.564v-.82l-6.68-3.856.117-.202 6.738 3.89.058.034v.954c0 .171.012.351.036.533.011.083.021.165.029.246.138 1.395.948 2.935 2.065 3.923l7.397 6.545c.173.153.35.289.527.406.758.499 1.504.63 2.047.359.49-.243.786-.795.834-1.551.05-.778.057-1.591.024-2.417l-.004-.163v-1.355l.175.1 25.987 15.004.059.033v54.068c0 .569-.198.996-.559 1.204a1.002 1.002 0 0 1-.506.131' fill='#607D8B'/><path d='M145.685 163.161l24.115 13.922-25.978 14.998-1.462-.307c-6.534-2.17-13.628-3.728-21.019-4.616-4.365-.524-8.663 1.096-9.598 3.62a2.746 2.746 0 0 0-.011 1.928c1.538 4.267 4.236 8.363 7.995 12.135l.532.845-25.977 14.997-24.115-13.922 75.518-43.6' fill='#FFF'/><path d='M94.282 220.818l-.059-.033-24.29-14.024.175-.101 75.577-43.634.058.033 24.29 14.024-26.191 15.122-.045-.01-1.461-.307c-6.549-2.174-13.613-3.725-21.009-4.614a13.744 13.744 0 0 0-1.638-.097c-3.758 0-7.054 1.531-7.837 3.642a2.62 2.62 0 0 0-.01 1.848c1.535 4.258 4.216 8.326 7.968 12.091l.016.021.526.835.006.01.064.102-.105.061-25.977 14.998-.058.033zm-23.881-14.057l23.881 13.788 24.802-14.32c.546-.315.846-.489 1.017-.575l-.466-.74c-3.771-3.787-6.467-7.881-8.013-12.168a2.851 2.851 0 0 1 .011-2.008c.815-2.199 4.203-3.795 8.056-3.795.557 0 1.117.033 1.666.099 7.412.891 14.491 2.445 21.041 4.621.836.175 1.215.254 1.39.304l25.78-14.884-23.881-13.788-75.284 43.466z' fill='#607D8B'/><path d='M167.23 125.979v50.871l-27.321 15.773-6.461-14.167c-.91-1.996-3.428-1.738-5.624.574a10.238 10.238 0 0 0-2.33 4.018l-6.46 21.628-27.322 15.774v-50.871l75.518-43.6' fill='#FFF'/><path d='M91.712 220.567a.127.127 0 0 1-.059-.016.118.118 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.519-43.6a.117.117 0 0 1 .175.101v50.871c0 .041-.023.08-.059.1l-27.321 15.775a.118.118 0 0 1-.094.01.12.12 0 0 1-.071-.063l-6.46-14.168c-.375-.822-1.062-1.275-1.934-1.275-1.089 0-2.364.686-3.5 1.881a10.206 10.206 0 0 0-2.302 3.972l-6.46 21.627a.118.118 0 0 1-.054.068L91.77 220.551a.12.12 0 0 1-.058.016zm.117-50.92v50.601l27.106-15.65 6.447-21.583a10.286 10.286 0 0 1 2.357-4.065c1.18-1.242 2.517-1.954 3.669-1.954.969 0 1.731.501 2.146 1.411l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M168.543 126.213v50.87l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.624.574a10.248 10.248 0 0 0-2.33 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6' fill='#FFF'/><path d='M93.025 220.8a.123.123 0 0 1-.059-.015.12.12 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.518-43.6a.112.112 0 0 1 .117 0c.036.02.059.059.059.1v50.871a.116.116 0 0 1-.059.101l-27.321 15.774a.111.111 0 0 1-.094.01.115.115 0 0 1-.071-.062l-6.46-14.168c-.375-.823-1.062-1.275-1.935-1.275-1.088 0-2.363.685-3.499 1.881a10.19 10.19 0 0 0-2.302 3.971l-6.461 21.628a.108.108 0 0 1-.053.067l-27.322 15.775a.12.12 0 0 1-.058.015zm.117-50.919v50.6l27.106-15.649 6.447-21.584a10.293 10.293 0 0 1 2.357-4.065c1.179-1.241 2.516-1.954 3.668-1.954.969 0 1.732.502 2.147 1.412l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M169.8 177.083l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.625.574a10.246 10.246 0 0 0-2.329 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6v50.87z' fill='#FAFAFA'/><path d='M94.282 220.917a.234.234 0 0 1-.234-.233v-50.871c0-.083.045-.161.117-.202l75.518-43.601a.234.234 0 1 1 .35.202v50.871a.233.233 0 0 1-.116.202l-27.322 15.775a.232.232 0 0 1-.329-.106l-6.461-14.168c-.36-.789-.992-1.206-1.828-1.206-1.056 0-2.301.672-3.415 1.844a10.099 10.099 0 0 0-2.275 3.924l-6.46 21.628a.235.235 0 0 1-.107.136l-27.322 15.774a.23.23 0 0 1-.116.031zm.233-50.969v50.331l26.891-15.525 6.434-21.539a10.41 10.41 0 0 1 2.384-4.112c1.201-1.265 2.569-1.991 3.753-1.991 1.018 0 1.818.526 2.253 1.48l6.354 13.934 26.982-15.578v-50.331l-75.051 43.331z' fill='#607D8B'/><path d='M109.894 199.943c-1.774 0-3.241-.725-4.244-2.12a.224.224 0 0 1 .023-.294.233.233 0 0 1 .301-.023c.78.547 1.705.827 2.75.827 1.323 0 2.754-.439 4.256-1.306 5.311-3.067 9.631-10.518 9.631-16.611 0-1.927-.442-3.56-1.278-4.724a.232.232 0 0 1 .323-.327c1.671 1.172 2.591 3.381 2.591 6.219 0 6.242-4.426 13.863-9.865 17.003-1.574.908-3.084 1.356-4.488 1.356zm-2.969-1.542c.813.651 1.82.877 2.968.877h.001c1.321 0 2.753-.327 4.254-1.194 5.311-3.067 9.632-10.463 9.632-16.556 0-1.979-.463-3.599-1.326-4.761.411 1.035.625 2.275.625 3.635 0 6.243-4.426 13.883-9.865 17.023-1.574.909-3.084 1.317-4.49 1.317-.641 0-1.243-.149-1.799-.341z' fill='#607D8B'/><path d='M113.097 197.23c5.384-3.108 9.748-10.636 9.748-16.814 0-2.051-.483-3.692-1.323-4.86-1.784-1.252-4.374-1.194-7.257.47-5.384 3.108-9.748 10.636-9.748 16.814 0 2.051.483 3.692 1.323 4.86 1.784 1.252 4.374 1.194 7.257-.47' fill='#FAFAFA'/><path d='M108.724 198.614c-1.142 0-2.158-.213-3.019-.817-.021-.014-.04.014-.055-.007-.894-1.244-1.367-2.948-1.367-4.973 0-6.242 4.426-13.864 9.865-17.005 1.574-.908 3.084-1.363 4.49-1.363 1.142 0 2.158.309 3.018.913a.23.23 0 0 1 .056.056c.894 1.244 1.367 2.972 1.367 4.997 0 6.243-4.426 13.783-9.865 16.923-1.574.909-3.084 1.276-4.49 1.276zm-2.718-1.109c.774.532 1.688.776 2.718.776 1.323 0 2.754-.413 4.256-1.28 5.311-3.066 9.631-10.505 9.631-16.598 0-1.909-.434-3.523-1.255-4.685-.774-.533-1.688-.799-2.718-.799-1.323 0-2.755.441-4.256 1.308-5.311 3.066-9.631 10.506-9.631 16.599 0 1.909.434 3.517 1.255 4.679z' fill='#607D8B'/><path d='M149.318 114.262l-9.984 8.878 15.893 11.031 5.589-6.112-11.498-13.797' fill='#FAFAFA'/><path d='M169.676 120.84l-9.748 5.627c-3.642 2.103-9.528 2.113-13.147.024-3.62-2.089-3.601-5.488.041-7.591l9.495-5.608-6.729-3.885-81.836 47.071 45.923 26.514 3.081-1.779c.631-.365.869-.898.618-1.39-2.357-4.632-2.593-9.546-.683-14.262 5.638-13.92 24.509-24.815 48.618-28.07 8.169-1.103 16.68-.967 24.704.394.852.145 1.776.008 2.407-.357l3.081-1.778-25.825-14.91' fill='#FAFAFA'/><path d='M113.675 183.459a.47.47 0 0 1-.233-.062l-45.924-26.515a.468.468 0 0 1 .001-.809l81.836-47.071a.467.467 0 0 1 .466 0l6.729 3.885a.467.467 0 0 1-.467.809l-6.496-3.75-80.9 46.533 44.988 25.973 2.848-1.644c.192-.111.62-.409.435-.773-2.416-4.748-2.658-9.814-.7-14.65 2.806-6.927 8.885-13.242 17.582-18.263 8.657-4.998 19.518-8.489 31.407-10.094 8.198-1.107 16.79-.97 24.844.397.739.125 1.561.007 2.095-.301l2.381-1.374-25.125-14.506a.467.467 0 0 1 .467-.809l25.825 14.91a.467.467 0 0 1 0 .809l-3.081 1.779c-.721.417-1.763.575-2.718.413-7.963-1.351-16.457-1.486-24.563-.392-11.77 1.589-22.512 5.039-31.065 9.977-8.514 4.916-14.456 11.073-17.183 17.805-1.854 4.578-1.623 9.376.666 13.875.37.725.055 1.513-.8 2.006l-3.081 1.78a.476.476 0 0 1-.234.062' fill='#455A64'/><path d='M153.316 128.279c-2.413 0-4.821-.528-6.652-1.586-1.818-1.049-2.82-2.461-2.82-3.975 0-1.527 1.016-2.955 2.861-4.02l9.493-5.607a.233.233 0 1 1 .238.402l-9.496 5.609c-1.696.979-2.628 2.263-2.628 3.616 0 1.34.918 2.608 2.585 3.571 3.549 2.049 9.343 2.038 12.914-.024l9.748-5.628a.234.234 0 0 1 .234.405l-9.748 5.628c-1.858 1.072-4.296 1.609-6.729 1.609' fill='#607D8B'/><path d='M113.675 182.992l-45.913-26.508M113.675 183.342a.346.346 0 0 1-.175-.047l-45.913-26.508a.35.35 0 1 1 .35-.607l45.913 26.508a.35.35 0 0 1-.175.654' fill='#455A64'/><path d='M67.762 156.484v54.001c0 1.09.77 2.418 1.72 2.967l42.473 24.521c.95.549 1.72.11 1.72-.98v-54.001' fill='#FAFAFA'/><path d='M112.727 238.561c-.297 0-.62-.095-.947-.285l-42.473-24.521c-1.063-.613-1.895-2.05-1.895-3.27v-54.001a.35.35 0 1 1 .701 0v54.001c0 .96.707 2.18 1.544 2.663l42.473 24.522c.344.198.661.243.87.122.206-.119.325-.411.325-.799v-54.001a.35.35 0 1 1 .7 0v54.001c0 .655-.239 1.154-.675 1.406a1.235 1.235 0 0 1-.623.162' fill='#455A64'/><path d='M112.86 147.512h-.001c-2.318 0-4.499-.522-6.142-1.471-1.705-.984-2.643-2.315-2.643-3.749 0-1.445.952-2.791 2.68-3.788l12.041-6.953c1.668-.962 3.874-1.493 6.212-1.493 2.318 0 4.499.523 6.143 1.472 1.704.984 2.643 2.315 2.643 3.748 0 1.446-.952 2.791-2.68 3.789l-12.042 6.952c-1.668.963-3.874 1.493-6.211 1.493zm12.147-16.753c-2.217 0-4.298.497-5.861 1.399l-12.042 6.952c-1.502.868-2.33 1.998-2.33 3.182 0 1.173.815 2.289 2.293 3.142 1.538.889 3.596 1.378 5.792 1.378h.001c2.216 0 4.298-.497 5.861-1.399l12.041-6.953c1.502-.867 2.33-1.997 2.33-3.182 0-1.172-.814-2.288-2.292-3.142-1.539-.888-3.596-1.377-5.793-1.377z' fill='#607D8B'/><path d='M165.63 123.219l-5.734 3.311c-3.167 1.828-8.286 1.837-11.433.02-3.147-1.817-3.131-4.772.036-6.601l5.734-3.31 11.397 6.58' fill='#FAFAFA'/><path d='M154.233 117.448l9.995 5.771-4.682 2.704c-1.434.827-3.352 1.283-5.399 1.283-2.029 0-3.923-.449-5.333-1.263-1.29-.744-2-1.694-2-2.674 0-.991.723-1.955 2.036-2.713l5.383-3.108m0-.809l-5.734 3.31c-3.167 1.829-3.183 4.784-.036 6.601 1.568.905 3.623 1.357 5.684 1.357 2.077 0 4.159-.46 5.749-1.377l5.734-3.311-11.397-6.58M145.445 179.667c-1.773 0-3.241-.85-4.243-2.245-.067-.092-.057-.275.023-.356.08-.081.207-.12.3-.055.781.548 1.706.812 2.751.811 1.322 0 2.754-.446 4.256-1.313 5.31-3.066 9.631-10.522 9.631-16.615 0-1.927-.442-3.562-1.279-4.726a.235.235 0 0 1 .024-.301.232.232 0 0 1 .3-.027c1.67 1.172 2.59 3.38 2.59 6.219 0 6.242-4.425 13.987-9.865 17.127-1.573.908-3.083 1.481-4.488 1.481zM142.476 178c.814.651 1.82 1.002 2.969 1.002 1.322 0 2.753-.452 4.255-1.32 5.31-3.065 9.631-10.523 9.631-16.617 0-1.98-.463-3.63-1.325-4.793.411 1.035.624 2.26.624 3.62 0 6.242-4.425 13.875-9.865 17.015-1.573.909-3.084 1.376-4.489 1.376a5.49 5.49 0 0 1-1.8-.283z' fill='#607D8B'/><path d='M148.648 176.704c5.384-3.108 9.748-10.636 9.748-16.813 0-2.052-.483-3.693-1.322-4.861-1.785-1.252-4.375-1.194-7.258.471-5.383 3.108-9.748 10.636-9.748 16.813 0 2.051.484 3.692 1.323 4.86 1.785 1.253 4.374 1.195 7.257-.47' fill='#FAFAFA'/><path d='M144.276 178.276c-1.143 0-2.158-.307-3.019-.911a.217.217 0 0 1-.055-.054c-.895-1.244-1.367-2.972-1.367-4.997 0-6.241 4.425-13.875 9.865-17.016 1.573-.908 3.084-1.369 4.489-1.369 1.143 0 2.158.307 3.019.91a.24.24 0 0 1 .055.055c.894 1.244 1.367 2.971 1.367 4.997 0 6.241-4.425 13.875-9.865 17.016-1.573.908-3.084 1.369-4.489 1.369zm-2.718-1.172c.773.533 1.687.901 2.718.901 1.322 0 2.754-.538 4.256-1.405 5.31-3.066 9.631-10.567 9.631-16.661 0-1.908-.434-3.554-1.256-4.716-.774-.532-1.688-.814-2.718-.814-1.322 0-2.754.433-4.256 1.3-5.31 3.066-9.631 10.564-9.631 16.657 0 1.91.434 3.576 1.256 4.738z' fill='#607D8B'/><path d='M150.72 172.361l-.363-.295a24.105 24.105 0 0 0 2.148-3.128 24.05 24.05 0 0 0 1.977-4.375l.443.149a24.54 24.54 0 0 1-2.015 4.46 24.61 24.61 0 0 1-2.19 3.189M115.917 191.514l-.363-.294a24.174 24.174 0 0 0 2.148-3.128 24.038 24.038 0 0 0 1.976-4.375l.443.148a24.48 24.48 0 0 1-2.015 4.461 24.662 24.662 0 0 1-2.189 3.188M114 237.476V182.584 237.476' fill='#607D8B'/><g><path d='M81.822 37.474c.017-.135-.075-.28-.267-.392-.327-.188-.826-.21-1.109-.045l-6.012 3.471c-.131.076-.194.178-.191.285.002.132.002.461.002.578v.043l-.007.128-6.591 3.779c-.001 0-2.077 1.046-2.787 5.192 0 0-.912 6.961-.898 19.745.015 12.57.606 17.07 1.167 21.351.22 1.684 3.001 2.125 3.001 2.125.331.04.698-.027 1.08-.248l75.273-43.551c1.808-1.069 2.667-3.719 3.056-6.284 1.213-7.99 1.675-32.978-.275-39.878-.196-.693-.51-1.083-.868-1.282l-2.086-.79c-.727.028-1.416.467-1.534.535L82.032 37.072l-.21.402' fill='#FFF'/><path d='M144.311 1.701l2.085.79c.358.199.672.589.868 1.282 1.949 6.9 1.487 31.887.275 39.878-.39 2.565-1.249 5.215-3.056 6.284L69.21 93.486a1.78 1.78 0 0 1-.896.258l-.183-.011c0 .001-2.782-.44-3.003-2.124-.56-4.282-1.151-8.781-1.165-21.351-.015-12.784.897-19.745.897-19.745.71-4.146 2.787-5.192 2.787-5.192l6.591-3.779.007-.128v-.043c0-.117 0-.446-.002-.578-.003-.107.059-.21.191-.285l6.012-3.472a.98.98 0 0 1 .481-.11c.218 0 .449.053.627.156.193.112.285.258.268.392l.211-.402 60.744-34.836c.117-.068.806-.507 1.534-.535m0-.997l-.039.001c-.618.023-1.283.244-1.974.656l-.021.012-60.519 34.706a2.358 2.358 0 0 0-.831-.15c-.365 0-.704.084-.98.244l-6.012 3.471c-.442.255-.699.69-.689 1.166l.001.15-6.08 3.487c-.373.199-2.542 1.531-3.29 5.898l-.006.039c-.009.07-.92 7.173-.906 19.875.014 12.62.603 17.116 1.172 21.465l.002.015c.308 2.355 3.475 2.923 3.836 2.98l.034.004c.101.013.204.019.305.019a2.77 2.77 0 0 0 1.396-.392l75.273-43.552c1.811-1.071 2.999-3.423 3.542-6.997 1.186-7.814 1.734-33.096-.301-40.299-.253-.893-.704-1.527-1.343-1.882l-.132-.062-2.085-.789a.973.973 0 0 0-.353-.065' fill='#455A64'/><path d='M128.267 11.565l1.495.434-56.339 32.326' fill='#FFF'/><path d='M74.202 90.545a.5.5 0 0 1-.25-.931l18.437-10.645a.499.499 0 1 1 .499.864L74.451 90.478l-.249.067M75.764 42.654l-.108-.062.046-.171 5.135-2.964.17.045-.045.171-5.135 2.964-.063.017M70.52 90.375V46.421l.063-.036L137.84 7.554v43.954l-.062.036L70.52 90.375zm.25-43.811v43.38l66.821-38.579V7.985L70.77 46.564z' fill='#607D8B'/><path d='M86.986 83.182c-.23.149-.612.384-.849.523l-11.505 6.701c-.237.139-.206.252.068.252h.565c.275 0 .693-.113.93-.252L87.7 83.705c.237-.139.428-.253.425-.256a11.29 11.29 0 0 1-.006-.503c0-.274-.188-.377-.418-.227l-.715.463' fill='#607D8B'/><path d='M75.266 90.782H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.236-.138.615-.371.844-.519l.715-.464a.488.488 0 0 1 .266-.089c.172 0 .345.13.345.421 0 .214.001.363.003.437l.006.004-.004.069c-.003.075-.003.075-.486.356l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.108.866-.234l11.505-6.702c.168-.098.294-.173.361-.214-.004-.084-.004-.218-.004-.437l-.095-.171-.131.049-.714.463c-.232.15-.616.386-.854.525l-11.505 6.702-.029.018z' fill='#607D8B'/><path d='M75.266 89.871H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.258-.151.694-.268.993-.268h.565c.2 0 .316.056.346.166.03.11-.043.217-.215.317l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.107.866-.234l11.505-6.702.03-.018-.035-.001h-.565c-.252 0-.649.108-.867.234l-11.505 6.702-.029.018zM74.37 90.801v-1.247 1.247' fill='#607D8B'/><path d='M68.13 93.901c-.751-.093-1.314-.737-1.439-1.376-.831-4.238-1.151-8.782-1.165-21.352-.015-12.784.897-19.745.897-19.745.711-4.146 2.787-5.192 2.787-5.192l74.859-43.219c.223-.129 2.487-1.584 3.195.923 1.95 6.9 1.488 31.887.275 39.878-.389 2.565-1.248 5.215-3.056 6.283L69.21 93.653c-.382.221-.749.288-1.08.248 0 0-2.781-.441-3.001-2.125-.561-4.281-1.152-8.781-1.167-21.351-.014-12.784.898-19.745.898-19.745.71-4.146 2.787-5.191 2.787-5.191l6.598-3.81.871-.119 6.599-3.83.046-.461L68.13 93.901' fill='#FAFAFA'/><path d='M68.317 94.161l-.215-.013h-.001l-.244-.047c-.719-.156-2.772-.736-2.976-2.292-.568-4.34-1.154-8.813-1.168-21.384-.014-12.654.891-19.707.9-19.777.725-4.231 2.832-5.338 2.922-5.382l6.628-3.827.87-.119 6.446-3.742.034-.334a.248.248 0 0 1 .273-.223.248.248 0 0 1 .223.272l-.059.589-6.752 3.919-.87.118-6.556 3.785c-.031.016-1.99 1.068-2.666 5.018-.007.06-.908 7.086-.894 19.702.014 12.539.597 16.996 1.161 21.305.091.691.689 1.154 1.309 1.452a1.95 1.95 0 0 1-.236-.609c-.781-3.984-1.155-8.202-1.17-21.399-.014-12.653.891-19.707.9-19.777.725-4.231 2.832-5.337 2.922-5.382-.004.001 74.444-42.98 74.846-43.212l.028-.017c.904-.538 1.72-.688 2.36-.433.555.221.949.733 1.172 1.52 2.014 7.128 1.46 32.219.281 39.983-.507 3.341-1.575 5.515-3.175 6.462L69.335 93.869a2.023 2.023 0 0 1-1.018.292zm-.147-.507c.293.036.604-.037.915-.217l75.273-43.551c1.823-1.078 2.602-3.915 2.934-6.106 1.174-7.731 1.731-32.695-.268-39.772-.178-.631-.473-1.032-.876-1.192-.484-.193-1.166-.052-1.921.397l-.034.021-74.858 43.218c-.031.017-1.989 1.069-2.666 5.019-.007.059-.908 7.085-.894 19.702.015 13.155.386 17.351 1.161 21.303.09.461.476.983 1.037 1.139.114.025.185.037.196.039h.001z' fill='#455A64'/><path d='M69.317 68.982c.489-.281.885-.056.885.505 0 .56-.396 1.243-.885 1.525-.488.282-.884.057-.884-.504 0-.56.396-1.243.884-1.526' fill='#FFF'/><path d='M68.92 71.133c-.289 0-.487-.228-.487-.625 0-.56.396-1.243.884-1.526a.812.812 0 0 1 .397-.121c.289 0 .488.229.488.626 0 .56-.396 1.243-.885 1.525a.812.812 0 0 1-.397.121m.794-2.459a.976.976 0 0 0-.49.147c-.548.317-.978 1.058-.978 1.687 0 .486.271.812.674.812a.985.985 0 0 0 .491-.146c.548-.317.978-1.057.978-1.687 0-.486-.272-.813-.675-.813' fill='#8097A2'/><path d='M68.92 70.947c-.271 0-.299-.307-.299-.439 0-.491.361-1.116.79-1.363a.632.632 0 0 1 .303-.096c.272 0 .301.306.301.438 0 .491-.363 1.116-.791 1.364a.629.629 0 0 1-.304.096m.794-2.086a.812.812 0 0 0-.397.121c-.488.283-.884.966-.884 1.526 0 .397.198.625.487.625a.812.812 0 0 0 .397-.121c.489-.282.885-.965.885-1.525 0-.397-.199-.626-.488-.626' fill='#8097A2'/><path d='M69.444 85.35c.264-.152.477-.031.477.272 0 .303-.213.67-.477.822-.263.153-.477.031-.477-.271 0-.302.214-.671.477-.823' fill='#FFF'/><path d='M69.23 86.51c-.156 0-.263-.123-.263-.337 0-.302.214-.671.477-.823a.431.431 0 0 1 .214-.066c.156 0 .263.124.263.338 0 .303-.213.67-.477.822a.431.431 0 0 1-.214.066m.428-1.412c-.1 0-.203.029-.307.09-.32.185-.57.618-.57.985 0 .309.185.524.449.524a.63.63 0 0 0 .308-.09c.32-.185.57-.618.57-.985 0-.309-.185-.524-.45-.524' fill='#8097A2'/><path d='M69.23 86.322l-.076-.149c0-.235.179-.544.384-.661l.12-.041.076.151c0 .234-.179.542-.383.66l-.121.04m.428-1.038a.431.431 0 0 0-.214.066c-.263.152-.477.521-.477.823 0 .214.107.337.263.337a.431.431 0 0 0 .214-.066c.264-.152.477-.519.477-.822 0-.214-.107-.338-.263-.338' fill='#8097A2'/><path d='M139.278 7.769v43.667L72.208 90.16V46.493l67.07-38.724' fill='#455A64'/><path d='M72.083 90.375V46.421l.063-.036 67.257-38.831v43.954l-.062.036-67.258 38.831zm.25-43.811v43.38l66.821-38.579V7.985L72.333 46.564z' fill='#607D8B'/></g><path d='M125.737 88.647l-7.639 3.334V84l-11.459 4.713v8.269L99 100.315l13.369 3.646 13.368-15.314' fill='#455A64'/></g></svg>";function yt(){this.loadIcon_();var Z=document.createElement("div"),ie=Z.style;ie.position="fixed",ie.top=0,ie.right=0,ie.bottom=0,ie.left=0,ie.backgroundColor="gray",ie.fontFamily="sans-serif",ie.zIndex=1e6;var be=document.createElement("img");be.src=this.icon;var ie=be.style;ie.marginLeft="25%",ie.marginTop="25%",ie.width="50%",Z.appendChild(be);var Ae=document.createElement("div"),ie=Ae.style;ie.textAlign="center",ie.fontSize="16px",ie.lineHeight="24px",ie.margin="24px 25%",ie.width="50%",Ae.innerHTML="Place your phone into your Cardboard viewer.",Z.appendChild(Ae);var ze=document.createElement("div"),ie=ze.style;ie.backgroundColor="#CFD8DC",ie.position="fixed",ie.bottom=0,ie.width="100%",ie.height="48px",ie.padding="14px 24px",ie.boxSizing="border-box",ie.color="#656A6B",Z.appendChild(ze);var ft=document.createElement("div");ft.style.float="left",ft.innerHTML="No Cardboard viewer?";var Ct=document.createElement("a");Ct.href="https://www.google.com/get/cardboard/get-cardboard/",Ct.innerHTML="get one",Ct.target="_blank";var ie=Ct.style;ie.float="right",ie.fontWeight=600,ie.textTransform="uppercase",ie.borderLeft="1px solid gray",ie.paddingLeft="24px",ie.textDecoration="none",ie.color="#656A6B",ze.appendChild(ft),ze.appendChild(Ct),this.overlay=Z,this.text=Ae,this.hide()}yt.prototype.show=function(Z){!Z&&!this.overlay.parentElement?document.body.appendChild(this.overlay):Z&&(this.overlay.parentElement&&this.overlay.parentElement!=Z&&this.overlay.parentElement.removeChild(this.overlay),Z.appendChild(this.overlay)),this.overlay.style.display="block";var ie=this.overlay.querySelector("img"),be=ie.style;_e()?(be.width="20%",be.marginLeft="40%",be.marginTop="3%"):(be.width="50%",be.marginLeft="25%",be.marginTop="25%")},yt.prototype.hide=function(){this.overlay.style.display="none"},yt.prototype.showTemporarily=function(Z,ie){this.show(ie),this.timer=setTimeout(this.hide.bind(this),Z)},yt.prototype.disableShowTemporarily=function(){clearTimeout(this.timer)},yt.prototype.update=function(){this.disableShowTemporarily(),!_e()&&ye()?this.show():this.hide()},yt.prototype.loadIcon_=function(){this.icon=$("image/svg+xml",bt)};var zt="CardboardV1",kt="WEBVR_CARDBOARD_VIEWER",sn="webvr-polyfill-viewer-selector";function jt(Z){try{this.selectedKey=localStorage.getItem(kt)}catch(ie){console.error("Failed to load viewer profile: %s",ie)}this.selectedKey||(this.selectedKey=Z||zt),this.dialog=this.createDialog_(Jn.Viewers),this.root=null,this.onChangeCallbacks_=[]}jt.prototype.show=function(Z){this.root=Z,Z.appendChild(this.dialog);var ie=this.dialog.querySelector("#"+this.selectedKey);ie.checked=!0,this.dialog.style.display="block"},jt.prototype.hide=function(){this.root&&this.root.contains(this.dialog)&&this.root.removeChild(this.dialog),this.dialog.style.display="none"},jt.prototype.getCurrentViewer=function(){return Jn.Viewers[this.selectedKey]},jt.prototype.getSelectedKey_=function(){var Z=this.dialog.querySelector("input[name=field]:checked");return Z?Z.id:null},jt.prototype.onChange=function(Z){this.onChangeCallbacks_.push(Z)},jt.prototype.fireOnChange_=function(Z){for(var ie=0;ie<this.onChangeCallbacks_.length;ie++)this.onChangeCallbacks_[ie](Z)},jt.prototype.onSave_=function(){if(this.selectedKey=this.getSelectedKey_(),!this.selectedKey||!Jn.Viewers[this.selectedKey]){console.error("ViewerSelector.onSave_: this should never happen!");return}this.fireOnChange_(Jn.Viewers[this.selectedKey]);try{localStorage.setItem(kt,this.selectedKey)}catch(Z){console.error("Failed to save viewer profile: %s",Z)}this.hide()},jt.prototype.createDialog_=function(Z){var ie=document.createElement("div");ie.classList.add(sn),ie.style.display="none";var be=document.createElement("div"),Ae=be.style;Ae.position="fixed",Ae.left=0,Ae.top=0,Ae.width="100%",Ae.height="100%",Ae.background="rgba(0, 0, 0, 0.3)",be.addEventListener("click",this.hide.bind(this));var ze=280,ft=document.createElement("div"),Ae=ft.style;Ae.boxSizing="border-box",Ae.position="fixed",Ae.top="24px",Ae.left="50%",Ae.marginLeft=-ze/2+"px",Ae.width=ze+"px",Ae.padding="24px",Ae.overflow="hidden",Ae.background="#fafafa",Ae.fontFamily="'Roboto', sans-serif",Ae.boxShadow="0px 5px 20px #666",ft.appendChild(this.createH1_("Select your viewer"));for(var Ct in Z)ft.appendChild(this.createChoice_(Ct,Z[Ct].label));return ft.appendChild(this.createButton_("Save",this.onSave_.bind(this))),ie.appendChild(be),ie.appendChild(ft),ie},jt.prototype.createH1_=function(Z){var ie=document.createElement("h1"),be=ie.style;return be.color="black",be.fontSize="20px",be.fontWeight="bold",be.marginTop=0,be.marginBottom="24px",ie.innerHTML=Z,ie},jt.prototype.createChoice_=function(Z,ie){var be=document.createElement("div");be.style.marginTop="8px",be.style.color="black";var Ae=document.createElement("input");Ae.style.fontSize="30px",Ae.setAttribute("id",Z),Ae.setAttribute("type","radio"),Ae.setAttribute("value",Z),Ae.setAttribute("name","field");var ze=document.createElement("label");return ze.style.marginLeft="4px",ze.setAttribute("for",Z),ze.innerHTML=ie,be.appendChild(Ae),be.appendChild(ze),be},jt.prototype.createButton_=function(Z,ie){var be=document.createElement("button");be.innerHTML=Z;var Ae=be.style;return Ae.float="right",Ae.textTransform="uppercase",Ae.color="#1094f7",Ae.fontSize="14px",Ae.letterSpacing=0,Ae.border=0,Ae.background="none",Ae.marginTop="16px",be.addEventListener("click",ie),be};var Nt=typeof window!="undefined"?window:typeof u!="undefined"?u:typeof self!="undefined"?self:{};function mn(Z){return Z&&Z.__esModule&&Object.prototype.hasOwnProperty.call(Z,"default")?Z.default:Z}function An(Z,ie){return ie={exports:{}},Z(ie,ie.exports),ie.exports}var Cn=An(function(Z,ie){(function(Ae,ze){Z.exports=ze()})(Nt,function(){return function(be){var Ae={};function ze(ft){if(Ae[ft])return Ae[ft].exports;var Ct=Ae[ft]={i:ft,l:!1,exports:{}};return be[ft].call(Ct.exports,Ct,Ct.exports,ze),Ct.l=!0,Ct.exports}return ze.m=be,ze.c=Ae,ze.d=function(ft,Ct,Xt){ze.o(ft,Ct)||Object.defineProperty(ft,Ct,{configurable:!1,enumerable:!0,get:Xt})},ze.n=function(ft){var Ct=ft&&ft.__esModule?function(){return ft.default}:function(){return ft};return ze.d(Ct,"a",Ct),Ct},ze.o=function(ft,Ct){return Object.prototype.hasOwnProperty.call(ft,Ct)},ze.p="",ze(ze.s=0)}([function(be,Ae,ze){var ft=function(){function se(he,Te){for(var Pe=0;Pe<Te.length;Pe++){var Ce=Te[Pe];Ce.enumerable=Ce.enumerable||!1,Ce.configurable=!0,"value"in Ce&&(Ce.writable=!0),Object.defineProperty(he,Ce.key,Ce)}}return function(he,Te,Pe){return Te&&se(he.prototype,Te),Pe&&se(he,Pe),he}}();function Ct(se,he){if(!(se instanceof he))throw new TypeError("Cannot call a class as a function")}var Xt=ze(1),Et=typeof navigator!="undefined"&&parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))<10&&!window.MSStream,wt=function(){function se(){Ct(this,se),Et?this.noSleepTimer=null:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("playsinline",""),this.noSleepVideo.setAttribute("src",Xt),this.noSleepVideo.addEventListener("timeupdate",function(he){this.noSleepVideo.currentTime>.5&&(this.noSleepVideo.currentTime=Math.random())}.bind(this)))}return ft(se,[{key:"enable",value:function(){Et?(this.disable(),this.noSleepTimer=window.setInterval(function(){window.location.href="/",window.setTimeout(window.stop,0)},15e3)):this.noSleepVideo.play()}},{key:"disable",value:function(){Et?this.noSleepTimer&&(window.clearInterval(this.noSleepTimer),this.noSleepTimer=null):this.noSleepVideo.pause()}}]),se}();be.exports=wt},function(be,Ae,ze){be.exports="data:video/mp4;base64,AAAAIGZ0eXBtcDQyAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAACKBtZGF0AAAC8wYF///v3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE0MiByMjQ3OSBkZDc5YTYxIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTEgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MToweDExMSBtZT1oZXggc3VibWU9MiBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0wIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MCA4eDhkY3Q9MCBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0wIHRocmVhZHM9NiBsb29rYWhlYWRfdGhyZWFkcz0xIHNsaWNlZF90aHJlYWRzPTAgbnI9MCBkZWNpbWF0ZT0xIGludGVybGFjZWQ9MCBibHVyYXlfY29tcGF0PTAgY29uc3RyYWluZWRfaW50cmE9MCBiZnJhbWVzPTMgYl9weXJhbWlkPTIgYl9hZGFwdD0xIGJfYmlhcz0wIGRpcmVjdD0xIHdlaWdodGI9MSBvcGVuX2dvcD0wIHdlaWdodHA9MSBrZXlpbnQ9MzAwIGtleWludF9taW49MzAgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD0xMCByYz1jcmYgbWJ0cmVlPTEgY3JmPTIwLjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IHZidl9tYXhyYXRlPTIwMDAwIHZidl9idWZzaXplPTI1MDAwIGNyZl9tYXg9MC4wIG5hbF9ocmQ9bm9uZSBmaWxsZXI9MCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAOWWIhAA3//p+C7v8tDDSTjf97w55i3SbRPO4ZY+hkjD5hbkAkL3zpJ6h/LR1CAABzgB1kqqzUorlhQAAAAxBmiQYhn/+qZYADLgAAAAJQZ5CQhX/AAj5IQADQGgcIQADQGgcAAAACQGeYUQn/wALKCEAA0BoHAAAAAkBnmNEJ/8ACykhAANAaBwhAANAaBwAAAANQZpoNExDP/6plgAMuSEAA0BoHAAAAAtBnoZFESwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBnqVEJ/8ACykhAANAaBwAAAAJAZ6nRCf/AAsoIQADQGgcIQADQGgcAAAADUGarDRMQz/+qZYADLghAANAaBwAAAALQZ7KRRUsK/8ACPkhAANAaBwAAAAJAZ7pRCf/AAsoIQADQGgcIQADQGgcAAAACQGe60Qn/wALKCEAA0BoHAAAAA1BmvA0TEM//qmWAAy5IQADQGgcIQADQGgcAAAAC0GfDkUVLCv/AAj5IQADQGgcAAAACQGfLUQn/wALKSEAA0BoHCEAA0BoHAAAAAkBny9EJ/8ACyghAANAaBwAAAANQZs0NExDP/6plgAMuCEAA0BoHAAAAAtBn1JFFSwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBn3FEJ/8ACyghAANAaBwAAAAJAZ9zRCf/AAsoIQADQGgcIQADQGgcAAAADUGbeDRMQz/+qZYADLkhAANAaBwAAAALQZ+WRRUsK/8ACPghAANAaBwhAANAaBwAAAAJAZ+1RCf/AAspIQADQGgcAAAACQGft0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bm7w0TEM//qmWAAy4IQADQGgcAAAAC0Gf2kUVLCv/AAj5IQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHAAAAAkBn/tEJ/8ACykhAANAaBwAAAANQZvgNExDP/6plgAMuSEAA0BoHCEAA0BoHAAAAAtBnh5FFSwr/wAI+CEAA0BoHAAAAAkBnj1EJ/8ACyghAANAaBwhAANAaBwAAAAJAZ4/RCf/AAspIQADQGgcAAAADUGaJDRMQz/+qZYADLghAANAaBwAAAALQZ5CRRUsK/8ACPkhAANAaBwhAANAaBwAAAAJAZ5hRCf/AAsoIQADQGgcAAAACQGeY0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bmmg0TEM//qmWAAy5IQADQGgcAAAAC0GehkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGepUQn/wALKSEAA0BoHAAAAAkBnqdEJ/8ACyghAANAaBwAAAANQZqsNExDP/6plgAMuCEAA0BoHCEAA0BoHAAAAAtBnspFFSwr/wAI+SEAA0BoHAAAAAkBnulEJ/8ACyghAANAaBwhAANAaBwAAAAJAZ7rRCf/AAsoIQADQGgcAAAADUGa8DRMQz/+qZYADLkhAANAaBwhAANAaBwAAAALQZ8ORRUsK/8ACPkhAANAaBwAAAAJAZ8tRCf/AAspIQADQGgcIQADQGgcAAAACQGfL0Qn/wALKCEAA0BoHAAAAA1BmzQ0TEM//qmWAAy4IQADQGgcAAAAC0GfUkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGfcUQn/wALKCEAA0BoHAAAAAkBn3NEJ/8ACyghAANAaBwhAANAaBwAAAANQZt4NExC//6plgAMuSEAA0BoHAAAAAtBn5ZFFSwr/wAI+CEAA0BoHCEAA0BoHAAAAAkBn7VEJ/8ACykhAANAaBwAAAAJAZ+3RCf/AAspIQADQGgcAAAADUGbuzRMQn/+nhAAYsAhAANAaBwhAANAaBwAAAAJQZ/aQhP/AAspIQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHAAACiFtb292AAAAbG12aGQAAAAA1YCCX9WAgl8AAAPoAAAH/AABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAGGlvZHMAAAAAEICAgAcAT////v7/AAAF+XRyYWsAAABcdGtoZAAAAAPVgIJf1YCCXwAAAAEAAAAAAAAH0AAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAygAAAMoAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAB9AAABdwAAEAAAAABXFtZGlhAAAAIG1kaGQAAAAA1YCCX9WAgl8AAV+QAAK/IFXEAAAAAAAtaGRscgAAAAAAAAAAdmlkZQAAAAAAAAAAAAAAAFZpZGVvSGFuZGxlcgAAAAUcbWluZgAAABR2bWhkAAAAAQAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAAE3HN0YmwAAACYc3RzZAAAAAAAAAABAAAAiGF2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAygDKAEgAAABIAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY//8AAAAyYXZjQwFNQCj/4QAbZ01AKOyho3ySTUBAQFAAAAMAEAAr8gDxgxlgAQAEaO+G8gAAABhzdHRzAAAAAAAAAAEAAAA8AAALuAAAABRzdHNzAAAAAAAAAAEAAAABAAAB8GN0dHMAAAAAAAAAPAAAAAEAABdwAAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAAC7gAAAAAQAAF3AAAAABAAAAAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAEEc3RzegAAAAAAAAAAAAAAPAAAAzQAAAAQAAAADQAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAANAAAADQAAAQBzdGNvAAAAAAAAADwAAAAwAAADZAAAA3QAAAONAAADoAAAA7kAAAPQAAAD6wAAA/4AAAQXAAAELgAABEMAAARcAAAEbwAABIwAAAShAAAEugAABM0AAATkAAAE/wAABRIAAAUrAAAFQgAABV0AAAVwAAAFiQAABaAAAAW1AAAFzgAABeEAAAX+AAAGEwAABiwAAAY/AAAGVgAABnEAAAaEAAAGnQAABrQAAAbPAAAG4gAABvUAAAcSAAAHJwAAB0AAAAdTAAAHcAAAB4UAAAeeAAAHsQAAB8gAAAfjAAAH9gAACA8AAAgmAAAIQQAACFQAAAhnAAAIhAAACJcAAAMsdHJhawAAAFx0a2hkAAAAA9WAgl/VgIJfAAAAAgAAAAAAAAf8AAAAAAAAAAAAAAABAQAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAACsm1kaWEAAAAgbWRoZAAAAADVgIJf1YCCXwAArEQAAWAAVcQAAAAAACdoZGxyAAAAAAAAAABzb3VuAAAAAAAAAAAAAAAAU3RlcmVvAAAAAmNtaW5mAAAAEHNtaGQAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAidzdGJsAAAAZ3N0c2QAAAAAAAAAAQAAAFdtcDRhAAAAAAAAAAEAAAAAAAAAAAACABAAAAAArEQAAAAAADNlc2RzAAAAAAOAgIAiAAIABICAgBRAFQAAAAADDUAAAAAABYCAgAISEAaAgIABAgAAABhzdHRzAAAAAAAAAAEAAABYAAAEAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAAUc3RzegAAAAAAAAAGAAAAWAAAAXBzdGNvAAAAAAAAAFgAAAOBAAADhwAAA5oAAAOtAAADswAAA8oAAAPfAAAD5QAAA/gAAAQLAAAEEQAABCgAAAQ9AAAEUAAABFYAAARpAAAEgAAABIYAAASbAAAErgAABLQAAATHAAAE3gAABPMAAAT5AAAFDAAABR8AAAUlAAAFPAAABVEAAAVXAAAFagAABX0AAAWDAAAFmgAABa8AAAXCAAAFyAAABdsAAAXyAAAF+AAABg0AAAYgAAAGJgAABjkAAAZQAAAGZQAABmsAAAZ+AAAGkQAABpcAAAauAAAGwwAABskAAAbcAAAG7wAABwYAAAcMAAAHIQAABzQAAAc6AAAHTQAAB2QAAAdqAAAHfwAAB5IAAAeYAAAHqwAAB8IAAAfXAAAH3QAAB/AAAAgDAAAICQAACCAAAAg1AAAIOwAACE4AAAhhAAAIeAAACH4AAAiRAAAIpAAACKoAAAiwAAAItgAACLwAAAjCAAAAFnVkdGEAAAAObmFtZVN0ZXJlbwAAAHB1ZHRhAAAAaG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAO2lsc3QAAAAzqXRvbwAAACtkYXRhAAAAAQAAAABIYW5kQnJha2UgMC4xMC4yIDIwMTUwNjExMDA="}])})}),Gn=mn(Cn),tr=1e3,Rn=[0,0,.5,1],_r=[.5,0,.5,1],Nr=window.requestAnimationFrame,Fi=window.cancelAnimationFrame;function Xn(){this.leftProjectionMatrix=new Float32Array(16),this.leftViewMatrix=new Float32Array(16),this.rightProjectionMatrix=new Float32Array(16),this.rightViewMatrix=new Float32Array(16),this.pose=null}function dr(Z){Object.defineProperties(this,{hasPosition:{writable:!1,enumerable:!0,value:Z.hasPosition},hasExternalDisplay:{writable:!1,enumerable:!0,value:Z.hasExternalDisplay},canPresent:{writable:!1,enumerable:!0,value:Z.canPresent},maxLayers:{writable:!1,enumerable:!0,value:Z.maxLayers},hasOrientation:{enumerable:!0,get:function(){return Se("VRDisplayCapabilities.prototype.hasOrientation","VRDisplay.prototype.getFrameData"),Z.hasOrientation}}})}function ur(Z){Z=Z||{};var ie="wakelock"in Z?Z.wakelock:!0;this.isPolyfilled=!0,this.displayId=tr++,this.displayName="",this.depthNear=.01,this.depthFar=1e4,this.isPresenting=!1,Object.defineProperty(this,"isConnected",{get:function(){return Se("VRDisplay.prototype.isConnected","VRDisplayCapabilities.prototype.hasExternalDisplay"),!1}}),this.capabilities=new dr({hasPosition:!1,hasOrientation:!1,hasExternalDisplay:!1,canPresent:!1,maxLayers:1}),this.stageParameters=null,this.waitingForPresent_=!1,this.layer_=null,this.originalParent_=null,this.fullscreenElement_=null,this.fullscreenWrapper_=null,this.fullscreenElementCachedStyle_=null,this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null,ie&&ye()&&(this.wakelock_=new Gn)}ur.prototype.getFrameData=function(Z){return j(Z,this._getPose(),this)},ur.prototype.getPose=function(){return Se("VRDisplay.prototype.getPose","VRDisplay.prototype.getFrameData"),this._getPose()},ur.prototype.resetPose=function(){return Se("VRDisplay.prototype.resetPose"),this._resetPose()},ur.prototype.getImmediatePose=function(){return Se("VRDisplay.prototype.getImmediatePose","VRDisplay.prototype.getFrameData"),this._getPose()},ur.prototype.requestAnimationFrame=function(Z){return Nr(Z)},ur.prototype.cancelAnimationFrame=function(Z){return Fi(Z)},ur.prototype.wrapForFullscreen=function(Z){if(D())return Z;if(!this.fullscreenWrapper_){this.fullscreenWrapper_=document.createElement("div");var ie=["height: "+Math.min(screen.height,screen.width)+"px !important","top: 0 !important","left: 0 !important","right: 0 !important","border: 0","margin: 0","padding: 0","z-index: 999999 !important","position: fixed"];this.fullscreenWrapper_.setAttribute("style",ie.join("; ")+";"),this.fullscreenWrapper_.classList.add("webvr-polyfill-fullscreen-wrapper")}if(this.fullscreenElement_==Z)return this.fullscreenWrapper_;if(this.fullscreenElement_&&(this.originalParent_?this.originalParent_.appendChild(this.fullscreenElement_):this.fullscreenElement_.parentElement.removeChild(this.fullscreenElement_)),this.fullscreenElement_=Z,this.originalParent_=Z.parentElement,this.originalParent_||document.body.appendChild(Z),!this.fullscreenWrapper_.parentElement){var be=this.fullscreenElement_.parentElement;be.insertBefore(this.fullscreenWrapper_,this.fullscreenElement_),be.removeChild(this.fullscreenElement_)}this.fullscreenWrapper_.insertBefore(this.fullscreenElement_,this.fullscreenWrapper_.firstChild),this.fullscreenElementCachedStyle_=this.fullscreenElement_.getAttribute("style");var Ae=this;function ze(){if(!!Ae.fullscreenElement_){var ft=["position: absolute","top: 0","left: 0","width: "+Math.max(screen.width,screen.height)+"px","height: "+Math.min(screen.height,screen.width)+"px","border: 0","margin: 0","padding: 0"];Ae.fullscreenElement_.setAttribute("style",ft.join("; ")+";")}}return ze(),this.fullscreenWrapper_},ur.prototype.removeFullscreenWrapper=function(){if(!!this.fullscreenElement_){var Z=this.fullscreenElement_;this.fullscreenElementCachedStyle_?Z.setAttribute("style",this.fullscreenElementCachedStyle_):Z.removeAttribute("style"),this.fullscreenElement_=null,this.fullscreenElementCachedStyle_=null;var ie=this.fullscreenWrapper_.parentElement;return this.fullscreenWrapper_.removeChild(Z),this.originalParent_===ie?ie.insertBefore(Z,this.fullscreenWrapper_):this.originalParent_&&this.originalParent_.appendChild(Z),ie.removeChild(this.fullscreenWrapper_),Z}},ur.prototype.requestPresent=function(Z){var ie=this.isPresenting,be=this;return Z instanceof Array||(Se("VRDisplay.prototype.requestPresent with non-array argument","an array of VRLayers as the first argument"),Z=[Z]),new Promise(function(Ae,ze){if(!be.capabilities.canPresent){ze(new Error("VRDisplay is not capable of presenting."));return}if(Z.length==0||Z.length>be.capabilities.maxLayers){ze(new Error("Invalid number of layers."));return}var ft=Z[0];if(!ft.source){Ae();return}var Ct=ft.leftBounds||Rn,Xt=ft.rightBounds||_r;if(ie){var Et=be.layer_;Et.source!==ft.source&&(Et.source=ft.source);for(var wt=0;wt<4;wt++)Et.leftBounds[wt]=Ct[wt],Et.rightBounds[wt]=Xt[wt];be.wrapForFullscreen(be.layer_.source),be.updatePresent_(),Ae();return}if(be.layer_={predistorted:ft.predistorted,source:ft.source,leftBounds:Ct.slice(0),rightBounds:Xt.slice(0)},be.waitingForPresent_=!1,be.layer_&&be.layer_.source){var se=be.wrapForFullscreen(be.layer_.source),he=function(){var Ce=Me();be.isPresenting=se===Ce,be.isPresenting?(screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape-primary").catch(function(pt){console.error("screen.orientation.lock() failed due to",pt.message)}),be.waitingForPresent_=!1,be.beginPresent_(),Ae()):(screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),be.removeFullscreenWrapper(),be.disableWakeLock(),be.endPresent_(),be.removeFullscreenListeners_()),be.fireVRDisplayPresentChange_()},Te=function(){!be.waitingForPresent_||(be.removeFullscreenWrapper(),be.removeFullscreenListeners_(),be.disableWakeLock(),be.waitingForPresent_=!1,be.isPresenting=!1,ze(new Error("Unable to present.")))};be.addFullscreenListeners_(se,he,Te),Le(se)?(be.enableWakeLock(),be.waitingForPresent_=!0):(D()||I())&&(be.enableWakeLock(),be.isPresenting=!0,be.beginPresent_(),be.fireVRDisplayPresentChange_(),Ae())}!be.waitingForPresent_&&!D()&&(Fe(),ze(new Error("Unable to present.")))})},ur.prototype.exitPresent=function(){var Z=this.isPresenting,ie=this;return this.isPresenting=!1,this.layer_=null,this.disableWakeLock(),new Promise(function(be,Ae){Z?(!Fe()&&D()&&(ie.endPresent_(),ie.fireVRDisplayPresentChange_()),I()&&(ie.removeFullscreenWrapper(),ie.removeFullscreenListeners_(),ie.endPresent_(),ie.fireVRDisplayPresentChange_()),be()):Ae(new Error("Was not presenting to VRDisplay."))})},ur.prototype.getLayers=function(){return this.layer_?[this.layer_]:[]},ur.prototype.fireVRDisplayPresentChange_=function(){var Z=new CustomEvent("vrdisplaypresentchange",{detail:{display:this}});window.dispatchEvent(Z)},ur.prototype.fireVRDisplayConnect_=function(){var Z=new CustomEvent("vrdisplayconnect",{detail:{display:this}});window.dispatchEvent(Z)},ur.prototype.addFullscreenListeners_=function(Z,ie,be){this.removeFullscreenListeners_(),this.fullscreenEventTarget_=Z,this.fullscreenChangeHandler_=ie,this.fullscreenErrorHandler_=be,ie&&(document.fullscreenEnabled?Z.addEventListener("fullscreenchange",ie,!1):document.webkitFullscreenEnabled?Z.addEventListener("webkitfullscreenchange",ie,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenchange",ie,!1):document.msFullscreenEnabled&&Z.addEventListener("msfullscreenchange",ie,!1)),be&&(document.fullscreenEnabled?Z.addEventListener("fullscreenerror",be,!1):document.webkitFullscreenEnabled?Z.addEventListener("webkitfullscreenerror",be,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenerror",be,!1):document.msFullscreenEnabled&&Z.addEventListener("msfullscreenerror",be,!1))},ur.prototype.removeFullscreenListeners_=function(){if(!!this.fullscreenEventTarget_){var Z=this.fullscreenEventTarget_;if(this.fullscreenChangeHandler_){var ie=this.fullscreenChangeHandler_;Z.removeEventListener("fullscreenchange",ie,!1),Z.removeEventListener("webkitfullscreenchange",ie,!1),document.removeEventListener("mozfullscreenchange",ie,!1),Z.removeEventListener("msfullscreenchange",ie,!1)}if(this.fullscreenErrorHandler_){var be=this.fullscreenErrorHandler_;Z.removeEventListener("fullscreenerror",be,!1),Z.removeEventListener("webkitfullscreenerror",be,!1),document.removeEventListener("mozfullscreenerror",be,!1),Z.removeEventListener("msfullscreenerror",be,!1)}this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null}},ur.prototype.enableWakeLock=function(){this.wakelock_&&this.wakelock_.enable()},ur.prototype.disableWakeLock=function(){this.wakelock_&&this.wakelock_.disable()},ur.prototype.beginPresent_=function(){},ur.prototype.endPresent_=function(){},ur.prototype.submitFrame=function(Z){},ur.prototype.getEyeParameters=function(Z){return null};var $i={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1},qr={LEFT:"left",RIGHT:"right"};function Qr(Z){var ie=fe({},$i);Z=fe(ie,Z||{}),ur.call(this,{wakelock:Z.MOBILE_WAKE_LOCK}),this.config=Z,this.displayName="Cardboard VRDisplay",this.capabilities=new dr({hasPosition:!1,hasOrientation:!0,hasExternalDisplay:!1,canPresent:!0,maxLayers:1}),this.stageParameters=null,this.bufferScale_=this.config.BUFFER_SCALE,this.poseSensor_=new ct(this.config),this.distorter_=null,this.cardboardUI_=null,this.dpdb_=new je(this.config.DPDB_URL,this.onDeviceParamsUpdated_.bind(this)),this.deviceInfo_=new Jn(this.dpdb_.getDeviceParams(),Z.ADDITIONAL_VIEWERS),this.viewerSelector_=new jt(Z.DEFAULT_VIEWER),this.viewerSelector_.onChange(this.onViewerChanged_.bind(this)),this.deviceInfo_.setViewer(this.viewerSelector_.getCurrentViewer()),this.config.ROTATE_INSTRUCTIONS_DISABLED||(this.rotateInstructions_=new yt),D()&&window.addEventListener("resize",this.onResize_.bind(this))}return Qr.prototype=Object.create(ur.prototype),Qr.prototype._getPose=function(){return{position:null,orientation:this.poseSensor_.getOrientation(),linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}},Qr.prototype._resetPose=function(){this.poseSensor_.resetPose&&this.poseSensor_.resetPose()},Qr.prototype._getFieldOfView=function(Z){var ie;if(Z==qr.LEFT)ie=this.deviceInfo_.getFieldOfViewLeftEye();else if(Z==qr.RIGHT)ie=this.deviceInfo_.getFieldOfViewRightEye();else return console.error("Invalid eye provided: %s",Z),null;return ie},Qr.prototype._getEyeOffset=function(Z){var ie;if(Z==qr.LEFT)ie=[-this.deviceInfo_.viewer.interLensDistance*.5,0,0];else if(Z==qr.RIGHT)ie=[this.deviceInfo_.viewer.interLensDistance*.5,0,0];else return console.error("Invalid eye provided: %s",Z),null;return ie},Qr.prototype.getEyeParameters=function(Z){var ie=this._getEyeOffset(Z),be=this._getFieldOfView(Z),Ae={offset:ie,renderWidth:this.deviceInfo_.device.width*.5*this.bufferScale_,renderHeight:this.deviceInfo_.device.height*this.bufferScale_};return Object.defineProperty(Ae,"fieldOfView",{enumerable:!0,get:function(){return Se("VRFieldOfView","VRFrameData's projection matrices"),be}}),Ae},Qr.prototype.onDeviceParamsUpdated_=function(Z){this.config.DEBUG&&console.log("DPDB reported that device params were updated."),this.deviceInfo_.updateDeviceParams(Z),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_)},Qr.prototype.updateBounds_=function(){this.layer_&&this.distorter_&&(this.layer_.leftBounds||this.layer_.rightBounds)&&this.distorter_.setTextureBounds(this.layer_.leftBounds,this.layer_.rightBounds)},Qr.prototype.beginPresent_=function(){var Z=this.layer_.source.getContext("webgl");Z||(Z=this.layer_.source.getContext("experimental-webgl")),Z||(Z=this.layer_.source.getContext("webgl2")),!!Z&&(this.layer_.predistorted?this.config.CARDBOARD_UI_DISABLED||(Z.canvas.width=Ie()*this.bufferScale_,Z.canvas.height=Ve()*this.bufferScale_,this.cardboardUI_=new Fn(Z)):(this.config.CARDBOARD_UI_DISABLED||(this.cardboardUI_=new Fn(Z)),this.distorter_=new K(Z,this.cardboardUI_,this.config.BUFFER_SCALE,this.config.DIRTY_SUBMIT_FRAME_BINDINGS),this.distorter_.updateDeviceInfo(this.deviceInfo_)),this.cardboardUI_&&this.cardboardUI_.listen(function(ie){this.viewerSelector_.show(this.layer_.source.parentElement),ie.stopPropagation(),ie.preventDefault()}.bind(this),function(ie){this.exitPresent(),ie.stopPropagation(),ie.preventDefault()}.bind(this)),this.rotateInstructions_&&(_e()&&ye()?this.rotateInstructions_.showTemporarily(3e3,this.layer_.source.parentElement):this.rotateInstructions_.update()),this.orientationHandler=this.onOrientationChange_.bind(this),window.addEventListener("orientationchange",this.orientationHandler),this.vrdisplaypresentchangeHandler=this.updateBounds_.bind(this),window.addEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler),this.fireVRDisplayDeviceParamsChange_())},Qr.prototype.endPresent_=function(){this.distorter_&&(this.distorter_.destroy(),this.distorter_=null),this.cardboardUI_&&(this.cardboardUI_.destroy(),this.cardboardUI_=null),this.rotateInstructions_&&this.rotateInstructions_.hide(),this.viewerSelector_.hide(),window.removeEventListener("orientationchange",this.orientationHandler),window.removeEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler)},Qr.prototype.updatePresent_=function(){this.endPresent_(),this.beginPresent_()},Qr.prototype.submitFrame=function(Z){if(this.distorter_)this.updateBounds_(),this.distorter_.submitFrame();else if(this.cardboardUI_&&this.layer_){var ie=this.layer_.source.getContext("webgl");ie||(ie=this.layer_.source.getContext("experimental-webgl")),ie||(ie=this.layer_.source.getContext("webgl2"));var be=ie.canvas;(be.width!=this.lastWidth||be.height!=this.lastHeight)&&this.cardboardUI_.onResize(),this.lastWidth=be.width,this.lastHeight=be.height,this.cardboardUI_.render()}},Qr.prototype.onOrientationChange_=function(Z){this.viewerSelector_.hide(),this.rotateInstructions_&&this.rotateInstructions_.update(),this.onResize_()},Qr.prototype.onResize_=function(Z){if(this.layer_){var ie=this.layer_.source.getContext("webgl");ie||(ie=this.layer_.source.getContext("experimental-webgl")),ie||(ie=this.layer_.source.getContext("webgl2"));var be=["position: absolute","top: 0","left: 0","width: 100vw","height: 100vh","border: 0","margin: 0","padding: 0px","box-sizing: content-box"];ie.canvas.setAttribute("style",be.join("; ")+";"),H(ie.canvas)}},Qr.prototype.onViewerChanged_=function(Z){this.deviceInfo_.setViewer(Z),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_),this.fireVRDisplayDeviceParamsChange_()},Qr.prototype.fireVRDisplayDeviceParamsChange_=function(){var Z=new CustomEvent("vrdisplaydeviceparamschange",{detail:{vrdisplay:this,deviceInfo:this.deviceInfo_}});window.dispatchEvent(Z)},Qr.VRFrameData=Xn,Qr.VRDisplay=ur,Qr})}),w=f(b),A="0.10.12",M={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",PROVIDE_MOBILE_VRDISPLAY:!0,MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1};function S(L){this.config=y(y({},M),L),this.polyfillDisplays=[],this.enabled=!1,this.hasNative="getVRDisplays"in navigator,this.native={},this.native.getVRDisplays=navigator.getVRDisplays,this.native.VRFrameData=window.VRFrameData,this.native.VRDisplay=window.VRDisplay,(!this.hasNative||this.config.PROVIDE_MOBILE_VRDISPLAY&&m())&&(this.enable(),this.getVRDisplays().then(function(P){P&&P[0]&&P[0].fireVRDisplayConnect_&&P[0].fireVRDisplayConnect_()}))}S.prototype.getPolyfillDisplays=function(){if(this._polyfillDisplaysPopulated)return this.polyfillDisplays;if(m()){var L=new w({ADDITIONAL_VIEWERS:this.config.ADDITIONAL_VIEWERS,DEFAULT_VIEWER:this.config.DEFAULT_VIEWER,MOBILE_WAKE_LOCK:this.config.MOBILE_WAKE_LOCK,DEBUG:this.config.DEBUG,DPDB_URL:this.config.DPDB_URL,CARDBOARD_UI_DISABLED:this.config.CARDBOARD_UI_DISABLED,K_FILTER:this.config.K_FILTER,PREDICTION_TIME_S:this.config.PREDICTION_TIME_S,ROTATE_INSTRUCTIONS_DISABLED:this.config.ROTATE_INSTRUCTIONS_DISABLED,YAW_ONLY:this.config.YAW_ONLY,BUFFER_SCALE:this.config.BUFFER_SCALE,DIRTY_SUBMIT_FRAME_BINDINGS:this.config.DIRTY_SUBMIT_FRAME_BINDINGS});this.polyfillDisplays.push(L)}return this._polyfillDisplaysPopulated=!0,this.polyfillDisplays},S.prototype.enable=function(){if(this.enabled=!0,this.hasNative&&this.native.VRFrameData){var L=this.native.VRFrameData,P=new this.native.VRFrameData,N=this.native.VRDisplay.prototype.getFrameData;window.VRDisplay.prototype.getFrameData=function(F){if(F instanceof L){N.call(this,F);return}N.call(this,P),F.pose=P.pose,g(P.leftProjectionMatrix,F.leftProjectionMatrix),g(P.rightProjectionMatrix,F.rightProjectionMatrix),g(P.leftViewMatrix,F.leftViewMatrix),g(P.rightViewMatrix,F.rightViewMatrix)}}navigator.getVRDisplays=this.getVRDisplays.bind(this),window.VRDisplay=w.VRDisplay,window.VRFrameData=w.VRFrameData},S.prototype.getVRDisplays=function(){var L=this;return this.config,this.hasNative?this.native.getVRDisplays.call(navigator).then(function(P){return P.length>0?P:L.getPolyfillDisplays()}):Promise.resolve(this.getPolyfillDisplays())},S.version=A,S.VRFrameData=w.VRFrameData,S.VRDisplay=w.VRDisplay;var E=Object.freeze({default:S}),T=E&&S||E;typeof u!="undefined"&&u.window&&(u.document||(u.document=u.window.document),u.navigator||(u.navigator=u.window.navigator));var C=T;return C})}).call(this,typeof Ba!="undefined"?Ba:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],69:[function(r,a,s){var o=/\n/,u=`
`,f=/\s/;a.exports=function(w,A){var M=a.exports.lines(w,A);return M.map(function(S){return w.substring(S.start,S.end)}).join(`
`)},a.exports.lines=function(A,M){if(M=M||{},M.width===0&&M.mode!=="nowrap")return[];A=A||"";var S=typeof M.width=="number"?M.width:Number.MAX_VALUE,E=Math.max(0,M.start||0),T=typeof M.end=="number"?M.end:A.length,C=M.mode,L=M.measure||b;return C==="pre"?g(L,A,E,T,S):y(L,A,E,T,S,C)};function v(w,A,M,S){var E=w.indexOf(A,M);return E===-1||E>S?S:E}function m(w){return f.test(w)}function g(w,A,M,S,E){for(var T=[],C=M,L=M;L<S&&L<A.length;L++){var P=A.charAt(L),N=o.test(P);if(N||L===S-1){var F=N?L:L+1,X=w(A,C,F,E);T.push(X),C=L+1}}return T}function y(w,A,M,S,E,T){var C=[],L=E;for(T==="nowrap"&&(L=Number.MAX_VALUE);M<S&&M<A.length;){for(var P=v(A,u,M,S);M<P&&m(A.charAt(M));)M++;var N=w(A,M,P,L),F=M+(N.end-N.start),X=F+u.length;if(F<P){for(;F>M&&!m(A.charAt(F));)F--;if(F===M)X>M+u.length&&X--,F=X;else for(X=F;F>M&&m(A.charAt(F-u.length));)F--}if(F>=M){var Y=w(A,M,F,L);C.push(Y)}M=X}return C}function b(w,A,M,S){var E=Math.min(S,M-A);return{start:A,end:A+E}}},{}],70:[function(r,a,s){var o=r("global/window"),u=r("is-function"),f=r("parse-headers"),v=r("xtend");a.exports=b,a.exports.default=b,b.XMLHttpRequest=o.XMLHttpRequest||M,b.XDomainRequest="withCredentials"in new b.XMLHttpRequest?b.XMLHttpRequest:o.XDomainRequest,m(["get","put","post","patch","head","delete"],function(S){b[S==="delete"?"del":S]=function(E,T,C){return T=y(E,T,C),T.method=S.toUpperCase(),w(T)}});function m(S,E){for(var T=0;T<S.length;T++)E(S[T])}function g(S){for(var E in S)if(S.hasOwnProperty(E))return!1;return!0}function y(S,E,T){var C=S;return u(E)?(T=E,typeof S=="string"&&(C={uri:S})):C=v(E,{uri:S}),C.callback=T,C}function b(S,E,T){return E=y(S,E,T),w(E)}function w(S){if(typeof S.callback=="undefined")throw new Error("callback argument missing");var E=!1,T=function(oe,ge,_e){E||(E=!0,S.callback(oe,ge,_e))};function C(){F.readyState===4&&setTimeout(N,0)}function L(){var ce=void 0;if(F.response?ce=F.response:ce=F.responseText||A(F),k)try{ce=JSON.parse(ce)}catch{}return ce}function P(ce){return clearTimeout(U),ce instanceof Error||(ce=new Error(""+(ce||"Unknown XMLHttpRequest Error"))),ce.statusCode=0,T(ce,W)}function N(){if(!Y){var ce;clearTimeout(U),S.useXDR&&F.status===void 0?ce=200:ce=F.status===1223?204:F.status;var oe=W,ge=null;return ce!==0?(oe={body:L(),statusCode:ce,method:$,headers:{},url:ae,rawRequest:F},F.getAllResponseHeaders&&(oe.headers=f(F.getAllResponseHeaders()))):ge=new Error("Internal XMLHttpRequest Error"),T(ge,oe,oe.body)}}var F=S.xhr||null;F||(S.cors||S.useXDR?F=new b.XDomainRequest:F=new b.XMLHttpRequest);var X,Y,ae=F.url=S.uri||S.url,$=F.method=S.method||"GET",de=S.body||S.data,D=F.headers=S.headers||{},I=!!S.sync,k=!1,U,W={body:void 0,headers:{},statusCode:0,method:$,url:ae,rawRequest:F};if("json"in S&&S.json!==!1&&(k=!0,D.accept||D.Accept||(D.Accept="application/json"),$!=="GET"&&$!=="HEAD"&&(D["content-type"]||D["Content-Type"]||(D["Content-Type"]="application/json"),de=JSON.stringify(S.json===!0?de:S.json))),F.onreadystatechange=C,F.onload=N,F.onerror=P,F.onprogress=function(){},F.onabort=function(){Y=!0},F.ontimeout=P,F.open($,ae,!I,S.username,S.password),I||(F.withCredentials=!!S.withCredentials),!I&&S.timeout>0&&(U=setTimeout(function(){if(!Y){Y=!0,F.abort("timeout");var ce=new Error("XMLHttpRequest timeout");ce.code="ETIMEDOUT",P(ce)}},S.timeout)),F.setRequestHeader)for(X in D)D.hasOwnProperty(X)&&F.setRequestHeader(X,D[X]);else if(S.headers&&!g(S.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in S&&(F.responseType=S.responseType),"beforeSend"in S&&typeof S.beforeSend=="function"&&S.beforeSend(F),F.send(de||null),F}function A(S){try{if(S.responseType==="document")return S.responseXML;var E=S.responseXML&&S.responseXML.documentElement.nodeName==="parsererror";if(S.responseType===""&&!E)return S.responseXML}catch{}return null}function M(){}},{"global/window":27,"is-function":33,"parse-headers":47,xtend:72}],71:[function(r,a,s){a.exports=function(){return typeof self.DOMParser!="undefined"?function(u){var f=new self.DOMParser;return f.parseFromString(u,"application/xml")}:typeof self.ActiveXObject!="undefined"&&new self.ActiveXObject("Microsoft.XMLDOM")?function(u){var f=new self.ActiveXObject("Microsoft.XMLDOM");return f.async="false",f.loadXML(u),f}:function(u){var f=document.createElement("div");return f.innerHTML=u,f}}()},{}],72:[function(r,a,s){a.exports=u;var o=Object.prototype.hasOwnProperty;function u(){for(var f={},v=0;v<arguments.length;v++){var m=arguments[v];for(var g in m)o.call(m,g)&&(f[g]=m[g])}return f}},{}],73:[function(r,a,s){a.exports={name:"aframe",version:"1.2.0",description:"A web framework for building virtual reality experiences.",homepage:"https://aframe.io/",main:"dist/aframe-master.js",scripts:{browserify:"browserify src/index.js -s 'AFRAME' -p browserify-derequire",build:"shx mkdir -p build/ && npm run browserify -- --debug -t [ envify --INSPECTOR_VERSION dev ] -o build/aframe.js",codecov:"codecov",dev:"npm run build && cross-env INSPECTOR_VERSION=dev node ./scripts/budo -t envify",dist:"node scripts/updateVersionLog.js && npm run dist:min && npm run dist:max","dist:max":"npm run browserify -s -- --debug | exorcist dist/aframe-master.js.map > dist/aframe-master.js","dist:min":"npm run browserify -s -- --debug -p [ minifyify --map aframe-master.min.js.map --output dist/aframe-master.min.js.map ] -o dist/aframe-master.min.js",docs:"markserv --dir docs --port 9001",preghpages:"node ./scripts/preghpages.js",ghpages:"ghpages -p gh-pages/",lint:"semistandard -v | snazzy","lint:fix":"semistandard --fix",precommit:"npm run lint",prepush:"node scripts/testOnlyCheck.js",prerelease:"node scripts/release.js 1.0.4 1.1.0",start:"npm run dev","start:https":"cross-env SSL=true npm run dev",test:"karma start ./tests/karma.conf.js","test:docs":"node scripts/docsLint.js","test:firefox":"npm test -- --browsers Firefox","test:chrome":"npm test -- --browsers Chrome","test:nobrowser":"NO_BROWSER=true npm test","test:node":"mocha --ui tdd tests/node"},repository:"aframevr/aframe",license:"MIT",files:["dist/*","docs/**/*","src/**/*","vendor/**/*"],dependencies:{"custom-event-polyfill":"^1.0.6",debug:"ngokevin/debug#noTimestamp","deep-assign":"^2.0.0","document-register-element":"dmarcos/document-register-element#8ccc532b7f3744be954574caf3072a5fd260ca90","load-bmfont":"^1.2.3","object-assign":"^4.0.1",present:"0.0.6","promise-polyfill":"^3.1.0","super-animejs":"^3.1.0","super-three":"^0.125.1","three-bmfont-text":"dmarcos/three-bmfont-text#1babdf8507c731a18f8af3b807292e2b9740955e","webvr-polyfill":"^0.10.12"},devDependencies:{browserify:"^13.1.0","browserify-css":"^0.8.4","browserify-derequire":"^0.9.4","browserify-istanbul":"^2.0.0",budo:"^9.2.0",chai:"^3.5.0","chai-shallow-deep-equal":"^1.4.0",chalk:"^1.1.3",codecov:"^1.0.1","cross-env":"^5.0.1",envify:"^3.4.1",exorcist:"^0.4.0",ghpages:"0.0.8","git-rev":"^0.2.1",glob:"^7.1.1",husky:"^0.11.7",istanbul:"^0.4.5",jsdom:"^9.11.0",karma:"1.4.1","karma-browserify":"^5.1.0","karma-chai-shallow-deep-equal":"0.0.4","karma-chrome-launcher":"^2.0.0","karma-coverage":"^1.1.1","karma-env-preprocessor":"^0.1.1","karma-firefox-launcher":"^1.2.0","karma-mocha":"^1.1.1","karma-mocha-reporter":"^2.1.0","karma-sinon-chai":"1.2.4",lolex:"^1.5.1",markserv:"github:sukima/markserv#feature/fix-broken-websoketio-link",minifyify:"^7.3.3",mocha:"^3.0.2","mozilla-download":"^1.1.1","replace-in-file":"^2.5.3",semistandard:"^9.0.0",shelljs:"^0.7.7",shx:"^0.2.2",sinon:"^1.17.5","sinon-chai":"2.8.0",snazzy:"^5.0.0","too-wordy":"ngokevin/too-wordy",uglifyjs:"^2.4.10","write-good":"^0.9.1"},link:!0,browserify:{transform:["browserify-css","envify"]},semistandard:{ignore:["build/**","dist/**","examples/**/shaders/*.js","**/vendor/**"]},keywords:["3d","aframe","cardboard","components","oculus","three","three.js","rift","vive","vr","web-components","webvr"],"browserify-css":{minify:!0},engines:{node:">= 4.6.0",npm:"^2.15.9"}}},{}],74:[function(r,a,s){var o=r("super-animejs"),u=r("../core/component").components,f=r("../core/component").registerComponent,v=r("../lib/three"),m=r("../utils"),g=new v.Color,y=new v.Color,b=m.entity.getComponentProperty,w=m.entity.setComponentProperty,A={},M="color",S="position",E="rotation",T="scale",C="components",L="object3D";a.exports.Component=f("animation",{schema:{autoplay:{default:!0},delay:{default:0},dir:{default:""},dur:{default:1e3},easing:{default:"easeInQuad"},elasticity:{default:400},enabled:{default:!0},from:{default:""},loop:{default:0,parse:function(D){return D===!0||D==="true"?!0:D===!1||D==="false"?!1:parseInt(D,10)}},property:{default:""},startEvents:{type:"array"},pauseEvents:{type:"array"},resumeEvents:{type:"array"},round:{default:!1},to:{default:""},type:{default:""},isRawProperty:{default:!1}},multiple:!0,init:function(){var D=this;this.eventDetail={name:this.attrName},this.time=0,this.animation=null,this.animationIsPlaying=!1,this.onStartEvent=this.onStartEvent.bind(this),this.beginAnimation=this.beginAnimation.bind(this),this.pauseAnimation=this.pauseAnimation.bind(this),this.resumeAnimation=this.resumeAnimation.bind(this),this.fromColor={},this.toColor={},this.targets={},this.targetsArray=[],this.updateConfigForDefault=this.updateConfigForDefault.bind(this),this.updateConfigForRawColor=this.updateConfigForRawColor.bind(this),this.config={complete:function(){D.animationIsPlaying=!1,D.el.emit("animationcomplete",D.eventDetail,!1),D.id&&D.el.emit("animationcomplete__"+D.id,D.eventDetail,!1)}}},update:function(D){var I=this.config,k=this.data;this.animationIsPlaying=!1,!!this.data.enabled&&(!k.property||(I.autoplay=!1,I.direction=k.dir,I.duration=k.dur,I.easing=k.easing,I.elasticity=k.elasticity,I.loop=k.loop,I.round=k.round,this.createAndStartAnimation()))},tick:function(D,I){!this.animationIsPlaying||(this.time+=I,this.animation.tick(this.time))},remove:function(){this.pauseAnimation(),this.removeEventListeners()},pause:function(){this.paused=!0,this.pausedWasPlaying=this.animationIsPlaying,this.pauseAnimation(),this.removeEventListeners()},play:function(){!this.paused||(this.paused=!1,this.addEventListeners(),this.pausedWasPlaying&&(this.resumeAnimation(),this.pausedWasPlaying=!1))},createAndStartAnimation:function(){var D=this.data;if(this.updateConfig(),this.animationIsPlaying=!1,this.animation=o(this.config),this.animation.began=!0,this.removeEventListeners(),this.addEventListeners(),!(!D.autoplay||D.startEvents&&D.startEvents.length)){if(D.delay){setTimeout(this.beginAnimation,D.delay);return}this.beginAnimation()}},beginAnimation:function(){this.updateConfig(),this.animation.began=!0,this.time=0,this.animationIsPlaying=!0,this.stopRelatedAnimations(),this.el.emit("animationbegin",this.eventDetail,!1)},pauseAnimation:function(){this.animationIsPlaying=!1},resumeAnimation:function(){this.animationIsPlaying=!0},onStartEvent:function(){if(!!this.data.enabled){if(this.updateConfig(),this.animation&&this.animation.pause(),this.animation=o(this.config),this.data.delay){setTimeout(this.beginAnimation,this.data.delay);return}this.beginAnimation()}},updateConfigForRawColor:function(){var D=this.config,I=this.data,k=this.el,U,W,ce;if(!this.waitComponentInitRawProperty(this.updateConfigForRawColor)){U=I.from===""?Y(k,I.property):I.from,ce=I.to,this.setColorConfig(U,ce),U=this.fromColor,ce=this.toColor,this.targetsArray.length=0,this.targetsArray.push(U),D.targets=this.targetsArray;for(W in ce)D[W]=ce[W];D.update=function(){var oe={};return function(ge){var _e;_e=ge.animatables[0].target,!(_e.r===oe.r&&_e.g===oe.g&&_e.b===oe.b)&&ae(k,I.property,_e,I.type)}}()}},updateConfigForDefault:function(){var D=this.config,I=this.data,k=this.el,U,W,ce,oe;this.waitComponentInitRawProperty(this.updateConfigForDefault)||(I.from===""?U=de(I)?Y(k,I.property):b(k,I.property):U=I.from,oe=I.to,ce=!isNaN(U||oe),ce?(U=parseFloat(U),oe=parseFloat(oe)):(U=U&&U.toString(),oe=oe&&oe.toString()),W=I.to==="true"||I.to==="false"||I.to===!0||I.to===!1,W&&(U=I.from==="true"||I.from===!0?1:0,oe=I.to==="true"||I.to===!0?1:0),this.targets.aframeProperty=U,D.targets=this.targets,D.aframeProperty=oe,D.update=function(){var ge;return function(_e){var Ne;Ne=_e.animatables[0].target.aframeProperty,Ne!==ge&&(ge=Ne,W&&(Ne=Ne>=1),de(I)?ae(k,I.property,Ne,I.type):w(k,I.property,Ne))}}())},updateConfigForVector:function(){var D=this.config,I=this.data,k=this.el,U,W,ce;W=I.from!==""?m.coordinates.parse(I.from):b(k,I.property),ce=m.coordinates.parse(I.to),I.property===E&&(N(W),N(ce)),this.targetsArray.length=0,this.targetsArray.push(W),D.targets=this.targetsArray;for(U in ce)D[U]=ce[U];if(I.property===S||I.property===E||I.property===T){D.update=function(){var oe={};return function(ge){var _e=ge.animatables[0].target;I.property===T&&(_e.x=Math.max(1e-4,_e.x),_e.y=Math.max(1e-4,_e.y),_e.z=Math.max(1e-4,_e.z)),!(_e.x===oe.x&&_e.y===oe.y&&_e.z===oe.z)&&(oe.x=_e.x,oe.y=_e.y,oe.z=_e.z,k.object3D[I.property].set(_e.x,_e.y,_e.z))}}();return}D.update=function(){var oe={};return function(ge){var _e=ge.animatables[0].target;_e.x===oe.x&&_e.y===oe.y&&_e.z===oe.z||(oe.x=_e.x,oe.y=_e.y,oe.z=_e.z,w(k,I.property,_e))}}()},updateConfig:function(){var D;D=P(this.el,this.data.property),de(this.data)&&this.data.type===M?this.updateConfigForRawColor():D==="vec2"||D==="vec3"||D==="vec4"?this.updateConfigForVector():this.updateConfigForDefault()},waitComponentInitRawProperty:function(D){var I,k=this.data,U=this.el,W=this;return k.from!==""||!k.property.startsWith(C)||(I=$(k.property)[1],U.components[I])?!1:(U.addEventListener("componentinitialized",function ce(oe){oe.detail.name===I&&(D(),W.animation=o(W.config),U.removeEventListener("componentinitialized",ce))}),!0)},stopRelatedAnimations:function(){var D,I;for(I in this.el.components)D=this.el.components[I],I!==this.attrName&&D.name==="animation"&&(!D.animationIsPlaying||D.data.property===this.data.property&&(D.animationIsPlaying=!1))},addEventListeners:function(){var D=this.data,I=this.el;F(I,D.startEvents,this.onStartEvent),F(I,D.pauseEvents,this.pauseAnimation),F(I,D.resumeEvents,this.resumeAnimation)},removeEventListeners:function(){var D=this.data,I=this.el;X(I,D.startEvents,this.onStartEvent),X(I,D.pauseEvents,this.pauseAnimation),X(I,D.resumeEvents,this.resumeAnimation)},setColorConfig:function(D,I){g.set(D),y.set(I),D=this.fromColor,I=this.toColor,D.r=g.r,D.g=g.g,D.b=g.b,I.r=y.r,I.g=y.g,I.b=y.b}});function P(D,I){var k,U,W,ce;return W=I.split("."),U=W[0],ce=W[1],k=D.components[U]||u[U],!k||ce&&!k.schema[ce]?null:ce?k.schema[ce].type:k.schema.type}function N(D){D.x=v.Math.degToRad(D.x),D.y=v.Math.degToRad(D.y),D.z=v.Math.degToRad(D.z)}function F(D,I,k){var U;for(U=0;U<I.length;U++)D.addEventListener(I[U],k)}function X(D,I,k){var U;for(U=0;U<I.length;U++)D.removeEventListener(I[U],k)}function Y(D,I){var k,U,W;for(U=$(I),W=D,k=0;k<U.length;k++)W=W[U[k]];if(W===void 0)throw console.log(D),new Error("[animation] property ("+I+") could not be found");return W}function ae(D,I,k,U){var W,ce,oe,ge;for(I.startsWith("object3D.rotation")&&(k=v.Math.degToRad(k)),ce=$(I),ge=D,W=0;W<ce.length-1;W++)ge=ge[ce[W]];if(oe=ce[ce.length-1],U===M){"r"in ge[oe]?(ge[oe].r=k.r,ge[oe].g=k.g,ge[oe].b=k.b):(ge[oe].x=k.r,ge[oe].y=k.g,ge[oe].z=k.b);return}ge[oe]=k}function $(D){return D in A||(A[D]=D.split(".")),A[D]}function de(D){return D.isRawProperty||D.property.startsWith(C)||D.property.startsWith(L)}},{"../core/component":131,"../lib/three":179,"../utils":205,"super-animejs":56}],75:[function(r,a,s){var o=r("../core/component").registerComponent,u=r("../lib/three");a.exports.Component=o("camera",{schema:{active:{default:!0},far:{default:1e4},fov:{default:80,min:0},near:{default:.005,min:0},spectator:{default:!1},zoom:{default:1,min:0}},init:function(){var f,v=this.el;f=this.camera=new u.PerspectiveCamera,v.setObject3D("camera",f)},update:function(f){var v=this.data,m=this.camera;m.aspect=v.aspect||window.innerWidth/window.innerHeight,m.far=v.far,m.fov=v.fov,m.near=v.near,m.zoom=v.zoom,m.updateProjectionMatrix(),this.updateActiveCamera(f),this.updateSpectatorCamera(f)},updateActiveCamera:function(f){var v=this.data,m=this.el,g=this.system;f&&f.active===v.active||v.spectator||(v.active&&g.activeCameraEl!==m?g.setActiveCamera(m):!v.active&&g.activeCameraEl===m&&g.disableActiveCamera())},updateSpectatorCamera:function(f){var v=this.data,m=this.el,g=this.system;f&&f.spectator===v.spectator||(v.spectator&&g.spectatorCameraEl!==m?g.setSpectatorCamera(m):!v.spectator&&g.spectatorCameraEl===m&&g.disableSpectatorCamera())},remove:function(){this.el.removeObject3D("camera")}})},{"../core/component":131,"../lib/three":179}],76:[function(r,a,s){var o=r("../core/component").registerComponent,u=r("../utils/"),f=u.bind,v={CLICK:"click",FUSING:"fusing",MOUSEENTER:"mouseenter",MOUSEDOWN:"mousedown",MOUSELEAVE:"mouseleave",MOUSEUP:"mouseup"},m={FUSING:"cursor-fusing",HOVERING:"cursor-hovering",HOVERED:"cursor-hovered"},g={DOWN:["mousedown","touchstart"],UP:["mouseup","touchend"]},y={DOWN:["selectstart"],UP:["selectend"]},b="a-mouse-cursor-hover";a.exports.Component=o("cursor",{dependencies:["raycaster"],schema:{downEvents:{default:[]},fuse:{default:u.device.isMobile()},fuseTimeout:{default:1500,min:0},mouseCursorStylesEnabled:{default:!0},upEvents:{default:[]},rayOrigin:{default:"entity",oneOf:["mouse","entity"]}},init:function(){var w=this;this.fuseTimeout=void 0,this.cursorDownEl=null,this.intersectedEl=null,this.canvasBounds=document.body.getBoundingClientRect(),this.isCursorDown=!1,this.updateCanvasBounds=u.debounce(function(){w.canvasBounds=w.el.sceneEl.canvas.getBoundingClientRect()},500),this.eventDetail={},this.intersectedEventDetail={cursorEl:this.el},this.onCursorDown=f(this.onCursorDown,this),this.onCursorUp=f(this.onCursorUp,this),this.onIntersection=f(this.onIntersection,this),this.onIntersectionCleared=f(this.onIntersectionCleared,this),this.onMouseMove=f(this.onMouseMove,this),this.onEnterVR=f(this.onEnterVR,this)},update:function(w){this.data.rayOrigin!==w.rayOrigin&&this.updateMouseEventListeners()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){var w=this.el;w.removeState(m.HOVERING),w.removeState(m.FUSING),clearTimeout(this.fuseTimeout),this.intersectedEl&&this.intersectedEl.removeState(m.HOVERED),this.removeEventListeners()},addEventListeners:function(){var w,A=this.data,M=this.el,S=this;function E(){w=M.sceneEl.canvas,!(A.downEvents.length||A.upEvents.length)&&(g.DOWN.forEach(function(T){w.addEventListener(T,S.onCursorDown)}),g.UP.forEach(function(T){w.addEventListener(T,S.onCursorUp)}))}w=M.sceneEl.canvas,w?E():M.sceneEl.addEventListener("render-target-loaded",E),A.downEvents.forEach(function(T){M.addEventListener(T,S.onCursorDown)}),A.upEvents.forEach(function(T){M.addEventListener(T,S.onCursorUp)}),M.addEventListener("raycaster-intersection",this.onIntersection),M.addEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),M.sceneEl.addEventListener("rendererresize",this.updateCanvasBounds),M.sceneEl.addEventListener("enter-vr",this.onEnterVR),window.addEventListener("resize",this.updateCanvasBounds),window.addEventListener("scroll",this.updateCanvasBounds),this.updateMouseEventListeners()},removeEventListeners:function(){var w,A=this.data,M=this.el,S=this;w=M.sceneEl.canvas,w&&!A.downEvents.length&&!A.upEvents.length&&(g.DOWN.forEach(function(E){w.removeEventListener(E,S.onCursorDown)}),g.UP.forEach(function(E){w.removeEventListener(E,S.onCursorUp)})),A.downEvents.forEach(function(E){M.removeEventListener(E,S.onCursorDown)}),A.upEvents.forEach(function(E){M.removeEventListener(E,S.onCursorUp)}),M.removeEventListener("raycaster-intersection",this.onIntersection),M.removeEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),w.removeEventListener("mousemove",this.onMouseMove),w.removeEventListener("touchstart",this.onMouseMove),w.removeEventListener("touchmove",this.onMouseMove),M.sceneEl.removeEventListener("rendererresize",this.updateCanvasBounds),M.sceneEl.removeEventListener("enter-vr",this.onEnterVR),window.removeEventListener("resize",this.updateCanvasBounds),window.removeEventListener("scroll",this.updateCanvasBounds)},updateMouseEventListeners:function(){var w,A=this.el;w=A.sceneEl.canvas,w.removeEventListener("mousemove",this.onMouseMove),w.removeEventListener("touchmove",this.onMouseMove),A.setAttribute("raycaster","useWorldCoordinates",!1),this.data.rayOrigin==="mouse"&&(w.addEventListener("mousemove",this.onMouseMove,!1),w.addEventListener("touchmove",this.onMouseMove,!1),A.setAttribute("raycaster","useWorldCoordinates",!0),this.updateCanvasBounds())},onMouseMove:function(){var w=new THREE.Vector3,A=new THREE.Vector2,M=new THREE.Vector3,S={origin:M,direction:w};return function(E){var T=this.canvasBounds,C=this.el.sceneEl.camera,L,P,N;C.parent.updateMatrixWorld(),E.type==="touchmove"||E.type==="touchstart"?P=E.touches.item(0):P=E,L=P.clientX-T.left,N=P.clientY-T.top,A.x=L/T.width*2-1,A.y=-(N/T.height)*2+1,M.setFromMatrixPosition(C.matrixWorld),w.set(A.x,A.y,.5).unproject(C).sub(M).normalize(),this.el.setAttribute("raycaster",S),E.type==="touchmove"&&E.preventDefault()}}(),onCursorDown:function(w){this.isCursorDown=!0,this.data.rayOrigin==="mouse"&&w.type==="touchstart"&&(this.onMouseMove(w),this.el.components.raycaster.checkIntersections(),w.preventDefault()),this.twoWayEmit(v.MOUSEDOWN),this.cursorDownEl=this.intersectedEl},onCursorUp:function(w){if(!!this.isCursorDown){this.isCursorDown=!1;var A=this.data;this.twoWayEmit(v.MOUSEUP),this.cursorDownEl&&this.cursorDownEl!==this.intersectedEl&&(this.intersectedEventDetail.intersection=null,this.cursorDownEl.emit(v.MOUSEUP,this.intersectedEventDetail)),(!A.fuse||A.rayOrigin==="mouse")&&this.intersectedEl&&this.cursorDownEl===this.intersectedEl&&this.twoWayEmit(v.CLICK),this.cursorDownEl=null,w.type==="touchend"&&w.preventDefault()}},onIntersection:function(w){var A,M=this.el,S,E,T;S=w.detail.els[0]===M?1:0,T=w.detail.intersections[S],E=w.detail.els[S],!!E&&this.intersectedEl!==E&&(this.intersectedEl&&(A=this.el.components.raycaster.getIntersection(this.intersectedEl),A&&A.distance<=T.distance)||(this.clearCurrentIntersection(!0),this.setIntersection(E,T)))},onIntersectionCleared:function(w){var A=w.detail.clearedEls;A.indexOf(this.intersectedEl)!==-1&&this.clearCurrentIntersection()},onEnterVR:function(){this.clearCurrentIntersection(!0);var w=this.el.sceneEl.xrSession,A=this;!w||this.data.rayOrigin!=="mouse"&&(y.DOWN.forEach(function(M){w.addEventListener(M,A.onCursorDown)}),y.UP.forEach(function(M){w.addEventListener(M,A.onCursorUp)}))},setIntersection:function(w,A){var M=this.el,S=this.data,E=this;this.intersectedEl!==w&&(this.intersectedEl=w,M.addState(m.HOVERING),w.addState(m.HOVERED),this.twoWayEmit(v.MOUSEENTER),this.data.mouseCursorStylesEnabled&&this.data.rayOrigin==="mouse"&&this.el.sceneEl.canvas.classList.add(b),!(S.fuseTimeout===0||!S.fuse)&&(M.addState(m.FUSING),this.twoWayEmit(v.FUSING),this.fuseTimeout=setTimeout(function(){M.removeState(m.FUSING),E.twoWayEmit(v.CLICK)},S.fuseTimeout)))},clearCurrentIntersection:function(w){var A,M,S,E=this.el;!this.intersectedEl||(this.intersectedEl.removeState(m.HOVERED),E.removeState(m.HOVERING),E.removeState(m.FUSING),this.twoWayEmit(v.MOUSELEAVE),this.data.mouseCursorStylesEnabled&&this.data.rayOrigin==="mouse"&&this.el.sceneEl.canvas.classList.remove(b),this.intersectedEl=null,clearTimeout(this.fuseTimeout),w!==!0&&(S=this.el.components.raycaster.intersections,S.length!==0&&(A=S[0].object.el===E?1:0,M=S[A],!!M&&this.setIntersection(M.object.el,M))))},twoWayEmit:function(w){var A=this.el,M=this.intersectedEl,S;S=this.el.components.raycaster.getIntersection(M),this.eventDetail.intersectedEl=M,this.eventDetail.intersection=S,A.emit(w,this.eventDetail),!!M&&(this.intersectedEventDetail.intersection=S,M.emit(w,this.intersectedEventDetail))}})},{"../core/component":131,"../utils/":205}],77:[function(r,a,s){var o=r("../core/component").registerComponent,u=r("../utils/bind"),f=r("../utils/tracked-controls"),v=f.checkControllerPresentAndSetup,m=f.emitIfAxesChanged,g=f.onButtonEvent,y="https://cdn.aframe.io/controllers/google/",b=y+"vr_controller_daydream.obj",w=y+"vr_controller_daydream.mtl",A=r("../utils/").device.isWebXRAvailable,M="google-daydream",S="Daydream Controller",E=A?M:S,T={axes:{trackpad:[0,1]},buttons:["trackpad","menu","system"]},C={axes:{touchpad:[0,1]},buttons:["none","none","touchpad","menu","system"]},L=A?C:T;a.exports.Component=o("daydream-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#000000"},buttonTouchedColor:{type:"color",default:"#777777"},buttonHighlightColor:{type:"color",default:"#FFFFFF"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:L,bindMethods:function(){this.onModelLoaded=u(this.onModelLoaded,this),this.onControllersUpdate=u(this.onControllersUpdate,this),this.checkIfControllerPresent=u(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=u(this.removeControllersUpdateListener,this),this.onAxisMoved=u(this.onAxisMoved,this)},init:function(){var P=this;this.onButtonChanged=u(this.onButtonChanged,this),this.onButtonDown=function(N){g(N.detail.id,"down",P)},this.onButtonUp=function(N){g(N.detail.id,"up",P)},this.onButtonTouchStart=function(N){g(N.detail.id,"touchstart",P)},this.onButtonTouchEnd=function(N){g(N.detail.id,"touchend",P)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var P=this.el;P.addEventListener("buttonchanged",this.onButtonChanged),P.addEventListener("buttondown",this.onButtonDown),P.addEventListener("buttonup",this.onButtonUp),P.addEventListener("touchstart",this.onButtonTouchStart),P.addEventListener("touchend",this.onButtonTouchEnd),P.addEventListener("model-loaded",this.onModelLoaded),P.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var P=this.el;P.removeEventListener("buttonchanged",this.onButtonChanged),P.removeEventListener("buttondown",this.onButtonDown),P.removeEventListener("buttonup",this.onButtonUp),P.removeEventListener("touchstart",this.onButtonTouchStart),P.removeEventListener("touchend",this.onButtonTouchEnd),P.removeEventListener("model-loaded",this.onModelLoaded),P.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){v(this,E,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var P=this.el,N=this.data;P.setAttribute("tracked-controls",{armModel:N.armModel,hand:N.hand,idPrefix:E,id:E,orientationOffset:N.orientationOffset}),!!this.data.model&&this.el.setAttribute("obj-model",{obj:b,mtl:w})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(P){var N=P.detail.model,F;!this.data.model||(F=this.buttonMeshes={},F.menu=N.getObjectByName("AppButton_AppButton_Cylinder.004"),F.system=N.getObjectByName("HomeButton_HomeButton_Cylinder.005"),F.trackpad=N.getObjectByName("TouchPad_TouchPad_Cylinder.003"),F.touchpad=N.getObjectByName("TouchPad_TouchPad_Cylinder.003"),N.position.set(0,0,-.04))},onAxisMoved:function(P){m(this,this.mapping.axes,P)},onButtonChanged:function(P){var N=this.mapping.buttons[P.detail.id];!N||this.el.emit(N+"changed",P.detail.state)},updateModel:function(P,N){!this.data.model||this.updateButtonModel(P,N)},updateButtonModel:function(P,N){var F=this.buttonMeshes;if(!(!F||!F[P])){var X;switch(N){case"down":X=this.data.buttonHighlightColor;break;case"touchstart":X=this.data.buttonTouchedColor;break;default:X=this.data.buttonColor}F[P].material.color.set(X)}}})},{"../core/component":131,"../utils/":205,"../utils/bind":199,"../utils/tracked-controls":214}],78:[function(r,a,s){var o=r("../core/component").registerComponent,u=r("../utils/bind"),f=r("../utils/tracked-controls"),v=f.checkControllerPresentAndSetup,m=f.emitIfAxesChanged,g=f.onButtonEvent,y=r("../utils/").device.isWebXRAvailable,b="https://cdn.aframe.io/controllers/samsung/",w=b+"gear_vr_controller.obj",A=b+"gear_vr_controller.mtl",M="samsung-gearvr",S="Gear VR",E=y?M:S,T={axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},C={axes:{touchpad:[0,1]},buttons:["trigger","none","touchpad","none","menu"]},L=y?C:T;a.exports.Component=o("gearvr-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#000000"},buttonTouchedColor:{type:"color",default:"#777777"},buttonHighlightColor:{type:"color",default:"#FFFFFF"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:L,bindMethods:function(){this.onModelLoaded=u(this.onModelLoaded,this),this.onControllersUpdate=u(this.onControllersUpdate,this),this.checkIfControllerPresent=u(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=u(this.removeControllersUpdateListener,this),this.onAxisMoved=u(this.onAxisMoved,this)},init:function(){var P=this;this.onButtonChanged=u(this.onButtonChanged,this),this.onButtonDown=function(N){g(N.detail.id,"down",P)},this.onButtonUp=function(N){g(N.detail.id,"up",P)},this.onButtonTouchStart=function(N){g(N.detail.id,"touchstart",P)},this.onButtonTouchEnd=function(N){g(N.detail.id,"touchend",P)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var P=this.el;P.addEventListener("buttonchanged",this.onButtonChanged),P.addEventListener("buttondown",this.onButtonDown),P.addEventListener("buttonup",this.onButtonUp),P.addEventListener("touchstart",this.onButtonTouchStart),P.addEventListener("touchend",this.onButtonTouchEnd),P.addEventListener("model-loaded",this.onModelLoaded),P.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var P=this.el;P.removeEventListener("buttonchanged",this.onButtonChanged),P.removeEventListener("buttondown",this.onButtonDown),P.removeEventListener("buttonup",this.onButtonUp),P.removeEventListener("touchstart",this.onButtonTouchStart),P.removeEventListener("touchend",this.onButtonTouchEnd),P.removeEventListener("model-loaded",this.onModelLoaded),P.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){v(this,E,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var P=this.el,N=this.data;P.setAttribute("tracked-controls",{armModel:N.armModel,hand:N.hand,idPrefix:E,id:E,orientationOffset:N.orientationOffset}),!!this.data.model&&this.el.setAttribute("obj-model",{obj:w,mtl:A})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(P){var N=P.detail.model,F;!this.data.model||(F=this.buttonMeshes={},F.trigger=N.children[2],F.trackpad=N.children[1],F.touchpad=N.children[1])},onButtonChanged:function(P){var N=this.mapping.buttons[P.detail.id];!N||this.el.emit(N+"changed",P.detail.state)},onAxisMoved:function(P){m(this,this.mapping.axes,P)},updateModel:function(P,N){!this.data.model||this.updateButtonModel(P,N)},updateButtonModel:function(P,N){var F=this.buttonMeshes;if(!(!F||!F[P])){var X;switch(N){case"down":X=this.data.buttonHighlightColor;break;case"touchstart":X=this.data.buttonTouchedColor;break;default:X=this.data.buttonColor}F[P].material.color.set(X)}}})},{"../core/component":131,"../utils/":205,"../utils/bind":199,"../utils/tracked-controls":214}],79:[function(r,a,s){var o=r("../core/component").registerComponent,u=r("../utils/bind"),f=r("../utils/tracked-controls"),v=f.checkControllerPresentAndSetup,m=f.emitIfAxesChanged,g=f.onButtonEvent,y="generic",b={axes:{touchpad:[0,1],thumbstick:[2,3]},buttons:["trigger","squeeze","touchpad","thumbstick"]};a.exports.Component=o("generic-tracked-controller-controls",{schema:{hand:{default:""},defaultModel:{default:!0},defaultModelColor:{default:"gray"},orientationOffset:{type:"vec3"},disabled:{default:!1}},mapping:b,bindMethods:function(){this.onControllersUpdate=u(this.onControllersUpdate,this),this.checkIfControllerPresent=u(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=u(this.removeControllersUpdateListener,this),this.onAxisMoved=u(this.onAxisMoved,this)},init:function(){var w=this;this.onButtonChanged=u(this.onButtonChanged,this),this.onButtonDown=function(A){g(A.detail.id,"down",w)},this.onButtonUp=function(A){g(A.detail.id,"up",w)},this.onButtonTouchStart=function(A){g(A.detail.id,"touchstart",w)},this.onButtonTouchEnd=function(A){g(A.detail.id,"touchend",w)},this.controllerPresent=!1,this.wasControllerConnected=!1,this.lastControllerCheck=0,this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods(),this.el.addEventListener("controllerconnected",function(A){A.detail.name!==w.name&&(w.wasControllerConnected=!0,w.removeEventListeners(),w.removeControllersUpdateListener())})},addEventListeners:function(){var w=this.el;w.addEventListener("buttonchanged",this.onButtonChanged),w.addEventListener("buttondown",this.onButtonDown),w.addEventListener("buttonup",this.onButtonUp),w.addEventListener("touchstart",this.onButtonTouchStart),w.addEventListener("touchend",this.onButtonTouchEnd),w.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var w=this.el;w.removeEventListener("buttonchanged",this.onButtonChanged),w.removeEventListener("buttondown",this.onButtonDown),w.removeEventListener("buttonup",this.onButtonUp),w.removeEventListener("touchstart",this.onButtonTouchStart),w.removeEventListener("touchend",this.onButtonTouchEnd),w.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var w=this.data,A=w.hand?w.hand:void 0;v(this,y,{hand:A,iterateControllerProfiles:!0})},play:function(){this.wasControllerConnected||(this.checkIfControllerPresent(),this.addControllersUpdateListener())},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var w=this.el,A=this.data;if(this.el.components["tracked-controls"]){this.removeEventListeners();return}w.setAttribute("tracked-controls",{hand:A.hand,idPrefix:y,orientationOffset:A.orientationOffset,iterateControllerProfiles:!0}),!!this.data.defaultModel&&this.initDefaultModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(w){var A=this.mapping.buttons[w.detail.id];!A||this.el.emit(A+"changed",w.detail.state)},onAxisMoved:function(w){m(this,this.mapping.axes,w)},initDefaultModel:function(){var w=this.modelEl=document.createElement("a-entity");w.setAttribute("geometry",{primitive:"sphere",radius:.03}),w.setAttribute("material",{color:this.data.color}),this.el.appendChild(w)}})},{"../core/component":131,"../utils/bind":199,"../utils/tracked-controls":214}],80:[function(r,a,s){var o=r("../core/geometry").geometries,u=r("../core/geometry").geometryNames,f=r("../core/component").registerComponent,v=r("../lib/three"),m=new v.BufferGeometry;a.exports.Component=f("geometry",{schema:{buffer:{default:!0},primitive:{default:"box",oneOf:u,schemaChange:!0},skipCache:{default:!1}},init:function(){this.geometry=null},update:function(g){var y=this.data,b=this.el,w,A=this.system;this.geometry&&(A.unuseGeometry(g),this.geometry=null),this.geometry=A.getOrCreateGeometry(y),w=b.getObject3D("mesh"),w?w.geometry=this.geometry:(w=new v.Mesh,w.geometry=this.geometry,this.el.getAttribute("material")||(w.material=new v.MeshStandardMaterial({color:Math.random()*16777215,metalness:0,roughness:.5})),b.setObject3D("mesh",w))},remove:function(){this.system.unuseGeometry(this.data),this.el.getObject3D("mesh").geometry=m,this.geometry=null},updateSchema:function(g){var y=this.oldData&&this.oldData.primitive,b=g.primitive,w=o[b]&&o[b].schema;if(!w)throw new Error("Unknown geometry schema `"+b+"`");y&&y===b||this.extendSchema(w)}})},{"../core/component":131,"../core/geometry":132,"../lib/three":179}],81:[function(r,a,s){var o=r("../core/component").registerComponent,u=r("../lib/three"),f=r("../utils/"),v=f.debug("components:gltf-model:warn");a.exports.Component=o("gltf-model",{schema:{type:"model"},init:function(){var m=this.system.getDRACOLoader();this.model=null,this.loader=new u.GLTFLoader,m&&this.loader.setDRACOLoader(m)},update:function(){var m=this,g=this.el,y=this.data;!y||(this.remove(),this.loader.load(y,function(w){m.model=w.scene||w.scenes[0],m.model.animations=w.animations,g.setObject3D("mesh",m.model),g.emit("model-loaded",{format:"gltf",model:m.model})},void 0,function(w){var A=w&&w.message?w.message:"Failed to load glTF model";v(A),g.emit("model-error",{format:"gltf",src:y})}))},remove:function(){!this.model||this.el.removeObject3D("mesh")}})},{"../core/component":131,"../lib/three":179,"../utils/":205}],82:[function(r,a,s){var o=r("../core/component").registerComponent,u={toonLeft:"https://cdn.aframe.io/controllers/hands/leftHand.glb",toonRight:"https://cdn.aframe.io/controllers/hands/rightHand.glb",lowPolyLeft:"https://cdn.aframe.io/controllers/hands/leftHandLow.glb",lowPolyRight:"https://cdn.aframe.io/controllers/hands/rightHandLow.glb",highPolyLeft:"https://cdn.aframe.io/controllers/hands/leftHandHigh.glb",highPolyRight:"https://cdn.aframe.io/controllers/hands/rightHandHigh.glb"},f={open:"Open",point:"Point",pointThumb:"Point + Thumb",fist:"Fist",hold:"Hold",thumbUp:"Thumb Up"},v={};v[f.fist]="grip",v[f.thumbUp]="pistol",v[f.point]="pointing",a.exports.Component=o("hand-controls",{schema:{color:{default:"white",type:"color"},hand:{default:"left"},handModelStyle:{default:"lowPoly",oneOf:["lowPoly","highPoly","toon"]}},init:function(){var y=this,b=this.el;this.gesture=f.open,this.pressedButtons={},this.touchedButtons={},this.loader=new THREE.GLTFLoader,this.loader.setCrossOrigin("anonymous"),this.onGripDown=function(){y.handleButton("grip","down")},this.onGripUp=function(){y.handleButton("grip","up")},this.onTrackpadDown=function(){y.handleButton("trackpad","down")},this.onTrackpadUp=function(){y.handleButton("trackpad","up")},this.onTrackpadTouchStart=function(){y.handleButton("trackpad","touchstart")},this.onTrackpadTouchEnd=function(){y.handleButton("trackpad","touchend")},this.onTriggerDown=function(){y.handleButton("trigger","down")},this.onTriggerUp=function(){y.handleButton("trigger","up")},this.onTriggerTouchStart=function(){y.handleButton("trigger","touchstart")},this.onTriggerTouchEnd=function(){y.handleButton("trigger","touchend")},this.onGripTouchStart=function(){y.handleButton("grip","touchstart")},this.onGripTouchEnd=function(){y.handleButton("grip","touchend")},this.onThumbstickDown=function(){y.handleButton("thumbstick","down")},this.onThumbstickUp=function(){y.handleButton("thumbstick","up")},this.onAorXTouchStart=function(){y.handleButton("AorX","touchstart")},this.onAorXTouchEnd=function(){y.handleButton("AorX","touchend")},this.onBorYTouchStart=function(){y.handleButton("BorY","touchstart")},this.onBorYTouchEnd=function(){y.handleButton("BorY","touchend")},this.onSurfaceTouchStart=function(){y.handleButton("surface","touchstart")},this.onSurfaceTouchEnd=function(){y.handleButton("surface","touchend")},this.onControllerConnected=this.onControllerConnected.bind(this),this.onControllerDisconnected=this.onControllerDisconnected.bind(this),b.addEventListener("controllerconnected",this.onControllerConnected),b.addEventListener("controllerdisconnected",this.onControllerDisconnected),b.object3D.visible=!1},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},tick:function(y,b){var w=this.el.getObject3D("mesh");!w||!w.mixer||w.mixer.update(b/1e3)},onControllerConnected:function(){this.el.object3D.visible=!0},onControllerDisconnected:function(){this.el.object3D.visible=!1},addEventListeners:function(){var y=this.el;y.addEventListener("gripdown",this.onGripDown),y.addEventListener("gripup",this.onGripUp),y.addEventListener("trackpaddown",this.onTrackpadDown),y.addEventListener("trackpadup",this.onTrackpadUp),y.addEventListener("trackpadtouchstart",this.onTrackpadTouchStart),y.addEventListener("trackpadtouchend",this.onTrackpadTouchEnd),y.addEventListener("triggerdown",this.onTriggerDown),y.addEventListener("triggerup",this.onTriggerUp),y.addEventListener("triggertouchstart",this.onTriggerTouchStart),y.addEventListener("triggertouchend",this.onTriggerTouchEnd),y.addEventListener("griptouchstart",this.onGripTouchStart),y.addEventListener("griptouchend",this.onGripTouchEnd),y.addEventListener("thumbstickdown",this.onThumbstickDown),y.addEventListener("thumbstickup",this.onThumbstickUp),y.addEventListener("abuttontouchstart",this.onAorXTouchStart),y.addEventListener("abuttontouchend",this.onAorXTouchEnd),y.addEventListener("bbuttontouchstart",this.onBorYTouchStart),y.addEventListener("bbuttontouchend",this.onBorYTouchEnd),y.addEventListener("xbuttontouchstart",this.onAorXTouchStart),y.addEventListener("xbuttontouchend",this.onAorXTouchEnd),y.addEventListener("ybuttontouchstart",this.onBorYTouchStart),y.addEventListener("ybuttontouchend",this.onBorYTouchEnd),y.addEventListener("surfacetouchstart",this.onSurfaceTouchStart),y.addEventListener("surfacetouchend",this.onSurfaceTouchEnd)},removeEventListeners:function(){var y=this.el;y.removeEventListener("gripdown",this.onGripDown),y.removeEventListener("gripup",this.onGripUp),y.removeEventListener("trackpaddown",this.onTrackpadDown),y.removeEventListener("trackpadup",this.onTrackpadUp),y.removeEventListener("trackpadtouchstart",this.onTrackpadTouchStart),y.removeEventListener("trackpadtouchend",this.onTrackpadTouchEnd),y.removeEventListener("triggerdown",this.onTriggerDown),y.removeEventListener("triggerup",this.onTriggerUp),y.removeEventListener("triggertouchstart",this.onTriggerTouchStart),y.removeEventListener("triggertouchend",this.onTriggerTouchEnd),y.removeEventListener("griptouchstart",this.onGripTouchStart),y.removeEventListener("griptouchend",this.onGripTouchEnd),y.removeEventListener("thumbstickdown",this.onThumbstickDown),y.removeEventListener("thumbstickup",this.onThumbstickUp),y.removeEventListener("abuttontouchstart",this.onAorXTouchStart),y.removeEventListener("abuttontouchend",this.onAorXTouchEnd),y.removeEventListener("bbuttontouchstart",this.onBorYTouchStart),y.removeEventListener("bbuttontouchend",this.onBorYTouchEnd),y.removeEventListener("xbuttontouchstart",this.onAorXTouchStart),y.removeEventListener("xbuttontouchend",this.onAorXTouchEnd),y.removeEventListener("ybuttontouchstart",this.onBorYTouchStart),y.removeEventListener("ybuttontouchend",this.onBorYTouchEnd),y.removeEventListener("surfacetouchstart",this.onSurfaceTouchStart),y.removeEventListener("surfacetouchend",this.onSurfaceTouchEnd)},update:function(y){var b,w=this.el,A=this.data.hand,M=this.data.handModelStyle,S=this.data.color,E=this;if(b={hand:A,model:!1},A!==y){var T=u[M+A.charAt(0).toUpperCase()+A.slice(1)];this.loader.load(T,function(C){var L=C.scene.children[0],P=A==="left"?Math.PI/2:-Math.PI/2;L.mixer=new THREE.AnimationMixer(L),E.clips=C.animations,w.setObject3D("mesh",L);var N=L.children[1].material;N.color=new THREE.Color(S),L.position.set(0,0,0),L.rotation.set(0,0,P),w.setAttribute("magicleap-controls",b),w.setAttribute("vive-controls",b),w.setAttribute("oculus-touch-controls",b),w.setAttribute("windows-motion-controls",b)})}},remove:function(){this.el.removeObject3D("mesh")},handleButton:function(y,b){var w,A=b==="down",M=b==="touchstart";if(b.indexOf("touch")===0){if(M===this.touchedButtons[y])return;this.touchedButtons[y]=M}else{if(A===this.pressedButtons[y])return;this.pressedButtons[y]=A}w=this.gesture,this.gesture=this.determineGesture(),this.gesture!==w&&(this.animateGesture(this.gesture,w),this.emitGestureEvents(this.gesture,w))},determineGesture:function(){var y,b=this.pressedButtons.grip,w=this.pressedButtons.surface||this.touchedButtons.surface,A=this.pressedButtons.trackpad||this.touchedButtons.trackpad,M=this.pressedButtons.trigger||this.touchedButtons.trigger,S=this.touchedButtons.AorX||this.touchedButtons.BorY,E=g(this.el.components["tracked-controls"]);return E?b||M?y=f.fist:A&&(y=f.point):b?w||S||A?y=M?f.fist:f.point:y=M?f.thumbUp:f.pointThumb:M&&(y=f.hold),y},getClip:function(y){var b,w;for(w=0;w<this.clips.length;w++)if(b=this.clips[w],b.name===y)return b},animateGesture:function(y,b){if(y){this.playAnimation(y||f.open,b,!1);return}this.playAnimation(b,b,!0)},emitGestureEvents:function(y,b){var w=this.el,A;b!==y&&(A=m(b,!1),A&&w.emit(A),A=m(y,!0),A&&w.emit(A))},playAnimation:function(y,b,w){var A,M,S=this.el.getObject3D("mesh"),E;if(!!S){if(S.mixer.stopAllAction(),A=this.getClip(y),E=S.mixer.clipAction(A),E.clampWhenFinished=!0,E.loop=THREE.LoopRepeat,E.repetitions=0,E.timeScale=w?-1:1,E.time=w?A.duration:0,E.weight=1,!b||y===b){S.mixer.stopAllAction(),E.play();return}A=this.getClip(b),M=S.mixer.clipAction(A),M.weight=.15,M.play(),E.play(),M.crossFadeTo(E,.15,!0)}}});function m(y,b){var w;if(!!y){if(w=v[y],w==="grip")return w+(b?"close":"open");if(w==="point")return w+(b?"up":"down");if(w==="pointing"||w==="pistol")return w+(b?"start":"end")}}function g(y){var b=y&&y.controller,w=b&&(b.id&&b.id.indexOf("OpenVR ")===0||b.profiles&&b.profiles[0]&&b.profiles[0]==="htc-vive-controller-mv");return w}},{"../core/component":131}],83:[function(r,a,s){var o=r("../core/component").registerComponent,u=r("../utils/bind"),f=r("../utils/tracked-controls"),v=f.checkControllerPresentAndSetup,m="https://cdn.aframe.io/controllers/oculus-hands/unity/left.glb",g="https://cdn.aframe.io/controllers/oculus-hands/unity/right.glb",y={left:"b_l_",right:"b_r_"},b=["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"],w={wrist:"wrist","thumb-metacarpal":"thumb1","thumb-phalanx-proximal":"thumb2","thumb-phalanx-distal":"thumb3","thumb-tip":"thumb_null","index-finger-phalanx-proximal":"index1","index-finger-phalanx-intermediate":"index2","index-finger-phalanx-distal":"index3","index-finger-tip":"index_null","middle-finger-phalanx-proximal":"middle1","middle-finger-phalanx-intermediate":"middle2","middle-finger-phalanx-distal":"middle3","middle-finger-tip":"middle_null","ring-finger-phalanx-proximal":"ring1","ring-finger-phalanx-intermediate":"ring2","ring-finger-phalanx-distal":"ring3","ring-finger-tip":"ring_null","pinky-finger-metacarpal":"pinky0","pinky-finger-phalanx-proximal":"pinky1","pinky-finger-phalanx-intermediate":"pinky2","pinky-finger-phalanx-distal":"pinky3","pinky-finger-tip":"pinky_null"},A=.015,M=.03,S=.5;a.exports.Component=o("hand-tracking-controls",{schema:{hand:{default:"right",oneOf:["left","right"]},modelStyle:{default:"mesh",oneOf:["dots","mesh"]},modelColor:{default:"white"}},bindMethods:function(){this.onControllersUpdate=u(this.onControllersUpdate,this),this.checkIfControllerPresent=u(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=u(this.removeControllersUpdateListener,this)},addEventListeners:function(){this.el.addEventListener("model-loaded",this.onModelLoaded);for(var E=0;E<this.jointEls.length;++E)this.jointEls[E].object3D.visible=!0},removeEventListeners:function(){this.el.removeEventListener("model-loaded",this.onModelLoaded);for(var E=0;E<this.jointEls.length;++E)this.jointEls[E].object3D.visible=!1},init:function(){var E=this.el.sceneEl,T=E.getAttribute("webxr").optionalFeatures;T.push("hand-tracking"),E.setAttribute("webxr",{optionalFeatures:T}),this.onModelLoaded=this.onModelLoaded.bind(this),this.jointEls=[],this.controllerPresent=!1,this.isPinched=!1,this.pinchEventDetail={position:new THREE.Vector3},this.indexTipPosition=new THREE.Vector3,this.bindMethods(),this.updateReferenceSpace=this.updateReferenceSpace.bind(this),this.el.sceneEl.addEventListener("enter-vr",this.updateReferenceSpace),this.el.sceneEl.addEventListener("exit-vr",this.updateReferenceSpace)},updateReferenceSpace:function(){var E=this,T=this.el.sceneEl.xrSession;if(this.referenceSpace=void 0,!!T){var C=E.el.sceneEl.systems.webxr.sessionReferenceSpaceType;T.requestReferenceSpace(C).then(function(L){E.referenceSpace=L.getOffsetReferenceSpace(new XRRigidTransform({x:0,y:1.5,z:0}))}).catch(function(L){throw E.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(C,"tracked-controls-webxr uses reference space "+C),L})}},checkIfControllerPresent:function(){var E=this.data,T=E.hand?E.hand:void 0;v(this,"",{hand:T,iterateControllerProfiles:!0,handTracking:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},tick:function(){var E=this.el.sceneEl,T=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,C=E.frame,L=this.el.components["tracked-controls-webxr"];!T||!C||!L||T.hand&&(this.el.object3D.position.set(0,0,0),this.el.object3D.rotation.set(0,0,0),C.getJointPose&&this.updateHandModel(),this.detectGesture())},updateHandModel:function(){this.data.modelStyle==="dots"&&this.updateHandDotsModel(),this.data.modelStyle==="mesh"&&this.updateHandMeshModel()},getBone:function(E){for(var T=this.bones,C=0;C<T.length;C++)if(T[C].name===E)return T[C];return null},updateHandMeshModel:function(){var E=this.el.sceneEl.frame,T=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,C=this.referenceSpace;if(!(!T||!this.mesh||!C)){this.mesh.visible=!1;for(var L of T.hand.values()){var P,N,F;N=E.getJointPose(L,C),!!w[L.jointName]&&(P=this.getBone(y[this.data.hand]+w[L.jointName]),P!=null&&N&&(F=N.transform,this.mesh.visible=!0,P.position.copy(F.position).multiplyScalar(100),P.quaternion.set(F.orientation.x,F.orientation.y,F.orientation.z,F.orientation.w)))}}},updateHandDotsModel:function(){var E=this.el.sceneEl.frame,T=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,C=this.el.components["tracked-controls-webxr"],L=C.system.referenceSpace,P,N,F,X=0;for(var Y of T.hand.values())P=this.jointEls[X++],N=P.object3D,F=E.getJointPose(Y,L),P.object3D.visible=!!F,!!F&&(N.matrix.elements=F.transform.matrix,N.matrix.decompose(N.position,N.rotation,N.scale),P.setAttribute("scale",{x:F.radius,y:F.radius,z:F.radius}))},detectGesture:function(){this.detectPinch()},detectPinch:function(){var E=new THREE.Vector3;return function(){var T=this.el.sceneEl.frame,C=this.indexTipPosition,L=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,P=this.el.components["tracked-controls-webxr"],N=this.referenceSpace||P.system.referenceSpace,F=L.hand.get("index-finger-tip"),X=L.hand.get("thumb-tip");if(!(!F||!X)){var Y=T.getJointPose(F,N),ae=T.getJointPose(X,N);if(!(!Y||!ae)){E.copy(ae.transform.position),C.copy(Y.transform.position);var $=C.distanceTo(E);$<A&&this.isPinched===!1&&(this.isPinched=!0,this.pinchEventDetail.position.copy(C).lerp(E,S),this.pinchEventDetail.position.y+=1.5,this.el.emit("pinchstarted",this.pinchEventDetail)),$>M&&this.isPinched===!0&&(this.isPinched=!1,this.pinchEventDetail.position.copy(C).lerp(E,S),this.pinchEventDetail.position.y+=1.5,this.el.emit("pinchended",this.pinchEventDetail)),this.isPinched&&(this.pinchEventDetail.position.copy(C).lerp(E,S),this.pinchEventDetail.position.y+=1.5,this.el.emit("pinchmoved",this.pinchEventDetail)),C.y+=1.5}}}}(),pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var E=this.el,T=this.data;E.setAttribute("tracked-controls",{hand:T.hand,iterateControllerProfiles:!0,handTrackingEnabled:!0}),this.initDefaultModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){var E;this.checkIfControllerPresent(),E=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,!!this.el.getObject3D("mesh")&&(!E||!E.hand||!E.hand[0])&&(this.el.getObject3D("mesh").visible=!1)},initDefaultModel:function(){this.el.getObject3D("mesh")||(this.data.modelStyle==="dots"&&this.initDotsModel(),this.data.modelStyle==="mesh"&&this.initMeshHandModel())},initDotsModel:function(){if(this.jointEls.length===0)for(var E=0;E<b.length;++E){var T=this.jointEl=document.createElement("a-entity");T.setAttribute("geometry",{primitive:"sphere",radius:1}),T.setAttribute("material",{color:this.data.modelColor}),T.object3D.visible=!1,this.el.appendChild(T),this.jointEls.push(T)}},initMeshHandModel:function(){var E=this.data.hand==="left"?m:g;this.el.setAttribute("gltf-model",E)},onModelLoaded:function(){var E=this.mesh=this.el.getObject3D("mesh").children[0],T=this.skinnedMesh=E.children[24];!this.skinnedMesh||(this.bones=T.skeleton.bones,this.el.removeObject3D("mesh"),E.position.set(0,1.5,0),E.rotation.set(0,0,0),T.frustumCulled=!1,T.material=new THREE.MeshStandardMaterial({skinning:!0,color:this.data.modelColor}),this.el.setObject3D("mesh",E))}})},{"../core/component":131,"../utils/bind":199,"../utils/tracked-controls":214}],84:[function(r,a,s){r("./animation"),r("./camera"),r("./cursor"),r("./daydream-controls"),r("./gearvr-controls"),r("./geometry"),r("./generic-tracked-controller-controls"),r("./gltf-model"),r("./hand-tracking-controls"),r("./hand-controls"),r("./layer"),r("./laser-controls"),r("./light"),r("./line"),r("./link"),r("./look-controls"),r("./magicleap-controls"),r("./material"),r("./obj-model"),r("./oculus-go-controls"),r("./oculus-touch-controls"),r("./position"),r("./raycaster"),r("./rotation"),r("./scale"),r("./shadow"),r("./sound"),r("./text"),r("./tracked-controls"),r("./tracked-controls-webvr"),r("./tracked-controls-webxr"),r("./visible"),r("./valve-index-controls"),r("./vive-controls"),r("./vive-focus-controls"),r("./wasd-controls"),r("./windows-motion-controls"),r("./scene/background"),r("./scene/debug"),r("./scene/device-orientation-permission-ui"),r("./scene/embedded"),r("./scene/inspector"),r("./scene/fog"),r("./scene/keyboard-shortcuts"),r("./scene/pool"),r("./scene/screenshot"),r("./scene/stats"),r("./scene/vr-mode-ui")},{"./animation":74,"./camera":75,"./cursor":76,"./daydream-controls":77,"./gearvr-controls":78,"./generic-tracked-controller-controls":79,"./geometry":80,"./gltf-model":81,"./hand-controls":82,"./hand-tracking-controls":83,"./laser-controls":85,"./layer":86,"./light":87,"./line":88,"./link":89,"./look-controls":90,"./magicleap-controls":91,"./material":92,"./obj-model":93,"./oculus-go-controls":94,"./oculus-touch-controls":95,"./position":96,"./raycaster":97,"./rotation":98,"./scale":99,"./scene/background":100,"./scene/debug":101,"./scene/device-orientation-permission-ui":102,"./scene/embedded":103,"./scene/fog":104,"./scene/inspector":105,"./scene/keyboard-shortcuts":106,"./scene/pool":107,"./scene/screenshot":108,"./scene/stats":109,"./scene/vr-mode-ui":110,"./shadow":111,"./sound":112,"./text":113,"./tracked-controls":116,"./tracked-controls-webvr":114,"./tracked-controls-webxr":115,"./valve-index-controls":117,"./visible":118,"./vive-controls":119,"./vive-focus-controls":120,"./wasd-controls":121,"./windows-motion-controls":122}],85:[function(r,a,s){var o=r("../core/component").registerComponent,u=r("../utils/");o("laser-controls",{schema:{hand:{default:"right"},model:{default:!0},defaultModelColor:{type:"color",default:"grey"}},init:function(){var f=this.config,v=this.data,m=this.el,g=this,y={hand:v.hand,model:v.model};m.setAttribute("daydream-controls",y),m.setAttribute("gearvr-controls",y),m.setAttribute("magicleap-controls",y),m.setAttribute("oculus-go-controls",y),m.setAttribute("oculus-touch-controls",y),m.setAttribute("valve-index-controls",y),m.setAttribute("vive-controls",y),m.setAttribute("vive-focus-controls",y),m.setAttribute("windows-motion-controls",y),m.setAttribute("generic-tracked-controller-controls",y),m.addEventListener("controllerconnected",b),m.addEventListener("controllerdisconnected",w),m.addEventListener("controllermodelready",function(A){b(A),g.modelReady=!0});function b(A){var M=f[A.detail.name];if(!!M){var S=u.extend({showLine:!0},M.raycaster||{});A.detail.rayOrigin&&(S.origin=A.detail.rayOrigin.origin,S.direction=A.detail.rayOrigin.direction,S.showLine=!0),A.detail.rayOrigin||!g.modelReady?m.setAttribute("raycaster",S):m.setAttribute("raycaster","showLine",!0),m.setAttribute("cursor",u.extend({fuse:!1},M.cursor))}}function w(){m.setAttribute("raycaster","showLine",!1)}},config:{"daydream-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"gearvr-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:.001,z:0}}},"generic-tracked-controller-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"magicleap-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"oculus-go-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:5e-4,z:0}}},"oculus-touch-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:0,z:0}}},"valve-index-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-focus-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"windows-motion-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{showLine:!1}}}})},{"../core/component":131,"../utils/":205}],86:[function(r,a,s){var o=r("../core/component").registerComponent,u=r("../utils/"),f=u.debug("components:layer:warn");a.exports.Component=o("layer",{schema:{type:{default:"quad",oneOf:["quad","monocubemap","stereocubemap"]},src:{type:"map"},rotateCubemap:{default:!1},width:{default:0},height:{default:0}},init:function(){var m=this.el.sceneEl.renderer.getContext();this.quaternion=new THREE.Quaternion,this.position=new THREE.Vector3,this.bindMethods(),this.needsRedraw=!1,this.frameBuffer=m.createFramebuffer();var g=this.el.sceneEl.getAttribute("webxr").requiredFeatures;g.push("layers"),this.el.sceneEl.getAttribute("webxr","requiredFeatures",g),this.el.sceneEl.addEventListener("enter-vr",this.onEnterVR),this.el.sceneEl.addEventListener("exit-vr",this.onExitVR)},bindMethods:function(){this.onRequestedReferenceSpace=this.onRequestedReferenceSpace.bind(this),this.onEnterVR=this.onEnterVR.bind(this),this.onExitVR=this.onExitVR.bind(this)},update:function(m){this.data.src!==m.src&&this.updateSrc()},updateSrc:function(){var m=this.data.type;if(this.texture=void 0,m==="quad"){this.loadQuadImage();return}if(m==="monocubemap"||m==="stereocubemap"){this.loadCubeMapImages();return}},loadCubeMapImages:function(){var m=this.data.type,g,y=this.xrGLFactory,b=this.el.sceneEl.frame,w=this.data.src;this.visibilityChanged=!1,!!this.layer&&(w.complete?this.pendingCubeMapUpdate=!1:this.pendingCubeMapUpdate=!0,this.loadingScreen?this.loadingScreen=!1:this.loadingScreen=!0,m==="monocubemap"?(g=y.getSubImage(this.layer,b),this.loadCubeMapImage(g.colorTexture,w,0)):(g=y.getSubImage(this.layer,b,"left"),this.loadCubeMapImage(g.colorTexture,w,0),g=y.getSubImage(this.layer,b,"right"),this.loadCubeMapImage(g.colorTexture,w,6)))},loadQuadImage:function(){var m=this.data.src,g=this;this.el.sceneEl.systems.material.loadTexture(m,{src:m},function(b){g.el.sceneEl.renderer.initTexture(b),g.texture=b,m.tagName==="VIDEO"&&setTimeout(function(){g.textureIsVideo=!0},1e3),g.layer&&(g.layer.height=g.data.height/2||g.texture.image.height/1e3,g.layer.width=g.data.width/2||g.texture.image.width/1e3,g.needsRedraw=!0),g.updateQuadPanel()})},preGenerateCubeMapTextures:function(m,g){this.data.type==="monocubemap"?this.generateCubeMapTextures(m,0,g):(this.generateCubeMapTextures(m,0,g),this.generateCubeMapTextures(m,6,g))},generateCubeMapTextures:function(m,g,y){for(var b=this.data,w=this.cubeFaceSize,A=Math.min(m.width,m.height),M=[],S,E,T=0;T<6;T++){var C=document.createElement("CANVAS");C.width=C.height=w;var L=C.getContext("2d");b.rotateCubemap&&(T===2||T===3)&&(L.save(),L.translate(w,w),L.rotate(Math.PI)),L.drawImage(m,(T+g)*A,0,A,A,0,0,w,w),L.restore(),y&&y(),M.push(C)}return b.rotateCubemap&&(S=M[0],E=M[1],M[0]=E,M[1]=S,S=M[4],E=M[5],M[4]=E,M[5]=S),y&&y(),M},loadCubeMapImage:function(m,g,y){var b=this.el.sceneEl.renderer.getContext(),w;b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1),b.bindTexture(b.TEXTURE_CUBE_MAP,m),!g.complete||this.loadingScreen?w=this.loadingScreenImages:w=this.generateCubeMapTextures(g,y);var A=0;w.forEach(function(M,S){b.texSubImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+S,0,0,0,b.RGBA,b.UNSIGNED_BYTE,M),A=b.getError()}),A!==0&&console.log("renderingError, WebGL Error Code: "+A),b.bindTexture(b.TEXTURE_CUBE_MAP,null)},tick:function(){!this.el.sceneEl.xrSession||(!this.layer&&this.el.sceneEl.is("vr-mode")&&this.initLayer(),this.updateTransform(),this.data.src.complete&&(this.pendingCubeMapUpdate||this.loadingScreen||this.visibilityChanged)&&this.loadCubeMapImages(),!(!this.needsRedraw&&!this.layer.needsRedraw&&!this.textureIsVideo)&&(this.data.type==="quad"&&this.draw(),this.needsRedraw=!1))},initLayer:function(){var m=this,g=this.data.type;if(this.el.sceneEl.xrSession.onvisibilitychange=function(y){m.visibilityChanged=y.session.visibilityState!=="hidden"},g==="quad"){this.initQuadLayer();return}if(g==="monocubemap"||g==="stereocubemap"){this.initCubeMapLayer();return}},initQuadLayer:function(){var m=this.el.sceneEl,g=m.renderer.getContext(),y=this.xrGLFactory=new XRWebGLBinding(m.xrSession,g);!this.texture||(this.layer=y.createQuadLayer({space:this.referenceSpace,viewPixelHeight:2048,viewPixelWidth:2048,height:this.data.height/2||this.texture.image.height/1e3,width:this.data.width/2||this.texture.image.width/1e3}),m.renderer.xr.addLayer(this.layer))},initCubeMapLayer:function(){var m=this.data.src,g=this.el.sceneEl,y=g.renderer.getContext(),b=y.getParameter(y.MAX_CUBE_MAP_TEXTURE_SIZE),w=this.cubeFaceSize=Math.min(b,Math.min(m.width,m.height)),A=this.xrGLFactory=new XRWebGLBinding(g.xrSession,y);this.layer=A.createCubeLayer({space:this.referenceSpace,viewPixelWidth:w,viewPixelHeight:w,layout:this.data.type==="monocubemap"?"mono":"stereo",isStatic:!1}),this.initLoadingScreenImages(),this.loadCubeMapImages(),g.renderer.xr.addLayer(this.layer)},initLoadingScreenImages:function(){for(var m=this.cubeFaceSize,g=this.loadingScreenImages=[],y=0;y<6;y++){var b=document.createElement("CANVAS");b.width=b.height=m;var w=b.getContext("2d");b.width=b.height=m,w.fillStyle="black",w.fillRect(0,0,m,m),y!==2&&y!==3&&(w.translate(m,0),w.scale(-1,1),w.fillStyle="white",w.font="30px Arial",w.fillText("Loading",m/2,m/2)),g.push(b)}},destroyLayer:function(){!this.layer||(this.el.sceneEl.renderer.xr.removeLayer(this.layer),this.layer.destroy(),this.layer=void 0)},toggleCompositorLayer:function(){this.enableCompositorLayer(!this.layerEnabled)},enableCompositorLayer:function(m){this.layerEnabled=m,this.quadPanelEl.object3D.visible=!this.layerEnabled},updateQuadPanel:function(){var m=this.quadPanelEl;this.quadPanelEl||(m=this.quadPanelEl=document.createElement("a-entity"),this.el.appendChild(m)),m.setAttribute("material",{shader:"flat",src:this.data.src,transparent:!0}),m.setAttribute("geometry",{primitive:"plane",height:this.data.height||this.texture.image.height/1e3,width:this.data.width||this.texture.image.height/1e3})},draw:function(){var m=this.el.sceneEl,g=this.el.sceneEl.renderer.getContext(),y=this.xrGLFactory.getSubImage(this.layer,m.frame),b=m.renderer.properties.get(this.texture).__webglTexture,w=g.getParameter(g.FRAMEBUFFER_BINDING);g.viewport(y.viewport.x,y.viewport.y,y.viewport.width,y.viewport.height),g.bindFramebuffer(g.FRAMEBUFFER,this.frameBuffer),g.framebufferTexture2D(g.FRAMEBUFFER,g.COLOR_ATTACHMENT0,g.TEXTURE_2D,y.colorTexture,0),v(g,b,y,this.data.src),g.bindFramebuffer(g.FRAMEBUFFER,w)},updateTransform:function(){var m=this.el,g=this.position,y=this.quaternion;m.object3D.updateMatrixWorld(),g.setFromMatrixPosition(m.object3D.matrixWorld),y.setFromRotationMatrix(m.object3D.matrixWorld),this.layerEnabled||g.set(0,0,1e8),this.layer.transform=new XRRigidTransform(g,y)},onEnterVR:function(){var m=this.el.sceneEl,g=m.xrSession;if(!m.hasWebXR||!XRWebGLBinding||!g){f("The layer component requires WebXR and the layers API enabled");return}g.requestReferenceSpace("local").then(this.onRequestedReferenceSpace),this.needsRedraw=!0,this.layerEnabled=!0,this.quadPanelEl&&(this.quadPanelEl.object3D.visible=!1),this.data.src.play&&this.data.src.play()},onExitVR:function(){this.quadPanelEl&&(this.quadPanelEl.object3D.visible=!0),this.destroyLayer()},onRequestedReferenceSpace:function(m){this.referenceSpace=m}});function v(m,g,y,b){var w=m.createFramebuffer();let A=y.viewport.x,M=y.viewport.y,S=y.viewport.x+y.viewport.width,E=y.viewport.y+y.viewport.height;b.tagName==="VIDEO"&&(m.bindTexture(m.TEXTURE_2D,g),m.texSubImage2D(m.TEXTURE_2D,0,0,0,b.width,b.height,m.RGB,m.UNSIGNED_BYTE,b)),m.bindFramebuffer(m.READ_FRAMEBUFFER,w),m.framebufferTexture2D(m.READ_FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,g,0),m.readBuffer(m.COLOR_ATTACHMENT0),m.blitFramebuffer(0,0,b.width,b.height,A,M,S,E,m.COLOR_BUFFER_BIT,m.NEAREST),m.bindFramebuffer(m.READ_FRAMEBUFFER,null),m.deleteFramebuffer(w)}},{"../core/component":131,"../utils/":205}],87:[function(r,a,s){var o=r("../utils/bind"),u=r("../utils").diff,f=r("../utils/debug"),v=r("../core/component").registerComponent,m=r("../lib/three"),g=m.Math.degToRad,y=f("components:light:warn");a.exports.Component=v("light",{schema:{angle:{default:60,if:{type:["spot"]}},color:{type:"color"},groundColor:{type:"color",if:{type:["hemisphere"]}},decay:{default:1,if:{type:["point","spot"]}},distance:{default:0,min:0,if:{type:["point","spot"]}},intensity:{default:1,min:0,if:{type:["ambient","directional","hemisphere","point","spot"]}},penumbra:{default:0,min:0,max:1,if:{type:["spot"]}},type:{default:"directional",oneOf:["ambient","directional","hemisphere","point","spot"],schemaChange:!0},target:{type:"selector",if:{type:["spot","directional"]}},castShadow:{default:!1,if:{type:["point","spot","directional"]}},shadowBias:{default:0,if:{castShadow:!0}},shadowCameraFar:{default:500,if:{castShadow:!0}},shadowCameraFov:{default:90,if:{castShadow:!0}},shadowCameraNear:{default:.5,if:{castShadow:!0}},shadowCameraTop:{default:5,if:{castShadow:!0}},shadowCameraRight:{default:5,if:{castShadow:!0}},shadowCameraBottom:{default:-5,if:{castShadow:!0}},shadowCameraLeft:{default:-5,if:{castShadow:!0}},shadowCameraVisible:{default:!1,if:{castShadow:!0}},shadowMapHeight:{default:512,if:{castShadow:!0}},shadowMapWidth:{default:512,if:{castShadow:!0}},shadowRadius:{default:1,if:{castShadow:!0}}},init:function(){var b=this.el;this.light=null,this.defaultTarget=null,this.rendererSystem=this.el.sceneEl.systems.renderer,this.system.registerLight(b)},update:function(b){var w=this.data,A=u(w,b),M=this.light,S=this.rendererSystem,E=this;if(M&&!("type"in A)){var T=!1;Object.keys(A).forEach(function(C){var L=w[C];switch(C){case"color":{M.color.set(L),S.applyColorCorrection(M.color);break}case"groundColor":{M.groundColor.set(L),S.applyColorCorrection(M.groundColor);break}case"angle":{M.angle=g(L);break}case"target":{L===null?(w.type==="spot"||w.type==="directional")&&(M.target=E.defaultTarget):L.hasLoaded?E.onSetTarget(L,M):L.addEventListener("loaded",o(E.onSetTarget,E,L,M));break}case"castShadow":case"shadowBias":case"shadowCameraFar":case"shadowCameraFov":case"shadowCameraNear":case"shadowCameraTop":case"shadowCameraRight":case"shadowCameraBottom":case"shadowCameraLeft":case"shadowCameraVisible":case"shadowMapHeight":case"shadowMapWidth":case"shadowRadius":T||(E.updateShadow(),T=!0);break;default:M[C]=L}});return}this.setLight(this.data),this.updateShadow()},setLight:function(b){var w=this.el,A=this.getLight(b);A&&(this.light&&w.removeObject3D("light"),this.light=A,this.light.el=w,w.setObject3D("light",this.light),(b.type==="spot"||b.type==="directional"||b.type==="hemisphere")&&w.getObject3D("light").translateY(-1),b.type==="spot"&&(w.setObject3D("light-target",this.defaultTarget),w.getObject3D("light-target").position.set(0,0,-1)))},updateShadow:function(){var b=this.el,w=this.data,A=this.light;A.castShadow=w.castShadow;var M=b.getObject3D("cameraHelper");if(w.shadowCameraVisible&&!M?b.setObject3D("cameraHelper",new m.CameraHelper(A.shadow.camera)):!w.shadowCameraVisible&&M&&b.removeObject3D("cameraHelper"),!w.castShadow)return A;A.shadow.bias=w.shadowBias,A.shadow.radius=w.shadowRadius,A.shadow.mapSize.height=w.shadowMapHeight,A.shadow.mapSize.width=w.shadowMapWidth,A.shadow.camera.near=w.shadowCameraNear,A.shadow.camera.far=w.shadowCameraFar,A.shadow.camera instanceof m.OrthographicCamera?(A.shadow.camera.top=w.shadowCameraTop,A.shadow.camera.right=w.shadowCameraRight,A.shadow.camera.bottom=w.shadowCameraBottom,A.shadow.camera.left=w.shadowCameraLeft):A.shadow.camera.fov=w.shadowCameraFov,A.shadow.camera.updateProjectionMatrix(),M&&M.update()},getLight:function(b){var w=b.angle,A=new m.Color(b.color);this.rendererSystem.applyColorCorrection(A),A=A.getHex();var M=b.decay,S=b.distance,E=new m.Color(b.groundColor);this.rendererSystem.applyColorCorrection(E),E=E.getHex();var T=b.intensity,C=b.type,L=b.target,P=null;switch(C.toLowerCase()){case"ambient":return new m.AmbientLight(A,T);case"directional":return P=new m.DirectionalLight(A,T),this.defaultTarget=P.target,L&&(L.hasLoaded?this.onSetTarget(L,P):L.addEventListener("loaded",o(this.onSetTarget,this,L,P))),P;case"hemisphere":return new m.HemisphereLight(A,E,T);case"point":return new m.PointLight(A,T,S,M);case"spot":return P=new m.SpotLight(A,T,S,g(w),b.penumbra,M),this.defaultTarget=P.target,L&&(L.hasLoaded?this.onSetTarget(L,P):L.addEventListener("loaded",o(this.onSetTarget,this,L,P))),P;default:y("%s is not a valid light type. Choose from ambient, directional, hemisphere, point, spot.",C)}},onSetTarget:function(b,w){w.target=b.object3D},remove:function(){var b=this.el;b.removeObject3D("light"),b.getObject3D("cameraHelper")&&b.removeObject3D("cameraHelper")}})},{"../core/component":131,"../lib/three":179,"../utils":205,"../utils/bind":199,"../utils/debug":201}],88:[function(r,a,s){var o=r("../core/component").registerComponent;a.exports.Component=o("line",{schema:{start:{type:"vec3",default:{x:0,y:0,z:0}},end:{type:"vec3",default:{x:0,y:0,z:0}},color:{type:"color",default:"#74BEC1"},opacity:{type:"number",default:1},visible:{default:!0}},multiple:!0,init:function(){var f=this.data,v,m;this.rendererSystem=this.el.sceneEl.systems.renderer,m=this.material=new THREE.LineBasicMaterial({color:f.color,opacity:f.opacity,transparent:f.opacity<1,visible:f.visible}),v=this.geometry=new THREE.BufferGeometry,v.setAttribute("position",new THREE.BufferAttribute(new Float32Array(2*3),3)),this.rendererSystem.applyColorCorrection(m.color),this.line=new THREE.Line(v,m),this.el.setObject3D(this.attrName,this.line)},update:function(f){var v=this.data,m=this.geometry,g=!1,y=this.material,b=m.attributes.position.array;u(v.start,f.start)||(b[0]=v.start.x,b[1]=v.start.y,b[2]=v.start.z,g=!0),u(v.end,f.end)||(b[3]=v.end.x,b[4]=v.end.y,b[5]=v.end.z,g=!0),g&&(m.attributes.position.needsUpdate=!0,m.computeBoundingSphere()),y.color.setStyle(v.color),this.rendererSystem.applyColorCorrection(y.color),y.opacity=v.opacity,y.transparent=v.opacity<1,y.visible=v.visible},remove:function(){this.el.removeObject3D("line",this.line)}});function u(f,v){return!f||!v?!1:f.x===v.x&&f.y===v.y&&f.z===v.z}},{"../core/component":131}],89:[function(r,a,s){var o=r("../core/component").registerComponent,u=r("../core/shader").registerShader,f=r("../lib/three");a.exports.Component=o("link",{schema:{backgroundColor:{default:"red",type:"color"},borderColor:{default:"white",type:"color"},highlighted:{default:!1},highlightedColor:{default:"#24CAFF",type:"color"},href:{default:""},image:{type:"asset"},on:{default:"click"},peekMode:{default:!1},title:{default:""},titleColor:{default:"white",type:"color"},visualAspectEnabled:{default:!1}},init:function(){this.navigate=this.navigate.bind(this),this.previousQuaternion=void 0,this.quaternionClone=new f.Quaternion,this.hiddenEls=[]},update:function(v){var m=this.data,g=this.el,y,b;!m.visualAspectEnabled||(this.initVisualAspect(),y=m.highlighted?m.highlightedColor:m.backgroundColor,b=m.highlighted?m.highlightedColor:m.borderColor,g.setAttribute("material","backgroundColor",y),g.setAttribute("material","strokeColor",b),m.on!==v.on&&this.updateEventListener(),v.peekMode!==void 0&&m.peekMode!==v.peekMode&&this.updatePeekMode(),!(!m.image||v.image===m.image)&&g.setAttribute("material","pano",typeof m.image=="string"?m.image:m.image.src))},updatePeekMode:function(){var v=this.el,m=this.sphereEl;this.data.peekMode?(this.hideAll(),v.getObject3D("mesh").visible=!1,m.setAttribute("visible",!0)):(this.showAll(),v.getObject3D("mesh").visible=!0,m.setAttribute("visible",!1))},play:function(){this.updateEventListener()},pause:function(){this.removeEventListener()},updateEventListener:function(){var v=this.el;!v.isPlaying||(this.removeEventListener(),v.addEventListener(this.data.on,this.navigate))},removeEventListener:function(){var v=this.data.on;!v||this.el.removeEventListener(v,this.navigate)},initVisualAspect:function(){var v=this.el,m,g,y;!this.data.visualAspectEnabled||this.visualAspectInitialized||(y=this.textEl=this.textEl||document.createElement("a-entity"),g=this.sphereEl=this.sphereEl||document.createElement("a-entity"),m=this.semiSphereEl=this.semiSphereEl||document.createElement("a-entity"),v.setAttribute("geometry",{primitive:"circle",radius:1,segments:64}),v.setAttribute("material",{shader:"portal",pano:this.data.image,side:"double"}),y.setAttribute("text",{color:this.data.titleColor,align:"center",font:"kelsonsans",value:this.data.title||this.data.href,width:4}),y.setAttribute("position","0 1.5 0"),v.appendChild(y),m.setAttribute("geometry",{primitive:"sphere",radius:1,phiStart:0,segmentsWidth:64,segmentsHeight:64,phiLength:180,thetaStart:0,thetaLength:360}),m.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),m.setAttribute("rotation","0 180 0"),m.setAttribute("position","0 0 0"),m.setAttribute("visible",!1),v.appendChild(m),g.setAttribute("geometry",{primitive:"sphere",radius:10,segmentsWidth:64,segmentsHeight:64}),g.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),g.setAttribute("visible",!1),v.appendChild(g),this.visualAspectInitialized=!0)},navigate:function(){window.location=this.data.href},tick:function(){var v=new f.Vector3,m=new f.Vector3,g=new f.Quaternion,y=new f.Vector3;return function(){var b=this.el,w=b.object3D,A=b.sceneEl.camera,M,S,E=this.textEl;if(!!this.data.visualAspectEnabled)if(w.updateMatrixWorld(),A.parent.updateMatrixWorld(),A.updateMatrixWorld(),w.matrix.decompose(m,g,y),m.setFromMatrixPosition(w.matrixWorld),v.setFromMatrixPosition(A.matrixWorld),S=m.distanceTo(v),S>20)this.previousQuaternion||(this.quaternionClone.copy(g),this.previousQuaternion=this.quaternionClone),w.lookAt(v);else{if(M=this.calculateCameraPortalOrientation(),S<.5){if(this.semiSphereEl.getAttribute("visible")===!0)return;E.setAttribute("text","width",1.5),M<=0?(E.setAttribute("position","0 0 0.75"),E.setAttribute("rotation","0 180 0"),this.semiSphereEl.setAttribute("rotation","0 0 0")):(E.setAttribute("position","0 0 -0.75"),E.setAttribute("rotation","0 0 0"),this.semiSphereEl.setAttribute("rotation","0 180 0")),b.getObject3D("mesh").visible=!1,this.semiSphereEl.setAttribute("visible",!0),this.peekCameraPortalOrientation=M}else M<=0?E.setAttribute("rotation","0 180 0"):E.setAttribute("rotation","0 0 0"),E.setAttribute("text","width",5),E.setAttribute("position","0 1.5 0"),b.getObject3D("mesh").visible=!0,this.semiSphereEl.setAttribute("visible",!1),this.peekCameraPortalOrientation=void 0;this.previousQuaternion&&(w.quaternion.copy(this.previousQuaternion),this.previousQuaternion=void 0)}}}(),hideAll:function(){var v=this.el,m=this.hiddenEls,g=this;m.length>0||v.sceneEl.object3D.traverse(function(y){y&&y.el&&y.el.hasAttribute("link-controls")||!y.el||y===v.sceneEl.object3D||y.el===v||y.el===g.sphereEl||y.el===v.sceneEl.cameraEl||y.el.getAttribute("visible")===!1||y.el===g.textEl||y.el===g.semiSphereEl||(y.el.setAttribute("visible",!1),m.push(y.el))})},showAll:function(){this.hiddenEls.forEach(function(v){v.setAttribute("visible",!0)}),this.hiddenEls=[]},calculateCameraPortalOrientation:function(){var v=new f.Matrix4,m=new f.Vector3,g=new f.Vector3(0,0,1),y=new f.Vector3(0,0,0);return function(){var b=this.el,w=b.sceneEl.camera;return m.set(0,0,0),g.set(0,0,1),y.set(0,0,0),b.object3D.matrixWorld.extractRotation(v),g.applyMatrix4(v),b.object3D.updateMatrixWorld(),b.object3D.localToWorld(y),w.parent.parent.updateMatrixWorld(),w.parent.updateMatrixWorld(),w.updateMatrixWorld(),w.localToWorld(m),m.sub(y).normalize(),g.normalize(),Math.sign(g.dot(m))}}(),remove:function(){this.removeEventListener()}}),u("portal",{schema:{borderEnabled:{default:1,type:"int",is:"uniform"},backgroundColor:{default:"red",type:"color",is:"uniform"},pano:{type:"map",is:"uniform"},strokeColor:{default:"white",type:"color",is:"uniform"}},vertexShader:["vec3 portalPosition;","varying vec3 vWorldPosition;","varying float vDistanceToCenter;","varying float vDistance;","void main() {","vDistanceToCenter = clamp(length(position - vec3(0.0, 0.0, 0.0)), 0.0, 1.0);","portalPosition = (modelMatrix * vec4(0.0, 0.0, 0.0, 1.0)).xyz;","vDistance = length(portalPosition - cameraPosition);","vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join(`
`),fragmentShader:["#define RECIPROCAL_PI2 0.15915494","uniform sampler2D pano;","uniform vec3 strokeColor;","uniform vec3 backgroundColor;","uniform float borderEnabled;","varying float vDistanceToCenter;","varying float vDistance;","varying vec3 vWorldPosition;","void main() {","vec3 direction = normalize(vWorldPosition - cameraPosition);","vec2 sampleUV;","float borderThickness = clamp(exp(-vDistance / 50.0), 0.6, 0.95);","sampleUV.y = clamp(direction.y * 0.5  + 0.5, 0.0, 1.0);","sampleUV.x = atan(direction.z, -direction.x) * -RECIPROCAL_PI2 + 0.5;","if (vDistanceToCenter > borderThickness && borderEnabled == 1.0) {","gl_FragColor = vec4(strokeColor, 1.0);","} else {","gl_FragColor = mix(texture2D(pano, sampleUV), vec4(backgroundColor, 1.0), clamp(pow((vDistance / 15.0), 2.0), 0.0, 1.0));","}","}"].join(`
`)})},{"../core/component":131,"../core/shader":141,"../lib/three":179}],90:[function(r,a,s){var o=r("../core/component").registerComponent,u=r("../lib/three"),f=r("../utils/"),v=f.bind,m=Math.PI/2;a.exports.Component=o("look-controls",{dependencies:["position","rotation"],schema:{enabled:{default:!0},magicWindowTrackingEnabled:{default:!0},pointerLockEnabled:{default:!1},reverseMouseDrag:{default:!1},reverseTouchDrag:{default:!1},touchEnabled:{default:!0},mouseEnabled:{default:!0}},init:function(){this.deltaYaw=0,this.previousHMDPosition=new u.Vector3,this.hmdQuaternion=new u.Quaternion,this.magicWindowAbsoluteEuler=new u.Euler,this.magicWindowDeltaEuler=new u.Euler,this.position=new u.Vector3,this.magicWindowObject=new u.Object3D,this.rotation={},this.deltaRotation={},this.savedPose=null,this.pointerLocked=!1,this.setupMouseControls(),this.bindMethods(),this.previousMouseEvent={},this.setupMagicWindowControls(),this.savedPose={position:new u.Vector3,rotation:new u.Euler},this.el.sceneEl.is("vr-mode")&&this.onEnterVR()},setupMagicWindowControls:function(){var g,y=this.data;f.device.isMobile()&&(g=this.magicWindowControls=new u.DeviceOrientationControls(this.magicWindowObject),typeof DeviceOrientationEvent!="undefined"&&DeviceOrientationEvent.requestPermission&&(g.enabled=!1,this.el.sceneEl.components["device-orientation-permission-ui"].permissionGranted?g.enabled=y.magicWindowTrackingEnabled:this.el.sceneEl.addEventListener("deviceorientationpermissiongranted",function(){g.enabled=y.magicWindowTrackingEnabled})))},update:function(g){var y=this.data;y.enabled!==g.enabled&&this.updateGrabCursor(y.enabled),g&&!y.magicWindowTrackingEnabled&&g.magicWindowTrackingEnabled&&(this.magicWindowAbsoluteEuler.set(0,0,0),this.magicWindowDeltaEuler.set(0,0,0)),this.magicWindowControls&&(this.magicWindowControls.enabled=y.magicWindowTrackingEnabled),g&&!y.pointerLockEnabled!==g.pointerLockEnabled&&(this.removeEventListeners(),this.addEventListeners(),this.pointerLocked&&this.exitPointerLock())},tick:function(g){var y=this.data;!y.enabled||this.updateOrientation()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.pointerLocked&&this.exitPointerLock()},remove:function(){this.removeEventListeners(),this.pointerLocked&&this.exitPointerLock()},bindMethods:function(){this.onMouseDown=v(this.onMouseDown,this),this.onMouseMove=v(this.onMouseMove,this),this.onMouseUp=v(this.onMouseUp,this),this.onTouchStart=v(this.onTouchStart,this),this.onTouchMove=v(this.onTouchMove,this),this.onTouchEnd=v(this.onTouchEnd,this),this.onEnterVR=v(this.onEnterVR,this),this.onExitVR=v(this.onExitVR,this),this.onPointerLockChange=v(this.onPointerLockChange,this),this.onPointerLockError=v(this.onPointerLockError,this)},setupMouseControls:function(){this.mouseDown=!1,this.pitchObject=new u.Object3D,this.yawObject=new u.Object3D,this.yawObject.position.y=10,this.yawObject.add(this.pitchObject)},addEventListeners:function(){var g=this.el.sceneEl,y=g.canvas;if(!y){g.addEventListener("render-target-loaded",v(this.addEventListeners,this));return}y.addEventListener("mousedown",this.onMouseDown,!1),window.addEventListener("mousemove",this.onMouseMove,!1),window.addEventListener("mouseup",this.onMouseUp,!1),y.addEventListener("touchstart",this.onTouchStart),window.addEventListener("touchmove",this.onTouchMove),window.addEventListener("touchend",this.onTouchEnd),g.addEventListener("enter-vr",this.onEnterVR),g.addEventListener("exit-vr",this.onExitVR),this.data.pointerLockEnabled&&(document.addEventListener("pointerlockchange",this.onPointerLockChange,!1),document.addEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.addEventListener("pointerlockerror",this.onPointerLockError,!1))},removeEventListeners:function(){var g=this.el.sceneEl,y=g&&g.canvas;!y||(y.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp),y.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd),g.removeEventListener("enter-vr",this.onEnterVR),g.removeEventListener("exit-vr",this.onExitVR),document.removeEventListener("pointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("pointerlockerror",this.onPointerLockError,!1))},updateOrientation:function(){var g=new u.Matrix4;return function(){var y=this.el.object3D,b=this.pitchObject,w=this.yawObject,A,M=this.el.sceneEl;if(M.is("vr-mode")&&M.checkHeadsetConnected()){M.hasWebXR&&(A=M.renderer.xr.getCameraPose(),A&&(g.elements=A.transform.matrix,g.decompose(y.position,y.rotation,y.scale)));return}this.updateMagicWindowOrientation(),y.rotation.x=this.magicWindowDeltaEuler.x+b.rotation.x,y.rotation.y=this.magicWindowDeltaEuler.y+w.rotation.y,y.rotation.z=this.magicWindowDeltaEuler.z}}(),updateMagicWindowOrientation:function(){var g=this.magicWindowAbsoluteEuler,y=this.magicWindowDeltaEuler;this.magicWindowControls&&this.magicWindowControls.enabled&&(this.magicWindowControls.update(),g.setFromQuaternion(this.magicWindowObject.quaternion,"YXZ"),!this.previousMagicWindowYaw&&g.y!==0&&(this.previousMagicWindowYaw=g.y),this.previousMagicWindowYaw&&(y.x=g.x,y.y+=g.y-this.previousMagicWindowYaw,y.z=g.z,this.previousMagicWindowYaw=g.y))},onMouseMove:function(g){var y,b,w,A=this.pitchObject,M=this.previousMouseEvent,S=this.yawObject;!this.data.enabled||!this.mouseDown&&!this.pointerLocked||(this.pointerLocked?(b=g.movementX||g.mozMovementX||0,w=g.movementY||g.mozMovementY||0):(b=g.screenX-M.screenX,w=g.screenY-M.screenY),this.previousMouseEvent.screenX=g.screenX,this.previousMouseEvent.screenY=g.screenY,y=this.data.reverseMouseDrag?1:-1,S.rotation.y+=b*.002*y,A.rotation.x+=w*.002*y,A.rotation.x=Math.max(-m,Math.min(m,A.rotation.x)))},onMouseDown:function(g){var y=this.el.sceneEl;if(!(!this.data.enabled||!this.data.mouseEnabled||y.is("vr-mode")&&y.checkHeadsetConnected())&&g.button===0){var b=y&&y.canvas;this.mouseDown=!0,this.previousMouseEvent.screenX=g.screenX,this.previousMouseEvent.screenY=g.screenY,this.showGrabbingCursor(),this.data.pointerLockEnabled&&!this.pointerLocked&&(b.requestPointerLock?b.requestPointerLock():b.mozRequestPointerLock&&b.mozRequestPointerLock())}},showGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor="grabbing"},hideGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor=""},onMouseUp:function(){this.mouseDown=!1,this.hideGrabbingCursor()},onTouchStart:function(g){g.touches.length!==1||!this.data.touchEnabled||this.el.sceneEl.is("vr-mode")||(this.touchStart={x:g.touches[0].pageX,y:g.touches[0].pageY},this.touchStarted=!0)},onTouchMove:function(g){var y,b=this.el.sceneEl.canvas,w,A=this.yawObject;!this.touchStarted||!this.data.touchEnabled||(w=2*Math.PI*(g.touches[0].pageX-this.touchStart.x)/b.clientWidth,y=this.data.reverseTouchDrag?1:-1,A.rotation.y-=w*.5*y,this.touchStart={x:g.touches[0].pageX,y:g.touches[0].pageY})},onTouchEnd:function(){this.touchStarted=!1},onEnterVR:function(){var g=this.el.sceneEl;!g.checkHeadsetConnected()||(this.saveCameraPose(),this.el.object3D.position.set(0,0,0),this.el.object3D.rotation.set(0,0,0),g.hasWebXR&&(this.el.object3D.matrixAutoUpdate=!1,this.el.object3D.updateMatrix()))},onExitVR:function(){!this.el.sceneEl.checkHeadsetConnected()||(this.restoreCameraPose(),this.previousHMDPosition.set(0,0,0),this.el.object3D.matrixAutoUpdate=!0)},onPointerLockChange:function(){this.pointerLocked=!!(document.pointerLockElement||document.mozPointerLockElement)},onPointerLockError:function(){this.pointerLocked=!1},exitPointerLock:function(){document.exitPointerLock(),this.pointerLocked=!1},updateGrabCursor:function(g){var y=this.el.sceneEl;function b(){y.canvas.classList.add("a-grab-cursor")}function w(){y.canvas.classList.remove("a-grab-cursor")}if(!y.canvas){g?y.addEventListener("render-target-loaded",b):y.addEventListener("render-target-loaded",w);return}if(g){b();return}w()},saveCameraPose:function(){var g=this.el;this.savedPose.position.copy(g.object3D.position),this.savedPose.rotation.copy(g.object3D.rotation),this.hasSavedPose=!0},restoreCameraPose:function(){var g=this.el,y=this.savedPose;!this.hasSavedPose||(g.object3D.position.copy(y.position),g.object3D.rotation.copy(y.rotation),this.hasSavedPose=!1)}})},{"../core/component":131,"../lib/three":179,"../utils/":205}],91:[function(r,a,s){var o=r("../utils/bind"),u=r("../core/component").registerComponent,f=r("../utils/tracked-controls"),v=f.checkControllerPresentAndSetup,m=f.emitIfAxesChanged,g=f.onButtonEvent,y="magicleap",b="-one",w=y+b,A="https://cdn.aframe.io/controllers/magicleap/magicleap-one-controller.glb",M={axes:{touchpad:[0,1]},buttons:["trigger","grip","touchpad","menu"]};a.exports.Component=u("magicleap-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:M,init:function(){var S=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=o(this.onButtonChanged,this),this.onButtonDown=function(E){g(E.detail.id,"down",S)},this.onButtonUp=function(E){g(E.detail.id,"up",S)},this.onButtonTouchEnd=function(E){g(E.detail.id,"touchend",S)},this.onButtonTouchStart=function(E){g(E.detail.id,"touchstart",S)},this.previousButtonValues={},this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},update:function(){var S=this.data;this.controllerIndex=S.hand==="right"?0:S.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=o(this.onModelLoaded,this),this.onControllersUpdate=o(this.onControllersUpdate,this),this.checkIfControllerPresent=o(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=o(this.removeControllersUpdateListener,this),this.onAxisMoved=o(this.onAxisMoved,this)},addEventListeners:function(){var S=this.el;S.addEventListener("buttonchanged",this.onButtonChanged),S.addEventListener("buttondown",this.onButtonDown),S.addEventListener("buttonup",this.onButtonUp),S.addEventListener("touchstart",this.onButtonTouchStart),S.addEventListener("touchend",this.onButtonTouchEnd),S.addEventListener("axismove",this.onAxisMoved),S.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var S=this.el;S.removeEventListener("buttonchanged",this.onButtonChanged),S.removeEventListener("buttondown",this.onButtonDown),S.removeEventListener("buttonup",this.onButtonUp),S.removeEventListener("touchstart",this.onButtonTouchStart),S.removeEventListener("touchend",this.onButtonTouchEnd),S.removeEventListener("axismove",this.onAxisMoved),S.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var S=this.data;v(this,w,{index:this.controllerIndex,hand:S.hand})},injectTrackedControls:function(){var S=this.el,E=this.data;S.setAttribute("tracked-controls",{idPrefix:w,hand:E.hand,controller:this.controllerIndex,orientationOffset:E.orientationOffset}),!!this.data.model&&this.el.setAttribute("gltf-model",A)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(S){var E=this.mapping.buttons[S.detail.id],T;!E||(E==="trigger"&&(T=S.detail.state.value,console.log("analog value of trigger press: "+T)),this.el.emit(E+"changed",S.detail.state))},onModelLoaded:function(S){var E=S.detail.model;E.scale.set(.01,.01,.01)},onAxisMoved:function(S){m(this,this.mapping.axes,S)},updateModel:function(S,E){},setButtonColor:function(S,E){}})},{"../core/component":131,"../utils/bind":199,"../utils/tracked-controls":214}],92:[function(r,a,s){var o=r("../utils/"),u=r("../core/component"),f=r("../lib/three"),v=r("../core/shader"),m=o.debug("components:material:error"),g=u.registerComponent,y=v.shaders,b=v.shaderNames;a.exports.Component=g("material",{schema:{alphaTest:{default:0,min:0,max:1},depthTest:{default:!0},depthWrite:{default:!0},flatShading:{default:!1},npot:{default:!1},offset:{type:"vec2",default:{x:0,y:0}},opacity:{default:1,min:0,max:1},repeat:{type:"vec2",default:{x:1,y:1}},shader:{default:"standard",oneOf:b,schemaChange:!0},side:{default:"front",oneOf:["front","back","double"]},transparent:{default:!1},vertexColors:{type:"string",default:"none",oneOf:["face","vertex"]},visible:{default:!0},blending:{default:"normal",oneOf:["none","normal","additive","subtractive","multiply"]},dithering:{default:!0}},init:function(){this.material=null},update:function(E){var T=this.data;(!this.shader||T.shader!==E.shader)&&this.updateShader(T.shader),this.shader.update(this.data),this.updateMaterial(E)},updateSchema:function(E){var T,C,L,P;C=E&&E.shader,T=this.oldData&&this.oldData.shader,P=C||T,L=y[P]&&y[P].schema,L||m("Unknown shader schema "+P),!(T&&C===T)&&(this.extendSchema(L),this.updateBehavior())},updateBehavior:function(){var E,T=this.el.sceneEl,C=this.schema,L=this,P;function N(F,X){var Y;for(Y in P)P[Y]=F;L.shader.update(P)}this.tick=void 0,P={};for(E in C)C[E].type==="time"&&(this.tick=N,P[E]=!0);!T||(this.tick?T.addBehavior(this):T.removeBehavior(this))},updateShader:function(E){var T=this.data,C=y[E]&&y[E].Shader,L;if(!C)throw new Error("Unknown shader "+E);L=this.shader=new C,L.el=this.el,L.init(T),this.setMaterial(L.material),this.updateSchema(T)},updateMaterial:function(E){var T=this.data,C=this.material,L;C.alphaTest=T.alphaTest,C.depthTest=T.depthTest!==!1,C.depthWrite=T.depthWrite!==!1,C.opacity=T.opacity,C.flatShading=T.flatShading,C.side=w(T.side),C.transparent=T.transparent!==!1||T.opacity<1,C.vertexColors=A(T.vertexColors),C.visible=T.visible,C.blending=M(T.blending),C.dithering=T.dithering;for(L in E)break;L&&(E.alphaTest!==T.alphaTest||E.side!==T.side||E.vertexColors!==T.vertexColors)&&(C.needsUpdate=!0)},remove:function(){var E=new f.MeshBasicMaterial,T=this.material,C=this.el.getObject3D("mesh");C&&(C.material=E),S(T,this.system)},setMaterial:function(E){var T=this.el,C,L=this.system;this.material&&S(this.material,L),this.material=E,L.registerMaterial(E),C=T.getObject3D("mesh"),C?C.material=E:T.addEventListener("object3dset",function P(N){N.detail.type!=="mesh"||N.target!==T||(T.getObject3D("mesh").material=E,T.removeEventListener("object3dset",P))})}});function w(E){switch(E){case"back":return f.BackSide;case"double":return f.DoubleSide;default:return f.FrontSide}}function A(E){switch(E){case"face":return f.FaceColors;case"vertex":return f.VertexColors;default:return f.NoColors}}function M(E){switch(E){case"none":return f.NoBlending;case"additive":return f.AdditiveBlending;case"subtractive":return f.SubtractiveBlending;case"multiply":return f.MultiplyBlending;default:return f.NormalBlending}}function S(E,T){E.dispose(),T.unregisterMaterial(E)}},{"../core/component":131,"../core/shader":141,"../lib/three":179,"../utils/":205}],93:[function(r,a,s){var o=r("../utils/debug"),u=r("../core/component").registerComponent,f=r("../lib/three"),v=o("components:obj-model:warn");a.exports.Component=u("obj-model",{schema:{mtl:{type:"model"},obj:{type:"model"}},init:function(){var m=this;this.model=null,this.objLoader=new f.OBJLoader,this.mtlLoader=new f.MTLLoader(this.objLoader.manager),this.mtlLoader.crossOrigin="",this.el.addEventListener("componentinitialized",function(g){!m.model||g.detail.name==="material"&&m.applyMaterial()})},update:function(){var m=this.data;!m.obj||(this.resetMesh(),this.loadObj(m.obj,m.mtl))},remove:function(){!this.model||this.resetMesh()},resetMesh:function(){this.el.removeObject3D("mesh")},loadObj:function(m,g){var y=this,b=this.el,w=this.mtlLoader,A=this.objLoader,M=this.el.sceneEl.systems.renderer,S=g.substr(0,g.lastIndexOf("/")+1);if(g){b.hasAttribute("material")&&v("Material component properties are ignored when a .MTL is provided"),w.setResourcePath(S),w.load(g,function(E){E.preload(),A.setMaterials(E),A.load(m,function(T){y.model=T,y.model.traverse(function(C){if(C.isMesh){var L=C.material;L.color&&M.applyColorCorrection(L.color),L.map&&M.applyColorCorrection(L.map),L.emissive&&M.applyColorCorrection(L.emissive),L.emissiveMap&&M.applyColorCorrection(L.emissiveMap)}}),b.setObject3D("mesh",T),b.emit("model-loaded",{format:"obj",model:T})})});return}A.load(m,function(T){y.model=T,y.applyMaterial(),b.setObject3D("mesh",T),b.emit("model-loaded",{format:"obj",model:T})})},applyMaterial:function(){var m=this.el.components.material;!m||this.model.traverse(function(g){g instanceof f.Mesh&&(g.material=m.material)})}})},{"../core/component":131,"../lib/three":179,"../utils/debug":201}],94:[function(r,a,s){var o=r("../core/component").registerComponent,u=r("../utils/bind"),f=r("../utils/tracked-controls"),v=f.checkControllerPresentAndSetup,m=f.emitIfAxesChanged,g=f.onButtonEvent,y=r("../utils/").device.isWebXRAvailable,b="oculus-go",w="Oculus Go",A="https://cdn.aframe.io/controllers/oculus/go/oculus-go-controller.gltf",M=y?b:w,S={axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},E={axes:{touchpad:[0,1]},buttons:["trigger","none","touchpad"]},T=y?E:S;a.exports.Component=o("oculus-go-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#FFFFFF"},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:T,bindMethods:function(){this.onModelLoaded=u(this.onModelLoaded,this),this.onControllersUpdate=u(this.onControllersUpdate,this),this.checkIfControllerPresent=u(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=u(this.removeControllersUpdateListener,this),this.onAxisMoved=u(this.onAxisMoved,this)},init:function(){var C=this;this.onButtonChanged=u(this.onButtonChanged,this),this.onButtonDown=function(L){g(L.detail.id,"down",C)},this.onButtonUp=function(L){g(L.detail.id,"up",C)},this.onButtonTouchStart=function(L){g(L.detail.id,"touchstart",C)},this.onButtonTouchEnd=function(L){g(L.detail.id,"touchend",C)},this.controllerPresent=!1,this.lastControllerCheck=0,this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},addEventListeners:function(){var C=this.el;C.addEventListener("buttonchanged",this.onButtonChanged),C.addEventListener("buttondown",this.onButtonDown),C.addEventListener("buttonup",this.onButtonUp),C.addEventListener("touchstart",this.onButtonTouchStart),C.addEventListener("touchend",this.onButtonTouchEnd),C.addEventListener("model-loaded",this.onModelLoaded),C.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var C=this.el;C.removeEventListener("buttonchanged",this.onButtonChanged),C.removeEventListener("buttondown",this.onButtonDown),C.removeEventListener("buttonup",this.onButtonUp),C.removeEventListener("touchstart",this.onButtonTouchStart),C.removeEventListener("touchend",this.onButtonTouchEnd),C.removeEventListener("model-loaded",this.onModelLoaded),C.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){v(this,M,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var C=this.el,L=this.data;C.setAttribute("tracked-controls",{armModel:L.armModel,hand:L.hand,idPrefix:M,orientationOffset:L.orientationOffset}),!!this.data.model&&this.el.setAttribute("gltf-model",A)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(C){var L=C.detail.model,P;!this.data.model||(P=this.buttonMeshes={},P.trigger=L.getObjectByName("oculus_go_button_trigger"),P.trackpad=L.getObjectByName("oculus_go_touchpad"),P.touchpad=L.getObjectByName("oculus_go_touchpad"))},onButtonChanged:function(C){var L=this.mapping.buttons[C.detail.id];!L||this.el.emit(L+"changed",C.detail.state)},onAxisMoved:function(C){m(this,this.mapping.axes,C)},updateModel:function(C,L){!this.data.model||this.updateButtonModel(C,L)},updateButtonModel:function(C,L){var P=this.buttonMeshes;if(!(!P||!P[C])){var N,F;switch(L){case"down":N=this.data.buttonHighlightColor;break;case"touchstart":N=this.data.buttonTouchedColor;break;default:N=this.data.buttonColor}F=P[C],F.material.color.set(N),this.rendererSystem.applyColorCorrection(F.material.color)}}})},{"../core/component":131,"../utils/":205,"../utils/bind":199,"../utils/tracked-controls":214}],95:[function(r,a,s){var o=r("../utils/bind"),u=r("../core/component").registerComponent,f=r("../lib/three"),v=r("../utils/tracked-controls"),m=v.checkControllerPresentAndSetup,g=v.emitIfAxesChanged,y=v.onButtonEvent,b=r("../utils/").device.isWebXRAvailable,w="oculus-touch",A="Oculus Touch",M=b?w:A,S="https://cdn.aframe.io/controllers/oculus/oculus-touch-controller-",E={left:{modelUrl:S+"left.gltf",rayOrigin:{origin:{x:.008,y:-.01,z:0},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new f.Vector3(-.005,.003,-.055),modelPivotRotation:new f.Euler(0,0,0)},right:{modelUrl:S+"right.gltf",rayOrigin:{origin:{x:-.008,y:-.01,z:0},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new f.Vector3(.005,.003,-.055),modelPivotRotation:new f.Euler(0,0,0)}},T={left:{modelUrl:S+"left.gltf",rayOrigin:{origin:{x:.002,y:-.005,z:-.03},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new f.Vector3(-.005,.036,-.037),modelPivotRotation:new f.Euler(Math.PI/4.5,0,0)},right:{modelUrl:S+"right.gltf",rayOrigin:{origin:{x:-.002,y:-.005,z:-.03},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new f.Vector3(.005,.036,-.037),modelPivotRotation:new f.Euler(Math.PI/4.5,0,0)}},C=b?T:E,L="oculus-touch",P={"oculus-touch":C,"oculus-touch-v2":{left:{modelUrl:S+"gen2-left.gltf",rayOrigin:{origin:{x:-.01,y:0,z:-.02},direction:{x:0,y:-.5,z:-1}},modelPivotOffset:new f.Vector3(0,0,0),modelPivotRotation:new f.Euler(0,0,0)},right:{modelUrl:S+"gen2-right.gltf",rayOrigin:{origin:{x:.01,y:0,z:-.02},direction:{x:0,y:-.5,z:-1}},modelPivotOffset:new f.Vector3(0,0,0),modelPivotRotation:new f.Euler(0,0,0)}},"oculus-touch-v3":{left:{modelUrl:S+"v3-left.glb",rayOrigin:{origin:{x:.015,y:.005,z:0},direction:{x:0,y:0,z:-1}},modelPivotOffset:new f.Vector3(.01,-.01,.05),modelPivotRotation:new f.Euler(Math.PI/4,0,0)},right:{modelUrl:S+"v3-right.glb",rayOrigin:{origin:{x:-.015,y:.005,z:0},direction:{x:0,y:0,z:-1}},modelPivotOffset:new f.Vector3(-.01,-.01,.05),modelPivotRotation:new f.Euler(Math.PI/4,0,0)}}},N={left:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","xbutton","ybutton","surface"]},right:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","abutton","bbutton","surface"]}},F={left:{axes:{thumbstick:[2,3]},buttons:["trigger","grip","none","thumbstick","xbutton","ybutton","surface"]},right:{axes:{thumbstick:[2,3]},buttons:["trigger","grip","none","thumbstick","abutton","bbutton","surface"]}},X=b?F:N;a.exports.Component=u("oculus-touch-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#999"},buttonTouchColor:{type:"color",default:"#8AB"},buttonHighlightColor:{type:"color",default:"#2DF"},model:{default:!0},controllerType:{default:"auto",oneOf:["auto","oculus-touch","oculus-touch-v2","oculus-touch-v3"]},orientationOffset:{type:"vec3",default:{x:43,y:0,z:0}}},mapping:X,bindMethods:function(){this.onModelLoaded=o(this.onModelLoaded,this),this.onControllersUpdate=o(this.onControllersUpdate,this),this.checkIfControllerPresent=o(this.checkIfControllerPresent,this),this.onAxisMoved=o(this.onAxisMoved,this)},init:function(){var Y=this;this.onButtonChanged=o(this.onButtonChanged,this),this.onButtonDown=function(ae){y(ae.detail.id,"down",Y,Y.data.hand)},this.onButtonUp=function(ae){y(ae.detail.id,"up",Y,Y.data.hand)},this.onButtonTouchStart=function(ae){y(ae.detail.id,"touchstart",Y,Y.data.hand)},this.onButtonTouchEnd=function(ae){y(ae.detail.id,"touchend",Y,Y.data.hand)},this.controllerPresent=!1,this.lastControllerCheck=0,this.previousButtonValues={},this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},addEventListeners:function(){var Y=this.el;Y.addEventListener("buttonchanged",this.onButtonChanged),Y.addEventListener("buttondown",this.onButtonDown),Y.addEventListener("buttonup",this.onButtonUp),Y.addEventListener("touchstart",this.onButtonTouchStart),Y.addEventListener("touchend",this.onButtonTouchEnd),Y.addEventListener("axismove",this.onAxisMoved),Y.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var Y=this.el;Y.removeEventListener("buttonchanged",this.onButtonChanged),Y.removeEventListener("buttondown",this.onButtonDown),Y.removeEventListener("buttonup",this.onButtonUp),Y.removeEventListener("touchstart",this.onButtonTouchStart),Y.removeEventListener("touchend",this.onButtonTouchEnd),Y.removeEventListener("axismove",this.onAxisMoved),Y.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){m(this,M,{hand:this.data.hand})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},loadModel:function(Y){var ae=this.data,$;if(!!ae.model){if(this.displayModel=P[ae.controllerType]||P[L],ae.controllerType==="auto"){var de=this.el.sceneEl.systems["tracked-controls-webvr"];if(de&&de.vrDisplay){var D=de.vrDisplay.displayName;/^Oculus Quest$/.test(D)&&(this.displayModel=P["oculus-touch-v2"])}else $=L,$=Y.profiles.indexOf("oculus-touch-v2")!==-1?"oculus-touch-v2":$,$=Y.profiles.indexOf("oculus-touch-v3")!==-1?"oculus-touch-v3":$,this.displayModel=P[$]}var I=this.displayModel[ae.hand].modelUrl;this.el.setAttribute("gltf-model",I)}},injectTrackedControls:function(Y){var ae=this.data,$=w,de=ae.hand==="right"?"Oculus Touch (Right)":"Oculus Touch (Left)",D=b?$:de;this.el.setAttribute("tracked-controls",{id:D,hand:ae.hand,orientationOffset:ae.orientationOffset,handTrackingEnabled:!1}),this.loadModel(Y)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(Y){var ae=this.mapping[this.data.hand].buttons[Y.detail.id],$=this.buttonMeshes,de;!ae||((ae==="trigger"||ae==="grip")&&(de=Y.detail.state.value),$&&(ae==="trigger"&&$.trigger&&($.trigger.rotation.x=this.originalXRotationTrigger-de*(Math.PI/26)),ae==="grip"&&$.grip&&($.grip.position.x=this.originalXPositionGrip+(this.data.hand==="left"?-1:1)*de*.004)),this.el.emit(ae+"changed",Y.detail.state))},onModelLoaded:function(Y){var ae=this.controllerObject3D=Y.detail.model,$;!this.data.model||($=this.buttonMeshes={},$.grip=ae.getObjectByName("buttonHand"),this.originalXPositionGrip=$.grip&&$.grip.position.x,$.thumbstick=ae.getObjectByName("stick"),$.trigger=ae.getObjectByName("buttonTrigger"),this.originalXRotationTrigger=$.trigger&&$.trigger.rotation.x,$.xbutton=ae.getObjectByName("buttonX"),$.abutton=ae.getObjectByName("buttonA"),$.ybutton=ae.getObjectByName("buttonY"),$.bbutton=ae.getObjectByName("buttonB"),ae.position.copy(this.displayModel[this.data.hand].modelPivotOffset),ae.rotation.copy(this.displayModel[this.data.hand].modelPivotRotation),this.el.emit("controllermodelready",{name:"oculus-touch-controls",model:this.data.model,rayOrigin:this.displayModel[this.data.hand].rayOrigin}))},onAxisMoved:function(Y){g(this,this.mapping[this.data.hand].axes,Y)},updateModel:function(Y,ae){!this.data.model||this.updateButtonModel(Y,ae)},updateButtonModel:function(Y,ae){var $,de=ae==="up"||ae==="touchend"?this.data.buttonColor:ae==="touchstart"?this.data.buttonTouchColor:this.data.buttonHighlightColor,D=this.buttonMeshes;!this.data.model||D&&D[Y]&&($=D[Y],$.material.color.set(de),this.rendererSystem.applyColorCorrection($.material.color))}})},{"../core/component":131,"../lib/three":179,"../utils/":205,"../utils/bind":199,"../utils/tracked-controls":214}],96:[function(r,a,s){var o=r("../core/component").registerComponent;a.exports.Component=o("position",{schema:{type:"vec3"},update:function(){var u=this.el.object3D,f=this.data;u.position.set(f.x,f.y,f.z)},remove:function(){this.el.object3D.position.set(0,0,0)}})},{"../core/component":131}],97:[function(r,a,s){var o=r("../core/component").registerComponent,u=r("../lib/three"),f=r("../utils/"),v=f.debug("components:raycaster:warn"),m=/^[\w\s-.,[\]#]*$/,g={childList:!0,attributes:!0,subtree:!0},y={INTERSECT:"raycaster-intersected",INTERSECTION:"raycaster-intersection",INTERSECT_CLEAR:"raycaster-intersected-cleared",INTERSECTION_CLEAR:"raycaster-intersection-cleared"};a.exports.Component=o("raycaster",{schema:{autoRefresh:{default:!0},direction:{type:"vec3",default:{x:0,y:0,z:-1}},enabled:{default:!0},far:{default:1e3},interval:{default:0},near:{default:0},objects:{default:""},origin:{type:"vec3"},showLine:{default:!1},lineColor:{default:"white"},lineOpacity:{default:1},useWorldCoordinates:{default:!1}},multiple:!0,init:function(){this.clearedIntersectedEls=[],this.unitLineEndVec3=new u.Vector3,this.intersectedEls=[],this.intersections=[],this.newIntersectedEls=[],this.newIntersections=[],this.objects=[],this.prevCheckTime=void 0,this.prevIntersectedEls=[],this.rawIntersections=[],this.raycaster=new u.Raycaster,this.updateOriginDirection(),this.setDirty=this.setDirty.bind(this),this.updateLine=this.updateLine.bind(this),this.observer=new MutationObserver(this.setDirty),this.dirty=!0,this.lineEndVec3=new u.Vector3,this.otherLineEndVec3=new u.Vector3,this.lineData={end:this.lineEndVec3},this.getIntersection=this.getIntersection.bind(this),this.intersectedDetail={el:this.el,getIntersection:this.getIntersection},this.intersectedClearedDetail={el:this.el},this.intersectionClearedDetail={clearedEls:this.clearedIntersectedEls},this.intersectionDetail={}},update:function(w){var A=this.data,M=this.el,S=this.raycaster;S.far=A.far,S.near=A.near,A.showLine&&(A.far!==w.far||A.origin!==w.origin||A.direction!==w.direction||!w.showLine)&&(this.unitLineEndVec3.copy(A.origin).add(A.direction).normalize(),this.drawLine()),!A.showLine&&w.showLine&&M.removeAttribute("line"),A.objects!==w.objects&&!m.test(A.objects)&&v('[raycaster] Selector "'+A.objects+'" may not update automatically with DOM changes.'),A.objects||v('[raycaster] For performance, please define raycaster.objects when using raycaster or cursor components to whitelist which entities to intersect with. e.g., raycaster="objects: [data-raycastable]".'),A.autoRefresh!==w.autoRefresh&&M.isPlaying&&(A.autoRefresh?this.addEventListeners():this.removeEventListeners()),w.enabled&&!A.enabled&&this.clearAllIntersections(),this.setDirty()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){this.data.showLine&&this.el.removeAttribute("line"),this.clearAllIntersections()},addEventListeners:function(){!this.data.autoRefresh||(this.observer.observe(this.el.sceneEl,g),this.el.sceneEl.addEventListener("object3dset",this.setDirty),this.el.sceneEl.addEventListener("object3dremove",this.setDirty))},removeEventListeners:function(){this.observer.disconnect(),this.el.sceneEl.removeEventListener("object3dset",this.setDirty),this.el.sceneEl.removeEventListener("object3dremove",this.setDirty)},setDirty:function(){this.dirty=!0},refreshObjects:function(){var w=this.data,A;A=w.objects?this.el.sceneEl.querySelectorAll(w.objects):this.el.sceneEl.querySelectorAll("*"),this.objects=this.flattenObject3DMaps(A),this.dirty=!1},tock:function(w){var A=this.data,M=this.prevCheckTime;!A.enabled||M&&w-M<A.interval||(this.prevCheckTime=w,this.checkIntersections())},checkIntersections:function(){var w=this.clearedIntersectedEls,A=this.el,M=this.data,S,E=this.intersectedEls,T,C=this.intersections,L=this.newIntersectedEls,P=this.newIntersections,N=this.prevIntersectedEls,F=this.rawIntersections;for(this.dirty&&this.refreshObjects(),b(this.prevIntersectedEls,this.intersectedEls),this.updateOriginDirection(),F.length=0,this.raycaster.intersectObjects(this.objects,!0,F),C.length=0,E.length=0,S=0;S<F.length;S++)T=F[S],!(M.showLine&&T.object===A.getObject3D("line"))&&T.object.el&&(C.push(T),E.push(T.object.el));for(P.length=0,L.length=0,S=0;S<C.length;S++)N.indexOf(C[S].object.el)===-1&&(P.push(C[S]),L.push(C[S].object.el));for(w.length=0,S=0;S<N.length;S++)E.indexOf(N[S])===-1&&(N[S].emit(y.INTERSECT_CLEAR,this.intersectedClearedDetail),w.push(N[S]));for(w.length&&A.emit(y.INTERSECTION_CLEAR,this.intersectionClearedDetail),S=0;S<L.length;S++)L[S].emit(y.INTERSECT,this.intersectedDetail);P.length&&(this.intersectionDetail.els=L,this.intersectionDetail.intersections=P,A.emit(y.INTERSECTION,this.intersectionDetail)),M.showLine&&setTimeout(this.updateLine)},updateLine:function(){var w=this.el,A=this.intersections,M;A.length&&(A[0].object.el===w&&A[1]?M=A[1].distance:M=A[0].distance),this.drawLine(M)},getIntersection:function(w){var A,M;for(A=0;A<this.intersections.length;A++)if(M=this.intersections[A],M.object.el===w)return M;return null},updateOriginDirection:function(){var w=new u.Vector3,A=new u.Vector3;return function(){var S=this.el,E=this.data;if(E.useWorldCoordinates){this.raycaster.set(E.origin,E.direction);return}S.object3D.updateMatrixWorld(),A.setFromMatrixPosition(S.object3D.matrixWorld),(E.origin.x!==0||E.origin.y!==0||E.origin.z!==0)&&(A=S.object3D.localToWorld(A.copy(E.origin))),w.copy(E.direction).transformDirection(S.object3D.matrixWorld).normalize(),this.raycaster.set(A,w)}}(),drawLine:function(w){var A=this.data,M=this.el,S;S=this.lineData.end===this.lineEndVec3?this.otherLineEndVec3:this.lineEndVec3,w===void 0&&(w=A.far===1/0?1e3:A.far),this.lineData.start=A.origin,this.lineData.end=S.copy(this.unitLineEndVec3).multiplyScalar(w),this.lineData.color=A.lineColor,this.lineData.opacity=A.lineOpacity,M.setAttribute("line",this.lineData)},flattenObject3DMaps:function(w){var A,M,S=this.objects;for(S.length=0,M=0;M<w.length;M++)if(w[M].isEntity&&w[M].object3D)for(A in w[M].object3DMap)S.push(w[M].getObject3D(A));return S},clearAllIntersections:function(){var w;for(w=0;w<this.intersectedEls.length;w++)this.intersectedEls[w].emit(y.INTERSECT_CLEAR,this.intersectedClearedDetail);b(this.clearedIntersectedEls,this.intersectedEls),this.intersectedEls.length=0,this.intersections.length=0,this.el.emit(y.INTERSECTION_CLEAR,this.intersectionClearedDetail)}});function b(w,A){var M;for(w.length=A.length,M=0;M<A.length;M++)w[M]=A[M]}},{"../core/component":131,"../lib/three":179,"../utils/":205}],98:[function(r,a,s){var o=r("../lib/three").Math.degToRad,u=r("../core/component").registerComponent;a.exports.Component=u("rotation",{schema:{type:"vec3"},update:function(){var f=this.data,v=this.el.object3D;v.rotation.set(o(f.x),o(f.y),o(f.z)),v.rotation.order="YXZ"},remove:function(){this.el.object3D.rotation.set(0,0,0)}})},{"../core/component":131,"../lib/three":179}],99:[function(r,a,s){var o=r("../core/component").registerComponent,u=1e-5;a.exports.Component=o("scale",{schema:{type:"vec3",default:{x:1,y:1,z:1}},update:function(){var f=this.data,v=this.el.object3D,m=f.x===0?u:f.x,g=f.y===0?u:f.y,y=f.z===0?u:f.z;v.scale.set(m,g,y)},remove:function(){this.el.object3D.scale.set(1,1,1)}})},{"../core/component":131}],100:[function(r,a,s){var o=r("../../core/component").registerComponent,u=r("../../core/component").components;a.exports.Component=o("background",{schema:{color:{type:"color",default:"black"},transparent:{default:!1}},update:function(){var f=this.data,v=this.el.object3D;if(f.transparent){v.background=null;return}v.background=new THREE.Color(f.color)},remove:function(){var f=this.data,v=this.el.object3D;if(f.transparent){v.background=null;return}v.background=u[this.name].schema.color.default}})},{"../../core/component":131}],101:[function(r,a,s){var o=r("../../core/component").registerComponent;a.exports.Component=o("debug",{schema:{default:!0}})},{"../../core/component":131}],102:[function(r,a,s){var o=r("../../core/component").registerComponent,u=r("../../utils/"),f=u.bind,v=r("../../constants/"),m="a-modal",g="a-dialog",y="a-dialog-text",b="a-dialog-text-container",w="a-dialog-buttons-container",A="a-dialog-button",M="a-dialog-allow-button",S="a-dialog-deny-button",E="a-dialog-ok-button";a.exports.Component=o("device-orientation-permission-ui",{schema:{enabled:{default:!0},deviceMotionMessage:{default:"This immersive website requires access to your device motion sensors."},mobileDesktopMessage:{default:"Set your browser to request the mobile version of the site and reload the page to enjoy immersive mode."},httpsMessage:{default:"Access this site over HTTPS to enter VR mode and grant access to the device sensors."},denyButtonText:{default:"Deny"},allowButtonText:{default:"Allow"},cancelButtonText:{default:"Cancel"}},init:function(){var P=this;if(!!this.data.enabled){if(location.hostname!=="localhost"&&location.hostname!=="127.0.0.1"&&location.protocol==="http:"&&this.showHTTPAlert(),u.device.isMobileDeviceRequestingDesktopSite()){this.showMobileDesktopModeAlert();return}if(typeof DeviceOrientationEvent=="undefined"||!DeviceOrientationEvent.requestPermission){this.permissionGranted=!0;return}this.onDeviceMotionDialogAllowClicked=f(this.onDeviceMotionDialogAllowClicked,this),this.onDeviceMotionDialogDenyClicked=f(this.onDeviceMotionDialogDenyClicked,this),DeviceOrientationEvent.requestPermission().catch(function(){P.devicePermissionDialogEl=T(P.data.denyButtonText,P.data.allowButtonText,P.data.deviceMotionMessage,P.onDeviceMotionDialogAllowClicked,P.onDeviceMotionDialogDenyClicked),P.el.appendChild(P.devicePermissionDialogEl)}).then(function(){P.el.emit("deviceorientationpermissiongranted"),P.permissionGranted=!0})}},remove:function(){this.devicePermissionDialogEl&&this.el.removeChild(this.devicePermissionDialogEl)},onDeviceMotionDialogDenyClicked:function(){this.remove()},showMobileDesktopModeAlert:function(){var P=this,N=C(P.data.cancelButtonText,P.data.mobileDesktopMessage,function(){P.el.removeChild(N)});this.el.appendChild(N)},showHTTPAlert:function(){var P=this,N=C(P.data.cancelButtonText,P.data.httpsMessage,function(){P.el.removeChild(N)});this.el.appendChild(N)},onDeviceMotionDialogAllowClicked:function(){var P=this;this.el.emit("deviceorientationpermissionrequested"),DeviceOrientationEvent.requestPermission().then(function(N){N==="granted"?(P.el.emit("deviceorientationpermissiongranted"),P.permissionGranted=!0):P.el.emit("deviceorientationpermissionrejected"),P.remove()}).catch(console.error)}});function T(P,N,F,X,Y){var ae,$,de;return ae=document.createElement("div"),ae.classList.add(w),$=document.createElement("button"),$.classList.add(A,S),$.setAttribute(v.AFRAME_INJECTED,""),$.innerHTML=P,ae.appendChild($),de=document.createElement("button"),de.classList.add(A,M),de.setAttribute(v.AFRAME_INJECTED,""),de.innerHTML=N,ae.appendChild(de),de.addEventListener("click",function(D){D.stopPropagation(),X()}),$.addEventListener("click",function(D){D.stopPropagation(),Y()}),L(F,ae)}function C(P,N,F){var X,Y;return X=document.createElement("div"),X.classList.add(w),Y=document.createElement("button"),Y.classList.add(A,E),Y.setAttribute(v.AFRAME_INJECTED,""),Y.innerHTML=P,X.appendChild(Y),Y.addEventListener("click",function(ae){ae.stopPropagation(),F()}),L(N,X)}function L(P,N){var F,X,Y,ae;return F=document.createElement("div"),F.classList.add(m),F.setAttribute(v.AFRAME_INJECTED,""),X=document.createElement("div"),X.className=g,X.setAttribute(v.AFRAME_INJECTED,""),F.appendChild(X),Y=document.createElement("div"),Y.classList.add(b),X.appendChild(Y),ae=document.createElement("div"),ae.classList.add(y),ae.innerHTML=P,Y.appendChild(ae),X.appendChild(N),F}},{"../../constants/":123,"../../core/component":131,"../../utils/":205}],103:[function(r,a,s){var o=r("../../core/component").registerComponent;a.exports.Component=o("embedded",{dependencies:["vr-mode-ui"],schema:{default:!0},update:function(){var u=this.el,f=u.querySelector(".a-enter-vr");this.data===!0?(f&&f.classList.add("embedded"),u.removeFullScreenStyles()):(f&&f.classList.remove("embedded"),u.addFullScreenStyles())}})},{"../../core/component":131}],104:[function(r,a,s){var o=r("../../core/component").registerComponent,u=r("../../lib/three"),f=r("../../utils/debug"),v=f("components:fog:warn");a.exports.Component=o("fog",{schema:{color:{type:"color",default:"#000"},density:{default:25e-5},far:{default:1e3,min:0},near:{default:1,min:0},type:{default:"linear",oneOf:["linear","exponential"]}},update:function(){var g=this.data,y=this.el,b=this.el.object3D.fog;if(!y.isScene){v("Fog component can only be applied to <a-scene>");return}if(!b||g.type!==b.name){y.object3D.fog=m(g),y.systems.material.updateMaterials();return}Object.keys(this.schema).forEach(function(w){var A=g[w];w==="color"&&(A=new u.Color(A)),b[w]=A})},remove:function(){var g=this.el.object3D.fog;!g||(g.far=0,g.near=.1)}});function m(g){var y;return g.type==="exponential"?y=new u.FogExp2(g.color,g.density):y=new u.Fog(g.color,g.near,g.far),y.name=g.type,y}},{"../../core/component":131,"../../lib/three":179,"../../utils/debug":201}],105:[function(r,a,s){(function(o){var u=r("../../constants").AFRAME_INJECTED,f=r("../../../package"),v=r("../../core/component").registerComponent,m=r("../../utils/");function g(M){var S=M.split(".");return S[2]="x",S.join(".")}var y="https://unpkg.com/aframe-inspector@"+g(f.version)+"/dist/aframe-inspector.min.js",b=y,w="Loading Inspector",A="Error loading Inspector";a.exports.Component=v("inspector",{schema:{url:{default:b}},init:function(){this.firstPlay=!0,this.onKeydown=this.onKeydown.bind(this),this.onMessage=this.onMessage.bind(this),this.initOverlay(),window.addEventListener("keydown",this.onKeydown),window.addEventListener("message",this.onMessage)},play:function(){var M;!this.firstPlay||(M=m.getUrlParameter("inspector"),M!=="false"&&!!M&&(this.openInspector(),this.firstPlay=!1))},initOverlay:function(){var M='<span class="dots"><span>.</span><span>.</span><span>.</span></span>';this.loadingMessageEl=document.createElement("div"),this.loadingMessageEl.classList.add("a-inspector-loader"),this.loadingMessageEl.innerHTML=w+M},remove:function(){this.removeEventListeners()},onKeydown:function(M){var S=M.keyCode===73&&(M.ctrlKey&&M.altKey||M.getModifierState("AltGraph"));!S||this.openInspector()},showLoader:function(){document.body.appendChild(this.loadingMessageEl)},hideLoader:function(){document.body.removeChild(this.loadingMessageEl)},onMessage:function(M){M.data==="INJECT_AFRAME_INSPECTOR"&&this.openInspector()},openInspector:function(M){var S=this,E;if(AFRAME.INSPECTOR||AFRAME.inspectorInjected){AFRAME.INSPECTOR.open(M);return}this.showLoader(),E=document.createElement("script"),E.src=this.data.url,E.setAttribute("data-name","aframe-inspector"),E.setAttribute(u,""),E.onload=function(){AFRAME.INSPECTOR.open(M),S.hideLoader(),S.removeEventListeners()},E.onerror=function(){S.loadingMessageEl.innerHTML=A},document.head.appendChild(E),AFRAME.inspectorInjected=!0},removeEventListeners:function(){window.removeEventListener("keydown",this.onKeydown),window.removeEventListener("message",this.onMessage)}})}).call(this,r("_process"))},{"../../../package":73,"../../constants":123,"../../core/component":131,"../../utils/":205,_process:49}],106:[function(r,a,s){var o=r("../../core/component").registerComponent,u=r("../../utils/").shouldCaptureKeyEvent;a.exports.Component=o("keyboard-shortcuts",{schema:{enterVR:{default:!0},exitVR:{default:!0}},init:function(){this.onKeyup=this.onKeyup.bind(this)},update:function(f){var v=this.data;this.enterVREnabled=v.enterVR},play:function(){window.addEventListener("keyup",this.onKeyup,!1)},pause:function(){window.removeEventListener("keyup",this.onKeyup)},onKeyup:function(f){var v=this.el;!u(f)||(this.enterVREnabled&&f.keyCode===70&&v.enterVR(),this.enterVREnabled&&f.keyCode===27&&v.exitVR())}})},{"../../core/component":131,"../../utils/":205}],107:[function(r,a,s){var o=r("../../utils/debug"),u=r("../../core/component").registerComponent,f=o("components:pool:warn");a.exports.Component=u("pool",{schema:{container:{default:""},mixin:{default:""},size:{default:0},dynamic:{default:!1}},multiple:!0,initPool:function(){var v;for(this.availableEls=[],this.usedEls=[],this.data.mixin||f("No mixin provided for pool component."),this.data.container&&(this.container=document.querySelector(this.data.container),this.container||f("Container "+this.data.container+" not found.")),this.container=this.container||this.el,v=0;v<this.data.size;++v)this.createEntity()},update:function(v){var m=this.data;(v.mixin!==m.mixin||v.size!==m.size)&&this.initPool()},createEntity:function(){var v;v=document.createElement("a-entity"),v.play=this.wrapPlay(v.play),v.setAttribute("mixin",this.data.mixin),v.object3D.visible=!1,v.pause(),this.container.appendChild(v),this.availableEls.push(v)},wrapPlay:function(v){var m=this.usedEls;return function(){m.indexOf(this)!==-1&&v.call(this)}},requestEntity:function(){var v;if(this.availableEls.length===0){if(this.data.dynamic===!1){f("Requested entity from empty pool: "+this.attrName);return}else f("Requested entity from empty pool. This pool is dynamic and will resize automatically. You might want to increase its initial size: "+this.attrName);this.createEntity()}return v=this.availableEls.shift(),this.usedEls.push(v),v.object3D.visible=!0,v},returnEntity:function(v){var m=this.usedEls.indexOf(v);if(m===-1){f("The returned entity was not previously pooled from "+this.attrName);return}return this.usedEls.splice(m,1),this.availableEls.push(v),v.object3D.visible=!1,v.pause(),v}})},{"../../core/component":131,"../../utils/debug":201}],108:[function(r,a,s){var o=r("../../core/component").registerComponent,u=r("../../lib/three"),f=["attribute vec3 position;","attribute vec2 uv;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUv;","void main()  {","  vUv = vec2( 1.- uv.x, uv.y );","  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),v=["precision mediump float;","uniform samplerCube map;","varying vec2 vUv;","#define M_PI 3.141592653589793238462643383279","void main() {","  vec2 uv = vUv;","  float longitude = uv.x * 2. * M_PI - M_PI + M_PI / 2.;","  float latitude = uv.y * M_PI;","  vec3 dir = vec3(","    - sin( longitude ) * sin( latitude ),","    cos( latitude ),","    - cos( longitude ) * sin( latitude )","  );","  normalize( dir );","  gl_FragColor = vec4( textureCube( map, dir ).rgb, 1.0 );","}"].join(`
`);a.exports.Component=o("screenshot",{schema:{width:{default:4096},height:{default:2048},camera:{type:"selector"}},init:function(){var m=this.el,g=this;m.renderer?y():m.addEventListener("render-target-loaded",y);function y(){var b=m.renderer.getContext();!b||(g.cubeMapSize=b.getParameter(b.MAX_CUBE_MAP_TEXTURE_SIZE),g.material=new u.RawShaderMaterial({uniforms:{map:{type:"t",value:null}},vertexShader:f,fragmentShader:v,side:u.DoubleSide}),g.quad=new u.Mesh(new u.PlaneBufferGeometry(1,1),g.material),g.quad.visible=!1,g.camera=new u.OrthographicCamera(-1/2,1/2,1/2,-1/2,-1e4,1e4),g.canvas=document.createElement("canvas"),g.ctx=g.canvas.getContext("2d"),m.object3D.add(g.quad),g.onKeyDown=g.onKeyDown.bind(g))}},getRenderTarget:function(m,g){return new u.WebGLRenderTarget(m,g,{minFilter:u.LinearFilter,magFilter:u.LinearFilter,wrapS:u.ClampToEdgeWrapping,wrapT:u.ClampToEdgeWrapping,format:u.RGBAFormat,type:u.UnsignedByteType})},resize:function(m,g){this.quad.scale.set(m,g,1),this.camera.left=-1*m/2,this.camera.right=m/2,this.camera.top=g/2,this.camera.bottom=-1*g/2,this.camera.updateProjectionMatrix(),this.canvas.width=m,this.canvas.height=g},play:function(){window.addEventListener("keydown",this.onKeyDown)},onKeyDown:function(m){var g=m.keyCode===83&&m.ctrlKey&&m.altKey;if(!(!this.data||!g)){var y=m.shiftKey?"equirectangular":"perspective";this.capture(y)}},setCapture:function(m){var g=this.el,y,b,w,A;return m==="perspective"?(this.quad.visible=!1,b=this.data.camera&&this.data.camera.components.camera.camera||g.camera,y={width:this.data.width,height:this.data.height}):(b=this.camera,A=new u.WebGLCubeRenderTarget(Math.min(this.cubeMapSize,2048),{format:u.RGBFormat,generateMipmaps:!0,minFilter:u.LinearMipmapLinearFilter,encoding:u.sRGBEncoding}),w=new u.CubeCamera(g.camera.near,g.camera.far,A),g.camera.getWorldPosition(w.position),g.camera.getWorldQuaternion(w.quaternion),w.update(g.renderer,g.object3D),this.quad.material.uniforms.map.value=w.renderTarget.texture,y={width:this.data.width,height:this.data.height},this.quad.visible=!0),{camera:b,size:y,projection:m}},capture:function(m){var g=this.el.renderer.xr.enabled,y=this.el.renderer,b;y.xr.enabled=!1,b=this.setCapture(m),this.renderCapture(b.camera,b.size,b.projection),this.saveCapture(),y.xr.enabled=g},getCanvas:function(m){var g=this.el.renderer.xr.enabled,y=this.el.renderer,b=this.setCapture(m);return y.xr.enabled=!1,this.renderCapture(b.camera,b.size,b.projection),y.xr.enabled=g,this.canvas},renderCapture:function(m,g,y){var b=this.el.renderer.autoClear,w=this.el,A,M,S,E=w.renderer;M=this.getRenderTarget(g.width,g.height),S=new Uint8Array(4*g.width*g.height),this.resize(g.width,g.height),E.autoClear=!0,E.clear(),E.setRenderTarget(M),E.render(w.object3D,m),E.autoClear=b,E.readRenderTargetPixels(M,0,0,g.width,g.height,S),E.setRenderTarget(null),y==="perspective"&&(S=this.flipPixelsVertically(S,g.width,g.height)),A=new ImageData(new Uint8ClampedArray(S),g.width,g.height),this.quad.visible=!1,this.ctx.putImageData(A,0,0)},flipPixelsVertically:function(m,g,y){for(var b=m.slice(0),w=0;w<g;++w)for(var A=0;A<y;++A)b[w*4+A*g*4]=m[w*4+(y-A)*g*4],b[w*4+1+A*g*4]=m[w*4+1+(y-A)*g*4],b[w*4+2+A*g*4]=m[w*4+2+(y-A)*g*4],b[w*4+3+A*g*4]=m[w*4+3+(y-A)*g*4];return b},saveCapture:function(){this.canvas.toBlob(function(m){var g="screenshot-"+document.title.toLowerCase()+"-"+Date.now()+".png",y=document.createElement("a"),b=URL.createObjectURL(m);y.href=b,y.setAttribute("download",g),y.innerHTML="downloading...",y.style.display="none",document.body.appendChild(y),setTimeout(function(){y.click(),document.body.removeChild(y)},1)},"image/png")}})},{"../../core/component":131,"../../lib/three":179}],109:[function(r,a,s){var o=r("../../core/component").registerComponent,u=r("../../../vendor/rStats"),f=r("../../utils");r("../../../vendor/rStats.extras"),r("../../lib/rStatsAframe");var v=window.aframeStats,m=f.bind,g="a-hidden",y=window.threeStats;a.exports.Component=o("stats",{schema:{default:!0},init:function(){var w=this.el;f.getUrlParameter("stats")!=="false"&&(this.stats=b(w),this.statsEl=document.querySelector(".rs-base"),this.hideBound=m(this.hide,this),this.showBound=m(this.show,this),w.addEventListener("enter-vr",this.hideBound),w.addEventListener("exit-vr",this.showBound))},update:function(){if(!!this.stats)return this.data?this.show():this.hide()},remove:function(){this.el.removeEventListener("enter-vr",this.hideBound),this.el.removeEventListener("exit-vr",this.showBound),!!this.statsEl&&this.statsEl.parentNode.removeChild(this.statsEl)},tick:function(){var w=this.stats;!w||(w("rAF").tick(),w("FPS").frame(),w().update())},hide:function(){this.statsEl.classList.add(g)},show:function(){this.statsEl.classList.remove(g)}});function b(w){var A=new y(w.renderer),M=new v(w),S=w.isMobile?[]:[A,M];return new u({css:[],values:{fps:{caption:"fps",below:30}},groups:[{caption:"Framerate",values:["fps","raf"]}],plugins:S})}},{"../../../vendor/rStats":217,"../../../vendor/rStats.extras":216,"../../core/component":131,"../../lib/rStatsAframe":178,"../../utils":205}],110:[function(r,a,s){var o=r("../../core/component").registerComponent,u=r("../../constants/"),f=r("../../utils/"),v=f.bind,m="a-enter-vr",g="a-enter-ar",y="a-enter-vr-button",b="a-enter-ar-button",w="a-hidden",A="a-orientation-modal";a.exports.Component=o("vr-mode-ui",{dependencies:["canvas"],schema:{enabled:{default:!0},enterVRButton:{default:""},enterARButton:{default:""}},init:function(){var C=this,L=this.el;f.getUrlParameter("ui")!=="false"&&(this.insideLoader=!1,this.enterVREl=null,this.enterAREl=null,this.orientationModalEl=null,this.bindMethods(),L.addEventListener("enter-vr",this.updateEnterInterfaces),L.addEventListener("exit-vr",this.updateEnterInterfaces),L.addEventListener("update-vr-devices",this.updateEnterInterfaces),window.addEventListener("message",function(P){P.data.type==="loaderReady"&&(C.insideLoader=!0,C.remove())}),window.addEventListener("orientationchange",this.toggleOrientationModalIfNeeded))},bindMethods:function(){this.onEnterVRButtonClick=v(this.onEnterVRButtonClick,this),this.onEnterARButtonClick=v(this.onEnterARButtonClick,this),this.onModalClick=v(this.onModalClick,this),this.toggleOrientationModalIfNeeded=v(this.toggleOrientationModalIfNeeded,this),this.updateEnterInterfaces=v(this.updateEnterInterfaces,this)},onModalClick:function(){this.el.exitVR()},onEnterVRButtonClick:function(){this.el.enterVR()},onEnterARButtonClick:function(){this.el.enterAR()},update:function(){var C=this.data,L=this.el;if(!C.enabled||this.insideLoader||f.getUrlParameter("ui")==="false")return this.remove();this.enterVREl||this.enterAREl||this.orientationModalEl||(C.enterVRButton?(this.enterVREl=document.querySelector(C.enterVRButton),this.enterVREl.addEventListener("click",this.onEnterVRButtonClick)):(this.enterVREl=M(this.onEnterVRButtonClick),L.appendChild(this.enterVREl)),C.enterARButton?(this.enterAREl=document.querySelector(C.enterARButton),this.enterAREl.addEventListener("click",this.onEnterARButtonClick)):(this.enterAREl=S(this.onEnterARButtonClick),L.appendChild(this.enterAREl)),this.orientationModalEl=E(this.onModalClick),L.appendChild(this.orientationModalEl),this.updateEnterInterfaces())},remove:function(){[this.enterVREl,this.enterAREl,this.orientationModalEl].forEach(function(C){C&&C.parentNode&&C.parentNode.removeChild(C)}),this.enterVREl=void 0,this.enterAREl=void 0,this.orientationModalEl=void 0},updateEnterInterfaces:function(){this.toggleEnterVRButtonIfNeeded(),this.toggleEnterARButtonIfNeeded(),this.toggleOrientationModalIfNeeded()},toggleEnterVRButtonIfNeeded:function(){var C=this.el;!this.enterVREl||(C.is("vr-mode")?this.enterVREl.classList.add(w):this.enterVREl.classList.remove(w))},toggleEnterARButtonIfNeeded:function(){var C=this.el;!this.enterAREl||(C.is("vr-mode")||!f.device.checkARSupport()?this.enterAREl.classList.add(w):this.enterAREl.classList.remove(w))},toggleOrientationModalIfNeeded:function(){var C=this.el,L=this.orientationModalEl;!L||!C.isMobile||(!f.device.isLandscape()&&C.is("vr-mode")?L.classList.remove(w):L.classList.add(w))}});function M(C){var L,P;return P=document.createElement("div"),P.classList.add(m),P.setAttribute(u.AFRAME_INJECTED,""),L=document.createElement("button"),L.className=y,L.setAttribute("title","Enter VR mode with a headset or fullscreen mode on a desktop. Visit https://webvr.rocks or https://webvr.info for more information."),L.setAttribute(u.AFRAME_INJECTED,""),f.device.isMobile()&&T(L),P.appendChild(L),L.addEventListener("click",function(N){C(),N.stopPropagation()}),P}function S(C){var L,P;return P=document.createElement("div"),P.classList.add(g),P.setAttribute(u.AFRAME_INJECTED,""),L=document.createElement("button"),L.className=b,L.setAttribute("title","Enter AR mode with a headset or handheld device. Visit https://webvr.rocks or https://webvr.info for more information."),L.setAttribute(u.AFRAME_INJECTED,""),f.device.isMobile()&&T(L),P.appendChild(L),L.addEventListener("click",function(N){C(),N.stopPropagation()}),P}function E(C){var L=document.createElement("div");L.className=A,L.classList.add(w),L.setAttribute(u.AFRAME_INJECTED,"");var P=document.createElement("button");return P.setAttribute(u.AFRAME_INJECTED,""),P.innerHTML="Exit VR",P.addEventListener("click",C),L.appendChild(P),L}function T(C){C.addEventListener("touchstart",function(){C.classList.remove("resethover")}),C.addEventListener("touchend",function(){C.classList.add("resethover")})}},{"../../constants/":123,"../../core/component":131,"../../utils/":205}],111:[function(r,a,s){var o=r("../core/component"),u=r("../lib/three"),f=r("../utils/bind"),v=o.registerComponent;a.exports.Component=v("shadow",{schema:{cast:{default:!0},receive:{default:!0}},init:function(){this.onMeshChanged=f(this.update,this),this.el.addEventListener("object3dset",this.onMeshChanged),this.system.setShadowMapEnabled(!0)},update:function(){var m=this.data;this.updateDescendants(m.cast,m.receive)},remove:function(){var m=this.el;m.removeEventListener("object3dset",this.onMeshChanged),this.updateDescendants(!1,!1)},updateDescendants:function(m,g){var y=this.el.sceneEl;this.el.object3D.traverse(function(b){if(b instanceof u.Mesh&&(b.castShadow=m,b.receiveShadow=g,y.hasLoaded&&b.material))for(var w=Array.isArray(b.material)?b.material:[b.material],A=0;A<w.length;A++)w[A].needsUpdate=!0})}})},{"../core/component":131,"../lib/three":179,"../utils/bind":199}],112:[function(r,a,s){var o=r("../core/component").registerComponent,u=r("../utils/debug"),f=r("../lib/three"),v=u("components:sound:warn");a.exports.Component=o("sound",{schema:{autoplay:{default:!1},distanceModel:{default:"inverse",oneOf:["linear","inverse","exponential"]},loop:{default:!1},maxDistance:{default:1e4},on:{default:""},poolSize:{default:1},positional:{default:!0},refDistance:{default:1},rolloffFactor:{default:1},src:{type:"audio"},volume:{default:1}},multiple:!0,init:function(){var m=this;this.listener=null,this.audioLoader=new f.AudioLoader,this.pool=new f.Group,this.loaded=!1,this.mustPlay=!1,this.playSoundBound=function(){m.playSound()}},update:function(m){var g=this.data,y,b,w=g.src!==m.src;if(w){if(!g.src)return;this.setupSound()}for(y=0;y<this.pool.children.length;y++)b=this.pool.children[y],g.positional&&(b.setDistanceModel(g.distanceModel),b.setMaxDistance(g.maxDistance),b.setRefDistance(g.refDistance),b.setRolloffFactor(g.rolloffFactor)),b.setLoop(g.loop),b.setVolume(g.volume),b.isPaused=!1;if(g.on!==m.on&&this.updateEventListener(m.on),w){var A=this;this.loaded=!1,this.audioLoader.load(g.src,function(M){for(y=0;y<A.pool.children.length;y++)b=A.pool.children[y],b.setBuffer(M);A.loaded=!0,f.Cache.remove(g.src),(A.data.autoplay||A.mustPlay)&&A.playSound(),A.el.emit("sound-loaded",A.evtDetail,!1)})}},pause:function(){this.stopSound(),this.removeEventListener()},play:function(){this.data.autoplay&&this.playSound(),this.updateEventListener()},remove:function(){var m,g;this.removeEventListener(),this.el.getObject3D(this.attrName)&&this.el.removeObject3D(this.attrName);try{for(m=0;m<this.pool.children.length;m++)g=this.pool.children[m],g.disconnect()}catch{v("Audio source not properly disconnected")}},updateEventListener:function(m){var g=this.el;m&&g.removeEventListener(m,this.playSoundBound),g.addEventListener(this.data.on,this.playSoundBound)},removeEventListener:function(){this.el.removeEventListener(this.data.on,this.playSoundBound)},setupSound:function(){var m=this.el,g,y=m.sceneEl,b=this,w;this.pool.children.length>0&&(this.stopSound(),m.removeObject3D("sound"));var A=this.listener=y.audioListener||new f.AudioListener;for(y.audioListener=A,y.camera&&y.camera.add(A),y.addEventListener("camera-set-active",function(M){M.detail.cameraEl.getObject3D("camera").add(A)}),this.pool=new f.Group,g=0;g<this.data.poolSize;g++)w=this.data.positional?new f.PositionalAudio(A):new f.Audio(A),this.pool.add(w);for(m.setObject3D(this.attrName,this.pool),g=0;g<this.pool.children.length;g++)w=this.pool.children[g],w.onEnded=function(){this.isPlaying=!1,b.el.emit("sound-ended",b.evtDetail,!1)}},pauseSound:function(){var m,g;for(this.isPlaying=!1,m=0;m<this.pool.children.length;m++)g=this.pool.children[m],!(!g.source||!g.source.buffer||!g.isPlaying||g.isPaused)&&(g.isPaused=!0,g.pause())},playSound:function(m){var g,y,b;if(!this.loaded){v("Sound not loaded yet. It will be played once it finished loading"),this.mustPlay=!0;return}for(g=!1,this.isPlaying=!0,y=0;y<this.pool.children.length;y++)if(b=this.pool.children[y],!b.isPlaying&&b.buffer&&!g){m&&m(b),b.play(),b.isPaused=!1,g=!0;continue}if(!g){v("All the sounds are playing. If you need to play more sounds simultaneously consider increasing the size of pool with the `poolSize` attribute.",this.el);return}this.mustPlay=!1},stopSound:function(){var m,g;for(this.isPlaying=!1,m=0;m<this.pool.children.length;m++){if(g=this.pool.children[m],!g.source||!g.source.buffer)return;g.stop()}}})},{"../core/component":131,"../lib/three":179,"../utils/debug":201}],113:[function(r,a,s){var o=r("three-bmfont-text"),u=r("load-bmfont"),f=r("../core/component").registerComponent,v=r("../core/shader"),m=r("../lib/three"),g=r("../utils/"),y=g.debug("components:text:error"),b=v.shaders,w=g.debug("components:text:warn"),A=1,M=16,S="https://cdn.aframe.io/fonts/",E={aileronsemibold:S+"Aileron-Semibold.fnt",dejavu:S+"DejaVu-sdf.fnt",exo2bold:S+"Exo2Bold.fnt",exo2semibold:S+"Exo2SemiBold.fnt",kelsonsans:S+"KelsonSans.fnt",monoid:S+"Monoid.fnt",mozillavr:S+"mozillavr.fnt",roboto:S+"Roboto-msdf.json",sourcecodepro:S+"SourceCodePro.fnt"},T=["roboto"],C="roboto";a.exports.FONTS=E;var L=new I,P={},N={},F=/^\w+:/;a.exports.Component=f("text",{multiple:!0,schema:{align:{type:"string",default:"left",oneOf:["left","right","center"]},alphaTest:{default:.5},anchor:{default:"center",oneOf:["left","right","center","align"]},baseline:{default:"center",oneOf:["top","center","bottom"]},color:{type:"color",default:"#FFF"},font:{type:"string",default:C},fontImage:{type:"string"},height:{type:"number"},letterSpacing:{type:"number",default:0},lineHeight:{type:"number"},negate:{type:"boolean",default:!0},opacity:{type:"number",default:1},shader:{default:"sdf",oneOf:b},side:{default:"front",oneOf:["front","back","double"]},tabSize:{default:4},transparent:{default:!0},value:{type:"string"},whiteSpace:{default:"normal",oneOf:["normal","pre","nowrap"]},width:{type:"number"},wrapCount:{type:"number",default:40},wrapPixels:{type:"number"},xOffset:{type:"number",default:0},yOffset:{type:"number",default:0},zOffset:{type:"number",default:.001}},init:function(){this.shaderData={},this.geometry=o(),this.createOrUpdateMaterial()},update:function(k){var U=this.data,W=this.currentFont;if(N[U.font]?this.texture=N[U.font]:(this.texture=N[U.font]=new m.Texture,this.texture.anisotropy=M),this.createOrUpdateMaterial(),k.font!==U.font){this.updateFont();return}W&&(this.updateGeometry(this.geometry,W),this.updateLayout())},remove:function(){this.geometry.dispose(),this.geometry=null,this.el.removeObject3D(this.attrName),this.material.dispose(),this.material=null,this.texture.dispose(),this.texture=null,this.shaderObject&&delete this.shaderObject},createOrUpdateMaterial:function(){var k=this.data,U,W=this.material,ce,oe=this.shaderData,ge;if(ge=k.shader,T.indexOf(k.font)!==-1||k.font.indexOf("-msdf.")>=0?ge="msdf":k.font in E&&T.indexOf(k.font)===-1&&(ge="sdf"),U=(this.shaderObject&&this.shaderObject.name)!==ge,oe.alphaTest=k.alphaTest,oe.color=k.color,oe.map=this.texture,oe.opacity=k.opacity,oe.side=X(k.side),oe.transparent=k.transparent,oe.negate=k.negate,!U){this.shaderObject.update(oe),W.transparent=oe.transparent,W.side=oe.side;return}ce=$(this.el,ge,oe),this.material=ce.material,this.shaderObject=ce.shader,this.material.side=oe.side,this.mesh&&(this.mesh.material=this.material)},updateFont:function(){var k=this.data,U=this.el,W,ce=this.geometry,oe=this;k.font||w("No font specified. Using the default font."),this.mesh&&(this.mesh.visible=!1),W=this.lookupFont(k.font||C)||k.font,L.get(W,function(){return Y(W,k.yOffset)}).then(function(_e){var Ne;if(_e.pages.length!==1)throw new Error("Currently only single-page bitmap fonts are supported.");P[W]||(_e.widthFactor=P[_e]=D(_e)),oe.currentFont=_e,Ne=oe.getFontImageSrc(),L.get(Ne,function(){return ae(Ne)}).then(function(Ie){var Ve=oe.texture;Ve.image=Ie,Ve.needsUpdate=!0,N[k.font]=Ve,oe.texture=Ve,oe.initMesh(),oe.currentFont=_e,oe.updateGeometry(ce,_e),oe.updateLayout(),oe.mesh.visible=!0,U.emit("textfontset",{font:k.font,fontObj:_e})}).catch(function(Ie){y(Ie.message),y(Ie.stack)})}).catch(function(ge){y(ge.message),y(ge.stack)})},initMesh:function(){this.mesh||(this.mesh=new m.Mesh(this.geometry,this.material),this.el.setObject3D(this.attrName,this.mesh))},getFontImageSrc:function(){if(this.data.fontImage)return this.data.fontImage;var k=this.lookupFont(this.data.font||C)||this.data.font,U=this.currentFont.pages[0];return U.match(F)&&U.indexOf("http")!==0?k.replace(/(\.fnt)|(\.json)/,".png"):m.LoaderUtils.extractUrlBase(k)+U},updateLayout:function(){var k,U,W=this.el,ce=this.data,oe=this.geometry,ge,_e,Ne,Ie=this.mesh,Ve,Le,Fe,Me,Qe;if(!(!Ie||!oe.layout)){if(ge=W.getAttribute("geometry"),Fe=ce.width||ge&&ge.width||A,Ve=de(ce.wrapPixels,ce.wrapCount,this.currentFont.widthFactor),Le=Fe/Ve,Ne=oe.layout,_e=Le*(Ne.height+Ne.descender),ge&&ge.primitive==="plane"&&(ge.width||W.setAttribute("geometry","width",Fe),ge.height||W.setAttribute("geometry","height",_e)),k=ce.anchor==="align"?ce.align:ce.anchor,k==="left")Me=0;else if(k==="right")Me=-1*Ne.width;else if(k==="center")Me=-1*Ne.width/2;else throw new TypeError("Invalid text.anchor property value",k);if(U=ce.baseline,U==="bottom")Qe=0;else if(U==="top")Qe=-1*Ne.height+Ne.ascender;else if(U==="center")Qe=-1*Ne.height/2;else throw new TypeError("Invalid text.baseline property value",U);Ie.position.x=Me*Le+ce.xOffset,Ie.position.y=Qe*Le,Ie.position.z=ce.zOffset,Ie.scale.set(Le,-1*Le,Le)}},lookupFont:function(k){return E[k]},updateGeometry:function(){var k={},U={},W=/\\n/g,ce=/\\t/g;return function(oe,ge){var _e=this.data;U.font=ge,U.lineHeight=_e.lineHeight&&isFinite(_e.lineHeight)?_e.lineHeight:ge.common.lineHeight,U.text=_e.value.toString().replace(W,`
`).replace(ce,"	"),U.width=de(_e.wrapPixels,_e.wrapCount,ge.widthFactor),oe.update(g.extend(k,_e,U))}}()});function X(k){switch(k){case"back":return m.FrontSide;case"double":return m.DoubleSide;default:return m.BackSide}}function Y(k,U){return new Promise(function(W,ce){u(k,function(oe,ge){if(oe){y("Error loading font",k),ce(oe);return}k.indexOf("/Roboto-msdf.json")>=0&&(U=30),U&&ge.chars.map(function(Ne){Ne.yoffset+=U}),W(ge)})})}function ae(k){return new Promise(function(U,W){new m.ImageLoader().load(k,function(ce){U(ce)},void 0,function(){y("Error loading font image",k),W(null)})})}function $(k,U,W){var ce,oe;return oe=new b[U].Shader,oe.el=k,oe.init(W),oe.update(W),ce=oe.material,ce.transparent=W.transparent,{material:ce,shader:oe}}function de(k,U,W){return k||(.5+U)*W}function D(k){var U=0,W=0,ce=0;return k.chars.map(function(oe){U+=oe.xadvance,oe.id>=48&&oe.id<=57&&(ce++,W+=oe.xadvance)}),ce?W/ce:U/k.chars.length}function I(){var k=this.cache={};this.get=function(U,W){return U in k||(k[U]=W()),k[U]}}},{"../core/component":131,"../core/shader":141,"../lib/three":179,"../utils/":205,"load-bmfont":37,"three-bmfont-text":63}],114:[function(r,a,s){var o=r("../core/component").registerComponent,u=r("../utils/tracked-controls"),f=r("../constants").DEFAULT_CAMERA_HEIGHT,v=r("../lib/three"),m=r("../constants").DEFAULT_HANDEDNESS,g={x:.175,y:-.3,z:-.03},y={x:0,y:0,z:-.175},b={touches:[]},w={AXISMOVE:"axismove",BUTTONCHANGED:"buttonchanged",BUTTONDOWN:"buttondown",BUTTONUP:"buttonup",TOUCHSTART:"touchstart",TOUCHEND:"touchend"};a.exports.Component=o("tracked-controls-webvr",{schema:{autoHide:{default:!0},controller:{default:0},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},orientationOffset:{type:"vec3"},armModel:{default:!1},headElement:{type:"selector"}},init:function(){this.axis=this.el.components["tracked-controls"].axis=[0,0,0],this.buttonStates=this.el.components["tracked-controls"].buttonStates={},this.changedAxes=[],this.targetControllerNumber=this.data.controller,this.axisMoveEventDetail={axis:this.axis,changed:this.changedAxes},this.deltaControllerPosition=new v.Vector3,this.controllerQuaternion=new v.Quaternion,this.controllerEuler=new v.Euler,this.updateGamepad(),this.buttonEventDetails={}},tick:function(A,M){var S=this.el.getObject3D("mesh");S&&S.update&&S.update(M/1e3),this.updateGamepad(),this.updatePose(),this.updateButtons()},defaultUserHeight:function(){return f},getHeadElement:function(){return this.data.headElement||this.el.sceneEl.camera.el},updateGamepad:function(){var A=this.data,M=u.findMatchingControllerWebVR(this.system.controllers,A.id,A.idPrefix,A.hand,A.controller);this.controller=M,this.el.components["tracked-controls"].controller=M,this.data.autoHide&&(this.el.object3D.visible=!!this.controller)},applyArmModel:function(A){var M=this.controller,S=this.controllerEuler,E=this.controllerQuaternion,T=this.deltaControllerPosition,C,L,P,N,F;L=this.getHeadElement(),P=L.object3D,F=this.defaultUserHeight(),N=M.pose,C=(M?M.hand:void 0)||m,A.copy(P.position),T.set(g.x*(C==="left"?-1:C==="right"?1:0),g.y,g.z),T.multiplyScalar(F),T.applyAxisAngle(P.up,P.rotation.y),A.add(T),T.set(y.x,y.y,y.z),T.multiplyScalar(F),N.orientation?E.fromArray(N.orientation):E.copy(P.quaternion),S.setFromQuaternion(E),S.set(S.x,S.y,0),T.applyEuler(S),A.add(T)},updatePose:function(){var A=this.controller,M=this.data,S=this.el.object3D,E,T=this.system.vrDisplay,C;!A||(E=A.pose,E.position?S.position.fromArray(E.position):M.armModel&&this.applyArmModel(S.position),E.orientation&&S.quaternion.fromArray(E.orientation),T&&E.position&&(C=this.el.sceneEl.renderer.xr.getStandingMatrix(),S.matrix.compose(S.position,S.quaternion,S.scale),S.matrix.multiplyMatrices(C,S.matrix),S.matrix.decompose(S.position,S.quaternion,S.scale)),S.rotateX(this.data.orientationOffset.x*v.Math.DEG2RAD),S.rotateY(this.data.orientationOffset.y*v.Math.DEG2RAD),S.rotateZ(this.data.orientationOffset.z*v.Math.DEG2RAD))},updateButtons:function(){var A,M=this.controller,S;if(!!M){for(S=0;S<M.buttons.length;++S)this.buttonStates[S]||(this.buttonStates[S]={pressed:!1,touched:!1,value:0}),this.buttonEventDetails[S]||(this.buttonEventDetails[S]={id:S,state:this.buttonStates[S]}),A=M.buttons[S],this.handleButton(S,A);this.handleAxes()}},handleButton:function(A,M){var S;return S=this.handlePress(A,M)|this.handleTouch(A,M)|this.handleValue(A,M),S?(this.el.emit(w.BUTTONCHANGED,this.buttonEventDetails[A],!1),!0):!1},handleAxes:function(){var A=!1,M=this.controller.axes,S,E=this.axis,T=this.changedAxes;for(this.changedAxes.splice(0,this.changedAxes.length),S=0;S<M.length;++S)T.push(E[S]!==M[S]),T[S]&&(A=!0);if(!A)return!1;for(this.axis.splice(0,this.axis.length),S=0;S<M.length;S++)this.axis.push(M[S]);return this.el.emit(w.AXISMOVE,this.axisMoveEventDetail,!1),!0},handlePress:function(A,M){var S,E=this.buttonStates[A];return M.pressed===E.pressed?!1:(S=M.pressed?w.BUTTONDOWN:w.BUTTONUP,this.el.emit(S,this.buttonEventDetails[A],!1),E.pressed=M.pressed,!0)},handleTouch:function(A,M){var S,E=this.buttonStates[A];return M.touched===E.touched?!1:(S=M.touched?w.TOUCHSTART:w.TOUCHEND,this.el.emit(S,this.buttonEventDetails[A],!1,b),E.touched=M.touched,!0)},handleValue:function(A,M){var S=this.buttonStates[A];return M.value===S.value?!1:(S.value=M.value,!0)}})},{"../constants":123,"../core/component":131,"../lib/three":179,"../utils/tracked-controls":214}],115:[function(r,a,s){var o=r("../utils/tracked-controls"),u=r("../core/component").registerComponent,f={AXISMOVE:"axismove",BUTTONCHANGED:"buttonchanged",BUTTONDOWN:"buttondown",BUTTONUP:"buttonup",TOUCHSTART:"touchstart",TOUCHEND:"touchend"};a.exports.Component=u("tracked-controls-webxr",{schema:{id:{type:"string",default:""},hand:{type:"string",default:""},handTrackingEnabled:{default:!1},index:{type:"int",default:-1},iterateControllerProfiles:{default:!1}},init:function(){this.updateController=this.updateController.bind(this),this.buttonEventDetails={},this.buttonStates=this.el.components["tracked-controls"].buttonStates={},this.axis=this.el.components["tracked-controls"].axis=[0,0,0],this.changedAxes=[],this.axisMoveEventDetail={axis:this.axis,changed:this.changedAxes}},update:function(){this.updateController()},play:function(){var v=this.el.sceneEl;this.updateController(),v.addEventListener("controllersupdated",this.updateController)},pause:function(){var v=this.el.sceneEl;v.removeEventListener("controllersupdated",this.updateController)},isControllerPresent:function(v){return!(!this.controller||this.controller.gamepad||v.inputSource.handedness!=="none"&&v.inputSource.handedness!==this.data.hand)},updateController:function(){this.controller=o.findMatchingControllerWebXR(this.system.controllers,this.data.id,this.data.hand,this.data.index,this.data.iterateControllerProfiles,this.data.handTrackingEnabled),this.el.components["tracked-controls"].controller=this.controller,this.data.autoHide&&(this.el.object3D.visible=!!this.controller)},tick:function(){var v=this.el.sceneEl,m=this.controller,g=v.frame;!m||!v.frame||!this.system.referenceSpace||m.hand||(this.pose=g.getPose(m.targetRaySpace,this.system.referenceSpace),this.updatePose(),this.updateButtons())},updatePose:function(){var v=this.el.object3D,m=this.pose;!m||(v.matrix.elements=m.transform.matrix,v.matrix.decompose(v.position,v.rotation,v.scale))},updateButtons:function(){var v,m,g=this.controller,y;if(!(!g||!g.gamepad)){for(y=g.gamepad,m=0;m<y.buttons.length;++m)this.buttonStates[m]||(this.buttonStates[m]={pressed:!1,touched:!1,value:0}),this.buttonEventDetails[m]||(this.buttonEventDetails[m]={id:m,state:this.buttonStates[m]}),v=y.buttons[m],this.handleButton(m,v);this.handleAxes()}},handleButton:function(v,m){var g;return g=this.handlePress(v,m)|this.handleTouch(v,m)|this.handleValue(v,m),g?(this.el.emit(f.BUTTONCHANGED,this.buttonEventDetails[v],!1),!0):!1},handleAxes:function(){var v=!1,m=this.controller.gamepad.axes,g,y=this.axis,b=this.changedAxes;for(this.changedAxes.splice(0,this.changedAxes.length),g=0;g<m.length;++g)b.push(y[g]!==m[g]),b[g]&&(v=!0);if(!v)return!1;for(this.axis.splice(0,this.axis.length),g=0;g<m.length;g++)this.axis.push(m[g]);return this.el.emit(f.AXISMOVE,this.axisMoveEventDetail,!1),!0},handlePress:function(v,m){var g,y=this.buttonStates[v];return m.pressed===y.pressed?!1:(g=m.pressed?f.BUTTONDOWN:f.BUTTONUP,this.el.emit(g,this.buttonEventDetails[v],!1),y.pressed=m.pressed,!0)},handleTouch:function(v,m){var g,y=this.buttonStates[v];return m.touched===y.touched?!1:(g=m.touched?f.TOUCHSTART:f.TOUCHEND,this.el.emit(g,this.buttonEventDetails[v],!1),y.touched=m.touched,!0)},handleValue:function(v,m){var g=this.buttonStates[v];return m.value===g.value?!1:(g.value=m.value,!0)}})},{"../core/component":131,"../utils/tracked-controls":214}],116:[function(r,a,s){var o=r("../core/component").registerComponent;a.exports.Component=o("tracked-controls",{schema:{autoHide:{default:!0},controller:{default:-1},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},handTrackingEnabled:{default:!1},orientationOffset:{type:"vec3"},armModel:{default:!1},headElement:{type:"selector"},iterateControllerProfiles:{default:!1}},update:function(){var u=this.data,f=this.el;f.sceneEl.hasWebXR?f.setAttribute("tracked-controls-webxr",{id:u.id,hand:u.hand,index:u.controller,iterateControllerProfiles:u.iterateControllerProfiles,handTrackingEnabled:u.handTrackingEnabled}):f.setAttribute("tracked-controls-webvr",u)}})},{"../core/component":131}],117:[function(r,a,s){var o=r("../core/component").registerComponent,u=r("../utils/bind"),f=r("../lib/three"),v=r("../utils/tracked-controls"),m=v.checkControllerPresentAndSetup,g=v.emitIfAxesChanged,y=v.onButtonEvent,b="https://cdn.aframe.io/controllers/valve/index/valve-index-",w={left:b+"left.glb",right:b+"right.glb"},A="valve",M=r("../utils/").device.isWebXRAvailable,S={left:{x:-.00023692678902063457,y:.04724540367838371,z:-.061959880395271096},right:{x:.002471558599671131,y:.055765208987076195,z:-.061068168708348844}},E={left:{x:0,y:-.05,z:.06},right:{x:0,y:-.05,z:.06}},T={left:{_x:.692295102620542,_y:-.0627618864318427,_z:-.06265893149611756,_order:"XYZ"},right:{_x:.6484021229942998,_y:-.032563619881892894,_z:-.1327973171917482,_order:"XYZ"}},C={left:{_x:Math.PI/3,_y:0,_z:0,_order:"XYZ"},right:{_x:Math.PI/3,_y:0,_z:0,_order:"XYZ"}},L=M?C:T,P=M?E:S;a.exports.Component=o("valve-index-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:{axes:{trackpad:[0,1],thumbstick:[2,3]},buttons:["trigger","grip","trackpad","thumbstick","abutton"]},init:function(){var N=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=u(this.onButtonChanged,this),this.onButtonDown=function(F){y(F.detail.id,"down",N)},this.onButtonUp=function(F){y(F.detail.id,"up",N)},this.onButtonTouchEnd=function(F){y(F.detail.id,"touchend",N)},this.onButtonTouchStart=function(F){y(F.detail.id,"touchstart",N)},this.previousButtonValues={},this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=u(this.onModelLoaded,this),this.onControllersUpdate=u(this.onControllersUpdate,this),this.checkIfControllerPresent=u(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=u(this.removeControllersUpdateListener,this),this.onAxisMoved=u(this.onAxisMoved,this)},addEventListeners:function(){var N=this.el;N.addEventListener("buttonchanged",this.onButtonChanged),N.addEventListener("buttondown",this.onButtonDown),N.addEventListener("buttonup",this.onButtonUp),N.addEventListener("touchend",this.onButtonTouchEnd),N.addEventListener("touchstart",this.onButtonTouchStart),N.addEventListener("model-loaded",this.onModelLoaded),N.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var N=this.el;N.removeEventListener("buttonchanged",this.onButtonChanged),N.removeEventListener("buttondown",this.onButtonDown),N.removeEventListener("buttonup",this.onButtonUp),N.removeEventListener("touchend",this.onButtonTouchEnd),N.removeEventListener("touchstart",this.onButtonTouchStart),N.removeEventListener("model-loaded",this.onModelLoaded),N.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var N=this.data,F=N.hand==="right"?0:N.hand==="left"?1:2;m(this,A,{index:F,iterateControllerProfiles:!0,hand:N.hand})},injectTrackedControls:function(){var N=this.el,F=this.data;N.setAttribute("tracked-controls",{idPrefix:A,controller:F.hand==="right"?1:F.hand==="left"?0:2,hand:F.hand,orientationOffset:F.orientationOffset}),this.loadModel()},loadModel:function(){var N=this.data;!N.model||this.el.setAttribute("gltf-model",""+w[N.hand]+"")},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(N){var F=this.mapping.buttons[N.detail.id],X=this.buttonMeshes,Y;!F||(F==="trigger"&&(Y=N.detail.state.value,X&&X.trigger&&(X.trigger.rotation.x=this.triggerOriginalRotationX-Y*(Math.PI/40))),this.el.emit(F+"changed",N.detail.state))},onModelLoaded:function(N){var F,X=N.detail.model,Y=this;!this.data.model||(F=this.buttonMeshes={},F.grip={left:X.getObjectByName("leftgrip"),right:X.getObjectByName("rightgrip")},F.menu=X.getObjectByName("menubutton"),F.system=X.getObjectByName("systembutton"),F.trackpad=X.getObjectByName("touchpad"),F.trigger=X.getObjectByName("trigger"),this.triggerOriginalRotationX=F.trigger.rotation.x,Object.keys(F).forEach(function(ae){Y.setButtonColor(ae,Y.data.buttonColor)}),X.position.copy(P[this.data.hand]),X.rotation.copy(L[this.data.hand]),this.el.emit("controllermodelready",{name:"valve-index-controlls",model:this.data.model,rayOrigin:new f.Vector3(0,0,0)}))},onAxisMoved:function(N){g(this,this.mapping.axes,N)},updateModel:function(N,F){var X,Y;!this.data.model||(Y=F.indexOf("touch")!==-1,!Y&&(X=F==="up"?this.data.buttonColor:this.data.buttonHighlightColor,this.setButtonColor(N,X)))},setButtonColor:function(N,F){}})},{"../core/component":131,"../lib/three":179,"../utils/":205,"../utils/bind":199,"../utils/tracked-controls":214}],118:[function(r,a,s){var o=r("../core/component").registerComponent;a.exports.Component=o("visible",{schema:{default:!0},update:function(){this.el.object3D.visible=this.data}})},{"../core/component":131}],119:[function(r,a,s){var o=r("../core/component").registerComponent,u=r("../utils/bind"),f=r("../utils/tracked-controls"),v=f.checkControllerPresentAndSetup,m=f.emitIfAxesChanged,g=f.onButtonEvent,y="https://cdn.aframe.io/controllers/vive/vr_controller_vive.obj",b="https://cdn.aframe.io/controllers/vive/vr_controller_vive.mtl",w=r("../utils/").device.isWebXRAvailable,A="htc-vive-controller-mv",M="OpenVR ",S=w?A:M,E={axes:{trackpad:[0,1]},buttons:["trackpad","trigger","grip","menu","system"]},T={axes:{thumbstick:[0,1]},buttons:["trigger","grip","trackpad","none","menu"]},C=w?T:E;a.exports.Component=o("vive-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:C,init:function(){var L=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=u(this.onButtonChanged,this),this.onButtonDown=function(P){g(P.detail.id,"down",L)},this.onButtonUp=function(P){g(P.detail.id,"up",L)},this.onButtonTouchEnd=function(P){g(P.detail.id,"touchend",L)},this.onButtonTouchStart=function(P){g(P.detail.id,"touchstart",L)},this.previousButtonValues={},this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},update:function(){var L=this.data;this.controllerIndex=L.hand==="right"?0:L.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=u(this.onModelLoaded,this),this.onControllersUpdate=u(this.onControllersUpdate,this),this.checkIfControllerPresent=u(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=u(this.removeControllersUpdateListener,this),this.onAxisMoved=u(this.onAxisMoved,this)},addEventListeners:function(){var L=this.el;L.addEventListener("buttonchanged",this.onButtonChanged),L.addEventListener("buttondown",this.onButtonDown),L.addEventListener("buttonup",this.onButtonUp),L.addEventListener("touchend",this.onButtonTouchEnd),L.addEventListener("touchstart",this.onButtonTouchStart),L.addEventListener("model-loaded",this.onModelLoaded),L.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var L=this.el;L.removeEventListener("buttonchanged",this.onButtonChanged),L.removeEventListener("buttondown",this.onButtonDown),L.removeEventListener("buttonup",this.onButtonUp),L.removeEventListener("touchend",this.onButtonTouchEnd),L.removeEventListener("touchstart",this.onButtonTouchStart),L.removeEventListener("model-loaded",this.onModelLoaded),L.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var L=this.data;v(this,S,{index:this.controllerIndex,hand:L.hand})},injectTrackedControls:function(){var L=this.el,P=this.data;L.setAttribute("tracked-controls",{idPrefix:S,hand:P.hand,controller:this.controllerIndex,orientationOffset:P.orientationOffset}),!!this.data.model&&this.el.setAttribute("obj-model",{obj:y,mtl:b})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(L){var P=this.mapping.buttons[L.detail.id],N=this.buttonMeshes,F;!P||(P==="trigger"&&(F=L.detail.state.value,N&&N.trigger&&(N.trigger.rotation.x=-F*(Math.PI/12))),this.el.emit(P+"changed",L.detail.state))},onModelLoaded:function(L){var P,N=L.detail.model,F=this;!this.data.model||(P=this.buttonMeshes={},P.grip={left:N.getObjectByName("leftgrip"),right:N.getObjectByName("rightgrip")},P.menu=N.getObjectByName("menubutton"),P.system=N.getObjectByName("systembutton"),P.trackpad=N.getObjectByName("touchpad"),P.trigger=N.getObjectByName("trigger"),Object.keys(P).forEach(function(X){F.setButtonColor(X,F.data.buttonColor)}),N.position.set(0,-.015,.04))},onAxisMoved:function(L){m(this,this.mapping.axes,L)},updateModel:function(L,P){var N,F;!this.data.model||(F=P.indexOf("touch")!==-1,!F&&(N=P==="up"?this.data.buttonColor:this.data.buttonHighlightColor,this.setButtonColor(L,N)))},setButtonColor:function(L,P){var N=this.buttonMeshes,F=this.rendererSystem;if(!!N){if(L==="grip"){N.grip.left.material.color.set(P),N.grip.right.material.color.set(P),F.applyColorCorrection(N.grip.left.material.color),F.applyColorCorrection(N.grip.right.material.color);return}N[L].material.color.set(P),F.applyColorCorrection(N[L].material.color)}}})},{"../core/component":131,"../utils/":205,"../utils/bind":199,"../utils/tracked-controls":214}],120:[function(r,a,s){var o=r("../core/component").registerComponent,u=r("../utils/bind"),f=r("../utils/tracked-controls"),v=f.checkControllerPresentAndSetup,m=f.emitIfAxesChanged,g=f.onButtonEvent,y="HTC Vive Focus",b="https://cdn.aframe.io/controllers/vive/focus-controller/focus-controller.gltf";a.exports.Component=o("vive-focus-controls",{schema:{hand:{default:""},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:{axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},bindMethods:function(){this.onModelLoaded=u(this.onModelLoaded,this),this.onControllersUpdate=u(this.onControllersUpdate,this),this.checkIfControllerPresent=u(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=u(this.removeControllersUpdateListener,this),this.onAxisMoved=u(this.onAxisMoved,this)},init:function(){var w=this;this.onButtonChanged=u(this.onButtonChanged,this),this.onButtonDown=function(A){g(A.detail.id,"down",w)},this.onButtonUp=function(A){g(A.detail.id,"up",w)},this.onButtonTouchStart=function(A){g(A.detail.id,"touchstart",w)},this.onButtonTouchEnd=function(A){g(A.detail.id,"touchend",w)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var w=this.el;w.addEventListener("buttonchanged",this.onButtonChanged),w.addEventListener("buttondown",this.onButtonDown),w.addEventListener("buttonup",this.onButtonUp),w.addEventListener("touchstart",this.onButtonTouchStart),w.addEventListener("touchend",this.onButtonTouchEnd),w.addEventListener("model-loaded",this.onModelLoaded),w.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0,this.addControllersUpdateListener()},removeEventListeners:function(){var w=this.el;w.removeEventListener("buttonchanged",this.onButtonChanged),w.removeEventListener("buttondown",this.onButtonDown),w.removeEventListener("buttonup",this.onButtonUp),w.removeEventListener("touchstart",this.onButtonTouchStart),w.removeEventListener("touchend",this.onButtonTouchEnd),w.removeEventListener("model-loaded",this.onModelLoaded),w.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1,this.removeControllersUpdateListener()},checkIfControllerPresent:function(){v(this,y,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var w=this.el,A=this.data;w.setAttribute("tracked-controls",{armModel:A.armModel,idPrefix:y,orientationOffset:A.orientationOffset}),!!this.data.model&&this.el.setAttribute("gltf-model",b)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(w){var A=w.detail.model,M;!this.data.model||(M=this.buttonMeshes={},M.trigger=A.getObjectByName("BumperKey"),M.triggerPressed=A.getObjectByName("BumperKey_Press"),M.triggerPressed&&(M.triggerPressed.visible=!1),M.trackpad=A.getObjectByName("TouchPad"),M.trackpadPressed=A.getObjectByName("TouchPad_Press"),M.trackpadPressed&&(M.trackpadPressed.visible=!1))},onButtonChanged:function(w){var A=this.mapping.buttons[w.detail.id];!A||this.el.emit(A+"changed",w.detail.state)},onAxisMoved:function(w){m(this,this.mapping.axes,w)},updateModel:function(w,A){!this.data.model||this.updateButtonModel(w,A)},updateButtonModel:function(w,A){var M=this.buttonMeshes,S=w+"Pressed";if(!(!M||!M[w]||!M[S])){var E;switch(A){case"down":E=this.data.buttonHighlightColor;break;case"touchstart":E=this.data.buttonTouchedColor;break}E&&M[S].material.color.set(E),M[S].visible=!!E,M[w].visible=!E}}})},{"../core/component":131,"../utils/bind":199,"../utils/tracked-controls":214}],121:[function(r,a,s){var o=r("../constants").keyboardevent.KEYCODE_TO_CODE,u=r("../core/component").registerComponent,f=r("../lib/three"),v=r("../utils/"),m=v.bind,g=v.shouldCaptureKeyEvent,y=1e-5,b=.2,w=["KeyW","KeyA","KeyS","KeyD","ArrowUp","ArrowLeft","ArrowRight","ArrowDown"];a.exports.Component=u("wasd-controls",{schema:{acceleration:{default:65},adAxis:{default:"x",oneOf:["x","y","z"]},adEnabled:{default:!0},adInverted:{default:!1},enabled:{default:!0},fly:{default:!1},wsAxis:{default:"z",oneOf:["x","y","z"]},wsEnabled:{default:!0},wsInverted:{default:!1}},init:function(){this.keys={},this.easing=1.1,this.velocity=new f.Vector3,this.onBlur=m(this.onBlur,this),this.onContextMenu=m(this.onContextMenu,this),this.onFocus=m(this.onFocus,this),this.onKeyDown=m(this.onKeyDown,this),this.onKeyUp=m(this.onKeyUp,this),this.onVisibilityChange=m(this.onVisibilityChange,this),this.attachVisibilityEventListeners()},tick:function(M,S){var E=this.data,T=this.el,C=this.velocity;!C[E.adAxis]&&!C[E.wsAxis]&&A(this.keys)||(S=S/1e3,this.updateVelocity(S),!(!C[E.adAxis]&&!C[E.wsAxis])&&T.object3D.position.add(this.getMovementVector(S)))},remove:function(){this.removeKeyEventListeners(),this.removeVisibilityEventListeners()},play:function(){this.attachKeyEventListeners()},pause:function(){this.keys={},this.removeKeyEventListeners()},updateVelocity:function(M){var S,E,T,C=this.data,L=this.keys,P=this.velocity,N,F;if(E=C.adAxis,N=C.wsAxis,M>b){P[E]=0,P[N]=0;return}var X=Math.pow(1/this.easing,M*60);P[E]!==0&&(P[E]=P[E]*X),P[N]!==0&&(P[N]=P[N]*X),Math.abs(P[E])<y&&(P[E]=0),Math.abs(P[N])<y&&(P[N]=0),!!C.enabled&&(S=C.acceleration,C.adEnabled&&(T=C.adInverted?-1:1,(L.KeyA||L.ArrowLeft)&&(P[E]-=T*S*M),(L.KeyD||L.ArrowRight)&&(P[E]+=T*S*M)),C.wsEnabled&&(F=C.wsInverted?-1:1,(L.KeyW||L.ArrowUp)&&(P[N]-=F*S*M),(L.KeyS||L.ArrowDown)&&(P[N]+=F*S*M)))},getMovementVector:function(){var M=new f.Vector3(0,0,0),S=new f.Euler(0,0,0,"YXZ");return function(E){var T=this.el.getAttribute("rotation"),C=this.velocity,L;return M.copy(C),M.multiplyScalar(E),T&&(L=this.data.fly?T.x:0,S.set(f.Math.degToRad(L),f.Math.degToRad(T.y),0),M.applyEuler(S)),M}}(),attachVisibilityEventListeners:function(){window.oncontextmenu=this.onContextMenu,window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus),document.addEventListener("visibilitychange",this.onVisibilityChange)},removeVisibilityEventListeners:function(){window.removeEventListener("blur",this.onBlur),window.removeEventListener("focus",this.onFocus),document.removeEventListener("visibilitychange",this.onVisibilityChange)},attachKeyEventListeners:function(){window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp)},removeKeyEventListeners:function(){window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)},onContextMenu:function(){for(var M=Object.keys(this.keys),S=0;S<M.length;S++)delete this.keys[M[S]]},onBlur:function(){this.pause()},onFocus:function(){this.play()},onVisibilityChange:function(){document.hidden?this.onBlur():this.onFocus()},onKeyDown:function(M){var S;!g(M)||(S=M.code||o[M.keyCode],w.indexOf(S)!==-1&&(this.keys[S]=!0))},onKeyUp:function(M){var S;S=M.code||o[M.keyCode],delete this.keys[S]}});function A(M){var S;for(S in M)return!1;return!0}},{"../constants":123,"../core/component":131,"../lib/three":179,"../utils/":205}],122:[function(r,a,s){var o=r("../core/component").registerComponent,u=r("../utils/bind"),f=r("../utils/tracked-controls"),v=f.checkControllerPresentAndSetup,m=f.emitIfAxesChanged,g=f.onButtonEvent,y=r("../utils/"),b=y.debug("components:windows-motion-controls:debug"),w=y.debug("components:windows-motion-controls:warn"),A=r("../constants").DEFAULT_HANDEDNESS,M="https://cdn.aframe.io/controllers/microsoft/",S={left:"left.glb",right:"right.glb",default:"universal.glb"},E=r("../utils/").device.isWebXRAvailable,T="windows-mixed-reality",C="Spatial Controller (Spatial Interaction Source) ",L=/([0-9a-zA-Z]+-[0-9a-zA-Z]+)$/,P=E?T:C,N={axes:{thumbstick:[0,1],trackpad:[2,3]},buttons:["thumbstick","trigger","grip","menu","trackpad"],axisMeshNames:["THUMBSTICK_X","THUMBSTICK_Y","TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",grip:"GRASP",thumbstick:"THUMBSTICK_PRESS",trackpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"},F={axes:{touchpad:[0,1],thumbstick:[2,3]},buttons:["trigger","squeeze","touchpad","thumbstick","menu"],axisMeshNames:["TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_X","THUMBSTICK_X","THUMBSTICK_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",squeeze:"GRASP",thumbstick:"THUMBSTICK_PRESS",touchpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"},X=E?F:N;a.exports.Component=o("windows-motion-controls",{schema:{hand:{default:A},pair:{default:0},model:{default:!0},hideDisconnected:{default:!0}},mapping:X,bindMethods:function(){this.onModelError=u(this.onModelError,this),this.onModelLoaded=u(this.onModelLoaded,this),this.onControllersUpdate=u(this.onControllersUpdate,this),this.checkIfControllerPresent=u(this.checkIfControllerPresent,this),this.onAxisMoved=u(this.onAxisMoved,this)},init:function(){var Y=this,ae=this.el;this.onButtonChanged=u(this.onButtonChanged,this),this.onButtonDown=function($){g($.detail.id,"down",Y)},this.onButtonUp=function($){g($.detail.id,"up",Y)},this.onButtonTouchStart=function($){g($.detail.id,"touchstart",Y)},this.onButtonTouchEnd=function($){g($.detail.id,"touchend",Y)},this.onControllerConnected=function(){Y.setModelVisibility(!0)},this.onControllerDisconnected=function(){Y.setModelVisibility(!1)},this.controllerPresent=!1,this.lastControllerCheck=0,this.previousButtonValues={},this.bindMethods(),this.loadedMeshInfo={buttonMeshes:null,axisMeshes:null},this.rayOrigin={origin:new THREE.Vector3,direction:new THREE.Vector3(0,0,-1),createdFromMesh:!1},ae.addEventListener("controllerconnected",this.onControllerConnected),ae.addEventListener("controllerdisconnected",this.onControllerDisconnected)},addEventListeners:function(){var Y=this.el;Y.addEventListener("buttonchanged",this.onButtonChanged),Y.addEventListener("buttondown",this.onButtonDown),Y.addEventListener("buttonup",this.onButtonUp),Y.addEventListener("touchstart",this.onButtonTouchStart),Y.addEventListener("touchend",this.onButtonTouchEnd),Y.addEventListener("axismove",this.onAxisMoved),Y.addEventListener("model-error",this.onModelError),Y.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var Y=this.el;Y.removeEventListener("buttonchanged",this.onButtonChanged),Y.removeEventListener("buttondown",this.onButtonDown),Y.removeEventListener("buttonup",this.onButtonUp),Y.removeEventListener("touchstart",this.onButtonTouchStart),Y.removeEventListener("touchend",this.onButtonTouchEnd),Y.removeEventListener("axismove",this.onAxisMoved),Y.removeEventListener("model-error",this.onModelError),Y.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){v(this,P,{hand:this.data.hand,index:this.data.pair,iterateControllerProfiles:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},updateControllerModel:function(){if(!this.data.model||this.rayOrigin.createdFromMesh){this.modelReady();return}var Y=this.createControllerModelUrl();this.loadModel(Y)},createControllerModelUrl:function(Y){var ae=this.el.components["tracked-controls"],$=ae?ae.controller:null,de="default",D=this.data.hand,I;if($&&!window.hasNativeWebXRImplementation&&(D=$.hand,!Y)){var k=$.id.match(L);de=k&&k[0]||de}return I=S[D]||S.default,M+de+"/"+I},injectTrackedControls:function(){var Y=this.data;this.el.setAttribute("tracked-controls",{idPrefix:P,controller:Y.pair,hand:Y.hand,armModel:!1}),this.updateControllerModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelError:function(Y){var ae=this.createControllerModelUrl(!0);Y.detail.src!==ae?(w("Failed to load controller model for device, attempting to load default."),this.loadModel(ae)):w("Failed to load default controller model.")},loadModel:function(Y){this.el.setAttribute("gltf-model","url("+Y+")")},onModelLoaded:function(Y){var ae=this.controllerModel=Y.detail.model,$=this.loadedMeshInfo,de,D,I,k;if(b("Processing model"),$.buttonMeshes={},$.axisMeshes={},ae){for(de=0;de<this.mapping.buttons.length;de++){if(D=this.mapping.buttonMeshNames[this.mapping.buttons[de]],!D){b("Skipping unknown button at index: "+de+" with mapped name: "+this.mapping.buttons[de]);continue}if(I=ae.getObjectByName(D),!I){w("Missing button mesh with name: "+D);continue}k={index:de,value:U(I,"VALUE"),pressed:U(I,"PRESSED"),unpressed:U(I,"UNPRESSED")},k.value&&k.pressed&&k.unpressed?$.buttonMeshes[this.mapping.buttons[de]]=k:w("Missing button submesh under mesh with name: "+D+"(VALUE: "+!!k.value+", PRESSED: "+!!k.pressed+", UNPRESSED:"+!!k.unpressed+")")}for(de=0;de<this.mapping.axisMeshNames.length;de++){if(D=this.mapping.axisMeshNames[de],!D){b("Skipping unknown axis at index: "+de);continue}if(I=ae.getObjectByName(D),!I){w("Missing axis mesh with name: "+D);continue}k={index:de,value:U(I,"VALUE"),min:U(I,"MIN"),max:U(I,"MAX")},k.value&&k.min&&k.max?$.axisMeshes[de]=k:w("Missing axis submesh under mesh with name: "+D+"(VALUE: "+!!k.value+", MIN: "+!!k.min+", MAX:"+!!k.max+")")}this.calculateRayOriginFromMesh(ae),this.setModelVisibility()}b("Model load complete.");function U(W,ce){for(var oe=0,ge=W.children.length;oe<ge;oe++){var _e=W.children[oe];if(_e&&_e.name===ce)return _e}}},calculateRayOriginFromMesh:function(){var Y=new THREE.Quaternion;return function(ae){var $;if(this.rayOrigin.origin.set(0,0,0),this.rayOrigin.direction.set(0,0,-1),this.rayOrigin.createdFromMesh=!0,$=ae.getObjectByName(this.mapping.pointingPoseMeshName),$){var de=ae.parent;de&&(ae.parent=null,ae.updateMatrixWorld(!0),ae.parent=de),$.getWorldPosition(this.rayOrigin.origin),$.getWorldQuaternion(Y),this.rayOrigin.direction.applyQuaternion(Y),de&&ae.updateMatrixWorld(!0)}else b("Mesh does not contain pointing origin data, defaulting to none.");this.modelReady()}}(),lerpAxisTransform:function(){var Y=new THREE.Quaternion;return function(ae,$){var de=this.loadedMeshInfo.axisMeshes[ae];if(!!de){var D=de.min,I=de.max,k=de.value,U=$*.5+.5;k.setRotationFromQuaternion(Y.copy(D.quaternion).slerp(I.quaternion,U)),k.position.lerpVectors(D.position,I.position,U)}}}(),lerpButtonTransform:function(){var Y=new THREE.Quaternion;return function(ae,$){var de=this.loadedMeshInfo.buttonMeshes[ae];if(!!de){var D=de.unpressed,I=de.pressed,k=de.value;k.setRotationFromQuaternion(Y.copy(D.quaternion).slerp(I.quaternion,$)),k.position.lerpVectors(D.position,I.position,$)}}}(),modelReady:function(){this.el.emit("controllermodelready",{name:"windows-motion-controls",model:this.data.model,rayOrigin:this.rayOrigin})},onButtonChanged:function(Y){var ae=this.mapping.buttons[Y.detail.id];ae&&(this.loadedMeshInfo&&this.loadedMeshInfo.buttonMeshes&&this.lerpButtonTransform(ae,Y.detail.state.value),this.el.emit(ae+"changed",Y.detail.state))},onAxisMoved:function(Y){var ae=this.mapping.axisMeshNames.length;if(this.loadedMeshInfo&&this.loadedMeshInfo.axisMeshes)for(var $=0;$<ae;$++)this.lerpAxisTransform($,Y.detail.axis[$]||0);m(this,this.mapping.axes,Y)},setModelVisibility:function(Y){var ae=this.el.getObject3D("mesh");Y=Y!==void 0?Y:this.modelVisible,this.modelVisible=Y,!!ae&&(ae.visible=Y)}})},{"../constants":123,"../core/component":131,"../utils/":205,"../utils/bind":199,"../utils/tracked-controls":214}],123:[function(r,a,s){a.exports={AFRAME_INJECTED:"aframe-injected",DEFAULT_CAMERA_HEIGHT:1.6,DEFAULT_HANDEDNESS:"right",keyboardevent:r("./keyboardevent")}},{"./keyboardevent":124}],124:[function(r,a,s){a.exports={KEYCODE_TO_CODE:{"38":"ArrowUp","37":"ArrowLeft","40":"ArrowDown","39":"ArrowRight","87":"KeyW","65":"KeyA","83":"KeyS","68":"KeyD"}}},{}],125:[function(r,a,s){var o=r("./a-node"),u=r("../utils/bind"),f=r("../utils/debug"),v=r("./a-register-element").registerElement,m=r("../lib/three"),g=new m.FileLoader,y=f("core:a-assets:warn");a.exports=v("a-assets",{prototype:Object.create(o.prototype,{createdCallback:{value:function(){this.isAssets=!0,this.fileLoader=g,this.timeout=null}},attachedCallback:{value:function(){var T=this,C,L=[],P,N,F,X,Y;if(!this.parentNode.isScene)throw new Error("<a-assets> must be a child of a <a-scene>.");for(X=this.querySelectorAll("img"),C=0;C<X.length;C++)F=w(X[C]),L.push(new Promise(function(ae,$){m.Cache.files[X[C].getAttribute("src")]=F,F.onload=ae,F.onerror=$}));for(N=this.querySelectorAll("audio, video"),C=0;C<N.length;C++)P=w(N[C]),!P.src&&!P.srcObject&&y("Audio/video asset has neither `src` nor `srcObject` attributes."),L.push(b(P));Promise.all(L).then(u(this.load,this)),Y=parseInt(this.getAttribute("timeout"),10)||3e3,this.timeout=setTimeout(function(){T.hasLoaded||(y("Asset loading timed out in ",Y,"ms"),T.emit("timeout"),T.load())},Y)}},detachedCallback:{value:function(){this.timeout&&clearTimeout(this.timeout)}},load:{value:function(){o.prototype.load.call(this,null,function(C){return C.isAssetItem&&C.hasAttribute("src")})}}})}),v("a-asset-item",{prototype:Object.create(o.prototype,{createdCallback:{value:function(){this.data=null,this.isAssetItem=!0}},attachedCallback:{value:function(){var T=this,C=this.getAttribute("src");g.setResponseType(this.getAttribute("response-type")||S(C)),g.load(C,function(P){T.data=P,setTimeout(function(){o.prototype.load.call(T)})},function(P){T.emit("progress",{loadedBytes:P.loaded,totalBytes:P.total,xhr:P})},function(P){T.emit("error",{xhr:P})})}}})});function b(T){if(!(!T.hasAttribute("autoplay")&&T.getAttribute("preload")!=="auto"))return new Promise(function(C,L){if(T.readyState===4)return C();if(T.error)return L();T.addEventListener("loadeddata",P,!1),T.addEventListener("progress",P,!1),T.addEventListener("error",L,!1);function P(){for(var N=0,F=0;F<T.buffered.length;F++)N+=T.buffered.end(F)-T.buffered.start(F);N>=T.duration&&(T.tagName==="VIDEO"&&(m.Cache.files[T.getAttribute("src")]=T),C())}})}function w(T){var C=A(T);return C.tagName&&C.tagName.toLowerCase()==="video"&&(C.setAttribute("playsinline",""),C.setAttribute("webkit-playsinline","")),C!==T&&(T.parentNode.appendChild(C),T.parentNode.removeChild(T)),C}function A(T){var C,L;return T.hasAttribute("crossorigin")||(L=T.getAttribute("src"),L!==null&&(L.indexOf("://")===-1||M(L)===window.location.host))?T:(y('Cross-origin element (e.g., <img>) was requested without `crossorigin` set. A-Frame will re-request the asset with `crossorigin` attribute set. Please set `crossorigin` on the element (e.g., <img crossorigin="anonymous">)',L),T.crossOrigin="anonymous",C=T.cloneNode(!0),C)}function M(T){var C=T.indexOf("://")>-1?T.split("/")[2]:T.split("/")[0];return C.substring(0,C.indexOf(":"))}function S(T){var C=E(T),L=C.lastIndexOf(".");if(L>=0){var P=C.slice(L,T.search(/\?|#|$/));if(P===".glb")return"arraybuffer"}return"text"}a.exports.inferResponseType=S;function E(T){var C=document.createElement("a");C.href=T;var L=C.search.replace(/^\?/,""),P=T.replace(L,"").replace("?","");return P.substring(P.lastIndexOf("/")+1)}a.exports.getFileNameFromURL=E},{"../lib/three":179,"../utils/bind":199,"../utils/debug":201,"./a-node":129,"./a-register-element":130}],126:[function(r,a,s){var o=r("../utils/debug"),u=r("./a-register-element").registerElement,f=o("core:cubemap:warn");a.exports=u("a-cubemap",{prototype:Object.create(window.HTMLElement.prototype,{attachedCallback:{value:function(){this.srcs=this.validate()},writable:window.debug},validate:{value:function(){var v=this.querySelectorAll("[src]"),m,g=[];if(v.length===6){for(m=0;m<v.length;m++)g.push(v[m].getAttribute("src"));return g}f("<a-cubemap> did not contain exactly six elements each with a `src` attribute.")},writable:window.debug}})})},{"../utils/debug":201,"./a-register-element":130}],127:[function(r,a,s){var o=r("./a-node"),u=r("./component").components,f=r("./a-register-element").registerElement,v=r("../lib/three"),m=r("../utils/"),g,y=m.debug("core:a-entity:debug"),b=m.debug("core:a-entity:warn"),w="__",A=["position","rotation","scale","visible"],M={once:!0},S=Object.create(o.prototype,{createdCallback:{value:function(){this.components={},this.initializingComponents={},this.componentsToUpdate={},this.isEntity=!0,this.isPlaying=!1,this.object3D=new v.Group,this.object3D.el=this,this.object3DMap={},this.parentEl=null,this.rotationObj={},this.states=[]}},attributeChangedCallback:{value:function(N,F,X){var Y=this.components[N];if(Y&&Y.justInitialized&&X===""){delete Y.justInitialized;return}!Y&&X===null||this.setEntityAttribute(N,F,X)}},attachedCallback:{value:function(){var N,F=this.sceneEl,X=this;if(this.addToParent(),!this.isScene){if(!F){this.load();return}if(N=F.querySelector("a-assets"),N&&!N.hasLoaded){N.addEventListener("loaded",function(){X.load()});return}this.load()}}},detachedCallback:{value:function(){var N;if(!!this.parentEl){for(N in this.components)this.removeComponent(N,!1);this.isScene||(this.removeFromParent(),o.prototype.detachedCallback.call(this),this.object3D.el=null)}}},getObject3D:{value:function(N){return this.object3DMap[N]}},setObject3D:{value:function(N,F){var X,Y=this;if(!(F instanceof v.Object3D))throw new Error("`Entity.setObject3D` was called with an object that was not an instance of THREE.Object3D.");X=this.getObject3D(N),X&&this.object3D.remove(X),F.el=this,F.children.length&&F.traverse(function($){$.el=Y}),this.object3D.add(F),this.object3DMap[N]=F,this.emit("object3dset",{object:F,type:N})}},removeObject3D:{value:function(N){var F=this.getObject3D(N);if(!F){b("Tried to remove `Object3D` of type:",N,"which was not defined.");return}this.object3D.remove(F),delete this.object3DMap[N],this.emit("object3dremove",{type:N})}},getOrCreateObject3D:{value:function(N,F){var X=this.getObject3D(N);return!X&&F&&(X=new F,this.setObject3D(N,X)),b("`getOrCreateObject3D` has been deprecated. Use `setObject3D()` and `object3dset` event instead."),X}},add:{value:function(N){if(!N.object3D)throw new Error("Trying to add an element that doesn't have an `object3D`");this.object3D.add(N.object3D),this.emit("child-attached",{el:N})}},addToParent:{value:function(){var N=this.parentEl=this.parentNode;!N||!N.add||this.attachedToParent||(N.add(this),this.attachedToParent=!0)}},removeFromParent:{value:function(){var N=this.parentEl;this.parentEl.remove(this),this.attachedToParent=!1,this.parentEl=null,N.emit("child-detached",{el:this})}},load:{value:function(){var N=this;this.hasLoaded||!this.parentEl||o.prototype.load.call(this,function(){!N.parentEl||(N.updateComponents(),(N.isScene||N.parentEl.isPlaying)&&N.play())})},writable:window.debug},remove:{value:function(N){N?this.object3D.remove(N.object3D):this.parentNode.removeChild(this)}},getChildEntities:{value:function(){for(var N=this.children,F=[],X=0;X<N.length;X++){var Y=N[X];Y instanceof g&&F.push(Y)}return F}},initComponent:{value:function(N,F,X){var Y,ae,$,de,D;if($=m.split(N,w),de=$[0],ae=$.length>2?$.slice(1).join("__"):$[1],!!u[de]&&(D=E(this,N)||F!==void 0,!(!D&&!X)&&!(N in this.components))){if(this.initComponentDependencies(de),ae&&!u[de].multiple)throw new Error("Trying to initialize multiple components of type `"+de+"`. There can only be one component of this type per entity.");Y=new u[de].Component(this,F,ae),this.isPlaying&&Y.play(),this.hasAttribute(N)||(Y.justInitialized=!0,window.HTMLElement.prototype.setAttribute.call(this,N,"")),y("Component initialized: %s",N)}},writable:window.debug},initComponentDependencies:{value:function(N){var F=this,X=u[N],Y,ae;if(!!X&&(Y=u[N].dependencies,!!Y))for(ae=0;ae<Y.length;ae++)F.initComponent(Y[ae],window.HTMLElement.prototype.getAttribute.call(F,Y[ae])||void 0,!0)}},removeComponent:{value:function(N,F){var X;if(X=this.components[N],!!X){if(!X.initialized){this.addEventListener("componentinitialized",function Y(ae){ae.detail.name===N&&(this.removeComponent(N,F),this.removeEventListener("componentinitialized",Y))});return}X.pause(),X.remove(),F&&(X.destroy(),delete this.components[N]),this.emit("componentremoved",X.evtDetail,!1)}},writable:window.debug},updateComponents:{value:function(){var N,F,X,Y,ae=this.componentsToUpdate;if(!!this.hasLoaded){for(X=0;X<this.mixinEls.length;X++)for(Y in this.mixinEls[X].componentCache)L(Y)&&(ae[Y]=!0);if(this.getExtraComponents){F=this.getExtraComponents();for(Y in F)L(Y)&&(ae[Y]=!0)}for(X=0;X<this.attributes.length;++X)Y=this.attributes[X].name,A.indexOf(Y)===-1&&L(Y)&&(ae[Y]=!0);for(X=0;X<A.length;X++)Y=A[X],!!this.hasAttribute(Y)&&this.updateComponent(Y,this.getDOMAttribute(Y));for(Y in ae)N=C(this.getDOMAttribute(Y),F&&F[Y]),this.updateComponent(Y,N),delete ae[Y]}},writable:window.debug},updateComponent:{value:function(N,F,X){var Y=this.components[N];if(Y){if(F===null&&!E(this,N)){this.removeComponent(N,!0);return}Y.updateProperties(F,X);return}this.initComponent(N,F,!1)}},removeAttribute:{value:function(N,F){var X=this.components[N];if(X&&F===void 0&&this.removeComponent(N,!0),X&&F!==void 0){X.resetProperty(F);return}N==="mixin"&&this.mixinUpdate(""),window.HTMLElement.prototype.removeAttribute.call(this,N)}},play:{value:function(){var N,F,X;if(!(this.isPlaying||!this.hasLoaded)){this.isPlaying=!0;for(X in this.components)this.components[X].play();for(N=this.getChildEntities(),F=0;F<N.length;F++)N[F].play();this.emit("play")}},writable:!0},pause:{value:function(){var N,F,X;if(!!this.isPlaying){this.isPlaying=!1;for(X in this.components)this.components[X].pause();for(N=this.getChildEntities(),F=0;F<N.length;F++)N[F].pause();this.emit("pause")}},writable:!0},setEntityAttribute:{value:function(N,F,X){if(u[N]||this.components[N]){this.updateComponent(N,X);return}if(N==="mixin"){if(X===this.computedMixinStr)return;this.mixinUpdate(X,F)}}},mixinUpdate:{value:function(){var N=[];return function(F,X){var Y,ae,$,de,D=this;if(!this.hasLoaded){this.addEventListener("loaded",function(){D.mixinUpdate(F,X)},M);return}for(X=X||this.getAttribute("mixin"),$=this.updateMixins(F,X),N.length=0,de=0;de<this.mixinEls.length;de++)for(Y in this.mixinEls[de].componentCache)N.indexOf(Y)===-1&&(this.components[Y]?this.components[Y].handleMixinUpdate():this.initComponent(Y,null),N.push(Y));for(de=0;de<$.oldMixinIds.length;de++)if(ae=document.getElementById($.oldMixinIds[de]),!!ae)for(Y in ae.componentCache)N.indexOf(Y)===-1&&this.components[Y]&&(this.getDOMAttribute(Y)?this.components[Y].handleMixinUpdate():this.removeComponent(Y,!0))}}()},setAttribute:{value:function(){var N={};return function(F,X,Y){var ae,$,de,D,I,k;if(D=F.indexOf(w),de=D>0?F.substring(0,D):F,!u[de]){F==="mixin"&&this.mixinUpdate(X),o.prototype.setAttribute.call(this,F,X);return}if(!this.components[F]&&this.hasAttribute(F)&&this.updateComponent(F,window.HTMLElement.prototype.getAttribute.call(this,F)),typeof Y!="undefined"&&typeof X=="string"&&X.length>0&&typeof m.styleParser.parse(X)=="string"){for(k in N)delete N[k];ae=N,ae[X]=Y,$=!1}else ae=X,$=Y===!0;this.updateComponent(F,ae,$),I=this.sceneEl&&this.sceneEl.getAttribute("debug"),I&&this.components[F].flushToDOM()}}(),writable:window.debug},flushToDOM:{value:function(N){var F=this.components,X,Y=this.children,ae,$;for($ in F)F[$].flushToDOM();if(!!N)for(ae=0;ae<Y.length;++ae)X=Y[ae],!!X.flushToDOM&&X.flushToDOM(N)}},getAttribute:{value:function(N){var F;return N==="position"?this.object3D.position:N==="rotation"?P(this):N==="scale"?this.object3D.scale:N==="visible"?this.object3D.visible:(F=this.components[N],F?F.data:window.HTMLElement.prototype.getAttribute.call(this,N))},writable:window.debug},getDOMAttribute:{value:function(N){var F=this.components[N];return F?F.attrValue:window.HTMLElement.prototype.getAttribute.call(this,N)},writable:window.debug},addState:{value:function(N){this.is(N)||(this.states.push(N),this.emit("stateadded",N))}},removeState:{value:function(N){var F=this.states.indexOf(N);F!==-1&&(this.states.splice(F,1),this.emit("stateremoved",N))}},is:{value:function(N){return this.states.indexOf(N)!==-1}},inspect:{value:function(){this.sceneEl.components.inspector.openInspector(this)}},destroy:{value:function(){var N;if(this.parentNode){b("Entity can only be destroyed if detached from scenegraph.");return}for(N in this.components)this.components[N].destroy()}}});function E(N,F){return N.components[F]&&N.components[F].attrValue?!0:T(F,N.mixinEls)}function T(N,F){var X,Y=!1;for(X=0;X<F.length&&(Y=F[X].hasAttribute(N),!Y);++X);return Y}function C(N,F){return F?F.constructor===Object?m.extend(F,m.styleParser.parse(N||{})):N||F:N}function L(N){return N.indexOf(w)!==-1&&(N=m.split(N,w)[0]),!!u[N]}function P(N){var F=v.Math.radToDeg,X=N.object3D.rotation,Y=N.rotationObj;return Y.x=F(X.x),Y.y=F(X.y),Y.z=F(X.z),Y}g=f("a-entity",{prototype:S}),a.exports=g},{"../lib/three":179,"../utils/":205,"./a-node":129,"./a-register-element":130,"./component":131}],128:[function(r,a,s){var o=r("./a-node"),u=r("./a-register-element").registerElement,f=r("./component").components,v=r("../utils"),m="__";a.exports=u("a-mixin",{prototype:Object.create(o.prototype,{createdCallback:{value:function(){this.componentCache={},this.id=this.getAttribute("id"),this.isMixin=!0}},attributeChangedCallback:{value:function(g,y,b){this.cacheAttribute(g,b),this.updateEntities()}},attachedCallback:{value:function(){this.sceneEl=this.closestScene(),this.cacheAttributes(),this.updateEntities(),this.load()}},setAttribute:{value:function(g,y){window.HTMLElement.prototype.setAttribute.call(this,g,y),this.cacheAttribute(g,y)}},cacheAttribute:{value:function(g,y){var b,w;w=v.split(g,m)[0],b=f[w],!!b&&(y===void 0&&(y=window.HTMLElement.prototype.getAttribute.call(this,g)),this.componentCache[g]=b.parseAttrValueForCache(y))}},getAttribute:{value:function(g){return this.componentCache[g]||window.HTMLElement.prototype.getAttribute.call(this,g)}},cacheAttributes:{value:function(){var g=this.attributes,y,b;for(b=0;b<g.length;b++)y=g[b].name,this.cacheAttribute(y)}},updateEntities:{value:function(){var g,y,b;if(!!this.sceneEl)for(y=this.sceneEl.querySelectorAll("[mixin~="+this.id+"]"),b=0;b<y.length;b++)g=y[b],!(!g.hasLoaded||g.isMixin)&&g.mixinUpdate(this.id)}}})})},{"../utils":205,"./a-node":129,"./a-register-element":130,"./component":131}],129:[function(r,a,s){var o=r("./a-register-element").registerElement,u=r("./a-register-element").isNode,f=r("../utils/"),v=f.debug("core:a-node:warn"),m=f.debug("core:a-node:error");a.exports=o("a-node",{prototype:Object.create(window.HTMLElement.prototype,{createdCallback:{value:function(){this.computedMixinStr="",this.hasLoaded=!1,this.isNode=!0,this.mixinEls=[]},writable:window.debug},attachedCallback:{value:function(){var g;this.sceneEl=this.closestScene(),this.sceneEl||v("You are attempting to attach <"+this.tagName+"> outside of an A-Frame scene. Append this element to `<a-scene>` instead."),this.hasLoaded=!1,this.emit("nodeready",void 0,!1),this.isMixin||(g=this.getAttribute("mixin"),g&&this.updateMixins(g))},writable:window.debug},attributeChangedCallback:{value:function(g,y,b){b!==this.computedMixinStr&&g==="mixin"&&!this.isMixin&&this.updateMixins(b,y)}},closestScene:{value:function(){for(var y=this;y&&!y.isScene;)y=y.parentElement;return y}},closest:{value:function(y){for(var b=this.matches||this.mozMatchesSelector||this.msMatchesSelector||this.oMatchesSelector||this.webkitMatchesSelector,w=this;w&&!b.call(w,y);)w=w.parentElement;return w}},detachedCallback:{value:function(){this.hasLoaded=!1}},load:{value:function(g,y){var b,w,A=this;this.hasLoaded||(y=y||u,b=this.getChildren(),w=b.filter(y).map(function(M){return new Promise(function(E){if(M.hasLoaded)return E();M.addEventListener("loaded",E)})}),Promise.all(w).then(function(){A.hasLoaded=!0,g&&g(),A.emit("loaded",void 0,!1)}).catch(function(M){m("Failure loading node: ",M)}))},writable:!0},getChildren:{value:function(){return Array.prototype.slice.call(this.children,0)}},updateMixins:{value:function(){var g=[],y=[],b={};return function(w,A){var M,S,E;for(g.length=0,y.length=0,S=w?f.split(w.trim(),/\s+/):g,E=A?f.split(A.trim(),/\s+/):y,b.newMixinIds=S,b.oldMixinIds=E,M=0;M<E.length;M++)S.indexOf(E[M])===-1&&this.unregisterMixin(E[M]);for(this.computedMixinStr="",this.mixinEls.length=0,M=0;M<S.length;M++)this.registerMixin(document.getElementById(S[M]));return this.computedMixinStr&&(this.computedMixinStr=this.computedMixinStr.trim(),window.HTMLElement.prototype.setAttribute.call(this,"mixin",this.computedMixinStr)),b}}()},registerMixin:{value:function(g){var y,b,w;if(!!g){if(w=g.getAttribute("mixin"),w)for(y=f.split(w.trim(),/\s+/),b=0;b<y.length;b++)this.registerMixin(document.getElementById(y[b]));this.computedMixinStr=this.computedMixinStr+" "+g.id,this.mixinEls.push(g)}}},setAttribute:{value:function(g,y){g==="mixin"&&this.updateMixins(y),window.HTMLElement.prototype.setAttribute.call(this,g,y)}},unregisterMixin:{value:function(g){var y,b=this.mixinEls,w;for(y=0;y<b.length;++y)if(w=b[y],g===w.id){b.splice(y,1);break}}},emit:{value:function(){var g={};return function(y,b,w,A){w===void 0&&(w=!0),g.bubbles=!!w,g.detail=b,A&&(g=f.extend({},A,g)),this.dispatchEvent(new CustomEvent(y,g))}}(),writable:window.debug}})})},{"../utils/":205,"./a-register-element":130}],130:[function(r,a,s){r("document-register-element");var o,u,f=a.exports.knownTags={};function v(A){f[A.toLowerCase()]=!0}a.exports.isNode=function(A){return A.tagName.toLowerCase()in f||A.isNode},a.exports.registerElement=function(A,M){var S=Object.getPrototypeOf(M.prototype),E=M,T=o&&S===o.prototype,C=u&&S===u.prototype;return(T||C)&&v(A),T&&(E=m(M.prototype),E={prototype:Object.create(S,E)}),C&&(E=g(M.prototype),E={prototype:Object.create(S,E)}),Object.getOwnPropertyNames(E.prototype).forEach(function(L){var P=E.prototype[L];typeof P=="function"&&(P.displayName=L)}),document.registerElement(A,E)};function m(A){var M={},S=["attachedCallback","attributeChangedCallback","createdCallback","detachedCallback"];return y(M,S,A,o.prototype),w(A,M),M}function g(A){var M={},S=["attachedCallback","attributeChangedCallback","createdCallback","detachedCallback"],E=["attachedCallback","attributeChangedCallback","createdCallback","detachedCallback"];return y(M,S,A,o.prototype),y(M,E,A,u.prototype),w(A,M),M}function y(A,M,S,E){M.forEach(function(T){b(A,T,S,E)})}a.exports.wrapMethods=y;function b(A,M,S,E){var T=S[M],C=E[M];!T||!C||T!==C&&(A[M]={value:function(){return C.apply(this,arguments),T.apply(this,arguments)},writable:window.debug})}function w(A,M){var S=Object.getOwnPropertyNames(A);S.forEach(function(E){var T;M[E]||(T=Object.getOwnPropertyDescriptor(A,E),M[E]={value:A[E],writable:T.writable})})}o=r("./a-node"),u=r("./a-entity")},{"./a-entity":127,"./a-node":129,"document-register-element":12}],131:[function(r,a,s){var o=r("./schema"),u=r("./scene/scenes"),f=r("./system"),v=r("../utils/"),m=a.exports.components={},g=o.parseProperties,y=o.parseProperty,b=o.process,w=o.isSingleProperty,A=o.stringifyProperties,M=o.stringifyProperty,S=v.styleParser,E=v.debug("core:component:warn"),T=document.currentScript,C=new RegExp("[A-Z]+"),L={},P=a.exports.Component=function(k,U,W){var ce=this;this.el=k,this.id=W,this.attrName=this.name+(W?"__"+W:""),this.evtDetail={id:this.id,name:this.name},this.initialized=!1,this.isSingleProperty=w(this.schema),this.isSinglePropertyObject=this.isSingleProperty&&D(y(void 0,this.schema))&&!(this.schema.default instanceof window.HTMLElement),this.isObjectBased=!this.isSingleProperty||this.isSinglePropertyObject,this.el.components[this.attrName]=this,this.objectPool=L[this.name];const oe=this.events;this.events={},N(this,oe),this.attrValue=void 0,this.isObjectBased?(this.nextData=this.objectPool.use(),v.objectPool.removeUnusedKeys(this.nextData,this.schema),this.oldData=this.objectPool.use(),v.objectPool.removeUnusedKeys(this.oldData,this.schema),this.previousOldData=this.objectPool.use(),v.objectPool.removeUnusedKeys(this.previousOldData,this.schema),this.parsingAttrValue=this.objectPool.use(),v.objectPool.removeUnusedKeys(this.parsingAttrValue,this.schema)):(this.nextData=void 0,this.oldData=void 0,this.previousOldData=void 0,this.parsingAttrValue=void 0),this.throttledEmitComponentChanged=v.throttle(function(){k.emit("componentchanged",ce.evtDetail,!1)},200),this.updateProperties(U)};P.prototype={schema:{},init:function(){},events:{},update:function(k){},updateSchema:void 0,tick:void 0,tock:void 0,play:function(){},pause:function(){},remove:function(){},parse:function(k,U){var W=this.schema;return this.isSingleProperty?y(k,W):g(S.parse(k),W,!0,this.name,U)},stringify:function(k){var U=this.schema;return typeof k=="string"?k:this.isSingleProperty?M(k,U):(k=A(k,U),S.stringify(k))},updateCachedAttrValue:function(k,U){var W,ce,oe;if(k!==void 0){if(k===null){this.isObjectBased&&this.attrValue&&this.objectPool.recycle(this.attrValue),this.attrValue=void 0;return}if(k instanceof Object&&!(k instanceof window.HTMLElement)?(ce=this.objectPool.use(),W=v.extend(ce,k)):W=this.parseAttrValueForCache(k),this.isObjectBased&&!U&&this.attrValue)for(oe in this.attrValue)W[oe]===void 0&&(W[oe]=this.attrValue[oe]);this.isObjectBased&&!this.attrValue&&(this.attrValue=this.objectPool.use()),v.objectPool.clearObject(this.attrValue),this.attrValue=Y(this.attrValue,W,this.isObjectBased),v.objectPool.clearObject(ce)}},parseAttrValueForCache:function(k){var U;return typeof k!="string"?k:(this.isSingleProperty?(U=this.schema.parse(k),typeof U=="string"&&(U=k)):(v.objectPool.clearObject(this.parsingAttrValue),U=S.parse(k,this.parsingAttrValue)),U)},flushToDOM:function(k){var U=k?this.data:this.attrValue;U!=null&&window.HTMLElement.prototype.setAttribute.call(this.el,this.attrName,this.stringify(U))},updateProperties:function(k,U){var W=this.el;if(!W.hasLoaded){this.updateCachedAttrValue(k);return}k!==null&&(k=this.parseAttrValueForCache(k)),this.updateCachedAttrValue(k,U),this.initialized?(this.updateComponent(k,U),this.callUpdateHandler()):this.initComponent()},initComponent:function(){var k=this.el,U;this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,!1,!0)),this.data=this.buildData(this.attrValue),!k.initializingComponents[this.name]&&(k.initializingComponents[this.name]=!0,this.init(),this.initialized=!0,delete k.initializingComponents[this.name],this.oldData=Y(this.oldData,this.data,this.isObjectBased),U=this.isObjectBased?this.objectPool.use():void 0,this.update(U),this.isObjectBased&&this.objectPool.recycle(U),k.isPlaying&&this.play(),k.emit("componentinitialized",this.evtDetail,!1))},updateComponent:function(k,U){var W,ce;if(U){this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,!0,!0)),this.data=this.buildData(this.attrValue,!0,!1);return}if(this.isSingleProperty){this.isObjectBased&&y(k,this.schema),this.data=k;return}if(g(k,this.schema,!0,this.name),this.schemaChangeKeys.length){for(W in k)if(this.schema[W].schemaChange){ce=!0;break}}if(ce){this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,!0,!0)),this.data=this.buildData(this.attrValue,!0,!1);return}for(W in k)k[W]!==void 0&&(this.data[W]=k[W])},callUpdateHandler:function(){var k;this.previousOldData instanceof Object&&v.objectPool.clearObject(this.previousOldData),this.isObjectBased?X(this.previousOldData,this.oldData):this.previousOldData=this.oldData,k=!v.deepEqual(this.oldData,this.data),!(!this.isPositionRotationScale&&!k)&&(this.oldData instanceof Object&&v.objectPool.clearObject(this.oldData),this.oldData=Y(this.oldData,this.data,this.isObjectBased),this.update(this.previousOldData),this.throttledEmitComponentChanged())},handleMixinUpdate:function(){this.data=this.buildData(this.attrValue),this.callUpdateHandler()},resetProperty:function(k){if(this.isObjectBased){if(!(k in this.attrValue))return;delete this.attrValue[k],this.data[k]=this.schema[k].default}else this.attrValue=this.schema.default,this.data=this.schema.default;this.updateProperties(this.attrValue)},extendSchema:function(k){var U;U=v.extend({},m[this.name].schema),v.extend(U,k),this.schema=b(U),this.el.emit("schemachanged",this.evtDetail)},buildData:function(k,U,W){var ce,oe,ge,_e,Ne,Ie=this.nextData,Ve=this.schema,Le,Fe=this.el.mixinEls,Me;if(ce=k&&k.constructor===Array?k.length:k!=null,this.isObjectBased&&v.objectPool.clearObject(Ie),this.isSingleProperty)this.isObjectBased?oe=X(Ie,Ve.default):oe=I(Ve.default)?v.clone(Ve.default):Ve.default;else{Me=!U&&this.attrValue,oe=Me instanceof Object?X(Ie,Me):Ie;for(_e in Ve)ge=Ve[_e].default,oe[_e]===void 0&&(oe[_e]=I(ge)?v.clone(ge):ge)}for(Le=0;Le<Fe.length;Le++)Ne=Fe[Le].getAttribute(this.attrName),!!Ne&&(oe=Y(oe,Ne,this.isObjectBased));if(ce){if(this.isSingleProperty)return D(k)?(X(this.parsingAttrValue,k),y(this.parsingAttrValue,Ve)):y(k,Ve);oe=Y(oe,k,this.isObjectBased)}else if(this.isSingleProperty)return y(oe,Ve);return g(oe,Ve,void 0,this.name,W)},eventsAttach:function(){var k;this.eventsDetach();for(k in this.events)this.el.addEventListener(k,this.events[k])},eventsDetach:function(){var k;for(k in this.events)this.el.removeEventListener(k,this.events[k])},destroy:function(){this.objectPool.recycle(this.attrValue),this.objectPool.recycle(this.oldData),this.objectPool.recycle(this.parsingAttrValue),this.attrValue=this.oldData=this.parsingAttrValue=void 0}};function N(k,U){var W;for(W in U)k.events[W]=U[W].bind(k)}if(window.debug)var F=a.exports.registrationOrderWarnings={};a.exports.registerComponent=function(k,U){var W,ce,oe={},ge,_e;if(document.currentScript&&document.currentScript!==T&&u.forEach(function(Ie){Ie.hasLoaded||document.currentScript.compareDocumentPosition(Ie)!==Node.DOCUMENT_POSITION_FOLLOWING&&(E("The component `"+k+"` was registered in a <script> tag after the scene. Component <script> tags in an HTML file should be declared *before* the scene such that the component is available to entities during scene initialization."),window.debug&&(F[k]=!0))}),C.test(k)===!0&&E("The component name `"+k+"` contains uppercase characters, but HTML will ignore the capitalization of attribute names. Change the name to be lowercase: `"+k.toLowerCase()+"`"),k.indexOf("__")!==-1)throw new Error("The component name `"+k+"` is not allowed. The sequence __ (double underscore) is reserved to specify an id for multiple components of the same type");if(Object.keys(U).forEach(function(Ne){oe[Ne]={value:U[Ne],writable:!0}}),m[k])throw new Error("The component `"+k+"` has been already registered. Check that you are not loading two versions of the same component or two different components of the same name.");if(W=function(Ne,Ie,Ve){P.call(this,Ne,Ie,Ve)},W.prototype=Object.create(P.prototype,oe),W.prototype.name=k,W.prototype.isPositionRotationScale=k==="position"||k==="rotation"||k==="scale",W.prototype.constructor=W,W.prototype.system=f&&f.systems[k],W.prototype.play=de(W.prototype.play),W.prototype.pause=$(W.prototype.pause),ge=v.extend(b(W.prototype.schema,W.prototype.name)),_e=w(W.prototype.schema),!_e){W.prototype.schemaChangeKeys=[];for(ce in ge)ge[ce].schemaChange&&W.prototype.schemaChangeKeys.push(ce)}return L[k]=v.objectPool.createPool(),m[k]={Component:W,dependencies:W.prototype.dependencies,isSingleProp:_e,multiple:W.prototype.multiple,name:k,parse:W.prototype.parse,parseAttrValueForCache:W.prototype.parseAttrValueForCache,schema:ge,stringify:W.prototype.stringify,type:W.prototype.type},W};function X(k,U){var W,ce;for(ce in U)U[ce]!==void 0&&(W=U[ce],k[ce]=I(W)?v.clone(W):W);return k}function Y(k,U,W){var ce;if(W&&U.constructor===Object){for(ce in U)U[ce]!==void 0&&(U[ce]&&U[ce].constructor===Object?k[ce]=v.clone(U[ce]):k[ce]=U[ce]);return k}return U}function ae(k){return k.tick||k.tock}function $(k){return function(){var W=this.el.sceneEl;!this.isPlaying||(k.call(this),this.isPlaying=!1,this.eventsDetach(),!!ae(this)&&W.removeBehavior(this))}}function de(k){return function(){var W=this.el.sceneEl,ce=this.el.isPlaying&&!this.isPlaying;!this.initialized||!ce||(k.call(this),this.isPlaying=!0,this.eventsAttach(),!!ae(this)&&W.addBehavior(this))}}function D(k){return k&&k.constructor===Object&&!(k instanceof window.HTMLElement)}function I(k){return k&&(k.constructor===Object||k.constructor===Array)&&!(k instanceof window.HTMLElement)}},{"../utils/":205,"./scene/scenes":138,"./schema":140,"./system":142}],132:[function(r,a,s){var o=r("./schema"),u=o.process,f=a.exports.geometries={},v=a.exports.geometryNames=[],m=r("../lib/three"),g=a.exports.Geometry=function(){};g.prototype={schema:{},init:function(y){return this.geometry=new m.BufferGeometry,this.geometry},update:function(y){}},a.exports.registerGeometry=function(y,b){var w,A={};if(Object.keys(b).forEach(function(S){A[S]={value:b[S],writable:!0}}),f[y])throw new Error("The geometry `"+y+"` has been already registered");return w=function(){g.call(this)},w.prototype=Object.create(g.prototype,A),w.prototype.name=y,w.prototype.constructor=w,f[y]={Geometry:w,schema:u(w.prototype.schema)},v.push(y),w}},{"../lib/three":179,"./schema":140}],133:[function(r,a,s){var o=r("../utils/coordinates"),u=r("debug"),f=u("core:propertyTypes:warn"),v=u("core:propertyTypes:warn"),m=a.exports.propertyTypes={},g=/[,> .[\]:]/,y=/\url\((.+)\)/;b("audio","",M),b("array",[],w,A),b("asset","",M),b("boolean",!1,T),b("color","#FFF",S,E),b("int",0,C),b("number",0,L),b("map","",M),b("model","",M),b("selector",null,P,F),b("selectorAll",null,N,X),b("src","",Y),b("string","",S,E),b("time",0,C),b("vec2",{x:0,y:0},ae,o.stringify),b("vec3",{x:0,y:0,z:0},ae,o.stringify),b("vec4",{x:0,y:0,z:0,w:1},ae,o.stringify);function b(D,I,k,U){if("type"in m){f("Property type "+D+" is already registered.");return}m[D]={default:I,parse:k||S,stringify:U||E}}a.exports.registerPropertyType=b;function w(D){if(Array.isArray(D))return D;if(!D||typeof D!="string")return[];return D.split(",").map(I);function I(k){return k.trim()}}function A(D){return D.join(", ")}function M(D){var I,k;if(typeof D!="string")return D;if(k=D.match(y),k)return k[1];if(D.charAt(0)==="#"){if(I=document.getElementById(D.substring(1)),I)return I.tagName==="CANVAS"||I.tagName==="VIDEO"||I.tagName==="IMG"?I:I.getAttribute("src");v('"'+D+'" asset not found.');return}return D}function S(D){return D}function E(D){return D===null?"null":D.toString()}function T(D){return D!=="false"&&D!==!1}function C(D){return parseInt(D,10)}function L(D){return parseFloat(D,10)}function P(D){return D?typeof D!="string"?D:D[0]==="#"&&!g.test(D)?document.getElementById(D.substring(1)):document.querySelector(D):null}function N(D){return D?typeof D!="string"?D:Array.prototype.slice.call(document.querySelectorAll(D),0):null}function F(D){return D.getAttribute?"#"+D.getAttribute("id"):E(D)}function X(D){return D instanceof Array?D.map(function(I){return"#"+I.getAttribute("id")}).join(", "):E(D)}function Y(D){return v("`src` property type is deprecated. Use `asset` instead."),M(D)}function ae(D){return o.parse(D,this.default)}function $(D,I){return D==="audio"&&typeof I!="string"||D==="array"&&!Array.isArray(I)||D==="asset"&&typeof I!="string"||D==="boolean"&&typeof I!="boolean"||D==="color"&&typeof I!="string"||D==="int"&&typeof I!="number"||D==="number"&&typeof I!="number"||D==="map"&&typeof I!="string"||D==="model"&&typeof I!="string"||D==="selector"&&typeof I!="string"&&I!==null||D==="selectorAll"&&typeof I!="string"&&I!==null||D==="src"&&typeof I!="string"||D==="string"&&typeof I!="string"||D==="time"&&typeof I!="number"?!1:D==="vec2"?de(I,2):D==="vec3"?de(I,3):D==="vec4"?de(I,4):!0}a.exports.isValidDefaultValue=$;function de(D,I){if(D===null)return!0;if(typeof D!="object"||Object.keys(D).length!==I)return!1;var k=D.x,U=D.y,W=D.z,ce=D.w;return!(typeof k!="number"||typeof U!="number"||I>2&&typeof W!="number"||I>3&&typeof ce!="number")}a.exports.isValidDefaultCoordinate=de},{"../utils/coordinates":200,debug:8}],134:[function(r,a,s){var o=r("./metaTags").inject,u=r("./wakelock"),f=r("./loadingScreen"),v=r("../a-register-element"),m=r("./scenes"),g=r("../system").systems,y=r("../../lib/three"),b=r("../../utils/"),w=r("../a-entity"),A=r("../a-node"),M=r("./postMessage"),S=b.bind,E=b.device.isIOS(),T=b.device.isMobile(),C=b.device.isWebXRAvailable,L=v.registerElement,P=b.debug("core:a-scene:warn");E&&r("../../utils/ios-orientationchange-blank-bug"),a.exports.AScene=L("a-scene",{prototype:Object.create(w.prototype,{createdCallback:{value:function(){this.clock=new y.Clock,this.isIOS=E,this.isMobile=T,this.hasWebXR=C,this.isAR=!1,this.isScene=!0,this.object3D=new y.Scene;var $=this;this.object3D.onAfterRender=function(de,D,I){$.isPlaying&&$.tock($.time,$.delta,I)},this.resize=S(this.resize,this),this.render=S(this.render,this),this.systems={},this.systemNames=[],this.time=this.delta=0,this.behaviors={tick:[],tock:[]},this.hasLoaded=!1,this.isPlaying=!1,this.originalHTML=this.innerHTML,this.setAttribute("inspector",""),this.setAttribute("keyboard-shortcuts",""),this.setAttribute("screenshot",""),this.setAttribute("vr-mode-ui",""),this.setAttribute("device-orientation-permission-ui","")}},addFullScreenStyles:{value:function(){document.documentElement.classList.add("a-fullscreen")}},removeFullScreenStyles:{value:function(){document.documentElement.classList.remove("a-fullscreen")}},attachedCallback:{value:function(){var $=this,de=this.hasAttribute("embedded");ae(this),this.setupRenderer(),f.setup(this,N),this.resize(),de||this.addFullScreenStyles(),M(this),o(this),u(this),this.onVRPresentChangeBound=S(this.onVRPresentChange,this),window.addEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),this.enterVRBound=function(){$.enterVR()},this.exitVRBound=function(){$.exitVR()},this.exitVRTrueBound=function(){$.exitVR(!0)},this.pointerRestrictedBound=function(){$.pointerRestricted()},this.pointerUnrestrictedBound=function(){$.pointerUnrestricted()},C||(window.addEventListener("vrdisplaydeactivate",this.exitVRBound),window.addEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.addEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.addEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound)),window.addEventListener("sessionend",this.resize),this.addEventListener("cameraready",function(){$.attachedCallbackPostCamera()}),this.initSystems(),this.hasWebXR&&navigator.xr&&navigator.xr.addEventListener&&navigator.xr.addEventListener("sessiongranted",function(){$.enterVR()})}},attachedCallbackPostCamera:{value:function(){var $,de=this;window.addEventListener("load",$),window.addEventListener("resize",function(){de.isIOS?setTimeout(de.resize,100):de.resize()}),this.play(),m.push(this)},writable:window.debug},initSystems:{value:function(){var $;this.initSystem("camera");for($ in g)$!=="camera"&&this.initSystem($)}},initSystem:{value:function($){this.systems[$]||(this.systems[$]=new g[$](this),this.systemNames.push($))}},detachedCallback:{value:function(){var $=m.indexOf(this);m.splice($,1),window.removeEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),window.removeEventListener("vrdisplayactivate",this.enterVRBound),window.removeEventListener("vrdisplaydeactivate",this.exitVRBound),window.removeEventListener("vrdisplayconnect",this.enterVRBound),window.removeEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.removeEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.removeEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound),window.removeEventListener("sessionend",this.resize),this.renderer.xr.dispose()}},addBehavior:{value:function($){var de,D=this.behaviors,I;for(I in D)!$[I]||(de=this.behaviors[I],de.indexOf($)===-1&&de.push($))}},getPointerLockElement:{value:function(){return document.pointerLockElement},writable:window.debug},checkHeadsetConnected:{value:b.device.checkHeadsetConnected,writable:window.debug},enterAR:{value:function(){var $;if(!this.hasWebXR)throw $="Failed to enter AR mode, WebXR not supported.",new Error($);if(!b.device.checkARSupport())throw $="Failed to enter AR, WebXR immersive-ar mode not supported in your browser or device.",new Error($);return this.enterVR(!0)}},enterVR:{value:function($){var de=this,D,I=de.renderer.xr,k;if(this.is("vr-mode"))return Promise.resolve("Already in VR.");if(this.checkHeadsetConnected()||this.isMobile)if(I.enabled=!0,this.hasWebXR){this.xrSession&&this.xrSession.removeEventListener("end",this.exitVRBound);var U=this.sceneEl.systems.webxr.sessionReferenceSpaceType;I.setReferenceSpaceType(U);var W=$?"immersive-ar":"immersive-vr";return k=this.sceneEl.systems.webxr.sessionConfiguration,new Promise(function(Ne,Ie){navigator.xr.requestSession(W,k).then(function(Le){de.xrSession=Le,I.layersEnabled=k.requiredFeatures.indexOf("layers")!==-1,I.setSession(Le),Le.addEventListener("end",de.exitVRBound),ge(Ne)},function(Le){var Fe=W==="immersive-ar",Me=Fe?"AR":"VR";throw new Error("Failed to enter "+Me+" mode (`requestSession`) "+Le)})})}else{if(D=b.device.getVRDisplay(),I.setDevice(D),D.isPresenting&&!window.hasNativeWebVRImplementation)return ge(),Promise.resolve();var ce=this.getAttribute("renderer"),oe={highRefreshRate:ce.highRefreshRate,foveationLevel:ce.foveationLevel};return D.requestPresent([{source:this.canvas,attributes:oe}]).then(ge,_e)}return ge(),Promise.resolve();function ge(Ne){var Ie;window.hasNativeWebVRImplementation&&!window.hasNativeWebXRImplementation&&(Ie=new CustomEvent("vrdisplaypresentchange",{detail:{display:b.device.getVRDisplay()}}),window.dispatchEvent(Ie)),$?de.addState("ar-mode"):de.addState("vr-mode"),de.emit("enter-vr",{target:de}),!C&&de.isMobile&&screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape"),de.addFullScreenStyles(),!de.isMobile&&!de.checkHeadsetConnected()&&X(de.canvas),de.renderer.setAnimationLoop(de.render),de.resize(),Ne&&Ne()}function _e(Ne){throw de.removeState("vr-mode"),Ne&&Ne.message?new Error("Failed to enter VR mode (`requestPresent`): "+Ne.message):new Error("Failed to enter VR mode (`requestPresent`).")}},writable:!0},exitVR:{value:function(){var $=this,de,D=this.renderer.xr;if(!this.is("vr-mode")&&!this.is("ar-mode"))return Promise.resolve("Not in immersive mode.");if(this.checkHeadsetConnected()||this.isMobile){if(D.enabled=!1,de=b.device.getVRDisplay(),this.hasWebXR)this.xrSession.removeEventListener("end",this.exitVRBound),this.xrSession.end().then(function(){},function(){}),this.xrSession=void 0,D.setSession(null);else if(de.isPresenting)return de.exitPresent().then(I,k)}else Y();return I(),Promise.resolve();function I(){$.removeState("vr-mode"),$.removeState("ar-mode"),$.isMobile&&screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),$.hasAttribute("embedded")&&$.removeFullScreenStyles(),$.resize(),$.isIOS&&b.forceCanvasResizeSafariMobile($.canvas),$.renderer.setPixelRatio(window.devicePixelRatio),$.emit("exit-vr",{target:$})}function k(U){throw U&&U.message?new Error("Failed to exit VR mode (`exitPresent`): "+U.message):new Error("Failed to exit VR mode (`exitPresent`).")}},writable:!0},pointerRestricted:{value:function(){if(this.canvas){var $=this.getPointerLockElement();$&&$!==this.canvas&&document.exitPointerLock&&document.exitPointerLock(),this.canvas.requestPointerLock&&this.canvas.requestPointerLock()}}},pointerUnrestricted:{value:function(){var $=this.getPointerLockElement();$&&$===this.canvas&&document.exitPointerLock&&document.exitPointerLock()}},onVRPresentChange:{value:function($){var de=$.display||$.detail.display;if(de&&de.isPresenting){this.enterVR();return}this.exitVR()}},getAttribute:{value:function($){var de=this.systems[$];return de?de.data:w.prototype.getAttribute.call(this,$)}},getComputedAttribute:{value:function($){P("`getComputedAttribute` is deprecated. Use `getAttribute` instead."),this.getAttribute($)}},getDOMAttribute:{value:function($){var de=this.systems[$];return de?de.data:w.prototype.getDOMAttribute.call(this,$)}},setAttribute:{value:function($,de,D){var I=this.systems[$];if(I){A.prototype.setAttribute.call(this,$,de),I.updateProperties(de);return}w.prototype.setAttribute.call(this,$,de,D)}},removeBehavior:{value:function($){var de,D,I=this.behaviors,k;for(D in I)!$[D]||(de=this.behaviors[D],k=de.indexOf($),k!==-1&&de.splice(k,1))}},resize:{value:function(){var $=this.camera,de=this.canvas,D,I,k,U=this.renderer.xr.isPresenting;I=this.renderer.xr.enabled&&U,!(!$||!de||this.is("vr-mode")&&(this.isMobile||I))&&(D=this.getAttribute("embedded")&&!this.is("vr-mode"),k=N(de,D,this.maxCanvasSize,this.is("vr-mode")),$.aspect=k.width/k.height,$.updateProjectionMatrix(),this.renderer.setSize(k.width,k.height,!1),this.emit("rendererresize",null,!1))},writable:!0},setupRenderer:{value:function(){var $=this,de,D,I,k;k={alpha:!0,antialias:!T,canvas:this.canvas,logarithmicDepthBuffer:!1,powerPreference:"high-performance"},this.maxCanvasSize={height:1920,width:1920},this.hasAttribute("renderer")&&(I=this.getAttribute("renderer"),D=b.styleParser.parse(I),D.precision&&(k.precision=D.precision+"p"),D.antialias&&D.antialias!=="auto"&&(k.antialias=D.antialias==="true"),D.logarithmicDepthBuffer&&D.logarithmicDepthBuffer!=="auto"&&(k.logarithmicDepthBuffer=D.logarithmicDepthBuffer==="true"),D.alpha&&(k.alpha=D.alpha==="true"),this.maxCanvasSize={width:D.maxCanvasWidth?parseInt(D.maxCanvasWidth):this.maxCanvasSize.width,height:D.maxCanvasHeight?parseInt(D.maxCanvasHeight):this.maxCanvasSize.height}),de=this.renderer=new y.WebGLRenderer(k),de.setPixelRatio(window.devicePixelRatio),de.sortObjects=!1,this.camera&&de.xr.setPoseTarget(this.camera.el.object3D),this.addEventListener("camera-set-active",function(){de.xr.setPoseTarget($.camera.el.object3D)})},writable:window.debug},play:{value:function(){var $=this,de=this;if(this.renderStarted){w.prototype.play.call(this);return}this.addEventListener("loaded",function(){var D=this.renderer,I,k=this.renderer.xr;w.prototype.play.call(this),!de.renderStarted&&(de.resize(),de.renderer&&(window.performance&&window.performance.mark("render-started"),f.remove(),I=b.device.getVRDisplay(),I&&I.isPresenting&&(k.setDevice(I),k.enabled=!0,de.enterVR()),D.setAnimationLoop(this.render),de.renderStarted=!0,de.emit("renderstart")))}),setTimeout(function(){w.prototype.load.call($)})}},updateComponent:{value:function($){$ in g||w.prototype.updateComponent.apply(this,arguments)}},tick:{value:function($,de){var D,I=this.systems;for(D=0;D<this.behaviors.tick.length;D++)!this.behaviors.tick[D].el.isPlaying||this.behaviors.tick[D].tick($,de);for(D=0;D<this.systemNames.length;D++)!I[this.systemNames[D]].tick||I[this.systemNames[D]].tick($,de)}},tock:{value:function($,de,D){var I,k=this.systems;for(I=0;I<this.behaviors.tock.length;I++)!this.behaviors.tock[I].el.isPlaying||this.behaviors.tock[I].tock($,de,D);for(I=0;I<this.systemNames.length;I++)!k[this.systemNames[I]].tock||k[this.systemNames[I]].tock($,de,D)}},render:{value:function($,de){var D=this.renderer;this.frame=de,this.delta=this.clock.getDelta()*1e3,this.time=this.clock.elapsedTime*1e3,this.isPlaying&&this.tick(this.time,this.delta);var I=null;this.is("ar-mode")&&(I=this.object3D.background,this.object3D.background=null),D.render(this.object3D,this.camera),I&&(this.object3D.background=I)},writable:!0}})});function N($,de,D,I){return $.parentElement?de?{height:$.parentElement.offsetHeight,width:$.parentElement.offsetWidth}:F(D,I):{height:0,width:0}}function F($,de){var D,I,k=window.devicePixelRatio;return I={height:document.body.offsetHeight,width:document.body.offsetWidth},!$||de||$.width===-1&&$.height===-1||I.width*k<$.width&&I.height*k<$.height||(D=I.width/I.height,I.width*k>$.width&&$.width!==-1&&(I.width=Math.round($.width/k),I.height=Math.round($.width/D/k)),I.height*k>$.height&&$.height!==-1&&(I.height=Math.round($.height/k),I.width=Math.round($.height*D/k))),I}function X($){var de=$.requestFullscreen||$.webkitRequestFullscreen||$.mozRequestFullScreen||$.msRequestFullscreen;de.apply($,[{navigationUI:"hide"}])}function Y(){var $=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement;!$||(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())}function ae($){var de;de=document.createElement("canvas"),de.classList.add("a-canvas"),de.dataset.aframeCanvas=!0,$.appendChild(de),document.addEventListener("fullscreenchange",D),document.addEventListener("mozfullscreenchange",D),document.addEventListener("webkitfullscreenchange",D),document.addEventListener("MSFullscreenChange",D),de.addEventListener("touchmove",function(I){I.preventDefault()}),$.canvas=de,$.emit("render-target-loaded",{target:de}),setTimeout(S($.resize,$),0);function D(){var I=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement;I||$.exitVR(),document.activeElement.blur(),document.body.focus()}}a.exports.setupCanvas=ae},{"../../lib/three":179,"../../utils/":205,"../../utils/ios-orientationchange-blank-bug":206,"../a-entity":127,"../a-node":129,"../a-register-element":130,"../system":142,"./loadingScreen":135,"./metaTags":136,"./postMessage":137,"./scenes":138,"./wakelock":139}],135:[function(r,a,s){var o=r("../../utils/"),u=o.styleParser,f,v,m,g="loading-screen",y="a-loader-title";a.exports.setup=function(M,S){f=M,m=S;var E=f.hasAttribute(g)?u.parse(f.getAttribute(g)):void 0,T=E&&E.dotsColor||"white",C=E&&E.backgroundColor||"#24CAFF",L=E===void 0||E.enabled==="true"||E.enabled===void 0,P,N,F,X,Y,ae,$,de,D,I;!L||(P=new THREE.Scene,N=new THREE.SphereGeometry(.2,36,18,0,2*Math.PI,0,Math.PI),F=new THREE.MeshBasicMaterial({color:T}),X=new THREE.Mesh(N,F),Y=X.clone(),ae=X.clone(),$=new THREE.PerspectiveCamera(80,window.innerWidth/window.innerHeight,5e-4,1e4),de=new THREE.Clock,D=0,I=function(){f.renderer.render(P,$),D=de.getElapsedTime()%4,X.visible=D>=1,Y.visible=D>=2,ae.visible=D>=3},P.background=new THREE.Color(C),P.add($),X.position.set(-1,0,-15),Y.position.set(0,0,-15),ae.position.set(1,0,-15),$.add(X),$.add(Y),$.add(ae),w(),setTimeout(function(){f.hasLoaded||(b($),v.style.display="block",window.addEventListener("resize",function(){b($)}),f.renderer.setAnimationLoop(I))},200))},a.exports.remove=function(){window.removeEventListener("resize",b),!!v&&(v.style.display="none")};function b(A){var M=f.hasAttribute("embedded"),S=m(f.canvas,M,f.maxCanvasSize,f.is("vr-mode"));A.aspect=S.width/S.height,A.updateProjectionMatrix(),f.renderer.setSize(S.width,S.height,!1)}function w(){v=document.createElement("div"),v.className=y,v.innerHTML=document.title,v.style.display="none",f.appendChild(v)}},{"../../utils/":205}],136:[function(r,a,s){var o=r("../../constants/"),u=r("../../utils").extend,f=a.exports.MOBILE_HEAD_TAGS=[m({name:"viewport",content:"width=device-width,initial-scale=1,maximum-scale=1,shrink-to-fit=no,user-scalable=no,minimal-ui,viewport-fit=cover"}),m({name:"mobile-web-app-capable",content:"yes"}),m({name:"theme-color",content:"black"})],v=[m({name:"apple-mobile-web-app-capable",content:"yes"}),m({name:"apple-mobile-web-app-status-bar-style",content:"black"}),g({rel:"apple-touch-icon",href:"https://aframe.io/images/aframe-logo-152.png"})];function m(b){return{tagName:"meta",attributes:b,exists:function(){return document.querySelector('meta[name="'+b.name+'"]')}}}function g(b){return{tagName:"link",attributes:b,exists:function(){return document.querySelector('link[rel="'+b.rel+'"]')}}}a.exports.inject=function(w){var A=document.head,M=A.querySelector("script"),S,E=[];return f.forEach(T),w.isIOS&&v.forEach(T),E;function T(C){!C||C.exists()||(S=y(C),!!S&&(M?M.parentNode.insertBefore(S,M):A.appendChild(S),E.push(S)))}};function y(b){if(!(!b||!b.tagName)){var w=document.createElement(b.tagName);return w.setAttribute(o.AFRAME_INJECTED,""),u(w,b.attributes)}}},{"../../constants/":123,"../../utils":205}],137:[function(r,a,s){var o=r("../../utils/bind"),u=r("../../utils/").isIframed;a.exports=function(m){!u()||window.addEventListener("message",o(f,m))};function f(v){var m=this;if(!!v.data)switch(v.data.type){case"vr":switch(v.data.data){case"enter":m.enterVR();break;case"exit":m.exitVR();break}}}},{"../../utils/":205,"../../utils/bind":199}],138:[function(r,a,s){a.exports=[]},{}],139:[function(r,a,s){var o=r("../../../vendor/wakelock/wakelock");a.exports=function(f){if(!!f.isMobile){var v=f.wakelock=new o;f.addEventListener("enter-vr",function(){v.request()}),f.addEventListener("exit-vr",function(){v.release()})}}},{"../../../vendor/wakelock/wakelock":220}],140:[function(r,a,s){var o=r("../utils/"),u=r("./propertyTypes"),f=o.debug,v=u.isValidDefaultValue,m=u.propertyTypes,g=f("core:schema:warn");function y(M){return"type"in M?typeof M.type=="string":"default"in M}a.exports.isSingleProperty=y,a.exports.process=function(M,S){var E;if(y(M))return b(M,S);for(E in M)M[E]=b(M[E],S);return M};function b(M,S){var E=M.default,T,C,L=M.type;return M.type?M.type==="bool"?L="boolean":M.type==="float"&&(L="number"):E!==void 0&&(typeof E=="boolean"||typeof E=="number")?L=typeof E:Array.isArray(E)?L="array":L="string",C=m[L],C||g("Unknown property type for component `"+S+"`: "+L),T=!!M.parse,M.parse=M.parse||C.parse,M.stringify=M.stringify||C.stringify,M.type=L,"default"in M?!T&&!v(L,E)&&g("Default value `"+E+"` does not match type `"+L+"` in component `"+S+"`"):M.default=C.default,M}a.exports.processPropertyDefinition=b,a.exports.parseProperties=function(){var M=[];return function(S,E,T,C,L){var P,N,F,X;M.length=0;for(N in T?S:E)T&&S[N]===void 0||M.push(N);if(S===null||typeof S!="object")return S;for(N in S)S[N]!==void 0&&!E[N]&&!L&&g("Unknown property `"+N+"` for component/system `"+C+"`.");for(P=0;P<M.length;P++){if(N=M[P],F=E[N],X=S[N],!E[N])return;S[N]=w(X,F)}return S}}();function w(M,S){return(M==null||M==="")&&(M=S.default,Array.isArray(M)&&(M=M.slice())),S.parse(M,S.default)}a.exports.parseProperty=w,a.exports.stringifyProperties=function(M,S){var E,T,C,L={},P;for(E in M)T=S[E],C=M[E],P=C,typeof P=="object"&&(P=A(C,T),T||g("Unknown component property: "+E)),L[E]=P;return L};function A(M,S){return typeof M!="object"?M:!S||M===null?JSON.stringify(M):S.stringify(M)}a.exports.stringifyProperty=A},{"../utils/":205,"./propertyTypes":133}],141:[function(r,a,s){var o=r("./schema"),u=o.process,f=a.exports.shaders={},v=a.exports.shaderNames=[],m=r("../lib/three"),g=r("../utils"),y={array:"v3",color:"v3",int:"i",number:"f",map:"t",time:"f",vec2:"v2",vec3:"v3",vec4:"v4"},b=a.exports.Shader=function(){};b.prototype={schema:{},vertexShader:"void main() {gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);}",fragmentShader:"void main() {gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);}",init:function(w){return this.attributes=this.initVariables(w,"attribute"),this.uniforms=this.initVariables(w,"uniform"),this.material=new(this.raw?m.RawShaderMaterial:m.ShaderMaterial)({uniforms:this.uniforms,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader}),this.material},initVariables:function(w,A){var M,S=this.schema,E={},T;for(M in S)S[M].is===A&&(T=y[S[M].type],E[M]={type:T,value:void 0});return E},update:function(w){this.updateVariables(w,"attribute"),this.updateVariables(w,"uniform")},updateVariables:function(w,A){var M,S,E=this.schema,T;T=A==="uniform"?this.uniforms:this.attributes;for(M in w)if(!(!E[M]||E[M].is!==A)){if(E[M].type==="map"){if(!T[M]||T[M].value===w[M])continue;S="_texture_"+M,this.setMapOnTextureLoad(T,M,S),g.material.updateMapMaterialFromData(S,M,this,w);continue}T[M].value=this.parseValue(E[M].type,w[M]),T[M].needsUpdate=!0}},parseValue:function(w,A){var M;switch(w){case"vec2":return new m.Vector2(A.x,A.y);case"vec3":return new m.Vector3(A.x,A.y,A.z);case"vec4":return new m.Vector4(A.x,A.y,A.z,A.w);case"color":return M=new m.Color(A),new m.Vector3(M.r,M.g,M.b);case"map":return m.ImageUtils.loadTexture(A);default:return A}},setMapOnTextureLoad:function(w,A,M){var S=this;this.el.addEventListener("materialtextureloaded",function(){w[A].value=S.material[M],w[A].needsUpdate=!0})}},a.exports.registerShader=function(w,A){var M,S={};if(Object.keys(A).forEach(function(E){S[E]={value:A[E],writable:!0}}),f[w])throw new Error("The shader "+w+" has been already registered");return M=function(){b.call(this)},M.prototype=Object.create(b.prototype,S),M.prototype.name=w,M.prototype.constructor=M,f[w]={Shader:M,schema:u(M.prototype.schema)},v.push(w),M}},{"../lib/three":179,"../utils":205,"./schema":140}],142:[function(r,a,s){var o=r("./component"),u=r("./schema"),f=r("../utils/"),v=u.parseProperties,m=u.parseProperty,g=u.process,y=u.isSingleProperty,b=f.styleParser,w=a.exports.systems={},A=a.exports.System=function(M){var S=o&&o.components[this.name];this.el=M,this.sceneEl=M,S&&(S.Component.prototype.system=this),this.buildData(),this.init(),this.update({})};A.prototype={schema:{},init:function(){},update:function(M){},updateProperties:function(M){var S=this.data;!Object.keys(u).length||(this.buildData(M),this.update(S))},buildData:function(M){var S=this.schema;!Object.keys(S).length||(M=M||window.HTMLElement.prototype.getAttribute.call(this.sceneEl,this.name),y(S)?this.data=m(M,S):this.data=v(b.parse(M)||{},S))},tick:void 0,tock:void 0,play:function(){},pause:function(){}},a.exports.registerSystem=function(M,S){var E,T,C={},L=f.findAllScenes(document);if(Object.keys(S).forEach(function(P){C[P]={value:S[P],writable:!0}}),w[M])throw new Error("The system `"+M+"` has been already registered. Check that you are not loading two versions of the same system or two different systems of the same name.");for(T=function(P){A.call(this,P)},T.prototype=Object.create(A.prototype,C),T.prototype.name=M,T.prototype.constructor=T,T.prototype.schema=f.extend(g(T.prototype.schema)),w[M]=T,E=0;E<L.length;E++)L[E].initSystem(M)}},{"../utils/":205,"./component":131,"./schema":140}],143:[function(r,a,s){r("./pivot")},{"./pivot":144}],144:[function(r,a,s){var o=r("../../core/component").registerComponent,u=r("../../lib/three"),f=new u.Vector3,v=new u.Vector3;o("pivot",{dependencies:["position"],schema:{type:"vec3"},init:function(){var m=this.data,g=this.el,y=g.object3D.parent,b=g.object3D,w=new u.Group;f.copy(b.position),v.copy(b.rotation),y.remove(b),w.add(b),y.add(w),g.object3D=w,b.position.set(-1*m.x,-1*m.y,-1*m.z),w.position.set(m.x+f.x,m.y+f.y,m.z+f.z),w.rotation.copy(b.rotation),b.rotation.set(0,0,0)}})},{"../../core/component":131,"../../lib/three":179}],145:[function(r,a,s){var o=r("../../core/component").components,u=r("../../core/shader").shaders,f=r("../../utils/"),v={};Object.keys(o.material.schema).forEach(m),Object.keys(u.standard.schema).forEach(m);function m(g){var y=g.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();g==="fog"&&(y="material-fog"),g==="visible"&&(y="material-visible"),v[y]="material."+g}a.exports=function(){return{defaultComponents:{material:{}},mappings:f.extend({},v)}}},{"../../core/component":131,"../../core/shader":141,"../../utils/":205}],146:[function(r,a,s){r("./primitives/a-camera"),r("./primitives/a-cursor"),r("./primitives/a-curvedimage"),r("./primitives/a-gltf-model"),r("./primitives/a-image"),r("./primitives/a-light"),r("./primitives/a-link"),r("./primitives/a-obj-model"),r("./primitives/a-sky"),r("./primitives/a-sound"),r("./primitives/a-text"),r("./primitives/a-video"),r("./primitives/a-videosphere"),r("./primitives/meshPrimitives")},{"./primitives/a-camera":148,"./primitives/a-cursor":149,"./primitives/a-curvedimage":150,"./primitives/a-gltf-model":151,"./primitives/a-image":152,"./primitives/a-light":153,"./primitives/a-link":154,"./primitives/a-obj-model":155,"./primitives/a-sky":156,"./primitives/a-sound":157,"./primitives/a-text":158,"./primitives/a-video":159,"./primitives/a-videosphere":160,"./primitives/meshPrimitives":161}],147:[function(r,a,s){var o=r("../../core/a-entity"),u=r("../../core/component").components,f=r("../../core/a-register-element").registerElement,v=r("../../utils/"),m=v.debug,g=v.entity.setComponentProperty,y=m("extras:primitives:debug"),b=m("extras:primitives:warn"),w=a.exports.primitives={};a.exports.registerPrimitive=function(E,T){E=E.toLowerCase(),y("Registering <%s>",E),T.defaultAttributes&&b("The 'defaultAttributes' object is deprecated. Use 'defaultComponents' instead.");var C=f(E,{prototype:Object.create(o.prototype,{defaultComponentsFromPrimitive:{value:T.defaultComponents||T.defaultAttributes||{}},deprecated:{value:T.deprecated||null},deprecatedMappings:{value:T.deprecatedMappings||{}},mappings:{value:T.mappings||{}},createdCallback:{value:function(){T.deprecated&&console.warn(T.deprecated),this.resolveMappingCollisions()}},resolveMappingCollisions:{value:function(){var L=this.mappings,P=this;Object.keys(L).forEach(function(F){var X;F!==F.toLowerCase()&&b("Mapping keys should be specified in lower case. The mapping key "+F+" may not be recognized"),u[F]&&(X=L[F].replace(".","-"),L[X]=L[F],delete L[F],console.warn("The primitive "+P.tagName.toLowerCase()+" has a mapping collision. The attribute "+F+" has the same name as a registered component and has been renamed to "+X))})}},getExtraComponents:{value:function(){var L,P,N,F,X,Y,ae=this;for(P=v.clone(this.defaultComponentsFromPrimitive),X=this.getAttribute("mixin"),X&&(X=X.trim().split(" "),X.forEach(function(U){var W=ae.sceneEl.querySelector("#"+U).componentCache;Object.keys(W).forEach(function(oe){P[oe]=$(P[oe],W[oe])})})),N=0;N<this.attributes.length;N++)if(L=this.attributes[N],F=this.mappings[L.name],F){Y=v.entity.getComponentPropertyPath(F),Y.constructor===Array?(P[Y[0]]=P[Y[0]]||{},P[Y[0]][Y[1]]=L.value.trim()):P[Y]=L.value.trim();continue}return P;function $(k,U){return de(k)?D(U):de(U)?D(k):I(k)&&I(U)?v.extendDeep(k,U):D(U)}function de(k){return typeof k=="undefined"}function D(k){return I(k)?v.extendDeep({},k):k}function I(k){return k!==null&&k.constructor===Object}}},attributeChangedCallback:{value:function(L,P,N){var F=this.mappings[L];L in this.deprecatedMappings&&console.warn(this.deprecatedMappings[L]),!(!L||!F)&&g(this,F,N)}}})});return w[E]=C,C};function A(S,E){var T=u[S].schema;Object.keys(T).map(function(C){var L=C.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();E[L]!==void 0&&(L=S+"-"+C),E[L]=S+"."+C})}function M(S,E,T){T=T||{},Object.keys(E).map(function(L){A(L,T)}),a.exports.registerPrimitive(S,v.extendDeep({},null,{defaultComponents:E,mappings:T}))}a.exports.definePrimitive=M},{"../../core/a-entity":127,"../../core/a-register-element":130,"../../core/component":131,"../../utils/":205}],148:[function(r,a,s){var o=r("../primitives").registerPrimitive;o("a-camera",{defaultComponents:{camera:{},"look-controls":{},"wasd-controls":{},position:{x:0,y:1.6,z:0}},mappings:{active:"camera.active",far:"camera.far",fov:"camera.fov","look-controls-enabled":"look-controls.enabled",near:"camera.near","pointer-lock-enabled":"look-controls.pointerLockEnabled","wasd-controls-enabled":"wasd-controls.enabled","reverse-mouse-drag":"look-controls.reverseMouseDrag",zoom:"camera.zoom"}})},{"../primitives":147}],149:[function(r,a,s){var o=r("../getMeshMixin"),u=r("../primitives").registerPrimitive,f=r("../../../utils/");u("a-cursor",f.extendDeep({},o(),{defaultComponents:{cursor:{},geometry:{primitive:"ring",radiusOuter:.016,radiusInner:.01,segmentsTheta:32},material:{color:"#000",shader:"flat",opacity:.8},position:{x:0,y:0,z:-1}},mappings:{far:"raycaster.far",fuse:"cursor.fuse","fuse-timeout":"cursor.fuseTimeout",interval:"raycaster.interval",objects:"raycaster.objects"}}))},{"../../../utils/":205,"../getMeshMixin":145,"../primitives":147}],150:[function(r,a,s){var o=r("../getMeshMixin"),u=r("../primitives").registerPrimitive,f=r("../../../utils/");u("a-curvedimage",f.extendDeep({},o(),{defaultComponents:{geometry:{height:1,primitive:"cylinder",radius:2,segmentsRadial:48,thetaLength:270,openEnded:!0,thetaStart:0},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0,repeat:"-1 1"}},mappings:{height:"geometry.height","open-ended":"geometry.openEnded",radius:"geometry.radius",segments:"geometry.segmentsRadial",start:"geometry.thetaStart","theta-length":"geometry.thetaLength","theta-start":"geometry.thetaStart",width:"geometry.thetaLength"}}))},{"../../../utils/":205,"../getMeshMixin":145,"../primitives":147}],151:[function(r,a,s){var o=r("../primitives").registerPrimitive;o("a-gltf-model",{mappings:{src:"gltf-model"}})},{"../primitives":147}],152:[function(r,a,s){var o=r("../getMeshMixin"),u=r("../primitives").registerPrimitive,f=r("../../../utils/");u("a-image",f.extendDeep({},o(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},{"../../../utils/":205,"../getMeshMixin":145,"../primitives":147}],153:[function(r,a,s){var o=r("../primitives").registerPrimitive;o("a-light",{defaultComponents:{light:{}},mappings:{angle:"light.angle",color:"light.color","ground-color":"light.groundColor",decay:"light.decay",distance:"light.distance",intensity:"light.intensity",penumbra:"light.penumbra",type:"light.type",target:"light.target"}})},{"../primitives":147}],154:[function(r,a,s){var o=r("../primitives").registerPrimitive;o("a-link",{defaultComponents:{link:{visualAspectEnabled:!0}},mappings:{href:"link.href",image:"link.image",title:"link.title"}})},{"../primitives":147}],155:[function(r,a,s){var o=r("../getMeshMixin")(),u=r("../primitives").registerPrimitive,f=r("../../../utils/");u("a-obj-model",f.extendDeep({},o,{defaultComponents:{"obj-model":{}},mappings:{src:"obj-model.obj",mtl:"obj-model.mtl"}}))},{"../../../utils/":205,"../getMeshMixin":145,"../primitives":147}],156:[function(r,a,s){var o=r("../getMeshMixin"),u=r("../primitives").registerPrimitive,f=r("../../../utils/"),v=r("./meshPrimitives");u("a-sky",f.extendDeep({},o(),{defaultComponents:{geometry:{primitive:"sphere",radius:500,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",side:"back",shader:"flat",npot:!0},scale:"-1 1 1"},mappings:f.extendDeep({},v["a-sphere"].prototype.mappings)}))},{"../../../utils/":205,"../getMeshMixin":145,"../primitives":147,"./meshPrimitives":161}],157:[function(r,a,s){var o=r("../primitives").registerPrimitive;o("a-sound",{defaultComponents:{sound:{}},mappings:{src:"sound.src",on:"sound.on",autoplay:"sound.autoplay",loop:"sound.loop",volume:"sound.volume"}})},{"../primitives":147}],158:[function(r,a,s){var o=r("../primitives").definePrimitive;o("a-text",{text:{anchor:"align",width:5}})},{"../primitives":147}],159:[function(r,a,s){var o=r("../getMeshMixin"),u=r("../primitives").registerPrimitive,f=r("../../../utils/");u("a-video",f.extendDeep({},o(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},{"../../../utils/":205,"../getMeshMixin":145,"../primitives":147}],160:[function(r,a,s){var o=r("../getMeshMixin"),u=r("../primitives").registerPrimitive,f=r("../../../utils/");u("a-videosphere",f.extendDeep({},o(),{defaultComponents:{geometry:{primitive:"sphere",radius:500,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",shader:"flat",side:"back",npot:!0},scale:"-1 1 1"},mappings:{radius:"geometry.radius","segments-height":"geometry.segmentsHeight","segments-width":"geometry.segmentsWidth"}}))},{"../../../utils/":205,"../getMeshMixin":145,"../primitives":147}],161:[function(r,a,s){var o=r("../getMeshMixin"),u=r("../../../core/geometry").geometries,f=r("../../../core/geometry").geometryNames,v=r("../primitives").registerPrimitive,m=r("../../../utils/"),g=a.exports={};f.forEach(function(w){var A=u[w],M=y(w),S={};Object.keys(A.schema).forEach(function(L){S[y(L)]="geometry."+L});var E="a-"+M,T=v(E,m.extendDeep({},o(),{defaultComponents:{geometry:{primitive:w}},mappings:S}));g[E]=T});function y(b){return b.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}},{"../../../core/geometry":132,"../../../utils/":205,"../getMeshMixin":145,"../primitives":147}],162:[function(r,a,s){var o=r("../core/geometry").registerGeometry,u=r("../lib/three");o("box",{schema:{depth:{default:1,min:0},height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"},segmentsDepth:{default:1,min:1,max:20,type:"int"}},init:function(f){this.geometry=new u.BoxGeometry(f.width,f.height,f.depth,f.segmentsWidth,f.segmentsHeight,f.segmentsDepth)}})},{"../core/geometry":132,"../lib/three":179}],163:[function(r,a,s){var o=r("../core/geometry").registerGeometry,u=r("../lib/three"),f=u.Math.degToRad;o("circle",{schema:{radius:{default:1,min:0},segments:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(v){this.geometry=new u.CircleGeometry(v.radius,v.segments,f(v.thetaStart),f(v.thetaLength))}})},{"../core/geometry":132,"../lib/three":179}],164:[function(r,a,s){var o=r("../core/geometry").registerGeometry,u=r("../lib/three"),f=u.Math.degToRad;o("cone",{schema:{height:{default:1,min:0},openEnded:{default:!1},radiusBottom:{default:1,min:0},radiusTop:{default:.01,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(v){this.geometry=new u.CylinderGeometry(v.radiusTop,v.radiusBottom,v.height,v.segmentsRadial,v.segmentsHeight,v.openEnded,f(v.thetaStart),f(v.thetaLength))}})},{"../core/geometry":132,"../lib/three":179}],165:[function(r,a,s){var o=r("../core/geometry").registerGeometry,u=r("../lib/three"),f=u.Math.degToRad;o("cylinder",{schema:{height:{default:1,min:0},openEnded:{default:!1},radius:{default:1,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(v){this.geometry=new u.CylinderGeometry(v.radius,v.radius,v.height,v.segmentsRadial,v.segmentsHeight,v.openEnded,f(v.thetaStart),f(v.thetaLength))}})},{"../core/geometry":132,"../lib/three":179}],166:[function(r,a,s){var o=r("../core/geometry").registerGeometry,u=r("../lib/three");o("dodecahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(f){this.geometry=new u.DodecahedronGeometry(f.radius,f.detail)}})},{"../core/geometry":132,"../lib/three":179}],167:[function(r,a,s){var o=r("../core/geometry").registerGeometry,u=r("../lib/three");o("icosahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(f){this.geometry=new u.IcosahedronGeometry(f.radius,f.detail)}})},{"../core/geometry":132,"../lib/three":179}],168:[function(r,a,s){r("./box.js"),r("./circle.js"),r("./cone.js"),r("./cylinder.js"),r("./dodecahedron.js"),r("./icosahedron.js"),r("./octahedron.js"),r("./plane.js"),r("./ring.js"),r("./sphere.js"),r("./tetrahedron.js"),r("./torus.js"),r("./torusKnot.js"),r("./triangle.js")},{"./box.js":162,"./circle.js":163,"./cone.js":164,"./cylinder.js":165,"./dodecahedron.js":166,"./icosahedron.js":167,"./octahedron.js":169,"./plane.js":170,"./ring.js":171,"./sphere.js":172,"./tetrahedron.js":173,"./torus.js":174,"./torusKnot.js":175,"./triangle.js":176}],169:[function(r,a,s){var o=r("../core/geometry").registerGeometry,u=r("../lib/three");o("octahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(f){this.geometry=new u.OctahedronGeometry(f.radius,f.detail)}})},{"../core/geometry":132,"../lib/three":179}],170:[function(r,a,s){var o=r("../core/geometry").registerGeometry,u=r("../lib/three");o("plane",{schema:{height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"}},init:function(f){this.geometry=new u.PlaneGeometry(f.width,f.height,f.segmentsWidth,f.segmentsHeight)}})},{"../core/geometry":132,"../lib/three":179}],171:[function(r,a,s){var o=r("../core/geometry").registerGeometry,u=r("../lib/three"),f=u.Math.degToRad;o("ring",{schema:{radiusInner:{default:.8,min:0},radiusOuter:{default:1.2,min:0},segmentsPhi:{default:10,min:1,type:"int"},segmentsTheta:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(v){this.geometry=new u.RingGeometry(v.radiusInner,v.radiusOuter,v.segmentsTheta,v.segmentsPhi,f(v.thetaStart),f(v.thetaLength))}})},{"../core/geometry":132,"../lib/three":179}],172:[function(r,a,s){var o=r("../core/geometry").registerGeometry,u=r("../lib/three"),f=u.Math.degToRad;o("sphere",{schema:{radius:{default:1,min:0},phiLength:{default:360},phiStart:{default:0,min:0},thetaLength:{default:180,min:0},thetaStart:{default:0},segmentsHeight:{default:18,min:2,type:"int"},segmentsWidth:{default:36,min:3,type:"int"}},init:function(v){this.geometry=new u.SphereGeometry(v.radius,v.segmentsWidth,v.segmentsHeight,f(v.phiStart),f(v.phiLength),f(v.thetaStart),f(v.thetaLength))}})},{"../core/geometry":132,"../lib/three":179}],173:[function(r,a,s){var o=r("../core/geometry").registerGeometry,u=r("../lib/three");o("tetrahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(f){this.geometry=new u.TetrahedronGeometry(f.radius,f.detail)}})},{"../core/geometry":132,"../lib/three":179}],174:[function(r,a,s){var o=r("../core/geometry").registerGeometry,u=r("../lib/three"),f=u.Math.degToRad;o("torus",{schema:{arc:{default:360},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:36,min:2,type:"int"},segmentsTubular:{default:32,min:3,type:"int"}},init:function(v){this.geometry=new u.TorusGeometry(v.radius,v.radiusTubular*2,v.segmentsRadial,v.segmentsTubular,f(v.arc))}})},{"../core/geometry":132,"../lib/three":179}],175:[function(r,a,s){var o=r("../core/geometry").registerGeometry,u=r("../lib/three");o("torusKnot",{schema:{p:{default:2,min:1},q:{default:3,min:1},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:8,min:3,type:"int"},segmentsTubular:{default:100,min:3,type:"int"}},init:function(f){this.geometry=new u.TorusKnotGeometry(f.radius,f.radiusTubular*2,f.segmentsTubular,f.segmentsRadial,f.p,f.q)}})},{"../core/geometry":132,"../lib/three":179}],176:[function(r,a,s){var o=r("../core/geometry").registerGeometry,u=r("../lib/three"),f=new u.Quaternion,v=new u.Vector3(0,0,1),m=new u.Vector2,g=new u.Vector2,y=new u.Vector2;o("triangle",{schema:{vertexA:{type:"vec3",default:{x:0,y:.5,z:0}},vertexB:{type:"vec3",default:{x:-.5,y:-.5,z:0}},vertexC:{type:"vec3",default:{x:.5,y:-.5,z:0}}},init:function(b){var w,A,M,S,E,T,C,L,P;M=new u.Triangle,M.a.set(b.vertexA.x,b.vertexA.y,b.vertexA.z),M.b.set(b.vertexB.x,b.vertexB.y,b.vertexB.z),M.c.set(b.vertexC.x,b.vertexC.y,b.vertexC.z),A=M.getNormal(new u.Vector3),f.setFromUnitVectors(A,v),S=M.a.clone().applyQuaternion(f),E=M.b.clone().applyQuaternion(f),T=M.c.clone().applyQuaternion(f),m.set(Math.min(S.x,E.x,T.x),Math.min(S.y,E.y,T.y)),g.set(Math.max(S.x,E.x,T.x),Math.max(S.y,E.y,T.y)),y.set(0,0).subVectors(g,m),S=new u.Vector2().subVectors(S,m).divide(y),E=new u.Vector2().subVectors(E,m).divide(y),T=new u.Vector2().subVectors(T,m).divide(y),w=this.geometry=new u.BufferGeometry,C=[M.a.x,M.a.y,M.a.z,M.b.x,M.b.y,M.b.z,M.c.x,M.c.y,M.c.z],L=[A.x,A.y,A.z,A.x,A.y,A.z,A.x,A.y,A.z],P=[S.x,S.y,E.x,E.y,T.x,T.y],w.setAttribute("position",new u.Float32BufferAttribute(C,3)),w.setAttribute("normal",new u.Float32BufferAttribute(L,3)),w.setAttribute("uv",new u.Float32BufferAttribute(P,2))}})},{"../core/geometry":132,"../lib/three":179}],177:[function(r,a,s){if(window.Promise=window.Promise||r("promise-polyfill"),window.hasNativeWebVRImplementation=!!window.navigator.getVRDisplays||!!window.navigator.getVRDevices,window.hasNativeWebXRImplementation=navigator.xr!==void 0,!window.hasNativeWebXRImplementation&&!window.hasNativeWebVRImplementation){var o=r("./utils/isIOSOlderThan10"),u=o(window.navigator.userAgent)?1/window.devicePixelRatio:1,f=r("webvr-polyfill"),v={BUFFER_SCALE:u,CARDBOARD_UI_DISABLED:!0,ROTATE_INSTRUCTIONS_DISABLED:!0,MOBILE_WAKE_LOCK:!!window.cordova};window.webvrpolyfill=new f(v)}var m=r("./utils/"),g=m.debug;m.isIE11&&(r("custom-event-polyfill"),r("../vendor/starts-with-polyfill"));var y=g("A-Frame:error"),b=g("A-Frame:warn");window.document.currentScript&&window.document.currentScript.parentNode!==window.document.head&&!window.debug&&b("Put the A-Frame <script> tag in the <head> of the HTML *before* the scene to ensure everything for A-Frame is properly registered before they are used from HTML."),!window.cordova&&window.location.protocol==="file:"&&y("This HTML file is currently being served via the file:// protocol. Assets, textures, and models WILL NOT WORK due to cross-origin policy! Please use a local or hosted server: https://aframe.io/docs/0.5.0/introduction/getting-started.html#using-a-local-server."),r("present"),m.device.isBrowserEnvironment&&(r("./style/aframe.css"),r("./style/rStats.css"));var w=r("./core/scene/a-scene").AScene,A=r("./core/component").components,M=r("./core/component").registerComponent,S=r("./core/geometry").registerGeometry,E=r("./extras/primitives/primitives").registerPrimitive,T=r("./core/shader").registerShader,C=r("./core/system").registerSystem,L=r("./core/shader").shaders,P=r("./core/system").systems,N=window.THREE=r("./lib/three"),F=r("../package");r("./components/index"),r("./geometries/index"),r("./shaders/index"),r("./systems/index");var X=r("./core/a-node"),Y=r("./core/a-entity");r("./core/a-assets"),r("./core/a-cubemap"),r("./core/a-mixin"),r("./extras/components/"),r("./extras/primitives/"),console.log("A-Frame Version: 1.2.0 (Date 2021-02-05, Commit #b220fa00)"),console.log("THREE Version (https://github.com/supermedium/three.js):",F.dependencies["super-three"]),console.log("WebVR Polyfill Version:",F.dependencies["webvr-polyfill"]),a.exports=window.AFRAME={AComponent:r("./core/component").Component,AEntity:Y,ANode:X,ANIME:r("super-animejs"),AScene:w,components:A,coreComponents:Object.keys(A),geometries:r("./core/geometry").geometries,registerComponent:M,registerElement:r("./core/a-register-element").registerElement,registerGeometry:S,registerPrimitive:E,registerShader:T,registerSystem:C,primitives:{getMeshMixin:r("./extras/primitives/getMeshMixin"),primitives:r("./extras/primitives/primitives").primitives},scenes:r("./core/scene/scenes"),schema:r("./core/schema"),shaders:L,systems:P,THREE:N,utils:m,version:F.version}},{"../package":73,"../vendor/starts-with-polyfill":218,"./components/index":84,"./core/a-assets":125,"./core/a-cubemap":126,"./core/a-entity":127,"./core/a-mixin":128,"./core/a-node":129,"./core/a-register-element":130,"./core/component":131,"./core/geometry":132,"./core/scene/a-scene":134,"./core/scene/scenes":138,"./core/schema":140,"./core/shader":141,"./core/system":142,"./extras/components/":143,"./extras/primitives/":146,"./extras/primitives/getMeshMixin":145,"./extras/primitives/primitives":147,"./geometries/index":168,"./lib/three":179,"./shaders/index":181,"./style/aframe.css":186,"./style/rStats.css":187,"./systems/index":191,"./utils/":205,"./utils/isIOSOlderThan10":208,"custom-event-polyfill":7,present:48,"promise-polyfill":50,"super-animejs":56,"webvr-polyfill":68}],178:[function(r,a,s){window.aframeStats=function(o){var u=null,f=o,v={te:{caption:"Entities"},lt:{caption:"Load Time"}},m=[{caption:"A-Frame",values:["te","lt"]}];function g(){u("te").set(y()),window.performance.getEntriesByName&&u("lt").set(window.performance.getEntriesByName("render-started")[0].startTime.toFixed(0))}function y(){var M=f.querySelectorAll("*");return Array.prototype.slice.call(M).filter(function(S){return S.isEntity}),M.length}function b(){}function w(){}function A(M){u=M}return{update:g,start:b,end:w,attach:A,values:v,groups:m,fractions:[]}},typeof a=="object"&&(a.exports={aframeStats:window.aframeStats})},{}],179:[function(r,a,s){(function(o){var u=o.THREE=r("super-three");u.TextureLoader&&(u.TextureLoader.prototype.crossOrigin="anonymous"),u.ImageLoader&&(u.ImageLoader.prototype.crossOrigin="anonymous"),u.Cache&&(u.Cache.enabled=!0),r("../../vendor/DeviceOrientationControls"),r("super-three/examples/js/loaders/DRACOLoader"),r("super-three/examples/js/loaders/GLTFLoader"),r("super-three/examples/js/loaders/OBJLoader"),r("super-three/examples/js/loaders/MTLLoader"),r("super-three/examples/js/utils/BufferGeometryUtils"),u.DRACOLoader.prototype.crossOrigin="anonymous",u.GLTFLoader.prototype.crossOrigin="anonymous",u.MTLLoader.prototype.crossOrigin="anonymous",u.OBJLoader.prototype.crossOrigin="anonymous",a.exports=u}).call(this,typeof Ba!="undefined"?Ba:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"../../vendor/DeviceOrientationControls":215,"super-three":57,"super-three/examples/js/loaders/DRACOLoader":58,"super-three/examples/js/loaders/GLTFLoader":59,"super-three/examples/js/loaders/MTLLoader":60,"super-three/examples/js/loaders/OBJLoader":61,"super-three/examples/js/utils/BufferGeometryUtils":62}],180:[function(r,a,s){var o=r("../core/shader").registerShader,u=r("../lib/three"),f=r("../utils/");a.exports.Shader=o("flat",{schema:{color:{type:"color"},fog:{default:!0},height:{default:256},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2}},init:function(m){this.rendererSystem=this.el.sceneEl.systems.renderer,this.materialData={color:new u.Color},this.textureSrc=null,v(m,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color),this.material=new u.MeshBasicMaterial(this.materialData),f.material.updateMap(this,m)},update:function(m){this.updateMaterial(m),f.material.updateMap(this,m)},updateMaterial:function(m){var g;v(m,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color);for(g in this.materialData)this.material[g]=this.materialData[g]}});function v(m,g){return g.color.set(m.color),g.fog=m.fog,g.wireframe=m.wireframe,g.wireframeLinewidth=m.wireframeLinewidth,g}},{"../core/shader":141,"../lib/three":179,"../utils/":205}],181:[function(r,a,s){r("./flat"),r("./standard"),r("./sdf"),r("./msdf"),r("./ios10hls")},{"./flat":180,"./ios10hls":182,"./msdf":183,"./sdf":184,"./standard":185}],182:[function(r,a,s){var o=r("../core/shader").registerShader;a.exports.Shader=o("ios10hls",{schema:{src:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},vertexShader:["varying vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join(`
`),fragmentShader:["uniform sampler2D src;","uniform float opacity;","varying vec2 vUV;","void main() {","  vec2 offset = vec2(0, 0);","  vec2 repeat = vec2(1, 1);","  vec4 color = texture2D(src, vec2(vUV.x / repeat.x + offset.x, (1.0 - vUV.y) / repeat.y + offset.y)).bgra;","  gl_FragColor = vec4(color.rgb, opacity);","}"].join(`
`)})},{"../core/shader":141}],183:[function(r,a,s){var o=r("../core/shader").registerShader,u=!!document.createElement("canvas").getContext("webgl2"),f=["attribute vec2 uv;","attribute vec3 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join(`
`),v=["#version 300 es","in vec2 uv;","in vec3 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","out vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join(`
`),m=u?v:f,g=["#ifdef GL_OES_standard_derivatives","#extension GL_OES_standard_derivatives: enable","#endif","precision highp float;","uniform bool negate;","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","varying vec2 vUV;","float median(float r, float g, float b) {","  return max(min(r, g), min(max(r, g), b));","}","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","void main() {","  vec3 sampleColor = texture2D(map, vUV).rgb;","  if (negate) { sampleColor = 1.0 - sampleColor; }","  float sigDist = median(sampleColor.r, sampleColor.g, sampleColor.b) - 0.5;","  float alpha = clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);","  float dscale = 0.353505;","  vec2 duv = dscale * (dFdx(vUV) + dFdy(vUV));","  float isBigEnough = max(abs(duv.x), abs(duv.y));","  // Do modified alpha test.","  if (isBigEnough > BIG_ENOUGH) {","    float ratio = BIG_ENOUGH / isBigEnough;","    alpha = ratio * alpha + (1.0 - ratio) * (sigDist + 0.5);","  }","  // Do modified alpha test.","  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  gl_FragColor = vec4(color.xyz, alpha * opacity);","}"].join(`
`),y=["#version 300 es","precision highp float;","uniform bool negate;","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","in vec2 vUV;","out vec4 fragColor;","float median(float r, float g, float b) {","  return max(min(r, g), min(max(r, g), b));","}","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","void main() {","  vec3 sampleColor = texture(map, vUV).rgb;","  if (negate) { sampleColor = 1.0 - sampleColor; }","  float sigDist = median(sampleColor.r, sampleColor.g, sampleColor.b) - 0.5;","  float alpha = clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);","  float dscale = 0.353505;","  vec2 duv = dscale * (dFdx(vUV) + dFdy(vUV));","  float isBigEnough = max(abs(duv.x), abs(duv.y));","  // Do modified alpha test.","  if (isBigEnough > BIG_ENOUGH) {","    float ratio = BIG_ENOUGH / isBigEnough;","    alpha = ratio * alpha + (1.0 - ratio) * (sigDist + 0.5);","  }","  // Do modified alpha test.","  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  fragColor = vec4(color.xyz, alpha * opacity);","}"].join(`
`),b=u?y:g;a.exports.Shader=o("msdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},negate:{type:"boolean",is:"uniform",default:!0},opacity:{type:"number",is:"uniform",default:1}},raw:!0,vertexShader:m,fragmentShader:b})},{"../core/shader":141}],184:[function(r,a,s){var o=r("../core/shader").registerShader;a.exports.Shader=o("sdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},raw:!0,vertexShader:["#version 300 es","in vec2 uv;","in vec3 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","out vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join(`
`),fragmentShader:["#version 300 es","precision highp float;","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","in vec2 vUV;","out vec4 fragColor;","#ifdef GL_OES_standard_derivatives","  float contour(float width, float value) {","    return smoothstep(0.5 - value, 0.5 + value, width);","  }","#else","  float aastep(float value, float afwidth) {","    return smoothstep(0.5 - afwidth, 0.5 + afwidth, value);","  }","#endif","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","#define ALL_SMOOTH 0.4","#define ALL_ROUGH 0.02","#define DISCARD_ALPHA (alphaTest / (2.2 - 1.2 * ratio))","void main() {","  #ifdef GL_OES_standard_derivatives","    vec2 uv = vUV;","    vec4 texColor = texture(map, uv);","    float dist = texColor.a;","    float width = fwidth(dist);","    float alpha = contour(dist, width);","    float dscale = 0.353505;","    vec2 duv = dscale * (dFdx(uv) + dFdy(uv));","    float isBigEnough = max(abs(duv.x), abs(duv.y));","    if (isBigEnough > BIG_ENOUGH) {","      float ratio = BIG_ENOUGH / isBigEnough;","      alpha = ratio * alpha + (1.0 - ratio) * dist;","    }","    if (isBigEnough <= BIG_ENOUGH) {","      vec4 box = vec4 (uv - duv, uv + duv);","      alpha = (alpha + 0.5 * (","        contour(texture(map, box.xy).a, width)","        + contour(texture(map, box.zw).a, width)","        + contour(texture(map, box.xw).a, width)","        + contour(texture(map, box.zy).a, width)","      )) / 3.0;","    }","    if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  #else","    vec4 texColor = texture(map, vUV);","    float value = texColor.a;","    float afwidth = (1.0 / 32.0) * (1.4142135623730951 / (2.0 * gl_FragCoord.w));","    float alpha = aastep(value, afwidth);","    float ratio = (gl_FragCoord.w >= ALL_SMOOTH) ? 1.0 : (gl_FragCoord.w < ALL_ROUGH) ? 0.0 : (gl_FragCoord.w - ALL_ROUGH) / (ALL_SMOOTH - ALL_ROUGH);","    if (alpha < alphaTest) { if (ratio >= 1.0) { discard; return; } alpha = 0.0; }","    alpha = alpha * ratio + (1.0 - ratio) * value;","    if (ratio < 1.0 && alpha <= DISCARD_ALPHA) { discard; return; }","  #endif","  fragColor = vec4(color, opacity * alpha);","}"].join(`
`)})},{"../core/shader":141}],185:[function(r,a,s){var o=r("../core/shader").registerShader,u=r("../lib/three"),f=r("../utils/"),v=new u.CubeTextureLoader,m={};a.exports.Shader=o("standard",{schema:{ambientOcclusionMap:{type:"map"},ambientOcclusionMapIntensity:{default:1},ambientOcclusionTextureOffset:{type:"vec2"},ambientOcclusionTextureRepeat:{type:"vec2",default:{x:1,y:1}},color:{type:"color"},displacementMap:{type:"map"},displacementScale:{default:1},displacementBias:{default:.5},displacementTextureOffset:{type:"vec2"},displacementTextureRepeat:{type:"vec2",default:{x:1,y:1}},emissive:{type:"color",default:"#000"},emissiveIntensity:{default:1},envMap:{default:""},fog:{default:!0},height:{default:256},metalness:{default:0,min:0,max:1},metalnessMap:{type:"map"},metalnessTextureOffset:{type:"vec2"},metalnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},normalMap:{type:"map"},normalScale:{type:"vec2",default:{x:1,y:1}},normalTextureOffset:{type:"vec2"},normalTextureRepeat:{type:"vec2",default:{x:1,y:1}},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},roughness:{default:.5,min:0,max:1},roughnessMap:{type:"map"},roughnessTextureOffset:{type:"vec2"},roughnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},sphericalEnvMap:{type:"map"},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2}},init:function(y){this.rendererSystem=this.el.sceneEl.systems.renderer,this.materialData={color:new u.Color,emissive:new u.Color},g(y,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color),this.rendererSystem.applyColorCorrection(this.materialData.emissive),this.material=new u.MeshStandardMaterial(this.materialData),f.material.updateMap(this,y),y.normalMap&&f.material.updateDistortionMap("normal",this,y),y.displacementMap&&f.material.updateDistortionMap("displacement",this,y),y.ambientOcclusionMap&&f.material.updateDistortionMap("ambientOcclusion",this,y),y.metalnessMap&&f.material.updateDistortionMap("metalness",this,y),y.roughnessMap&&f.material.updateDistortionMap("roughness",this,y),this.updateEnvMap(y)},update:function(y){this.updateMaterial(y),f.material.updateMap(this,y),y.normalMap&&f.material.updateDistortionMap("normal",this,y),y.displacementMap&&f.material.updateDistortionMap("displacement",this,y),y.ambientOcclusionMap&&f.material.updateDistortionMap("ambientOcclusion",this,y),y.metalnessMap&&f.material.updateDistortionMap("metalness",this,y),y.roughnessMap&&f.material.updateDistortionMap("roughness",this,y),this.updateEnvMap(y)},updateMaterial:function(y){var b,w=this.material;g(y,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color),this.rendererSystem.applyColorCorrection(this.materialData.emissive);for(b in this.materialData)w[b]=this.materialData[b]},updateEnvMap:function(y){var b=this,w=this.material,A=y.envMap,M=y.sphericalEnvMap;if(!A&&!M||this.isLoadingEnvMap){w.envMap=null,w.needsUpdate=!0;return}if(this.isLoadingEnvMap=!0,M){this.el.sceneEl.systems.material.loadTexture(M,{src:M},function(E){b.isLoadingEnvMap=!1,E.mapping=u.SphericalReflectionMapping,w.envMap=E,f.material.handleTextureEvents(b.el,E),w.needsUpdate=!0});return}if(m[A]){m[A].then(function(S){b.isLoadingEnvMap=!1,w.envMap=S,f.material.handleTextureEvents(b.el,S),w.needsUpdate=!0});return}m[A]=new Promise(function(S){f.srcLoader.validateCubemapSrc(A,function(T){v.load(T,function(C){b.isLoadingEnvMap=!1,w.envMap=C,f.material.handleTextureEvents(b.el,C),S(C)})})})}});function g(y,b){return b.color.set(y.color),b.emissive.set(y.emissive),b.emissiveIntensity=y.emissiveIntensity,b.fog=y.fog,b.metalness=y.metalness,b.roughness=y.roughness,b.wireframe=y.wireframe,b.wireframeLinewidth=y.wireframeLinewidth,y.normalMap&&(b.normalScale=y.normalScale),y.ambientOcclusionMap&&(b.aoMapIntensity=y.ambientOcclusionMapIntensity),y.displacementMap&&(b.displacementScale=y.displacementScale,b.displacementBias=y.displacementBias),b}},{"../core/shader":141,"../lib/three":179,"../utils/":205}],186:[function(r,a,s){var o=`html.a-fullscreen{bottom:0;left:0;position:fixed;right:0;top:0}html.a-fullscreen body{height:100%;margin:0;overflow:hidden;padding:0;width:100%}html.a-fullscreen .a-canvas{width:100%!important;height:100%!important;top:0!important;left:0!important;right:0!important;bottom:0!important;position:fixed!important}html:not(.a-fullscreen) .a-enter-ar,html:not(.a-fullscreen) .a-enter-vr{right:5px;bottom:5px}:-webkit-full-screen{background-color:transparent}.a-hidden{display:none!important}.a-canvas{height:100%;left:0;position:absolute;top:0;width:100%}.a-canvas.a-grab-cursor:hover{cursor:grab;cursor:-moz-grab;cursor:-webkit-grab}canvas.a-canvas.a-mouse-cursor-hover:hover{cursor:pointer}.a-inspector-loader{background-color:#ed3160;position:fixed;left:3px;top:3px;padding:6px 10px;color:#fff;text-decoration:none;font-size:12px;font-family:Roboto,sans-serif;text-align:center;z-index:99999;width:204px}@keyframes dots-1{from{opacity:0}25%{opacity:1}}@keyframes dots-2{from{opacity:0}50%{opacity:1}}@keyframes dots-3{from{opacity:0}75%{opacity:1}}@-webkit-keyframes dots-1{from{opacity:0}25%{opacity:1}}@-webkit-keyframes dots-2{from{opacity:0}50%{opacity:1}}@-webkit-keyframes dots-3{from{opacity:0}75%{opacity:1}}.a-inspector-loader .dots span{animation:dots-1 2s infinite steps(1);-webkit-animation:dots-1 2s infinite steps(1)}.a-inspector-loader .dots span:first-child+span{animation-name:dots-2;-webkit-animation-name:dots-2}.a-inspector-loader .dots span:first-child+span+span{animation-name:dots-3;-webkit-animation-name:dots-3}a-scene{display:block;position:relative;height:100%;width:100%}a-assets,a-scene audio,a-scene img,a-scene video{display:none}.a-enter-vr-modal,.a-orientation-modal{font-family:Consolas,Andale Mono,Courier New,monospace}.a-enter-vr-modal a{border-bottom:1px solid #fff;padding:2px 0;text-decoration:none;transition:.1s color ease-in}.a-enter-vr-modal a:hover{background-color:#fff;color:#111;padding:2px 4px;position:relative;left:-4px}.a-enter-ar,.a-enter-vr{font-family:sans-serif,monospace;font-size:13px;width:100%;font-weight:200;line-height:16px;position:absolute;right:20px;bottom:20px}.a-enter-ar{right:80px}.a-enter-vr-button,.a-enter-vr-modal,.a-enter-vr-modal a{color:#fff;user-select:none;outline:0}.a-enter-vr-button{background:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='108' height='62' viewBox='0 0 108 62'%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z' fill='%23fff'/%3E%3Cpath d='M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z' fill='%23fff'/%3E%3C/svg%3E") 50% 50% no-repeat rgba(0,0,0,.35)}.a-enter-ar-button{background:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='108' height='62' viewBox='0 0 108 62'%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z' fill='%23fff'/%3E%3Cpath d='M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z' fill='%23fff'/%3E%3Cpath d='M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z' fill='%23fff'/%3E%3C/svg%3E") 50% 50% no-repeat rgba(0,0,0,.2)}.a-enter-ar-button,.a-enter-vr-button{background-size:90% 90%;border:0;bottom:0;cursor:pointer;min-width:58px;min-height:34px;padding-right:0;padding-top:0;position:absolute;right:0;transition:background-color .05s ease;-webkit-transition:background-color .05s ease;z-index:9999;border-radius:8px;touch-action:manipulation}.a-enter-ar-button{background-size:100% 90%;margin-right:10px;border-radius:7px}.a-enter-ar-button:active,.a-enter-ar-button:hover,.a-enter-vr-button:active,.a-enter-vr-button:hover{background-color:#ef2d5e}.a-enter-vr-button.resethover{background-color:rgba(0,0,0,.35)}[data-a-enter-vr-no-webvr] .a-enter-vr-button{border-color:#666;opacity:.65}[data-a-enter-vr-no-webvr] .a-enter-vr-button:active,[data-a-enter-vr-no-webvr] .a-enter-vr-button:hover{background-color:rgba(0,0,0,.35);cursor:not-allowed}.a-enter-vr-modal{background-color:#666;border-radius:0;display:none;min-height:32px;margin-right:70px;padding:9px;width:280px;right:2%;position:absolute}.a-enter-vr-modal:after{border-bottom:10px solid transparent;border-left:10px solid #666;border-top:10px solid transparent;display:inline-block;content:'';position:absolute;right:-5px;top:5px;width:0;height:0}.a-enter-vr-modal a,.a-enter-vr-modal p{display:inline}.a-enter-vr-modal p{margin:0}.a-enter-vr-modal p:after{content:' '}[data-a-enter-vr-no-headset].a-enter-vr:hover .a-enter-vr-modal,[data-a-enter-vr-no-webvr].a-enter-vr:hover .a-enter-vr-modal{display:block}.a-orientation-modal{background:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E) center/50% 50% no-repeat rgba(244,244,244,1);bottom:0;font-size:14px;font-weight:600;left:0;line-height:20px;right:0;position:fixed;top:0;z-index:9999999}.a-orientation-modal:after{color:#666;content:"Insert phone into Cardboard holder.";display:block;position:absolute;text-align:center;top:70%;transform:translateY(-70%);width:100%}.a-orientation-modal button{background:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E) no-repeat;border:none;height:50px;text-indent:-9999px;width:50px}.a-loader-title{background-color:rgba(0,0,0,.6);font-family:sans-serif,monospace;text-align:center;font-size:20px;height:50px;font-weight:300;line-height:50px;position:absolute;right:0;left:0;top:0;color:#fff}.a-modal{background:0 0/50% 50% rgba(0,0,0,.6);bottom:0;font-size:14px;font-weight:600;left:0;line-height:20px;right:0;position:fixed;top:0;z-index:9999999}.a-dialog{position:relative;left:50%;top:50%;transform:translate(-50%,-50%);z-index:199995;width:300px;height:200px;background-size:contain;background-color:#fff;font-family:sans-serif,monospace;font-size:20px;border-radius:3px;padding:6px}.a-dialog-text-container{width:100%;height:70%;align-self:flex-start;display:flex;justify-content:center;align-content:center;flex-direction:column}.a-dialog-text{display:inline-block;font-weight:400;font-size:14pt;margin:8px}.a-dialog-buttons-container{display:inline-flex;align-self:flex-end;width:100%;height:30%}.a-dialog-button{cursor:pointer;align-self:center;opacity:.9;height:80%;width:50%;font-size:12pt;margin:4px;border-radius:2px;text-align:center;border:none;display:inline-block;-webkit-transition:all .25s ease-in-out;transition:all .25s ease-in-out;box-shadow:0 1px 3px rgba(0,0,0,.1),0 1px 2px rgba(0,0,0,.2);user-select:none}.a-dialog-permission-button:hover{box-shadow:0 7px 14px rgba(0,0,0,.2),0 2px 2px rgba(0,0,0,.2)}.a-dialog-allow-button{background-color:#00ceff}.a-dialog-deny-button{background-color:#ff005b}.a-dialog-ok-button{background-color:#00ceff;width:100%}`;r("browserify-css").createStyle(o,{href:"src/style/aframe.css"}),a.exports=o},{"browserify-css":4}],187:[function(r,a,s){var o=".rs-base{background-color:#333;color:#fafafa;border-radius:0;font:10px monospace;left:5px;line-height:1em;opacity:.85;overflow:hidden;padding:10px;position:fixed;top:5px;width:300px;z-index:10000}.rs-base div.hidden{display:none}.rs-base h1{color:#fff;cursor:pointer;font-size:1.4em;font-weight:300;margin:0 0 5px;padding:0}.rs-group{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex-direction:column-reverse;flex-direction:column-reverse;margin-bottom:5px}.rs-group:last-child{margin-bottom:0}.rs-counter-base{align-items:center;display:-webkit-box;display:-webkit-flex;display:flex;height:10px;-webkit-justify-content:space-between;justify-content:space-between;margin:2px 0}.rs-counter-base.alarm{color:#b70000;text-shadow:0 0 0 #b70000,0 0 1px #fff,0 0 1px #fff,0 0 2px #fff,0 0 2px #fff,0 0 3px #fff,0 0 3px #fff,0 0 4px #fff,0 0 4px #fff}.rs-counter-id{font-weight:300;-webkit-box-ordinal-group:0;-webkit-order:0;order:0;width:54px}.rs-counter-value{font-weight:300;-webkit-box-ordinal-group:1;-webkit-order:1;order:1;text-align:right;width:35px}.rs-canvas{-webkit-box-ordinal-group:2;-webkit-order:2;order:2}@media (min-width:480px){.rs-base{left:20px;top:20px}}";r("browserify-css").createStyle(o,{href:"src/style/rStats.css"}),a.exports=o},{"browserify-css":4}],188:[function(r,a,s){var o=r("../constants/"),u=r("../core/system").registerSystem,f="data-aframe-default-camera";a.exports.System=u("camera",{init:function(){this.activeCameraEl=null,this.render=this.render.bind(this),this.unwrapRender=this.unwrapRender.bind(this),this.wrapRender=this.wrapRender.bind(this),this.initialCameraFound=!1,this.numUserCameras=0,this.numUserCamerasChecked=0,this.setupInitialCamera()},setupInitialCamera:function(){var m,g,y=this.sceneEl,b=this;if(y.camera&&!y.camera.el.getAttribute("camera").spectator){y.emit("cameraready",{cameraEl:y.camera.el});return}if(m=y.querySelectorAll("a-camera, [camera]"),!m.length){this.createDefaultCamera();return}for(this.numUserCameras=m.length,g=0;g<m.length;g++)m[g].addEventListener("object3dset",function(w){w.detail.type==="camera"&&b.checkUserCamera(this)}),m[g].isNode?m[g].load():m[g].addEventListener("nodeready",function(){this.load()})},checkUserCamera:function(m){var g,y=this.el.sceneEl;if(this.numUserCamerasChecked++,!this.initialCameraFound){if(g=m.getAttribute("camera"),!g.active||g.spectator){this.numUserCamerasChecked===this.numUserCameras&&this.createDefaultCamera();return}this.initialCameraFound=!0,y.camera=m.getObject3D("camera"),y.emit("cameraready",{cameraEl:m})}},createDefaultCamera:function(){var m,g=this.sceneEl;m=document.createElement("a-entity"),m.setAttribute("camera",{active:!0}),m.setAttribute("position",{x:0,y:o.DEFAULT_CAMERA_HEIGHT,z:0}),m.setAttribute("wasd-controls",""),m.setAttribute("look-controls",""),m.setAttribute(o.AFRAME_INJECTED,""),m.addEventListener("object3dset",function(y){y.detail.type==="camera"&&(g.camera=y.detail.object,g.emit("cameraready",{cameraEl:m}))}),g.appendChild(m)},disableActiveCamera:function(){var m,g;m=this.sceneEl.querySelectorAll("[camera]"),g=m[m.length-1],g.setAttribute("camera","active",!0)},setActiveCamera:function(m){var g,y,b,w,A=this.activeCameraEl,M=this.sceneEl;if(w=m.getObject3D("camera"),!(!w||m===this.activeCameraEl)){var S=M.querySelector("["+f+"]"),E=S&&S.querySelector("[camera]");for(m!==E&&v(M),this.activeCameraEl=m,this.activeCameraEl.play(),M.camera=w,A&&A.setAttribute("camera","active",!1),y=M.querySelectorAll("[camera]"),b=0;b<y.length;b++)g=y[b],!(!g.isEntity||m===g)&&(g.setAttribute("camera","active",!1),g.pause());M.emit("camera-set-active",{cameraEl:m})}},setSpectatorCamera:function(m){var g,y=this.spectatorCameraEl,b=this.sceneEl,w;g=m.getObject3D("camera"),!(!g||m===this.spectatorCameraEl)&&(y&&y.setAttribute("camera","spectator",!1),w=this.spectatorCameraEl=m,b.addEventListener("enter-vr",this.wrapRender),b.addEventListener("exit-vr",this.unwrapRender),w.setAttribute("camera","active",!1),w.play(),b.emit("camera-set-spectator",{cameraEl:m}))},disableSpectatorCamera:function(){this.spectatorCameraEl=void 0},wrapRender:function(){!this.spectatorCameraEl||this.originalRender||(this.originalRender=this.sceneEl.renderer.render,this.sceneEl.renderer.render=this.render)},unwrapRender:function(){!this.originalRender||(this.sceneEl.renderer.render=this.originalRender,this.originalRender=void 0)},render:function(m,g){var y,b=this.sceneEl,w;y=b.renderer.xr.enabled,this.originalRender.call(b.renderer,m,g),!(!this.spectatorCameraEl||b.isMobile||!y)&&(w=this.spectatorCameraEl.components.camera.camera,b.renderer.xr.enabled=!1,this.originalRender.call(b.renderer,m,w),b.renderer.xr.enabled=y)}});function v(m){var g,y=m.camera;!y||(g=m.querySelector("["+f+"]"),!!g&&m.removeChild(g))}},{"../constants/":123,"../core/system":142}],189:[function(r,a,s){var o=r("../core/geometry").geometries,u=r("../core/system").registerSystem;a.exports.System=u("geometry",{init:function(){this.cache={},this.cacheCount={}},clearCache:function(){this.cache={},this.cacheCount={}},getOrCreateGeometry:function(g){var y=this.cache,b,w;return g.skipCache?f(g):(w=this.hash(g),b=y[w],m(this.cacheCount,w),b||(b=f(g),y[w]=b,b))},unuseGeometry:function(g){var y=this.cache,b=this.cacheCount,w,A;g.skipCache||(A=this.hash(g),!!y[A]&&(v(b,A),!(b[A]>0)&&(w=y[A],w.dispose(),delete y[A],delete b[A])))},hash:function(g){return JSON.stringify(g)}});function f(g){var y=g.primitive,b=o[y]&&o[y].Geometry,w=new b;if(!b)throw new Error("Unknown geometry `"+y+"`");return w.init(g),w.geometry}function v(g,y){g[y]--}function m(g,y){g[y]=g[y]===void 0?1:g[y]+1}},{"../core/geometry":132,"../core/system":142}],190:[function(r,a,s){var o=r("../core/system").registerSystem,u=r("../lib/three");a.exports.System=o("gltf-model",{schema:{dracoDecoderPath:{default:""}},init:function(){var f=this.data.dracoDecoderPath;this.dracoLoader=new u.DRACOLoader,this.dracoLoader.setDecoderPath(f)},update:function(){var f;this.dracoLoader||(f=this.data.dracoDecoderPath,this.dracoLoader=new u.DRACOLoader,this.dracoLoader.setDecoderPath(f))},getDRACOLoader:function(){return this.dracoLoader}})},{"../core/system":142,"../lib/three":179}],191:[function(r,a,s){r("./camera"),r("./geometry"),r("./gltf-model"),r("./light"),r("./material"),r("./renderer"),r("./shadow"),r("./tracked-controls-webvr"),r("./tracked-controls-webxr"),r("./webxr")},{"./camera":188,"./geometry":189,"./gltf-model":190,"./light":192,"./material":193,"./renderer":194,"./shadow":195,"./tracked-controls-webvr":196,"./tracked-controls-webxr":197,"./webxr":198}],192:[function(r,a,s){var o=r("../core/system").registerSystem,u=r("../utils/bind"),f=r("../constants/"),v="data-aframe-default-light";a.exports.System=o("light",{schema:{defaultLightsEnabled:{default:!0}},init:function(){this.defaultLights=!1,this.userDefinedLights=!1,this.sceneEl.addEventListener("loaded",u(this.setupDefaultLights,this))},registerLight:function(m){m.hasAttribute(v)||(this.removeDefaultLights(),this.userDefinedLights=!0)},removeDefaultLights:function(){var m,g=this.sceneEl;if(!!this.defaultLights){m=document.querySelectorAll("["+v+"]");for(var y=0;y<m.length;y++)g.removeChild(m[y]);this.defaultLights=!1}},setupDefaultLights:function(){var m=this.sceneEl,g,y;this.userDefinedLights||this.defaultLights||!this.data.defaultLightsEnabled||(g=document.createElement("a-entity"),g.setAttribute("light",{color:"#BBB",type:"ambient"}),g.setAttribute(v,""),g.setAttribute(f.AFRAME_INJECTED,""),m.appendChild(g),y=document.createElement("a-entity"),y.setAttribute("light",{color:"#FFF",intensity:.6,castShadow:!0}),y.setAttribute("position",{x:-.5,y:1,z:1}),y.setAttribute(v,""),y.setAttribute(f.AFRAME_INJECTED,""),m.appendChild(y),this.defaultLights=!0)}})},{"../constants/":123,"../core/system":142,"../utils/bind":199}],193:[function(r,a,s){var o=r("../core/system").registerSystem,u=r("../lib/three"),f=r("../utils/"),v=r("../utils/material").isHLS,m=f.bind,g=f.debug,y=g("components:texture:error"),b=new u.TextureLoader,w=g("components:texture:warn");b.setCrossOrigin("anonymous"),a.exports.System=o("material",{init:function(){this.materials={},this.textureCounts={},this.textureCache={},this.sceneEl.addEventListener("materialtextureloaded",m(this.onMaterialTextureLoaded,this))},clearTextureCache:function(){this.textureCache={}},loadTexture:function(C,L,P){var N=this;if(C.tagName==="CANVAS"){this.loadCanvas(C,L,P);return}if(C.tagName==="VIDEO"){!C.src&&!C.srcObject&&!C.childElementCount&&w("Video element was defined with neither `source` elements nor `src` / `srcObject` attributes."),this.loadVideo(C,L,P);return}f.srcLoader.validateSrc(C,F,X);function F(Y){N.loadImage(Y,L,P)}function X(Y){N.loadVideo(Y,L,P)}},loadImage:function(C,L,P){var N=this.hash(L),F=this.textureCache;if(F[N]){F[N].then(P);return}F[N]=M(C,L),F[N].then(P)},loadCanvas:function(C,L,P){var N;N=new u.CanvasTexture(C),S(N,L),P(N)},loadVideo:function(C,L,P){var N,F,X=this.textureCache,Y,ae;function $(de){de.texture.needsUpdate=!0,P(de.texture,de.videoEl)}if(typeof C!="string"){if(Y=C,N=this.hashVideo(L,Y),X[N]){X[N].then($);return}T(Y)}if(Y=Y||E(C,L.width,L.height),N=this.hashVideo(L,Y),X[N]){X[N].then($);return}F=new u.VideoTexture(Y),F.minFilter=u.LinearFilter,S(F,L),this.sceneEl.isIOS&&v(Y.src||Y.getAttribute("src"),Y.type||Y.getAttribute("type"))&&(F.format=u.RGBAFormat,F.needsCorrectionBGRA=!0,F.flipY=!1,F.needsCorrectionFlipY=!0),ae={texture:F,videoEl:Y},X[N]=Promise.resolve(ae),$(ae)},hash:function(C){return C.src.tagName&&(C=f.extendDeep({},C),C.src=C.src.src),JSON.stringify(C)},hashVideo:function(C,L){return A(C,L)},registerMaterial:function(C){this.materials[C.uuid]=C},unregisterMaterial:function(C){delete this.materials[C.uuid];var L=this.textureCounts;Object.keys(C).filter(function(P){return C[P]&&C[P].isTexture}).forEach(function(P){L[C[P].uuid]--,L[C[P].uuid]<=0&&C[P].dispose()})},updateMaterials:function(C){var L=this.materials;Object.keys(L).forEach(function(P){L[P].needsUpdate=!0})},onMaterialTextureLoaded:function(C){this.textureCounts[C.detail.texture.uuid]||(this.textureCounts[C.detail.texture.uuid]=0),this.textureCounts[C.detail.texture.uuid]++}});function A(C,L){var P,N=L.getAttribute("id"),F,X;if(N)return N;for(F="",X=C||{},P=0;P<L.attributes.length;P++)X[L.attributes[P].name]=L.attributes[P].value;return Object.keys(X).sort().forEach(function(Y){F+=Y+":"+X[Y]+";"}),F}function M(C,L){return new Promise(P);function P(N,F){var X=typeof C!="string";function Y(ae){S(ae,L),ae.needsUpdate=!0,N(ae)}if(X){Y(new u.Texture(C));return}b.load(C,Y,function(){},function(ae){y("`$s` could not be fetched (Error code: %s; Response: %s)",ae.status,ae.statusText)})}}function S(C,L){var P=L.offset||{x:0,y:0},N=L.repeat||{x:1,y:1},F=L.npot||!1;F&&(C.wrapS=u.ClampToEdgeWrapping,C.wrapT=u.ClampToEdgeWrapping,C.magFilter=u.LinearFilter,C.minFilter=u.LinearFilter),(N.x!==1||N.y!==1)&&(C.wrapS=u.RepeatWrapping,C.wrapT=u.RepeatWrapping,C.repeat.set(N.x,N.y)),(P.x!==0||P.y!==0)&&C.offset.set(P.x,P.y)}function E(C,L,P){var N=document.createElement("video");return N.width=L,N.height=P,N.setAttribute("playsinline",""),N.setAttribute("webkit-playsinline",""),N.autoplay=!0,N.loop=!0,N.crossOrigin="anonymous",N.addEventListener("error",function(){w("`$s` is not a valid video",C)},!0),N.src=C,N}function T(C){return C.autoplay=C.hasAttribute("autoplay")&&C.getAttribute("autoplay")!=="false",C.controls=C.hasAttribute("controls")&&C.getAttribute("controls")!=="false",C.getAttribute("loop")==="false"&&C.removeAttribute("loop"),C.getAttribute("preload")==="false"&&(C.preload="none"),C.crossOrigin=C.crossOrigin||"anonymous",C.setAttribute("playsinline",""),C.setAttribute("webkit-playsinline",""),C}},{"../core/system":142,"../lib/three":179,"../utils/":205,"../utils/material":209}],194:[function(r,a,s){var o=r("../core/system").registerSystem,u=r("../utils/"),f=r("../lib/three"),v=u.debug,m=v("components:renderer:warn");a.exports.System=o("renderer",{schema:{antialias:{default:"auto",oneOf:["true","false","auto"]},highRefreshRate:{default:u.device.isOculusBrowser()},logarithmicDepthBuffer:{default:"auto",oneOf:["true","false","auto"]},maxCanvasWidth:{default:1920},maxCanvasHeight:{default:1920},physicallyCorrectLights:{default:!1},precision:{default:"high",oneOf:["high","medium","low"]},sortObjects:{default:!1},colorManagement:{default:!1},gammaOutput:{default:!1},alpha:{default:!0},foveationLevel:{default:0}},init:function(){var g=this.data,y=this.el,b=y.renderer;b.sortObjects=g.sortObjects,b.physicallyCorrectLights=g.physicallyCorrectLights,(g.colorManagement||g.gammaOutput)&&(b.outputEncoding=f.sRGBEncoding,g.gammaOutput&&m('Property `gammaOutput` is deprecated. Use `renderer="colorManagement: true;"` instead.')),y.hasAttribute("antialias")&&m('Component `antialias` is deprecated. Use `renderer="antialias: true"` instead.'),y.hasAttribute("logarithmicDepthBuffer")&&m('Component `logarithmicDepthBuffer` is deprecated. Use `renderer="logarithmicDepthBuffer: true"` instead.')},applyColorCorrection:function(g){!this.data.colorManagement||!g||(g.isColor?g.convertSRGBToLinear():g.isTexture&&(g.encoding=f.sRGBEncoding))}})},{"../core/system":142,"../lib/three":179,"../utils/":205}],195:[function(r,a,s){var o=r("../core/system").registerSystem,u=r("../lib/three"),f={basic:u.BasicShadowMap,pcf:u.PCFShadowMap,pcfsoft:u.PCFSoftShadowMap};a.exports.System=o("shadow",{schema:{enabled:{default:!0},autoUpdate:{default:!0},type:{default:"pcf",oneOf:["basic","pcf","pcfsoft"]}},init:function(){var v=this.sceneEl,m=this.data;this.shadowMapEnabled=!1,!!v.renderer&&(v.renderer.shadowMap.type=f[m.type],v.renderer.shadowMap.autoUpdate=m.autoUpdate,this.setShadowMapEnabled(this.shadowMapEnabled))},update:function(v){v.enabled!==this.data.enabled&&this.setShadowMapEnabled(this.data.enabled)},setShadowMapEnabled:function(v){var m=this.sceneEl.renderer;this.shadowMapEnabled=this.data.enabled&&v,m&&(m.shadowMap.enabled=this.shadowMapEnabled)}})},{"../core/system":142,"../lib/three":179}],196:[function(r,a,s){var o=r("../core/system").registerSystem,u=r("../utils"),f=u.device.isWebXRAvailable;a.exports.System=o("tracked-controls-webvr",{init:function(){var v=this;this.controllers=[],this.isChrome=navigator.userAgent.indexOf("Chrome")!==-1,this.updateControllerList(),this.throttledUpdateControllerList=u.throttle(this.updateControllerList,500,this),!f&&(!navigator.getVRDisplays||this.sceneEl.addEventListener("enter-vr",function(){navigator.getVRDisplays().then(function(m){m.length&&(v.vrDisplay=m[0])})}))},tick:function(){this.isChrome?this.updateControllerList():this.throttledUpdateControllerList()},updateControllerList:function(){var v=this.controllers,m,g,y,b;if(g=navigator.getGamepads&&navigator.getGamepads(),!!g){for(b=v.length,v.length=0,y=0;y<g.length;++y)m=g[y],m&&m.pose&&v.push(m);v.length!==b&&this.el.emit("controllersupdated",void 0,!1)}}})},{"../core/system":142,"../utils":205}],197:[function(r,a,s){var o=r("../core/system").registerSystem,u=r("../utils");a.exports.System=o("tracked-controls-webxr",{init:function(){this.controllers=[],this.oldControllers=[],this.oldControllersLength=0,this.throttledUpdateControllerList=u.throttle(this.updateControllerList,500,this),this.updateReferenceSpace=this.updateReferenceSpace.bind(this),this.el.addEventListener("enter-vr",this.updateReferenceSpace),this.el.addEventListener("exit-vr",this.updateReferenceSpace)},tick:function(){this.throttledUpdateControllerList()},updateReferenceSpace:function(){var f=this,v=this.el.xrSession;if(!v){this.referenceSpace=void 0,this.controllers=[],this.oldControllersLength>0&&(this.oldControllersLength=0,this.el.emit("controllersupdated",void 0,!1));return}var m=f.el.sceneEl.systems.webxr.sessionReferenceSpaceType;v.requestReferenceSpace(m).then(function(g){f.referenceSpace=g}).catch(function(g){throw f.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(m,'tracked-controls-webxr uses reference space "'+m+'".'),g})},updateControllerList:function(){var f=this.el.xrSession,v=this.oldControllers,m;if(!f){if(this.oldControllersLength===0)return;this.oldControllersLength=0,this.controllers=[],this.el.emit("controllersupdated",void 0,!1);return}if(!!f.inputSources){if(this.controllers=f.inputSources,this.oldControllersLength===this.controllers.length){var g=!0;for(m=0;m<this.controllers.length;++m)if(!(this.controllers[m]===v[m]&&this.controllers[m].gamepad===v[m].gamepad)){g=!1;break}if(g)return}for(v.length=0,m=0;m<this.controllers.length;m++)v.push(this.controllers[m]);this.oldControllersLength=this.controllers.length,this.el.emit("controllersupdated",void 0,!1)}}})},{"../core/system":142,"../utils":205}],198:[function(r,a,s){var o=r("../core/system").registerSystem,u=r("../utils/"),f=u.debug("systems:webxr:warn");a.exports.System=o("webxr",{schema:{referenceSpaceType:{type:"string",default:"local-floor"},requiredFeatures:{type:"array",default:["local-floor"]},optionalFeatures:{type:"array",default:["bounded-floor"]},overlayElement:{type:"selector"}},update:function(){var v=this.data;this.sessionConfiguration={requiredFeatures:v.requiredFeatures,optionalFeatures:v.optionalFeatures},this.sessionReferenceSpaceType=v.referenceSpaceType,v.overlayElement&&(this.warnIfFeatureNotRequested("dom-overlay"),this.sessionConfiguration.domOverlay={root:v.overlayElement})},wasFeatureRequested:function(v){return!!(v==="viewer"||v==="local"||this.sessionConfiguration.requiredFeatures.includes(v)||this.sessionConfiguration.optionalFeatures.includes(v))},warnIfFeatureNotRequested:function(v,m){if(!this.wasFeatureRequested(v)){var g='Please add the feature "'+v+`" to a-scene's webxr system options in requiredFeatures/optionalFeatures.`;f((m?m+" ":"")+g)}}})},{"../core/system":142,"../utils/":205}],199:[function(r,a,s){a.exports=function(u,f){return function(v){return function(){var g=v.concat(Array.prototype.slice.call(arguments,0));return u.apply(f,g)}}(Array.prototype.slice.call(arguments,2))}},{}],200:[function(r,a,s){var o=r("./debug"),u=r("object-assign"),f=o("utils:coordinates:warn"),v=["x","y","z","w"],m=/^\s*((-?\d*\.{0,1}\d+(e-?\d+)?)\s+){2,3}(-?\d*\.{0,1}\d+(e-?\d+)?)\s*$/;a.exports.regex=m;var g="object",y=/\s+/g;function b(S,E){var T,C,L,P,N,F,X,Y,ae;if(S&&S instanceof Object)return F=S.x===void 0?E&&E.x:S.x,X=S.y===void 0?E&&E.y:S.y,Y=S.z===void 0?E&&E.z:S.z,ae=S.w===void 0?E&&E.w:S.w,F!=null&&(S.x=M(F)),X!=null&&(S.y=M(X)),Y!=null&&(S.z=M(Y)),ae!=null&&(S.w=M(ae)),S;if(S==null)return typeof E===g?u({},E):E;for(T=S.trim().split(y),N={},P=0;P<v.length;P++)if(L=v[P],T[P])N[L]=parseFloat(T[P],10);else{if(C=E&&E[L],C===void 0)continue;N[L]=M(C)}return N}a.exports.parse=b;function w(S){var E;return typeof S!==g?S:(E=S.x+" "+S.y,S.z!=null&&(E+=" "+S.z),S.w!=null&&(E+=" "+S.w),E)}a.exports.stringify=w;function A(S){return m.test(S)}a.exports.isCoordinates=A,a.exports.isCoordinate=function(S){return f("`AFRAME.utils.isCoordinate` has been renamed to `AFRAME.utils.isCoordinates`"),A(S)};function M(S){return S!=null&&S.constructor===String?parseFloat(S,10):S}a.exports.toVector3=function(S){return new THREE.Vector3(S.x,S.y,S.z)}},{"./debug":201,"object-assign":39}],201:[function(r,a,s){(function(o){var u=r("debug"),f=r("object-assign"),v={colors:{debug:"gray",error:"red",info:"gray",warn:"orange"}},m=function(A){var M=u(A);return M.color=y(A),M};f(m,u);function g(A){var M=A.split(":");return M[M.length-1]}function y(A){var M=g(A),S=v.colors&&v.colors[M];return S||null}function b(){try{return window.localStorage}catch{}}var w=b();w&&(parseInt(w.logs,10)||w.logs==="true")?m.enable("*"):m.enable("*:error,*:info,*:warn"),o.browser&&(window.logs=m),a.exports=m}).call(this,r("_process"))},{_process:49,debug:8,"object-assign":39}],202:[function(r,a,s){(function(o){var u=r("debug")("device:error"),f,v=!1,m=!1,g=a.exports.isWebXRAvailable=!window.debug&&navigator.xr!==void 0;if(window.addEventListener("vrdisplayactivate",function(X){var Y;g||(Y=document.createElement("canvas"),f=X.display,Y.getContext("webgl",{}),f.requestPresent([{source:Y}]).then(function(){},function(){}))}),g){var y=function(){var X=document.querySelector("a-scene");if(!X){window.addEventListener("DOMContentLoaded",y);return}X.hasLoaded?X.components["vr-mode-ui"].updateEnterInterfaces():X.addEventListener("loaded",y)},b=function(X){u("WebXR session support error: "+X.message)};navigator.xr.isSessionSupported?(navigator.xr.isSessionSupported("immersive-vr").then(function(X){v=X,y()}).catch(b),navigator.xr.isSessionSupported("immersive-ar").then(function(X){m=X,y()}).catch(function(){})):navigator.xr.supportsSession?(navigator.xr.supportsSession("immersive-vr").then(function(){v=!0,y()}).catch(b),navigator.xr.supportsSession("immersive-ar").then(function(){m=!0,y()}).catch(function(){})):u("WebXR has neither isSessionSupported or supportsSession?!")}else navigator.getVRDisplays&&navigator.getVRDisplays().then(function(X){var Y=document.querySelector("a-scene");f=X.length&&X[0],Y&&Y.emit("displayconnected",{vrDisplay:f})});function w(){return f}a.exports.getVRDisplay=w;function A(){return v||m||!!w()}a.exports.checkHeadsetConnected=A;function M(){return m}a.exports.checkARSupport=M;var S=function(){var X=!1;return function(Y){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(Y)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(Y.substr(0,4)))&&(X=!0),(T()||E()||F())&&(X=!0),N()&&(X=!1)}(window.navigator.userAgent||window.navigator.vendor||window.opera),function(){return X}}();a.exports.isMobile=S;function E(X){var Y=X||window.navigator.userAgent;return/ipad|Nexus (7|9)|xoom|sch-i800|playbook|tablet|kindle/i.test(Y)}a.exports.isTablet=E;function T(){return/iPad|iPhone|iPod/.test(window.navigator.platform)}a.exports.isIOS=T;function C(){return!S()&&!N()&&window.orientation!==void 0}a.exports.isMobileDeviceRequestingDesktopSite=C;function L(){return/(OculusBrowser)/i.test(window.navigator.userAgent)}a.exports.isOculusBrowser=L;function P(){return/(Mobile VR)/i.test(window.navigator.userAgent)}a.exports.isFirefoxReality=P;function N(){return L()||P()}a.exports.isMobileVR=N;function F(){return/R7 Build/.test(window.navigator.userAgent)}a.exports.isR7=F,a.exports.isLandscape=function(){var X=window.orientation;return F()&&(X+=90),X===90||X===-90},a.exports.isBrowserEnvironment=!!(!o||o.browser),a.exports.isNodeEnvironment=!a.exports.isBrowserEnvironment}).call(this,r("_process"))},{_process:49,debug:8}],203:[function(r,a,s){var o={};function u(f,v){return v=v||".",o[v]||(o[v]={}),f.indexOf(v)!==-1?o[v][f]=f.split(v):o[v][f]=f,o[v][f]}a.exports.getComponentPropertyPath=u,a.exports.propertyPathCache=o,a.exports.getComponentProperty=function(f,v,m){var g;return m=m||".",v.indexOf(m)!==-1?(g=u(v,m),g.constructor===String?f.getAttribute(g):f.getAttribute(g[0])[g[1]]):f.getAttribute(v)},a.exports.setComponentProperty=function(f,v,m,g){var y;if(g=g||".",v.indexOf(g)!==-1){y=u(v,g),y.constructor===String?f.setAttribute(y,m):f.setAttribute(y[0],y[1],m);return}f.setAttribute(v,m)}},{}],204:[function(r,a,s){a.exports=function(u){var f=u.style.width,v=u.style.height;u.style.width=parseInt(f,10)+1+"px",u.style.height=parseInt(v,10)+1+"px",setTimeout(function(){u.style.width=f,u.style.height=v},200)}},{}],205:[function(r,a,s){var o=r("./debug"),u=r("deep-assign"),f=r("./device"),v=r("object-assign"),m=r("./object-pool"),g=o("utils:warn");a.exports.bind=r("./bind"),a.exports.coordinates=r("./coordinates"),a.exports.debug=o,a.exports.device=f,a.exports.entity=r("./entity"),a.exports.forceCanvasResizeSafariMobile=r("./forceCanvasResizeSafariMobile"),a.exports.isIE11=r("./is-ie11"),a.exports.material=r("./material"),a.exports.objectPool=m,a.exports.split=r("./split").split,a.exports.styleParser=r("./styleParser"),a.exports.trackedControls=r("./tracked-controls"),a.exports.checkHeadsetConnected=function(){return g("`utils.checkHeadsetConnected` has moved to `utils.device.checkHeadsetConnected`"),f.checkHeadsetConnected(arguments)},a.exports.isGearVR=a.exports.device.isGearVR=function(){g("`utils.isGearVR` has been deprecated, use `utils.device.isMobileVR`")},a.exports.isIOS=function(){return g("`utils.isIOS` has moved to `utils.device.isIOS`"),f.isIOS(arguments)},a.exports.isOculusGo=a.exports.device.isOculusGo=function(){g("`utils.isOculusGo` has been deprecated, use `utils.device.isMobileVR`")},a.exports.isMobile=function(){return g("`utils.isMobile has moved to `utils.device.isMobile`"),f.isMobile(arguments)},a.exports.throttle=function(b,w,A){var M;return A&&(b=a.exports.bind(b,A)),function(){var S=Date.now(),E=typeof M=="undefined"?w:S-M;(typeof M=="undefined"||E>=w)&&(M=S,b.apply(null,arguments))}},a.exports.throttleTick=function(b,w,A){var M;return A&&(b=a.exports.bind(b,A)),function(S,E){var T=typeof M=="undefined"?E:S-M;(typeof M=="undefined"||T>=w)&&(M=S,b(S,T))}},a.exports.debounce=function(b,w,A){var M;return function(){var S=this,E=arguments,T=function(){M=null,A||b.apply(S,E)},C=A&&!M;clearTimeout(M),M=setTimeout(T,w),C&&b.apply(S,E)}},a.exports.extend=v,a.exports.extendDeep=u,a.exports.clone=function(b){return JSON.parse(JSON.stringify(b))};var y=function(){var b=m.createPool(function(){return[]});return function(w,A){var M,S,E,T,C,L;if(w===void 0||A===void 0||w===null||A===null||!(w&&A&&w.constructor===Object&&A.constructor===Object||w.constructor===Array&&A.constructor===Array))return w===A;S=b.use(),E=b.use(),S.length=0,E.length=0;for(M in w)S.push(M);for(M in A)E.push(M);if(S.length!==E.length)return b.recycle(S),b.recycle(E),!1;for(T=0;T<S.length;++T)if(C=w[S[T]],L=A[S[T]],typeof C=="object"||typeof L=="object"||Array.isArray(C)&&Array.isArray(L)){if(C===L)continue;if(!y(C,L))return b.recycle(S),b.recycle(E),!1}else if(C!==L)return b.recycle(S),b.recycle(E),!1;return b.recycle(S),b.recycle(E),!0}}();a.exports.deepEqual=y,a.exports.diff=function(){var b=[];return function(w,A,M){var S,E,T,C,L,P,N;C=M||{},b.length=0;for(L in w)b.push(L);if(!A)return C;for(T in A)b.indexOf(T)===-1&&b.push(T);for(P=0;P<b.length;P++)L=b[P],S=w[L],E=A[L],N=S&&E&&S.constructor===Object&&E.constructor===Object,(N&&!y(S,E)||!N&&S!==E)&&(C[L]=E);return C}}(),a.exports.shouldCaptureKeyEvent=function(b){return b.metaKey?!1:document.activeElement===document.body},a.exports.splitString=function(b,w){typeof w=="undefined"&&(w=" ");var A=new RegExp(w,"g");return b=(b||"").replace(A,w),b.split(w)},a.exports.getElData=function(b,w){w=w||{};var A={};Object.keys(w).forEach(M);function M(S){b.hasAttribute(S)&&(A[S]=b.getAttribute(S))}return A},a.exports.getUrlParameter=function(b){b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var w=new RegExp("[\\?&]"+b+"=([^&#]*)"),A=w.exec(location.search);return A===null?"":decodeURIComponent(A[1].replace(/\+/g," "))},a.exports.isIframed=function(){return window.top!==window.self},a.exports.findAllScenes=function(b){for(var w=[],A=b.getElementsByTagName("*"),M=0,S=A.length;M<S;M++)A[M].isScene&&w.push(A[M]);return w},a.exports.srcLoader=r("./src-loader")},{"./bind":199,"./coordinates":200,"./debug":201,"./device":202,"./entity":203,"./forceCanvasResizeSafariMobile":204,"./is-ie11":207,"./material":209,"./object-pool":210,"./split":211,"./src-loader":212,"./styleParser":213,"./tracked-controls":214,"deep-assign":10,"object-assign":39}],206:[function(r,a,s){window.addEventListener("orientationchange",function(){document.documentElement.style.height="initial",setTimeout(function(){document.documentElement.style.height="100%",setTimeout(function(){window.scrollTo(0,1)},500)},500)})},{}],207:[function(r,a,s){function o(){var u=-1,f=navigator.userAgent,v;return navigator.appName==="Microsoft Internet Explorer"?(v=new RegExp("MSIE ([0-9]{1,}[\\.0-9]{0,})"),v.exec(f)!=null&&(u=parseFloat(RegExp.$1))):navigator.appName==="Netscape"&&(v=new RegExp("Trident/.*rv:([0-9]{1,}[\\.0-9]{0,})"),v.exec(f)!=null&&(u=parseFloat(RegExp.$1))),u}a.exports=o()===11},{}],208:[function(r,a,s){a.exports=function(u){return/(iphone|ipod|ipad).*os.(7_|8_|9_)/i.test(u)}},{}],209:[function(r,a,s){var o=r("../lib/three"),u=["application/x-mpegurl","application/vnd.apple.mpegurl"],f=new Set(["emissiveMap","envMap","map","specularMap"]);a.exports.updateMapMaterialFromData=function(m,g,y,b){var w=y.el,A=y.material,M=w.sceneEl.systems.renderer,S=b[g];if(y.materialSrcs||(y.materialSrcs={}),!S){delete y.materialSrcs[m],T(null);return}if(S===y.materialSrcs[m])return;y.materialSrcs[m]=S,S instanceof o.Texture?T(S):w.sceneEl.systems.material.loadTexture(S,{src:S,repeat:b.repeat,offset:b.offset,npot:b.npot},E);function E(C){y.materialSrcs[m]===S&&T(C)}function T(C){A[m]=C,C&&f.has(m)&&M.applyColorCorrection(C),A.needsUpdate=!0,v(w,C)}},a.exports.updateMap=function(m,g){return a.exports.updateMapMaterialFromData("map","src",m,g)},a.exports.updateDistortionMap=function(m,g,y){var b=m;m==="ambientOcclusion"&&(b="ao");var w=g.el,A=g.material,M=w.sceneEl.systems.renderer,S=y[m+"Map"],E={};if(E.src=S,E.offset=y[m+"TextureOffset"],E.repeat=y[m+"TextureRepeat"],E.wrap=y[m+"TextureWrap"],S){if(S===g[m+"TextureSrc"])return;g[m+"TextureSrc"]=S,w.sceneEl.systems.material.loadTexture(S,E,T);return}if(!A.map)return;T(null);function T(C){var L=b+"Map";A[L]=C,C&&f.has(L)&&M.applyColorCorrection(C),A.needsUpdate=!0,v(w,C)}};function v(m,g){!g||(m.emit("materialtextureloaded",{src:g.image,texture:g}),!(!g.image||g.image.tagName!=="VIDEO")&&(g.image.addEventListener("loadeddata",function(){!m.components||!m.components.material||(g.needsCorrectionBGRA&&g.needsCorrectionFlipY&&["standard","flat"].indexOf(m.components.material.data.shader)!==-1&&m.setAttribute("material","shader","ios10hls"),m.emit("materialvideoloadeddata",{src:g.image,texture:g}))}),g.image.addEventListener("ended",function(){m.emit("materialvideoended",{src:g.image,texture:g})})))}a.exports.handleTextureEvents=v,a.exports.isHLS=function(m,g){return!!(g&&u.includes(g.toLowerCase())||m&&m.toLowerCase().indexOf(".m3u8")>0)}},{"../lib/three":179}],210:[function(r,a,s){var o=Object.freeze(Object.create(null));function u(){return{}}a.exports.createPool=function(g){var y=[],b=null;g=g||u;function w(){var E;return(b===null||b===y.length)&&M(y.length||5),E=y[b],y[b++]=o,f(E),E}function A(E){if(E instanceof Object){if(b===null||b===-1){y[y.length]=E;return}y[--b]=E}}function M(E){var T,C;if(E=E===void 0?y.length:E,E>0&&b==null&&(b=0),E>0)for(T=y.length,y.length+=Number(E),C=T;C<y.length;C++)y[C]=g();return y.length}function S(){return y.length}return{grow:M,pool:y,recycle:A,size:S,use:w}};function f(m){var g;if(!(!m||m.constructor!==Object))for(g in m)m[g]=void 0}a.exports.clearObject=f;function v(m,g){var y;if(!(!m||m.constructor!==Object))for(y in m)y in g||delete m[y]}a.exports.removeUnusedKeys=v},{}],211:[function(r,a,s){a.exports.split=function(){var o={};return function(u,f){return f in o||(o[f]={}),u in o[f]||(o[f][u]=u.split(f)),o[f][u]}}()},{}],212:[function(r,a,s){var o=r("./debug"),u=o("utils:src-loader:warn");function f(w,A,M){g(w,function(E){if(E){A(w);return}M(w)})}function v(w,A){var M,S="",E,T,C=[];for(E=0;E<5;E++)S+="(url\\((?:[^\\)]+)\\),\\s*)";S+="(url\\((?:[^\\)]+)\\)\\s*)",T=w.match(new RegExp(S));function L(P){C.push(P),C.length===6&&A(C)}if(T){for(E=1;E<7;E++)f(m(T[E]),L);return}if(M=b(w),!!M){if(M.tagName==="A-CUBEMAP"&&M.srcs)return A(M.srcs);u('Selector "%s" does not point to <a-cubemap>',w)}}function m(w){var A=w.match(/\url\((.+)\)/);if(!!A)return A[1]}function g(w,A){var M;if(w.tagName){A(w.tagName==="IMG");return}M=new XMLHttpRequest,M.open("HEAD",w),M.addEventListener("load",function(S){var E;M.status>=200&&M.status<300?(E=M.getResponseHeader("Content-Type"),E==null?y(w,A):E.startsWith("image")?A(!0):A(!1)):y(w,A),M.abort()}),M.send()}function y(w,A){var M=new Image;M.addEventListener("load",S);function S(){A(!0)}M.addEventListener("error",E);function E(){A(!1)}M.src=w}function b(w){try{var A=document.querySelector(w);return A||u('No element was found matching the selector: "%s"',w),A}catch{u('"%s" is not a valid selector',w);return}}a.exports={parseUrl:m,validateSrc:f,validateCubemapSrc:v}},{"./debug":201}],213:[function(r,a,s){var o=/-([a-z])/g;a.exports.parse=function(b,w){var A;return typeof b!="string"||(A=m(b,w),A[""])?b:f(A)},a.exports.stringify=function(b){return typeof b=="string"?b:g(b)};function u(b){return b.replace(o,y)}a.exports.toCamelCase=u;function f(b){var w,A;for(A in b)w=u(A),A!==w&&(b[w]=b[A],delete b[A]);return b}a.exports.transformKeysToCamelCase=f;var v=function(){var b=[],w=/url\([^)]+$/;return function(M){var S="",E,T=0,C=";";for(b.length=0;T<M.length;){if(E=M.indexOf(C,T),E===-1&&(E=M.length),S+=M.substring(T,E),w.test(S)){S+=";",T=E+1;continue}b.push(S.trim()),S="",T=E+1}return b}}();function m(b,w){var A,M,S,E,T,C;for(w=w||{},A=v(b),M=0;M<A.length;M++)S=A[M],!!S&&(E=S.indexOf(":"),T=S.substr(0,E).trim(),C=S.substr(E+1).trim(),w[T]=C);return w}function g(b){var w,A=0,M=0,S="";for(w in b)A++;for(w in b)S+=w+": "+b[w],M<A-1&&(S+="; "),M++;return S}function y(b){return b[1].toUpperCase()}},{}],214:[function(r,a,s){var o=r("../constants").DEFAULT_HANDEDNESS,u=["x","y","z","w"],f=2;a.exports.checkControllerPresentAndSetup=function(b,w,A){var M=b.el,S,E=M.sceneEl.hasWebXR,T=E?m:v,C;if(S=T(b,w,A),C=!!S,b.controllerPresent&&!b.controllerEventsActive&&!E&&b.addEventListeners(),C===b.controllerPresent)return C;b.controllerPresent=C,C?(b.addEventListeners(),b.injectTrackedControls(S),M.emit("controllerconnected",{name:b.name,component:b})):(b.removeEventListeners(),M.emit("controllerdisconnected",{name:b.name,component:b}))};function v(b,w,A){var M,S=b.el.sceneEl,E,T=A.index||0;return!w||(E=S&&S.systems["tracked-controls-webvr"],!E)||(M=E.controllers,!M.length)?!1:!!g(M,null,w,A.hand,T)}function m(b,w,A){var M,S=b.el.sceneEl,E=S&&S.systems["tracked-controls-webxr"];return!E||(M=E.controllers,!M||!M.length)?!1:y(M,w,A.hand,A.index,A.iterateControllerProfiles,A.handTracking)}a.exports.isControllerPresentWebVR=v,a.exports.isControllerPresentWebXR=m;function g(b,w,A,M,S){var E,T,C=0,L=S>=0?S:0;for(T=0;T<b.length;T++)if(E=b[T],!(A&&!E.id.startsWith(A))&&!(!A&&E.id!==w)&&!(M&&E.hand&&M!==E.hand)){if(M&&!E.hand)L=f*S+(M===o?0:1);else return E;if(C===L)return E;++C}}function y(b,w,A,M,S,E){var T,C,L,P=!1,N,F;for(T=0;T<b.length;T++){if(L=b[T],F=L.profiles,E)P=L.hand;else if(S)for(C=0;C<F.length&&(P=F[C].startsWith(w),!P);C++);else P=F.length>0&&F[0].startsWith(w);if(!!P){if(N=L.handedness==="right"||L.handedness==="left",N){if(L.handedness===A)return b[T]}else if(T===M)return b[T]}}}a.exports.findMatchingControllerWebVR=g,a.exports.findMatchingControllerWebXR=y,a.exports.emitIfAxesChanged=function(b,w,A){var M,S,E,T,C;for(S in w){for(M=w[S],E=!1,C=0;C<M.length;C++)A.detail.changed[M[C]]&&(E=!0);if(!!E){for(T={},C=0;C<M.length;C++)T[u[C]]=A.detail.axis[M[C]];b.el.emit(S+"moved",T)}}},a.exports.onButtonEvent=function(b,w,A,M){var S=M?A.mapping[M]:A.mapping,E=S.buttons[b];A.el.emit(E+w),A.updateModel&&A.updateModel(E,w)}},{"../constants":123}],215:[function(r,a,s){THREE.DeviceOrientationControls=function(o){var u=this;this.object=o,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0;var f=function(g){u.deviceOrientation=g},v=function(){u.screenOrientation=window.orientation||0},m=function(){var g=new THREE.Vector3(0,0,1),y=new THREE.Euler,b=new THREE.Quaternion,w=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));return function(A,M,S,E,T){y.set(S,M,-E,"YXZ"),A.setFromEuler(y),A.multiply(w),A.multiply(b.setFromAxisAngle(g,-T))}}();this.connect=function(){v(),window.addEventListener("orientationchange",v,!1),window.addEventListener("deviceorientation",f,!1),u.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",v,!1),window.removeEventListener("deviceorientation",f,!1),u.enabled=!1},this.update=function(){if(u.enabled!==!1){var g=u.deviceOrientation;if(g){var y=g.alpha?THREE.Math.degToRad(g.alpha)+u.alphaOffset:0,b=g.beta?THREE.Math.degToRad(g.beta):0,w=g.gamma?THREE.Math.degToRad(g.gamma):0,A=u.screenOrientation?THREE.Math.degToRad(u.screenOrientation):0;m(u.object.quaternion,y,b,w,A)}}},this.dispose=function(){u.disconnect()},this.connect()}},{}],216:[function(r,a,s){window.glStats=function(){var o=null,u=0,f=0,v=0,m=0,g=0,y=0,b=0;function w(P,N){return function(){N.apply(this,arguments),P.apply(this,arguments)}}WebGLRenderingContext.prototype.drawArrays=w(WebGLRenderingContext.prototype.drawArrays,function(){u++,arguments[0]==this.POINTS?y+=arguments[2]:g+=arguments[2]}),WebGLRenderingContext.prototype.drawElements=w(WebGLRenderingContext.prototype.drawElements,function(){f++,m+=arguments[1]/3,g+=arguments[1]}),WebGLRenderingContext.prototype.useProgram=w(WebGLRenderingContext.prototype.useProgram,function(){v++}),WebGLRenderingContext.prototype.bindTexture=w(WebGLRenderingContext.prototype.bindTexture,function(){b++});var A={allcalls:{over:3e3,caption:"Calls (hook)"},drawelements:{caption:"drawElements (hook)"},drawarrays:{caption:"drawArrays (hook)"}},M=[{caption:"WebGL",values:["allcalls","drawelements","drawarrays","useprogram","bindtexture","glfaces","glvertices","glpoints"]}],S=[{base:"allcalls",steps:["drawelements","drawarrays"]}];function E(){o("allcalls").set(u+f),o("drawElements").set(f),o("drawArrays").set(u),o("bindTexture").set(b),o("useProgram").set(v),o("glfaces").set(m),o("glvertices").set(g),o("glpoints").set(y)}function T(){u=0,f=0,v=0,m=0,g=0,y=0,b=0}function C(){}function L(P){o=P}return{update:E,start:T,end:C,attach:L,values:A,groups:M,fractions:S}},window.threeStats=function(o){var u=null,f={"renderer.info.memory.geometries":{caption:"Geometries"},"renderer.info.memory.textures":{caption:"Textures"},"renderer.info.programs":{caption:"Programs"},"renderer.info.render.calls":{caption:"Calls"},"renderer.info.render.triangles":{caption:"Triangles",over:1e3},"renderer.info.render.points":{caption:"Points"}},v=[{caption:"Three.js - Memory",values:["renderer.info.memory.geometries","renderer.info.programs","renderer.info.memory.textures"]},{caption:"Three.js - Render",values:["renderer.info.render.calls","renderer.info.render.triangles","renderer.info.render.points"]}],m=[];function g(){u("renderer.info.memory.geometries").set(o.info.memory.geometries),u("renderer.info.programs").set(o.info.programs.length),u("renderer.info.memory.textures").set(o.info.memory.textures),u("renderer.info.render.calls").set(o.info.render.calls),u("renderer.info.render.triangles").set(o.info.render.triangles),u("renderer.info.render.points").set(o.info.render.points)}function y(){}function b(){}function w(A){u=A}return{update:g,start:y,end:b,attach:w,values:f,groups:v,fractions:m}},window.BrowserStats=function(){var o=null,u=0,f=0;window.performance&&!performance.memory&&(performance.memory={usedJSHeapSize:0,totalJSHeapSize:0}),performance.memory.totalJSHeapSize===0&&console.warn("totalJSHeapSize === 0... performance.memory is only available in Chrome .");var v={memory:{caption:"Used Memory",average:!0,avgMs:1e3,over:22},total:{caption:"Total Memory"}},m=[{caption:"Browser",values:["memory","total"]}],g=[{base:"total",steps:["memory"]}],y=Math.log(1024);function b(E){var T=100,C=Math.floor(Math.log(E)/y);return Math.round(E*T/Math.pow(1024,C))/T}function w(){u=b(performance.memory.usedJSHeapSize),f=b(performance.memory.totalJSHeapSize),o("memory").set(u),o("total").set(f)}function A(){u=0}function M(){}function S(E){o=E}return{update:w,start:A,end:M,attach:S,values:v,groups:m,fractions:g}},typeof a=="object"&&(a.exports={glStats:window.glStats,threeStats:window.threeStats,BrowserStats:window.BrowserStats})},{}],217:[function(r,a,s){(function(){"performance"in window||(window.performance={});var o=window.performance;if(!("now"in o)){var u=Date.now();o.timing&&o.timing.navigationStart&&(u=o.timing.navigationStart),o.now=function(){return Date.now()-u}}o.mark||(o.mark=function(){}),o.measure||(o.measure=function(){})})(),window.rStats=function(u){function f(Y,ae){for(var $=Object.keys(Y),de=0,D=$.length;de<D;de++)ae($[de])}function v(Y){var ae=document.createElement("link");ae.href=Y,ae.rel="stylesheet",ae.type="text/css",document.getElementsByTagName("head")[0].appendChild(ae)}var m=u||{},g=m.colours||["#850700","#c74900","#fcb300","#284280","#4c7c0c"],y="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,300",b=(m.CSSPath?m.CSSPath:"")+"rStats.css",w=m.css||[y,b];w.forEach(function(Y){v(Y)}),m.values||(m.values={});var A,M,S=10,E=200,T={};function C(Y,ae,$){var de=$||{},D=document.createElement("canvas"),I=D.getContext("2d"),k=0,U=0,W=de.color?de.color:"#666666",ce=document.createElement("canvas"),oe=ce.getContext("2d");ce.width=1,ce.height=2*S,oe.fillStyle="#444444",oe.fillRect(0,0,1,2*S),oe.fillStyle=W,oe.fillRect(0,S,1,S),oe.fillStyle="#ffffff",oe.globalAlpha=.5,oe.fillRect(0,S,1,1),oe.globalAlpha=1;var ge=document.createElement("canvas"),_e=ge.getContext("2d");ge.width=1,ge.height=2*S,_e.fillStyle="#444444",_e.fillRect(0,0,1,2*S),_e.fillStyle="#b70000",_e.fillRect(0,S,1,S),_e.globalAlpha=.5,_e.fillStyle="#ffffff",_e.fillRect(0,S,1,1),_e.globalAlpha=1;function Ne(){D.width=E,D.height=S,D.style.width=D.width+"px",D.style.height=D.height+"px",D.className="rs-canvas",Y.appendChild(D),I.fillStyle="#444444",I.fillRect(0,0,D.width,D.height)}function Ie(Ve,Le){U+=(Ve-U)*.1,k*=.99,U>k&&(k=U),I.drawImage(D,1,0,D.width-1,D.height,0,0,D.width-1,D.height),Le?I.drawImage(ge,D.width-1,D.height-U*D.height/k-S):I.drawImage(ce,D.width-1,D.height-U*D.height/k-S)}return Ne(),{draw:Ie}}function L(Y,ae){var $=document.createElement("canvas"),de=$.getContext("2d");function D(){$.width=E,$.height=S*ae,$.style.width=$.width+"px",$.style.height=$.height+"px",$.className="rs-canvas",Y.appendChild($),de.fillStyle="#444444",de.fillRect(0,0,$.width,$.height)}function I(k){de.drawImage($,1,0,$.width-1,$.height,0,0,$.width-1,$.height);var U=0;f(k,function(W){var ce=k[W]*$.height;de.fillStyle=g[W],de.fillRect($.width-1,U,1,ce),U+=ce})}return D(),{draw:I}}function P(Y,ae){var $=Y,de,D=0,I=0,k=0,U=0,W=performance.now(),ce=0,oe=document.createElement("div"),ge=document.createElement("span"),_e=document.createElement("div"),Ne=document.createTextNode(""),Ie=m?m.values[$.toLowerCase()]:null,Ve=new C(oe,$,Ie),Le=!1;ge.className="rs-counter-id",ge.textContent=Ie&&Ie.caption?Ie.caption:$,_e.className="rs-counter-value",_e.appendChild(Ne),oe.appendChild(ge),oe.appendChild(_e),ae?ae.div.appendChild(oe):M.appendChild(oe),de=performance.now();function Fe(H){if(Ie&&Ie.average){U+=H,ce++;var j=performance.now();j-W>=(Ie.avgMs||1e3)&&(k=U/ce,U=0,W=j,ce=0)}}function Me(){de=performance.now(),m.userTimingAPI&&performance.mark($+"-start"),Le=!0}function Qe(){D=performance.now()-de,m.userTimingAPI&&(performance.mark($+"-end"),Le&&performance.measure($,$+"-start",$+"-end")),Fe(D)}function mt(){Qe(),Me()}function ht(){var H=Ie&&Ie.average?k:D;Ne.nodeValue=Math.round(H*100)/100;var j=Ie&&(Ie.below&&D<Ie.below||Ie.over&&D>Ie.over);Ve.draw(D,j),oe.className=j?"rs-counter-base alarm":"rs-counter-base"}function ye(){var H=performance.now(),j=H-de;I++,j>1e3&&(Ie&&Ie.interpolate===!1?D=I:D=I*1e3/j,I=0,de=H,Fe(D))}function fe(H){D=H,Fe(D)}return{set:fe,start:Me,tick:mt,end:Qe,frame:ye,value:function(){return D},draw:ht}}function N(Y){var ae=Y.toLowerCase();if(ae===void 0&&(ae="default"),T[ae])return T[ae];var $=null;m&&m.groups&&f(m.groups,function(D){var I=m.groups[parseInt(D,10)];!$&&I.values.indexOf(ae.toLowerCase())!==-1&&($=I)});var de=new P(ae,$);return T[ae]=de,de}function F(){if(m.plugins){m.values||(m.values={}),m.groups||(m.groups=[]),m.fractions||(m.fractions=[]);for(var Y=0;Y<m.plugins.length;Y++)m.plugins[Y].attach(N),f(m.plugins[Y].values,function(ae){m.values[ae]=m.plugins[Y].values[ae]}),m.groups=m.groups.concat(m.plugins[Y].groups),m.fractions=m.fractions.concat(m.plugins[Y].fractions)}else m.plugins={};A=document.createElement("div"),A.className="rs-base",M=document.createElement("div"),M.className="rs-container",M.style.height="auto",A.appendChild(M),document.body.appendChild(A),!!m&&(m.groups&&f(m.groups,function(ae){var $=m.groups[parseInt(ae,10)],de=document.createElement("div");de.className="rs-group",$.div=de;var D=document.createElement("h1");D.textContent=$.caption,D.addEventListener("click",function(I){this.classList.toggle("hidden"),I.preventDefault()}.bind(de)),M.appendChild(D),M.appendChild(de)}),m.fractions&&f(m.fractions,function(ae){var $=m.fractions[parseInt(ae,10)],de=document.createElement("div");de.className="rs-fraction";var D=document.createElement("div");D.className="rs-legend";var I=0;f(m.fractions[ae].steps,function(U){var W=document.createElement("p");W.textContent=m.fractions[ae].steps[U],W.style.color=g[I],D.appendChild(W),I++}),de.appendChild(D),de.style.height=I*S+"px",$.div=de;var k=new L(de,I);$.graph=k,M.appendChild(de)}))}function X(){f(m.plugins,function(Y){m.plugins[Y].update()}),f(T,function(Y){T[Y].draw()}),m&&m.fractions&&f(m.fractions,function(Y){var ae=m.fractions[parseInt(Y,10)],$=[],de=T[ae.base.toLowerCase()];de&&(de=de.value(),f(m.fractions[Y].steps,function(D){var I=m.fractions[Y].steps[parseInt(D,10)].toLowerCase(),k=T[I];k&&$.push(k.value()/de)})),ae.graph.draw($)})}return F(),function(Y){return Y?N(Y):{element:A,update:X}}},typeof a=="object"&&(a.exports=window.rStats)},{}],218:[function(r,a,s){String.prototype.startsWith||(String.prototype.startsWith=function(o,u){return u=u||0,this.substr(u,o.length)===o})},{}],219:[function(r,a,s){var o={};o.base64=function(u,f){return"data:"+u+";base64,"+f},o.isMobile=function(){var u=!1;return function(f){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(f)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(f.substr(0,4)))&&(u=!0)}(navigator.userAgent||navigator.vendor||window.opera),u},o.isIOS=function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},o.isIFrame=function(){try{return window.self!==window.top}catch{return!0}},o.appendQueryParameter=function(u,f,v){var m=u.indexOf("?")<0?"?":"&";return u+=m+f+"="+v,u},o.getQueryParameter=function(u){u=u.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var f=new RegExp("[\\?&]"+u+"=([^&#]*)"),v=f.exec(location.search);return v===null?"":decodeURIComponent(v[1].replace(/\+/g," "))},o.isLandscapeMode=function(){return window.orientation==90||window.orientation==-90},a.exports=o},{}],220:[function(r,a,s){var o=r("./util.js");function u(){var m=document.createElement("video");m.addEventListener("ended",function(){m.play()}),this.request=function(){m.paused&&(m.src=o.base64("video/webm","GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4ECQoWBAhhTgGcBAAAAAAAH4xFNm3RALE27i1OrhBVJqWZTrIHfTbuMU6uEFlSua1OsggEwTbuMU6uEHFO7a1OsggfG7AEAAAAAAACkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAAEUq17GDD0JATYCNTGF2ZjU2LjQwLjEwMVdBjUxhdmY1Ni40MC4xMDFzpJAGSJTMbsLpDt/ySkipgX1fRImIQO1MAAAAAAAWVK5rAQAAAAAAADuuAQAAAAAAADLXgQFzxYEBnIEAIrWcg3VuZIaFVl9WUDmDgQEj44OEO5rKAOABAAAAAAAABrCBsLqBkB9DtnUBAAAAAAAAo+eBAKOmgQAAgKJJg0IAAV4BHsAHBIODCoAACmH2MAAAZxgz4dPSTFi5JACjloED6ACmAECSnABMQAADYAAAWi0quoCjloEH0ACmAECSnABNwAADYAAAWi0quoCjloELuACmAECSnABNgAADYAAAWi0quoCjloEPoACmAECSnABNYAADYAAAWi0quoCjloETiACmAECSnABNIAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTnghdwo5aBAAAApgBAkpwATOAAA2AAAFotKrqAo5aBA+gApgBAkpwATMAAA2AAAFotKrqAo5aBB9AApgBAkpwATIAAA2AAAFotKrqAo5aBC7gApgBAkpwATEAAA2AAAFotKrqAo5aBD6AApgDAkpwAQ2AAA2AAAFotKrqAo5aBE4gApgBAkpwATCAAA2AAAFotKrqAH0O2dQEAAAAAAACU54Iu4KOWgQAAAKYAQJKcAEvAAANgAABaLSq6gKOWgQPoAKYAQJKcAEtgAANgAABaLSq6gKOWgQfQAKYAQJKcAEsAAANgAABaLSq6gKOWgQu4AKYAQJKcAEqAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEogAANgAABaLSq6gKOWgROIAKYAQJKcAEnAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCRlCjloEAAACmAECSnABJgAADYAAAWi0quoCjloED6ACmAECSnABJIAADYAAAWi0quoCjloEH0ACmAMCSnABDYAADYAAAWi0quoCjloELuACmAECSnABI4AADYAAAWi0quoCjloEPoACmAECSnABIoAADYAAAWi0quoCjloETiACmAECSnABIYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngl3Ao5aBAAAApgBAkpwASCAAA2AAAFotKrqAo5aBA+gApgBAkpwASAAAA2AAAFotKrqAo5aBB9AApgBAkpwAR8AAA2AAAFotKrqAo5aBC7gApgBAkpwAR4AAA2AAAFotKrqAo5aBD6AApgBAkpwAR2AAA2AAAFotKrqAo5aBE4gApgBAkpwARyAAA2AAAFotKrqAH0O2dQEAAAAAAACU54J1MKOWgQAAAKYAwJKcAENgAANgAABaLSq6gKOWgQPoAKYAQJKcAEbgAANgAABaLSq6gKOWgQfQAKYAQJKcAEagAANgAABaLSq6gKOWgQu4AKYAQJKcAEaAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEZAAANgAABaLSq6gKOWgROIAKYAQJKcAEYAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCjKCjloEAAACmAECSnABF4AADYAAAWi0quoCjloED6ACmAECSnABFwAADYAAAWi0quoCjloEH0ACmAECSnABFoAADYAAAWi0quoCjloELuACmAECSnABFgAADYAAAWi0quoCjloEPoACmAMCSnABDYAADYAAAWi0quoCjloETiACmAECSnABFYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngqQQo5aBAAAApgBAkpwARUAAA2AAAFotKrqAo5aBA+gApgBAkpwARSAAA2AAAFotKrqAo5aBB9AApgBAkpwARQAAA2AAAFotKrqAo5aBC7gApgBAkpwARQAAA2AAAFotKrqAo5aBD6AApgBAkpwAROAAA2AAAFotKrqAo5aBE4gApgBAkpwARMAAA2AAAFotKrqAH0O2dQEAAAAAAACU54K7gKOWgQAAAKYAQJKcAESgAANgAABaLSq6gKOWgQPoAKYAQJKcAESAAANgAABaLSq6gKOWgQfQAKYAwJKcAENgAANgAABaLSq6gKOWgQu4AKYAQJKcAERgAANgAABaLSq6gKOWgQ+gAKYAQJKcAERAAANgAABaLSq6gKOWgROIAKYAQJKcAEQgAANgAABaLSq6gB9DtnUBAAAAAAAAlOeC0vCjloEAAACmAECSnABEIAADYAAAWi0quoCjloED6ACmAECSnABEAAADYAAAWi0quoCjloEH0ACmAECSnABD4AADYAAAWi0quoCjloELuACmAECSnABDwAADYAAAWi0quoCjloEPoACmAECSnABDoAADYAAAWi0quoCjloETiACmAECSnABDgAADYAAAWi0quoAcU7trAQAAAAAAABG7j7OBALeK94EB8YIBd/CBAw=="),m.play())},this.release=function(){m.pause(),m.src=""}}function f(){var m=null;this.request=function(){m||(m=setInterval(function(){window.location.href="/",setTimeout(window.stop,0)},15e3))},this.release=function(){m&&(clearInterval(m),m=null)}}function v(){var m=navigator.userAgent||navigator.vendor||window.opera;return m.match(/iPhone/i)||m.match(/iPod/i)?f:u}a.exports=v()},{"./util.js":219}]},{},[177])(177)})})(OK);const SR=.1;AFRAME.registerComponent("checkpoint-controls",{schema:{enabled:{default:!0},mode:{default:"teleport",oneOf:["teleport","animate"]},animateSpeed:{default:3}},init:function(){this.active=!0,this.checkpoint=null,this.isNavMeshConstrained=!1,this.offset=new THREE.Vector3,this.position=new THREE.Vector3,this.targetPosition=new THREE.Vector3},play:function(){this.active=!0},pause:function(){this.active=!1},setCheckpoint:function(i){const n=this.el;if(!!this.active&&this.checkpoint!==i){if(this.checkpoint&&n.emit("navigation-end",{checkpoint:this.checkpoint}),this.checkpoint=i,this.sync(),this.position.distanceTo(this.targetPosition)<SR){this.checkpoint=null;return}n.emit("navigation-start",{checkpoint:i}),this.data.mode==="teleport"&&(this.el.setAttribute("position",this.targetPosition),this.checkpoint=null,n.emit("navigation-end",{checkpoint:i}),n.components["movement-controls"].updateNavLocation())}},isVelocityActive:function(){return!!(this.active&&this.checkpoint)},getVelocity:function(){if(!this.active)return;const i=this.data,n=this.offset,r=this.position,a=this.targetPosition,s=this.checkpoint;return this.sync(),r.distanceTo(a)<SR?(this.checkpoint=null,this.el.emit("navigation-end",{checkpoint:s}),n.set(0,0,0)):(n.setLength(i.animateSpeed),n)},sync:function(){const i=this.offset,n=this.position,r=this.targetPosition;n.copy(this.el.getAttribute("position")),this.checkpoint.object3D.getWorldPosition(r),r.add(this.checkpoint.components.checkpoint.getOffset()),i.copy(r).sub(n)}});var IK=Object.assign(function(){},{FACE_1:0,FACE_2:1,FACE_3:2,FACE_4:3,L_SHOULDER_1:4,R_SHOULDER_1:5,L_SHOULDER_2:6,R_SHOULDER_2:7,SELECT:8,START:9,DPAD_UP:12,DPAD_DOWN:13,DPAD_LEFT:14,DPAD_RIGHT:15,VENDOR:16});function kK(i,n,r){this.type=i,this.index=n,this.pressed=r.pressed,this.value=r.value}var FK=kK;const Jh=IK,Rw=FK,ec=.2,Ks={LEFT:"left",RIGHT:"right"},Zs={MOVEMENT:1,ROTATION:2};AFRAME.registerComponent("gamepad-controls",{GamepadButton:Jh,schema:{enabled:{default:!0},camera:{default:"[camera]",type:"selector"},rotationSensitivity:{default:2}},init:function(){const i=this.el.sceneEl;this.system=i.systems["tracked-controls-webxr"]||{controllers:[]},this.prevTime=window.performance.now(),this.buttons={};const n=this.el.object3D.rotation;this.pitch=new THREE.Object3D,this.pitch.rotation.x=THREE.Math.degToRad(n.x),this.yaw=new THREE.Object3D,this.yaw.position.y=10,this.yaw.rotation.y=THREE.Math.degToRad(n.y),this.yaw.add(this.pitch),this._lookVector=new THREE.Vector2,this._moveVector=new THREE.Vector2,this._dpadVector=new THREE.Vector2,i.addBehavior(this)},update:function(){this.tick()},tick:function(i,n){this.updateButtonState(),this.updateRotation(n)},remove:function(){},isVelocityActive:function(){if(!this.data.enabled||!this.isConnected())return!1;const i=this._dpadVector,n=this._moveVector;this.getDpad(i),this.getJoystick(Zs.MOVEMENT,n);const r=i.x||n.x,a=i.y||n.y;return Math.abs(r)>ec||Math.abs(a)>ec},getVelocityDelta:function(){const i=this._dpadVector,n=this._moveVector;this.getDpad(i),this.getJoystick(Zs.MOVEMENT,n);const r=i.x||n.x,a=i.y||n.y,s=new THREE.Vector3;return Math.abs(r)>ec&&(s.x+=r),Math.abs(a)>ec&&(s.z+=a),s},isRotationActive:function(){if(!this.data.enabled||!this.isConnected())return!1;const i=this._lookVector;return this.getJoystick(Zs.ROTATION,i),Math.abs(i.x)>ec||Math.abs(i.y)>ec},updateRotation:function(i){if(!this.isRotationActive())return;const n=this.data,r=this.yaw,a=this.pitch,s=n.camera.components["look-controls"],o=s&&s.pitchObject&&s.yawObject;o&&(a.rotation.copy(s.pitchObject.rotation),r.rotation.copy(s.yawObject.rotation));const u=this._lookVector;this.getJoystick(Zs.ROTATION,u),Math.abs(u.x)<=ec&&(u.x=0),Math.abs(u.y)<=ec&&(u.y=0),u.multiplyScalar(n.rotationSensitivity*i/1e3),r.rotation.y-=u.x,a.rotation.x-=u.y,a.rotation.x=Math.max(-Math.PI/2,Math.min(Math.PI/2,a.rotation.x)),n.camera.object3D.rotation.set(a.rotation.x,r.rotation.y,0),o&&(s.pitchObject.rotation.copy(a.rotation),s.yawObject.rotation.copy(r.rotation))},updateButtonState:function(){const i=this.getGamepad(Ks.RIGHT);if(this.data.enabled&&i)for(var n=0;n<i.buttons.length;n++)i.buttons[n].pressed&&!this.buttons[n]?this.emit(new Rw("gamepadbuttondown",n,i.buttons[n])):!i.buttons[n].pressed&&this.buttons[n]&&this.emit(new Rw("gamepadbuttonup",n,i.buttons[n])),this.buttons[n]=i.buttons[n].pressed;else Object.keys(this.buttons)&&(this.buttons={})},emit:function(i){this.el.emit(i.type,i),this.el.emit(i.type+":"+i.index,new Rw(i.type,i.index,i))},getGamepad:function(){const i=[],n=[];return function(r){const a=this.el.sceneEl.components["proxy-controls"],s=a&&a.isConnected()&&a.getGamepad(0);if(s)return s;i.length=0;for(let u=0;u<this.system.controllers.length;u++){const f=this.system.controllers[u],v=f?f.gamepad:null;if(i.push(v),v&&v.handedness===r)return v}const o=navigator.getGamepads?navigator.getGamepads():n;for(let u=0;u<o.length;u++){const f=o[u];if(f&&f.hand===r)return f}return i[0]||o[0]}}(),getButton:function(i){return this.getGamepad(Ks.RIGHT).buttons[i]},getAxis:function(i){return this.getGamepad(i>1?Ks.RIGHT:Ks.LEFT).axes[i]},getJoystick:function(i,n){const r=this.getGamepad(i===Zs.MOVEMENT?Ks.LEFT:Ks.RIGHT);if(r.mapping==="xr-standard")switch(i){case Zs.MOVEMENT:return n.set(r.axes[2],r.axes[3]);case Zs.ROTATION:return n.set(r.axes[0],r.axes[1])}else switch(i){case Zs.MOVEMENT:return n.set(r.axes[0],r.axes[1]);case Zs.ROTATION:return n.set(r.axes[2],r.axes[3])}throw new Error('Unexpected joystick index "%d".',i)},getDpad:function(i){const n=this.getGamepad(Ks.LEFT);return n.buttons[Jh.DPAD_RIGHT]?i.set((n.buttons[Jh.DPAD_RIGHT].pressed?1:0)+(n.buttons[Jh.DPAD_LEFT].pressed?-1:0),(n.buttons[Jh.DPAD_UP].pressed?-1:0)+(n.buttons[Jh.DPAD_DOWN].pressed?1:0)):i.set(0,0)},isConnected:function(){const i=this.getGamepad(Ks.LEFT);return!!(i&&i.connected)},getID:function(){return this.getGamepad(Ks.LEFT).id}});(function(i){var n="KeyboardEvent"in i;n||(i.KeyboardEvent=function(){throw TypeError("Illegal constructor")}),"DOM_KEY_LOCATION_STANDARD"in i.KeyboardEvent||(i.KeyboardEvent.DOM_KEY_LOCATION_STANDARD=0),"DOM_KEY_LOCATION_LEFT"in i.KeyboardEvent||(i.KeyboardEvent.DOM_KEY_LOCATION_LEFT=1),"DOM_KEY_LOCATION_RIGHT"in i.KeyboardEvent||(i.KeyboardEvent.DOM_KEY_LOCATION_RIGHT=2),"DOM_KEY_LOCATION_NUMPAD"in i.KeyboardEvent||(i.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD=3);var r=window.KeyboardEvent.DOM_KEY_LOCATION_STANDARD,a=window.KeyboardEvent.DOM_KEY_LOCATION_LEFT,s=window.KeyboardEvent.DOM_KEY_LOCATION_RIGHT,o=window.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD;function u(P,N){return String(P).indexOf(N)!==-1}var f=function(){return u(navigator.platform,"Win")?"win":u(navigator.platform,"Mac")?"mac":u(navigator.platform,"CrOS")?"cros":u(navigator.platform,"Linux")?"linux":u(navigator.userAgent,"iPad")||u(navigator.platform,"iPod")||u(navigator.platform,"iPhone")?"ios":""}(),v=function(){return u(navigator.userAgent,"Chrome/")?"chrome":u(navigator.vendor,"Apple")?"safari":u(navigator.userAgent,"MSIE")?"ie":u(navigator.userAgent,"Gecko/")?"moz":u(navigator.userAgent,"Opera/")?"opera":""}(),m=v+"-"+f;function g(P,N,F){(m===N||v===N||f===N)&&Object.keys(F).forEach(function(X){P[X]=F[X]})}function y(P,N){var F={};return Object.keys(P).forEach(function(X){var Y=P[X];N in Y&&(F[Y[N]]=Y)}),F}var b={3:{code:"Cancel"},6:{code:"Help"},8:{code:"Backspace"},9:{code:"Tab"},12:{code:"Clear"},13:{code:"Enter"},16:{code:"Shift"},17:{code:"Control"},18:{code:"Alt"},19:{code:"Pause"},20:{code:"CapsLock"},21:{code:"KanaMode"},22:{code:"HangulMode"},23:{code:"JunjaMode"},24:{code:"FinalMode"},25:{code:"KanjiMode"},27:{code:"Escape"},28:{code:"Convert"},29:{code:"NonConvert"},30:{code:"Accept"},31:{code:"ModeChange"},32:{code:"Space"},33:{code:"PageUp"},34:{code:"PageDown"},35:{code:"End"},36:{code:"Home"},37:{code:"ArrowLeft"},38:{code:"ArrowUp"},39:{code:"ArrowRight"},40:{code:"ArrowDown"},41:{code:"Select"},42:{code:"Print"},43:{code:"Execute"},44:{code:"PrintScreen"},45:{code:"Insert"},46:{code:"Delete"},47:{code:"Help"},48:{code:"Digit0",keyCap:"0"},49:{code:"Digit1",keyCap:"1"},50:{code:"Digit2",keyCap:"2"},51:{code:"Digit3",keyCap:"3"},52:{code:"Digit4",keyCap:"4"},53:{code:"Digit5",keyCap:"5"},54:{code:"Digit6",keyCap:"6"},55:{code:"Digit7",keyCap:"7"},56:{code:"Digit8",keyCap:"8"},57:{code:"Digit9",keyCap:"9"},65:{code:"KeyA",keyCap:"a"},66:{code:"KeyB",keyCap:"b"},67:{code:"KeyC",keyCap:"c"},68:{code:"KeyD",keyCap:"d"},69:{code:"KeyE",keyCap:"e"},70:{code:"KeyF",keyCap:"f"},71:{code:"KeyG",keyCap:"g"},72:{code:"KeyH",keyCap:"h"},73:{code:"KeyI",keyCap:"i"},74:{code:"KeyJ",keyCap:"j"},75:{code:"KeyK",keyCap:"k"},76:{code:"KeyL",keyCap:"l"},77:{code:"KeyM",keyCap:"m"},78:{code:"KeyN",keyCap:"n"},79:{code:"KeyO",keyCap:"o"},80:{code:"KeyP",keyCap:"p"},81:{code:"KeyQ",keyCap:"q"},82:{code:"KeyR",keyCap:"r"},83:{code:"KeyS",keyCap:"s"},84:{code:"KeyT",keyCap:"t"},85:{code:"KeyU",keyCap:"u"},86:{code:"KeyV",keyCap:"v"},87:{code:"KeyW",keyCap:"w"},88:{code:"KeyX",keyCap:"x"},89:{code:"KeyY",keyCap:"y"},90:{code:"KeyZ",keyCap:"z"},91:{code:"OSLeft",location:a},92:{code:"OSRight",location:s},93:{code:"ContextMenu"},95:{code:"Standby"},96:{code:"Numpad0",keyCap:"0",location:o},97:{code:"Numpad1",keyCap:"1",location:o},98:{code:"Numpad2",keyCap:"2",location:o},99:{code:"Numpad3",keyCap:"3",location:o},100:{code:"Numpad4",keyCap:"4",location:o},101:{code:"Numpad5",keyCap:"5",location:o},102:{code:"Numpad6",keyCap:"6",location:o},103:{code:"Numpad7",keyCap:"7",location:o},104:{code:"Numpad8",keyCap:"8",location:o},105:{code:"Numpad9",keyCap:"9",location:o},106:{code:"NumpadMultiply",keyCap:"*",location:o},107:{code:"NumpadAdd",keyCap:"+",location:o},108:{code:"NumpadComma",keyCap:",",location:o},109:{code:"NumpadSubtract",keyCap:"-",location:o},110:{code:"NumpadDecimal",keyCap:".",location:o},111:{code:"NumpadDivide",keyCap:"/",location:o},112:{code:"F1"},113:{code:"F2"},114:{code:"F3"},115:{code:"F4"},116:{code:"F5"},117:{code:"F6"},118:{code:"F7"},119:{code:"F8"},120:{code:"F9"},121:{code:"F10"},122:{code:"F11"},123:{code:"F12"},124:{code:"F13"},125:{code:"F14"},126:{code:"F15"},127:{code:"F16"},128:{code:"F17"},129:{code:"F18"},130:{code:"F19"},131:{code:"F20"},132:{code:"F21"},133:{code:"F22"},134:{code:"F23"},135:{code:"F24"},144:{code:"NumLock",location:o},145:{code:"ScrollLock"},160:{code:"ShiftLeft",location:a},161:{code:"ShiftRight",location:s},162:{code:"ControlLeft",location:a},163:{code:"ControlRight",location:s},164:{code:"AltLeft",location:a},165:{code:"AltRight",location:s},166:{code:"BrowserBack"},167:{code:"BrowserForward"},168:{code:"BrowserRefresh"},169:{code:"BrowserStop"},170:{code:"BrowserSearch"},171:{code:"BrowserFavorites"},172:{code:"BrowserHome"},173:{code:"VolumeMute"},174:{code:"VolumeDown"},175:{code:"VolumeUp"},176:{code:"MediaTrackNext"},177:{code:"MediaTrackPrevious"},178:{code:"MediaStop"},179:{code:"MediaPlayPause"},180:{code:"LaunchMail"},181:{code:"MediaSelect"},182:{code:"LaunchApp1"},183:{code:"LaunchApp2"},186:{code:"Semicolon",keyCap:";"},187:{code:"Equal",keyCap:"="},188:{code:"Comma",keyCap:","},189:{code:"Minus",keyCap:"-"},190:{code:"Period",keyCap:"."},191:{code:"Slash",keyCap:"/"},192:{code:"Backquote",keyCap:"`"},219:{code:"BracketLeft",keyCap:"["},220:{code:"Backslash",keyCap:"\\"},221:{code:"BracketRight",keyCap:"]"},222:{code:"Quote",keyCap:"'"},226:{code:"IntlBackslash",keyCap:"\\"},229:{code:"Process"},246:{code:"Attn"},247:{code:"CrSel"},248:{code:"ExSel"},249:{code:"EraseEof"},250:{code:"Play"},251:{code:"ZoomToggle"},254:{code:"Clear"}};g(b,"moz",{59:{code:"Semicolon",keyCap:";"},61:{code:"Equal",keyCap:"="},107:{code:"Equal",keyCap:"="},109:{code:"Minus",keyCap:"-"},187:{code:"NumpadAdd",keyCap:"+",location:o},189:{code:"NumpadSubtract",keyCap:"-",location:o}}),g(b,"moz-mac",{12:{code:"NumLock",location:o},173:{code:"Minus",keyCap:"-"}}),g(b,"moz-win",{173:{code:"Minus",keyCap:"-"}}),g(b,"chrome-mac",{93:{code:"OSRight",location:s}}),g(b,"safari",{3:{code:"Enter"},25:{code:"Tab"}}),g(b,"ios",{10:{code:"Enter",location:r}}),g(b,"safari-mac",{91:{code:"OSLeft",location:a},93:{code:"OSRight",location:s},229:{code:"KeyQ",keyCap:"Q"}});var w={};f==="cros"&&(w["U+00A0"]={code:"ShiftLeft",location:a},w["U+00A1"]={code:"ShiftRight",location:s},w["U+00A2"]={code:"ControlLeft",location:a},w["U+00A3"]={code:"ControlRight",location:s},w["U+00A4"]={code:"AltLeft",location:a},w["U+00A5"]={code:"AltRight",location:s}),m==="chrome-mac"&&(w["U+0010"]={code:"ContextMenu"}),m==="safari-mac"&&(w["U+0010"]={code:"ContextMenu"}),f==="ios"&&(w["U+0010"]={code:"Function"},w["U+001C"]={code:"ArrowLeft"},w["U+001D"]={code:"ArrowRight"},w["U+001E"]={code:"ArrowUp"},w["U+001F"]={code:"ArrowDown"},w["U+0001"]={code:"Home"},w["U+0004"]={code:"End"},w["U+000B"]={code:"PageUp"},w["U+000C"]={code:"PageDown"});var A=[];A[a]={16:{code:"ShiftLeft",location:a},17:{code:"ControlLeft",location:a},18:{code:"AltLeft",location:a}},A[s]={16:{code:"ShiftRight",location:s},17:{code:"ControlRight",location:s},18:{code:"AltRight",location:s}},A[o]={13:{code:"NumpadEnter",location:o}},g(A[o],"moz",{109:{code:"NumpadSubtract",location:o},107:{code:"NumpadAdd",location:o}}),g(A[a],"moz-mac",{224:{code:"OSLeft",location:a}}),g(A[s],"moz-mac",{224:{code:"OSRight",location:s}}),g(A[s],"moz-win",{91:{code:"OSRight",location:s}}),g(A[s],"mac",{93:{code:"OSRight",location:s}}),g(A[o],"chrome-mac",{12:{code:"NumLock",location:o}}),g(A[o],"safari-mac",{12:{code:"NumLock",location:o},187:{code:"NumpadAdd",location:o},189:{code:"NumpadSubtract",location:o},190:{code:"NumpadDecimal",location:o},191:{code:"NumpadDivide",location:o}});var M={ShiftLeft:{key:"Shift"},ShiftRight:{key:"Shift"},ControlLeft:{key:"Control"},ControlRight:{key:"Control"},AltLeft:{key:"Alt"},AltRight:{key:"Alt"},OSLeft:{key:"OS"},OSRight:{key:"OS"},NumpadEnter:{key:"Enter"},Space:{key:" "},Digit0:{key:"0",shiftKey:")"},Digit1:{key:"1",shiftKey:"!"},Digit2:{key:"2",shiftKey:"@"},Digit3:{key:"3",shiftKey:"#"},Digit4:{key:"4",shiftKey:"$"},Digit5:{key:"5",shiftKey:"%"},Digit6:{key:"6",shiftKey:"^"},Digit7:{key:"7",shiftKey:"&"},Digit8:{key:"8",shiftKey:"*"},Digit9:{key:"9",shiftKey:"("},KeyA:{key:"a",shiftKey:"A"},KeyB:{key:"b",shiftKey:"B"},KeyC:{key:"c",shiftKey:"C"},KeyD:{key:"d",shiftKey:"D"},KeyE:{key:"e",shiftKey:"E"},KeyF:{key:"f",shiftKey:"F"},KeyG:{key:"g",shiftKey:"G"},KeyH:{key:"h",shiftKey:"H"},KeyI:{key:"i",shiftKey:"I"},KeyJ:{key:"j",shiftKey:"J"},KeyK:{key:"k",shiftKey:"K"},KeyL:{key:"l",shiftKey:"L"},KeyM:{key:"m",shiftKey:"M"},KeyN:{key:"n",shiftKey:"N"},KeyO:{key:"o",shiftKey:"O"},KeyP:{key:"p",shiftKey:"P"},KeyQ:{key:"q",shiftKey:"Q"},KeyR:{key:"r",shiftKey:"R"},KeyS:{key:"s",shiftKey:"S"},KeyT:{key:"t",shiftKey:"T"},KeyU:{key:"u",shiftKey:"U"},KeyV:{key:"v",shiftKey:"V"},KeyW:{key:"w",shiftKey:"W"},KeyX:{key:"x",shiftKey:"X"},KeyY:{key:"y",shiftKey:"Y"},KeyZ:{key:"z",shiftKey:"Z"},Numpad0:{key:"0"},Numpad1:{key:"1"},Numpad2:{key:"2"},Numpad3:{key:"3"},Numpad4:{key:"4"},Numpad5:{key:"5"},Numpad6:{key:"6"},Numpad7:{key:"7"},Numpad8:{key:"8"},Numpad9:{key:"9"},NumpadMultiply:{key:"*"},NumpadAdd:{key:"+"},NumpadComma:{key:","},NumpadSubtract:{key:"-"},NumpadDecimal:{key:"."},NumpadDivide:{key:"/"},Semicolon:{key:";",shiftKey:":"},Equal:{key:"=",shiftKey:"+"},Comma:{key:",",shiftKey:"<"},Minus:{key:"-",shiftKey:"_"},Period:{key:".",shiftKey:">"},Slash:{key:"/",shiftKey:"?"},Backquote:{key:"`",shiftKey:"~"},BracketLeft:{key:"[",shiftKey:"{"},Backslash:{key:"\\",shiftKey:"|"},BracketRight:{key:"]",shiftKey:"}"},Quote:{key:"'",shiftKey:'"'},IntlBackslash:{key:"\\",shiftKey:"|"}};g(M,"mac",{OSLeft:{key:"Meta"},OSRight:{key:"Meta"}});var S={Esc:"Escape",Nonconvert:"NonConvert",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Menu:"ContextMenu",MediaNextTrack:"MediaTrackNext",MediaPreviousTrack:"MediaTrackPrevious",SelectMedia:"MediaSelect",HalfWidth:"Hankaku",FullWidth:"Zenkaku",RomanCharacters:"Romaji",Crsel:"CrSel",Exsel:"ExSel",Zoom:"ZoomToggle"},E=y(b,"code");try{var T=n&&"location"in new KeyboardEvent("")}catch{}function C(P){var N="keyCode"in P?P.keyCode:"which"in P?P.which:0,F=function(){if(T||"keyLocation"in P){var Y=T?P.location:P.keyLocation;if(Y&&N in A[Y])return A[Y][N]}return"keyIdentifier"in P&&P.keyIdentifier in w?w[P.keyIdentifier]:N in b?b[N]:null}();if(!F)return null;var X=function(){var Y=M[F.code];return Y?P.shiftKey&&"shiftKey"in Y?Y.shiftKey:Y.key:F.code}();return{code:F.code,key:X,location:F.location,keyCap:F.keyCap}}function L(P,N){if(P=String(P),!E.hasOwnProperty(P))return"Undefined";if(N&&String(N).toLowerCase()!=="en-us")throw Error("Unsupported locale");var F=E[P];return F.keyCap||F.code||"Undefined"}"KeyboardEvent"in i&&"defineProperty"in Object&&function(){function P(F,X,Y){X in F||Object.defineProperty(F,X,Y)}if(P(KeyboardEvent.prototype,"code",{get:function(){var F=C(this);return F?F.code:""}}),"key"in KeyboardEvent.prototype){var N=Object.getOwnPropertyDescriptor(KeyboardEvent.prototype,"key");Object.defineProperty(KeyboardEvent.prototype,"key",{get:function(){var F=N.get.call(this);return S.hasOwnProperty(F)?S[F]:F}})}P(KeyboardEvent.prototype,"key",{get:function(){var F=C(this);return F&&"key"in F?F.key:"Unidentified"}}),P(KeyboardEvent.prototype,"location",{get:function(){var F=C(this);return F&&"location"in F?F.location:r}}),P(KeyboardEvent.prototype,"locale",{get:function(){return""}})}(),"queryKeyCap"in i.KeyboardEvent||(i.KeyboardEvent.queryKeyCap=L),i.identifyKey=function(P){if(!("code"in P)){var N=C(P);P.code=N?N.code:"",P.key=N&&"key"in N?N.key:"Unidentified",P.location="location"in P?P.location:"keyLocation"in P?P.keyLocation:N&&"location"in N?N.location:r,P.locale=""}}})(window);const BK="__keyboard-controls-proxy",NK=window.KeyboardEvent;AFRAME.registerComponent("keyboard-controls",{schema:{enabled:{default:!0},debug:{default:!1}},init:function(){this.dVelocity=new THREE.Vector3,this.localKeys={},this.listeners={keydown:this.onKeyDown.bind(this),keyup:this.onKeyUp.bind(this),blur:this.onBlur.bind(this)},this.attachEventListeners()},isVelocityActive:function(){return this.data.enabled&&!!Object.keys(this.getKeys()).length},getVelocityDelta:function(){const i=this.data,n=this.getKeys();return this.dVelocity.set(0,0,0),i.enabled&&((n.KeyW||n.ArrowUp)&&(this.dVelocity.z-=1),(n.KeyA||n.ArrowLeft)&&(this.dVelocity.x-=1),(n.KeyS||n.ArrowDown)&&(this.dVelocity.z+=1),(n.KeyD||n.ArrowRight)&&(this.dVelocity.x+=1)),this.dVelocity.clone()},play:function(){this.attachEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){this.pause()},attachEventListeners:function(){window.addEventListener("keydown",this.listeners.keydown,!1),window.addEventListener("keyup",this.listeners.keyup,!1),window.addEventListener("blur",this.listeners.blur,!1)},removeEventListeners:function(){window.removeEventListener("keydown",this.listeners.keydown),window.removeEventListener("keyup",this.listeners.keyup),window.removeEventListener("blur",this.listeners.blur)},onKeyDown:function(i){AFRAME.utils.shouldCaptureKeyEvent(i)&&(this.localKeys[i.code]=!0,this.emit(i))},onKeyUp:function(i){AFRAME.utils.shouldCaptureKeyEvent(i)&&(delete this.localKeys[i.code],this.emit(i))},onBlur:function(){for(let i in this.localKeys)this.localKeys.hasOwnProperty(i)&&delete this.localKeys[i]},emit:function(i){BK in i&&this.el.emit(i.type,i),this.el.emit(i.type+":"+i.code,new NK(i.type,i)),this.data.debug&&console.log(i.type+":"+i.code)},isPressed:function(i){return i in this.getKeys()},getKeys:function(){return this.isProxied()?this.el.sceneEl.components["proxy-controls"].getKeyboard():this.localKeys},isProxied:function(){const i=this.el.sceneEl.components["proxy-controls"];return i&&i.isConnected()}});AFRAME.registerComponent("touch-controls",{schema:{enabled:{default:!0},reverseEnabled:{default:!0}},init:function(){this.dVelocity=new THREE.Vector3,this.bindMethods(),this.direction=0},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.dVelocity.set(0,0,0)},remove:function(){this.pause()},addEventListeners:function(){const i=this.el.sceneEl,n=i.canvas;if(!n){i.addEventListener("render-target-loaded",this.addEventListeners.bind(this));return}n.addEventListener("touchstart",this.onTouchStart),n.addEventListener("touchend",this.onTouchEnd)},removeEventListeners:function(){const i=this.el.sceneEl&&this.el.sceneEl.canvas;!i||(i.removeEventListener("touchstart",this.onTouchStart),i.removeEventListener("touchend",this.onTouchEnd))},isVelocityActive:function(){return this.data.enabled&&!!this.direction},getVelocityDelta:function(){return this.dVelocity.z=this.direction,this.dVelocity.clone()},bindMethods:function(){this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this)},onTouchStart:function(i){this.direction=-1,this.data.reverseEnabled&&i.touches.length===2&&(this.direction=1),i.preventDefault()},onTouchEnd:function(i){this.direction=0,i.preventDefault()}});const TR="-controls",UK=.2,HK=1e-5;AFRAME.registerComponent("movement-controls",{dependencies:["rotation"],schema:{enabled:{default:!0},controls:{default:["gamepad","trackpad","keyboard","touch"]},speed:{default:.3,min:0},fly:{default:!1},constrainToNavMesh:{default:!1},camera:{default:"[movement-controls] [camera]",type:"selector"}},init:function(){const i=this.el;this.velocityCtrl=null,this.velocity=new THREE.Vector3,this.heading=new THREE.Quaternion,this.navGroup=null,this.navNode=null,i.sceneEl.hasLoaded?this.injectControls():i.sceneEl.addEventListener("loaded",this.injectControls.bind(this))},update:function(i){const n=this.el,r=this.data,a=n.sceneEl.systems.nav;n.sceneEl.hasLoaded&&this.injectControls(),a&&r.constrainToNavMesh!==i.constrainToNavMesh&&(r.constrainToNavMesh?a.addAgent(this):a.removeAgent(this))},injectControls:function(){const i=this.data;var n;for(let r=0;r<i.controls.length;r++)n=i.controls[r]+TR,this.el.components[n]||this.el.setAttribute(n,"")},updateNavLocation:function(){this.navGroup=null,this.navNode=null},tick:function(){const i=new THREE.Vector3,n=new THREE.Vector3,r=new THREE.Vector3;return function(a,s){if(!s)return;const o=this.el,u=this.data;if(!u.enabled)return;this.updateVelocityCtrl();const f=this.velocityCtrl,v=this.velocity;if(!!f)if(s/1e3>UK?v.set(0,0,0):this.updateVelocity(s),u.constrainToNavMesh&&f.isNavMeshConstrained!==!1){if(v.lengthSq()<HK)return;i.copy(o.object3D.position),n.copy(v).multiplyScalar(s/1e3).add(i);const m=o.sceneEl.systems.nav;this.navGroup=this.navGroup===null?m.getGroup(i):this.navGroup,this.navNode=this.navNode||m.getNode(i,this.navGroup),this.navNode=m.clampStep(i,n,this.navGroup,this.navNode,r),o.object3D.position.copy(r)}else o.hasAttribute("velocity")?o.setAttribute("velocity",v):(o.object3D.position.x+=v.x*s/1e3,o.object3D.position.y+=v.y*s/1e3,o.object3D.position.z+=v.z*s/1e3)}}(),updateVelocityCtrl:function(){const i=this.data;if(i.enabled){for(let n=0,r=i.controls.length;n<r;n++){const a=this.el.components[i.controls[n]+TR];if(a&&a.isVelocityActive()){this.velocityCtrl=a;return}}this.velocityCtrl=null}},updateVelocity:function(){const i=new THREE.Vector2,n=new THREE.Quaternion;return function(r){let a;const s=this.el,o=this.velocityCtrl,u=this.velocity,f=this.data;if(o)if(o.getVelocityDelta)a=o.getVelocityDelta(r);else if(o.getVelocity){u.copy(o.getVelocity());return}else if(o.getPositionDelta){u.copy(o.getPositionDelta(r).multiplyScalar(1e3/r));return}else throw new Error("Incompatible movement controls: ",o);if(s.hasAttribute("velocity")&&!f.constrainToNavMesh&&u.copy(this.el.getAttribute("velocity")),a&&f.enabled){const v=f.camera;n.copy(v.object3D.quaternion),n.premultiply(s.object3D.quaternion),a.applyQuaternion(n);const m=a.length();f.fly?(u.copy(a),u.multiplyScalar(this.data.speed*16.66667)):(i.set(a.x,a.z),i.setLength(m*this.data.speed*16.66667),u.x=i.x,u.z=i.y)}}}()});AFRAME.registerComponent("trackpad-controls",{schema:{enabled:{default:!0},enableNegX:{default:!0},enablePosX:{default:!0},enableNegZ:{default:!0},enablePosZ:{default:!0},mode:{default:"touch",oneOf:["swipe","touch","press"]}},init:function(){this.dVelocity=new THREE.Vector3,this.zVel=0,this.xVel=0,this.bindMethods()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.dVelocity.set(0,0,0)},remove:function(){this.pause()},addEventListeners:function(){const i=this.data,n=this.el.sceneEl;switch(n.addEventListener("axismove",this.onAxisMove),i.mode){case"swipe":case"touch":n.addEventListener("trackpadtouchstart",this.onTouchStart),n.addEventListener("trackpadtouchend",this.onTouchEnd);break;case"press":n.addEventListener("trackpaddown",this.onTouchStart),n.addEventListener("trackpadup",this.onTouchEnd);break}},removeEventListeners:function(){const i=this.el.sceneEl;i.removeEventListener("axismove",this.onAxisMove),i.removeEventListener("trackpadtouchstart",this.onTouchStart),i.removeEventListener("trackpadtouchend",this.onTouchEnd),i.removeEventListener("trackpaddown",this.onTouchStart),i.removeEventListener("trackpadup",this.onTouchEnd)},isVelocityActive:function(){return this.data.enabled&&this.isMoving},getVelocityDelta:function(){return this.dVelocity.z=this.isMoving?-this.zVel:1,this.dVelocity.x=this.isMoving?this.xVel:1,this.dVelocity.clone()},bindMethods:function(){this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onAxisMove=this.onAxisMove.bind(this)},onTouchStart:function(i){switch(this.data.mode){case"swipe":this.canRecordAxis=!0,this.startingAxisData=[];break;case"touch":this.isMoving=!0;break;case"press":this.isMoving=!0;break}i.preventDefault()},onTouchEnd:function(i){this.data.mode=="swipe"&&(this.startingAxisData=[]),this.isMoving=!1,i.preventDefault()},onAxisMove:function(i){switch(this.data.mode){case"swipe":return this.handleSwipeAxis(i);case"touch":case"press":return this.handleTouchAxis(i)}},handleSwipeAxis:function(i){const n=this.data,r=i.detail.axis;if(this.startingAxisData.length===0&&this.canRecordAxis&&(this.canRecordAxis=!1,this.startingAxisData[0]=r[0],this.startingAxisData[1]=r[1]),this.startingAxisData.length>0){let a=0,s=0;n.enableNegX&&r[0]<this.startingAxisData[0]&&(a=-1),n.enablePosX&&r[0]>this.startingAxisData[0]&&(a=1),n.enablePosZ&&r[1]>this.startingAxisData[1]&&(s=-1),n.enableNegZ&&r[1]<this.startingAxisData[1]&&(s=1);const o=Math.abs(this.startingAxisData[1]-r[1]);Math.abs(this.startingAxisData[0]-r[0])>o?(this.zVel=0,this.xVel=a,this.isMoving=!0):(this.xVel=0,this.zVel=s,this.isMoving=!0)}},handleTouchAxis:function(i){const n=this.data,r=i.detail.axis;let a=0,s=0;n.enableNegX&&r[0]<0&&(a=-1),n.enablePosX&&r[0]>0&&(a=1),n.enablePosZ&&r[1]>0&&(s=-1),n.enableNegZ&&r[1]<0&&(s=1),Math.abs(r[0])>Math.abs(r[1])?(this.zVel=0,this.xVel=a):(this.xVel=0,this.zVel=s)}});const Lw={once:THREE.LoopOnce,repeat:THREE.LoopRepeat,pingpong:THREE.LoopPingPong};AFRAME.registerComponent("animation-mixer",{schema:{clip:{default:"*"},duration:{default:0},clampWhenFinished:{default:!1,type:"boolean"},crossFadeDuration:{default:0},loop:{default:"repeat",oneOf:Object.keys(Lw)},repetitions:{default:1/0,min:0},timeScale:{default:1}},init:function(){this.model=null,this.mixer=null,this.activeActions=[];const i=this.el.getObject3D("mesh");i?this.load(i):this.el.addEventListener("model-loaded",n=>{this.load(n.detail.model)})},load:function(i){const n=this.el;this.model=i,this.mixer=new THREE.AnimationMixer(i),this.mixer.addEventListener("loop",r=>{n.emit("animation-loop",{action:r.action,loopDelta:r.loopDelta})}),this.mixer.addEventListener("finished",r=>{n.emit("animation-finished",{action:r.action,direction:r.direction})}),this.data.clip&&this.update({})},remove:function(){this.mixer&&this.mixer.stopAllAction()},update:function(i){if(!i)return;const n=this.data,r=AFRAME.utils.diff(n,i);if("clip"in r){this.stopAction(),n.clip&&this.playAction();return}this.activeActions.forEach(a=>{"duration"in r&&n.duration&&a.setDuration(n.duration),"clampWhenFinished"in r&&(a.clampWhenFinished=n.clampWhenFinished),("loop"in r||"repetitions"in r)&&a.setLoop(Lw[n.loop],n.repetitions),"timeScale"in r&&a.setEffectiveTimeScale(n.timeScale)})},stopAction:function(){const i=this.data;for(let n=0;n<this.activeActions.length;n++)i.crossFadeDuration?this.activeActions[n].fadeOut(i.crossFadeDuration):this.activeActions[n].stop();this.activeActions.length=0},playAction:function(){if(!this.mixer)return;const i=this.model,n=this.data,r=i.animations||(i.geometry||{}).animations||[];if(!r.length)return;const a=zK(n.clip);for(let s,o=0;s=r[o];o++)if(s.name.match(a)){const u=this.mixer.clipAction(s,i);u.enabled=!0,u.clampWhenFinished=n.clampWhenFinished,n.duration&&u.setDuration(n.duration),n.timeScale!==1&&u.setEffectiveTimeScale(n.timeScale),u.setLoop(Lw[n.loop],n.repetitions).fadeIn(n.crossFadeDuration).play(),this.activeActions.push(u)}},tick:function(i,n){this.mixer&&!isNaN(n)&&this.mixer.update(n/1e3)}});function zK(i){return new RegExp("^"+i.split(/\*+/).map(GK).join(".*")+"$")}function GK(i){return i.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")}var VK=THREE.ColladaLoader=function(i){this.manager=i!==void 0?i:THREE.DefaultLoadingManager};THREE.ColladaLoader.prototype={constructor:THREE.ColladaLoader,crossOrigin:"anonymous",load:function(i,n,r,a){var s=this,o=s.path===void 0?THREE.LoaderUtils.extractUrlBase(i):s.path,u=new THREE.FileLoader(s.manager);u.setPath(s.path),u.load(i,function(f){n(s.parse(f,o))},r,a)},setPath:function(i){return this.path=i,this},setResourcePath:function(i){return this.resourcePath=i,this},options:{set convertUpAxis(i){console.warn("THREE.ColladaLoader: options.convertUpAxis() has been removed. Up axis is converted automatically.")}},setCrossOrigin:function(i){return this.crossOrigin=i,this},parse:function(i,n){function r(se,he){for(var Te=[],Pe=se.childNodes,Ce=0,pt=Pe.length;Ce<pt;Ce++){var Rt=Pe[Ce];Rt.nodeName===he&&Te.push(Rt)}return Te}function a(se){if(se.length===0)return[];for(var he=se.trim().split(/\s+/),Te=new Array(he.length),Pe=0,Ce=he.length;Pe<Ce;Pe++)Te[Pe]=he[Pe];return Te}function s(se){if(se.length===0)return[];for(var he=se.trim().split(/\s+/),Te=new Array(he.length),Pe=0,Ce=he.length;Pe<Ce;Pe++)Te[Pe]=parseFloat(he[Pe]);return Te}function o(se){if(se.length===0)return[];for(var he=se.trim().split(/\s+/),Te=new Array(he.length),Pe=0,Ce=he.length;Pe<Ce;Pe++)Te[Pe]=parseInt(he[Pe]);return Te}function u(se){return se.substring(1)}function f(){return"three_default_"+Xt++}function v(se){return Object.keys(se).length===0}function m(se){return{unit:g(r(se,"unit")[0]),upAxis:y(r(se,"up_axis")[0])}}function g(se){return se!==void 0&&se.hasAttribute("meter")===!0?parseFloat(se.getAttribute("meter")):1}function y(se){return se!==void 0?se.textContent:"Y_UP"}function b(se,he,Te,Pe){var Ce=r(se,he)[0];if(Ce!==void 0)for(var pt=r(Ce,Te),Rt=0;Rt<pt.length;Rt++)Pe(pt[Rt])}function w(se,he){for(var Te in se){var Pe=se[Te];Pe.build=he(se[Te])}}function A(se,he){return se.build!==void 0||(se.build=he(se)),se.build}function M(se){for(var he={sources:{},samplers:{},channels:{}},Te=0,Pe=se.childNodes.length;Te<Pe;Te++){var Ce=se.childNodes[Te];if(Ce.nodeType===1){var pt;switch(Ce.nodeName){case"source":pt=Ce.getAttribute("id"),he.sources[pt]=fr(Ce);break;case"sampler":pt=Ce.getAttribute("id"),he.samplers[pt]=S(Ce);break;case"channel":pt=Ce.getAttribute("target"),he.channels[pt]=E(Ce);break;default:console.log(Ce)}}}Et.animations[se.getAttribute("id")]=he}function S(se){for(var he={inputs:{}},Te=0,Pe=se.childNodes.length;Te<Pe;Te++){var Ce=se.childNodes[Te];if(Ce.nodeType===1)switch(Ce.nodeName){case"input":var pt=u(Ce.getAttribute("source")),Rt=Ce.getAttribute("semantic");he.inputs[Rt]=pt;break}}return he}function E(se){var he={},Te=se.getAttribute("target"),Pe=Te.split("/"),Ce=Pe.shift(),pt=Pe.shift(),Rt=pt.indexOf("(")!==-1,Bt=pt.indexOf(".")!==-1;if(Bt)Pe=pt.split("."),pt=Pe.shift(),he.member=Pe.shift();else if(Rt){var Kt=pt.split("(");pt=Kt.shift();for(var hn=0;hn<Kt.length;hn++)Kt[hn]=parseInt(Kt[hn].replace(/\)/,""));he.indices=Kt}return he.id=Ce,he.sid=pt,he.arraySyntax=Rt,he.memberSyntax=Bt,he.sampler=u(se.getAttribute("source")),he}function T(se){var he=[],Te=se.channels,Pe=se.samplers,Ce=se.sources;for(var pt in Te)if(Te.hasOwnProperty(pt)){var Rt=Te[pt],Bt=Pe[Rt.sampler],Kt=Bt.inputs.INPUT,hn=Bt.inputs.OUTPUT,Qt=Ce[Kt],on=Ce[hn],$n=L(Rt,Qt,on);Y($n,he)}return he}function C(se){return A(Et.animations[se],T)}function L(se,he,Te){var Pe=Et.nodes[se.id],Ce=Nr(Pe.id),pt=Pe.transforms[se.sid],Rt=Pe.matrix.clone().transpose(),Bt,Kt,hn,Qt,on,$n,kn={};switch(pt){case"matrix":for(hn=0,Qt=he.array.length;hn<Qt;hn++)if(Bt=he.array[hn],Kt=hn*Te.stride,kn[Bt]===void 0&&(kn[Bt]={}),se.arraySyntax===!0){var Un=Te.array[Kt],fn=se.indices[0]+4*se.indices[1];kn[Bt][fn]=Un}else for(on=0,$n=Te.stride;on<$n;on++)kn[Bt][on]=Te.array[Kt+on];break;case"translate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',pt);break;case"rotate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',pt);break;case"scale":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',pt);break}var Hn=P(kn,Rt),nr={name:Ce.uuid,keyframes:Hn};return nr}function P(se,he){var Te=[];for(var Pe in se)Te.push({time:parseFloat(Pe),value:se[Pe]});Te.sort(pt);for(var Ce=0;Ce<16;Ce++)ae(Te,Ce,he.elements[Ce]);return Te;function pt(Rt,Bt){return Rt.time-Bt.time}}var N=new THREE.Vector3,F=new THREE.Vector3,X=new THREE.Quaternion;function Y(se,he){for(var Te=se.keyframes,Pe=se.name,Ce=[],pt=[],Rt=[],Bt=[],Kt=0,hn=Te.length;Kt<hn;Kt++){var Qt=Te[Kt],on=Qt.time,$n=Qt.value;kt.fromArray($n).transpose(),kt.decompose(N,X,F),Ce.push(on),pt.push(N.x,N.y,N.z),Rt.push(X.x,X.y,X.z,X.w),Bt.push(F.x,F.y,F.z)}return pt.length>0&&he.push(new THREE.VectorKeyframeTrack(Pe+".position",Ce,pt)),Rt.length>0&&he.push(new THREE.QuaternionKeyframeTrack(Pe+".quaternion",Ce,Rt)),Bt.length>0&&he.push(new THREE.VectorKeyframeTrack(Pe+".scale",Ce,Bt)),he}function ae(se,he,Te){var Pe,Ce=!0,pt,Rt;for(pt=0,Rt=se.length;pt<Rt;pt++)Pe=se[pt],Pe.value[he]===void 0?Pe.value[he]=null:Ce=!1;if(Ce===!0)for(pt=0,Rt=se.length;pt<Rt;pt++)Pe=se[pt],Pe.value[he]=Te;else $(se,he)}function $(se,he){for(var Te,Pe,Ce=0,pt=se.length;Ce<pt;Ce++){var Rt=se[Ce];if(Rt.value[he]===null){if(Te=de(se,Ce,he),Pe=D(se,Ce,he),Te===null){Rt.value[he]=Pe.value[he];continue}if(Pe===null){Rt.value[he]=Te.value[he];continue}I(Rt,Te,Pe,he)}}}function de(se,he,Te){for(;he>=0;){var Pe=se[he];if(Pe.value[Te]!==null)return Pe;he--}return null}function D(se,he,Te){for(;he<se.length;){var Pe=se[he];if(Pe.value[Te]!==null)return Pe;he++}return null}function I(se,he,Te,Pe){if(Te.time-he.time==0){se.value[Pe]=he.value[Pe];return}se.value[Pe]=(se.time-he.time)*(Te.value[Pe]-he.value[Pe])/(Te.time-he.time)+he.value[Pe]}function k(se){for(var he={name:se.getAttribute("id")||"default",start:parseFloat(se.getAttribute("start")||0),end:parseFloat(se.getAttribute("end")||0),animations:[]},Te=0,Pe=se.childNodes.length;Te<Pe;Te++){var Ce=se.childNodes[Te];if(Ce.nodeType===1)switch(Ce.nodeName){case"instance_animation":he.animations.push(u(Ce.getAttribute("url")));break}}Et.clips[se.getAttribute("id")]=he}function U(se){for(var he=[],Te=se.name,Pe=se.end-se.start||-1,Ce=se.animations,pt=0,Rt=Ce.length;pt<Rt;pt++)for(var Bt=C(Ce[pt]),Kt=0,hn=Bt.length;Kt<hn;Kt++)he.push(Bt[Kt]);return new THREE.AnimationClip(Te,Pe,he)}function W(se){return A(Et.clips[se],U)}function ce(se){for(var he={},Te=0,Pe=se.childNodes.length;Te<Pe;Te++){var Ce=se.childNodes[Te];if(Ce.nodeType===1)switch(Ce.nodeName){case"skin":he.id=u(Ce.getAttribute("source")),he.skin=oe(Ce);break;case"morph":he.id=u(Ce.getAttribute("source")),console.warn("THREE.ColladaLoader: Morph target animation not supported yet.");break}}Et.controllers[se.getAttribute("id")]=he}function oe(se){for(var he={sources:{}},Te=0,Pe=se.childNodes.length;Te<Pe;Te++){var Ce=se.childNodes[Te];if(Ce.nodeType===1)switch(Ce.nodeName){case"bind_shape_matrix":he.bindShapeMatrix=s(Ce.textContent);break;case"source":var pt=Ce.getAttribute("id");he.sources[pt]=fr(Ce);break;case"joints":he.joints=ge(Ce);break;case"vertex_weights":he.vertexWeights=_e(Ce);break}}return he}function ge(se){for(var he={inputs:{}},Te=0,Pe=se.childNodes.length;Te<Pe;Te++){var Ce=se.childNodes[Te];if(Ce.nodeType===1)switch(Ce.nodeName){case"input":var pt=Ce.getAttribute("semantic"),Rt=u(Ce.getAttribute("source"));he.inputs[pt]=Rt;break}}return he}function _e(se){for(var he={inputs:{}},Te=0,Pe=se.childNodes.length;Te<Pe;Te++){var Ce=se.childNodes[Te];if(Ce.nodeType===1)switch(Ce.nodeName){case"input":var pt=Ce.getAttribute("semantic"),Rt=u(Ce.getAttribute("source")),Bt=parseInt(Ce.getAttribute("offset"));he.inputs[pt]={id:Rt,offset:Bt};break;case"vcount":he.vcount=o(Ce.textContent);break;case"v":he.v=o(Ce.textContent);break}}return he}function Ne(se){var he={id:se.id},Te=Et.geometries[he.id];return se.skin!==void 0&&(he.skin=Ie(se.skin),Te.sources.skinIndices=he.skin.indices,Te.sources.skinWeights=he.skin.weights),he}function Ie(se){var he=4,Te={joints:[],indices:{array:[],stride:he},weights:{array:[],stride:he}},Pe=se.sources,Ce=se.vertexWeights,pt=Ce.vcount,Rt=Ce.v,Bt=Ce.inputs.JOINT.offset,Kt=Ce.inputs.WEIGHT.offset,hn=se.sources[se.joints.inputs.JOINT],Qt=se.sources[se.joints.inputs.INV_BIND_MATRIX],on=Pe[Ce.inputs.WEIGHT.id].array,$n=0,kn,Un,fn;for(kn=0,fn=pt.length;kn<fn;kn++){var Hn=pt[kn],nr=[];for(Un=0;Un<Hn;Un++){var Tr=Rt[$n+Bt],Dr=Rt[$n+Kt],Vr=on[Dr];nr.push({index:Tr,weight:Vr}),$n+=2}for(nr.sort(ya),Un=0;Un<he;Un++){var ir=nr[Un];ir!==void 0?(Te.indices.array.push(ir.index),Te.weights.array.push(ir.weight)):(Te.indices.array.push(0),Te.weights.array.push(0))}}for(se.bindShapeMatrix?Te.bindMatrix=new THREE.Matrix4().fromArray(se.bindShapeMatrix).transpose():Te.bindMatrix=new THREE.Matrix4().identity(),kn=0,fn=hn.array.length;kn<fn;kn++){var ri=hn.array[kn],Nn=new THREE.Matrix4().fromArray(Qt.array,kn*Qt.stride).transpose();Te.joints.push({name:ri,boneInverse:Nn})}return Te;function ya(ba,vo){return vo.weight-ba.weight}}function Ve(se){return A(Et.controllers[se],Ne)}function Le(se){var he={init_from:r(se,"init_from")[0].textContent};Et.images[se.getAttribute("id")]=he}function Fe(se){return se.build!==void 0?se.build:se.init_from}function Me(se){var he=Et.images[se];return he!==void 0?A(he,Fe):(console.warn("THREE.ColladaLoader: Couldn't find image with ID:",se),null)}function Qe(se){for(var he={},Te=0,Pe=se.childNodes.length;Te<Pe;Te++){var Ce=se.childNodes[Te];if(Ce.nodeType===1)switch(Ce.nodeName){case"profile_COMMON":he.profile=mt(Ce);break}}Et.effects[se.getAttribute("id")]=he}function mt(se){for(var he={surfaces:{},samplers:{}},Te=0,Pe=se.childNodes.length;Te<Pe;Te++){var Ce=se.childNodes[Te];if(Ce.nodeType===1)switch(Ce.nodeName){case"newparam":ht(Ce,he);break;case"technique":he.technique=H(Ce);break;case"extra":he.extra=Se(Ce);break}}return he}function ht(se,he){for(var Te=se.getAttribute("sid"),Pe=0,Ce=se.childNodes.length;Pe<Ce;Pe++){var pt=se.childNodes[Pe];if(pt.nodeType===1)switch(pt.nodeName){case"surface":he.surfaces[Te]=ye(pt);break;case"sampler2D":he.samplers[Te]=fe(pt);break}}}function ye(se){for(var he={},Te=0,Pe=se.childNodes.length;Te<Pe;Te++){var Ce=se.childNodes[Te];if(Ce.nodeType===1)switch(Ce.nodeName){case"init_from":he.init_from=Ce.textContent;break}}return he}function fe(se){for(var he={},Te=0,Pe=se.childNodes.length;Te<Pe;Te++){var Ce=se.childNodes[Te];if(Ce.nodeType===1)switch(Ce.nodeName){case"source":he.source=Ce.textContent;break}}return he}function H(se){for(var he={},Te=0,Pe=se.childNodes.length;Te<Pe;Te++){var Ce=se.childNodes[Te];if(Ce.nodeType===1)switch(Ce.nodeName){case"constant":case"lambert":case"blinn":case"phong":he.type=Ce.nodeName,he.parameters=j(Ce);break}}return he}function j(se){for(var he={},Te=0,Pe=se.childNodes.length;Te<Pe;Te++){var Ce=se.childNodes[Te];if(Ce.nodeType===1)switch(Ce.nodeName){case"emission":case"diffuse":case"specular":case"bump":case"ambient":case"shininess":case"transparency":he[Ce.nodeName]=q(Ce);break;case"transparent":he[Ce.nodeName]={opaque:Ce.getAttribute("opaque"),data:q(Ce)};break}}return he}function q(se){for(var he={},Te=0,Pe=se.childNodes.length;Te<Pe;Te++){var Ce=se.childNodes[Te];if(Ce.nodeType===1)switch(Ce.nodeName){case"color":he[Ce.nodeName]=s(Ce.textContent);break;case"float":he[Ce.nodeName]=parseFloat(Ce.textContent);break;case"texture":he[Ce.nodeName]={id:Ce.getAttribute("texture"),extra:pe(Ce)};break}}return he}function pe(se){for(var he={technique:{}},Te=0,Pe=se.childNodes.length;Te<Pe;Te++){var Ce=se.childNodes[Te];if(Ce.nodeType===1)switch(Ce.nodeName){case"extra":ee(Ce,he);break}}return he}function ee(se,he){for(var Te=0,Pe=se.childNodes.length;Te<Pe;Te++){var Ce=se.childNodes[Te];if(Ce.nodeType===1)switch(Ce.nodeName){case"technique":te(Ce,he);break}}}function te(se,he){for(var Te=0,Pe=se.childNodes.length;Te<Pe;Te++){var Ce=se.childNodes[Te];if(Ce.nodeType===1)switch(Ce.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":he.technique[Ce.nodeName]=parseFloat(Ce.textContent);break;case"wrapU":case"wrapV":Ce.textContent.toUpperCase()==="TRUE"?he.technique[Ce.nodeName]=1:Ce.textContent.toUpperCase()==="FALSE"?he.technique[Ce.nodeName]=0:he.technique[Ce.nodeName]=parseInt(Ce.textContent);break}}}function Se(se){for(var he={},Te=0,Pe=se.childNodes.length;Te<Pe;Te++){var Ce=se.childNodes[Te];if(Ce.nodeType===1)switch(Ce.nodeName){case"technique":he.technique=ke(Ce);break}}return he}function ke(se){for(var he={},Te=0,Pe=se.childNodes.length;Te<Pe;Te++){var Ce=se.childNodes[Te];if(Ce.nodeType===1)switch(Ce.nodeName){case"double_sided":he[Ce.nodeName]=parseInt(Ce.textContent);break}}return he}function Be(se){return se}function We(se){return A(Et.effects[se],Be)}function ve(se){for(var he={name:se.getAttribute("name")},Te=0,Pe=se.childNodes.length;Te<Pe;Te++){var Ce=se.childNodes[Te];if(Ce.nodeType===1)switch(Ce.nodeName){case"instance_effect":he.url=u(Ce.getAttribute("url"));break}}Et.materials[se.getAttribute("id")]=he}function K(se){var he,Te=se.slice((se.lastIndexOf(".")-1>>>0)+2);switch(Te=Te.toLowerCase(),Te){case"tga":he=ze;break;default:he=Ae}return he}function J(se){var he=We(se.url),Te=he.profile.technique,Pe=he.profile.extra,Ce;switch(Te.type){case"phong":case"blinn":Ce=new THREE.MeshPhongMaterial;break;case"lambert":Ce=new THREE.MeshLambertMaterial;break;default:Ce=new THREE.MeshBasicMaterial;break}Ce.name=se.name;function pt($n){var kn=he.profile.samplers[$n.id],Un=null;if(kn!==void 0){var fn=he.profile.surfaces[kn.source];Un=Me(fn.init_from)}else console.warn("THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530)."),Un=Me($n.id);if(Un!==null){var Hn=K(Un);if(Hn!==void 0){var nr=Hn.load(Un),Tr=$n.extra;if(Tr!==void 0&&Tr.technique!==void 0&&v(Tr.technique)===!1){var Dr=Tr.technique;nr.wrapS=Dr.wrapU?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,nr.wrapT=Dr.wrapV?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,nr.offset.set(Dr.offsetU||0,Dr.offsetV||0),nr.repeat.set(Dr.repeatU||1,Dr.repeatV||1)}else nr.wrapS=THREE.RepeatWrapping,nr.wrapT=THREE.RepeatWrapping;return nr}else return console.warn("THREE.ColladaLoader: Loader for texture %s not found.",Un),null}else return console.warn("THREE.ColladaLoader: Couldn't create texture with ID:",$n.id),null}var Rt=Te.parameters;for(var Bt in Rt){var Kt=Rt[Bt];switch(Bt){case"diffuse":Kt.color&&Ce.color.fromArray(Kt.color),Kt.texture&&(Ce.map=pt(Kt.texture));break;case"specular":Kt.color&&Ce.specular&&Ce.specular.fromArray(Kt.color),Kt.texture&&(Ce.specularMap=pt(Kt.texture));break;case"bump":Kt.texture&&(Ce.normalMap=pt(Kt.texture));break;case"ambient":Kt.texture&&(Ce.lightMap=pt(Kt.texture));break;case"shininess":Kt.float&&Ce.shininess&&(Ce.shininess=Kt.float);break;case"emission":Kt.color&&Ce.emissive&&Ce.emissive.fromArray(Kt.color),Kt.texture&&(Ce.emissiveMap=pt(Kt.texture));break}}var hn=Rt.transparent,Qt=Rt.transparency;if(Qt===void 0&&hn&&(Qt={float:1}),hn===void 0&&Qt&&(hn={opaque:"A_ONE",data:{color:[1,1,1,1]}}),hn&&Qt)if(hn.data.texture)Ce.transparent=!0;else{var on=hn.data.color;switch(hn.opaque){case"A_ONE":Ce.opacity=on[3]*Qt.float;break;case"RGB_ZERO":Ce.opacity=1-on[0]*Qt.float;break;case"A_ZERO":Ce.opacity=1-on[3]*Qt.float;break;case"RGB_ONE":Ce.opacity=on[0]*Qt.float;break;default:console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.',hn.opaque)}Ce.opacity<1&&(Ce.transparent=!0)}return Pe!==void 0&&Pe.technique!==void 0&&Pe.technique.double_sided===1&&(Ce.side=THREE.DoubleSide),Ce}function Ee(se){return A(Et.materials[se],J)}function xe(se){for(var he={name:se.getAttribute("name")},Te=0,Pe=se.childNodes.length;Te<Pe;Te++){var Ce=se.childNodes[Te];if(Ce.nodeType===1)switch(Ce.nodeName){case"optics":he.optics=Je(Ce);break}}Et.cameras[se.getAttribute("id")]=he}function Je(se){for(var he=0;he<se.childNodes.length;he++){var Te=se.childNodes[he];switch(Te.nodeName){case"technique_common":return Xe(Te)}}return{}}function Xe(se){for(var he={},Te=0;Te<se.childNodes.length;Te++){var Pe=se.childNodes[Te];switch(Pe.nodeName){case"perspective":case"orthographic":he.technique=Pe.nodeName,he.parameters=Mt(Pe);break}}return he}function Mt(se){for(var he={},Te=0;Te<se.childNodes.length;Te++){var Pe=se.childNodes[Te];switch(Pe.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":he[Pe.nodeName]=parseFloat(Pe.textContent);break}}return he}function qe(se){var he;switch(se.optics.technique){case"perspective":he=new THREE.PerspectiveCamera(se.optics.parameters.yfov,se.optics.parameters.aspect_ratio,se.optics.parameters.znear,se.optics.parameters.zfar);break;case"orthographic":var Te=se.optics.parameters.ymag,Pe=se.optics.parameters.xmag,Ce=se.optics.parameters.aspect_ratio;Pe=Pe===void 0?Te*Ce:Pe,Te=Te===void 0?Pe/Ce:Te,Pe*=.5,Te*=.5,he=new THREE.OrthographicCamera(-Pe,Pe,Te,-Te,se.optics.parameters.znear,se.optics.parameters.zfar);break;default:he=new THREE.PerspectiveCamera;break}return he.name=se.name,he}function It(se){var he=Et.cameras[se];return he!==void 0?A(he,qe):(console.warn("THREE.ColladaLoader: Couldn't find camera with ID:",se),null)}function rn(se){for(var he={},Te=0,Pe=se.childNodes.length;Te<Pe;Te++){var Ce=se.childNodes[Te];if(Ce.nodeType===1)switch(Ce.nodeName){case"technique_common":he=Yt(Ce);break}}Et.lights[se.getAttribute("id")]=he}function Yt(se){for(var he={},Te=0,Pe=se.childNodes.length;Te<Pe;Te++){var Ce=se.childNodes[Te];if(Ce.nodeType===1)switch(Ce.nodeName){case"directional":case"point":case"spot":case"ambient":he.technique=Ce.nodeName,he.parameters=Tn(Ce)}}return he}function Tn(se){for(var he={},Te=0,Pe=se.childNodes.length;Te<Pe;Te++){var Ce=se.childNodes[Te];if(Ce.nodeType===1)switch(Ce.nodeName){case"color":var pt=s(Ce.textContent);he.color=new THREE.Color().fromArray(pt);break;case"falloff_angle":he.falloffAngle=parseFloat(Ce.textContent);break;case"quadratic_attenuation":var Rt=parseFloat(Ce.textContent);he.distance=Rt?Math.sqrt(1/Rt):0;break}}return he}function Jt(se){var he;switch(se.technique){case"directional":he=new THREE.DirectionalLight;break;case"point":he=new THREE.PointLight;break;case"spot":he=new THREE.SpotLight;break;case"ambient":he=new THREE.AmbientLight;break}return se.parameters.color&&he.color.copy(se.parameters.color),se.parameters.distance&&(he.distance=se.parameters.distance),he}function Fn(se){var he=Et.lights[se];return he!==void 0?A(he,Jt):(console.warn("THREE.ColladaLoader: Couldn't find light with ID:",se),null)}function mr(se){var he={name:se.getAttribute("name"),sources:{},vertices:{},primitives:[]},Te=r(se,"mesh")[0];if(Te!==void 0){for(var Pe=0;Pe<Te.childNodes.length;Pe++){var Ce=Te.childNodes[Pe];if(Ce.nodeType===1){var pt=Ce.getAttribute("id");switch(Ce.nodeName){case"source":he.sources[pt]=fr(Ce);break;case"vertices":he.vertices=Dt(Ce);break;case"polygons":console.warn("THREE.ColladaLoader: Unsupported primitive type: ",Ce.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":he.primitives.push(Ft(Ce));break;default:console.log(Ce)}}}Et.geometries[se.getAttribute("id")]=he}}function fr(se){for(var he={array:[],stride:3},Te=0;Te<se.childNodes.length;Te++){var Pe=se.childNodes[Te];if(Pe.nodeType===1)switch(Pe.nodeName){case"float_array":he.array=s(Pe.textContent);break;case"Name_array":he.array=a(Pe.textContent);break;case"technique_common":var Ce=r(Pe,"accessor")[0];Ce!==void 0&&(he.stride=parseInt(Ce.getAttribute("stride")));break}}return he}function Dt(se){for(var he={},Te=0;Te<se.childNodes.length;Te++){var Pe=se.childNodes[Te];Pe.nodeType===1&&(he[Pe.getAttribute("semantic")]=u(Pe.getAttribute("source")))}return he}function Ft(se){for(var he={type:se.nodeName,material:se.getAttribute("material"),count:parseInt(se.getAttribute("count")),inputs:{},stride:0,hasUV:!1},Te=0,Pe=se.childNodes.length;Te<Pe;Te++){var Ce=se.childNodes[Te];if(Ce.nodeType===1)switch(Ce.nodeName){case"input":var pt=u(Ce.getAttribute("source")),Rt=Ce.getAttribute("semantic"),Bt=parseInt(Ce.getAttribute("offset")),Kt=parseInt(Ce.getAttribute("set")),hn=Kt>0?Rt+Kt:Rt;he.inputs[hn]={id:pt,offset:Bt},he.stride=Math.max(he.stride,Bt+1),Rt==="TEXCOORD"&&(he.hasUV=!0);break;case"vcount":he.vcount=o(Ce.textContent);break;case"p":he.p=o(Ce.textContent);break}}return he}function $t(se){for(var he={},Te=0;Te<se.length;Te++){var Pe=se[Te];he[Pe.type]===void 0&&(he[Pe.type]=[]),he[Pe.type].push(Pe)}return he}function Pn(se){for(var he=0,Te=0,Pe=se.length;Te<Pe;Te++){var Ce=se[Te];Ce.hasUV===!0&&he++}he>0&&he<se.length&&(se.uvsNeedsFix=!0)}function In(se){var he={},Te=se.sources,Pe=se.vertices,Ce=se.primitives;if(Ce.length===0)return{};var pt=$t(Ce);for(var Rt in pt){var Bt=pt[Rt];Pn(Bt),he[Rt]=zn(Bt,Te,Pe)}return he}function zn(se,he,Te){for(var Pe={},Ce={array:[],stride:0},pt={array:[],stride:0},Rt={array:[],stride:0},Bt={array:[],stride:0},Kt={array:[],stride:0},hn={array:[],stride:4},Qt={array:[],stride:4},on=new THREE.BufferGeometry,$n=[],kn=0,Un=0;Un<se.length;Un++){var fn=se[Un],Hn=fn.inputs,nr=0;switch(fn.type){case"lines":case"linestrips":nr=fn.count*2;break;case"triangles":nr=fn.count*3;break;case"polylist":for(var Tr=0;Tr<fn.count;Tr++){var Dr=fn.vcount[Tr];switch(Dr){case 3:nr+=3;break;case 4:nr+=6;break;default:nr+=(Dr-2)*3;break}}break;default:console.warn("THREE.ColladaLoader: Unknow primitive type:",fn.type)}on.addGroup(kn,nr,Un),kn+=nr,fn.material&&$n.push(fn.material);for(var Vr in Hn){var ir=Hn[Vr];switch(Vr){case"VERTEX":for(var ri in Te){var Nn=Te[ri];switch(ri){case"POSITION":var ya=Ce.array.length;if(bn(fn,he[Nn],ir.offset,Ce.array),Ce.stride=he[Nn].stride,he.skinWeights&&he.skinIndices&&(bn(fn,he.skinIndices,ir.offset,hn.array),bn(fn,he.skinWeights,ir.offset,Qt.array)),fn.hasUV===!1&&se.uvsNeedsFix===!0)for(var nr=(Ce.array.length-ya)/Ce.stride,ba=0;ba<nr;ba++)Rt.array.push(0,0);break;case"NORMAL":bn(fn,he[Nn],ir.offset,pt.array),pt.stride=he[Nn].stride;break;case"COLOR":bn(fn,he[Nn],ir.offset,Kt.array),Kt.stride=he[Nn].stride;break;case"TEXCOORD":bn(fn,he[Nn],ir.offset,Rt.array),Rt.stride=he[Nn].stride;break;case"TEXCOORD1":bn(fn,he[Nn],ir.offset,Bt.array),Rt.stride=he[Nn].stride;break;default:console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.',ri)}}break;case"NORMAL":bn(fn,he[ir.id],ir.offset,pt.array),pt.stride=he[ir.id].stride;break;case"COLOR":bn(fn,he[ir.id],ir.offset,Kt.array),Kt.stride=he[ir.id].stride;break;case"TEXCOORD":bn(fn,he[ir.id],ir.offset,Rt.array),Rt.stride=he[ir.id].stride;break;case"TEXCOORD1":bn(fn,he[ir.id],ir.offset,Bt.array),Bt.stride=he[ir.id].stride;break}}}return Ce.array.length>0&&on.addAttribute("position",new THREE.Float32BufferAttribute(Ce.array,Ce.stride)),pt.array.length>0&&on.addAttribute("normal",new THREE.Float32BufferAttribute(pt.array,pt.stride)),Kt.array.length>0&&on.addAttribute("color",new THREE.Float32BufferAttribute(Kt.array,Kt.stride)),Rt.array.length>0&&on.addAttribute("uv",new THREE.Float32BufferAttribute(Rt.array,Rt.stride)),Bt.array.length>0&&on.addAttribute("uv2",new THREE.Float32BufferAttribute(Bt.array,Bt.stride)),hn.array.length>0&&on.addAttribute("skinIndex",new THREE.Float32BufferAttribute(hn.array,hn.stride)),Qt.array.length>0&&on.addAttribute("skinWeight",new THREE.Float32BufferAttribute(Qt.array,Qt.stride)),Pe.data=on,Pe.type=se[0].type,Pe.materialKeys=$n,Pe}function bn(se,he,Te,Pe){var Ce=se.p,pt=se.stride,Rt=se.vcount;function Bt(Vr){for(var ir=Ce[Vr+Te]*hn,ri=ir+hn;ir<ri;ir++)Pe.push(Kt[ir])}var Kt=he.array,hn=he.stride;if(se.vcount!==void 0)for(var Qt=0,on=0,$n=Rt.length;on<$n;on++){var kn=Rt[on];if(kn===4){var Un=Qt+pt*0,fn=Qt+pt*1,Hn=Qt+pt*2,nr=Qt+pt*3;Bt(Un),Bt(fn),Bt(nr),Bt(fn),Bt(Hn),Bt(nr)}else if(kn===3){var Un=Qt+pt*0,fn=Qt+pt*1,Hn=Qt+pt*2;Bt(Un),Bt(fn),Bt(Hn)}else if(kn>4)for(var Tr=1,Dr=kn-2;Tr<=Dr;Tr++){var Un=Qt+pt*0,fn=Qt+pt*Tr,Hn=Qt+pt*(Tr+1);Bt(Un),Bt(fn),Bt(Hn)}Qt+=pt*kn}else for(var on=0,$n=Ce.length;on<$n;on+=pt)Bt(on)}function Jn(se){return A(Et.geometries[se],In)}function Er(se){for(var he={name:se.getAttribute("name")||"",joints:{},links:[]},Te=0;Te<se.childNodes.length;Te++){var Pe=se.childNodes[Te];if(Pe.nodeType===1)switch(Pe.nodeName){case"technique_common":Lr(Pe,he);break}}Et.kinematicsModels[se.getAttribute("id")]=he}function cr(se){return se.build!==void 0?se.build:se}function gi(se){return A(Et.kinematicsModels[se],cr)}function Lr(se,he){for(var Te=0;Te<se.childNodes.length;Te++){var Pe=se.childNodes[Te];if(Pe.nodeType===1)switch(Pe.nodeName){case"joint":he.joints[Pe.getAttribute("sid")]=vr(Pe);break;case"link":he.links.push(_t(Pe));break}}}function vr(se){for(var he,Te=0;Te<se.childNodes.length;Te++){var Pe=se.childNodes[Te];if(Pe.nodeType===1)switch(Pe.nodeName){case"prismatic":case"revolute":he=je(Pe);break}}return he}function je(se,he){for(var he={sid:se.getAttribute("sid"),name:se.getAttribute("name")||"",axis:new THREE.Vector3,limits:{min:0,max:0},type:se.nodeName,static:!1,zeroPosition:0,middlePosition:0},Te=0;Te<se.childNodes.length;Te++){var Pe=se.childNodes[Te];if(Pe.nodeType===1)switch(Pe.nodeName){case"axis":var Ce=s(Pe.textContent);he.axis.fromArray(Ce);break;case"limits":var pt=Pe.getElementsByTagName("max")[0],Rt=Pe.getElementsByTagName("min")[0];he.limits.max=parseFloat(pt.textContent),he.limits.min=parseFloat(Rt.textContent);break}}return he.limits.min>=he.limits.max&&(he.static=!0),he.middlePosition=(he.limits.min+he.limits.max)/2,he}function _t(se){for(var he={sid:se.getAttribute("sid"),name:se.getAttribute("name")||"",attachments:[],transforms:[]},Te=0;Te<se.childNodes.length;Te++){var Pe=se.childNodes[Te];if(Pe.nodeType===1)switch(Pe.nodeName){case"attachment_full":he.attachments.push(Ot(Pe));break;case"matrix":case"translate":case"rotate":he.transforms.push(At(Pe));break}}return he}function Ot(se){for(var he={joint:se.getAttribute("joint").split("/").pop(),transforms:[],links:[]},Te=0;Te<se.childNodes.length;Te++){var Pe=se.childNodes[Te];if(Pe.nodeType===1)switch(Pe.nodeName){case"link":he.links.push(_t(Pe));break;case"matrix":case"translate":case"rotate":he.transforms.push(At(Pe));break}}return he}function At(se){var he={type:se.nodeName},Te=s(se.textContent);switch(he.type){case"matrix":he.obj=new THREE.Matrix4,he.obj.fromArray(Te).transpose();break;case"translate":he.obj=new THREE.Vector3,he.obj.fromArray(Te);break;case"rotate":he.obj=new THREE.Vector3,he.obj.fromArray(Te),he.angle=THREE.Math.degToRad(Te[3]);break}return he}function Gt(se){for(var he={name:se.getAttribute("name")||"",rigidBodies:{}},Te=0;Te<se.childNodes.length;Te++){var Pe=se.childNodes[Te];if(Pe.nodeType===1)switch(Pe.nodeName){case"rigid_body":he.rigidBodies[Pe.getAttribute("name")]={},En(Pe,he.rigidBodies[Pe.getAttribute("name")]);break}}Et.physicsModels[se.getAttribute("id")]=he}function En(se,he){for(var Te=0;Te<se.childNodes.length;Te++){var Pe=se.childNodes[Te];if(Pe.nodeType===1)switch(Pe.nodeName){case"technique_common":Sn(Pe,he);break}}}function Sn(se,he){for(var Te=0;Te<se.childNodes.length;Te++){var Pe=se.childNodes[Te];if(Pe.nodeType===1)switch(Pe.nodeName){case"inertia":he.inertia=s(Pe.textContent);break;case"mass":he.mass=s(Pe.textContent)[0];break}}}function pn(se){for(var he={bindJointAxis:[]},Te=0;Te<se.childNodes.length;Te++){var Pe=se.childNodes[Te];if(Pe.nodeType===1)switch(Pe.nodeName){case"bind_joint_axis":he.bindJointAxis.push(De(Pe));break}}Et.kinematicsScenes[u(se.getAttribute("url"))]=he}function De(se){for(var he={target:se.getAttribute("target").split("/").pop()},Te=0;Te<se.childNodes.length;Te++){var Pe=se.childNodes[Te];if(Pe.nodeType===1)switch(Pe.nodeName){case"axis":var Ce=Pe.getElementsByTagName("param")[0];he.axis=Ce.textContent;var pt=he.axis.split("inst_").pop().split("axis")[0];he.jointIndex=pt.substr(0,pt.length-1);break}}return he}function Ye(se){return se.build!==void 0?se.build:se}function ct(se){return A(Et.kinematicsScenes[se],Ye)}function bt(){var se=Object.keys(Et.kinematicsModels)[0],he=Object.keys(Et.kinematicsScenes)[0],Te=Object.keys(Et.visualScenes)[0];if(se===void 0||he===void 0)return;for(var Pe=gi(se),Ce=ct(he),pt=ur(Te),Rt=Ce.bindJointAxis,Bt={},Kt=0,hn=Rt.length;Kt<hn;Kt++){var Qt=Rt[Kt],on=Z.querySelector('[sid="'+Qt.target+'"]');if(on){var $n=on.parentElement;kn(Qt.jointIndex,$n)}}function kn(fn,Hn){var nr=Hn.getAttribute("name"),Tr=Pe.joints[fn];pt.traverse(function(Dr){Dr.name===nr&&(Bt[fn]={object:Dr,transforms:yt(Hn),joint:Tr,position:Tr.zeroPosition})})}var Un=new THREE.Matrix4;Ct={joints:Pe&&Pe.joints,getJointValue:function(fn){var Hn=Bt[fn];if(Hn)return Hn.position;console.warn("THREE.ColladaLoader: Joint "+fn+" doesn't exist.")},setJointValue:function(fn,Hn){var nr=Bt[fn];if(nr){var Tr=nr.joint;if(Hn>Tr.limits.max||Hn<Tr.limits.min)console.warn("THREE.ColladaLoader: Joint "+fn+" value "+Hn+" outside of limits (min: "+Tr.limits.min+", max: "+Tr.limits.max+").");else if(Tr.static)console.warn("THREE.ColladaLoader: Joint "+fn+" is static.");else{var Dr=nr.object,Vr=Tr.axis,ir=nr.transforms;kt.identity();for(var ri=0;ri<ir.length;ri++){var Nn=ir[ri];if(Nn.sid&&Nn.sid.indexOf(fn)!==-1)switch(Tr.type){case"revolute":kt.multiply(Un.makeRotationAxis(Vr,THREE.Math.degToRad(Hn)));break;case"prismatic":kt.multiply(Un.makeTranslation(Vr.x*Hn,Vr.y*Hn,Vr.z*Hn));break;default:console.warn("THREE.ColladaLoader: Unknown joint type: "+Tr.type);break}else switch(Nn.type){case"matrix":kt.multiply(Nn.obj);break;case"translate":kt.multiply(Un.makeTranslation(Nn.obj.x,Nn.obj.y,Nn.obj.z));break;case"scale":kt.scale(Nn.obj);break;case"rotate":kt.multiply(Un.makeRotationAxis(Nn.obj,Nn.angle));break}}Dr.matrix.copy(kt),Dr.matrix.decompose(Dr.position,Dr.quaternion,Dr.scale),Bt[fn].position=Hn}}else console.log("THREE.ColladaLoader: "+fn+" does not exist.")}}}function yt(se){for(var he=[],Te=Z.querySelector('[id="'+se.id+'"]'),Pe=0;Pe<Te.childNodes.length;Pe++){var Ce=Te.childNodes[Pe];if(Ce.nodeType===1)switch(Ce.nodeName){case"matrix":var pt=s(Ce.textContent),Rt=new THREE.Matrix4().fromArray(pt).transpose();he.push({sid:Ce.getAttribute("sid"),type:Ce.nodeName,obj:Rt});break;case"translate":case"scale":var pt=s(Ce.textContent),Bt=new THREE.Vector3().fromArray(pt);he.push({sid:Ce.getAttribute("sid"),type:Ce.nodeName,obj:Bt});break;case"rotate":var pt=s(Ce.textContent),Bt=new THREE.Vector3().fromArray(pt),Kt=THREE.Math.degToRad(pt[3]);he.push({sid:Ce.getAttribute("sid"),type:Ce.nodeName,obj:Bt,angle:Kt});break}}return he}function zt(se){for(var he=se.getElementsByTagName("node"),Te=0;Te<he.length;Te++){var Pe=he[Te];Pe.hasAttribute("id")===!1&&Pe.setAttribute("id",f())}}var kt=new THREE.Matrix4,sn=new THREE.Vector3;function jt(se){for(var he={name:se.getAttribute("name")||"",type:se.getAttribute("type"),id:se.getAttribute("id"),sid:se.getAttribute("sid"),matrix:new THREE.Matrix4,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}},Te=0;Te<se.childNodes.length;Te++){var Pe=se.childNodes[Te];if(Pe.nodeType===1)switch(Pe.nodeName){case"node":he.nodes.push(Pe.getAttribute("id")),jt(Pe);break;case"instance_camera":he.instanceCameras.push(u(Pe.getAttribute("url")));break;case"instance_controller":he.instanceControllers.push(Nt(Pe));break;case"instance_light":he.instanceLights.push(u(Pe.getAttribute("url")));break;case"instance_geometry":he.instanceGeometries.push(Nt(Pe));break;case"instance_node":he.instanceNodes.push(u(Pe.getAttribute("url")));break;case"matrix":var Ce=s(Pe.textContent);he.matrix.multiply(kt.fromArray(Ce).transpose()),he.transforms[Pe.getAttribute("sid")]=Pe.nodeName;break;case"translate":var Ce=s(Pe.textContent);sn.fromArray(Ce),he.matrix.multiply(kt.makeTranslation(sn.x,sn.y,sn.z)),he.transforms[Pe.getAttribute("sid")]=Pe.nodeName;break;case"rotate":var Ce=s(Pe.textContent),pt=THREE.Math.degToRad(Ce[3]);he.matrix.multiply(kt.makeRotationAxis(sn.fromArray(Ce),pt)),he.transforms[Pe.getAttribute("sid")]=Pe.nodeName;break;case"scale":var Ce=s(Pe.textContent);he.matrix.scale(sn.fromArray(Ce)),he.transforms[Pe.getAttribute("sid")]=Pe.nodeName;break;case"extra":break;default:console.log(Pe)}}return _r(he.id)?console.warn("THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",he.id):Et.nodes[he.id]=he,he}function Nt(se){for(var he={id:u(se.getAttribute("url")),materials:{},skeletons:[]},Te=0;Te<se.childNodes.length;Te++){var Pe=se.childNodes[Te];switch(Pe.nodeName){case"bind_material":for(var Ce=Pe.getElementsByTagName("instance_material"),pt=0;pt<Ce.length;pt++){var Rt=Ce[pt],Bt=Rt.getAttribute("symbol"),Kt=Rt.getAttribute("target");he.materials[Bt]=u(Kt)}break;case"skeleton":he.skeletons.push(u(Pe.textContent));break}}return he}function mn(se,he){var Te=[],Pe=[],Ce,pt,Rt;for(Ce=0;Ce<se.length;Ce++){var Bt=se[Ce],Kt;if(_r(Bt))Kt=Nr(Bt),An(Kt,he,Te);else if(dr(Bt))for(var hn=Et.visualScenes[Bt],Qt=hn.children,pt=0;pt<Qt.length;pt++){var on=Qt[pt];if(on.type==="JOINT"){var Kt=Nr(on.id);An(Kt,he,Te)}}else console.error("THREE.ColladaLoader: Unable to find root bone of skeleton with ID:",Bt)}for(Ce=0;Ce<he.length;Ce++)for(pt=0;pt<Te.length;pt++)if(Rt=Te[pt],Rt.bone.name===he[Ce].name){Pe[Ce]=Rt,Rt.processed=!0;break}for(Ce=0;Ce<Te.length;Ce++)Rt=Te[Ce],Rt.processed===!1&&(Pe.push(Rt),Rt.processed=!0);var $n=[],kn=[];for(Ce=0;Ce<Pe.length;Ce++)Rt=Pe[Ce],$n.push(Rt.bone),kn.push(Rt.boneInverse);return new THREE.Skeleton($n,kn)}function An(se,he,Te){se.traverse(function(Pe){if(Pe.isBone===!0){for(var Ce,pt=0;pt<he.length;pt++){var Rt=he[pt];if(Rt.name===Pe.name){Ce=Rt.boneInverse;break}}Ce===void 0&&(Ce=new THREE.Matrix4),Te.push({bone:Pe,boneInverse:Ce,processed:!1})}})}function Cn(se){for(var he=[],Te=se.matrix,Pe=se.nodes,Ce=se.type,pt=se.instanceCameras,Rt=se.instanceControllers,Bt=se.instanceLights,Kt=se.instanceGeometries,hn=se.instanceNodes,Qt=0,on=Pe.length;Qt<on;Qt++)he.push(Nr(Pe[Qt]));for(var Qt=0,on=pt.length;Qt<on;Qt++){var $n=It(pt[Qt]);$n!==null&&he.push($n.clone())}for(var Qt=0,on=Rt.length;Qt<on;Qt++)for(var kn=Rt[Qt],Un=Ve(kn.id),fn=Jn(Un.id),Hn=Rn(fn,kn.materials),nr=kn.skeletons,Tr=Un.skin.joints,Dr=mn(nr,Tr),Vr=0,ir=Hn.length;Vr<ir;Vr++){var Nn=Hn[Vr];Nn.isSkinnedMesh&&(Nn.bind(Dr,Un.skin.bindMatrix),Nn.normalizeSkinWeights()),he.push(Nn)}for(var Qt=0,on=Bt.length;Qt<on;Qt++){var ri=Fn(Bt[Qt]);ri!==null&&he.push(ri.clone())}for(var Qt=0,on=Kt.length;Qt<on;Qt++)for(var kn=Kt[Qt],fn=Jn(kn.id),Hn=Rn(fn,kn.materials),Vr=0,ir=Hn.length;Vr<ir;Vr++)he.push(Hn[Vr]);for(var Qt=0,on=hn.length;Qt<on;Qt++)he.push(Nr(hn[Qt]).clone());var Nn;if(Pe.length===0&&he.length===1)Nn=he[0];else{Nn=Ce==="JOINT"?new THREE.Bone:new THREE.Group;for(var Qt=0;Qt<he.length;Qt++)Nn.add(he[Qt])}return Nn.name===""&&(Nn.name=Ce==="JOINT"?se.sid:se.name),Nn.matrix.copy(Te),Nn.matrix.decompose(Nn.position,Nn.quaternion,Nn.scale),Nn}var Gn=new THREE.MeshBasicMaterial({color:16711935});function tr(se,he){for(var Te=[],Pe=0,Ce=se.length;Pe<Ce;Pe++){var pt=he[se[Pe]];pt===void 0?(console.warn("THREE.ColladaLoader: Material with key %s not found. Apply fallback material.",se[Pe]),Te.push(Gn)):Te.push(Ee(pt))}return Te}function Rn(se,he){var Te=[];for(var Pe in se){var Ce=se[Pe],pt=tr(Ce.materialKeys,he);pt.length===0&&(Pe==="lines"||Pe==="linestrips"?pt.push(new THREE.LineBasicMaterial):pt.push(new THREE.MeshPhongMaterial));var Rt=Ce.data.attributes.skinIndex!==void 0;if(Rt)for(var Bt=0,Kt=pt.length;Bt<Kt;Bt++)pt[Bt].skinning=!0;var hn=pt.length===1?pt[0]:pt,Qt;switch(Pe){case"lines":Qt=new THREE.LineSegments(Ce.data,hn);break;case"linestrips":Qt=new THREE.Line(Ce.data,hn);break;case"triangles":case"polylist":Rt?Qt=new THREE.SkinnedMesh(Ce.data,hn):Qt=new THREE.Mesh(Ce.data,hn);break}Te.push(Qt)}return Te}function _r(se){return Et.nodes[se]!==void 0}function Nr(se){return A(Et.nodes[se],Cn)}function Fi(se){var he={name:se.getAttribute("name"),children:[]};zt(se);for(var Te=r(se,"node"),Pe=0;Pe<Te.length;Pe++)he.children.push(jt(Te[Pe]));Et.visualScenes[se.getAttribute("id")]=he}function Xn(se){var he=new THREE.Group;he.name=se.name;for(var Te=se.children,Pe=0;Pe<Te.length;Pe++){var Ce=Te[Pe];he.add(Nr(Ce.id))}return he}function dr(se){return Et.visualScenes[se]!==void 0}function ur(se){return A(Et.visualScenes[se],Xn)}function $i(se){var he=r(se,"instance_visual_scene")[0];return ur(u(he.getAttribute("url")))}function qr(){var se=Et.clips;if(v(se)===!0){if(v(Et.animations)===!1){var he=[];for(var Te in Et.animations)for(var Pe=C(Te),Ce=0,pt=Pe.length;Ce<pt;Ce++)he.push(Pe[Ce]);ft.push(new THREE.AnimationClip("default",-1,he))}}else for(var Te in se)ft.push(W(Te))}if(i.length===0)return{scene:new THREE.Scene};var Qr=new DOMParser().parseFromString(i,"application/xml"),Z=r(Qr,"COLLADA")[0],ie=Z.getAttribute("version");console.log("THREE.ColladaLoader: File version",ie);var be=m(r(Z,"asset")[0]),Ae=new THREE.TextureLoader(this.manager);Ae.setPath(this.resourcePath||n).setCrossOrigin(this.crossOrigin);var ze;THREE.TGALoader&&(ze=new THREE.TGALoader(this.manager),ze.setPath(this.resourcePath||n));var ft=[],Ct={},Xt=0,Et={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};b(Z,"library_animations","animation",M),b(Z,"library_animation_clips","animation_clip",k),b(Z,"library_controllers","controller",ce),b(Z,"library_images","image",Le),b(Z,"library_effects","effect",Qe),b(Z,"library_materials","material",ve),b(Z,"library_cameras","camera",xe),b(Z,"library_lights","light",rn),b(Z,"library_geometries","geometry",mr),b(Z,"library_nodes","node",jt),b(Z,"library_visual_scenes","visual_scene",Fi),b(Z,"library_kinematics_models","kinematics_model",Er),b(Z,"library_physics_models","physics_model",Gt),b(Z,"scene","instance_kinematics_scene",pn),w(Et.animations,T),w(Et.clips,U),w(Et.controllers,Ne),w(Et.images,Fe),w(Et.effects,Be),w(Et.materials,J),w(Et.cameras,qe),w(Et.lights,Jt),w(Et.geometries,In),w(Et.visualScenes,Xn),qr(),bt();var wt=$i(r(Z,"scene")[0]);return be.upAxis==="Z_UP"&&wt.quaternion.setFromEuler(new THREE.Euler(-Math.PI/2,0,0)),wt.scale.multiplyScalar(be.unit),{animations:ft,kinematics:Ct,library:Et,scene:wt}}};THREE.ColladaLoader=VK;AFRAME.registerComponent("collada-model-legacy",{schema:{type:"asset"},init:function(){this.model=null,this.loader=new THREE.ColladaLoader},update:function(){var i=this,n=this.el,r=this.data,a=this.el.sceneEl.systems.renderer;!r||(this.remove(),this.loader.load(r,function(s){i.model=s.scene,i.model.traverse(function(o){if(o.isMesh){var u=o.material;u.color&&a.applyColorCorrection(u.color),u.map&&a.applyColorCorrection(u.map),u.emissive&&a.applyColorCorrection(u.emissive),u.emissiveMap&&a.applyColorCorrection(u.emissiveMap)}}),n.setObject3D("mesh",i.model),n.emit("model-loaded",{format:"collada",model:i.model})}))},remove:function(){!this.model||this.el.removeObject3D("mesh")}});var WK=THREE.FBXLoader=function(){var i,n,r;function a(D){this.manager=D!==void 0?D:THREE.DefaultLoadingManager}a.prototype={constructor:a,crossOrigin:"anonymous",load:function(D,I,k,U){var W=this,ce=THREE.LoaderUtils.extractUrlBase(D),oe=new THREE.FileLoader(this.manager);oe.setResponseType("arraybuffer"),oe.load(D,function(ge){try{var _e=W.parse(ge,ce);I(_e)}catch(Ne){setTimeout(function(){U&&U(Ne),W.manager.itemError(D)},0)}},k,U)},setCrossOrigin:function(D){return this.crossOrigin=D,this},parse:function(D,I){if(y(D))i=new v().parse(D);else{var k=Y(D);if(!b(k))throw new Error("THREE.FBXLoader: Unknown format.");if(w(k)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+w(k));i=new f().parse(k)}var U=new THREE.TextureLoader(this.manager).setPath(I).setCrossOrigin(this.crossOrigin);return new s(U).parse(i)}};function s(D){this.textureLoader=D}s.prototype={constructor:s,parse:function(){n=this.parseConnections();var D=this.parseImages(),I=this.parseTextures(D),k=this.parseMaterials(I),U=this.parseDeformers(),W=new o().parse(U);return this.parseScene(U,W,k),r},parseConnections:function(){var D=new Map;if("Connections"in i){var I=i.Connections.connections;I.forEach(function(k){var U=k[0],W=k[1],ce=k[2];D.has(U)||D.set(U,{parents:[],children:[]});var oe={ID:W,relationship:ce};D.get(U).parents.push(oe),D.has(W)||D.set(W,{parents:[],children:[]});var ge={ID:U,relationship:ce};D.get(W).children.push(ge)})}return D},parseImages:function(){var D={},I={};if("Video"in i.Objects){var k=i.Objects.Video;for(var U in k){var W=k[U],ce=parseInt(U);if(D[ce]=W.RelativeFilename||W.Filename,"Content"in W){var oe=W.Content instanceof ArrayBuffer&&W.Content.byteLength>0,ge=typeof W.Content=="string"&&W.Content!=="";if(oe||ge){var _e=this.parseImage(k[U]);I[W.RelativeFilename||W.Filename]=_e}}}}for(var ce in D){var Ne=D[ce];I[Ne]!==void 0?D[ce]=I[Ne]:D[ce]=D[ce].split("\\").pop()}return D},parseImage:function(D){var I=D.Content,k=D.RelativeFilename||D.Filename,U=k.slice(k.lastIndexOf(".")+1).toLowerCase(),W;switch(U){case"bmp":W="image/bmp";break;case"jpg":case"jpeg":W="image/jpeg";break;case"png":W="image/png";break;case"tif":W="image/tiff";break;case"tga":if(typeof THREE.TGALoader!="function"){console.warn("FBXLoader: THREE.TGALoader is required to load TGA textures");return}else{THREE.Loader.Handlers.get(".tga")===null&&THREE.Loader.Handlers.add(/\.tga$/i,new THREE.TGALoader),W="image/tga";break}default:console.warn('FBXLoader: Image type "'+U+'" is not supported.');return}if(typeof I=="string")return"data:"+W+";base64,"+I;var ce=new Uint8Array(I);return window.URL.createObjectURL(new Blob([ce],{type:W}))},parseTextures:function(D){var I=new Map;if("Texture"in i.Objects){var k=i.Objects.Texture;for(var U in k){var W=this.parseTexture(k[U],D);I.set(parseInt(U),W)}}return I},parseTexture:function(D,I){var k=this.loadTexture(D,I);k.ID=D.id,k.name=D.attrName;var U=D.WrapModeU,W=D.WrapModeV,ce=U!==void 0?U.value:0,oe=W!==void 0?W.value:0;if(k.wrapS=ce===0?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,k.wrapT=oe===0?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,"Scaling"in D){var ge=D.Scaling.value;k.repeat.x=ge[0],k.repeat.y=ge[1]}return k},loadTexture:function(D,I){var k,U=this.textureLoader.path,W=n.get(D.id).children;W!==void 0&&W.length>0&&I[W[0].ID]!==void 0&&(k=I[W[0].ID],(k.indexOf("blob:")===0||k.indexOf("data:")===0)&&this.textureLoader.setPath(void 0));var ce,oe=D.FileName.slice(-3).toLowerCase();if(oe==="tga"){var ge=THREE.Loader.Handlers.get(".tga");ge===null?(console.warn("FBXLoader: TGALoader not found, creating empty placeholder texture for",k),ce=new THREE.Texture):ce=ge.load(k)}else oe==="psd"?(console.warn("FBXLoader: PSD textures are not supported, creating empty placeholder texture for",k),ce=new THREE.Texture):ce=this.textureLoader.load(k);return this.textureLoader.setPath(U),ce},parseMaterials:function(D){var I=new Map;if("Material"in i.Objects){var k=i.Objects.Material;for(var U in k){var W=this.parseMaterial(k[U],D);W!==null&&I.set(parseInt(U),W)}}return I},parseMaterial:function(D,I){var k=D.id,U=D.attrName,W=D.ShadingModel;if(typeof W=="object"&&(W=W.value),!n.has(k))return null;var ce=this.parseParameters(D,I,k),oe;switch(W.toLowerCase()){case"phong":oe=new THREE.MeshPhongMaterial;break;case"lambert":oe=new THREE.MeshLambertMaterial;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',W),oe=new THREE.MeshPhongMaterial({color:3342591});break}return oe.setValues(ce),oe.name=U,oe},parseParameters:function(D,I,k){var U={};D.BumpFactor&&(U.bumpScale=D.BumpFactor.value),D.Diffuse?U.color=new THREE.Color().fromArray(D.Diffuse.value):D.DiffuseColor&&D.DiffuseColor.type==="Color"&&(U.color=new THREE.Color().fromArray(D.DiffuseColor.value)),D.DisplacementFactor&&(U.displacementScale=D.DisplacementFactor.value),D.Emissive?U.emissive=new THREE.Color().fromArray(D.Emissive.value):D.EmissiveColor&&D.EmissiveColor.type==="Color"&&(U.emissive=new THREE.Color().fromArray(D.EmissiveColor.value)),D.EmissiveFactor&&(U.emissiveIntensity=parseFloat(D.EmissiveFactor.value)),D.Opacity&&(U.opacity=parseFloat(D.Opacity.value)),U.opacity<1&&(U.transparent=!0),D.ReflectionFactor&&(U.reflectivity=D.ReflectionFactor.value),D.Shininess&&(U.shininess=D.Shininess.value),D.Specular?U.specular=new THREE.Color().fromArray(D.Specular.value):D.SpecularColor&&D.SpecularColor.type==="Color"&&(U.specular=new THREE.Color().fromArray(D.SpecularColor.value));var W=this;return n.get(k).children.forEach(function(ce){var oe=ce.relationship;switch(oe){case"Bump":U.bumpMap=W.getTexture(I,ce.ID);break;case"DiffuseColor":U.map=W.getTexture(I,ce.ID);break;case"DisplacementColor":U.displacementMap=W.getTexture(I,ce.ID);break;case"EmissiveColor":U.emissiveMap=W.getTexture(I,ce.ID);break;case"NormalMap":U.normalMap=W.getTexture(I,ce.ID);break;case"ReflectionColor":U.envMap=W.getTexture(I,ce.ID),U.envMap.mapping=THREE.EquirectangularReflectionMapping;break;case"SpecularColor":U.specularMap=W.getTexture(I,ce.ID);break;case"TransparentColor":U.alphaMap=W.getTexture(I,ce.ID),U.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",oe);break}}),U},getTexture:function(D,I){return"LayeredTexture"in i.Objects&&I in i.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),I=n.get(I).children[0].ID),D.get(I)},parseDeformers:function(){var D={},I={};if("Deformer"in i.Objects){var k=i.Objects.Deformer;for(var U in k){var W=k[U],ce=n.get(parseInt(U));if(W.attrType==="Skin"){var oe=this.parseSkeleton(ce,k);oe.ID=U,ce.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),oe.geometryID=ce.parents[0].ID,D[U]=oe}else if(W.attrType==="BlendShape"){var ge={id:U};ge.rawTargets=this.parseMorphTargets(ce,k),ge.id=U,ce.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),I[U]=ge}}}return{skeletons:D,morphTargets:I}},parseSkeleton:function(D,I){var k=[];return D.children.forEach(function(U){var W=I[U.ID];if(W.attrType==="Cluster"){var ce={ID:U.ID,indices:[],weights:[],transform:new THREE.Matrix4().fromArray(W.Transform.a),transformLink:new THREE.Matrix4().fromArray(W.TransformLink.a),linkMode:W.Mode};"Indexes"in W&&(ce.indices=W.Indexes.a,ce.weights=W.Weights.a),k.push(ce)}}),{rawBones:k,bones:[]}},parseMorphTargets:function(D,I){for(var k=[],U=0;U<D.children.length;U++){if(U===8){console.warn("FBXLoader: maximum of 8 morph targets supported. Ignoring additional targets.");break}var W=D.children[U],ce=I[W.ID],oe={name:ce.attrName,initialWeight:ce.DeformPercent,id:ce.id,fullWeights:ce.FullWeights.a};if(ce.attrType!=="BlendShapeChannel")return;var ge=n.get(parseInt(W.ID));ge.children.forEach(function(_e){_e.relationship===void 0&&(oe.geoID=_e.ID)}),k.push(oe)}return k},parseScene:function(D,I,k){r=new THREE.Group;var U=this.parseModels(D.skeletons,I,k),W=i.Objects.Model,ce=this;U.forEach(function(ge){var _e=W[ge.ID];ce.setLookAtProperties(ge,_e);var Ne=n.get(ge.ID).parents;Ne.forEach(function(Ie){var Ve=U.get(Ie.ID);Ve!==void 0&&Ve.add(ge)}),ge.parent===null&&r.add(ge)}),this.bindSkeleton(D.skeletons,I,U),this.createAmbientLight(),this.setupMorphMaterials();var oe=new u().parse();r.children.length===1&&r.children[0].isGroup&&(r.children[0].animations=oe,r=r.children[0]),r.animations=oe},parseModels:function(D,I,k){var U=new Map,W=i.Objects.Model;for(var ce in W){var oe=parseInt(ce),ge=W[ce],_e=n.get(oe),Ne=this.buildSkeleton(_e,D,oe,ge.attrName);if(!Ne){switch(ge.attrType){case"Camera":Ne=this.createCamera(_e);break;case"Light":Ne=this.createLight(_e);break;case"Mesh":Ne=this.createMesh(_e,I,k);break;case"NurbsCurve":Ne=this.createCurve(_e,I);break;case"LimbNode":case"Null":default:Ne=new THREE.Group;break}Ne.name=THREE.PropertyBinding.sanitizeNodeName(ge.attrName),Ne.ID=oe}this.setModelTransforms(Ne,ge),U.set(oe,Ne)}return U},buildSkeleton:function(D,I,k,U){var W=null;return D.parents.forEach(function(ce){for(var oe in I){var ge=I[oe];ge.rawBones.forEach(function(_e,Ne){if(_e.ID===ce.ID){var Ie=W;W=new THREE.Bone,W.matrixWorld.copy(_e.transformLink),W.name=THREE.PropertyBinding.sanitizeNodeName(U),W.ID=k,ge.bones[Ne]=W,Ie!==null&&W.add(Ie)}})}}),W},createCamera:function(D){var I,k;if(D.children.forEach(function(Ve){var Le=i.Objects.NodeAttribute[Ve.ID];Le!==void 0&&(k=Le)}),k===void 0)I=new THREE.Object3D;else{var U=0;k.CameraProjectionType!==void 0&&k.CameraProjectionType.value===1&&(U=1);var W=1;k.NearPlane!==void 0&&(W=k.NearPlane.value/1e3);var ce=1e3;k.FarPlane!==void 0&&(ce=k.FarPlane.value/1e3);var oe=window.innerWidth,ge=window.innerHeight;k.AspectWidth!==void 0&&k.AspectHeight!==void 0&&(oe=k.AspectWidth.value,ge=k.AspectHeight.value);var _e=oe/ge,Ne=45;k.FieldOfView!==void 0&&(Ne=k.FieldOfView.value);var Ie=k.FocalLength?k.FocalLength.value:null;switch(U){case 0:I=new THREE.PerspectiveCamera(Ne,_e,W,ce),Ie!==null&&I.setFocalLength(Ie);break;case 1:I=new THREE.OrthographicCamera(-oe/2,oe/2,ge/2,-ge/2,W,ce);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+U+"."),I=new THREE.Object3D;break}}return I},createLight:function(D){var I,k;if(D.children.forEach(function(Ie){var Ve=i.Objects.NodeAttribute[Ie.ID];Ve!==void 0&&(k=Ve)}),k===void 0)I=new THREE.Object3D;else{var U;k.LightType===void 0?U=0:U=k.LightType.value;var W=16777215;k.Color!==void 0&&(W=new THREE.Color().fromArray(k.Color.value));var ce=k.Intensity===void 0?1:k.Intensity.value/100;k.CastLightOnObject!==void 0&&k.CastLightOnObject.value===0&&(ce=0);var oe=0;k.FarAttenuationEnd!==void 0&&(k.EnableFarAttenuation!==void 0&&k.EnableFarAttenuation.value===0?oe=0:oe=k.FarAttenuationEnd.value);var ge=1;switch(U){case 0:I=new THREE.PointLight(W,ce,oe,ge);break;case 1:I=new THREE.DirectionalLight(W,ce);break;case 2:var _e=Math.PI/3;k.InnerAngle!==void 0&&(_e=THREE.Math.degToRad(k.InnerAngle.value));var Ne=0;k.OuterAngle!==void 0&&(Ne=THREE.Math.degToRad(k.OuterAngle.value),Ne=Math.max(Ne,1)),I=new THREE.SpotLight(W,ce,oe,_e,Ne,ge);break;default:console.warn("THREE.FBXLoader: Unknown light type "+k.LightType.value+", defaulting to a THREE.PointLight."),I=new THREE.PointLight(W,ce);break}k.CastShadows!==void 0&&k.CastShadows.value===1&&(I.castShadow=!0)}return I},createMesh:function(D,I,k){var U,W=null,ce=null,oe=[];return D.children.forEach(function(ge){I.has(ge.ID)&&(W=I.get(ge.ID)),k.has(ge.ID)&&oe.push(k.get(ge.ID))}),oe.length>1?ce=oe:oe.length>0?ce=oe[0]:(ce=new THREE.MeshPhongMaterial({color:13421772}),oe.push(ce)),"color"in W.attributes&&oe.forEach(function(ge){ge.vertexColors=THREE.VertexColors}),W.FBX_Deformer?(oe.forEach(function(ge){ge.skinning=!0}),U=new THREE.SkinnedMesh(W,ce)):U=new THREE.Mesh(W,ce),U},createCurve:function(D,I){var k=D.children.reduce(function(W,ce){return I.has(ce.ID)&&(W=I.get(ce.ID)),W},null),U=new THREE.LineBasicMaterial({color:3342591,linewidth:1});return new THREE.Line(k,U)},setModelTransforms:function(D,I){var k={};"RotationOrder"in I&&(k.eulerOrder=parseInt(I.RotationOrder.value)),"Lcl_Translation"in I&&(k.translation=I.Lcl_Translation.value),"RotationOffset"in I&&(k.rotationOffset=I.RotationOffset.value),"Lcl_Rotation"in I&&(k.rotation=I.Lcl_Rotation.value),"PreRotation"in I&&(k.preRotation=I.PreRotation.value),"PostRotation"in I&&(k.postRotation=I.PostRotation.value),"Lcl_Scaling"in I&&(k.scale=I.Lcl_Scaling.value);var U=N(k);D.applyMatrix(U)},setLookAtProperties:function(D,I){if("LookAtProperty"in I){var k=n.get(D.ID).children;k.forEach(function(U){if(U.relationship==="LookAtProperty"){var W=i.Objects.Model[U.ID];if("Lcl_Translation"in W){var ce=W.Lcl_Translation.value;D.target!==void 0?(D.target.position.fromArray(ce),r.add(D.target)):D.lookAt(new THREE.Vector3().fromArray(ce))}}})}},bindSkeleton:function(D,I,k){var U=this.parsePoseNodes();for(var W in D){var ce=D[W],oe=n.get(parseInt(ce.ID)).parents;oe.forEach(function(ge){if(I.has(ge.ID)){var _e=ge.ID,Ne=n.get(_e);Ne.parents.forEach(function(Ie){if(k.has(Ie.ID)){var Ve=k.get(Ie.ID);Ve.bind(new THREE.Skeleton(ce.bones),U[Ie.ID])}})}})}},parsePoseNodes:function(){var D={};if("Pose"in i.Objects){var I=i.Objects.Pose;for(var k in I)if(I[k].attrType==="BindPose"){var U=I[k].PoseNode;Array.isArray(U)?U.forEach(function(W){D[W.Node]=new THREE.Matrix4().fromArray(W.Matrix.a)}):D[U.Node]=new THREE.Matrix4().fromArray(U.Matrix.a)}}return D},createAmbientLight:function(){if("GlobalSettings"in i&&"AmbientColor"in i.GlobalSettings){var D=i.GlobalSettings.AmbientColor.value,I=D[0],k=D[1],U=D[2];if(I!==0||k!==0||U!==0){var W=new THREE.Color(I,k,U);r.add(new THREE.AmbientLight(W,1))}}},setupMorphMaterials:function(){r.traverse(function(D){if(D.isMesh&&(D.geometry.morphAttributes.position||D.geometry.morphAttributes.normal)){var I=D.uuid,k=D.material.uuid,U=!1;r.traverse(function(W){W.isMesh&&W.material.uuid===k&&W.uuid!==I&&(U=!0)}),U===!0&&(D.material=D.material.clone()),D.material.morphTargets=!0}})}};function o(){}o.prototype={constructor:o,parse:function(D){var I=new Map;if("Geometry"in i.Objects){var k=i.Objects.Geometry;for(var U in k){var W=n.get(parseInt(U)),ce=this.parseGeometry(W,k[U],D);I.set(parseInt(U),ce)}}return I},parseGeometry:function(D,I,k){switch(I.attrType){case"Mesh":return this.parseMeshGeometry(D,I,k);case"NurbsCurve":return this.parseNurbsGeometry(I)}},parseMeshGeometry:function(D,I,k){var U=k.skeletons,W=k.morphTargets,ce=D.parents.map(function(Ve){return i.Objects.Model[Ve.ID]});if(ce.length!==0){var oe=D.children.reduce(function(Ve,Le){return U[Le.ID]!==void 0&&(Ve=U[Le.ID]),Ve},null),ge=D.children.reduce(function(Ve,Le){return W[Le.ID]!==void 0&&(Ve=W[Le.ID]),Ve},null),_e=ce[0],Ne={};"RotationOrder"in _e&&(Ne.eulerOrder=_e.RotationOrder.value),"GeometricTranslation"in _e&&(Ne.translation=_e.GeometricTranslation.value),"GeometricRotation"in _e&&(Ne.rotation=_e.GeometricRotation.value),"GeometricScaling"in _e&&(Ne.scale=_e.GeometricScaling.value);var Ie=N(Ne);return this.genGeometry(I,oe,ge,Ie)}},genGeometry:function(D,I,k,U){var W=new THREE.BufferGeometry;D.attrName&&(W.name=D.attrName);var ce=this.parseGeoNode(D,I),oe=this.genBuffers(ce),ge=new THREE.Float32BufferAttribute(oe.vertex,3);if(U.applyToBufferAttribute(ge),W.addAttribute("position",ge),oe.colors.length>0&&W.addAttribute("color",new THREE.Float32BufferAttribute(oe.colors,3)),I&&(W.addAttribute("skinIndex",new THREE.Uint16BufferAttribute(oe.weightsIndices,4)),W.addAttribute("skinWeight",new THREE.Float32BufferAttribute(oe.vertexWeights,4)),W.FBX_Deformer=I),oe.normal.length>0){var _e=new THREE.Float32BufferAttribute(oe.normal,3),Ne=new THREE.Matrix3().getNormalMatrix(U);Ne.applyToBufferAttribute(_e),W.addAttribute("normal",_e)}if(oe.uvs.forEach(function(Me,Qe){var mt="uv"+(Qe+1).toString();Qe===0&&(mt="uv"),W.addAttribute(mt,new THREE.Float32BufferAttribute(oe.uvs[Qe],2))}),ce.material&&ce.material.mappingType!=="AllSame"){var Ie=oe.materialIndex[0],Ve=0;if(oe.materialIndex.forEach(function(Me,Qe){Me!==Ie&&(W.addGroup(Ve,Qe-Ve,Ie),Ie=Me,Ve=Qe)}),W.groups.length>0){var Le=W.groups[W.groups.length-1],Fe=Le.start+Le.count;Fe!==oe.materialIndex.length&&W.addGroup(Fe,oe.materialIndex.length-Fe,Ie)}W.groups.length===0&&W.addGroup(0,oe.materialIndex.length,oe.materialIndex[0])}return this.addMorphTargets(W,D,k,U),W},parseGeoNode:function(D,I){var k={};if(k.vertexPositions=D.Vertices!==void 0?D.Vertices.a:[],k.vertexIndices=D.PolygonVertexIndex!==void 0?D.PolygonVertexIndex.a:[],D.LayerElementColor&&(k.color=this.parseVertexColors(D.LayerElementColor[0])),D.LayerElementMaterial&&(k.material=this.parseMaterialIndices(D.LayerElementMaterial[0])),D.LayerElementNormal&&(k.normal=this.parseNormals(D.LayerElementNormal[0])),D.LayerElementUV){k.uv=[];for(var U=0;D.LayerElementUV[U];)k.uv.push(this.parseUVs(D.LayerElementUV[U])),U++}return k.weightTable={},I!==null&&(k.skeleton=I,I.rawBones.forEach(function(W,ce){W.indices.forEach(function(oe,ge){k.weightTable[oe]===void 0&&(k.weightTable[oe]=[]),k.weightTable[oe].push({id:ce,weight:W.weights[ge]})})})),k},genBuffers:function(D){var I={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]},k=0,U=0,W=!1,ce=[],oe=[],ge=[],_e=[],Ne=[],Ie=[],Ve=this;return D.vertexIndices.forEach(function(Le,Fe){var Me=!1;Le<0&&(Le=Le^-1,Me=!0);var Qe=[],mt=[];if(ce.push(Le*3,Le*3+1,Le*3+2),D.color){var ht=S(Fe,k,Le,D.color);ge.push(ht[0],ht[1],ht[2])}if(D.skeleton){if(D.weightTable[Le]!==void 0&&D.weightTable[Le].forEach(function(q){mt.push(q.weight),Qe.push(q.id)}),mt.length>4){W||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),W=!0);var ye=[0,0,0,0],fe=[0,0,0,0];mt.forEach(function(q,pe){var ee=q,te=Qe[pe];fe.forEach(function(Se,ke,Be){if(ee>Se){Be[ke]=ee,ee=Se;var We=ye[ke];ye[ke]=te,te=We}})}),Qe=ye,mt=fe}for(;mt.length<4;)mt.push(0),Qe.push(0);for(var H=0;H<4;++H)Ne.push(mt[H]),Ie.push(Qe[H])}if(D.normal){var ht=S(Fe,k,Le,D.normal);oe.push(ht[0],ht[1],ht[2])}if(D.material&&D.material.mappingType!=="AllSame")var j=S(Fe,k,Le,D.material)[0];D.uv&&D.uv.forEach(function(q,pe){var ee=S(Fe,k,Le,q);_e[pe]===void 0&&(_e[pe]=[]),_e[pe].push(ee[0]),_e[pe].push(ee[1])}),U++,Me&&(Ve.genFace(I,D,ce,j,oe,ge,_e,Ne,Ie,U),k++,U=0,ce=[],oe=[],ge=[],_e=[],Ne=[],Ie=[])}),I},genFace:function(D,I,k,U,W,ce,oe,ge,_e,Ne){for(var Ie=2;Ie<Ne;Ie++)D.vertex.push(I.vertexPositions[k[0]]),D.vertex.push(I.vertexPositions[k[1]]),D.vertex.push(I.vertexPositions[k[2]]),D.vertex.push(I.vertexPositions[k[(Ie-1)*3]]),D.vertex.push(I.vertexPositions[k[(Ie-1)*3+1]]),D.vertex.push(I.vertexPositions[k[(Ie-1)*3+2]]),D.vertex.push(I.vertexPositions[k[Ie*3]]),D.vertex.push(I.vertexPositions[k[Ie*3+1]]),D.vertex.push(I.vertexPositions[k[Ie*3+2]]),I.skeleton&&(D.vertexWeights.push(ge[0]),D.vertexWeights.push(ge[1]),D.vertexWeights.push(ge[2]),D.vertexWeights.push(ge[3]),D.vertexWeights.push(ge[(Ie-1)*4]),D.vertexWeights.push(ge[(Ie-1)*4+1]),D.vertexWeights.push(ge[(Ie-1)*4+2]),D.vertexWeights.push(ge[(Ie-1)*4+3]),D.vertexWeights.push(ge[Ie*4]),D.vertexWeights.push(ge[Ie*4+1]),D.vertexWeights.push(ge[Ie*4+2]),D.vertexWeights.push(ge[Ie*4+3]),D.weightsIndices.push(_e[0]),D.weightsIndices.push(_e[1]),D.weightsIndices.push(_e[2]),D.weightsIndices.push(_e[3]),D.weightsIndices.push(_e[(Ie-1)*4]),D.weightsIndices.push(_e[(Ie-1)*4+1]),D.weightsIndices.push(_e[(Ie-1)*4+2]),D.weightsIndices.push(_e[(Ie-1)*4+3]),D.weightsIndices.push(_e[Ie*4]),D.weightsIndices.push(_e[Ie*4+1]),D.weightsIndices.push(_e[Ie*4+2]),D.weightsIndices.push(_e[Ie*4+3])),I.color&&(D.colors.push(ce[0]),D.colors.push(ce[1]),D.colors.push(ce[2]),D.colors.push(ce[(Ie-1)*3]),D.colors.push(ce[(Ie-1)*3+1]),D.colors.push(ce[(Ie-1)*3+2]),D.colors.push(ce[Ie*3]),D.colors.push(ce[Ie*3+1]),D.colors.push(ce[Ie*3+2])),I.material&&I.material.mappingType!=="AllSame"&&(D.materialIndex.push(U),D.materialIndex.push(U),D.materialIndex.push(U)),I.normal&&(D.normal.push(W[0]),D.normal.push(W[1]),D.normal.push(W[2]),D.normal.push(W[(Ie-1)*3]),D.normal.push(W[(Ie-1)*3+1]),D.normal.push(W[(Ie-1)*3+2]),D.normal.push(W[Ie*3]),D.normal.push(W[Ie*3+1]),D.normal.push(W[Ie*3+2])),I.uv&&I.uv.forEach(function(Ve,Le){D.uvs[Le]===void 0&&(D.uvs[Le]=[]),D.uvs[Le].push(oe[Le][0]),D.uvs[Le].push(oe[Le][1]),D.uvs[Le].push(oe[Le][(Ie-1)*2]),D.uvs[Le].push(oe[Le][(Ie-1)*2+1]),D.uvs[Le].push(oe[Le][Ie*2]),D.uvs[Le].push(oe[Le][Ie*2+1])})},addMorphTargets:function(D,I,k,U){if(k!==null){D.morphAttributes.position=[],D.morphAttributes.normal=[];var W=this;k.rawTargets.forEach(function(ce){var oe=i.Objects.Geometry[ce.geoID];oe!==void 0&&W.genMorphGeometry(D,I,oe,U)})}},genMorphGeometry:function(D,I,k,U){var W=new THREE.BufferGeometry;k.attrName&&(W.name=k.attrName);for(var ce=I.PolygonVertexIndex!==void 0?I.PolygonVertexIndex.a:[],oe=I.Vertices!==void 0?I.Vertices.a.slice():[],ge=k.Vertices!==void 0?k.Vertices.a:[],_e=k.Indexes!==void 0?k.Indexes.a:[],Ne=0;Ne<_e.length;Ne++){var Ie=_e[Ne]*3;oe[Ie]+=ge[Ne*3],oe[Ie+1]+=ge[Ne*3+1],oe[Ie+2]+=ge[Ne*3+2]}var Ve={vertexIndices:ce,vertexPositions:oe},Le=this.genBuffers(Ve),Fe=new THREE.Float32BufferAttribute(Le.vertex,3);Fe.name=k.attrName,U.applyToBufferAttribute(Fe),D.morphAttributes.position.push(Fe)},parseNormals:function(D){var I=D.MappingInformationType,k=D.ReferenceInformationType,U=D.Normals.a,W=[];return k==="IndexToDirect"&&("NormalIndex"in D?W=D.NormalIndex.a:"NormalsIndex"in D&&(W=D.NormalsIndex.a)),{dataSize:3,buffer:U,indices:W,mappingType:I,referenceType:k}},parseUVs:function(D){var I=D.MappingInformationType,k=D.ReferenceInformationType,U=D.UV.a,W=[];return k==="IndexToDirect"&&(W=D.UVIndex.a),{dataSize:2,buffer:U,indices:W,mappingType:I,referenceType:k}},parseVertexColors:function(D){var I=D.MappingInformationType,k=D.ReferenceInformationType,U=D.Colors.a,W=[];return k==="IndexToDirect"&&(W=D.ColorIndex.a),{dataSize:4,buffer:U,indices:W,mappingType:I,referenceType:k}},parseMaterialIndices:function(D){var I=D.MappingInformationType,k=D.ReferenceInformationType;if(I==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:k};for(var U=D.Materials.a,W=[],ce=0;ce<U.length;++ce)W.push(ce);return{dataSize:1,buffer:U,indices:W,mappingType:I,referenceType:k}},parseNurbsGeometry:function(D){if(THREE.NURBSCurve===void 0)return console.error("THREE.FBXLoader: The loader relies on THREE.NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new THREE.BufferGeometry;var I=parseInt(D.Order);if(isNaN(I))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",D.Order,D.id),new THREE.BufferGeometry;for(var k=I-1,U=D.KnotVector.a,W=[],ce=D.Points.a,oe=0,ge=ce.length;oe<ge;oe+=4)W.push(new THREE.Vector4().fromArray(ce,oe));var _e,Ne;if(D.Form==="Closed")W.push(W[0]);else if(D.Form==="Periodic"){_e=k,Ne=U.length-1-_e;for(var oe=0;oe<k;++oe)W.push(W[oe])}var Ie=new THREE.NURBSCurve(k,U,W,_e,Ne),Ve=Ie.getPoints(W.length*7),Le=new Float32Array(Ve.length*3);Ve.forEach(function(Me,Qe){Me.toArray(Le,Qe*3)});var Fe=new THREE.BufferGeometry;return Fe.addAttribute("position",new THREE.BufferAttribute(Le,3)),Fe}};function u(){}u.prototype={constructor:u,parse:function(){var D=[],I=this.parseClips();if(I===void 0)return D;for(var k in I){var U=I[k],W=this.addClip(U);D.push(W)}return D},parseClips:function(){if(i.Objects.AnimationCurve!==void 0){var D=this.parseAnimationCurveNodes();this.parseAnimationCurves(D);var I=this.parseAnimationLayers(D),k=this.parseAnimStacks(I);return k}},parseAnimationCurveNodes:function(){var D=i.Objects.AnimationCurveNode,I=new Map;for(var k in D){var U=D[k];if(U.attrName.match(/S|R|T|DeformPercent/)!==null){var W={id:U.id,attr:U.attrName,curves:{}};I.set(W.id,W)}}return I},parseAnimationCurves:function(D){var I=i.Objects.AnimationCurve;for(var k in I){var U={id:I[k].id,times:I[k].KeyTime.a.map(A),values:I[k].KeyValueFloat.a},W=n.get(U.id);if(W!==void 0){var ce=W.parents[0].ID,oe=W.parents[0].relationship;oe.match(/X/)?D.get(ce).curves.x=U:oe.match(/Y/)?D.get(ce).curves.y=U:oe.match(/Z/)?D.get(ce).curves.z=U:oe.match(/d|DeformPercent/)&&D.has(ce)&&(D.get(ce).curves.morph=U)}}},parseAnimationLayers:function(D){var I=i.Objects.AnimationLayer,k=new Map;for(var U in I){var W=[],ce=n.get(parseInt(U));if(ce!==void 0){var oe=ce.children,ge=this;oe.forEach(function(_e,Ne){if(D.has(_e.ID)){var Ie=D.get(_e.ID);if(Ie.curves.x!==void 0||Ie.curves.y!==void 0||Ie.curves.z!==void 0){if(W[Ne]===void 0){var Ve;n.get(_e.ID).parents.forEach(function(ht){ht.relationship!==void 0&&(Ve=ht.ID)});var Le=i.Objects.Model[Ve.toString()],Fe={modelName:THREE.PropertyBinding.sanitizeNodeName(Le.attrName),initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1],transform:ge.getModelAnimTransform(Le)};"PreRotation"in Le&&(Fe.preRotations=Le.PreRotation.value),"PostRotation"in Le&&(Fe.postRotations=Le.PostRotation.value),W[Ne]=Fe}W[Ne][Ie.attr]=Ie}else if(Ie.curves.morph!==void 0){if(W[Ne]===void 0){var Me;n.get(_e.ID).parents.forEach(function(H){H.relationship!==void 0&&(Me=H.ID)});var Qe=n.get(Me).parents[0].ID,mt=n.get(Qe).parents[0].ID,Ve=n.get(mt).parents[0].ID,Le=i.Objects.Model[Ve],Fe={modelName:THREE.PropertyBinding.sanitizeNodeName(Le.attrName),morphName:i.Objects.Deformer[Me].attrName};W[Ne]=Fe}W[Ne][Ie.attr]=Ie}}}),k.set(parseInt(U),W)}}return k},getModelAnimTransform:function(D){var I={};return"RotationOrder"in D&&(I.eulerOrder=parseInt(D.RotationOrder.value)),"Lcl_Translation"in D&&(I.translation=D.Lcl_Translation.value),"RotationOffset"in D&&(I.rotationOffset=D.RotationOffset.value),"Lcl_Rotation"in D&&(I.rotation=D.Lcl_Rotation.value),"PreRotation"in D&&(I.preRotation=D.PreRotation.value),"PostRotation"in D&&(I.postRotation=D.PostRotation.value),"Lcl_Scaling"in D&&(I.scale=D.Lcl_Scaling.value),N(I)},parseAnimStacks:function(D){var I=i.Objects.AnimationStack,k={};for(var U in I){var W=n.get(parseInt(U)).children;W.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");var ce=D.get(W[0].ID);k[U]={name:I[U].attrName,layer:ce}}return k},addClip:function(D){var I=[],k=this;return D.layer.forEach(function(U){I=I.concat(k.generateTracks(U))}),new THREE.AnimationClip(D.name,-1,I)},generateTracks:function(D){var I=[],k=new THREE.Vector3,U=new THREE.Quaternion,W=new THREE.Vector3;if(D.transform&&D.transform.decompose(k,U,W),k=k.toArray(),U=new THREE.Euler().setFromQuaternion(U).toArray(),W=W.toArray(),D.T!==void 0&&Object.keys(D.T.curves).length>0){var ce=this.generateVectorTrack(D.modelName,D.T.curves,k,"position");ce!==void 0&&I.push(ce)}if(D.R!==void 0&&Object.keys(D.R.curves).length>0){var oe=this.generateRotationTrack(D.modelName,D.R.curves,U,D.preRotations,D.postRotations);oe!==void 0&&I.push(oe)}if(D.S!==void 0&&Object.keys(D.S.curves).length>0){var ge=this.generateVectorTrack(D.modelName,D.S.curves,W,"scale");ge!==void 0&&I.push(ge)}if(D.DeformPercent!==void 0){var _e=this.generateMorphTrack(D);_e!==void 0&&I.push(_e)}return I},generateVectorTrack:function(D,I,k,U){var W=this.getTimesForAllAxes(I),ce=this.getKeyframeTrackValues(W,I,k);return new THREE.VectorKeyframeTrack(D+"."+U,W,ce)},generateRotationTrack:function(D,I,k,U,W){I.x!==void 0&&(this.interpolateRotations(I.x),I.x.values=I.x.values.map(THREE.Math.degToRad)),I.y!==void 0&&(this.interpolateRotations(I.y),I.y.values=I.y.values.map(THREE.Math.degToRad)),I.z!==void 0&&(this.interpolateRotations(I.z),I.z.values=I.z.values.map(THREE.Math.degToRad));var ce=this.getTimesForAllAxes(I),oe=this.getKeyframeTrackValues(ce,I,k);U!==void 0&&(U=U.map(THREE.Math.degToRad),U.push("ZYX"),U=new THREE.Euler().fromArray(U),U=new THREE.Quaternion().setFromEuler(U)),W!==void 0&&(W=W.map(THREE.Math.degToRad),W.push("ZYX"),W=new THREE.Euler().fromArray(W),W=new THREE.Quaternion().setFromEuler(W).inverse());for(var ge=new THREE.Quaternion,_e=new THREE.Euler,Ne=[],Ie=0;Ie<oe.length;Ie+=3)_e.set(oe[Ie],oe[Ie+1],oe[Ie+2],"ZYX"),ge.setFromEuler(_e),U!==void 0&&ge.premultiply(U),W!==void 0&&ge.multiply(W),ge.toArray(Ne,Ie/3*4);return new THREE.QuaternionKeyframeTrack(D+".quaternion",ce,Ne)},generateMorphTrack:function(D){var I=D.DeformPercent.curves.morph,k=I.values.map(function(W){return W/100}),U=r.getObjectByName(D.modelName).morphTargetDictionary[D.morphName];return new THREE.NumberKeyframeTrack(D.modelName+".morphTargetInfluences["+U+"]",I.times,k)},getTimesForAllAxes:function(D){var I=[];return D.x!==void 0&&(I=I.concat(D.x.times)),D.y!==void 0&&(I=I.concat(D.y.times)),D.z!==void 0&&(I=I.concat(D.z.times)),I=I.sort(function(k,U){return k-U}).filter(function(k,U,W){return W.indexOf(k)==U}),I},getKeyframeTrackValues:function(D,I,k){var U=k,W=[],ce=-1,oe=-1,ge=-1;return D.forEach(function(_e){if(I.x&&(ce=I.x.times.indexOf(_e)),I.y&&(oe=I.y.times.indexOf(_e)),I.z&&(ge=I.z.times.indexOf(_e)),ce!==-1){var Ne=I.x.values[ce];W.push(Ne),U[0]=Ne}else W.push(U[0]);if(oe!==-1){var Ie=I.y.values[oe];W.push(Ie),U[1]=Ie}else W.push(U[1]);if(ge!==-1){var Ve=I.z.values[ge];W.push(Ve),U[2]=Ve}else W.push(U[2])}),W},interpolateRotations:function(D){for(var I=1;I<D.values.length;I++){var k=D.values[I-1],U=D.values[I]-k,W=Math.abs(U);if(W>=180){for(var ce=W/180,oe=U/ce,ge=k+oe,_e=D.times[I-1],Ne=D.times[I]-_e,Ie=Ne/ce,Ve=_e+Ie,Le=[],Fe=[];Ve<D.times[I];)Le.push(Ve),Ve+=Ie,Fe.push(ge),ge+=oe;D.times=de(D.times,I,Le),D.values=de(D.values,I,Fe)}}}};function f(){}f.prototype={constructor:f,getPrevNode:function(){return this.nodeStack[this.currentIndent-2]},getCurrentNode:function(){return this.nodeStack[this.currentIndent-1]},getCurrentProp:function(){return this.currentProp},pushStack:function(D){this.nodeStack.push(D),this.currentIndent+=1},popStack:function(){this.nodeStack.pop(),this.currentIndent-=1},setCurrentProp:function(D,I){this.currentProp=D,this.currentPropName=I},parse:function(D){this.currentIndent=0,console.log("FBXTree: ",g),this.allNodes=new g,this.nodeStack=[],this.currentProp=[],this.currentPropName="";var I=this,k=D.split(/[\r\n]+/);return k.forEach(function(U,W){var ce=U.match(/^[\s\t]*;/),oe=U.match(/^[\s\t]*$/);if(!(ce||oe)){var ge=U.match("^\\t{"+I.currentIndent+"}(\\w+):(.*){",""),_e=U.match("^\\t{"+I.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),Ne=U.match("^\\t{"+(I.currentIndent-1)+"}}");ge?I.parseNodeBegin(U,ge):_e?I.parseNodeProperty(U,_e,k[++W]):Ne?I.popStack():U.match(/^[^\s\t}]/)&&I.parseNodePropertyContinued(U)}}),this.allNodes},parseNodeBegin:function(D,I){var k=I[1].trim().replace(/^"/,"").replace(/"$/,""),U=I[2].split(",").map(function(ge){return ge.trim().replace(/^"/,"").replace(/"$/,"")}),W={name:k},ce=this.parseNodeAttr(U),oe=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(k,W):k in oe?(k==="PoseNode"?oe.PoseNode.push(W):oe[k].id!==void 0&&(oe[k]={},oe[k][oe[k].id]=oe[k]),ce.id!==""&&(oe[k][ce.id]=W)):typeof ce.id=="number"?(oe[k]={},oe[k][ce.id]=W):k!=="Properties70"&&(k==="PoseNode"?oe[k]=[W]:oe[k]=W),typeof ce.id=="number"&&(W.id=ce.id),ce.name!==""&&(W.attrName=ce.name),ce.type!==""&&(W.attrType=ce.type),this.pushStack(W)},parseNodeAttr:function(D){var I=D[0];D[0]!==""&&(I=parseInt(D[0]),isNaN(I)&&(I=D[0]));var k="",U="";return D.length>1&&(k=D[1].replace(/^(\w+)::/,""),U=D[2]),{id:I,name:k,type:U}},parseNodeProperty:function(D,I,k){var U=I[1].replace(/^"/,"").replace(/"$/,"").trim(),W=I[2].replace(/^"/,"").replace(/"$/,"").trim();U==="Content"&&W===","&&(W=k.replace(/"/g,"").replace(/,$/,"").trim());var ce=this.getCurrentNode(),oe=ce.name;if(oe==="Properties70"){this.parseNodeSpecialProperty(D,U,W);return}if(U==="C"){var ge=W.split(",").slice(1),_e=parseInt(ge[0]),Ne=parseInt(ge[1]),Ie=W.split(",").slice(3);Ie=Ie.map(function(Ve){return Ve.trim().replace(/^"/,"")}),U="connections",W=[_e,Ne],ae(W,Ie),ce[U]===void 0&&(ce[U]=[])}U==="Node"&&(ce.id=W),U in ce&&Array.isArray(ce[U])?ce[U].push(W):U!=="a"?ce[U]=W:ce.a=W,this.setCurrentProp(ce,U),U==="a"&&W.slice(-1)!==","&&(ce.a=X(W))},parseNodePropertyContinued:function(D){var I=this.getCurrentNode();I.a+=D,D.slice(-1)!==","&&(I.a=X(I.a))},parseNodeSpecialProperty:function(D,I,k){var U=k.split('",').map(function(Ne){return Ne.trim().replace(/^\"/,"").replace(/\s/,"_")}),W=U[0],ce=U[1],oe=U[2],ge=U[3],_e=U[4];switch(ce){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":_e=parseFloat(_e);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":_e=X(_e);break}this.getPrevNode()[W]={type:ce,type2:oe,flag:ge,value:_e},this.setCurrentProp(this.getPrevNode(),W)}};function v(){}v.prototype={constructor:v,parse:function(D){var I=new m(D);I.skip(23);var k=I.getUint32();console.log("THREE.FBXLoader: FBX binary version: "+k);for(var U=new g;!this.endOfContent(I);){var W=this.parseNode(I,k);W!==null&&U.add(W.name,W)}return U},endOfContent:function(D){return D.size()%16==0?(D.getOffset()+160+16&~15)>=D.size():D.getOffset()+160+16>=D.size()},parseNode:function(D,I){var k={},U=I>=7500?D.getUint64():D.getUint32(),W=I>=7500?D.getUint64():D.getUint32();I>=7500?D.getUint64():D.getUint32();var ce=D.getUint8(),oe=D.getString(ce);if(U===0)return null;for(var ge=[],_e=0;_e<W;_e++)ge.push(this.parseProperty(D));var Ne=ge.length>0?ge[0]:"",Ie=ge.length>1?ge[1]:"",Ve=ge.length>2?ge[2]:"";for(k.singleProperty=W===1&&D.getOffset()===U;U>D.getOffset();){var Le=this.parseNode(D,I);Le!==null&&this.parseSubNode(oe,k,Le)}return k.propertyList=ge,typeof Ne=="number"&&(k.id=Ne),Ie!==""&&(k.attrName=Ie),Ve!==""&&(k.attrType=Ve),oe!==""&&(k.name=oe),k},parseSubNode:function(D,I,k){if(k.singleProperty===!0){var U=k.propertyList[0];Array.isArray(U)?(I[k.name]=k,k.a=U):I[k.name]=U}else if(D==="Connections"&&k.name==="C"){var W=[];k.propertyList.forEach(function(Ve,Le){Le!==0&&W.push(Ve)}),I.connections===void 0&&(I.connections=[]),I.connections.push(W)}else if(k.name==="Properties70"){var ce=Object.keys(k);ce.forEach(function(Ve){I[Ve]=k[Ve]})}else if(D==="Properties70"&&k.name==="P"){var oe=k.propertyList[0],ge=k.propertyList[1],_e=k.propertyList[2],Ne=k.propertyList[3],Ie;oe.indexOf("Lcl ")===0&&(oe=oe.replace("Lcl ","Lcl_")),ge.indexOf("Lcl ")===0&&(ge=ge.replace("Lcl ","Lcl_")),ge==="Color"||ge==="ColorRGB"||ge==="Vector"||ge==="Vector3D"||ge.indexOf("Lcl_")===0?Ie=[k.propertyList[4],k.propertyList[5],k.propertyList[6]]:Ie=k.propertyList[4],I[oe]={type:ge,type2:_e,flag:Ne,value:Ie}}else I[k.name]===void 0?typeof k.id=="number"?(I[k.name]={},I[k.name][k.id]=k):I[k.name]=k:k.name==="PoseNode"?(Array.isArray(I[k.name])||(I[k.name]=[I[k.name]]),I[k.name].push(k)):I[k.name][k.id]===void 0&&(I[k.name][k.id]=k)},parseProperty:function(D){var I=D.getString(1);switch(I){case"C":return D.getBoolean();case"D":return D.getFloat64();case"F":return D.getFloat32();case"I":return D.getInt32();case"L":return D.getInt64();case"R":var k=D.getUint32();return D.getArrayBuffer(k);case"S":var k=D.getUint32();return D.getString(k);case"Y":return D.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":var U=D.getUint32(),W=D.getUint32(),ce=D.getUint32();if(W===0)switch(I){case"b":case"c":return D.getBooleanArray(U);case"d":return D.getFloat64Array(U);case"f":return D.getFloat32Array(U);case"i":return D.getInt32Array(U);case"l":return D.getInt64Array(U)}typeof Zlib=="undefined"&&console.error("THREE.FBXLoader: External library Inflate.min.js required, obtain or import from https://github.com/imaya/zlib.js");var oe=new Zlib.Inflate(new Uint8Array(D.getArrayBuffer(ce))),ge=new m(oe.decompress().buffer);switch(I){case"b":case"c":return ge.getBooleanArray(U);case"d":return ge.getFloat64Array(U);case"f":return ge.getFloat32Array(U);case"i":return ge.getInt32Array(U);case"l":return ge.getInt64Array(U)}default:throw new Error("THREE.FBXLoader: Unknown property type "+I)}}};function m(D,I){this.dv=new DataView(D),this.offset=0,this.littleEndian=I!==void 0?I:!0}m.prototype={constructor:m,getOffset:function(){return this.offset},size:function(){return this.dv.buffer.byteLength},skip:function(D){this.offset+=D},getBoolean:function(){return(this.getUint8()&1)==1},getBooleanArray:function(D){for(var I=[],k=0;k<D;k++)I.push(this.getBoolean());return I},getUint8:function(){var D=this.dv.getUint8(this.offset);return this.offset+=1,D},getInt16:function(){var D=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,D},getInt32:function(){var D=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,D},getInt32Array:function(D){for(var I=[],k=0;k<D;k++)I.push(this.getInt32());return I},getUint32:function(){var D=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,D},getInt64:function(){var D,I;return this.littleEndian?(D=this.getUint32(),I=this.getUint32()):(I=this.getUint32(),D=this.getUint32()),I&2147483648?(I=~I&4294967295,D=~D&4294967295,D===4294967295&&(I=I+1&4294967295),D=D+1&4294967295,-(I*4294967296+D)):I*4294967296+D},getInt64Array:function(D){for(var I=[],k=0;k<D;k++)I.push(this.getInt64());return I},getUint64:function(){var D,I;return this.littleEndian?(D=this.getUint32(),I=this.getUint32()):(I=this.getUint32(),D=this.getUint32()),I*4294967296+D},getFloat32:function(){var D=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,D},getFloat32Array:function(D){for(var I=[],k=0;k<D;k++)I.push(this.getFloat32());return I},getFloat64:function(){var D=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,D},getFloat64Array:function(D){for(var I=[],k=0;k<D;k++)I.push(this.getFloat64());return I},getArrayBuffer:function(D){var I=this.dv.buffer.slice(this.offset,this.offset+D);return this.offset+=D,I},getString:function(D){for(var I=[],k=0;k<D;k++)I[k]=this.getUint8();var U=I.indexOf(0);return U>=0&&(I=I.slice(0,U)),THREE.LoaderUtils.decodeText(new Uint8Array(I))}};function g(){}g.prototype={constructor:g,add:function(D,I){this[D]=I}};function y(D){var I="Kaydara FBX Binary  \0";return D.byteLength>=I.length&&I===Y(D,0,I.length)}function b(D){var I=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"],k=0;function U(oe){var ge=D[oe-1];return D=D.slice(k+oe),k++,ge}for(var W=0;W<I.length;++W){var ce=U(1);if(ce===I[W])return!1}return!0}function w(D){var I=/FBXVersion: (\d+)/,k=D.match(I);if(k){var U=parseInt(k[1]);return U}throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function A(D){return D/46186158e3}var M=[];function S(D,I,k,U){var W;switch(U.mappingType){case"ByPolygonVertex":W=D;break;case"ByPolygon":W=I;break;case"ByVertice":W=k;break;case"AllSame":W=U.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+U.mappingType)}U.referenceType==="IndexToDirect"&&(W=U.indices[W]);var ce=W*U.dataSize,oe=ce+U.dataSize;return $(M,U.buffer,ce,oe)}var E=new THREE.Matrix4,T=new THREE.Euler,C=new THREE.Vector3,L=new THREE.Vector3,P=new THREE.Matrix4;function N(D){var I=new THREE.Matrix4;L.set(0,0,0),P.identity();var k=D.eulerOrder?F(D.eulerOrder):F(0);if(D.translation&&L.fromArray(D.translation),D.rotationOffset&&L.add(C.fromArray(D.rotationOffset)),D.rotation){var U=D.rotation.map(THREE.Math.degToRad);U.push(k),P.makeRotationFromEuler(T.fromArray(U))}if(D.preRotation){var U=D.preRotation.map(THREE.Math.degToRad);U.push(k),E.makeRotationFromEuler(T.fromArray(U)),P.premultiply(E)}if(D.postRotation){var U=D.postRotation.map(THREE.Math.degToRad);U.push(k),E.makeRotationFromEuler(T.fromArray(U)),E.getInverse(E),P.multiply(E)}return D.scale&&I.scale(C.fromArray(D.scale)),I.setPosition(L),I.multiply(P),I}function F(D){var I=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return D===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),I[0]):I[D]}function X(D){var I=D.split(",").map(function(k){return parseFloat(k)});return I}function Y(D,I,k){return I===void 0&&(I=0),k===void 0&&(k=D.byteLength),THREE.LoaderUtils.decodeText(new Uint8Array(D,I,k))}function ae(D,I){for(var k=0,U=D.length,W=I.length;k<W;k++,U++)D[U]=I[k]}function $(D,I,k,U){for(var W=k,ce=0;W<U;W++,ce++)D[ce]=I[W];return D}function de(D,I,k){return D.slice(0,I).concat(k).concat(D.slice(I))}return a}();THREE.FBXLoader=WK;AFRAME.registerComponent("fbx-model",{schema:{src:{type:"asset"},crossorigin:{default:""}},init:function(){this.model=null},update:function(){const i=this.data;if(!i.src)return;this.remove();const n=new THREE.FBXLoader;i.crossorigin&&n.setCrossOrigin(i.crossorigin),n.load(i.src,this.load.bind(this))},load:function(i){this.model=i,this.el.setObject3D("mesh",i),this.el.emit("model-loaded",{format:"fbx",model:i})},remove:function(){this.model&&this.el.removeObject3D("mesh")}});function jK(){return"script_"+Date.now()+"_"+Math.ceil(Math.random()*1e5)}function XK(i,n){var r=document.createElement("script");return r.type="text/javascript",r.async=!0,r.id=n,r.src=i,r}function Pw(i){const n=document.getElementById(i),r=n.parentNode;try{r&&r.removeChild(n)}catch{}}function qK(i){const n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(i,n)}function YK(i,n,r){return new r(function(a,s){const o=n.timeout||5e3,u=jK(),f=XK(i,u),v=setTimeout(function(){s(new Error("Script request to "+i+" timed out")),Pw(u)},o),m=function(g){clearTimeout(g)};f.addEventListener("load",function(g){a({ok:!0}),m(v),Pw(u)}),f.addEventListener("error",function(g){s(new Error("Script request to "+i+" failed "+g)),m(v),Pw(u)}),qK(f)})}function $K(i){return i=i||{},function(n,r){return r=r||{},YK(n,r,i.Promise||Promise)}}var KK=$K;const ZK=KK(),QK="https://cdn.jsdelivr.net/gh/mrdoob/three.js@r86/examples/js/loaders/GLTFLoader.js",JK=function(){let i;return function(){return i=i||ZK(QK),i}}();AFRAME.registerComponent("gltf-model-legacy",{schema:{type:"model"},init:function(){this.model=null,this.loader=null,this.loaderPromise=JK().then(()=>{this.loader=new THREE.GLTFLoader,this.loader.setCrossOrigin("Anonymous")})},update:function(){const i=this,n=this.el,r=this.data;!r||(this.remove(),this.loaderPromise.then(()=>{this.loader.load(r,function(s){i.model=s.scene,i.model.animations=s.animations,n.setObject3D("mesh",i.model),n.emit("model-loaded",{format:"gltf",model:i.model})})}))},remove:function(){!this.model||this.el.removeObject3D("mesh")}});AFRAME.registerComponent("object-model",{schema:{src:{type:"asset"},crossorigin:{default:""}},init:function(){this.model=null},update:function(){let i;const n=this.data;!n.src||(this.remove(),i=new THREE.ObjectLoader,n.crossorigin&&i.setCrossOrigin(n.crossorigin),i.load(n.src,r=>{r.traverse(a=>{a instanceof THREE.SkinnedMesh&&a.material&&(a.material.skinning=!!(a.geometry&&a.geometry.bones||[]).length)}),this.load(r)}))},load:function(i){this.model=i,this.el.setObject3D("mesh",i),this.el.emit("model-loaded",{format:"json",model:i})},remove:function(){this.model&&this.el.removeObject3D("mesh")}});AFRAME.registerComponent("checkpoint",{schema:{offset:{default:{x:0,y:0,z:0},type:"vec3"}},init:function(){this.active=!1,this.targetEl=null,this.fire=this.fire.bind(this),this.offset=new THREE.Vector3},update:function(){this.offset.copy(this.data.offset)},play:function(){this.el.addEventListener("click",this.fire)},pause:function(){this.el.removeEventListener("click",this.fire)},remove:function(){this.pause()},fire:function(){const i=this.el.sceneEl.querySelector("[checkpoint-controls]");if(!i)throw new Error("No `checkpoint-controls` component found.");i.components["checkpoint-controls"].setCheckpoint(this.el)},getOffset:function(){return this.offset.copy(this.data.offset)}});function eZ(i){return i?Array.isArray(i)?i:i.materials?i.materials:[i]:[]}function wp(i,n,r,a){!i||(n=n||[],i.traverse(s=>{if(!s.isMesh)return;eZ(s.material).forEach(u=>{u&&!("envMap"in u)||n.length&&n.indexOf(u.name)===-1||(u.envMap=r,u.reflectivity=a,u.needsUpdate=!0)})}))}AFRAME.registerComponent("cube-env-map",{multiple:!0,schema:{path:{default:""},extension:{default:"jpg",oneOf:["jpg","png"]},format:{default:"RGBFormat",oneOf:["RGBFormat","RGBAFormat"]},enableBackground:{default:!1},reflectivity:{default:1,min:0,max:1},materials:{default:[]}},init:function(){const i=this.data;this.texture=new THREE.CubeTextureLoader().load([i.path+"posx."+i.extension,i.path+"negx."+i.extension,i.path+"posy."+i.extension,i.path+"negy."+i.extension,i.path+"posz."+i.extension,i.path+"negz."+i.extension]),this.texture.format=THREE[i.format],this.object3dsetHandler=()=>{const n=this.el.getObject3D("mesh"),r=this.data;wp(n,r.materials,this.texture,r.reflectivity)},this.el.addEventListener("object3dset",this.object3dsetHandler)},update:function(i){const n=this.data,r=this.el.getObject3D("mesh");let a=[],s=[];if(n.materials.length&&(i.materials?(a=n.materials.filter(o=>!i.materials.includes(o)),s=i.materials.filter(o=>!n.materials.includes(o))):a=n.materials),a.length&&wp(r,a,this.texture,n.reflectivity),s.length&&wp(r,s,null,1),i.materials&&n.reflectivity!==i.reflectivity){const o=n.materials.filter(u=>i.materials.includes(u));o.length&&wp(r,o,this.texture,n.reflectivity)}this.data.enableBackground&&!i.enableBackground?this.setBackground(this.texture):!this.data.enableBackground&&i.enableBackground&&this.setBackground(null)},remove:function(){this.el.removeEventListener("object3dset",this.object3dsetHandler);const i=this.el.getObject3D("mesh"),n=this.data;wp(i,n.materials,null,1),n.enableBackground&&this.setBackground(null)},setBackground:function(i){this.el.sceneEl.object3D.background=i}});AFRAME.registerComponent("grab",{init:function(){this.system=this.el.sceneEl.systems.physics,this.GRABBED_STATE="grabbed",this.grabbing=!1,this.hitEl=null,this.physics=this.el.sceneEl.systems.physics,this.constraint=null,this.onHit=this.onHit.bind(this),this.onGripOpen=this.onGripOpen.bind(this),this.onGripClose=this.onGripClose.bind(this)},play:function(){const i=this.el;i.addEventListener("hit",this.onHit),i.addEventListener("gripdown",this.onGripClose),i.addEventListener("gripup",this.onGripOpen),i.addEventListener("trackpaddown",this.onGripClose),i.addEventListener("trackpadup",this.onGripOpen),i.addEventListener("triggerdown",this.onGripClose),i.addEventListener("triggerup",this.onGripOpen)},pause:function(){const i=this.el;i.removeEventListener("hit",this.onHit),i.removeEventListener("gripdown",this.onGripClose),i.removeEventListener("gripup",this.onGripOpen),i.removeEventListener("trackpaddown",this.onGripClose),i.removeEventListener("trackpadup",this.onGripOpen),i.removeEventListener("triggerdown",this.onGripClose),i.removeEventListener("triggerup",this.onGripOpen)},onGripClose:function(){this.grabbing=!0},onGripOpen:function(){const i=this.hitEl;this.grabbing=!1,!!i&&(i.removeState(this.GRABBED_STATE),this.hitEl=void 0,this.system.removeConstraint(this.constraint),this.constraint=null)},onHit:function(i){const n=i.detail.el;!n||n.is(this.GRABBED_STATE)||!this.grabbing||this.hitEl||(n.addState(this.GRABBED_STATE),this.hitEl=n,this.constraint=new CANNON.LockConstraint(this.el.body,n.body),this.system.addConstraint(this.constraint))}});const tZ=-9.8,nZ=-15;AFRAME.registerComponent("jump-ability",{dependencies:["velocity"],schema:{on:{default:"keydown:Space gamepadbuttondown:0"},playerHeight:{default:1.764},maxJumps:{default:1},distance:{default:5},debug:{default:!1}},init:function(){this.velocity=0,this.numJumps=0;const i=this.beginJump.bind(this),n=this.data.on.split(" ");this.bindings={};for(let r=0;r<n.length;r++)this.bindings[n[r]]=i,this.el.addEventListener(n[r],i);this.bindings.collide=this.onCollide.bind(this),this.el.addEventListener("collide",this.bindings.collide)},remove:function(){for(var i in this.bindings)this.bindings.hasOwnProperty(i)&&(this.el.removeEventListener(i,this.bindings[i]),delete this.bindings[i]);this.el.removeEventListener("collide",this.bindings.collide),delete this.bindings.collide},beginJump:function(){if(this.numJumps<this.data.maxJumps){const i=this.data,n=Math.sqrt(-2*i.distance*(tZ+nZ)),r=this.el.getAttribute("velocity");this.el.setAttribute("velocity",{x:r.x,y:n,z:r.z}),this.numJumps++,this.el.emit("jumpstart")}},onCollide:function(){this.numJumps>0&&this.el.emit("jumpend"),this.numJumps=0}});const CR=1e-6;AFRAME.registerComponent("kinematic-body",{dependencies:["velocity"],schema:{mass:{default:5},radius:{default:1.3},linearDamping:{default:.05},enableSlopes:{default:!0},enableJumps:{default:!1}},init:function(){this.system=this.el.sceneEl.systems.physics,this.system.addComponent(this);const i=this.el,n=this.data,r=new CANNON.Vec3().copy(i.object3D.getWorldPosition(new THREE.Vector3));this.body=new CANNON.Body({material:this.system.getMaterial("staticMaterial"),position:r,mass:n.mass,linearDamping:n.linearDamping,fixedRotation:!0}),this.body.addShape(new CANNON.Sphere(n.radius),new CANNON.Vec3(0,n.radius,0)),this.body.el=this.el,this.el.body=this.body,this.system.addBody(this.body),i.hasAttribute("wasd-controls")&&console.warn("[kinematic-body] Not compatible with wasd-controls, use movement-controls.")},remove:function(){this.system.removeBody(this.body),this.system.removeComponent(this),delete this.el.body},beforeStep:function(i,n){if(!n)return;const r=this.el,a=this.data,s=this.body;a.enableJumps||s.velocity.set(0,0,0),s.position.copy(r.getAttribute("position"))},step:function(){const i=new THREE.Vector3,n=new THREE.Vector3,r=new THREE.Vector3,a=new THREE.Vector3;return function(s,o){if(!o)return;let u=this.body,f=this.data,v=!1,m,g=-1/0,y,b=this.system.getContacts();o=Math.min(o,this.system.data.maxInterval*1e3),a.set(0,0,0),i.copy(this.el.getAttribute("velocity")),u.velocity.copy(i);for(var w=0,A;A=b[w];w++)if(!!A.enabled){if(u.id===A.bi.id)A.ni.negate(r);else if(u.id===A.bj.id)r.copy(A.ni);else continue;v=u.velocity.dot(r)<-CR,v&&r.y<=.5?i.projectOnPlane(r):r.y>.5&&(m=u.id===A.bi.id?Math.abs(A.rj.y+A.bj.position.y):Math.abs(A.ri.y+A.bi.position.y),m>g&&(g=m,a.copy(r),y=u.id===A.bi.id?A.bj:A.bi))}n.copy(i).normalize(),y&&(!f.enableJumps||n.y<.5)?(f.enableSlopes?a.y<1-CR&&a.copy(this.raycastToGround(y,a)):a.set(0,1,0),i.projectOnPlane(a)):this.system.driver.world&&i.add(this.system.driver.world.gravity.scale(o*4/1e3)),u.velocity.copy(i),this.el.setAttribute("velocity",u.velocity),this.el.setAttribute("position",u.position)}}(),raycastToGround:function(i,n){let r,a,s=this.body.position,o=this.body.position.clone();return r=new CANNON.Ray(s,o),r._updateDirection(),r.intersectBody(i),r.hasHit?(a=r.result.hitNormalWorld,Math.abs(a.y)>Math.abs(n.y)?a:n):n}});AFRAME.registerComponent("mesh-smooth",{init:function(){this.el.addEventListener("model-loaded",i=>{i.detail.model.traverse(n=>{n.isMesh&&n.geometry.computeVertexNormals()})})}});AFRAME.registerComponent("normal-material",{init:function(){this.material=new THREE.MeshNormalMaterial({flatShading:!0}),this.applyMaterial=this.applyMaterial.bind(this),this.el.addEventListener("object3dset",this.applyMaterial)},remove:function(){this.el.removeEventListener("object3dset",this.applyMaterial)},applyMaterial:function(){this.el.object3D.traverse(i=>{i.isMesh&&(i.material=this.material)})}});AFRAME.registerComponent("sphere-collider",{schema:{objects:{default:""},state:{default:"collided"},radius:{default:.05},watch:{default:!0}},init:function(){this.observer=null,this.els=[],this.collisions=[],this.handleHit=this.handleHit.bind(this),this.handleHitEnd=this.handleHitEnd.bind(this)},remove:function(){this.pause()},play:function(){const i=this.el.sceneEl;this.data.watch&&(this.observer=new MutationObserver(this.update.bind(this,null)),this.observer.observe(i,{childList:!0,subtree:!0}))},pause:function(){this.observer&&(this.observer.disconnect(),this.observer=null)},update:function(){const i=this.data;let n;i.objects?n=this.el.sceneEl.querySelectorAll(i.objects):n=this.el.sceneEl.children,this.els=Array.prototype.slice.call(n)},tick:function(){const i=new THREE.Vector3,n=new THREE.Vector3,r=new THREE.Vector3,a=new THREE.Vector3,s=new THREE.Box3,o=new Map;return function(){const u=this.el,f=this.data,v=u.getObject3D("mesh"),m=[];let g;if(!v)return;o.clear(),u.object3D.getWorldPosition(i),u.object3D.getWorldScale(r),g=f.radius*b(r),this.els.forEach(y),m.sort((w,A)=>o.get(w)>o.get(A)?1:-1).forEach(this.handleHit),m.length===0&&u.emit("hit",{el:null}),this.collisions.filter(w=>!o.has(w)).forEach(this.handleHitEnd),this.collisions=m;function y(w){let A,M,S,E;!w.isEntity||(M=w.getObject3D("mesh"),!!M&&(s.setFromObject(M).getSize(a),E=Math.max(a.x,a.y,a.z)/2,A=Math.sqrt(2*E*E),s.getCenter(n),!!A&&(S=i.distanceTo(n),S<A+g&&(m.push(w),o.set(w,S)))))}function b(w){return Math.max.apply(null,w.toArray())}}}(),handleHit:function(i){i.emit("hit"),i.addState(this.data.state),this.el.emit("hit",{el:i})},handleHitEnd:function(i){i.emit("hitend"),i.removeState(this.data.state),this.el.emit("hitend",{el:i})}});AFRAME.registerComponent("nav-mesh",{init:function(){this.system=this.el.sceneEl.systems.nav,this.hasLoadedNavMesh=!1,this.el.addEventListener("object3dset",this.loadNavMesh.bind(this))},play:function(){this.hasLoadedNavMesh||this.loadNavMesh()},loadNavMesh:function(){const i=this.el.getObject3D("mesh"),n=this.el.sceneEl.object3D;if(!i)return;let r;if(i.traverse(s=>{s.isMesh&&(r=s)}),!r)return;const a=r.geometry.isBufferGeometry?new THREE.Geometry().fromBufferGeometry(r.geometry):r.geometry.clone();n.updateMatrixWorld(),a.applyMatrix(r.matrixWorld),this.system.setNavMeshGeometry(a),this.hasLoadedNavMesh=!0}});AFRAME.registerComponent("nav-agent",{schema:{destination:{type:"vec3"},active:{default:!1},speed:{default:2}},init:function(){this.system=this.el.sceneEl.systems.nav,this.system.addAgent(this),this.group=null,this.path=[],this.raycaster=new THREE.Raycaster},remove:function(){this.system.removeAgent(this)},update:function(){this.path.length=0},updateNavLocation:function(){this.group=null,this.path=[]},tick:function(){const i=new THREE.Vector3,n=new THREE.Vector3,r=new THREE.Vector3;return function(a,s){const o=this.el,u=this.data,f=this.raycaster,v=u.speed*s/1e3;if(!u.active)return;if(!this.path.length){const A=this.el.object3D.position;this.group=this.group||this.system.getGroup(A),this.path=this.system.getPath(A,i.copy(u.destination),this.group)||[],o.emit("navigation-start")}if(!this.path.length){console.warn("[nav] Unable to find path to %o.",u.destination),this.el.setAttribute("nav-agent",{active:!1}),o.emit("navigation-end");return}const m=o.object3D.position,g=this.path[0];n.subVectors(g,m);const y=n.length();let b;if(y<v){if(this.path.shift(),!this.path.length){this.el.setAttribute("nav-agent",{active:!1}),o.emit("navigation-end");return}r.copy(m),b=this.path[0]}else r.copy(n.setLength(v)).add(m),b=g;b.y=m.y,o.object3D.lookAt(b),f.ray.origin.copy(r),f.ray.origin.y+=1.5,f.ray.direction.y=-1;const w=f.intersectObject(this.system.getNavMesh());w.length?(n.subVectors(w[0].point,m),m.add(n.setLength(v))):m.copy(r)}}()});var Gr=function(){};Gr.computeCentroids=function(i){var n,r,a;for(n=0,r=i.faces.length;n<r;n++)(a=i.faces[n]).centroid=new THREE.Vector3(0,0,0),a.centroid.add(i.vertices[a.a]),a.centroid.add(i.vertices[a.b]),a.centroid.add(i.vertices[a.c]),a.centroid.divideScalar(3)},Gr.roundNumber=function(i,n){return Number(i.toFixed(n))},Gr.sample=function(i){return i[Math.floor(Math.random()*i.length)]},Gr.mergeVertexIds=function(i,n){var r=[];if(i.forEach(function(v){n.indexOf(v)>=0&&r.push(v)}),r.length<2)return[];r.includes(i[0])&&r.includes(i[i.length-1])&&i.push(i.shift()),r.includes(n[0])&&r.includes(n[n.length-1])&&n.push(n.shift()),r=[],i.forEach(function(v){n.includes(v)&&r.push(v)});for(var a=r[1],s=r[0],o=i.slice();o[0]!==a;)o.push(o.shift());for(var u=0,f=n.slice();f[0]!==s;)if(f.push(f.shift()),u++>10)throw new Error("Unexpected state");return f.shift(),f.pop(),o=o.concat(f)},Gr.setPolygonCentroid=function(i,n){var r=new THREE.Vector3,a=n.vertices;i.vertexIds.forEach(function(s){r.add(a[s])}),r.divideScalar(i.vertexIds.length),i.centroid.copy(r)},Gr.cleanPolygon=function(i,n){for(var r=[],a=n.vertices,s=0;s<i.vertexIds.length;s++){var o,u,f,v=a[i.vertexIds[s]];s===0?(o=i.vertexIds[1],u=i.vertexIds[i.vertexIds.length-1]):s===i.vertexIds.length-1?(o=i.vertexIds[0],u=i.vertexIds[i.vertexIds.length-2]):(o=i.vertexIds[s+1],u=i.vertexIds[s-1]),f=a[u];var m=a[o].clone().sub(v),g=f.clone().sub(v),y=m.angleTo(g);if(y>Math.PI-.01&&y<Math.PI+.01){var b=[];i.neighbours.forEach(function(w){w.vertexIds.includes(i.vertexIds[s])||b.push(w)}),i.neighbours=b}else r.push(i.vertexIds[s])}i.vertexIds=r,this.setPolygonCentroid(i,n)},Gr.isConvex=function(i,n){var r=n.vertices;if(i.vertexIds.length<3)return!1;for(var a=!0,s=[],o=0;o<i.vertexIds.length;o++){var u,f,v=r[i.vertexIds[o]];o===0?(u=r[i.vertexIds[1]],f=r[i.vertexIds[i.vertexIds.length-1]]):o===i.vertexIds.length-1?(u=r[i.vertexIds[0]],f=r[i.vertexIds[i.vertexIds.length-2]]):(u=r[i.vertexIds[o+1]],f=r[i.vertexIds[o-1]]);var m=u.clone().sub(v),g=f.clone().sub(v),y=m.angleTo(g);if(y===Math.PI||y===0)return!1;var b=m.cross(g).y;s.push(b)}return s.forEach(function(w){w===0&&(a=!1)}),s.forEach(s[0]>0?function(w){w<0&&(a=!1)}:function(w){w>0&&(a=!1)}),a},Gr.distanceToSquared=function(i,n){var r=i.x-n.x,a=i.y-n.y,s=i.z-n.z;return r*r+a*a+s*s},Gr.isPointInPoly=function(i,n){for(var r=!1,a=-1,s=i.length,o=s-1;++a<s;o=a)(i[a].z<=n.z&&n.z<i[o].z||i[o].z<=n.z&&n.z<i[a].z)&&n.x<(i[o].x-i[a].x)*(n.z-i[a].z)/(i[o].z-i[a].z)+i[a].x&&(r=!r);return r},Gr.isVectorInPolygon=function(i,n,r){var a=1e5,s=-1e5,o=[];return n.vertexIds.forEach(function(u){a=Math.min(r[u].y,a),s=Math.max(r[u].y,s),o.push(r[u])}),!!(i.y<s+.5&&i.y>a-.5&&this.isPointInPoly(o,i))},Gr.triarea2=function(i,n,r){return(r.x-i.x)*(n.z-i.z)-(n.x-i.x)*(r.z-i.z)},Gr.vequal=function(i,n){return this.distanceToSquared(i,n)<1e-5};var tc=function(i){this.content=[],this.scoreFunction=i};tc.prototype.push=function(i){this.content.push(i),this.sinkDown(this.content.length-1)},tc.prototype.pop=function(){var i=this.content[0],n=this.content.pop();return this.content.length>0&&(this.content[0]=n,this.bubbleUp(0)),i},tc.prototype.remove=function(i){var n=this.content.indexOf(i),r=this.content.pop();n!==this.content.length-1&&(this.content[n]=r,this.scoreFunction(r)<this.scoreFunction(i)?this.sinkDown(n):this.bubbleUp(n))},tc.prototype.size=function(){return this.content.length},tc.prototype.rescoreElement=function(i){this.sinkDown(this.content.indexOf(i))},tc.prototype.sinkDown=function(i){for(var n=this.content[i];i>0;){var r=(i+1>>1)-1,a=this.content[r];if(!(this.scoreFunction(n)<this.scoreFunction(a)))break;this.content[r]=n,this.content[i]=a,i=r}},tc.prototype.bubbleUp=function(i){for(var n=this.content.length,r=this.content[i],a=this.scoreFunction(r);;){var s=i+1<<1,o=s-1,u=null,f=void 0;if(o<n&&(f=this.scoreFunction(this.content[o]))<a&&(u=o),s<n&&this.scoreFunction(this.content[s])<(u===null?a:f)&&(u=s),u===null)break;this.content[i]=this.content[u],this.content[u]=r,i=u}};var Jc=function(){};Jc.init=function(i){for(var n=0;n<i.length;n++){var r=i[n];r.f=0,r.g=0,r.h=0,r.cost=1,r.visited=!1,r.closed=!1,r.parent=null}},Jc.cleanUp=function(i){for(var n=0;n<i.length;n++){var r=i[n];delete r.f,delete r.g,delete r.h,delete r.cost,delete r.visited,delete r.closed,delete r.parent}},Jc.heap=function(){return new tc(function(i){return i.f})},Jc.search=function(i,n,r){this.init(i);var a=this.heap();for(a.push(n);a.size()>0;){var s=a.pop();if(s===r){for(var o=s,u=[];o.parent;)u.push(o),o=o.parent;return this.cleanUp(u),u.reverse()}s.closed=!0;for(var f=this.neighbours(i,s),v=0,m=f.length;v<m;v++){var g=f[v];if(!g.closed){var y=s.g+g.cost,b=g.visited;if(!b||y<g.g){if(g.visited=!0,g.parent=s,!g.centroid||!r.centroid)throw new Error("Unexpected state");g.h=g.h||this.heuristic(g.centroid,r.centroid),g.g=y,g.f=g.g+g.h,b?a.rescoreElement(g):a.push(g)}}}}return[]},Jc.heuristic=function(i,n){return Gr.distanceToSquared(i,n)},Jc.neighbours=function(i,n){for(var r=[],a=0;a<n.neighbours.length;a++)r.push(i[n.neighbours[a]]);return r};var rZ=1,eu=function(){};eu.buildZone=function(i){var n=this,r=this._buildNavigationMesh(i),a={};r.vertices.forEach(function(u){u.x=Gr.roundNumber(u.x,2),u.y=Gr.roundNumber(u.y,2),u.z=Gr.roundNumber(u.z,2)}),a.vertices=r.vertices;var s=this._buildPolygonGroups(r);a.groups=[];var o=function(u,f){for(var v=0;v<u.length;v++)if(f===u[v])return v};return s.forEach(function(u){var f=[];u.forEach(function(v){var m=v.neighbours.map(function(y){return o(u,y)}),g=v.neighbours.map(function(y){return n._getSharedVerticesInOrder(v,y)});v.centroid.x=Gr.roundNumber(v.centroid.x,2),v.centroid.y=Gr.roundNumber(v.centroid.y,2),v.centroid.z=Gr.roundNumber(v.centroid.z,2),f.push({id:o(u,v),neighbours:m,vertexIds:v.vertexIds,centroid:v.centroid,portals:g})}),a.groups.push(f)}),a},eu._buildNavigationMesh=function(i){return Gr.computeCentroids(i),i.mergeVertices(),this._buildPolygonsFromGeometry(i)},eu._buildPolygonGroups=function(i){var n=[],r=0,a=function(s){s.neighbours.forEach(function(o){o.group===void 0&&(o.group=s.group,a(o))})};return i.polygons.forEach(function(s){s.group===void 0&&(s.group=r++,a(s)),n[s.group]||(n[s.group]=[]),n[s.group].push(s)}),n},eu._buildPolygonNeighbours=function(i,n,r){var a=new Set,s=r.get(i.vertexIds[0]),o=r.get(i.vertexIds[1]),u=r.get(i.vertexIds[2]);s.forEach(function(f){(o.has(f)||u.has(f))&&a.add(n.polygons[f])}),o.forEach(function(f){u.has(f)&&a.add(n.polygons[f])}),i.neighbours=Array.from(a)},eu._buildPolygonsFromGeometry=function(i){for(var n=this,r=[],a=i.vertices,s=i.faceVertexUvs,o=new Map,u=0;u<a.length;u++)o.set(u,new Set);i.faces.forEach(function(v){r.push({id:rZ++,vertexIds:[v.a,v.b,v.c],centroid:v.centroid,normal:v.normal,neighbours:[]}),o.get(v.a).add(r.length-1),o.get(v.b).add(r.length-1),o.get(v.c).add(r.length-1)});var f={polygons:r,vertices:a,faceVertexUvs:s};return r.forEach(function(v){n._buildPolygonNeighbours(v,f,o)}),f},eu._getSharedVerticesInOrder=function(i,n){var r=i.vertexIds,a=n.vertexIds,s=new Set;if(r.forEach(function(u){a.includes(u)&&s.add(u)}),s.size<2)return[];s.has(r[0])&&s.has(r[r.length-1])&&r.push(r.shift()),s.has(a[0])&&s.has(a[a.length-1])&&a.push(a.shift());var o=[];return r.forEach(function(u){a.includes(u)&&o.push(u)}),o};var Dw=function(){this.portals=[]};Dw.prototype.push=function(i,n){n===void 0&&(n=i),this.portals.push({left:i,right:n})},Dw.prototype.stringPull=function(){var i,n,r,a=this.portals,s=[],o=0,u=0,f=0;n=a[0].left,r=a[0].right,s.push(i=a[0].left);for(var v=1;v<a.length;v++){var m=a[v].left,g=a[v].right;if(Gr.triarea2(i,r,g)<=0){if(!(Gr.vequal(i,r)||Gr.triarea2(i,n,g)>0)){s.push(n),n=i=n,r=i,u=o=u,f=o,v=o;continue}r=g,f=v}if(Gr.triarea2(i,n,m)>=0){if(!(Gr.vequal(i,n)||Gr.triarea2(i,r,m)<0)){s.push(r),n=i=r,r=i,u=o=f,f=o,v=o;continue}n=m,u=v}}return s.length!==0&&Gr.vequal(s[s.length-1],a[a.length-1].left)||s.push(a[a.length-1].left),this.path=s,s};var Ow,Iw,tu,kw,Fw,v0,nc=function(){this.zones={}};nc.createZone=function(i){return eu.buildZone(i)},nc.prototype.setZoneData=function(i,n){this.zones[i]=n},nc.prototype.getGroup=function(i,n){if(!this.zones[i])return null;var r=null,a=Math.pow(50,2);return this.zones[i].groups.forEach(function(s,o){s.forEach(function(u){var f=Gr.distanceToSquared(u.centroid,n);f<a&&(r=o,a=f)})}),r},nc.prototype.getRandomNode=function(i,n,r,a){if(!this.zones[i])return new THREE.Vector3;r=r||null,a=a||0;var s=[];return this.zones[i].groups[n].forEach(function(o){r&&a?Gr.distanceToSquared(r,o.centroid)<a*a&&s.push(o.centroid):s.push(o.centroid)}),Gr.sample(s)||new THREE.Vector3},nc.prototype.getClosestNode=function(i,n,r,a){a===void 0&&(a=!1);var s=this.zones[n].vertices,o=null,u=1/0;return this.zones[n].groups[r].forEach(function(f){var v=Gr.distanceToSquared(f.centroid,i);v<u&&(!a||Gr.isVectorInPolygon(i,f,s))&&(o=f,u=v)}),o},nc.prototype.findPath=function(i,n,r,a){var s=this.zones[r].groups[a],o=this.zones[r].vertices,u=this.getClosestNode(i,r,a),f=this.getClosestNode(n,r,a,!0);if(!u||!f)return null;var v=Jc.search(s,u,f),m=function(M,S){for(var E=0;E<M.neighbours.length;E++)if(M.neighbours[E]===S.id)return M.portals[E]},g=new Dw;g.push(i);for(var y=0;y<v.length;y++){var b=v[y+1];if(b){var w=m(v[y],b);g.push(o[w[0]],o[w[1]])}}g.push(n),g.stringPull();var A=g.path.map(function(M){return new THREE.Vector3(M.x,M.y,M.z)});return A.shift(),A},nc.prototype.clampStep=(tu=new THREE.Vector3,kw=new THREE.Plane,Fw=new THREE.Triangle,v0=new THREE.Vector3,function(i,n,r,a,s,o){var u=this.zones[a].vertices,f=this.zones[a].groups[s],v=[r],m={};m[r.id]=0,Ow=void 0,v0.set(0,0,0),Iw=1/0,kw.setFromCoplanarPoints(u[r.vertexIds[0]],u[r.vertexIds[1]],u[r.vertexIds[2]]),kw.projectPoint(n,tu),n.copy(tu);for(var g=v.pop();g;g=v.pop()){Fw.set(u[g.vertexIds[0]],u[g.vertexIds[1]],u[g.vertexIds[2]]),Fw.closestPointToPoint(n,tu),tu.distanceToSquared(n)<Iw&&(Ow=g,v0.copy(tu),Iw=tu.distanceToSquared(n));var y=m[g];if(!(y>2))for(var b=0;b<g.neighbours.length;b++){var w=f[g.neighbours[b]];w.id in m||(v.push(w),m[w.id]=y+1)}}return o.copy(v0),Ow});var iZ=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",Pathfinding:nc}),aZ=IC(iZ);const{Pathfinding:RR}=aZ,Ap=new RR,Ep="level";AFRAME.registerSystem("nav",{init:function(){this.navMesh=null,this.agents=new Set},setNavMeshGeometry:function(i){this.navMesh=new THREE.Mesh(i),Ap.setZoneData(Ep,RR.createZone(i)),Array.from(this.agents).forEach(n=>n.updateNavLocation())},getNavMesh:function(){return this.navMesh},addAgent:function(i){this.agents.add(i)},removeAgent:function(i){this.agents.delete(i)},getPath:function(i,n,r){return this.navMesh?Ap.findPath(i,n,Ep,r):null},getGroup:function(i){return this.navMesh?Ap.getGroup(Ep,i):null},getNode:function(i,n){return this.navMesh?Ap.getClosestNode(i,Ep,n,!0):null},clampStep:function(i,n,r,a,s){if(this.navMesh){if(!a)return s.copy(n),this.getNode(n,r)}else return s.copy(n),null;return Ap.clampStep(i,n,a,Ep,r,s)}});AFRAME.registerPrimitive("a-grid",{defaultComponents:{geometry:{primitive:"plane",width:75,height:75},rotation:{x:-90,y:0,z:0},material:{src:"url(https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v1.16.3/assets/grid.png)",repeat:"75 75"}},mappings:{width:"geometry.width",height:"geometry.height",src:"material.src"}});var LR={exports:{}},Ht=LR.exports={VERSION:"0.1.1",PI:Math.PI,TAU:2*Math.PI,DEG_TO_RAD:.0174532925,RAD_TO_DEG:57.2957795,SQRT3:Math.sqrt(3),TILE:"tile",ENT:"entity",STR:"structure",HEX:"hex",SQR:"square",ABS:"abstract"};Ht.Board=function(i,n){if(!i)throw new Error("You must pass in a grid system for the board to use.");this.tiles=[],this.tileGroup=null,this.group=new THREE.Object3D,this.grid=null,this.overlay=null,this.finder=new Ht.AStarFinder(n),Ht.Loader.init(),this.setGrid(i)},Ht.Board.prototype={setEntityOnTile:function(i,n){var r=this.grid.cellToPixel(n.cell);i.position.copy(r),i.position.y+=i.heightOffset||0,i.tile&&(i.tile.entity=null),i.tile=n,n.entity=i},addTile:function(i){var n=this.tiles.indexOf(i);n===-1&&(this.tiles.push(i),this.snapTileToGrid(i),i.position.y=0,this.tileGroup.add(i.mesh),this.grid.add(i.cell),i.cell.tile=i)},removeTile:function(i){if(i){var n=this.tiles.indexOf(i);this.grid.remove(i.cell),n!==-1&&this.tiles.splice(n,1),i.dispose()}},removeAllTiles:function(){if(this.tileGroup)for(var i=this.tileGroup.children,n=0;n<i.length;n++)this.tileGroup.remove(i[n])},getTileAtCell:function(i){var n=this.grid.cellToHash(i);return i.tile||(typeof this.grid.cells[n]!="undefined"?this.grid.cells[n].tile:null)},snapToGrid:function(i){var n=this.grid.pixelToCell(i);i.copy(this.grid.cellToPixel(n))},snapTileToGrid:function(i){if(i.cell)i.position.copy(this.grid.cellToPixel(i.cell));else{var n=this.grid.pixelToCell(i.position);i.position.copy(this.grid.cellToPixel(n))}return i},getRandomTile:function(){var i=Ht.Tools.randomInt(0,this.tiles.length-1);return this.tiles[i]},findPath:function(i,n,r){return this.finder.findPath(i.cell,n.cell,r,this.grid)},setGrid:function(i){this.group.remove(this.tileGroup),this.grid&&i!==this.grid&&(this.removeAllTiles(),this.tiles.forEach(function(n){this.grid.remove(n.cell),n.dispose()}),this.grid.dispose()),this.grid=i,this.tiles=[],this.tileGroup=new THREE.Object3D,this.group.add(this.tileGroup)},generateOverlay:function(i){var n=new THREE.LineBasicMaterial({color:0,opacity:.3});this.overlay&&this.group.remove(this.overlay),this.overlay=new THREE.Object3D,this.grid.generateOverlay(i,this.overlay,n),this.group.add(this.overlay)},generateTilemap:function(i){this.reset();var n=this.grid.generateTiles(i);this.tiles=n,this.tileGroup=new THREE.Object3D;for(var r=0;r<n.length;r++)this.tileGroup.add(n[r].mesh);this.group.add(this.tileGroup)},reset:function(){this.removeAllTiles(),this.tileGroup&&this.group.remove(this.tileGroup)}},Ht.Board.prototype.constructor=Ht.Board,Ht.Cell=function(i,n,r,a){this.q=i||0,this.r=n||0,this.s=r||0,this.h=a||1,this.tile=null,this.userData={},this.walkable=!0,this._calcCost=0,this._priority=0,this._visited=!1,this._parent=null,this.uniqueID=Ht.LinkedList.generateID()},Ht.Cell.prototype={set:function(i,n,r){return this.q=i,this.r=n,this.s=r,this},copy:function(i){return this.q=i.q,this.r=i.r,this.s=i.s,this.h=i.h,this.tile=i.tile||null,this.userData=i.userData||{},this.walkable=i.walkable,this},add:function(i){return this.q+=i.q,this.r+=i.r,this.s+=i.s,this},equals:function(i){return this.q===i.q&&this.r===i.r&&this.s===i.s}},Ht.Cell.prototype.constructor=Ht.Cell,Ht.HexGrid=function(i){i=i||{},this.type=Ht.HEX,this.size=5,this.cellSize=typeof i.cellSize=="undefined"?10:i.cellSize,this.cells={},this.numCells=0,this.extrudeSettings=null,this.autogenerated=!1;var n,r=[];for(n=0;6>n;n++)r.push(this._createVertex(n));for(this.cellShape=new THREE.Shape,this.cellShape.moveTo(r[0].x,r[0].y),n=1;6>n;n++)this.cellShape.lineTo(r[n].x,r[n].y);this.cellShape.lineTo(r[0].x,r[0].y),this.cellShape.autoClose=!0,this.cellGeo=new THREE.Geometry,this.cellGeo.vertices=r,this.cellGeo.verticesNeedUpdate=!0,this.cellShapeGeo=new THREE.ShapeGeometry(this.cellShape),this._cellWidth=2*this.cellSize,this._cellLength=.5*Ht.SQRT3*this._cellWidth,this._hashDelimeter=".",this._directions=[new Ht.Cell(1,-1,0),new Ht.Cell(1,0,-1),new Ht.Cell(0,1,-1),new Ht.Cell(-1,1,0),new Ht.Cell(-1,0,1),new Ht.Cell(0,-1,1)],this._diagonals=[new Ht.Cell(2,-1,-1),new Ht.Cell(1,1,-2),new Ht.Cell(-1,2,-1),new Ht.Cell(-2,1,1),new Ht.Cell(-1,-1,2),new Ht.Cell(1,-2,1)],this._list=[],this._vec3=new THREE.Vector3,this._cel=new Ht.Cell,this._conversionVec=new THREE.Vector3,this._geoCache=[],this._matCache=[]},Ht.HexGrid.TWO_THIRDS=2/3,Ht.HexGrid.prototype={cellToPixel:function(i){return this._vec3.x=i.q*this._cellWidth*.75,this._vec3.y=i.h,this._vec3.z=-((i.s-i.r)*this._cellLength*.5),this._vec3},pixelToCell:function(i){var n=i.x*(Ht.HexGrid.TWO_THIRDS/this.cellSize),r=(-i.x/3+Ht.SQRT3/3*i.z)/this.cellSize;return this._cel.set(n,r,-n-r),this._cubeRound(this._cel)},getCellAt:function(i){var n=i.x*(Ht.HexGrid.TWO_THIRDS/this.cellSize),r=(-i.x/3+Ht.SQRT3/3*i.z)/this.cellSize;return this._cel.set(n,r,-n-r),this._cubeRound(this._cel),this.cells[this.cellToHash(this._cel)]},getNeighbors:function(i,n,r){var a,s,o=this._directions.length;for(this._list.length=0,a=0;o>a;a++)this._cel.copy(i),this._cel.add(this._directions[a]),s=this.cells[this.cellToHash(this._cel)],!s||r&&!r(i,s)||this._list.push(s);if(n)for(a=0;o>a;a++)this._cel.copy(i),this._cel.add(this._diagonals[a]),s=this.cells[this.cellToHash(this._cel)],!s||r&&!r(i,s)||this._list.push(s);return this._list},getRandomCell:function(){var i,n=0,r=Ht.Tools.randomInt(0,this.numCells);for(i in this.cells){if(n===r)return this.cells[i];n++}return this.cells[i]},cellToHash:function(i){return i.q+this._hashDelimeter+i.r+this._hashDelimeter+i.s},distance:function(i,n){var r=Math.max(Math.abs(i.q-n.q),Math.abs(i.r-n.r),Math.abs(i.s-n.s));return r+=n.h-i.h},clearPath:function(){var i,n;for(i in this.cells)n=this.cells[i],n._calcCost=0,n._priority=0,n._parent=null,n._visited=!1},traverse:function(i){var n;for(n in this.cells)i(this.cells[n])},generateTile:function(i,n,r){var a=Math.abs(i.h);1>a&&(a=1);var s=this._geoCache[a];s||(this.extrudeSettings.amount=a,s=new THREE.ExtrudeGeometry(this.cellShape,this.extrudeSettings),this._geoCache[a]=s);var o=new Ht.Tile({size:this.cellSize,scale:n,cell:i,geometry:s,material:r});return i.tile=o,o},generateTiles:function(i){i=i||{};var n=[],r={tileScale:.95,cellSize:this.cellSize,material:null,extrudeSettings:{amount:1,bevelEnabled:!0,bevelSegments:1,steps:1,bevelSize:.5,bevelThickness:.5}};r=Ht.Tools.merge(r,i),this.cellSize=r.cellSize,this._cellWidth=2*this.cellSize,this._cellLength=.5*Ht.SQRT3*this._cellWidth,this.autogenerated=!0,this.extrudeSettings=r.extrudeSettings;var a,s,o;for(a in this.cells)o=this.cells[a],s=this.generateTile(o,r.tileScale,r.material),s.position.copy(this.cellToPixel(o)),s.position.y=0,n.push(s);return n},generateTilePoly:function(i){i||(i=new THREE.MeshBasicMaterial({color:2405631}));var n=new THREE.Mesh(this.cellShapeGeo,i);return this._vec3.set(1,0,0),n.rotateOnAxis(this._vec3,Ht.PI/2),n},generate:function(i){i=i||{},this.size=typeof i.size=="undefined"?this.size:i.size;var n,r,a,s;for(n=-this.size;n<this.size+1;n++)for(r=-this.size;r<this.size+1;r++)a=-n-r,Math.abs(n)<=this.size&&Math.abs(r)<=this.size&&Math.abs(a)<=this.size&&(s=new Ht.Cell(n,r,a),this.add(s))},generateOverlay:function(i,n,r){var a,s,o,u=this.cellShape.createPointsGeometry();for(a=-i;i+1>a;a++)for(s=-i;i+1>s;s++)if(o=-a-s,Math.abs(a)<=i&&Math.abs(s)<=i&&Math.abs(o)<=i){this._cel.set(a,s,o);var f=new THREE.Line(u,r);f.position.copy(this.cellToPixel(this._cel)),f.rotation.x=90*Ht.DEG_TO_RAD,n.add(f)}},add:function(i){var n=this.cellToHash(i);if(!this.cells[n])return this.cells[n]=i,this.numCells++,i},remove:function(i){var n=this.cellToHash(i);this.cells[n]&&(delete this.cells[n],this.numCells--)},dispose:function(){this.cells=null,this.numCells=0,this.cellShape=null,this.cellGeo.dispose(),this.cellGeo=null,this.cellShapeGeo.dispose(),this.cellShapeGeo=null,this._list=null,this._vec3=null,this._conversionVec=null,this._geoCache=null,this._matCache=null},load:function(i,n,r){var a=this;Ht.Tools.getJSON({url:i,callback:function(s){a.fromJSON(s),n.call(r||null,s)},cache:!1,scope:a})},fromJSON:function(i){var n,r,a=i.cells;for(this.cells={},this.numCells=0,this.size=i.size,this.cellSize=i.cellSize,this._cellWidth=2*this.cellSize,this._cellLength=.5*Ht.SQRT3*this._cellWidth,this.extrudeSettings=i.extrudeSettings,this.autogenerated=i.autogenerated,n=0;n<a.length;n++)r=new Ht.Cell,r.copy(a[n]),this.add(r)},toJSON:function(){var i,n,r={size:this.size,cellSize:this.cellSize,extrudeSettings:this.extrudeSettings,autogenerated:this.autogenerated},a=[];for(n in this.cells)i=this.cells[n],a.push({q:i.q,r:i.r,s:i.s,h:i.h,walkable:i.walkable,userData:i.userData});return r.cells=a,r},_createVertex:function(i){var n=Ht.TAU/6*i;return new THREE.Vector3(this.cellSize*Math.cos(n),this.cellSize*Math.sin(n),0)},_cubeRound:function(i){var n=Math.round(i.q),r=Math.round(i.r),a=Math.round(i.s),s=Math.abs(n-i.q),o=Math.abs(r-i.r),u=Math.abs(a-i.s);return s>o&&s>u?n=-r-a:o>u?r=-n-a:a=-n-r,this._cel.set(n,r,a)}},Ht.HexGrid.prototype.constructor=Ht.HexGrid,Ht.SqrGrid=function(i){i=i||{},this.type=Ht.SQR,this.size=5,this.cellSize=typeof i.cellSize=="undefined"?10:i.cellSize,this.cells={},this.numCells=0,this.extrudeSettings=null,this.autogenerated=!1;var n=[];n.push(new THREE.Vector3),n.push(new THREE.Vector3(-this.cellSize,this.cellSize)),n.push(new THREE.Vector3(this.cellSize,this.cellSize)),n.push(new THREE.Vector3(this.cellSize,-this.cellSize)),this.cellShape=new THREE.Shape,this.cellShape.moveTo(-this.cellSize,-this.cellSize),this.cellShape.lineTo(-this.cellSize,this.cellSize),this.cellShape.lineTo(this.cellSize,this.cellSize),this.cellShape.lineTo(this.cellSize,-this.cellSize),this.cellShape.lineTo(-this.cellSize,-this.cellSize),this.cellGeo=new THREE.Geometry,this.cellGeo.vertices=n,this.cellGeo.verticesNeedUpdate=!0,this.cellShapeGeo=new THREE.ShapeGeometry(this.cellShape),this._fullCellSize=2*this.cellSize,this._hashDelimeter=".",this._directions=[new Ht.Cell(1,0,0),new Ht.Cell(0,-1,0),new Ht.Cell(-1,0,0),new Ht.Cell(0,1,0)],this._diagonals=[new Ht.Cell(-1,-1,0),new Ht.Cell(-1,1,0),new Ht.Cell(1,1,0),new Ht.Cell(1,-1,0)],this._list=[],this._vec3=new THREE.Vector3,this._cel=new Ht.Cell,this._conversionVec=new THREE.Vector3,this._geoCache=[],this._matCache=[]},Ht.SqrGrid.prototype={cellToPixel:function(i){return this._vec3.x=i.q*this._fullCellSize,this._vec3.y=i.h,this._vec3.z=i.r*this._fullCellSize,this._vec3},pixelToCell:function(i){var n=Math.round(i.x/this._fullCellSize),r=Math.round(i.z/this._fullCellSize);return this._cel.set(n,r,0)},getCellAt:function(i){var n=Math.round(i.x/this._fullCellSize),r=Math.round(i.z/this._fullCellSize);return this._cel.set(n,r),this.cells[this.cellToHash(this._cel)]},getNeighbors:function(i,n,r){var a,s,o=this._directions.length;for(this._list.length=0,a=0;o>a;a++)this._cel.copy(i),this._cel.add(this._directions[a]),s=this.cells[this.cellToHash(this._cel)],!s||r&&!r(i,s)||this._list.push(s);if(n)for(a=0;o>a;a++)this._cel.copy(i),this._cel.add(this._diagonals[a]),s=this.cells[this.cellToHash(this._cel)],!s||r&&!r(i,s)||this._list.push(s);return this._list},getRandomCell:function(){var i,n=0,r=Ht.Tools.randomInt(0,this.numCells);for(i in this.cells){if(n===r)return this.cells[i];n++}return this.cells[i]},cellToHash:function(i){return i.q+this._hashDelimeter+i.r},distance:function(i,n){var r=Math.max(Math.abs(i.q-n.q),Math.abs(i.r-n.r));return r+=n.h-i.h},clearPath:function(){var i,n;for(i in this.cells)n=this.cells[i],n._calcCost=0,n._priority=0,n._parent=null,n._visited=!1},traverse:function(i){var n;for(n in this.cells)i(this.cells[n])},generateTile:function(i,n,r){var a=Math.abs(i.h);1>a&&(a=1);var s=this._geoCache[a];s||(this.extrudeSettings.amount=a,s=new THREE.ExtrudeGeometry(this.cellShape,this.extrudeSettings),this._geoCache[a]=s);var o=new Ht.Tile({size:this.cellSize,scale:n,cell:i,geometry:s,material:r});return i.tile=o,o},generateTiles:function(i){i=i||{};var n=[],r={tileScale:.95,cellSize:this.cellSize,material:null,extrudeSettings:{amount:1,bevelEnabled:!0,bevelSegments:1,steps:1,bevelSize:.5,bevelThickness:.5}};r=Ht.Tools.merge(r,i),this.cellSize=r.cellSize,this._fullCellSize=2*this.cellSize,this.autogenerated=!0,this.extrudeSettings=r.extrudeSettings;var a,s,o;for(a in this.cells)o=this.cells[a],s=this.generateTile(o,r.tileScale,r.material),s.position.copy(this.cellToPixel(o)),s.position.y=0,n.push(s);return n},generateTilePoly:function(i){i||(i=new THREE.MeshBasicMaterial({color:2405631}));var n=new THREE.Mesh(this.cellShapeGeo,i);return this._vec3.set(1,0,0),n.rotateOnAxis(this._vec3,Ht.PI/2),n},generate:function(i){i=i||{},this.size=typeof i.size=="undefined"?this.size:i.size;var n,r,a,s=Math.ceil(this.size/2);for(n=-s;s>n;n++)for(r=-s;s>r;r++)a=new Ht.Cell(n,r+1),this.add(a)},generateOverlay:function(i,n,r){var a,s,o=Math.ceil(i/2);for(a=-o;o>a;a++)for(s=-o;o>s;s++){this._cel.set(a,s);var u=new THREE.Line(this.cellGeo,r);u.position.copy(this.cellToPixel(this._cel)),u.rotation.x=90*Ht.DEG_TO_RAD,n.add(u)}},add:function(i){var n=this.cellToHash(i);if(!this.cells[n])return this.cells[n]=i,this.numCells++,i},remove:function(i){var n=this.cellToHash(i);this.cells[n]&&(delete this.cells[n],this.numCells--)},dispose:function(){this.cells=null,this.numCells=0,this.cellShape=null,this.cellGeo.dispose(),this.cellGeo=null,this.cellShapeGeo.dispose(),this.cellShapeGeo=null,this._list=null,this._vec3=null,this._conversionVec=null,this._geoCache=null,this._matCache=null},load:function(i,n,r){Ht.Tools.getJSON({url:i,callback:function(a){this.fromJSON(a),n.call(r||null,a)},cache:!1,scope:this})},fromJSON:function(i){var n,r,a=i.cells;for(this.cells={},this.numCells=0,this.size=i.size,this.cellSize=i.cellSize,this._fullCellSize=2*this.cellSize,this.extrudeSettings=i.extrudeSettings,this.autogenerated=i.autogenerated,n=0;n<a.length;n++)r=new Ht.Cell,r.copy(a[n]),this.add(r)},toJSON:function(){var i,n,r={size:this.size,cellSize:this.cellSize,extrudeSettings:this.extrudeSettings,autogenerated:this.autogenerated},a=[];for(n in this.cells)i=this.cells[n],a.push({q:i.q,r:i.r,s:i.s,h:i.h,walkable:i.walkable,userData:i.userData});return r.cells=a,r}},Ht.SqrGrid.prototype.constructor=Ht.SqrGrid,Ht.Tile=function(i){i=i||{};var n={cell:null,geometry:null,material:null};if(n=Ht.Tools.merge(n,i),!n.cell||!n.geometry)throw new Error("Missing vg.Tile configuration");this.cell=n.cell,this.cell.tile&&this.cell.tile!==this&&this.cell.tile.dispose(),this.cell.tile=this,this.uniqueID=Ht.Tools.generateID(),this.geometry=n.geometry,this.material=n.material,this.material||(this.material=new THREE.MeshPhongMaterial({color:Ht.Tools.randomizeRGB("30, 30, 30",13)})),this.objectType=Ht.TILE,this.entity=null,this.userData={},this.selected=!1,this.highlight="0x0084cc",this.mesh=new THREE.Mesh(this.geometry,this.material),this.mesh.userData.structure=this,this.position=this.mesh.position,this.rotation=this.mesh.rotation,this.rotation.x=-90*Ht.DEG_TO_RAD,this.mesh.scale.set(n.scale,n.scale,1),this.material.emissive?this._emissive=this.material.emissive.getHex():this._emissive=null},Ht.Tile.prototype={select:function(){return this.material.emissive&&this.material.emissive.setHex(this.highlight),this.selected=!0,this},deselect:function(){return this._emissive!==null&&this.material.emissive&&this.material.emissive.setHex(this._emissive),this.selected=!1,this},toggle:function(){return this.selected?this.deselect():this.select(),this},dispose:function(){this.cell&&this.cell.tile&&(this.cell.tile=null),this.cell=null,this.position=null,this.rotation=null,this.mesh.parent&&this.mesh.parent.remove(this.mesh),this.mesh.userData.structure=null,this.mesh=null,this.material=null,this.userData=null,this.entity=null,this.geometry=null,this._emissive=null}},Ht.Tile.prototype.constructor=Ht.Tile,function(){var i=function(){this.obj=null,this.next=null,this.prev=null,this.free=!0},n=function(){this.first=null,this.last=null,this.length=0,this.objToNodeMap={},this.uniqueID=Date.now()+""+Math.floor(1e3*Math.random()),this.sortArray=[]};n.generateID=function(){return Math.random().toString(36).slice(2)+Date.now()},n.prototype={getNode:function(r){return this.objToNodeMap[r.uniqueID]},addNode:function(r){var a=new i;if(!r.uniqueID)try{r.uniqueID=n.generateID()}catch{return console.error("[LinkedList.addNode] obj passed is immutable: cannot attach necessary identifier"),null}return a.obj=r,a.free=!1,this.objToNodeMap[r.uniqueID]=a,a},swapObjects:function(r,a){this.objToNodeMap[r.obj.uniqueID]=null,this.objToNodeMap[a.uniqueID]=r,r.obj=a},add:function(r){var a=this.objToNodeMap[r.uniqueID];if(a){if(a.free===!1)return;a.obj=r,a.free=!1,a.next=null,a.prev=null}else a=this.addNode(r);if(this.first){if(!this.last)throw new Error("[LinkedList.add] No last in the list -- that shouldn't happen here");this.last.next=a,a.prev=this.last,this.last=a,a.next=null}else this.first=a,this.last=a,a.next=null,a.prev=null;this.length++,this.showDebug&&this.dump("after add")},has:function(r){return!!this.objToNodeMap[r.uniqueID]},moveUp:function(r){this.dump("before move up");var a=this.getNode(r);if(!a)throw"Oops, trying to move an object that isn't in the list";if(a.prev){var s=a.prev,o=s.prev;a==this.last&&(this.last=s);var u=a.next;o&&(o.next=a),a.next=s,a.prev=s.prev,s.next=u,s.prev=a,this.first==s&&(this.first=a)}},moveDown:function(r){var a=this.getNode(r);if(!a)throw"Oops, trying to move an object that isn't in the list";if(a.next){var s=a.next;this.moveUp(s.obj),this.last==s&&(this.last=a)}},sort:function(r){var a,s,o=this.sortArray,u=this.first;for(o.length=0;u;)o.push(u.obj),u=u.next;for(this.clear(),o.sort(r),s=o.length,a=0;s>a;a++)this.add(o[a])},remove:function(r){var a=this.getNode(r);return!a||a.free?!1:(a.prev&&(a.prev.next=a.next),a.next&&(a.next.prev=a.prev),a.prev||(this.first=a.next),a.next||(this.last=a.prev),a.free=!0,a.prev=null,a.next=null,this.length--,!0)},shift:function(){var r=this.first;return this.length===0?null:(r.prev&&(r.prev.next=r.next),r.next&&(r.next.prev=r.prev),this.first=r.next,r.next||(this.last=null),r.free=!0,r.prev=null,r.next=null,this.length--,r.obj)},pop:function(){var r=this.last;return this.length===0?null:(r.prev&&(r.prev.next=r.next),r.next&&(r.next.prev=r.prev),this.last=r.prev,r.prev||(this.first=null),r.free=!0,r.prev=null,r.next=null,this.length--,r.obj)},concat:function(r){for(var a=r.first;a;)this.add(a.obj),a=a.next},clear:function(){for(var r=this.first;r;)r.free=!0,r=r.next;this.first=null,this.length=0},dispose:function(){for(var r=this.first;r;)r.obj=null,r=r.next;this.first=null,this.objToNodeMap=null},dump:function(r){console.log("===================="+r+"=====================");for(var a=this.first;a;)console.log("{"+a.obj.toString()+"} previous="+(a.prev?a.prev.obj:"NULL")),a=a.next();console.log("==================================="),console.log("Last: {"+(this.last?this.last.obj:"NULL")+"} First: {"+(this.first?this.first.obj:"NULL")+"}")}},n.prototype.constructor=n,Ht.LinkedList=n}(),function(){var i=function(r,a,s,o,u){this._listener=a,this.isOnce=s,this.context=o,this.signal=r,this._priority=u||0};i.prototype={active:!0,params:null,execute:function(r){var a,s;return this.active&&this._listener&&(s=this.params?this.params.concat(r):r,a=this._listener.apply(this.context,s),this.isOnce&&this.detach()),a},detach:function(){return this.isBound()?this.signal.remove(this._listener,this.context):null},isBound:function(){return!!this.signal&&!!this._listener},_destroy:function(){delete this.signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this.isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},i.prototype.constructor=i;var n=function(){this._bindings=[],this._prevParams=null;var r=this;this.dispatch=function(){n.prototype.dispatch.apply(r,arguments)}};n.prototype={memorize:!1,_shouldPropagate:!0,active:!0,validateListener:function(r,a){if(typeof r!="function")throw new Error("Signal: listener is a required param of {fn}() and should be a Function.".replace("{fn}",a))},_registerListener:function(r,a,s,o){var u,f=this._indexOfListener(r,s);if(f!==-1){if(u=this._bindings[f],u.isOnce!==a)throw new Error("You cannot add"+(a?"":"Once")+"() then add"+(a?"Once":"")+"() the same listener without removing the relationship first.")}else u=new i(this,r,a,s,o),this._addBinding(u);return this.memorize&&this._prevParams&&u.execute(this._prevParams),u},_addBinding:function(r){var a=this._bindings.length;do a--;while(this._bindings[a]&&r._priority<=this._bindings[a]._priority);this._bindings.splice(a+1,0,r)},_indexOfListener:function(r,a){for(var s,o=this._bindings.length;o--;)if(s=this._bindings[o],s._listener===r&&s.context===a)return o;return-1},has:function(r,a){return this._indexOfListener(r,a)!==-1},add:function(r,a,s){return this.validateListener(r,"add"),this._registerListener(r,!1,a,s)},addOnce:function(r,a,s){return this.validateListener(r,"addOnce"),this._registerListener(r,!0,a,s)},remove:function(r,a){this.validateListener(r,"remove");var s=this._indexOfListener(r,a);return s!==-1&&(this._bindings[s]._destroy(),this._bindings.splice(s,1)),r},removeAll:function(r){typeof r=="undefined"&&(r=null);for(var a=this._bindings.length;a--;)r?this._bindings[a].context===r&&(this._bindings[a]._destroy(),this._bindings.splice(a,1)):this._bindings[a]._destroy();r||(this._bindings.length=0)},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(){if(this.active){var r,a=Array.prototype.slice.call(arguments),s=this._bindings.length;if(this.memorize&&(this._prevParams=a),s){r=this._bindings.slice(),this._shouldPropagate=!0;do s--;while(r[s]&&this._shouldPropagate&&r[s].execute(a)!==!1)}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}},n.prototype.constructor=n,Ht.Signal=n}(),Ht.AStarFinder=function(i){i=i||{};var n={allowDiagonal:!1,heuristicFilter:null};n=Ht.Tools.merge(n,i),this.allowDiagonal=n.allowDiagonal,this.heuristicFilter=n.heuristicFilter,this.list=new Ht.LinkedList},Ht.AStarFinder.prototype={findPath:function(i,n,r,a){var s,o,u,f,v,m;for(r=r||this.heuristicFilter,a.clearPath(),this.list.clear(),this.list.add(i);this.list.length>0;){if(this.list.sort(this.compare),s=this.list.shift(),s._visited=!0,s===n)return Ht.PathUtil.backtrace(n);for(u=a.getNeighbors(s,this.allowDiagonal,r),v=0,m=u.length;m>v;v++)if(f=u[v],f.walkable&&(o=s._calcCost+a.distance(s,f),!f._visited||o<f._calcCost)){if(f._visited=!0,f._parent=s,f._calcCost=o,f._priority=o+a.distance(n,f),f===n)return Ht.PathUtil.backtrace(n);this.list.add(f)}}return null},compare:function(i,n){return i._priority-n._priority}},Ht.AStarFinder.prototype.constructor=Ht.AStarFinder,Ht.PathUtil={backtrace:function(i){for(var n=[i];i._parent;)i=i._parent,n.push(i);return n.reverse()},biBacktrace:function(i,n){var r=this.backtrace(i),a=this.backtrace(n);return r.concat(a.reverse())},pathLength:function(i){var n,r,a,s,o,u=0;for(n=1;n<i.length;++n)r=i[n-1],a=i[n],s=r[0]-a[0],o=r[1]-a[1],u+=Math.sqrt(s*s+o*o);return u},interpolate:function(i,n,r,a){var s,o,u,f,v,m,g=Math.abs,y=[];for(u=g(r-i),f=g(a-n),s=r>i?1:-1,o=a>n?1:-1,v=u-f;i!==r||n!==a;)y.push([i,n]),m=2*v,m>-f&&(v-=f,i+=s),u>m&&(v+=u,n+=o);return y},expandPath:function(i){var n,r,a,s,o,u,f=[],v=i.length;if(2>v)return f;for(o=0;v-1>o;++o)for(n=i[o],r=i[o+1],a=this.interpolate(n[0],n[1],r[0],r[1]),s=a.length,u=0;s-1>u;++u)f.push(a[u]);return f.push(i[v-1]),f},smoothenPath:function(i,n){var r,a,s,o,u,f,v,m,g,y,b,w,A=n.length,M=n[0][0],S=n[0][1],E=n[A-1][0],T=n[A-1][1];for(r=M,a=S,u=[[r,a]],v=2;A>v;++v){for(g=n[v],s=g[0],o=g[1],y=this.interpolate(r,a,s,o),w=!1,m=1;m<y.length;++m)if(b=y[m],!i.isWalkableAt(b[0],b[1])){w=!0;break}w&&(f=n[v-1],u.push(f),r=f[0],a=f[1])}return u.push([E,T]),u},compressPath:function(i){if(i.length<3)return i;var n,r,a,s,o,u,f=[],v=i[0][0],m=i[0][1],g=i[1][0],y=i[1][1],b=g-v,w=y-m;for(o=Math.sqrt(b*b+w*w),b/=o,w/=o,f.push([v,m]),u=2;u<i.length;u++)n=g,r=y,a=b,s=w,g=i[u][0],y=i[u][1],b=g-n,w=y-r,o=Math.sqrt(b*b+w*w),b/=o,w/=o,(b!==a||w!==s)&&f.push([n,r]);return f.push([g,y]),f}},Ht.Loader={manager:null,imageLoader:null,crossOrigin:!1,init:function(i){this.crossOrigin=i||!1,this.manager=new THREE.LoadingManager(function(){},function(){},function(){console.warn("Error loading images")}),this.imageLoader=new THREE.ImageLoader(this.manager),this.imageLoader.crossOrigin=i},loadTexture:function(i,n,r,a){var s=new THREE.Texture(null,n);return this.imageLoader.load(i,function(o){s.image=o,s.needsUpdate=!0,r&&r(s)},null,function(o){a&&a(o)}),s.sourceFile=i,s}},Ht.MouseCaster=function(i,n,r){this.down=!1,this.rightDown=!1,this.pickedObject=null,this.selectedObject=null,this.allHits=null,this.active=!0,this.shift=!1,this.ctrl=!1,this.wheel=0,this.position=new THREE.Vector3,this.screenPosition=new THREE.Vector2,this.signal=new Ht.Signal,this.group=i,this._camera=n,this._raycaster=new THREE.Raycaster,this._preventDefault=!1,r=r||document,r.addEventListener("mousemove",this._onDocumentMouseMove.bind(this),!1),r.addEventListener("mousedown",this._onDocumentMouseDown.bind(this),!1),r.addEventListener("mouseup",this._onDocumentMouseUp.bind(this),!1),r.addEventListener("mousewheel",this._onMouseWheel.bind(this),!1),r.addEventListener("DOMMouseScroll",this._onMouseWheel.bind(this),!1)},Ht.MouseCaster.OVER="over",Ht.MouseCaster.OUT="out",Ht.MouseCaster.DOWN="down",Ht.MouseCaster.UP="up",Ht.MouseCaster.CLICK="click",Ht.MouseCaster.WHEEL="wheel",Ht.MouseCaster.prototype={update:function(){if(this.active){this._raycaster.setFromCamera(this.screenPosition,this._camera);var i,n,r=this._raycaster.intersectObject(this.group,!0);r.length>0?(i=r[0],n=i.object.userData.structure,this.pickedObject!=n&&(this.pickedObject&&this.signal.dispatch(Ht.MouseCaster.OUT,this.pickedObject),this.pickedObject=n,this.selectedObject=null,this.signal.dispatch(Ht.MouseCaster.OVER,this.pickedObject)),this.position.copy(i.point),this.screenPosition.z=i.distance):(this.pickedObject&&this.signal.dispatch(Ht.MouseCaster.OUT,this.pickedObject),this.pickedObject=null,this.selectedObject=null),this.allHits=r}},preventDefault:function(){this._preventDefault=!0},_onDocumentMouseDown:function(i){return i=i||window.event,i.preventDefault(),this._preventDefault?(this._preventDefault=!1,!1):(this.pickedObject&&(this.selectedObject=this.pickedObject),this.shift=i.shiftKey,this.ctrl=i.ctrlKey,this.down=i.which===1,this.rightDown=i.which===3,void this.signal.dispatch(Ht.MouseCaster.DOWN,this.pickedObject))},_onDocumentMouseUp:function(i){return i.preventDefault(),this._preventDefault?(this._preventDefault=!1,!1):(this.shift=i.shiftKey,this.ctrl=i.ctrlKey,this.signal.dispatch(Ht.MouseCaster.UP,this.pickedObject),this.selectedObject&&this.pickedObject&&this.selectedObject.uniqueID===this.pickedObject.uniqueID&&this.signal.dispatch(Ht.MouseCaster.CLICK,this.pickedObject),this.down=i.which===1?!1:this.down,void(this.rightDown=i.which===3?!1:this.rightDown))},_onDocumentMouseMove:function(i){i.preventDefault(),this.screenPosition.x=i.clientX/window.innerWidth*2-1,this.screenPosition.y=2*-(i.clientY/window.innerHeight)+1},_onMouseWheel:function(i){if(this.active){i.preventDefault(),i.stopPropagation();var n=0;i.wheelDelta!==void 0?n=i.wheelDelta:i.detail!==void 0&&(n=-i.detail),n>0?this.wheel++:this.wheel--,this.signal.dispatch(Ht.MouseCaster.WHEEL,this.wheel)}}},Ht.MouseCaster.prototype.constructor=Ht.MouseCaster,Ht.Scene=function(i,n){var r={element:document.body,alpha:!0,antialias:!0,clearColor:"#fff",sortObjects:!1,fog:null,light:new THREE.DirectionalLight(16777215),lightPosition:null,cameraType:"PerspectiveCamera",cameraPosition:null,orthoZoom:4},a={minDistance:100,maxDistance:1e3,zoomSpeed:2,noZoom:!1};if(r=Ht.Tools.merge(r,i),typeof n!="boolean"&&(a=Ht.Tools.merge(a,n)),this.renderer=new THREE.WebGLRenderer({alpha:r.alpha,antialias:r.antialias}),this.renderer.setClearColor(r.clearColor,0),this.renderer.sortObjects=r.sortObjects,this.width=window.innerWidth,this.height=window.innerHeight,this.orthoZoom=r.orthoZoom,this.container=new THREE.Scene,this.container.fog=r.fog,this.container.add(new THREE.AmbientLight(14540253)),r.lightPosition||r.light.position.set(-1,1,-1).normalize(),this.container.add(r.light),r.cameraType==="OrthographicCamera"){var s=window.innerWidth/this.orthoZoom,o=window.innerHeight/this.orthoZoom;this.camera=new THREE.OrthographicCamera(s/-2,s/2,o/2,o/-2,1,5e3)}else this.camera=new THREE.PerspectiveCamera(50,this.width/this.height,1,5e3);this.contolled=!!n,this.contolled&&(this.controls=new THREE.OrbitControls(this.camera,this.renderer.domElement),this.controls.minDistance=a.minDistance,this.controls.maxDistance=a.maxDistance,this.controls.zoomSpeed=a.zoomSpeed,this.controls.noZoom=a.noZoom),r.cameraPosition&&this.camera.position.copy(r.cameraPosition),window.addEventListener("resize",function(){if(this.width=window.innerWidth,this.height=window.innerHeight,this.camera.type==="OrthographicCamera"){var u=this.width/this.orthoZoom,f=this.height/this.orthoZoom;this.camera.left=u/-2,this.camera.right=u/2,this.camera.top=f/2,this.camera.bottom=f/-2}else this.camera.aspect=this.width/this.height;this.camera.updateProjectionMatrix(),this.renderer.setSize(this.width,this.height)}.bind(this),!1),this.attachTo(r.element)},Ht.Scene.prototype={attachTo:function(i){i.style.width=this.width+"px",i.style.height=this.height+"px",this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.width,this.height),i.appendChild(this.renderer.domElement)},add:function(i){this.container.add(i)},remove:function(i){this.container.remove(i)},render:function(){this.contolled&&this.controls.update(),this.renderer.render(this.container,this.camera)},updateOrthoZoom:function(){if(this.orthoZoom<=0)return void(this.orthoZoom=0);var i=this.width/this.orthoZoom,n=this.height/this.orthoZoom;this.camera.left=i/-2,this.camera.right=i/2,this.camera.top=n/2,this.camera.bottom=n/-2,this.camera.updateProjectionMatrix()},focusOn:function(i){this.camera.lookAt(i.position)}},Ht.Scene.prototype.constructor=Ht.Scene,Ht.SelectionManager=function(i){this.mouse=i,this.onSelect=new Ht.Signal,this.onDeselect=new Ht.Signal,this.selected=null,this.toggleSelection=!1,this.mouse.signal.add(this.onMouse,this)},Ht.SelectionManager.prototype={select:function(i,n){i&&(n=n||!0,this.selected!==i&&this.clearSelection(n),i.selected?this.toggleSelection&&(n&&this.onDeselect.dispatch(i),i.deselect()):i.select(),this.selected=i,n&&this.onSelect.dispatch(i))},clearSelection:function(i){i=i||!0,this.selected&&(i&&this.onDeselect.dispatch(this.selected),this.selected.deselect()),this.selected=null},onMouse:function(i,n){switch(i){case Ht.MouseCaster.DOWN:n||this.clearSelection();break;case Ht.MouseCaster.CLICK:this.select(n)}}},Ht.SelectionManager.prototype.constructor=Ht.SelectionManager,Ht.Tools={clamp:function(i,n,r){return Math.max(n,Math.min(r,i))},sign:function(i){return i&&i/Math.abs(i)},random:function(i,n){return arguments.length===1?Math.random()*i-.5*i:Math.random()*(n-i)+i},randomInt:function(i,n){return arguments.length===1?Math.random()*i-.5*i|0:Math.random()*(n-i+1)+i|0},normalize:function(i,n,r){return(i-n)/(r-n)},getShortRotation:function(i){return i%=this.TAU,i>this.PI?i-=this.TAU:i<-this.PI&&(i+=this.TAU),i},generateID:function(){return Math.random().toString(36).slice(2)+Date.now()},isPlainObject:function(i){if(typeof i!="object"||i.nodeType||i===i.window)return!1;try{if(i.constructor&&!Object.prototype.hasOwnProperty.call(i.constructor.prototype,"isPrototypeOf"))return!1}catch{return!1}return!0},merge:function(i,n){var r=this,a=Array.isArray(n),s=a&&[]||{};return a?(i=i||[],s=s.concat(i),n.forEach(function(o,u){typeof s[u]=="undefined"?s[u]=o:r.isPlainObject(o)?s[u]=r.merge(i[u],o):i.indexOf(o)===-1&&s.push(o)}),s):(i&&r.isPlainObject(i)&&Object.keys(i).forEach(function(o){s[o]=i[o]}),Object.keys(n).forEach(function(o){n[o]&&r.isPlainObject(n[o])&&i[o]?s[o]=r.merge(i[o],n[o]):s[o]=n[o]}),s)},now:function(){return window.nwf?window.nwf.system.Performance.elapsedTime:window.performance.now()},empty:function(i){for(;i.lastChild;)i.removeChild(i.lastChild)},radixSort:function(i,n,r,a){if(n=n||0,r=r||i.length,a=a||31,!(n>=r-1||0>a)){for(var s=n,o=r,u=1<<a;o>s;)if(i[s]&u){--o;var f=i[s];i[s]=i[o],i[o]=f}else++s;this.radixSort(i,n,o,a-1),this.radixSort(i,o,r,a-1)}},randomizeRGB:function(i,n){var r,a,s=i.split(","),o="rgb(";for(n=this.randomInt(n),r=0;3>r;r++)a=parseInt(s[r])+n,0>a?a=0:a>255&&(a=255),o+=a+",";return o=o.substring(0,o.length-1),o+=")"},getJSON:function(i){var n=new XMLHttpRequest,r=typeof i.cache=="undefined"?!1:i.cache,a=r?i.url:i.url+"?t="+Math.floor(1e4*Math.random())+Date.now();n.onreadystatechange=function(){if(this.status===200){var s=null;try{s=JSON.parse(this.responseText)}catch{return}return void i.callback.call(i.scope||null,s)}this.status!==0&&console.warn("[Tools.getJSON] Error: "+this.status+" ("+this.statusText+") :: "+i.url)},n.open("GET",a,!0),n.setRequestHeader("Accept","application/json"),n.setRequestHeader("Content-Type","application/json"),n.send("")}};var oZ={size:5,cellSize:10,extrudeSettings:{amount:1,bevelEnabled:!0,bevelSegments:1,steps:1,bevelSize:.5,bevelThickness:.5},autogenerated:!0,cells:[{q:-1,r:0,s:1,h:1,walkable:!0,userData:{}},{q:0,r:-1,s:1,h:1,walkable:!0,userData:{}},{q:0,r:0,s:0,h:1,walkable:!0,userData:{}},{q:1,r:-1,s:0,h:1,walkable:!0,userData:{}},{q:-1,r:1,s:0,h:0,walkable:!0,userData:{}},{q:0,r:1,s:-1,h:0,walkable:!0,userData:{}},{q:1,r:0,s:-1,h:0,walkable:!0,userData:{}}]};const PR=LR.exports,sZ=oZ;AFRAME.registerPrimitive("a-hexgrid",{defaultComponents:{hexgrid:{}},mappings:{src:"hexgrid.src"}});AFRAME.registerComponent("hexgrid",{dependencies:["material"],schema:{src:{type:"asset"}},init:function(){const i=this.data;i.src?fetch(i.src).then(n=>n.json()).then(n=>this.addMesh(n)):this.addMesh(sZ)},addMesh:function(i){const n=new PR.HexGrid;n.fromJSON(i);const r=new PR.Board(n);r.generateTilemap(),this.el.setObject3D("mesh",r.group),this.addMaterial()},addMaterial:function(){const n=(this.el.components.material||{}).material;!n||this.el.object3D.traverse(r=>{r.isMesh&&(r.material=n)})},remove:function(){this.el.removeObject3D("mesh")}});AFRAME.registerPrimitive("a-ocean",{defaultComponents:{ocean:{},rotation:{x:-90,y:0,z:0}},mappings:{width:"ocean.width",depth:"ocean.depth",density:"ocean.density",amplitude:"ocean.amplitude",amplitudeVariance:"ocean.amplitudeVariance",speed:"ocean.speed",speedVariance:"ocean.speedVariance",color:"ocean.color",opacity:"ocean.opacity"}});AFRAME.registerComponent("ocean",{schema:{width:{default:10,min:0},depth:{default:10,min:0},density:{default:10},amplitude:{default:.1},amplitudeVariance:{default:.3},speed:{default:1},speedVariance:{default:2},color:{default:"#7AD2F7",type:"color"},opacity:{default:.8}},play:function(){const i=this.el,n=this.data;let r=i.components.material;const a=new THREE.PlaneGeometry(n.width,n.depth,n.density,n.density);a.mergeVertices(),this.waves=[];for(let s,o=0,u=a.vertices.length;o<u;o++)s=a.vertices[o],this.waves.push({z:s.z,ang:Math.random()*Math.PI*2,amp:n.amplitude+Math.random()*n.amplitudeVariance,speed:(n.speed+Math.random()*n.speedVariance)/1e3});r||(r={},r.material=new THREE.MeshPhongMaterial({color:n.color,transparent:n.opacity<1,opacity:n.opacity,shading:THREE.FlatShading})),this.mesh=new THREE.Mesh(a,r.material),i.setObject3D("mesh",this.mesh)},remove:function(){this.el.removeObject3D("mesh")},tick:function(i,n){if(!n)return;const r=this.mesh.geometry.vertices;for(let a,s,o=0;a=r[o];o++)s=this.waves[o],a.z=s.z+Math.sin(s.ang)*s.amp,s.ang+=s.speed*n;this.mesh.geometry.verticesNeedUpdate=!0}});AFRAME.registerPrimitive("a-tube",{defaultComponents:{tube:{}},mappings:{path:"tube.path",segments:"tube.segments",radius:"tube.radius","radial-segments":"tube.radialSegments",closed:"tube.closed"}});AFRAME.registerComponent("tube",{schema:{path:{default:[]},segments:{default:64},radius:{default:1},radialSegments:{default:8},closed:{default:!1}},init:function(){const i=this.el,n=this.data;let r=i.components.material;if(!n.path.length){console.error("[a-tube] `path` property expected but not found.");return}const a=new THREE.CatmullRomCurve3(n.path.map(function(o){return o=o.split(" "),new THREE.Vector3(Number(o[0]),Number(o[1]),Number(o[2]))})),s=new THREE.TubeGeometry(a,n.segments,n.radius,n.radialSegments,n.closed);r||(r={},r.material=new THREE.MeshPhongMaterial),this.mesh=new THREE.Mesh(s,r.material),this.el.setObject3D("mesh",this.mesh)},update:function(i){!Object.keys(i).length||(this.remove(),this.init())},remove:function(){this.mesh&&this.el.removeObject3D("mesh")}});var lZ=IC(F$);if(typeof AFRAME=="undefined")throw new Error("Component attempted to register before AFRAME was available.");let nu=lZ;"default"in nu&&(nu=nu.default);const Bw=function(i){return typeof i=="string"?JSON.parse(i):i},Uo=function(i){if(typeof i=="function")return i;const n=eval;try{return n("("+i+")")}catch{}return null},Ri=function(i){return isNaN(parseFloat(i))?Uo(i)?Uo(i):i:parseFloat(i)};AFRAME.registerComponent("forcegraph",{schema:{jsonUrl:{type:"string",default:""},nodes:{parse:Bw,default:[]},links:{parse:Bw,default:[]},numDimensions:{type:"number",default:3},dagMode:{type:"string",default:""},dagLevelDistance:{type:"number",default:0},dagNodeFilter:{parse:Uo,function(){return!0}},onDagError:{parse:Uo,default:void 0},nodeRelSize:{type:"number",default:4},nodeId:{type:"string",default:"id"},nodeVal:{parse:Ri,default:"val"},nodeResolution:{type:"number",default:8},nodeVisibility:{parse:Ri,default:!0},nodeColor:{parse:Ri,default:"color"},nodeAutoColorBy:{parse:Ri,default:""},nodeOpacity:{type:"number",default:.75},nodeThreeObject:{parse:Ri,default:null},nodeThreeObjectExtend:{parse:Ri,default:!1},linkSource:{type:"string",default:"source"},linkTarget:{type:"string",default:"target"},linkVisibility:{parse:Ri,default:!0},linkColor:{parse:Ri,default:"color"},linkAutoColorBy:{parse:Ri,default:""},linkOpacity:{type:"number",default:.2},linkWidth:{parse:Ri,default:0},linkResolution:{type:"number",default:6},linkCurvature:{parse:Ri,default:0},linkCurveRotation:{parse:Ri,default:0},linkMaterial:{parse:Ri,default:null},linkThreeObject:{parse:Ri,default:null},linkThreeObjectExtend:{parse:Ri,default:!1},linkPositionUpdate:{parse:Uo,default:null},linkDirectionalArrowLength:{parse:Ri,default:0},linkDirectionalArrowColor:{parse:Ri,default:null},linkDirectionalArrowRelPos:{parse:Ri,default:.5},linkDirectionalArrowResolution:{type:"number",default:8},linkDirectionalParticles:{parse:Ri,default:0},linkDirectionalParticleSpeed:{parse:Ri,default:.01},linkDirectionalParticleWidth:{parse:Ri,default:.5},linkDirectionalParticleColor:{parse:Ri,default:null},linkDirectionalParticleResolution:{type:"number",default:4},onNodeHover:{parse:Uo,default:()=>{}},onLinkHover:{parse:Uo,default:()=>{}},onNodeClick:{parse:Uo,default:()=>{}},onLinkClick:{parse:Uo,default:()=>{}},forceEngine:{type:"string",default:"d3"},d3AlphaMin:{type:"number",default:0},d3AlphaDecay:{type:"number",default:.0228},d3VelocityDecay:{type:"number",default:.4},ngraphPhysics:{parse:Bw,default:null},warmupTicks:{type:"int",default:0},cooldownTicks:{type:"int",default:1e18},cooldownTime:{type:"int",default:15e3},onEngineTick:{parse:Uo,default:function(){}},onEngineStop:{parse:Uo,default:function(){}}},getGraphBbox:function(){return this.forceGraph||(this.forceGraph=new nu),this.forceGraph.getGraphBbox()},emitParticle:function(){this.forceGraph||(this.forceGraph=new nu);const i=this.forceGraph,n=i.emitParticle.apply(i,arguments);return n===i?this:n},d3Force:function(){this.forceGraph||(this.forceGraph=new nu);const i=this.forceGraph,n=i.d3Force.apply(i,arguments);return n===i?this:n},d3ReheatSimulation:function(){return this.forceGraph&&this.forceGraph.d3ReheatSimulation(),this},refresh:function(){return this.forceGraph&&this.forceGraph.refresh(),this},init:function(){const i=this.state={};i.infoEl=document.createElement("a-text"),i.infoEl.setAttribute("position","0 -0.1 -1"),i.infoEl.setAttribute("width",1),i.infoEl.setAttribute("align","center"),i.infoEl.setAttribute("color","lavender");const n=document.querySelector("a-entity[camera], a-camera");n.appendChild(i.infoEl),i.cameraObj=n.object3D.children.filter(function(r){return r.type==="PerspectiveCamera"})[0],this.el.sceneEl.addEventListener("camera-set-active",function(r){i.cameraObj=r.detail.cameraEl.components.camera.camera}),this.forceGraph||(this.forceGraph=new nu),this.forceGraph.onFinishUpdate(()=>this.el.setObject3D("forcegraphGroup",this.forceGraph)).onLoading(()=>i.infoEl.setAttribute("value","Loading...")).onFinishLoading(()=>i.infoEl.setAttribute("value","")),this.el.addEventListener("raycaster-intersected",r=>i.hoverDetail=r.detail),this.el.addEventListener("raycaster-intersected-cleared",r=>i.hoverDetail=r.detail),this.el.addEventListener("click",()=>i.hoverObj&&this.data["on"+(i.hoverObj.__graphObjType==="node"?"Node":"Link")+"Click"](i.hoverObj.__data))},remove:function(){this.state.infoEl.remove(),this.el.removeObject3D("forcegraphGroup")},update:function(i){const n=this,r=this.data,a=AFRAME.utils.diff(r,i);["jsonUrl","numDimensions","dagMode","dagLevelDistance","dagNodeFilter","onDagError","nodeRelSize","nodeId","nodeVal","nodeResolution","nodeVisibility","nodeColor","nodeAutoColorBy","nodeOpacity","nodeThreeObject","nodeThreeObjectExtend","linkSource","linkTarget","linkVisibility","linkColor","linkAutoColorBy","linkOpacity","linkWidth","linkResolution","linkCurvature","linkCurveRotation","linkMaterial","linkThreeObject","linkThreeObjectExtend","linkPositionUpdate","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution","forceEngine","d3AlphaMin","d3AphaDecay","d3VelocityDecay","ngraphPhysics","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"].filter(function(o){return o in a}).forEach(function(o){n.forceGraph[o](r[o]!==""?r[o]:null)}),("nodes"in a||"links"in a)&&n.forceGraph.graphData({nodes:r.nodes,links:r.links})},tick:function(i,n){const r=this.state,a=this.data,s=r.hoverDetail?r.hoverDetail.getIntersection?r.hoverDetail.getIntersection(this.el):r.hoverDetail.intersection||void 0:void 0;let o=s?s.object:void 0;for(;o&&!o.hasOwnProperty("__graphObjType");)o=o.parent;if(o!==r.hoverObj){const u=r.hoverObj?r.hoverObj.__graphObjType:null,f=r.hoverObj?r.hoverObj.__data:null,v=o?o.__graphObjType:null,m=o?o.__data:null;u&&u!==v&&a["on"+(u==="node"?"Node":"Link")+"Hover"](null,f),v&&a["on"+(v==="node"?"Node":"Link")+"Hover"](m,u===v?f:null),r.hoverObj=o}this.forceGraph.tickFrame()}});function cZ(i,n){n===void 0&&(n={});var r=n.insertAt;if(!(!i||typeof document=="undefined")){var a=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",r==="top"&&a.firstChild?a.insertBefore(s,a.firstChild):a.appendChild(s),s.styleSheet?s.styleSheet.cssText=i:s.appendChild(document.createTextNode(i))}}var uZ=`.graph-nav-info {
  position: absolute;
  bottom: 5px;
  width: 100%;
  text-align: center;
  color: slategrey;
  opacity: 0.7;
  font-size: 10px;
  font-family: Sans-serif;
  z-index: 1000;
}`;cZ(uZ);function DR(i,n){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);n&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(i,s).enumerable})),r.push.apply(r,a)}return r}function OR(i){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?DR(Object(r),!0).forEach(function(a){_p(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):DR(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}function _p(i,n,r){return n in i?Object.defineProperty(i,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):i[n]=r,i}function Nw(i,n){return fZ(i)||pZ(i,n)||IR(i,n)||vZ()}function g0(i){return hZ(i)||dZ(i)||IR(i)||mZ()}function hZ(i){if(Array.isArray(i))return Uw(i)}function fZ(i){if(Array.isArray(i))return i}function dZ(i){if(typeof Symbol!="undefined"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function pZ(i,n){var r=i==null?null:typeof Symbol!="undefined"&&i[Symbol.iterator]||i["@@iterator"];if(r!=null){var a=[],s=!0,o=!1,u,f;try{for(r=r.call(i);!(s=(u=r.next()).done)&&(a.push(u.value),!(n&&a.length===n));s=!0);}catch(v){o=!0,f=v}finally{try{!s&&r.return!=null&&r.return()}finally{if(o)throw f}}return a}}function IR(i,n){if(!!i){if(typeof i=="string")return Uw(i,n);var r=Object.prototype.toString.call(i).slice(8,-1);if(r==="Object"&&i.constructor&&(r=i.constructor.name),r==="Map"||r==="Set")return Array.from(i);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Uw(i,n)}}function Uw(i,n){(n==null||n>i.length)&&(n=i.length);for(var r=0,a=new Array(n);r<n;r++)a[r]=i[r];return a}function mZ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vZ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var gZ=Zc({props:{width:{default:window.innerWidth,triggerUpdate:!1,onChange:function(n,r){r.container&&(r.container.style.width=n)}},height:{default:window.innerHeight,triggerUpdate:!1,onChange:function(n,r){r.container&&(r.container.style.height=n)}},jsonUrl:{},graphData:{default:{nodes:[],links:[]}},numDimensions:{default:3},dagMode:{},dagLevelDistance:{},dagNodeFilter:{default:function(){return!0}},onDagError:{default:void 0},backgroundColor:{default:"#002"},showNavInfo:{default:!0},nodeRelSize:{default:4},nodeId:{default:"id"},nodeLabel:{default:"name"},nodeDesc:{default:"desc"},onNodeHover:{},onNodeClick:{},nodeVal:{default:"val"},nodeResolution:{default:8},nodeVisibility:{default:!0},nodeColor:{default:"color"},nodeAutoColorBy:{},nodeOpacity:{default:.75},nodeThreeObject:{},nodeThreeObjectExtend:{default:!1},linkSource:{default:"source"},linkTarget:{default:"target"},linkLabel:{default:"name"},linkDesc:{default:"desc"},onLinkHover:{},onLinkClick:{},linkVisibility:{default:!0},linkColor:{default:"color"},linkAutoColorBy:{},linkOpacity:{default:.2},linkWidth:{default:0},linkResolution:{default:6},linkCurvature:{default:0},linkCurveRotation:{default:0},linkMaterial:{},linkThreeObject:{},linkThreeObjectExtend:{default:!1},linkPositionUpdate:{},linkDirectionalArrowLength:{default:0},linkDirectionalArrowColor:{},linkDirectionalArrowRelPos:{default:.5},linkDirectionalArrowResolution:{default:8},linkDirectionalParticles:{default:0},linkDirectionalParticleSpeed:{default:.01},linkDirectionalParticleWidth:{default:.5},linkDirectionalParticleColor:{},linkDirectionalParticleResolution:{default:4},forceEngine:{default:"d3"},d3AlphaMin:{default:0},d3AlphaDecay:{default:.0228},d3VelocityDecay:{default:.4},ngraphPhysics:{},warmupTicks:{default:0},cooldownTicks:{},cooldownTime:{default:15e3},onEngineTick:{},onEngineStop:{}},methods:OR(OR({},Object.assign.apply(Object,[{}].concat(g0(["getGraphBbox","emitParticle","d3Force","d3ReheatSimulation","refresh"].map(function(i){return _p({},i,function(n){for(var r=n.forcegraph.components.forcegraph,a=arguments.length,s=new Array(a>1?a-1:0),o=1;o<a;o++)s[o-1]=arguments[o];var u=r[i].apply(r,s);return u===r?this:u})}))))),{},{_destructor:function(){this.graphData({nodes:[],links:[]})}}),init:function(n,r){n.innerHTML="",r.container=document.createElement("div"),n.appendChild(r.container),r.container.style.position="relative",r.container.style.width=r.width,r.container.style.height=r.height,r.container.appendChild(r.navInfo=document.createElement("div")),r.navInfo.className="graph-nav-info",r.navInfo.textContent="Mouse drag: look, gamepad/arrow/wasd keys: move";var a=document.createElement("a-scene");a.setAttribute("embedded",""),a.appendChild(r.sky=document.createElement("a-sky")),r.sky.setAttribute("radius",3e3);var s;a.appendChild(s=document.createElement("a-entity")),s.setAttribute("position","0 0 300"),s.setAttribute("movement-controls","fly: true; speed: 7");var o;s.appendChild(o=document.createElement("a-entity")),o.setAttribute("camera",""),o.setAttribute("position","0 0 0"),o.setAttribute("look-controls","reverseMouseDrag: false; pointerLockEnabled: false");var u;o.appendChild(u=document.createElement("a-text")),u.setAttribute("position","0 -0.3 -1"),u.setAttribute("width",2),u.setAttribute("align","center"),u.setAttribute("color","lavender"),u.setAttribute("value","");var f;o.appendChild(f=document.createElement("a-text")),f.setAttribute("position","0 -0.4 -1"),f.setAttribute("width",1.3),f.setAttribute("align","center"),f.setAttribute("color","lavender"),f.setAttribute("value",""),r.raycasterEls=[];var v;a.appendChild(v=document.createElement("a-entity")),v.setAttribute("cursor","rayOrigin: mouse; mouseCursorStylesEnabled: true"),v.setAttribute("raycaster","objects: [forcegraph]; interval: 100"),r.raycasterEls.push(v),["left","right"].forEach(function(m){var g;s.appendChild(g=document.createElement("a-entity")),g.setAttribute("laser-controls","hand: ".concat(m)),g.setAttribute("raycaster","objects: [forcegraph]; interval: 100; lineColor: steelblue; lineOpacity: 0.85"),r.raycasterEls.push(g)}),a.appendChild(r.forcegraph=document.createElement("a-entity")),r.forcegraph.setAttribute("forcegraph",null),r.container.appendChild(a),r.forcegraph.setAttribute("forcegraph",Object.assign.apply(Object,g0(["node","link"].map(function(m){var g={node:"Node",link:"Link"}[m];return _p({},"on".concat(g,"Hover"),function(b,w){var A=b&&Ln(r["".concat(m,"Label")])(b)||"",M=b&&Ln(r["".concat(m,"Desc")])(b)||"";u.setAttribute("value",A),f.setAttribute("value",M),r["on".concat(g,"Hover")]&&r["on".concat(g,"Hover")](b,w)})}))))},update:function(n,r){r.hasOwnProperty("backgroundColor")&&n.sky.setAttribute("color",n.backgroundColor),r.hasOwnProperty("showNavInfo")&&(n.navInfo.style.display=n.showNavInfo?null:"none");var a=["onNodeHover","onLinkHover","onNodeClick","onLinkClick"].some(function(u){return n[u]});n.raycasterEls.forEach(function(u){return u.setAttribute("raycaster",a?"objects: [forcegraph]; interval: 100":"objects: __none__")});var s=["jsonUrl","numDimensions","dagMode","dagLevelDistance","dagNodeFilter","onDagError","nodeRelSize","nodeId","onNodeClick","nodeVal","nodeResolution","nodeVisibility","nodeColor","nodeAutoColorBy","nodeOpacity","nodeThreeObject","nodeThreeObjectExtend","linkSource","linkTarget","onLinkClick","linkVisibility","linkColor","linkAutoColorBy","linkOpacity","linkWidth","linkResolution","linkCurvature","linkCurveRotation","linkMaterial","linkThreeObject","linkThreeObjectExtend","linkPositionUpdate","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution","forceEngine","d3AlphaMin","d3AlphaDecay","d3VelocityDecay","ngraphPhysics","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"],o=Object.assign.apply(Object,[{}].concat(g0(Object.entries(n).filter(function(u){var f=Nw(u,2),v=f[0],m=f[1];return r.hasOwnProperty(v)&&s.indexOf(v)!==-1&&m!==void 0&&m!==null}).map(function(u){var f=Nw(u,2),v=f[0],m=f[1];return _p({},v,m)})),g0(Object.entries(n.graphData).map(function(u){var f=Nw(u,2),v=f[0],m=f[1];return _p({},v,m)}))));n.forcegraph.setAttribute("forcegraph",o)}});const yZ={width:Number,height:Number,graphData:{type:Object,required:!0,validator(i){return i.nodes&&i.links}},backgroundColor:String,nodeRelSize:Number,nodeId:String,nodeLabel:[String,Function],nodeVal:[Number,String,Function],nodeVisibility:{type:[Boolean,String,Function],default:!0},nodeColor:[String,Function],nodeAutoColorBy:[String,Function],onNodeHover:Function,onNodeClick:Function,linkSource:String,linkTarget:String,linkLabel:[String,Function],linkVisibility:{type:[Boolean,String,Function],default:!0},linkColor:[String,Function],linkAutoColorBy:[String,Function],linkWidth:[Number,String,Function],linkCurvature:[Number,String,Function],linkDirectionalArrowLength:[Number,String,Function],linkDirectionalArrowColor:[String,Function],linkDirectionalArrowRelPos:[Number,String,Function],linkDirectionalParticles:[Number,String,Function],linkDirectionalParticleSpeed:[Number,String,Function],linkDirectionalParticleWidth:[Number,String,Function],linkDirectionalParticleColor:[String,Function],onLinkHover:Function,onLinkClick:Function,dagMode:{validator(i){return["td","bu","lr","rl","zin","zout","radialin","radialout"].includes(i)}},dagLevelDistance:Number,dagNodeFilter:Function,onDagError:Function,d3AlphaMin:Number,d3AlphaDecay:Number,d3VelocityDecay:Number,warmupTicks:Number,cooldownTicks:Number,cooldownTime:Number,onEngineTick:Function,onEngineStop:Function,getGraphBbox:Function,zoomToFit:Function,onNodeRightClick:Function,onNodeDrag:Function,onNodeDragEnd:Function,onLinkRightClick:Function,linkHoverPrecision:Number,onBackgroundClick:Function,onBackgroundRightClick:Function,enablePointerInteraction:{type:Boolean,default:!0},enableNodeDrag:{type:Boolean,default:!0},showNavInfo:{type:Boolean,default:!0},nodeOpacity:Number,nodeResolution:Number,nodeThreeObject:[Object,String,Function],nodeThreeObjectExtend:{type:[Boolean,String,Function],default:!1},linkOpacity:Number,linkResolution:Number,linkCurveRotation:[Number,String,Function],linkMaterial:[Object,String,Function],linkThreeObject:[Object,String,Function],linkThreeObjectExtend:{type:[Boolean,String,Function],default:!1},linkPositionUpdate:Function,linkDirectionalArrowResolution:Number,linkDirectionalParticleResolution:Number,forceEngine:{validator(i){return["d3","ngraph"].includes(i)}},ngraphPhysics:Object,numDimensions:{validator(i){return[1,2,3].includes(i)}},nodeDesc:[String,Function],linkDesc:[String,Function]};var kR=Og(gZ,{methodNames:["getGraphBbox","emitParticle","d3Force","d3ReheatSimulation","refresh"],name:"VueForceGraphVR",props:yZ});kR.__file="packages/components/vue-force-graph-vr/src/vue-force-graph-vr.vue";Xd(kR);function FR(i,n){var r=Object.keys(i);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);n&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(i,s).enumerable})),r.push.apply(r,a)}return r}function BR(i){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?FR(Object(r),!0).forEach(function(a){y0(i,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(r)):FR(Object(r)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(r,a))})}return i}function y0(i,n,r){return n in i?Object.defineProperty(i,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):i[n]=r,i}function b0(i,n){return xZ(i)||AZ(i,n)||NR(i,n)||_Z()}function x0(i){return bZ(i)||wZ(i)||NR(i)||EZ()}function bZ(i){if(Array.isArray(i))return Hw(i)}function xZ(i){if(Array.isArray(i))return i}function wZ(i){if(typeof Symbol!="undefined"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function AZ(i,n){var r=i==null?null:typeof Symbol!="undefined"&&i[Symbol.iterator]||i["@@iterator"];if(r!=null){var a=[],s=!0,o=!1,u,f;try{for(r=r.call(i);!(s=(u=r.next()).done)&&(a.push(u.value),!(n&&a.length===n));s=!0);}catch(v){o=!0,f=v}finally{try{!s&&r.return!=null&&r.return()}finally{if(o)throw f}}return a}}function NR(i,n){if(!!i){if(typeof i=="string")return Hw(i,n);var r=Object.prototype.toString.call(i).slice(8,-1);if(r==="Object"&&i.constructor&&(r=i.constructor.name),r==="Map"||r==="Set")return Array.from(i);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Hw(i,n)}}function Hw(i,n){(n==null||n>i.length)&&(n=i.length);for(var r=0,a=new Array(n);r<n;r++)a[r]=i[r];return a}function EZ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _Z(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var MZ=Zc({props:{width:{},height:{},yOffset:{default:1.5},glScale:{default:200},jsonUrl:{},graphData:{default:{nodes:[],links:[]}},numDimensions:{default:3},dagMode:{},dagLevelDistance:{},dagNodeFilter:{default:function(){return!0}},onDagError:{default:void 0},nodeRelSize:{default:4},nodeId:{default:"id"},nodeVal:{default:"val"},nodeResolution:{default:8},nodeVisibility:{default:!0},nodeColor:{default:"color"},nodeAutoColorBy:{},nodeOpacity:{default:.75},nodeThreeObject:{},nodeThreeObjectExtend:{default:!1},linkSource:{default:"source"},linkTarget:{default:"target"},linkVisibility:{default:!0},linkColor:{default:"color"},linkAutoColorBy:{},linkOpacity:{default:.2},linkWidth:{default:0},linkResolution:{default:6},linkCurvature:{default:0},linkCurveRotation:{default:0},linkMaterial:{},linkThreeObject:{},linkThreeObjectExtend:{default:!1},linkPositionUpdate:{},linkDirectionalArrowLength:{default:0},linkDirectionalArrowColor:{},linkDirectionalArrowRelPos:{default:.5},linkDirectionalArrowResolution:{default:8},linkDirectionalParticles:{default:0},linkDirectionalParticleSpeed:{default:.01},linkDirectionalParticleWidth:{default:.5},linkDirectionalParticleColor:{},linkDirectionalParticleResolution:{default:4},onNodeHover:{},onNodeClick:{},onLinkHover:{},onLinkClick:{},forceEngine:{default:"d3"},d3AlphaMin:{default:0},d3AlphaDecay:{default:.0228},d3VelocityDecay:{default:.4},ngraphPhysics:{},warmupTicks:{default:0},cooldownTicks:{},cooldownTime:{default:15e3},onEngineTick:{},onEngineStop:{}},methods:BR(BR({},Object.assign.apply(Object,[{}].concat(x0(["getGraphBbox","emitParticle","d3Force","d3ReheatSimulation","refresh"].map(function(i){return y0({},i,function(n){for(var r=n.forcegraph.components.forcegraph,a=arguments.length,s=new Array(a>1?a-1:0),o=1;o<a;o++)s[o-1]=arguments[o];var u=r[i].apply(r,s);return u===r?this:u})}))))),{},{_destructor:function(){this.graphData({nodes:[],links:[]})}}),init:function(n,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=a.markerAttrs,o=s===void 0?{preset:"hiro"}:s;n.innerHTML="",r.container=document.createElement("div"),n.appendChild(r.container);var u=document.createElement("a-scene");u.setAttribute("embedded",""),u.setAttribute("arjs","debugUIEnabled: false;");var f=document.createElement("a-marker");Object.entries(o).forEach(function(g){var y=b0(g,2),b=y[0],w=y[1];return f.setAttribute(b,w)}),u.appendChild(f);var v;u.appendChild(v=document.createElement("a-entity")),v.setAttribute("cursor"),v.setAttribute("raycaster","objects: [forcegraph]"),r.forcegraph=document.createElement("a-entity"),r.forcegraph.setAttribute("forcegraph",null),f.appendChild(r.forcegraph);var m=document.createElement("a-entity");m.setAttribute("camera",""),u.appendChild(m),r.container.appendChild(u)},update:function(n,r){r.hasOwnProperty("width")&&n.width&&(n.container.style.width=n.width),r.hasOwnProperty("height")&&n.height&&(n.container.style.height=n.height),r.hasOwnProperty("glScale")&&n.forcegraph.setAttribute("scale",x0(new Array(3)).map(function(){return 1/n.glScale}).join(" ")),r.hasOwnProperty("yOffset")&&n.forcegraph.setAttribute("position","0 ".concat(n.yOffset," 0"));var a=["jsonUrl","numDimensions","dagMode","dagLevelDistance","dagNodeFilter","onDagError","nodeRelSize","nodeId","nodeVal","nodeResolution","nodeVisibility","nodeColor","nodeAutoColorBy","nodeOpacity","nodeThreeObject","nodeThreeObjectExtend","linkSource","linkTarget","linkVisibility","linkColor","linkAutoColorBy","linkOpacity","linkWidth","linkResolution","linkCurvature","linkCurveRotation","linkMaterial","linkThreeObject","linkThreeObjectExtend","linkPositionUpdate","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution","onNodeHover","onNodeClick","onLinkHover","onLinkClick","forceEngine","d3AlphaMin","d3AlphaDecay","d3VelocityDecay","ngraphPhysics","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"],s=Object.assign.apply(Object,[{}].concat(x0(Object.entries(n).filter(function(o){var u=b0(o,2),f=u[0],v=u[1];return r.hasOwnProperty(f)&&a.indexOf(f)!==-1&&v!==void 0&&v!==null}).map(function(o){var u=b0(o,2),f=u[0],v=u[1];return y0({},f,v)})),x0(Object.entries(n.graphData).map(function(o){var u=b0(o,2),f=u[0],v=u[1];return y0({},f,v)}))));n.forcegraph.setAttribute("forcegraph",s)}});const SZ={width:Number,height:Number,graphData:{type:Object,required:!0,validator(i){return i.nodes&&i.links}},backgroundColor:String,nodeRelSize:Number,nodeId:String,nodeLabel:[String,Function],nodeVal:[Number,String,Function],nodeVisibility:{type:[Boolean,String,Function],default:!0},nodeColor:[String,Function],nodeAutoColorBy:[String,Function],onNodeHover:Function,onNodeClick:Function,linkSource:String,linkTarget:String,linkLabel:[String,Function],linkVisibility:{type:[Boolean,String,Function],default:!0},linkColor:[String,Function],linkAutoColorBy:[String,Function],linkWidth:[Number,String,Function],linkCurvature:[Number,String,Function],linkDirectionalArrowLength:[Number,String,Function],linkDirectionalArrowColor:[String,Function],linkDirectionalArrowRelPos:[Number,String,Function],linkDirectionalParticles:[Number,String,Function],linkDirectionalParticleSpeed:[Number,String,Function],linkDirectionalParticleWidth:[Number,String,Function],linkDirectionalParticleColor:[String,Function],onLinkHover:Function,onLinkClick:Function,dagMode:{validator(i){return["td","bu","lr","rl","zin","zout","radialin","radialout"].includes(i)}},dagLevelDistance:Number,dagNodeFilter:Function,onDagError:Function,d3AlphaMin:Number,d3AlphaDecay:Number,d3VelocityDecay:Number,warmupTicks:Number,cooldownTicks:Number,cooldownTime:Number,onEngineTick:Function,onEngineStop:Function,getGraphBbox:Function,zoomToFit:Function,onNodeRightClick:Function,onNodeDrag:Function,onNodeDragEnd:Function,onLinkRightClick:Function,linkHoverPrecision:Number,onBackgroundClick:Function,onBackgroundRightClick:Function,enablePointerInteraction:{type:Boolean,default:!0},enableNodeDrag:{type:Boolean,default:!0},showNavInfo:{type:Boolean,default:!0},nodeOpacity:Number,nodeResolution:Number,nodeThreeObject:[Object,String,Function],nodeThreeObjectExtend:{type:[Boolean,String,Function],default:!1},linkOpacity:Number,linkResolution:Number,linkCurveRotation:[Number,String,Function],linkMaterial:[Object,String,Function],linkThreeObject:[Object,String,Function],linkThreeObjectExtend:{type:[Boolean,String,Function],default:!1},linkPositionUpdate:Function,linkDirectionalArrowResolution:Number,linkDirectionalParticleResolution:Number,forceEngine:{validator(i){return["d3","ngraph"].includes(i)}},ngraphPhysics:Object,numDimensions:{validator(i){return[1,2,3].includes(i)}},markerAttrs:Object,yOffset:Number,glScale:Number};var UR=Og(MZ,{name:"VueForceGraphAR",methodNames:["getGraphBbox","emitParticle","d3Force","d3ReheatSimulation","refresh"],initPropNames:["markerAttrs"],props:SZ});UR.__file="packages/components/vue-force-graph-ar/src/vue-force-graph-ar.vue";Xd(UR);const TZ={bindType:{type:String,default:"node",validator:i=>["node","edge","canvas"].includes(i)},mode:{type:String,default:"2d",validator:i=>["2d","3d","ar","vr"].includes(i)},width:{type:[Number,String],default:"auto"},height:{type:[Number,String],default:"auto"},backgroundColor:{type:String,default:"rgba(0,0,0,0)"}};var w0=td({name:"GraphContextMenu",props:TZ,setup(i){const n=hb(),r=Ic({visible:!1,xyz:[0,0,0]}),a=()=>{r.visible=!1},s=Ic({graphContext:null,activeData:null,event:null}),o=H2(z2.token);s.graphContext=o,console.dir(o);const u=()=>{r.visible=!0};let f;const v=()=>{let A=0,M=0;if(i.mode==="3d"||i.mode==="2d"){if(r.xyz.every(E=>!E))return;const S=o.graph2ScreenCoords(...r.xyz);A=S.x,M=S.y}if(r.visible)m(A,M);else return;f=window.requestAnimationFrame(v)};cd(()=>r.visible,()=>{r.visible?f=window.requestAnimationFrame(v):window.cancelAnimationFrame(f)}),MM(()=>{U2(G2,s)});const m=(A,M)=>{n.value.style.top=M+"px",n.value.style.left=A+"px"},g=()=>{switch(i.bindType){case"node":y();break;case"edge":b();break;case"canvas":w();break}},y=()=>{o.onNodeRightClick((A,M)=>{console.log(A,M),s.activeData=A,s.event=M,r.xyz=[A.x,A.y,A.z];const S=M.clientX,E=M.clientY;m(S,E),u()})},b=()=>{o.onLinkRightClick((A,M)=>{s.event=M,s.activeData=A;const{clientX:S,clientY:E}=M,{x:T,y:C}=o.graph2ScreenCoords(A.target.x,A.target.y,A.target.z),{x:L,y:P}=o.graph2ScreenCoords(A.source.x,A.source.y,A.source.z),N=(S-T)/(L-T),F=(E-C)/(P-C);r.xyz=[N*(A.source.x-A.target.x)+A.target.x,F*(A.source.y-A.target.y)+A.target.y,(N+F)/2*(+A.source.z-A.target.z)+A.target.z],m(S,E),u()})},w=()=>{o.onBackgroundRightClick(A=>{s.event=A,s.activeData=null,m(A.clientX,A.clientY),u()})};return g(),mb(()=>{document.addEventListener("click",a,!1),v()}),vb(()=>{document.removeEventListener("click",a,!1)}),Object.assign(Object.assign(Object.assign({menuContainerRef:n},N_(r)),N_(s)),{hide:a})}});function CZ(i,n,r,a,s,o){return Z4((ju(),yv("div",{ref:"menuContainerRef",class:"menus-container",style:Jm({width:i.width,height:i.height,backgroundColor:i.backgroundColor}),onClick:n[0]||(n[0]=KB((...u)=>i.hide&&i.hide(...u),["stop"]))},[fM(i.$slots,"default",{graphContext:i.graphContext,activeData:i.activeData,event:i.event})],4)),[[ZB,i.visible]])}w0.render=CZ;w0.__scopeId="data-v-294bd8b4";w0.__file="packages/components/graph-context-menu/src/context-menu.vue";const RZ={data:{type:Array,default:()=>[],validator:i=>i.every(n=>n.hasOwnProperty("id")&&n.hasOwnProperty("label"))}};var Mp=td({name:"GraphMenu",props:RZ,emits:["change"],setup(i,{emit:n}){const r=H2(G2.token);return{clickItemHandle:s=>{const{activeData:o,event:u,graphContext:f}=r;n("change",{activeData:o,event:u,graphContext:f,menuItem:s})}}}});const LZ={class:"force-graph-menu"},PZ=["onClick"];function DZ(i,n,r,a,s,o){return ju(),yv("ul",LZ,[i.data.length?uB("v-if",!0):fM(i.$slots,"default",{key:0}),(ju(!0),yv(co,null,fB(i.data,u=>(ju(),yv("li",{class:"force-graph-menu-item",key:u.id,onClick:f=>i.clickItemHandle(u)},OF(u.label),9,PZ))),128))])}Mp.render=DZ;Mp.__scopeId="data-v-0f279b70";Mp.__file="packages/components/graph-context-menu/src/menu.vue";const WZ=Xd(w0,{GraphMenu:Mp}),jZ=a7(Mp);export{ha as $,Z4 as A,ZB as B,Ze as C,k4 as D,F4 as E,co as F,mb as G,I4 as H,KC as I,vb as J,On as K,Wt as L,jn as M,Us as N,ei as O,h0 as P,uR as Q,hS as R,Bx as S,x2 as T,tT as U,VZ as V,Do as W,Yv as X,G$ as Y,Ra as Z,zZ as _,FZ as a,Jf as a0,jZ as a1,WZ as a2,uB as b,cM as c,td as d,VT as e,UZ as f,NZ as g,yv as h,fM as i,hM as j,fB as k,kZ as l,_4 as m,qy as n,ju as o,IZ as p,ka as q,hb as r,BZ as s,OF as t,HZ as u,GZ as v,cd as w,Ic as x,Jo as y,N_ as z};
